--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            n0268.savio3
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4123

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
Rank =    0  Free Memory = 85714 MB
Rank =    1  Free Memory = 85713 MB
Rank =    2  Free Memory = 85713 MB
Rank =    3  Free Memory = 85713 MB
Rank =    4  Free Memory = 85711 MB
Rank =    5  Free Memory = 85711 MB
Rank =    6  Free Memory = 85709 MB
Rank =    7  Free Memory = 85708 MB
Rank =    8  Free Memory = 85707 MB
Rank =    9  Free Memory = 85706 MB
Rank =   10  Free Memory = 85701 MB
Rank =   11  Free Memory = 85701 MB
Rank =   12  Free Memory = 85701 MB
Rank =   13  Free Memory = 85701 MB
Rank =   14  Free Memory = 85701 MB
Rank =   15  Free Memory = 85701 MB
Rank =   16  Free Memory = 85695 MB
Rank =   17  Free Memory = 85694 MB
Rank =   18  Free Memory = 85694 MB
Rank =   19  Free Memory = 85694 MB
Rank =   20  Free Memory = 85694 MB
Rank =   21  Free Memory = 85694 MB
Rank =   22  Free Memory = 85694 MB
Rank =   23  Free Memory = 85694 MB
Rank =   24  Free Memory = 85694 MB
Rank =   25  Free Memory = 85694 MB
Rank =   26  Free Memory = 85694 MB
Rank =   27  Free Memory = 85694 MB
Rank =   28  Free Memory = 85694 MB
Rank =   29  Free Memory = 85694 MB
Rank =   30  Free Memory = 85694 MB
Rank =   31  Free Memory = 85694 MB
Rank =   32  Free Memory = 64690 MB
Rank =   33  Free Memory = 64690 MB
Rank =   34  Free Memory = 64690 MB
Rank =   35  Free Memory = 64690 MB
Rank =   36  Free Memory = 64690 MB
Rank =   37  Free Memory = 64690 MB
Rank =   38  Free Memory = 64690 MB
Rank =   39  Free Memory = 64690 MB
Rank =   40  Free Memory = 64690 MB
Rank =   41  Free Memory = 64690 MB
Rank =   42  Free Memory = 64690 MB
Rank =   43  Free Memory = 64690 MB
Rank =   44  Free Memory = 64690 MB
Rank =   45  Free Memory = 64690 MB
Rank =   46  Free Memory = 64690 MB
Rank =   47  Free Memory = 64690 MB
Rank =   48  Free Memory = 64690 MB
Rank =   49  Free Memory = 64690 MB
Rank =   50  Free Memory = 64690 MB
Rank =   51  Free Memory = 64690 MB
Rank =   52  Free Memory = 64690 MB
Rank =   53  Free Memory = 64690 MB
Rank =   54  Free Memory = 64689 MB
Rank =   55  Free Memory = 64689 MB
Rank =   56  Free Memory = 64689 MB
Rank =   57  Free Memory = 64689 MB
Rank =   58  Free Memory = 64689 MB
Rank =   59  Free Memory = 64689 MB
Rank =   60  Free Memory = 64689 MB
Rank =   61  Free Memory = 64689 MB
Rank =   62  Free Memory = 64689 MB
Rank =   63  Free Memory = 64689 MB
Rank =   64  Free Memory = 64689 MB
Rank =   65  Free Memory = 64689 MB
Rank =   66  Free Memory = 64689 MB
Rank =   67  Free Memory = 64689 MB
Rank =   68  Free Memory = 64689 MB
Rank =   69  Free Memory = 64689 MB
Rank =   70  Free Memory = 64689 MB
Rank =   71  Free Memory = 64689 MB
Rank =   72  Free Memory = 64854 MB
Rank =   73  Free Memory = 64854 MB
Rank =   74  Free Memory = 64854 MB
Rank =   75  Free Memory = 64854 MB
Rank =   76  Free Memory = 64854 MB
Rank =   77  Free Memory = 64854 MB
Rank =   78  Free Memory = 64854 MB
Rank =   79  Free Memory = 64854 MB
Rank =   80  Free Memory = 64854 MB
Rank =   81  Free Memory = 64854 MB
Rank =   82  Free Memory = 64854 MB
Rank =   83  Free Memory = 64854 MB
Rank =   84  Free Memory = 64854 MB
Rank =   85  Free Memory = 64854 MB
Rank =   86  Free Memory = 64854 MB
Rank =   87  Free Memory = 64854 MB
Rank =   88  Free Memory = 64854 MB
Rank =   89  Free Memory = 64854 MB
Rank =   90  Free Memory = 64854 MB
Rank =   91  Free Memory = 64854 MB
Rank =   92  Free Memory = 64854 MB
Rank =   93  Free Memory = 64854 MB
Rank =   94  Free Memory = 64854 MB
Rank =   95  Free Memory = 64854 MB
Rank =   96  Free Memory = 64854 MB
Rank =   97  Free Memory = 64854 MB
Rank =   98  Free Memory = 64854 MB
Rank =   99  Free Memory = 64854 MB
Rank =  100  Free Memory = 64854 MB
Rank =  101  Free Memory = 64854 MB
Rank =  102  Free Memory = 64854 MB
Rank =  103  Free Memory = 64854 MB
Rank =  104  Free Memory = 64854 MB
Rank =  105  Free Memory = 64854 MB
Rank =  106  Free Memory = 64854 MB
Rank =  107  Free Memory = 64854 MB
Rank =  108  Free Memory = 64854 MB
Rank =  109  Free Memory = 64854 MB
Rank =  110  Free Memory = 64854 MB
Rank =  111  Free Memory = 64854 MB
Rank =  112  Free Memory = 68575 MB
  Input file(s): opt_h2o_gs_tecombci_run001c.xml 
Rank =  113  Free Memory = 68575 MB
Rank =  114  Free Memory = 68575 MB
Rank =  115  Free Memory = 68575 MB
Rank =  116  Free Memory = 68575 MB
Rank =  117  Free Memory = 68575 MB
Rank =  118  Free Memory = 68575 MB
Rank =  119  Free Memory = 68575 MB
Rank =  120  Free Memory = 68575 MB
Rank =  121  Free Memory = 68575 MB
Rank =  122  Free Memory = 68575 MB
Rank =  123  Free Memory = 68575 MB
Rank =  124  Free Memory = 68575 MB
Rank =  125  Free Memory = 68575 MB
Rank =  126  Free Memory = 68575 MB
Rank =  127  Free Memory = 68575 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_tecombci_run001c.xml

  Project = H2O
  date    = 2023-04-18 00:46:55 PDT
  host    = n0050.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 751

  Range of prime numbers to use as seeds over processors and threads = 5717-6841


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.061949e-01    1         1 OFF
     uu_1                 4.539117e-02    1         1 OFF
     uu_2                -4.680481e-02    1         1 OFF
     uu_3                -9.936272e-02    1         1 OFF
     uu_4                -1.304449e-01    1         1 OFF
     uu_5                -1.356413e-01    1         1 OFF
     uu_6                -1.130357e-01    1         1 OFF
     uu_7                -3.972344e-02    1         1 OFF
     uu_8                 9.988696e-02    1         1 OFF
     uu_9                 1.208933e-01    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.495801e-01    1         1 OFF
     ud_1                 9.178565e-02    1         1 OFF
     ud_2                -1.648758e-02    1         1 OFF
     ud_3                -7.596335e-02    1         1 OFF
     ud_4                -1.217524e-01    1         1 OFF
     ud_5                -1.523214e-01    1         1 OFF
     ud_6                -1.544624e-01    1         1 OFF
     ud_7                -1.100034e-01    1         1 OFF
     ud_8                 4.463187e-03    1         1 OFF
     ud_9                 9.258159e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.504332e-01    1         1 OFF
     eO_1                -4.354966e-01    1         1 OFF
     eO_2                -3.598301e-02    1         1 OFF
     eO_3                 2.081612e-01    1         1 OFF
     eO_4                 2.891481e-01    1         1 OFF
     eO_5                 3.052708e-01    1         1 OFF
     eO_6                 2.501148e-01    1         1 OFF
     eO_7                 1.121837e-01    1         1 OFF
     eO_8                 2.793060e-02    1         1 OFF
     eO_9                 1.846823e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.820113e-01    1         1 OFF
     eH1_1                -1.027126e-01    1         1 OFF
     eH1_2                -6.202978e-02    1         1 OFF
     eH1_3                -2.594624e-02    1         1 OFF
     eH1_4                 1.931583e-02    1         1 OFF
     eH1_5                 3.552903e-02    1         1 OFF
     eH1_6                 7.728065e-02    1         1 OFF
     eH1_7                 1.103061e-01    1         1 OFF
     eH1_8                 9.073801e-02    1         1 OFF
     eH1_9                 2.428776e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.835289e-01    1         1 OFF
     eH2_1                -1.038380e-01    1         1 OFF
     eH2_2                -6.350521e-02    1         1 OFF
     eH2_3                -2.706107e-02    1         1 OFF
     eH2_4                 1.856801e-02    1         1 OFF
     eH2_5                 3.504988e-02    1         1 OFF
     eH2_6                 7.827831e-02    1         1 OFF
     eH2_7                 1.134121e-01    1         1 OFF
     eH2_8                 9.397367e-02    1         1 OFF
     eH2_9                 2.639279e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.679918e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.7449e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
[n0050.savio3:15701] 95 more processes have sent help message help-mpi-btl-openib.txt / no device params found
[n0050.savio3:15701] Set MCA parameter "orte_base_help_aggregate" to 0 to see all help / error messages
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.225
    reference variance = 0.572992
====================================================
  Execution time = 1.4494e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9736e-01
  Total weights = 1.957531156e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5224e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286368644435
                                         uncertainty =       0.001930441845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286368644435
                                         uncertainty =       0.001930441845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378395041
  error estimate for blocks of size 2^( 2) =       0.000389471647
  error estimate for blocks of size 2^( 3) =       0.000399498489
  error estimate for blocks of size 2^( 4) =       0.000407109980
  error estimate for blocks of size 2^( 5) =       0.000411955912
  error estimate for blocks of size 2^( 6) =       0.000415616796
  error estimate for blocks of size 2^( 7) =       0.000417771048

      target function =      -0.916778562203
              le_mean =     -17.214856645643
             les_mean =     296.648649712507
             stat err =       0.000413113434
             autocorr =       1.191921800275
   target nu stat err =       0.000413113434
   target dn stat err =       0.002170522418
      target stat err =       0.003473205044
              std dev =       0.535131399360
             le_variance =       0.286365614581


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721485664564e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916790796113       residual = 6.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916874857767       residual = 8.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916887159211       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916892067222       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916893117645       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916893416117       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916893584356       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916893588163       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916893602177       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916893595479       residual = 7.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 4.580268e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916790796113       residual = 6.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916816396981       residual = 8.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916819971173       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916821313700       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916821594458       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916821667963       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916821713252       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916821714797       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916821718045       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916821716386       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.336269e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916790796113       residual = 6.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916797565561       residual = 8.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916798496388       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916798839304       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916798910554       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916798928718       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916798940227       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916798940665       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916798941451       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916798941040       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.486574e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108501 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7133e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001 -3.761052e-02                3 1 ON  0
ci_002 -2.868242e-02                3 1 ON  1
ci_003 -2.365220e-02                3 1 ON  2
ci_004 2.082742e-02                 3 1 ON  3
ci_005 2.146618e-02                 3 1 ON  4
ci_006 -1.847008e-02                3 1 ON  5
ci_007 -1.844048e-02                3 1 ON  6
ci_008 -7.752039e-03                3 1 ON  7
ci_009 -1.402264e-02                3 1 ON  8
ci_010 -8.855924e-03                3 1 ON  9
ci_011 -9.098272e-03                3 1 ON  10
ci_012 -9.131230e-03                3 1 ON  11
ci_013 -1.917811e-02                3 1 ON  12
ci_014 1.117366e-02                 3 1 ON  13
ci_015 1.100170e-02                 3 1 ON  14
ci_016 1.601385e-02                 3 1 ON  15
ci_017 1.568850e-02                 3 1 ON  16
ci_018 9.108706e-03                 3 1 ON  17
ci_019 8.944708e-03                 3 1 ON  18
ci_020 1.508951e-02                 3 1 ON  19
ci_021 1.523428e-02                 3 1 ON  20
ci_022 8.225277e-03                 3 1 ON  21
ci_023 8.284875e-03                 3 1 ON  22
ci_024 8.534857e-03                 3 1 ON  23
ci_025 8.550087e-03                 3 1 ON  24
ci_026 1.000686e-02                 3 1 ON  25
ci_027 9.689055e-03                 3 1 ON  26
ci_028 -1.459942e-02                3 1 ON  27
ci_029 -1.495487e-02                3 1 ON  28
ci_030 -8.818066e-03                3 1 ON  29
ci_031 -8.607118e-03                3 1 ON  30
ci_032 -1.438990e-02                3 1 ON  31
ci_033 4.525837e-03                 3 1 ON  32
ci_034 4.876501e-03                 3 1 ON  33
ci_035 -3.337334e-03                3 1 ON  34
ci_036 -1.122247e-02                3 1 ON  35
ci_037 -1.153071e-02                3 1 ON  36
ci_038 8.962916e-04                 3 1 ON  37
ci_039 1.192685e-03                 3 1 ON  38
ci_040 -1.566796e-03                3 1 ON  39
ci_041 8.186082e-03                 3 1 ON  40
ci_042 8.261631e-03                 3 1 ON  41
ci_043 -2.339471e-03                3 1 ON  42
ci_044 -3.906479e-03                3 1 ON  43
ci_045 -1.867426e-03                3 1 ON  44
ci_046 4.761137e-03                 3 1 ON  45
ci_047 4.626049e-03                 3 1 ON  46
ci_048 -1.238200e-02                3 1 ON  47
ci_049 -1.292357e-02                3 1 ON  48
ci_050 2.810600e-03                 3 1 ON  49
ci_051 2.873843e-03                 3 1 ON  50
ci_052 -2.224155e-03                3 1 ON  51
ci_053 -2.257240e-03                3 1 ON  52
ci_054 -2.264594e-03                3 1 ON  53
ci_055 -2.365971e-03                3 1 ON  54
ci_056 4.649028e-03                 3 1 ON  55
ci_057 4.651861e-03                 3 1 ON  56
ci_058 -2.057022e-03                3 1 ON  57
ci_059 -2.062946e-03                3 1 ON  58
ci_060 4.766295e-03                 3 1 ON  59
ci_061 5.189981e-03                 3 1 ON  60
ci_062 -2.837642e-03                3 1 ON  61
ci_063 -2.774531e-03                3 1 ON  62
ci_064 -2.229250e-03                3 1 ON  63
ci_065 -3.386903e-03                3 1 ON  64
ci_066 4.052612e-03                 3 1 ON  65
ci_067 4.178059e-03                 3 1 ON  66
ci_068 -4.367124e-03                3 1 ON  67
ci_069 -4.072533e-03                3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2135
    reference variance = 0.41926
====================================================
  Execution time = 1.3462e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0483e-01
  Total weights = 1.9578e+06
  Execution time = 1.8602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290037466235
                                         uncertainty =       0.002689529920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290037466235
                                         uncertainty =       0.002689529920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380771462
  error estimate for blocks of size 2^( 2) =       0.000392151134
  error estimate for blocks of size 2^( 3) =       0.000402027650
  error estimate for blocks of size 2^( 4) =       0.000409771699
  error estimate for blocks of size 2^( 5) =       0.000414056140
  error estimate for blocks of size 2^( 6) =       0.000415761642
  error estimate for blocks of size 2^( 7) =       0.000417329874

      target function =      -0.903439516785
              le_mean =     -17.214992132656
             les_mean =     296.661934029525
             stat err =       0.000414229839
             autocorr =       1.183461067972
   target nu stat err =       0.000414229839
   target dn stat err =       0.003740973120
      target stat err =       0.005736083754
              std dev =       0.538492166125
             le_variance =       0.289973812978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290017121429
                                         uncertainty =       0.002713484212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290017121429
                                         uncertainty =       0.002713484212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380757869
  error estimate for blocks of size 2^( 2) =       0.000392157587
  error estimate for blocks of size 2^( 3) =       0.000402061559
  error estimate for blocks of size 2^( 4) =       0.000409827842
  error estimate for blocks of size 2^( 5) =       0.000414134033
  error estimate for blocks of size 2^( 6) =       0.000415844745
  error estimate for blocks of size 2^( 7) =       0.000417423749

      target function =      -0.852003705748
              le_mean =     -17.214992296265
             les_mean =     296.695888501382
             stat err =       0.000414307592
             autocorr =       1.183989928289
   target nu stat err =       0.000414307592
   target dn stat err =       0.034663245326
      target stat err =       0.047064637670
              std dev =       0.538472942853
             le_variance =       0.289953110185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290017462793
                                         uncertainty =       0.002703651282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290017462793
                                         uncertainty =       0.002703651282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380758188
  error estimate for blocks of size 2^( 2) =       0.000392150307
  error estimate for blocks of size 2^( 3) =       0.000402041392
  error estimate for blocks of size 2^( 4) =       0.000409798088
  error estimate for blocks of size 2^( 5) =       0.000414095722
  error estimate for blocks of size 2^( 6) =       0.000415803113
  error estimate for blocks of size 2^( 7) =       0.000417378236

      target function =      -0.905471874638
              le_mean =     -17.214990762335
             les_mean =     296.660557164722
             stat err =       0.000414268790
             autocorr =       1.183766183447
   target nu stat err =       0.000414268790
   target dn stat err =       0.003515556574
      target stat err =       0.005419796696
              std dev =       0.538473393075
             le_variance =       0.289953595050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290033786449
                                         uncertainty =       0.002691361025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290033786449
                                         uncertainty =       0.002691361025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380769028
  error estimate for blocks of size 2^( 2) =       0.000392150340
  error estimate for blocks of size 2^( 3) =       0.000402028780
  error estimate for blocks of size 2^( 4) =       0.000409774468
  error estimate for blocks of size 2^( 5) =       0.000414060594
  error estimate for blocks of size 2^( 6) =       0.000415766269
  error estimate for blocks of size 2^( 7) =       0.000417335334

      target function =      -0.904404956009
              le_mean =     -17.214991821446
             les_mean =     296.661291193102
             stat err =       0.000414234166
             autocorr =       1.183500926253
   target nu stat err =       0.000414234166
   target dn stat err =       0.003612506440
      target stat err =       0.005553810705
              std dev =       0.538488723726
             le_variance =       0.289970105580


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.903439516785        initial
     2.5000e-01     2.5000e+00             4.5803e-04        -0.852003705748
     1.0000e+00     1.0000e+01             1.3363e-04        -0.905471874638  <--
     4.0000e+00     4.0000e+01             3.4866e-05        -0.904404956009

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.2825e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001                -3.761052e-02 3 1  ON 0
ci_002                -2.868242e-02 3 1  ON 1
ci_003                -2.365220e-02 3 1  ON 2
ci_004                 2.082742e-02 3 1  ON 3
ci_005                 2.146618e-02 3 1  ON 4
ci_006                -1.847008e-02 3 1  ON 5
ci_007                -1.844048e-02 3 1  ON 6
ci_008                -7.752039e-03 3 1  ON 7
ci_009                -1.402264e-02 3 1  ON 8
ci_010                -8.855924e-03 3 1  ON 9
ci_011                -9.098272e-03 3 1  ON 10
ci_012                -9.131230e-03 3 1  ON 11
ci_013                -1.917811e-02 3 1  ON 12
ci_014                 1.117366e-02 3 1  ON 13
ci_015                 1.100170e-02 3 1  ON 14
ci_016                 1.601385e-02 3 1  ON 15
ci_017                 1.568850e-02 3 1  ON 16
ci_018                 9.108706e-03 3 1  ON 17
ci_019                 8.944708e-03 3 1  ON 18
ci_020                 1.508951e-02 3 1  ON 19
ci_021                 1.523428e-02 3 1  ON 20
ci_022                 8.225277e-03 3 1  ON 21
ci_023                 8.284875e-03 3 1  ON 22
ci_024                 8.534857e-03 3 1  ON 23
ci_025                 8.550087e-03 3 1  ON 24
ci_026                 1.000686e-02 3 1  ON 25
ci_027                 9.689055e-03 3 1  ON 26
ci_028                -1.459942e-02 3 1  ON 27
ci_029                -1.495487e-02 3 1  ON 28
ci_030                -8.818066e-03 3 1  ON 29
ci_031                -8.607118e-03 3 1  ON 30
ci_032                -1.438990e-02 3 1  ON 31
ci_033                 4.525837e-03 3 1  ON 32
ci_034                 4.876501e-03 3 1  ON 33
ci_035                -3.337334e-03 3 1  ON 34
ci_036                -1.122247e-02 3 1  ON 35
ci_037                -1.153071e-02 3 1  ON 36
ci_038                 8.962916e-04 3 1  ON 37
ci_039                 1.192685e-03 3 1  ON 38
ci_040                -1.566796e-03 3 1  ON 39
ci_041                 8.186082e-03 3 1  ON 40
ci_042                 8.261631e-03 3 1  ON 41
ci_043                -2.339471e-03 3 1  ON 42
ci_044                -3.906479e-03 3 1  ON 43
ci_045                -1.867426e-03 3 1  ON 44
ci_046                 4.761137e-03 3 1  ON 45
ci_047                 4.626049e-03 3 1  ON 46
ci_048                -1.238200e-02 3 1  ON 47
ci_049                -1.292357e-02 3 1  ON 48
ci_050                 2.810600e-03 3 1  ON 49
ci_051                 2.873843e-03 3 1  ON 50
ci_052                -2.224155e-03 3 1  ON 51
ci_053                -2.257240e-03 3 1  ON 52
ci_054                -2.264594e-03 3 1  ON 53
ci_055                -2.365971e-03 3 1  ON 54
ci_056                 4.649028e-03 3 1  ON 55
ci_057                 4.651861e-03 3 1  ON 56
ci_058                -2.057022e-03 3 1  ON 57
ci_059                -2.062946e-03 3 1  ON 58
ci_060                 4.766295e-03 3 1  ON 59
ci_061                 5.189981e-03 3 1  ON 60
ci_062                -2.837642e-03 3 1  ON 61
ci_063                -2.774531e-03 3 1  ON 62
ci_064                -2.229250e-03 3 1  ON 63
ci_065                -3.386903e-03 3 1  ON 64
ci_066                 4.052612e-03 3 1  ON 65
ci_067                 4.178059e-03 3 1  ON 66
ci_068                -4.367124e-03 3 1  ON 67
ci_069                -4.072533e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9966e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2136
    reference variance = 0.273252
====================================================
  Execution time = 1.3809e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0612e-01
  Total weights = 1.957682073e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5462e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289081971736
                                         uncertainty =       0.001753424819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289081971736
                                         uncertainty =       0.001753424819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380135776
  error estimate for blocks of size 2^( 2) =       0.000391390304
  error estimate for blocks of size 2^( 3) =       0.000402153206
  error estimate for blocks of size 2^( 4) =       0.000409750175
  error estimate for blocks of size 2^( 5) =       0.000415451362
  error estimate for blocks of size 2^( 6) =       0.000416949091
  error estimate for blocks of size 2^( 7) =       0.000418020627

      target function =      -0.903258241066
              le_mean =     -17.214237532704
             les_mean =     296.636093151827
             stat err =       0.000415042814
             autocorr =       1.192087975973
   target nu stat err =       0.000415042814
   target dn stat err =       0.004116466063
      target stat err =       0.006292533247
              std dev =       0.537593170488
             le_variance =       0.289006416956


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721423753270e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903301392970       residual = 3.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903588574007       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903615499909       residual = 4.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903625078482       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903627421336       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903627747711       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903628250671       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903628236636       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903628213512       residual = 7.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903628213234       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.903628213973       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 4.883844e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903301392970       residual = 3.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903388226957       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903395956507       residual = 4.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903398687155       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903399295822       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903399352982       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903399483321       residual = 9.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903399478806       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903399473586       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903399472280       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.903399473203       residual = 1.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.480593e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903301392970       residual = 3.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903324300676       residual = 2.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903326306484       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903327013407       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903327166247       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903327178415       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903327210987       residual = 9.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903327209944       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903327208662       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903327208246       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.903327208534       residual = 1.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.908980e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.113352 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6366e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -3.757065e-02 3 1  ON 0
ci_002                -2.877812e-02 3 1  ON 1
ci_003                -2.364987e-02 3 1  ON 2
ci_004                 2.077676e-02 3 1  ON 3
ci_005                 2.139075e-02 3 1  ON 4
ci_006                -1.844136e-02 3 1  ON 5
ci_007                -1.852247e-02 3 1  ON 6
ci_008                -7.789010e-03 3 1  ON 7
ci_009                -1.394616e-02 3 1  ON 8
ci_010                -8.906384e-03 3 1  ON 9
ci_011                -8.998352e-03 3 1  ON 10
ci_012                -9.135905e-03 3 1  ON 11
ci_013                -1.910240e-02 3 1  ON 12
ci_014                 1.114890e-02 3 1  ON 13
ci_015                 1.096940e-02 3 1  ON 14
ci_016                 1.596444e-02 3 1  ON 15
ci_017                 1.563560e-02 3 1  ON 16
ci_018                 9.123161e-03 3 1  ON 17
ci_019                 8.910516e-03 3 1  ON 18
ci_020                 1.508846e-02 3 1  ON 19
ci_021                 1.522514e-02 3 1  ON 20
ci_022                 8.267609e-03 3 1  ON 21
ci_023                 8.296679e-03 3 1  ON 22
ci_024                 8.486637e-03 3 1  ON 23
ci_025                 8.528998e-03 3 1  ON 24
ci_026                 9.976227e-03 3 1  ON 25
ci_027                 9.640280e-03 3 1  ON 26
ci_028                -1.455207e-02 3 1  ON 27
ci_029                -1.487228e-02 3 1  ON 28
ci_030                -8.831007e-03 3 1  ON 29
ci_031                -8.649527e-03 3 1  ON 30
ci_032                -1.432945e-02 3 1  ON 31
ci_033                 4.539549e-03 3 1  ON 32
ci_034                 4.905384e-03 3 1  ON 33
ci_035                -3.340441e-03 3 1  ON 34
ci_036                -1.115331e-02 3 1  ON 35
ci_037                -1.149959e-02 3 1  ON 36
ci_038                 9.014120e-04 3 1  ON 37
ci_039                 1.175296e-03 3 1  ON 38
ci_040                -1.526390e-03 3 1  ON 39
ci_041                 8.233505e-03 3 1  ON 40
ci_042                 8.209882e-03 3 1  ON 41
ci_043                -2.358132e-03 3 1  ON 42
ci_044                -3.903936e-03 3 1  ON 43
ci_045                -2.015485e-03 3 1  ON 44
ci_046                 4.817497e-03 3 1  ON 45
ci_047                 4.623207e-03 3 1  ON 46
ci_048                -1.233974e-02 3 1  ON 47
ci_049                -1.295975e-02 3 1  ON 48
ci_050                 2.821788e-03 3 1  ON 49
ci_051                 2.967962e-03 3 1  ON 50
ci_052                -2.185443e-03 3 1  ON 51
ci_053                -2.246148e-03 3 1  ON 52
ci_054                -2.242047e-03 3 1  ON 53
ci_055                -2.426931e-03 3 1  ON 54
ci_056                 4.665704e-03 3 1  ON 55
ci_057                 4.610822e-03 3 1  ON 56
ci_058                -2.108531e-03 3 1  ON 57
ci_059                -2.053059e-03 3 1  ON 58
ci_060                 4.810102e-03 3 1  ON 59
ci_061                 5.216185e-03 3 1  ON 60
ci_062                -2.964254e-03 3 1  ON 61
ci_063                -2.806897e-03 3 1  ON 62
ci_064                -2.258560e-03 3 1  ON 63
ci_065                -3.383855e-03 3 1  ON 64
ci_066                 4.084102e-03 3 1  ON 65
ci_067                 4.291814e-03 3 1  ON 66
ci_068                -4.311930e-03 3 1  ON 67
ci_069                -4.058175e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2101
    reference variance = 0.387028
====================================================
  Execution time = 1.3556e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9781e-01
  Total weights = 1.9577e+06
  Execution time = 1.8587e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286523394551
                                         uncertainty =       0.001478597879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286523394551
                                         uncertainty =       0.001478597879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378454087
  error estimate for blocks of size 2^( 2) =       0.000389736595
  error estimate for blocks of size 2^( 3) =       0.000399651850
  error estimate for blocks of size 2^( 4) =       0.000407077214
  error estimate for blocks of size 2^( 5) =       0.000410512014
  error estimate for blocks of size 2^( 6) =       0.000412661007
  error estimate for blocks of size 2^( 7) =       0.000413013345

      target function =      -0.914205540626
              le_mean =     -17.214912364014
             les_mean =     296.652213312406
             stat err =       0.000410815895
             autocorr =       1.178333102678
   target nu stat err =       0.000410815895
   target dn stat err =       0.002249866062
      target stat err =       0.003574853837
              std dev =       0.535214902141
             le_variance =       0.286454991474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286556975059
                                         uncertainty =       0.001468181532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286556975059
                                         uncertainty =       0.001468181532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378476151
  error estimate for blocks of size 2^( 2) =       0.000389766633
  error estimate for blocks of size 2^( 3) =       0.000399679718
  error estimate for blocks of size 2^( 4) =       0.000407111968
  error estimate for blocks of size 2^( 5) =       0.000410575075
  error estimate for blocks of size 2^( 6) =       0.000412717474
  error estimate for blocks of size 2^( 7) =       0.000413076052

      target function =      -0.916056649483
              le_mean =     -17.214906869471
             les_mean =     296.650840885471
             stat err =       0.000410870142
             autocorr =       1.178506898268
   target nu stat err =       0.000410870142
   target dn stat err =       0.001926818727
      target stat err =       0.003094978037
              std dev =       0.535246105273
             le_variance =       0.286488393210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286533545806
                                         uncertainty =       0.001472055268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286533545806
                                         uncertainty =       0.001472055268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378460729
  error estimate for blocks of size 2^( 2) =       0.000389747820
  error estimate for blocks of size 2^( 3) =       0.000399661642
  error estimate for blocks of size 2^( 4) =       0.000407091230
  error estimate for blocks of size 2^( 5) =       0.000410543186
  error estimate for blocks of size 2^( 6) =       0.000412687689
  error estimate for blocks of size 2^( 7) =       0.000413043950

      target function =      -0.916139385519
              le_mean =     -17.214907503284
             les_mean =     296.650809769965
             stat err =       0.000410841514
             autocorr =       1.178438703868
   target nu stat err =       0.000410841514
   target dn stat err =       0.001933398346
      target stat err =       0.003105543718
              std dev =       0.535224296232
             le_variance =       0.286465047277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286522947190
                                         uncertainty =       0.001477688986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286522947190
                                         uncertainty =       0.001477688986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378453784
  error estimate for blocks of size 2^( 2) =       0.000389736930
  error estimate for blocks of size 2^( 3) =       0.000399652052
  error estimate for blocks of size 2^( 4) =       0.000407077926
  error estimate for blocks of size 2^( 5) =       0.000410514880
  error estimate for blocks of size 2^( 6) =       0.000412662939
  error estimate for blocks of size 2^( 7) =       0.000413016686

      target function =      -0.915987321881
              le_mean =     -17.214911398923
             les_mean =     296.651040944992
             stat err =       0.000410818108
             autocorr =       1.178347683739
   target nu stat err =       0.000410818108
   target dn stat err =       0.001944946902
      target stat err =       0.003122152919
              std dev =       0.535214473545
             le_variance =       0.286454532692


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914205540626        initial
     2.5000e-01     2.5000e+00             4.8838e-04        -0.916056649483
     1.0000e+00     1.0000e+01             1.4806e-04        -0.916139385519  <--
     4.0000e+00     4.0000e+01             3.9090e-05        -0.915987321881

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.2935e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -3.757065e-02 3 1  ON 0
ci_002                -2.877812e-02 3 1  ON 1
ci_003                -2.364987e-02 3 1  ON 2
ci_004                 2.077676e-02 3 1  ON 3
ci_005                 2.139075e-02 3 1  ON 4
ci_006                -1.844136e-02 3 1  ON 5
ci_007                -1.852247e-02 3 1  ON 6
ci_008                -7.789010e-03 3 1  ON 7
ci_009                -1.394616e-02 3 1  ON 8
ci_010                -8.906384e-03 3 1  ON 9
ci_011                -8.998352e-03 3 1  ON 10
ci_012                -9.135905e-03 3 1  ON 11
ci_013                -1.910240e-02 3 1  ON 12
ci_014                 1.114890e-02 3 1  ON 13
ci_015                 1.096940e-02 3 1  ON 14
ci_016                 1.596444e-02 3 1  ON 15
ci_017                 1.563560e-02 3 1  ON 16
ci_018                 9.123161e-03 3 1  ON 17
ci_019                 8.910516e-03 3 1  ON 18
ci_020                 1.508846e-02 3 1  ON 19
ci_021                 1.522514e-02 3 1  ON 20
ci_022                 8.267609e-03 3 1  ON 21
ci_023                 8.296679e-03 3 1  ON 22
ci_024                 8.486637e-03 3 1  ON 23
ci_025                 8.528998e-03 3 1  ON 24
ci_026                 9.976227e-03 3 1  ON 25
ci_027                 9.640280e-03 3 1  ON 26
ci_028                -1.455207e-02 3 1  ON 27
ci_029                -1.487228e-02 3 1  ON 28
ci_030                -8.831007e-03 3 1  ON 29
ci_031                -8.649527e-03 3 1  ON 30
ci_032                -1.432945e-02 3 1  ON 31
ci_033                 4.539549e-03 3 1  ON 32
ci_034                 4.905384e-03 3 1  ON 33
ci_035                -3.340441e-03 3 1  ON 34
ci_036                -1.115331e-02 3 1  ON 35
ci_037                -1.149959e-02 3 1  ON 36
ci_038                 9.014120e-04 3 1  ON 37
ci_039                 1.175296e-03 3 1  ON 38
ci_040                -1.526390e-03 3 1  ON 39
ci_041                 8.233505e-03 3 1  ON 40
ci_042                 8.209882e-03 3 1  ON 41
ci_043                -2.358132e-03 3 1  ON 42
ci_044                -3.903936e-03 3 1  ON 43
ci_045                -2.015485e-03 3 1  ON 44
ci_046                 4.817497e-03 3 1  ON 45
ci_047                 4.623207e-03 3 1  ON 46
ci_048                -1.233974e-02 3 1  ON 47
ci_049                -1.295975e-02 3 1  ON 48
ci_050                 2.821788e-03 3 1  ON 49
ci_051                 2.967962e-03 3 1  ON 50
ci_052                -2.185443e-03 3 1  ON 51
ci_053                -2.246148e-03 3 1  ON 52
ci_054                -2.242047e-03 3 1  ON 53
ci_055                -2.426931e-03 3 1  ON 54
ci_056                 4.665704e-03 3 1  ON 55
ci_057                 4.610822e-03 3 1  ON 56
ci_058                -2.108531e-03 3 1  ON 57
ci_059                -2.053059e-03 3 1  ON 58
ci_060                 4.810102e-03 3 1  ON 59
ci_061                 5.216185e-03 3 1  ON 60
ci_062                -2.964254e-03 3 1  ON 61
ci_063                -2.806897e-03 3 1  ON 62
ci_064                -2.258560e-03 3 1  ON 63
ci_065                -3.383855e-03 3 1  ON 64
ci_066                 4.084102e-03 3 1  ON 65
ci_067                 4.291814e-03 3 1  ON 66
ci_068                -4.311930e-03 3 1  ON 67
ci_069                -4.058175e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9308e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2902
    reference variance = 0.747303
====================================================
  Execution time = 1.3793e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0001e-01
  Total weights = 1.957800273e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5493e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289055384787
                                         uncertainty =       0.001856479393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289055384787
                                         uncertainty =       0.001856479393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380148977
  error estimate for blocks of size 2^( 2) =       0.000391178000
  error estimate for blocks of size 2^( 3) =       0.000401825062
  error estimate for blocks of size 2^( 4) =       0.000410379807
  error estimate for blocks of size 2^( 5) =       0.000415858516
  error estimate for blocks of size 2^( 6) =       0.000416981827
  error estimate for blocks of size 2^( 7) =       0.000420758351

      target function =      -0.912647082357
              le_mean =     -17.214900785810
             les_mean =     296.652817791758
             stat err =       0.000415994625
             autocorr =       1.197478671109
   target nu stat err =       0.000415994625
   target dn stat err =       0.002120395417
      target stat err =       0.003367763752
              std dev =       0.537611838976
             le_variance =       0.289026489407


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721490078581e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912658543310       residual = 6.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912729320919       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912743593027       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912747585049       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912748717962       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912748448704       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912748657600       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912748689373       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912748678163       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912748677700       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 3.676773e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912658543310       residual = 6.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912680121969       residual = 9.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912684289961       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912685388815       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912685690123       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912685610730       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912685665870       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912685672069       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912685669082       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912685669168       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.074711e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912658543310       residual = 6.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912664251198       residual = 9.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912665338406       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912665619611       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912665695835       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912665675306       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912665688994       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912665690624       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912665689757       residual = 9.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 2.804088e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.117017 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6352e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -3.751574e-02 3 1  ON 0
ci_002                -2.876526e-02 3 1  ON 1
ci_003                -2.368129e-02 3 1  ON 2
ci_004                 2.074819e-02 3 1  ON 3
ci_005                 2.132563e-02 3 1  ON 4
ci_006                -1.844324e-02 3 1  ON 5
ci_007                -1.850240e-02 3 1  ON 6
ci_008                -7.784710e-03 3 1  ON 7
ci_009                -1.393470e-02 3 1  ON 8
ci_010                -8.947249e-03 3 1  ON 9
ci_011                -8.965147e-03 3 1  ON 10
ci_012                -9.102512e-03 3 1  ON 11
ci_013                -1.910732e-02 3 1  ON 12
ci_014                 1.114452e-02 3 1  ON 13
ci_015                 1.091549e-02 3 1  ON 14
ci_016                 1.591324e-02 3 1  ON 15
ci_017                 1.560759e-02 3 1  ON 16
ci_018                 9.125905e-03 3 1  ON 17
ci_019                 8.921576e-03 3 1  ON 18
ci_020                 1.509548e-02 3 1  ON 19
ci_021                 1.524798e-02 3 1  ON 20
ci_022                 8.250114e-03 3 1  ON 21
ci_023                 8.279072e-03 3 1  ON 22
ci_024                 8.388218e-03 3 1  ON 23
ci_025                 8.517814e-03 3 1  ON 24
ci_026                 9.909131e-03 3 1  ON 25
ci_027                 9.593511e-03 3 1  ON 26
ci_028                -1.453438e-02 3 1  ON 27
ci_029                -1.484084e-02 3 1  ON 28
ci_030                -8.786043e-03 3 1  ON 29
ci_031                -8.668637e-03 3 1  ON 30
ci_032                -1.431774e-02 3 1  ON 31
ci_033                 4.553967e-03 3 1  ON 32
ci_034                 4.887227e-03 3 1  ON 33
ci_035                -3.331833e-03 3 1  ON 34
ci_036                -1.107525e-02 3 1  ON 35
ci_037                -1.146453e-02 3 1  ON 36
ci_038                 9.031315e-04 3 1  ON 37
ci_039                 1.175781e-03 3 1  ON 38
ci_040                -1.532148e-03 3 1  ON 39
ci_041                 8.208281e-03 3 1  ON 40
ci_042                 8.188214e-03 3 1  ON 41
ci_043                -2.345461e-03 3 1  ON 42
ci_044                -3.950200e-03 3 1  ON 43
ci_045                -2.018790e-03 3 1  ON 44
ci_046                 4.822669e-03 3 1  ON 45
ci_047                 4.598311e-03 3 1  ON 46
ci_048                -1.244721e-02 3 1  ON 47
ci_049                -1.296937e-02 3 1  ON 48
ci_050                 2.854415e-03 3 1  ON 49
ci_051                 3.013512e-03 3 1  ON 50
ci_052                -2.206058e-03 3 1  ON 51
ci_053                -2.256716e-03 3 1  ON 52
ci_054                -2.227936e-03 3 1  ON 53
ci_055                -2.403872e-03 3 1  ON 54
ci_056                 4.653431e-03 3 1  ON 55
ci_057                 4.634183e-03 3 1  ON 56
ci_058                -2.063796e-03 3 1  ON 57
ci_059                -2.032672e-03 3 1  ON 58
ci_060                 4.778263e-03 3 1  ON 59
ci_061                 5.124472e-03 3 1  ON 60
ci_062                -2.976625e-03 3 1  ON 61
ci_063                -2.851052e-03 3 1  ON 62
ci_064                -2.227179e-03 3 1  ON 63
ci_065                -3.373685e-03 3 1  ON 64
ci_066                 4.154746e-03 3 1  ON 65
ci_067                 4.303876e-03 3 1  ON 66
ci_068                -4.349930e-03 3 1  ON 67
ci_069                -4.092756e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2005
    reference variance = 0.331698
====================================================
  Execution time = 1.3511e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0181e-01
  Total weights = 1.9578e+06
  Execution time = 1.8509e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287867328310
                                         uncertainty =       0.001564650511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287867328310
                                         uncertainty =       0.001564650511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379436377
  error estimate for blocks of size 2^( 2) =       0.000390442765
  error estimate for blocks of size 2^( 3) =       0.000400730360
  error estimate for blocks of size 2^( 4) =       0.000408624668
  error estimate for blocks of size 2^( 5) =       0.000413634571
  error estimate for blocks of size 2^( 6) =       0.000416339515
  error estimate for blocks of size 2^( 7) =       0.000418202476

      target function =      -0.910246967054
              le_mean =     -17.214207473944
             les_mean =     296.630513962396
             stat err =       0.000414200308
             autocorr =       1.191634053066
   target nu stat err =       0.000414200308
   target dn stat err =       0.002244123237
      target stat err =       0.003532351850
              std dev =       0.536604069778
             le_variance =       0.287943927702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287881956972
                                         uncertainty =       0.001568916273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287881956972
                                         uncertainty =       0.001568916273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379445479
  error estimate for blocks of size 2^( 2) =       0.000390466815
  error estimate for blocks of size 2^( 3) =       0.000400773632
  error estimate for blocks of size 2^( 4) =       0.000408675001
  error estimate for blocks of size 2^( 5) =       0.000413704130
  error estimate for blocks of size 2^( 6) =       0.000416402164
  error estimate for blocks of size 2^( 7) =       0.000418242127

      target function =      -0.907325344151
              le_mean =     -17.214208647498
             les_mean =     296.632451056238
             stat err =       0.000414255856
             autocorr =       1.191896507204
   target nu stat err =       0.000414255856
   target dn stat err =       0.002646763347
      target stat err =       0.004116812134
              std dev =       0.536616942191
             le_variance =       0.287957742647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287871265826
                                         uncertainty =       0.001567228466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287871265826
                                         uncertainty =       0.001567228466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379438667
  error estimate for blocks of size 2^( 2) =       0.000390454272
  error estimate for blocks of size 2^( 3) =       0.000400753235
  error estimate for blocks of size 2^( 4) =       0.000408651999
  error estimate for blocks of size 2^( 5) =       0.000413673246
  error estimate for blocks of size 2^( 6) =       0.000416374277
  error estimate for blocks of size 2^( 7) =       0.000418222694

      target function =      -0.908249559040
              le_mean =     -17.214207389724
             les_mean =     296.631806731196
             stat err =       0.000414230554
             autocorr =       1.191793703059
   target nu stat err =       0.000414230554
   target dn stat err =       0.002494978888
      target stat err =       0.003895518313
              std dev =       0.536607309440
             le_variance =       0.287947404545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287867015998
                                         uncertainty =       0.001564975030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287867015998
                                         uncertainty =       0.001564975030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379436132
  error estimate for blocks of size 2^( 2) =       0.000390443721
  error estimate for blocks of size 2^( 3) =       0.000400732819
  error estimate for blocks of size 2^( 4) =       0.000408627727
  error estimate for blocks of size 2^( 5) =       0.000413639140
  error estimate for blocks of size 2^( 6) =       0.000416343558
  error estimate for blocks of size 2^( 7) =       0.000418204558

      target function =      -0.910200389926
              le_mean =     -17.214207391852
             les_mean =     296.630541315645
             stat err =       0.000414203746
             autocorr =       1.191655374286
   target nu stat err =       0.000414203746
   target dn stat err =       0.002246478260
      target stat err =       0.003535558437
              std dev =       0.536603723509
             le_variance =       0.287943556084


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910246967054        initial  <--
     2.5000e-01     2.5000e+00             3.6768e-04        -0.907325344151
     1.0000e+00     1.0000e+01             1.0747e-04        -0.908249559040
     4.0000e+00     4.0000e+01             2.8041e-05        -0.910200389926

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8343
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -3.757065e-02 3 1  ON 0
ci_002                -2.877812e-02 3 1  ON 1
ci_003                -2.364987e-02 3 1  ON 2
ci_004                 2.077676e-02 3 1  ON 3
ci_005                 2.139075e-02 3 1  ON 4
ci_006                -1.844136e-02 3 1  ON 5
ci_007                -1.852247e-02 3 1  ON 6
ci_008                -7.789010e-03 3 1  ON 7
ci_009                -1.394616e-02 3 1  ON 8
ci_010                -8.906384e-03 3 1  ON 9
ci_011                -8.998352e-03 3 1  ON 10
ci_012                -9.135905e-03 3 1  ON 11
ci_013                -1.910240e-02 3 1  ON 12
ci_014                 1.114890e-02 3 1  ON 13
ci_015                 1.096940e-02 3 1  ON 14
ci_016                 1.596444e-02 3 1  ON 15
ci_017                 1.563560e-02 3 1  ON 16
ci_018                 9.123161e-03 3 1  ON 17
ci_019                 8.910516e-03 3 1  ON 18
ci_020                 1.508846e-02 3 1  ON 19
ci_021                 1.522514e-02 3 1  ON 20
ci_022                 8.267609e-03 3 1  ON 21
ci_023                 8.296679e-03 3 1  ON 22
ci_024                 8.486637e-03 3 1  ON 23
ci_025                 8.528998e-03 3 1  ON 24
ci_026                 9.976227e-03 3 1  ON 25
ci_027                 9.640280e-03 3 1  ON 26
ci_028                -1.455207e-02 3 1  ON 27
ci_029                -1.487228e-02 3 1  ON 28
ci_030                -8.831007e-03 3 1  ON 29
ci_031                -8.649527e-03 3 1  ON 30
ci_032                -1.432945e-02 3 1  ON 31
ci_033                 4.539549e-03 3 1  ON 32
ci_034                 4.905384e-03 3 1  ON 33
ci_035                -3.340441e-03 3 1  ON 34
ci_036                -1.115331e-02 3 1  ON 35
ci_037                -1.149959e-02 3 1  ON 36
ci_038                 9.014120e-04 3 1  ON 37
ci_039                 1.175296e-03 3 1  ON 38
ci_040                -1.526390e-03 3 1  ON 39
ci_041                 8.233505e-03 3 1  ON 40
ci_042                 8.209882e-03 3 1  ON 41
ci_043                -2.358132e-03 3 1  ON 42
ci_044                -3.903936e-03 3 1  ON 43
ci_045                -2.015485e-03 3 1  ON 44
ci_046                 4.817497e-03 3 1  ON 45
ci_047                 4.623207e-03 3 1  ON 46
ci_048                -1.233974e-02 3 1  ON 47
ci_049                -1.295975e-02 3 1  ON 48
ci_050                 2.821788e-03 3 1  ON 49
ci_051                 2.967962e-03 3 1  ON 50
ci_052                -2.185443e-03 3 1  ON 51
ci_053                -2.246148e-03 3 1  ON 52
ci_054                -2.242047e-03 3 1  ON 53
ci_055                -2.426931e-03 3 1  ON 54
ci_056                 4.665704e-03 3 1  ON 55
ci_057                 4.610822e-03 3 1  ON 56
ci_058                -2.108531e-03 3 1  ON 57
ci_059                -2.053059e-03 3 1  ON 58
ci_060                 4.810102e-03 3 1  ON 59
ci_061                 5.216185e-03 3 1  ON 60
ci_062                -2.964254e-03 3 1  ON 61
ci_063                -2.806897e-03 3 1  ON 62
ci_064                -2.258560e-03 3 1  ON 63
ci_065                -3.383855e-03 3 1  ON 64
ci_066                 4.084102e-03 3 1  ON 65
ci_067                 4.291814e-03 3 1  ON 66
ci_068                -4.311930e-03 3 1  ON 67
ci_069                -4.058175e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9192e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1466
    reference variance = 0.252624
====================================================
  Execution time = 1.3780e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5312e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0019e-01
  Total weights = 1.957852364e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284506075824
                                         uncertainty =       0.001494586338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284506075824
                                         uncertainty =       0.001494586338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377091554
  error estimate for blocks of size 2^( 2) =       0.000388661803
  error estimate for blocks of size 2^( 3) =       0.000399657478
  error estimate for blocks of size 2^( 4) =       0.000406920317
  error estimate for blocks of size 2^( 5) =       0.000411109142
  error estimate for blocks of size 2^( 6) =       0.000413418352
  error estimate for blocks of size 2^( 7) =       0.000416951535

      target function =      -0.912347737472
              le_mean =     -17.215013688931
             les_mean =     296.656883019788
             stat err =       0.000412099836
             autocorr =       1.194294060410
   target nu stat err =       0.000412099836
   target dn stat err =       0.003419777682
      target stat err =       0.005354073415
              std dev =       0.533287990616
             le_variance =       0.284396080936


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721501368893e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912378159246       residual = 7.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912389520890       residual = 7.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912390827817       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912391260326       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912391371975       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912391368277       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912391367024       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912391368567       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912391368934       residual = 9.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 4.127605e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912378159246       residual = 7.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912381065479       residual = 7.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912381397921       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912381507130       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912381535339       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912381534414       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912381534078       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912381534465       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912381534558       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.050814e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912378159246       residual = 7.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912378890038       residual = 7.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912378973513       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912379000882       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912379007953       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912379007722       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912379007636       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912379007733       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912379007757       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 2.639128e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120086 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6301e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -3.757133e-02 3 1  ON 0
ci_002                -2.877670e-02 3 1  ON 1
ci_003                -2.365127e-02 3 1  ON 2
ci_004                 2.077874e-02 3 1  ON 3
ci_005                 2.138942e-02 3 1  ON 4
ci_006                -1.843972e-02 3 1  ON 5
ci_007                -1.852376e-02 3 1  ON 6
ci_008                -7.783942e-03 3 1  ON 7
ci_009                -1.394553e-02 3 1  ON 8
ci_010                -8.913139e-03 3 1  ON 9
ci_011                -8.997329e-03 3 1  ON 10
ci_012                -9.135896e-03 3 1  ON 11
ci_013                -1.910125e-02 3 1  ON 12
ci_014                 1.115074e-02 3 1  ON 13
ci_015                 1.096625e-02 3 1  ON 14
ci_016                 1.596554e-02 3 1  ON 15
ci_017                 1.563172e-02 3 1  ON 16
ci_018                 9.130898e-03 3 1  ON 17
ci_019                 8.912551e-03 3 1  ON 18
ci_020                 1.508266e-02 3 1  ON 19
ci_021                 1.521884e-02 3 1  ON 20
ci_022                 8.273033e-03 3 1  ON 21
ci_023                 8.295337e-03 3 1  ON 22
ci_024                 8.476129e-03 3 1  ON 23
ci_025                 8.523713e-03 3 1  ON 24
ci_026                 9.974761e-03 3 1  ON 25
ci_027                 9.646646e-03 3 1  ON 26
ci_028                -1.454828e-02 3 1  ON 27
ci_029                -1.486982e-02 3 1  ON 28
ci_030                -8.827454e-03 3 1  ON 29
ci_031                -8.648924e-03 3 1  ON 30
ci_032                -1.432663e-02 3 1  ON 31
ci_033                 4.537098e-03 3 1  ON 32
ci_034                 4.904073e-03 3 1  ON 33
ci_035                -3.337394e-03 3 1  ON 34
ci_036                -1.115759e-02 3 1  ON 35
ci_037                -1.149130e-02 3 1  ON 36
ci_038                 9.025680e-04 3 1  ON 37
ci_039                 1.169240e-03 3 1  ON 38
ci_040                -1.526641e-03 3 1  ON 39
ci_041                 8.226065e-03 3 1  ON 40
ci_042                 8.207339e-03 3 1  ON 41
ci_043                -2.354572e-03 3 1  ON 42
ci_044                -3.907502e-03 3 1  ON 43
ci_045                -2.012420e-03 3 1  ON 44
ci_046                 4.824365e-03 3 1  ON 45
ci_047                 4.625582e-03 3 1  ON 46
ci_048                -1.234692e-02 3 1  ON 47
ci_049                -1.295516e-02 3 1  ON 48
ci_050                 2.826764e-03 3 1  ON 49
ci_051                 2.971156e-03 3 1  ON 50
ci_052                -2.181918e-03 3 1  ON 51
ci_053                -2.250135e-03 3 1  ON 52
ci_054                -2.236605e-03 3 1  ON 53
ci_055                -2.423462e-03 3 1  ON 54
ci_056                 4.663697e-03 3 1  ON 55
ci_057                 4.613168e-03 3 1  ON 56
ci_058                -2.107517e-03 3 1  ON 57
ci_059                -2.053172e-03 3 1  ON 58
ci_060                 4.815846e-03 3 1  ON 59
ci_061                 5.218412e-03 3 1  ON 60
ci_062                -2.962484e-03 3 1  ON 61
ci_063                -2.810348e-03 3 1  ON 62
ci_064                -2.261672e-03 3 1  ON 63
ci_065                -3.383815e-03 3 1  ON 64
ci_066                 4.083501e-03 3 1  ON 65
ci_067                 4.292125e-03 3 1  ON 66
ci_068                -4.307154e-03 3 1  ON 67
ci_069                -4.058668e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2207
    reference variance = 0.179422
====================================================
  Execution time = 1.3492e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0169e-01
  Total weights = 1.9580e+06
  Execution time = 1.8541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287898451421
                                         uncertainty =       0.001846477283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287898451421
                                         uncertainty =       0.001846477283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379432838
  error estimate for blocks of size 2^( 2) =       0.000390872367
  error estimate for blocks of size 2^( 3) =       0.000401703076
  error estimate for blocks of size 2^( 4) =       0.000409830941
  error estimate for blocks of size 2^( 5) =       0.000414195662
  error estimate for blocks of size 2^( 6) =       0.000418266989
  error estimate for blocks of size 2^( 7) =       0.000419982291

      target function =      -0.909828924470
              le_mean =     -17.214290369609
             les_mean =     296.633635390302
             stat err =       0.000415568971
             autocorr =       1.199544593779
   target nu stat err =       0.000415568971
   target dn stat err =       0.002431078493
      target stat err =       0.003813018497
              std dev =       0.536599065038
             le_variance =       0.287938556600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287901488160
                                         uncertainty =       0.001847254452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287901488160
                                         uncertainty =       0.001847254452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379434805
  error estimate for blocks of size 2^( 2) =       0.000390873761
  error estimate for blocks of size 2^( 3) =       0.000401704403
  error estimate for blocks of size 2^( 4) =       0.000409832660
  error estimate for blocks of size 2^( 5) =       0.000414198333
  error estimate for blocks of size 2^( 6) =       0.000418269366
  error estimate for blocks of size 2^( 7) =       0.000419983336

      target function =      -0.910046596630
              le_mean =     -17.214289941228
             les_mean =     296.633479466171
             stat err =       0.000415570924
             autocorr =       1.199543428512
   target nu stat err =       0.000415570924
   target dn stat err =       0.002431818822
      target stat err =       0.003815931858
              std dev =       0.536601847384
             le_variance =       0.287941542616

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287899899349
                                         uncertainty =       0.001846870312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287899899349
                                         uncertainty =       0.001846870312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379433775
  error estimate for blocks of size 2^( 2) =       0.000390873009
  error estimate for blocks of size 2^( 3) =       0.000401703683
  error estimate for blocks of size 2^( 4) =       0.000409831750
  error estimate for blocks of size 2^( 5) =       0.000414196946
  error estimate for blocks of size 2^( 6) =       0.000418268127
  error estimate for blocks of size 2^( 7) =       0.000419982761

      target function =      -0.910072473948
              le_mean =     -17.214290143148
             les_mean =     296.633469665927
             stat err =       0.000415569896
             autocorr =       1.199544012622
   target nu stat err =       0.000415569896
   target dn stat err =       0.002427911157
      target stat err =       0.003810222973
              std dev =       0.536600390061
             le_variance =       0.287939978614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287898622472
                                         uncertainty =       0.001846526319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287898622472
                                         uncertainty =       0.001846526319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379432948
  error estimate for blocks of size 2^( 2) =       0.000390872440
  error estimate for blocks of size 2^( 3) =       0.000401703145
  error estimate for blocks of size 2^( 4) =       0.000409831036
  error estimate for blocks of size 2^( 5) =       0.000414195811
  error estimate for blocks of size 2^( 6) =       0.000418267122
  error estimate for blocks of size 2^( 7) =       0.000419982345

      target function =      -0.909966248289
              le_mean =     -17.214290341912
             les_mean =     296.633545402086
             stat err =       0.000415569079
             autocorr =       1.199544516964
   target nu stat err =       0.000415569079
   target dn stat err =       0.002426290038
      target stat err =       0.003806893237
              std dev =       0.536599221394
             le_variance =       0.287938724401


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909828924470        initial
     2.5000e+00     2.5000e+01             4.1276e-05        -0.910046596630
     1.0000e+01     1.0000e+02             1.0508e-05        -0.910072473948  <--
     4.0000e+01     4.0000e+02             2.6391e-06        -0.909966248289

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 2.2838e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -3.757133e-02 3 1  ON 0
ci_002                -2.877670e-02 3 1  ON 1
ci_003                -2.365127e-02 3 1  ON 2
ci_004                 2.077874e-02 3 1  ON 3
ci_005                 2.138942e-02 3 1  ON 4
ci_006                -1.843972e-02 3 1  ON 5
ci_007                -1.852376e-02 3 1  ON 6
ci_008                -7.783942e-03 3 1  ON 7
ci_009                -1.394553e-02 3 1  ON 8
ci_010                -8.913139e-03 3 1  ON 9
ci_011                -8.997329e-03 3 1  ON 10
ci_012                -9.135896e-03 3 1  ON 11
ci_013                -1.910125e-02 3 1  ON 12
ci_014                 1.115074e-02 3 1  ON 13
ci_015                 1.096625e-02 3 1  ON 14
ci_016                 1.596554e-02 3 1  ON 15
ci_017                 1.563172e-02 3 1  ON 16
ci_018                 9.130898e-03 3 1  ON 17
ci_019                 8.912551e-03 3 1  ON 18
ci_020                 1.508266e-02 3 1  ON 19
ci_021                 1.521884e-02 3 1  ON 20
ci_022                 8.273033e-03 3 1  ON 21
ci_023                 8.295337e-03 3 1  ON 22
ci_024                 8.476129e-03 3 1  ON 23
ci_025                 8.523713e-03 3 1  ON 24
ci_026                 9.974761e-03 3 1  ON 25
ci_027                 9.646646e-03 3 1  ON 26
ci_028                -1.454828e-02 3 1  ON 27
ci_029                -1.486982e-02 3 1  ON 28
ci_030                -8.827454e-03 3 1  ON 29
ci_031                -8.648924e-03 3 1  ON 30
ci_032                -1.432663e-02 3 1  ON 31
ci_033                 4.537098e-03 3 1  ON 32
ci_034                 4.904073e-03 3 1  ON 33
ci_035                -3.337394e-03 3 1  ON 34
ci_036                -1.115759e-02 3 1  ON 35
ci_037                -1.149130e-02 3 1  ON 36
ci_038                 9.025680e-04 3 1  ON 37
ci_039                 1.169240e-03 3 1  ON 38
ci_040                -1.526641e-03 3 1  ON 39
ci_041                 8.226065e-03 3 1  ON 40
ci_042                 8.207339e-03 3 1  ON 41
ci_043                -2.354572e-03 3 1  ON 42
ci_044                -3.907502e-03 3 1  ON 43
ci_045                -2.012420e-03 3 1  ON 44
ci_046                 4.824365e-03 3 1  ON 45
ci_047                 4.625582e-03 3 1  ON 46
ci_048                -1.234692e-02 3 1  ON 47
ci_049                -1.295516e-02 3 1  ON 48
ci_050                 2.826764e-03 3 1  ON 49
ci_051                 2.971156e-03 3 1  ON 50
ci_052                -2.181918e-03 3 1  ON 51
ci_053                -2.250135e-03 3 1  ON 52
ci_054                -2.236605e-03 3 1  ON 53
ci_055                -2.423462e-03 3 1  ON 54
ci_056                 4.663697e-03 3 1  ON 55
ci_057                 4.613168e-03 3 1  ON 56
ci_058                -2.107517e-03 3 1  ON 57
ci_059                -2.053172e-03 3 1  ON 58
ci_060                 4.815846e-03 3 1  ON 59
ci_061                 5.218412e-03 3 1  ON 60
ci_062                -2.962484e-03 3 1  ON 61
ci_063                -2.810348e-03 3 1  ON 62
ci_064                -2.261672e-03 3 1  ON 63
ci_065                -3.383815e-03 3 1  ON 64
ci_066                 4.083501e-03 3 1  ON 65
ci_067                 4.292125e-03 3 1  ON 66
ci_068                -4.307154e-03 3 1  ON 67
ci_069                -4.058668e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9147e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1841
    reference variance = 0.22699
====================================================
  Execution time = 1.3940e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0012e-01
  Total weights = 1.957817123e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287471803964
                                         uncertainty =       0.001860787485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287471803964
                                         uncertainty =       0.001860787485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379092446
  error estimate for blocks of size 2^( 2) =       0.000390528939
  error estimate for blocks of size 2^( 3) =       0.000400991059
  error estimate for blocks of size 2^( 4) =       0.000409152978
  error estimate for blocks of size 2^( 5) =       0.000413819319
  error estimate for blocks of size 2^( 6) =       0.000417372158
  error estimate for blocks of size 2^( 7) =       0.000417971233

      target function =      -0.912436999452
              le_mean =     -17.215503999153
             les_mean =     296.673701659403
             stat err =       0.000414578922
             autocorr =       1.195980711681
   target nu stat err =       0.000414578922
   target dn stat err =       0.002839457188
      target stat err =       0.004468214551
              std dev =       0.536117678146
             le_variance =       0.287422164821


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721550399915e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912457805388       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912473435277       residual = 7.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912474695530       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912475117215       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912475228144       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912475276994       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912475289257       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912475294799       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912475295515       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912475295192       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 4.629982e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912457805388       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912461804672       residual = 7.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912462125249       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912462231589       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912462259539       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912462271827       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912462274871       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912462276246       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912462276425       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912462276344       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.178129e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912457805388       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912458811117       residual = 7.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912458891613       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912458918255       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912458925256       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912458928332       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912458929092       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912458929435       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912458929480       residual = 9.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 2.960219e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123594 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6469e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -3.756456e-02 3 1  ON 0
ci_002                -2.877669e-02 3 1  ON 1
ci_003                -2.364940e-02 3 1  ON 2
ci_004                 2.078452e-02 3 1  ON 3
ci_005                 2.138807e-02 3 1  ON 4
ci_006                -1.843693e-02 3 1  ON 5
ci_007                -1.852143e-02 3 1  ON 6
ci_008                -7.785253e-03 3 1  ON 7
ci_009                -1.394278e-02 3 1  ON 8
ci_010                -8.917705e-03 3 1  ON 9
ci_011                -8.995757e-03 3 1  ON 10
ci_012                -9.134010e-03 3 1  ON 11
ci_013                -1.909875e-02 3 1  ON 12
ci_014                 1.114600e-02 3 1  ON 13
ci_015                 1.097030e-02 3 1  ON 14
ci_016                 1.596351e-02 3 1  ON 15
ci_017                 1.563341e-02 3 1  ON 16
ci_018                 9.121728e-03 3 1  ON 17
ci_019                 8.918043e-03 3 1  ON 18
ci_020                 1.508056e-02 3 1  ON 19
ci_021                 1.521973e-02 3 1  ON 20
ci_022                 8.274359e-03 3 1  ON 21
ci_023                 8.298231e-03 3 1  ON 22
ci_024                 8.470538e-03 3 1  ON 23
ci_025                 8.516484e-03 3 1  ON 24
ci_026                 9.967046e-03 3 1  ON 25
ci_027                 9.643930e-03 3 1  ON 26
ci_028                -1.454533e-02 3 1  ON 27
ci_029                -1.485804e-02 3 1  ON 28
ci_030                -8.824269e-03 3 1  ON 29
ci_031                -8.654804e-03 3 1  ON 30
ci_032                -1.433109e-02 3 1  ON 31
ci_033                 4.536305e-03 3 1  ON 32
ci_034                 4.899388e-03 3 1  ON 33
ci_035                -3.335493e-03 3 1  ON 34
ci_036                -1.115899e-02 3 1  ON 35
ci_037                -1.148827e-02 3 1  ON 36
ci_038                 9.013189e-04 3 1  ON 37
ci_039                 1.165784e-03 3 1  ON 38
ci_040                -1.528451e-03 3 1  ON 39
ci_041                 8.221464e-03 3 1  ON 40
ci_042                 8.203314e-03 3 1  ON 41
ci_043                -2.355258e-03 3 1  ON 42
ci_044                -3.908615e-03 3 1  ON 43
ci_045                -2.007811e-03 3 1  ON 44
ci_046                 4.821453e-03 3 1  ON 45
ci_047                 4.619344e-03 3 1  ON 46
ci_048                -1.234905e-02 3 1  ON 47
ci_049                -1.295237e-02 3 1  ON 48
ci_050                 2.825330e-03 3 1  ON 49
ci_051                 2.975655e-03 3 1  ON 50
ci_052                -2.191858e-03 3 1  ON 51
ci_053                -2.241508e-03 3 1  ON 52
ci_054                -2.233958e-03 3 1  ON 53
ci_055                -2.421808e-03 3 1  ON 54
ci_056                 4.661505e-03 3 1  ON 55
ci_057                 4.613849e-03 3 1  ON 56
ci_058                -2.113816e-03 3 1  ON 57
ci_059                -2.047972e-03 3 1  ON 58
ci_060                 4.809403e-03 3 1  ON 59
ci_061                 5.218092e-03 3 1  ON 60
ci_062                -2.965422e-03 3 1  ON 61
ci_063                -2.809440e-03 3 1  ON 62
ci_064                -2.261488e-03 3 1  ON 63
ci_065                -3.383393e-03 3 1  ON 64
ci_066                 4.080309e-03 3 1  ON 65
ci_067                 4.285163e-03 3 1  ON 66
ci_068                -4.303592e-03 3 1  ON 67
ci_069                -4.057637e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1996
    reference variance = 0.251945
====================================================
  Execution time = 1.3422e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0073e-01
  Total weights = 1.9579e+06
  Execution time = 1.8537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285816428219
                                         uncertainty =       0.001983236097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285816428219
                                         uncertainty =       0.001983236097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378058275
  error estimate for blocks of size 2^( 2) =       0.000389383377
  error estimate for blocks of size 2^( 3) =       0.000399910394
  error estimate for blocks of size 2^( 4) =       0.000407712427
  error estimate for blocks of size 2^( 5) =       0.000411862427
  error estimate for blocks of size 2^( 6) =       0.000414350762
  error estimate for blocks of size 2^( 7) =       0.000417713107

      target function =      -0.911498611457
              le_mean =     -17.214568299981
             les_mean =     296.642107823159
             stat err =       0.000412909681
             autocorr =       1.192868671268
   target nu stat err =       0.000412909681
   target dn stat err =       0.003327955836
      target stat err =       0.005199060811
              std dev =       0.534655140452
             le_variance =       0.285856119211

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285799454374
                                         uncertainty =       0.001979447098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285799454374
                                         uncertainty =       0.001979447098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378046952
  error estimate for blocks of size 2^( 2) =       0.000389373219
  error estimate for blocks of size 2^( 3) =       0.000399901722
  error estimate for blocks of size 2^( 4) =       0.000407705505
  error estimate for blocks of size 2^( 5) =       0.000411855366
  error estimate for blocks of size 2^( 6) =       0.000414342362
  error estimate for blocks of size 2^( 7) =       0.000417703667

      target function =      -0.911626188573
              le_mean =     -17.214568400770
             les_mean =     296.642029421227
             stat err =       0.000412901725
             autocorr =       1.192894160658
   target nu stat err =       0.000412901725
   target dn stat err =       0.003279801674
      target stat err =       0.005126626726
              std dev =       0.534639126672
             le_variance =       0.285838995768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285807615291
                                         uncertainty =       0.001981285407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285807615291
                                         uncertainty =       0.001981285407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378052397
  error estimate for blocks of size 2^( 2) =       0.000389378093
  error estimate for blocks of size 2^( 3) =       0.000399905869
  error estimate for blocks of size 2^( 4) =       0.000407708797
  error estimate for blocks of size 2^( 5) =       0.000411858724
  error estimate for blocks of size 2^( 6) =       0.000414346371
  error estimate for blocks of size 2^( 7) =       0.000417708188

      target function =      -0.911558201434
              le_mean =     -17.214568341093
             les_mean =     296.642071024344
             stat err =       0.000412905520
             autocorr =       1.192881724933
   target nu stat err =       0.000412905520
   target dn stat err =       0.003302868086
      target stat err =       0.005161248932
              std dev =       0.534646827531
             le_variance =       0.285847230189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285815304556
                                         uncertainty =       0.001982989272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285815304556
                                         uncertainty =       0.001982989272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378057526
  error estimate for blocks of size 2^( 2) =       0.000389382703
  error estimate for blocks of size 2^( 3) =       0.000399909815
  error estimate for blocks of size 2^( 4) =       0.000407711961
  error estimate for blocks of size 2^( 5) =       0.000411861952
  error estimate for blocks of size 2^( 6) =       0.000414350200
  error estimate for blocks of size 2^( 7) =       0.000417712478

      target function =      -0.911507169773
              le_mean =     -17.214568303919
             les_mean =     296.642102465886
             stat err =       0.000412909148
             autocorr =       1.192870319537
   target nu stat err =       0.000412909148
   target dn stat err =       0.003324741540
      target stat err =       0.005194226955
              std dev =       0.534654080696
             le_variance =       0.285854986005


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911498611457        initial
     2.5000e+00     2.5000e+01             4.6300e-05        -0.911626188573  <--
     1.0000e+01     1.0000e+02             1.1781e-05        -0.911558201434
     4.0000e+01     4.0000e+02             2.9602e-06        -0.911507169773

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.2778e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -3.754469e-02 3 1  ON 0
ci_002                -2.877668e-02 3 1  ON 1
ci_003                -2.364394e-02 3 1  ON 2
ci_004                 2.080138e-02 3 1  ON 3
ci_005                 2.138411e-02 3 1  ON 4
ci_006                -1.842877e-02 3 1  ON 5
ci_007                -1.851460e-02 3 1  ON 6
ci_008                -7.789056e-03 3 1  ON 7
ci_009                -1.393477e-02 3 1  ON 8
ci_010                -8.931010e-03 3 1  ON 9
ci_011                -8.991157e-03 3 1  ON 10
ci_012                -9.128515e-03 3 1  ON 11
ci_013                -1.909143e-02 3 1  ON 12
ci_014                 1.113218e-02 3 1  ON 13
ci_015                 1.098210e-02 3 1  ON 14
ci_016                 1.595756e-02 3 1  ON 15
ci_017                 1.563839e-02 3 1  ON 16
ci_018                 9.095051e-03 3 1  ON 17
ci_019                 8.934018e-03 3 1  ON 18
ci_020                 1.507448e-02 3 1  ON 19
ci_021                 1.522226e-02 3 1  ON 20
ci_022                 8.278298e-03 3 1  ON 21
ci_023                 8.306636e-03 3 1  ON 22
ci_024                 8.454207e-03 3 1  ON 23
ci_025                 8.495310e-03 3 1  ON 24
ci_026                 9.944642e-03 3 1  ON 25
ci_027                 9.636017e-03 3 1  ON 26
ci_028                -1.453667e-02 3 1  ON 27
ci_029                -1.482352e-02 3 1  ON 28
ci_030                -8.815011e-03 3 1  ON 29
ci_031                -8.671898e-03 3 1  ON 30
ci_032                -1.434413e-02 3 1  ON 31
ci_033                 4.534003e-03 3 1  ON 32
ci_034                 4.885725e-03 3 1  ON 33
ci_035                -3.329952e-03 3 1  ON 34
ci_036                -1.116307e-02 3 1  ON 35
ci_037                -1.147944e-02 3 1  ON 36
ci_038                 8.976837e-04 3 1  ON 37
ci_039                 1.155722e-03 3 1  ON 38
ci_040                -1.533722e-03 3 1  ON 39
ci_041                 8.208047e-03 3 1  ON 40
ci_042                 8.191508e-03 3 1  ON 41
ci_043                -2.357257e-03 3 1  ON 42
ci_044                -3.911857e-03 3 1  ON 43
ci_045                -1.994400e-03 3 1  ON 44
ci_046                 4.812950e-03 3 1  ON 45
ci_047                 4.601125e-03 3 1  ON 46
ci_048                -1.235528e-02 3 1  ON 47
ci_049                -1.294429e-02 3 1  ON 48
ci_050                 2.821160e-03 3 1  ON 49
ci_051                 2.988714e-03 3 1  ON 50
ci_052                -2.220753e-03 3 1  ON 51
ci_053                -2.216393e-03 3 1  ON 52
ci_054                -2.226275e-03 3 1  ON 53
ci_055                -2.416965e-03 3 1  ON 54
ci_056                 4.655121e-03 3 1  ON 55
ci_057                 4.615831e-03 3 1  ON 56
ci_058                -2.132135e-03 3 1  ON 57
ci_059                -2.032860e-03 3 1  ON 58
ci_060                 4.790598e-03 3 1  ON 59
ci_061                 5.217152e-03 3 1  ON 60
ci_062                -2.973970e-03 3 1  ON 61
ci_063                -2.806761e-03 3 1  ON 62
ci_064                -2.260958e-03 3 1  ON 63
ci_065                -3.382163e-03 3 1  ON 64
ci_066                 4.071012e-03 3 1  ON 65
ci_067                 4.264882e-03 3 1  ON 66
ci_068                -4.293197e-03 3 1  ON 67
ci_069                -4.054621e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9258e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1527
    reference variance = 0.146683
====================================================
  Execution time = 1.3778e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9934e-01
  Total weights = 1.957454127e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5111e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286440550589
                                         uncertainty =       0.001886432918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286440550589
                                         uncertainty =       0.001886432918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378428519
  error estimate for blocks of size 2^( 2) =       0.000390027951
  error estimate for blocks of size 2^( 3) =       0.000400543295
  error estimate for blocks of size 2^( 4) =       0.000408496294
  error estimate for blocks of size 2^( 5) =       0.000413525383
  error estimate for blocks of size 2^( 6) =       0.000416005810
  error estimate for blocks of size 2^( 7) =       0.000419419943

      target function =      -0.913701906802
              le_mean =     -17.214412795587
             les_mean =     296.635347636847
             stat err =       0.000414361857
             autocorr =       1.198924474778
   target nu stat err =       0.000414361857
   target dn stat err =       0.002220126788
      target stat err =       0.003523535104
              std dev =       0.535178744059
             le_variance =       0.286416288093


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721441279559e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913714588189       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913786529427       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913800773393       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913804667415       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913805226155       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913805275124       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913805290785       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913805292093       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913805295212       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913805308078       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 2.200288e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913714588189       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913734304755       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913738135074       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913739159788       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913739299938       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913739310660       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913739313889       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913739314227       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913739314959       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913739318118       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 5.974115e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913714588189       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913719638865       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913720614836       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913720874361       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913720909373       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913720911943       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913720912701       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913720912786       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913720912966       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913720913751       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.526446e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127249 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6299e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -3.753446e-02 3 1  ON 0
ci_002                -2.877417e-02 3 1  ON 1
ci_003                -2.358420e-02 3 1  ON 2
ci_004                 2.078791e-02 3 1  ON 3
ci_005                 2.132971e-02 3 1  ON 4
ci_006                -1.842645e-02 3 1  ON 5
ci_007                -1.850470e-02 3 1  ON 6
ci_008                -7.776127e-03 3 1  ON 7
ci_009                -1.393548e-02 3 1  ON 8
ci_010                -8.905603e-03 3 1  ON 9
ci_011                -8.978802e-03 3 1  ON 10
ci_012                -9.114876e-03 3 1  ON 11
ci_013                -1.909661e-02 3 1  ON 12
ci_014                 1.112430e-02 3 1  ON 13
ci_015                 1.096591e-02 3 1  ON 14
ci_016                 1.594191e-02 3 1  ON 15
ci_017                 1.561274e-02 3 1  ON 16
ci_018                 9.090347e-03 3 1  ON 17
ci_019                 8.947598e-03 3 1  ON 18
ci_020                 1.509676e-02 3 1  ON 19
ci_021                 1.522215e-02 3 1  ON 20
ci_022                 8.270904e-03 3 1  ON 21
ci_023                 8.305652e-03 3 1  ON 22
ci_024                 8.428812e-03 3 1  ON 23
ci_025                 8.456444e-03 3 1  ON 24
ci_026                 9.905326e-03 3 1  ON 25
ci_027                 9.661228e-03 3 1  ON 26
ci_028                -1.455475e-02 3 1  ON 27
ci_029                -1.482965e-02 3 1  ON 28
ci_030                -8.818889e-03 3 1  ON 29
ci_031                -8.659816e-03 3 1  ON 30
ci_032                -1.434843e-02 3 1  ON 31
ci_033                 4.542786e-03 3 1  ON 32
ci_034                 4.892340e-03 3 1  ON 33
ci_035                -3.329370e-03 3 1  ON 34
ci_036                -1.119455e-02 3 1  ON 35
ci_037                -1.151593e-02 3 1  ON 36
ci_038                 9.011700e-04 3 1  ON 37
ci_039                 1.130390e-03 3 1  ON 38
ci_040                -1.545076e-03 3 1  ON 39
ci_041                 8.188834e-03 3 1  ON 40
ci_042                 8.190192e-03 3 1  ON 41
ci_043                -2.348408e-03 3 1  ON 42
ci_044                -3.903961e-03 3 1  ON 43
ci_045                -1.993978e-03 3 1  ON 44
ci_046                 4.812121e-03 3 1  ON 45
ci_047                 4.602708e-03 3 1  ON 46
ci_048                -1.234627e-02 3 1  ON 47
ci_049                -1.294460e-02 3 1  ON 48
ci_050                 2.829186e-03 3 1  ON 49
ci_051                 2.956645e-03 3 1  ON 50
ci_052                -2.232161e-03 3 1  ON 51
ci_053                -2.207863e-03 3 1  ON 52
ci_054                -2.221685e-03 3 1  ON 53
ci_055                -2.419562e-03 3 1  ON 54
ci_056                 4.680961e-03 3 1  ON 55
ci_057                 4.631969e-03 3 1  ON 56
ci_058                -2.125296e-03 3 1  ON 57
ci_059                -2.049141e-03 3 1  ON 58
ci_060                 4.806249e-03 3 1  ON 59
ci_061                 5.229742e-03 3 1  ON 60
ci_062                -2.951063e-03 3 1  ON 61
ci_063                -2.820341e-03 3 1  ON 62
ci_064                -2.262822e-03 3 1  ON 63
ci_065                -3.385850e-03 3 1  ON 64
ci_066                 4.066083e-03 3 1  ON 65
ci_067                 4.267750e-03 3 1  ON 66
ci_068                -4.262794e-03 3 1  ON 67
ci_069                -4.087148e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2597
    reference variance = 0.328975
====================================================
  Execution time = 1.3531e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0620e-01
  Total weights = 1.9580e+06
  Execution time = 1.8555e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289375915356
                                         uncertainty =       0.002056933469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289375915356
                                         uncertainty =       0.002056933469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380383954
  error estimate for blocks of size 2^( 2) =       0.000391726682
  error estimate for blocks of size 2^( 3) =       0.000402364894
  error estimate for blocks of size 2^( 4) =       0.000409680964
  error estimate for blocks of size 2^( 5) =       0.000414233008
  error estimate for blocks of size 2^( 6) =       0.000417766562
  error estimate for blocks of size 2^( 7) =       0.000419885619

      target function =      -0.903100924533
              le_mean =     -17.214987310481
             les_mean =     296.661991938999
             stat err =       0.000415391538
             autocorr =       1.192534399031
   target nu stat err =       0.000415391538
   target dn stat err =       0.003644018743
      target stat err =       0.005585677880
              std dev =       0.537944146102
             le_variance =       0.289383904325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289347347244
                                         uncertainty =       0.002050343140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289347347244
                                         uncertainty =       0.002050343140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380365765
  error estimate for blocks of size 2^( 2) =       0.000391718011
  error estimate for blocks of size 2^( 3) =       0.000402367094
  error estimate for blocks of size 2^( 4) =       0.000409692499
  error estimate for blocks of size 2^( 5) =       0.000414251566
  error estimate for blocks of size 2^( 6) =       0.000417782060
  error estimate for blocks of size 2^( 7) =       0.000419899063

      target function =      -0.902955647177
              le_mean =     -17.214986833143
             les_mean =     296.662070785272
             stat err =       0.000415406297
             autocorr =       1.192733204948
   target nu stat err =       0.000415406297
   target dn stat err =       0.003667481088
      target stat err =       0.005619285959
              std dev =       0.537918422864
             le_variance =       0.289356229656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289358637187
                                         uncertainty =       0.002053289512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289358637187
                                         uncertainty =       0.002053289512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380372917
  error estimate for blocks of size 2^( 2) =       0.000391720807
  error estimate for blocks of size 2^( 3) =       0.000402364905
  error estimate for blocks of size 2^( 4) =       0.000409686021
  error estimate for blocks of size 2^( 5) =       0.000414241822
  error estimate for blocks of size 2^( 6) =       0.000417773686
  error estimate for blocks of size 2^( 7) =       0.000419891626

      target function =      -0.903069624218
              le_mean =     -17.214986860488
             les_mean =     296.661996910631
             stat err =       0.000415398289
             autocorr =       1.192642363413
   target nu stat err =       0.000415398289
   target dn stat err =       0.003655060184
      target stat err =       0.005601950225
              std dev =       0.537928538014
             le_variance =       0.289367112009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289373453177
                                         uncertainty =       0.002056456790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289373453177
                                         uncertainty =       0.002056456790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380382376
  error estimate for blocks of size 2^( 2) =       0.000391725764
  error estimate for blocks of size 2^( 3) =       0.000402364726
  error estimate for blocks of size 2^( 4) =       0.000409681438
  error estimate for blocks of size 2^( 5) =       0.000414233953
  error estimate for blocks of size 2^( 6) =       0.000417767287
  error estimate for blocks of size 2^( 7) =       0.000419886200

      target function =      -0.903109036710
              le_mean =     -17.214987228694
             les_mean =     296.661983777254
             stat err =       0.000415392219
             autocorr =       1.192548198701
   target nu stat err =       0.000415392219
   target dn stat err =       0.003645171029
      target stat err =       0.005587515469
              std dev =       0.537941915353
             le_variance =       0.289381504293


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.903100924533        initial
     6.2500e-01     6.2500e+00             2.2003e-04        -0.902955647177
     2.5000e+00     2.5000e+01             5.9741e-05        -0.903069624218
     1.0000e+01     1.0000e+02             1.5264e-05        -0.903109036710  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 2.2897e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -3.754208e-02 3 1  ON 0
ci_002                -2.877604e-02 3 1  ON 1
ci_003                -2.362867e-02 3 1  ON 2
ci_004                 2.079797e-02 3 1  ON 3
ci_005                 2.137024e-02 3 1  ON 4
ci_006                -1.842817e-02 3 1  ON 5
ci_007                -1.851208e-02 3 1  ON 6
ci_008                -7.785739e-03 3 1  ON 7
ci_009                -1.393495e-02 3 1  ON 8
ci_010                -8.924527e-03 3 1  ON 9
ci_011                -8.987999e-03 3 1  ON 10
ci_012                -9.125038e-03 3 1  ON 11
ci_013                -1.909275e-02 3 1  ON 12
ci_014                 1.113018e-02 3 1  ON 13
ci_015                 1.097797e-02 3 1  ON 14
ci_016                 1.595357e-02 3 1  ON 15
ci_017                 1.563186e-02 3 1  ON 16
ci_018                 9.093851e-03 3 1  ON 17
ci_019                 8.937476e-03 3 1  ON 18
ci_020                 1.508015e-02 3 1  ON 19
ci_021                 1.522223e-02 3 1  ON 20
ci_022                 8.276409e-03 3 1  ON 21
ci_023                 8.306390e-03 3 1  ON 22
ci_024                 8.447745e-03 3 1  ON 23
ci_025                 8.485404e-03 3 1  ON 24
ci_026                 9.934591e-03 3 1  ON 25
ci_027                 9.642490e-03 3 1  ON 26
ci_028                -1.454129e-02 3 1  ON 27
ci_029                -1.482508e-02 3 1  ON 28
ci_030                -8.816004e-03 3 1  ON 29
ci_031                -8.668807e-03 3 1  ON 30
ci_032                -1.434523e-02 3 1  ON 31
ci_033                 4.536242e-03 3 1  ON 32
ci_034                 4.887412e-03 3 1  ON 33
ci_035                -3.329803e-03 3 1  ON 34
ci_036                -1.117114e-02 3 1  ON 35
ci_037                -1.148882e-02 3 1  ON 36
ci_038                 8.985747e-04 3 1  ON 37
ci_039                 1.149246e-03 3 1  ON 38
ci_040                -1.536626e-03 3 1  ON 39
ci_041                 8.203124e-03 3 1  ON 40
ci_042                 8.191168e-03 3 1  ON 41
ci_043                -2.354996e-03 3 1  ON 42
ci_044                -3.909841e-03 3 1  ON 43
ci_045                -1.994295e-03 3 1  ON 44
ci_046                 4.812737e-03 3 1  ON 45
ci_047                 4.601530e-03 3 1  ON 46
ci_048                -1.235298e-02 3 1  ON 47
ci_049                -1.294437e-02 3 1  ON 48
ci_050                 2.823217e-03 3 1  ON 49
ci_051                 2.980500e-03 3 1  ON 50
ci_052                -2.223670e-03 3 1  ON 51
ci_053                -2.214207e-03 3 1  ON 52
ci_054                -2.225106e-03 3 1  ON 53
ci_055                -2.417626e-03 3 1  ON 54
ci_056                 4.661722e-03 3 1  ON 55
ci_057                 4.619954e-03 3 1  ON 56
ci_058                -2.130379e-03 3 1  ON 57
ci_059                -2.037019e-03 3 1  ON 58
ci_060                 4.794589e-03 3 1  ON 59
ci_061                 5.220363e-03 3 1  ON 60
ci_062                -2.968126e-03 3 1  ON 61
ci_063                -2.810236e-03 3 1  ON 62
ci_064                -2.261436e-03 3 1  ON 63
ci_065                -3.383105e-03 3 1  ON 64
ci_066                 4.069754e-03 3 1  ON 65
ci_067                 4.265613e-03 3 1  ON 66
ci_068                -4.285438e-03 3 1  ON 67
ci_069                -4.062917e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9203e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1918
    reference variance = 0.175115
====================================================
  Execution time = 1.3770e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9816e-01
  Total weights = 1.957661144e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5062e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285776000717
                                         uncertainty =       0.001457155924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285776000717
                                         uncertainty =       0.001457155924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377946198
  error estimate for blocks of size 2^( 2) =       0.000389171544
  error estimate for blocks of size 2^( 3) =       0.000399986165
  error estimate for blocks of size 2^( 4) =       0.000407164282
  error estimate for blocks of size 2^( 5) =       0.000412985098
  error estimate for blocks of size 2^( 6) =       0.000416531425
  error estimate for blocks of size 2^( 7) =       0.000416434865

      target function =      -0.915543655257
              le_mean =     -17.214554497726
             les_mean =     296.639043574606
             stat err =       0.000413278917
             autocorr =       1.195711867280
   target nu stat err =       0.000413278917
   target dn stat err =       0.001945867021
      target stat err =       0.003119477637
              std dev =       0.534496639765
             le_variance =       0.285686657921


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721455449773e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915553317539       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915560389453       residual = 8.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915562254889       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915562757251       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915562833388       residual = 8.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915562860304       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915562872187       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915562872464       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915562872326       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 3.998784e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915553317539       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915555126662       residual = 8.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915555601407       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915555728004       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915555747131       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915555753851       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915555756824       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915555756881       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915555756845       residual = 6.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.020707e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915553317539       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915553772466       residual = 8.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915553891688       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915553923399       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915553928187       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915553929866       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915553930609       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915553930623       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915553930614       residual = 6.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 2.565247e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130297 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6285e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -3.754322e-02 3 1  ON 0
ci_002                -2.877174e-02 3 1  ON 1
ci_003                -2.362634e-02 3 1  ON 2
ci_004                 2.079900e-02 3 1  ON 3
ci_005                 2.136206e-02 3 1  ON 4
ci_006                -1.843216e-02 3 1  ON 5
ci_007                -1.851265e-02 3 1  ON 6
ci_008                -7.781871e-03 3 1  ON 7
ci_009                -1.393470e-02 3 1  ON 8
ci_010                -8.914320e-03 3 1  ON 9
ci_011                -8.986337e-03 3 1  ON 10
ci_012                -9.126901e-03 3 1  ON 11
ci_013                -1.909300e-02 3 1  ON 12
ci_014                 1.113339e-02 3 1  ON 13
ci_015                 1.097814e-02 3 1  ON 14
ci_016                 1.594617e-02 3 1  ON 15
ci_017                 1.563125e-02 3 1  ON 16
ci_018                 9.095577e-03 3 1  ON 17
ci_019                 8.939434e-03 3 1  ON 18
ci_020                 1.508124e-02 3 1  ON 19
ci_021                 1.522843e-02 3 1  ON 20
ci_022                 8.273303e-03 3 1  ON 21
ci_023                 8.308955e-03 3 1  ON 22
ci_024                 8.439080e-03 3 1  ON 23
ci_025                 8.483366e-03 3 1  ON 24
ci_026                 9.932839e-03 3 1  ON 25
ci_027                 9.648883e-03 3 1  ON 26
ci_028                -1.453454e-02 3 1  ON 27
ci_029                -1.482058e-02 3 1  ON 28
ci_030                -8.814316e-03 3 1  ON 29
ci_031                -8.662862e-03 3 1  ON 30
ci_032                -1.434528e-02 3 1  ON 31
ci_033                 4.535465e-03 3 1  ON 32
ci_034                 4.885316e-03 3 1  ON 33
ci_035                -3.331045e-03 3 1  ON 34
ci_036                -1.117145e-02 3 1  ON 35
ci_037                -1.149104e-02 3 1  ON 36
ci_038                 8.955749e-04 3 1  ON 37
ci_039                 1.149590e-03 3 1  ON 38
ci_040                -1.537772e-03 3 1  ON 39
ci_041                 8.202200e-03 3 1  ON 40
ci_042                 8.184424e-03 3 1  ON 41
ci_043                -2.353018e-03 3 1  ON 42
ci_044                -3.911144e-03 3 1  ON 43
ci_045                -1.993956e-03 3 1  ON 44
ci_046                 4.809411e-03 3 1  ON 45
ci_047                 4.599973e-03 3 1  ON 46
ci_048                -1.235053e-02 3 1  ON 47
ci_049                -1.294574e-02 3 1  ON 48
ci_050                 2.825130e-03 3 1  ON 49
ci_051                 2.979255e-03 3 1  ON 50
ci_052                -2.222303e-03 3 1  ON 51
ci_053                -2.214787e-03 3 1  ON 52
ci_054                -2.223073e-03 3 1  ON 53
ci_055                -2.419394e-03 3 1  ON 54
ci_056                 4.656353e-03 3 1  ON 55
ci_057                 4.619306e-03 3 1  ON 56
ci_058                -2.133624e-03 3 1  ON 57
ci_059                -2.041279e-03 3 1  ON 58
ci_060                 4.787091e-03 3 1  ON 59
ci_061                 5.219366e-03 3 1  ON 60
ci_062                -2.965780e-03 3 1  ON 61
ci_063                -2.808774e-03 3 1  ON 62
ci_064                -2.260513e-03 3 1  ON 63
ci_065                -3.385607e-03 3 1  ON 64
ci_066                 4.068921e-03 3 1  ON 65
ci_067                 4.258691e-03 3 1  ON 66
ci_068                -4.280281e-03 3 1  ON 67
ci_069                -4.068998e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1955
    reference variance = 0.347481
====================================================
  Execution time = 1.3497e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0043e-01
  Total weights = 1.9579e+06
  Execution time = 1.8607e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287744891111
                                         uncertainty =       0.001744947539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287744891111
                                         uncertainty =       0.001744947539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379316607
  error estimate for blocks of size 2^( 2) =       0.000390928624
  error estimate for blocks of size 2^( 3) =       0.000401598547
  error estimate for blocks of size 2^( 4) =       0.000409126511
  error estimate for blocks of size 2^( 5) =       0.000414203685
  error estimate for blocks of size 2^( 6) =       0.000415178173
  error estimate for blocks of size 2^( 7) =       0.000416488831

      target function =      -0.912011456203
              le_mean =     -17.214326362454
             les_mean =     296.633460886187
             stat err =       0.000413749300
             autocorr =       1.189791409139
   target nu stat err =       0.000413749300
   target dn stat err =       0.002489270952
      target stat err =       0.003919357584
              std dev =       0.536434690471
             le_variance =       0.287762177141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287745214913
                                         uncertainty =       0.001745326559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287745214913
                                         uncertainty =       0.001745326559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379316781
  error estimate for blocks of size 2^( 2) =       0.000390930305
  error estimate for blocks of size 2^( 3) =       0.000401602008
  error estimate for blocks of size 2^( 4) =       0.000409131259
  error estimate for blocks of size 2^( 5) =       0.000414209283
  error estimate for blocks of size 2^( 6) =       0.000415184535
  error estimate for blocks of size 2^( 7) =       0.000416495608

      target function =      -0.912024494136
              le_mean =     -17.214326915559
             les_mean =     296.633471498619
             stat err =       0.000413755171
             autocorr =       1.189824085833
   target nu stat err =       0.000413755171
   target dn stat err =       0.002489251699
      target stat err =       0.003919444334
              std dev =       0.536434936613
             le_variance =       0.287762441219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287744989599
                                         uncertainty =       0.001745139948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287744989599
                                         uncertainty =       0.001745139948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379316652
  error estimate for blocks of size 2^( 2) =       0.000390929437
  error estimate for blocks of size 2^( 3) =       0.000401600269
  error estimate for blocks of size 2^( 4) =       0.000409128890
  error estimate for blocks of size 2^( 5) =       0.000414206499
  error estimate for blocks of size 2^( 6) =       0.000415181377
  error estimate for blocks of size 2^( 7) =       0.000416492248

      target function =      -0.912019263487
              le_mean =     -17.214326636089
             les_mean =     296.633465260342
             stat err =       0.000413752254
             autocorr =       1.189808116746
   target nu stat err =       0.000413752254
   target dn stat err =       0.002489250032
      target stat err =       0.003919394629
              std dev =       0.536434753839
             le_variance =       0.287762245127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287744896231
                                         uncertainty =       0.001744971606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287744896231
                                         uncertainty =       0.001744971606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379316608
  error estimate for blocks of size 2^( 2) =       0.000390928722
  error estimate for blocks of size 2^( 3) =       0.000401598759
  error estimate for blocks of size 2^( 4) =       0.000409126805
  error estimate for blocks of size 2^( 5) =       0.000414204033
  error estimate for blocks of size 2^( 6) =       0.000415178571
  error estimate for blocks of size 2^( 7) =       0.000416489256

      target function =      -0.912012563599
              le_mean =     -17.214326395840
             les_mean =     296.633461319905
             stat err =       0.000413749666
             autocorr =       1.189793511126
   target nu stat err =       0.000413749666
   target dn stat err =       0.002489266867
      target stat err =       0.003919361080
              std dev =       0.536434691671
             le_variance =       0.287762178428


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912011456203        initial
     2.5000e+00     2.5000e+01             3.9988e-05        -0.912024494136  <--
     1.0000e+01     1.0000e+02             1.0207e-05        -0.912019263487
     4.0000e+01     4.0000e+02             2.5652e-06        -0.912012563599

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.2873e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -3.754656e-02 3 1  ON 0
ci_002                -2.875917e-02 3 1  ON 1
ci_003                -2.361956e-02 3 1  ON 2
ci_004                 2.080198e-02 3 1  ON 3
ci_005                 2.133817e-02 3 1  ON 4
ci_006                -1.844389e-02 3 1  ON 5
ci_007                -1.851433e-02 3 1  ON 6
ci_008                -7.770642e-03 3 1  ON 7
ci_009                -1.393398e-02 3 1  ON 8
ci_010                -8.884539e-03 3 1  ON 9
ci_011                -8.981494e-03 3 1  ON 10
ci_012                -9.132332e-03 3 1  ON 11
ci_013                -1.909373e-02 3 1  ON 12
ci_014                 1.114275e-02 3 1  ON 13
ci_015                 1.097862e-02 3 1  ON 14
ci_016                 1.592450e-02 3 1  ON 15
ci_017                 1.562945e-02 3 1  ON 16
ci_018                 9.100661e-03 3 1  ON 17
ci_019                 8.945156e-03 3 1  ON 18
ci_020                 1.508450e-02 3 1  ON 19
ci_021                 1.524660e-02 3 1  ON 20
ci_022                 8.264229e-03 3 1  ON 21
ci_023                 8.316468e-03 3 1  ON 22
ci_024                 8.413708e-03 3 1  ON 23
ci_025                 8.477389e-03 3 1  ON 24
ci_026                 9.927750e-03 3 1  ON 25
ci_027                 9.667430e-03 3 1  ON 26
ci_028                -1.451478e-02 3 1  ON 27
ci_029                -1.480736e-02 3 1  ON 28
ci_030                -8.809393e-03 3 1  ON 29
ci_031                -8.645547e-03 3 1  ON 30
ci_032                -1.434542e-02 3 1  ON 31
ci_033                 4.533193e-03 3 1  ON 32
ci_034                 4.879220e-03 3 1  ON 33
ci_035                -3.334665e-03 3 1  ON 34
ci_036                -1.117232e-02 3 1  ON 35
ci_037                -1.149749e-02 3 1  ON 36
ci_038                 8.868424e-04 3 1  ON 37
ci_039                 1.150591e-03 3 1  ON 38
ci_040                -1.541106e-03 3 1  ON 39
ci_041                 8.199458e-03 3 1  ON 40
ci_042                 8.164752e-03 3 1  ON 41
ci_043                -2.347256e-03 3 1  ON 42
ci_044                -3.914954e-03 3 1  ON 43
ci_045                -1.992975e-03 3 1  ON 44
ci_046                 4.799698e-03 3 1  ON 45
ci_047                 4.595429e-03 3 1  ON 46
ci_048                -1.234335e-02 3 1  ON 47
ci_049                -1.294969e-02 3 1  ON 48
ci_050                 2.830690e-03 3 1  ON 49
ci_051                 2.975641e-03 3 1  ON 50
ci_052                -2.218309e-03 3 1  ON 51
ci_053                -2.216495e-03 3 1  ON 52
ci_054                -2.217119e-03 3 1  ON 53
ci_055                -2.424550e-03 3 1  ON 54
ci_056                 4.640702e-03 3 1  ON 55
ci_057                 4.617418e-03 3 1  ON 56
ci_058                -2.143078e-03 3 1  ON 57
ci_059                -2.053659e-03 3 1  ON 58
ci_060                 4.765191e-03 3 1  ON 59
ci_061                 5.216453e-03 3 1  ON 60
ci_062                -2.958905e-03 3 1  ON 61
ci_063                -2.804503e-03 3 1  ON 62
ci_064                -2.257829e-03 3 1  ON 63
ci_065                -3.392886e-03 3 1  ON 64
ci_066                 4.066494e-03 3 1  ON 65
ci_067                 4.238525e-03 3 1  ON 66
ci_068                -4.265211e-03 3 1  ON 67
ci_069                -4.086756e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9164e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1799
    reference variance = 0.192076
====================================================
  Execution time = 1.3726e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9816e-01
  Total weights = 1.957687911e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5543e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285779310274
                                         uncertainty =       0.001501315866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285779310274
                                         uncertainty =       0.001501315866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377997488
  error estimate for blocks of size 2^( 2) =       0.000388917301
  error estimate for blocks of size 2^( 3) =       0.000399218110
  error estimate for blocks of size 2^( 4) =       0.000407627647
  error estimate for blocks of size 2^( 5) =       0.000412673271
  error estimate for blocks of size 2^( 6) =       0.000415030896
  error estimate for blocks of size 2^( 7) =       0.000416393189

      target function =      -0.915531373940
              le_mean =     -17.214937804859
             les_mean =     296.652240670855
             stat err =       0.000412931251
             autocorr =       1.193377036660
   target nu stat err =       0.000412931251
   target dn stat err =       0.002017910528
      target stat err =       0.003231271197
              std dev =       0.534569173809
             le_variance =       0.285764201587


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721493780486e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915541829541       residual = 9.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915591795323       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915600611170       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915603542423       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915604032554       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915604231055       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915604240783       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915604263758       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915604262796       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915604272165       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 2.675863e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915541829541       residual = 9.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915555475599       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915557825430       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915558589387       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915558713266       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915558763947       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915558765668       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915558771406       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915558771151       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915558773497       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 7.236554e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915541829541       residual = 9.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915545321749       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915545919014       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915546111983       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915546143004       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915546155736       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915546156119       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915546157550       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915546157485       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915546158071       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.846878e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133958 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6289e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -3.752689e-02 3 1  ON 0
ci_002                -2.877045e-02 3 1  ON 1
ci_003                -2.361159e-02 3 1  ON 2
ci_004                 2.082801e-02 3 1  ON 3
ci_005                 2.132351e-02 3 1  ON 4
ci_006                -1.842486e-02 3 1  ON 5
ci_007                -1.850952e-02 3 1  ON 6
ci_008                -7.750593e-03 3 1  ON 7
ci_009                -1.392281e-02 3 1  ON 8
ci_010                -8.907260e-03 3 1  ON 9
ci_011                -8.964436e-03 3 1  ON 10
ci_012                -9.134728e-03 3 1  ON 11
ci_013                -1.912599e-02 3 1  ON 12
ci_014                 1.113534e-02 3 1  ON 13
ci_015                 1.099512e-02 3 1  ON 14
ci_016                 1.591986e-02 3 1  ON 15
ci_017                 1.560801e-02 3 1  ON 16
ci_018                 9.123994e-03 3 1  ON 17
ci_019                 8.971114e-03 3 1  ON 18
ci_020                 1.510966e-02 3 1  ON 19
ci_021                 1.523960e-02 3 1  ON 20
ci_022                 8.274985e-03 3 1  ON 21
ci_023                 8.326229e-03 3 1  ON 22
ci_024                 8.390661e-03 3 1  ON 23
ci_025                 8.458403e-03 3 1  ON 24
ci_026                 9.910553e-03 3 1  ON 25
ci_027                 9.665043e-03 3 1  ON 26
ci_028                -1.455156e-02 3 1  ON 27
ci_029                -1.477908e-02 3 1  ON 28
ci_030                -8.818708e-03 3 1  ON 29
ci_031                -8.632240e-03 3 1  ON 30
ci_032                -1.436870e-02 3 1  ON 31
ci_033                 4.533928e-03 3 1  ON 32
ci_034                 4.842735e-03 3 1  ON 33
ci_035                -3.322477e-03 3 1  ON 34
ci_036                -1.120611e-02 3 1  ON 35
ci_037                -1.149965e-02 3 1  ON 36
ci_038                 8.797063e-04 3 1  ON 37
ci_039                 1.135917e-03 3 1  ON 38
ci_040                -1.542947e-03 3 1  ON 39
ci_041                 8.170507e-03 3 1  ON 40
ci_042                 8.166286e-03 3 1  ON 41
ci_043                -2.340738e-03 3 1  ON 42
ci_044                -3.987320e-03 3 1  ON 43
ci_045                -1.988412e-03 3 1  ON 44
ci_046                 4.786461e-03 3 1  ON 45
ci_047                 4.592013e-03 3 1  ON 46
ci_048                -1.236909e-02 3 1  ON 47
ci_049                -1.294222e-02 3 1  ON 48
ci_050                 2.851027e-03 3 1  ON 49
ci_051                 2.989814e-03 3 1  ON 50
ci_052                -2.225445e-03 3 1  ON 51
ci_053                -2.239598e-03 3 1  ON 52
ci_054                -2.206734e-03 3 1  ON 53
ci_055                -2.424219e-03 3 1  ON 54
ci_056                 4.640046e-03 3 1  ON 55
ci_057                 4.613353e-03 3 1  ON 56
ci_058                -2.146784e-03 3 1  ON 57
ci_059                -2.044779e-03 3 1  ON 58
ci_060                 4.762424e-03 3 1  ON 59
ci_061                 5.225122e-03 3 1  ON 60
ci_062                -2.936061e-03 3 1  ON 61
ci_063                -2.810805e-03 3 1  ON 62
ci_064                -2.261946e-03 3 1  ON 63
ci_065                -3.389676e-03 3 1  ON 64
ci_066                 4.070747e-03 3 1  ON 65
ci_067                 4.225871e-03 3 1  ON 66
ci_068                -4.233671e-03 3 1  ON 67
ci_069                -4.100277e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1606
    reference variance = 0.379888
====================================================
  Execution time = 1.5979e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9967e-01
  Total weights = 1.9574e+06
  Execution time = 1.8528e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286230306237
                                         uncertainty =       0.001478423357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286230306237
                                         uncertainty =       0.001478423357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378305465
  error estimate for blocks of size 2^( 2) =       0.000389602078
  error estimate for blocks of size 2^( 3) =       0.000400300408
  error estimate for blocks of size 2^( 4) =       0.000408052605
  error estimate for blocks of size 2^( 5) =       0.000412640451
  error estimate for blocks of size 2^( 6) =       0.000414738724
  error estimate for blocks of size 2^( 7) =       0.000415838919

      target function =      -0.896472588326
              le_mean =     -17.214120657048
             les_mean =     296.636456939502
             stat err =       0.000412817675
             autocorr =       1.190779464711
   target nu stat err =       0.000412817675
   target dn stat err =       0.009371561078
      target stat err =       0.014040694722
              std dev =       0.535004719309
             le_variance =       0.286230049683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286230454911
                                         uncertainty =       0.001481333777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286230454911
                                         uncertainty =       0.001481333777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378305383
  error estimate for blocks of size 2^( 2) =       0.000389598479
  error estimate for blocks of size 2^( 3) =       0.000400291136
  error estimate for blocks of size 2^( 4) =       0.000408042925
  error estimate for blocks of size 2^( 5) =       0.000412633046
  error estimate for blocks of size 2^( 6) =       0.000414739083
  error estimate for blocks of size 2^( 7) =       0.000415842600

      target function =      -0.907893353581
              le_mean =     -17.214122115664
             les_mean =     296.629087950734
             stat err =       0.000412814413
             autocorr =       1.190761167101
   target nu stat err =       0.000412814413
   target dn stat err =       0.004056731526
      target stat err =       0.006263993156
              std dev =       0.535004603066
             le_variance =       0.286229925302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286228614756
                                         uncertainty =       0.001479990431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286228614756
                                         uncertainty =       0.001479990431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378304251
  error estimate for blocks of size 2^( 2) =       0.000389598998
  error estimate for blocks of size 2^( 3) =       0.000400294387
  error estimate for blocks of size 2^( 4) =       0.000408046147
  error estimate for blocks of size 2^( 5) =       0.000412635411
  error estimate for blocks of size 2^( 6) =       0.000414737330
  error estimate for blocks of size 2^( 7) =       0.000415838198

      target function =      -0.904973945525
              le_mean =     -17.214121493406
             les_mean =     296.630949739765
             stat err =       0.000412814271
             autocorr =       1.190767474600
   target nu stat err =       0.000412814271
   target dn stat err =       0.005626340148
      target stat err =       0.008606633680
              std dev =       0.535003002000
             le_variance =       0.286228212149

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286229693473
                                         uncertainty =       0.001478632175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286229693473
                                         uncertainty =       0.001478632175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378305048
  error estimate for blocks of size 2^( 2) =       0.000389601512
  error estimate for blocks of size 2^( 3) =       0.000400300122
  error estimate for blocks of size 2^( 4) =       0.000408052174
  error estimate for blocks of size 2^( 5) =       0.000412640332
  error estimate for blocks of size 2^( 6) =       0.000414738252
  error estimate for blocks of size 2^( 7) =       0.000415836914

      target function =      -0.913282070398
              le_mean =     -17.214120833744
             les_mean =     296.625570559093
             stat err =       0.000412816918
             autocorr =       1.190777724486
   target nu stat err =       0.000412816918
   target dn stat err =       0.002410476778
      target stat err =       0.003808006132
              std dev =       0.535004129493
             le_variance =       0.286229418574


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.896472588326        initial
     6.2500e-01     6.2500e+00             2.6759e-04        -0.907893353581
     2.5000e+00     2.5000e+01             7.2366e-05        -0.904973945525
     1.0000e+01     1.0000e+02             1.8469e-05        -0.913282070398  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 2.5384e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -3.754156e-02 3 1  ON 0
ci_002                -2.876204e-02 3 1  ON 1
ci_003                -2.361752e-02 3 1  ON 2
ci_004                 2.080862e-02 3 1  ON 3
ci_005                 2.133444e-02 3 1  ON 4
ci_006                -1.843904e-02 3 1  ON 5
ci_007                -1.851311e-02 3 1  ON 6
ci_008                -7.765504e-03 3 1  ON 7
ci_009                -1.393113e-02 3 1  ON 8
ci_010                -8.890336e-03 3 1  ON 9
ci_011                -8.977141e-03 3 1  ON 10
ci_012                -9.132941e-03 3 1  ON 11
ci_013                -1.910193e-02 3 1  ON 12
ci_014                 1.114085e-02 3 1  ON 13
ci_015                 1.098282e-02 3 1  ON 14
ci_016                 1.592331e-02 3 1  ON 15
ci_017                 1.562400e-02 3 1  ON 16
ci_018                 9.106630e-03 3 1  ON 17
ci_019                 8.951778e-03 3 1  ON 18
ci_020                 1.509090e-02 3 1  ON 19
ci_021                 1.524480e-02 3 1  ON 20
ci_022                 8.266978e-03 3 1  ON 21
ci_023                 8.318957e-03 3 1  ON 22
ci_024                 8.407849e-03 3 1  ON 23
ci_025                 8.472552e-03 3 1  ON 24
ci_026                 9.923335e-03 3 1  ON 25
ci_027                 9.666829e-03 3 1  ON 26
ci_028                -1.452416e-02 3 1  ON 27
ci_029                -1.480016e-02 3 1  ON 28
ci_030                -8.811761e-03 3 1  ON 29
ci_031                -8.642151e-03 3 1  ON 30
ci_032                -1.435135e-02 3 1  ON 31
ci_033                 4.533385e-03 3 1  ON 32
ci_034                 4.869918e-03 3 1  ON 33
ci_035                -3.331550e-03 3 1  ON 34
ci_036                -1.118097e-02 3 1  ON 35
ci_037                -1.149805e-02 3 1  ON 36
ci_038                 8.850174e-04 3 1  ON 37
ci_039                 1.146838e-03 3 1  ON 38
ci_040                -1.541576e-03 3 1  ON 39
ci_041                 8.192038e-03 3 1  ON 40
ci_042                 8.165162e-03 3 1  ON 41
ci_043                -2.345590e-03 3 1  ON 42
ci_044                -3.933423e-03 3 1  ON 43
ci_045                -1.991807e-03 3 1  ON 44
ci_046                 4.796321e-03 3 1  ON 45
ci_047                 4.594556e-03 3 1  ON 46
ci_048                -1.234989e-02 3 1  ON 47
ci_049                -1.294780e-02 3 1  ON 48
ci_050                 2.835896e-03 3 1  ON 49
ci_051                 2.979272e-03 3 1  ON 50
ci_052                -2.220136e-03 3 1  ON 51
ci_053                -2.222406e-03 3 1  ON 52
ci_054                -2.214470e-03 3 1  ON 53
ci_055                -2.424466e-03 3 1  ON 54
ci_056                 4.640534e-03 3 1  ON 55
ci_057                 4.616379e-03 3 1  ON 56
ci_058                -2.144034e-03 3 1  ON 57
ci_059                -2.051389e-03 3 1  ON 58
ci_060                 4.764486e-03 3 1  ON 59
ci_061                 5.218664e-03 3 1  ON 60
ci_062                -2.953079e-03 3 1  ON 61
ci_063                -2.806117e-03 3 1  ON 62
ci_064                -2.258883e-03 3 1  ON 63
ci_065                -3.392065e-03 3 1  ON 64
ci_066                 4.067580e-03 3 1  ON 65
ci_067                 4.235286e-03 3 1  ON 66
ci_068                -4.257166e-03 3 1  ON 67
ci_069                -4.090203e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1680e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2036
    reference variance = 0.300958
====================================================
  Execution time = 1.3849e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0028e-01
  Total weights = 1.957772026e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5385e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286925831686
                                         uncertainty =       0.001848892341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286925831686
                                         uncertainty =       0.001848892341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378749589
  error estimate for blocks of size 2^( 2) =       0.000389853750
  error estimate for blocks of size 2^( 3) =       0.000399834109
  error estimate for blocks of size 2^( 4) =       0.000407056343
  error estimate for blocks of size 2^( 5) =       0.000411069093
  error estimate for blocks of size 2^( 6) =       0.000413714578
  error estimate for blocks of size 2^( 7) =       0.000414666735

      target function =      -0.912215273691
              le_mean =     -17.215124112778
             les_mean =     296.660777983033
             stat err =       0.000411626687
             autocorr =       1.181143618439
   target nu stat err =       0.000411626687
   target dn stat err =       0.002365956158
      target stat err =       0.003738105973
              std dev =       0.535632804859
             le_variance =       0.286902501642


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721512411278e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912229677992       residual = 7.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912239629299       residual = 8.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912241309614       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912241831965       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912242018404       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912242047613       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912242043671       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912242049774       residual = 7.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912242048171       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912242049260       residual = 4.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 4.425322e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912229677992       residual = 7.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912232224439       residual = 8.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912232652330       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912232784281       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912232831247       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912232838606       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912232837586       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912232839117       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912232838711       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912232838978       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.125340e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912229677992       residual = 7.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912230318376       residual = 8.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912230425849       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912230458922       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912230470685       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912230472529       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912230472271       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912230472654       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912230472553       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912230472619       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 2.825487e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137646 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6397e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -3.753031e-02 3 1  ON 0
ci_002                -2.875848e-02 3 1  ON 1
ci_003                -2.361442e-02 3 1  ON 2
ci_004                 2.081505e-02 3 1  ON 3
ci_005                 2.133131e-02 3 1  ON 4
ci_006                -1.843770e-02 3 1  ON 5
ci_007                -1.851196e-02 3 1  ON 6
ci_008                -7.764507e-03 3 1  ON 7
ci_009                -1.392684e-02 3 1  ON 8
ci_010                -8.889407e-03 3 1  ON 9
ci_011                -8.975955e-03 3 1  ON 10
ci_012                -9.130514e-03 3 1  ON 11
ci_013                -1.909568e-02 3 1  ON 12
ci_014                 1.113744e-02 3 1  ON 13
ci_015                 1.098350e-02 3 1  ON 14
ci_016                 1.592565e-02 3 1  ON 15
ci_017                 1.562256e-02 3 1  ON 16
ci_018                 9.105202e-03 3 1  ON 17
ci_019                 8.960497e-03 3 1  ON 18
ci_020                 1.509188e-02 3 1  ON 19
ci_021                 1.524094e-02 3 1  ON 20
ci_022                 8.272151e-03 3 1  ON 21
ci_023                 8.319767e-03 3 1  ON 22
ci_024                 8.401800e-03 3 1  ON 23
ci_025                 8.466728e-03 3 1  ON 24
ci_026                 9.915612e-03 3 1  ON 25
ci_027                 9.667665e-03 3 1  ON 26
ci_028                -1.451909e-02 3 1  ON 27
ci_029                -1.479456e-02 3 1  ON 28
ci_030                -8.810039e-03 3 1  ON 29
ci_031                -8.645302e-03 3 1  ON 30
ci_032                -1.435031e-02 3 1  ON 31
ci_033                 4.527036e-03 3 1  ON 32
ci_034                 4.871834e-03 3 1  ON 33
ci_035                -3.331706e-03 3 1  ON 34
ci_036                -1.118692e-02 3 1  ON 35
ci_037                -1.150401e-02 3 1  ON 36
ci_038                 8.810869e-04 3 1  ON 37
ci_039                 1.147879e-03 3 1  ON 38
ci_040                -1.542130e-03 3 1  ON 39
ci_041                 8.188418e-03 3 1  ON 40
ci_042                 8.166503e-03 3 1  ON 41
ci_043                -2.347673e-03 3 1  ON 42
ci_044                -3.941486e-03 3 1  ON 43
ci_045                -1.992489e-03 3 1  ON 44
ci_046                 4.797416e-03 3 1  ON 45
ci_047                 4.593014e-03 3 1  ON 46
ci_048                -1.234539e-02 3 1  ON 47
ci_049                -1.294127e-02 3 1  ON 48
ci_050                 2.839620e-03 3 1  ON 49
ci_051                 2.984791e-03 3 1  ON 50
ci_052                -2.215132e-03 3 1  ON 51
ci_053                -2.220083e-03 3 1  ON 52
ci_054                -2.211507e-03 3 1  ON 53
ci_055                -2.421464e-03 3 1  ON 54
ci_056                 4.638569e-03 3 1  ON 55
ci_057                 4.617582e-03 3 1  ON 56
ci_058                -2.142523e-03 3 1  ON 57
ci_059                -2.047648e-03 3 1  ON 58
ci_060                 4.765772e-03 3 1  ON 59
ci_061                 5.213765e-03 3 1  ON 60
ci_062                -2.956892e-03 3 1  ON 61
ci_063                -2.805340e-03 3 1  ON 62
ci_064                -2.262096e-03 3 1  ON 63
ci_065                -3.391095e-03 3 1  ON 64
ci_066                 4.064029e-03 3 1  ON 65
ci_067                 4.236294e-03 3 1  ON 66
ci_068                -4.261067e-03 3 1  ON 67
ci_069                -4.094494e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2767
    reference variance = 0.372499
====================================================
  Execution time = 1.3485e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0827e-01
  Total weights = 1.9577e+06
  Execution time = 1.8562e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286819317798
                                         uncertainty =       0.001675419918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286819317798
                                         uncertainty =       0.001675419918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378712309
  error estimate for blocks of size 2^( 2) =       0.000390221098
  error estimate for blocks of size 2^( 3) =       0.000400064595
  error estimate for blocks of size 2^( 4) =       0.000407621573
  error estimate for blocks of size 2^( 5) =       0.000412951745
  error estimate for blocks of size 2^( 6) =       0.000414475824
  error estimate for blocks of size 2^( 7) =       0.000413465537

      target function =      -0.899811442496
              le_mean =     -17.214616154926
             les_mean =     296.651291238490
             stat err =       0.000412128670
             autocorr =       1.184259326533
   target nu stat err =       0.000412128670
   target dn stat err =       0.008800001475
      target stat err =       0.013296614339
              std dev =       0.535580083079
             le_variance =       0.286846025391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286817953109
                                         uncertainty =       0.001676228142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286817953109
                                         uncertainty =       0.001676228142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378711452
  error estimate for blocks of size 2^( 2) =       0.000390221781
  error estimate for blocks of size 2^( 3) =       0.000400066674
  error estimate for blocks of size 2^( 4) =       0.000407624583
  error estimate for blocks of size 2^( 5) =       0.000412955500
  error estimate for blocks of size 2^( 6) =       0.000414480549
  error estimate for blocks of size 2^( 7) =       0.000413468321

      target function =      -0.899817821629
              le_mean =     -17.214617095780
             les_mean =     296.651318632532
             stat err =       0.000412132238
             autocorr =       1.184285190361
   target nu stat err =       0.000412132238
   target dn stat err =       0.008824849771
      target stat err =       0.013334287242
              std dev =       0.535578872025
             le_variance =       0.286844728160

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286818548711
                                         uncertainty =       0.001675831952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286818548711
                                         uncertainty =       0.001675831952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378711824
  error estimate for blocks of size 2^( 2) =       0.000390221397
  error estimate for blocks of size 2^( 3) =       0.000400065606
  error estimate for blocks of size 2^( 4) =       0.000407623061
  error estimate for blocks of size 2^( 5) =       0.000412953617
  error estimate for blocks of size 2^( 6) =       0.000414478192
  error estimate for blocks of size 2^( 7) =       0.000413466908

      target function =      -0.899826385723
              le_mean =     -17.214616629447
             les_mean =     296.651297268170
             stat err =       0.000412130445
             autocorr =       1.184272559089
   target nu stat err =       0.000412130445
   target dn stat err =       0.008812960756
      target stat err =       0.013316604933
              std dev =       0.535579397300
             le_variance =       0.286845290813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286819211978
                                         uncertainty =       0.001675471536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286819211978
                                         uncertainty =       0.001675471536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378712242
  error estimate for blocks of size 2^( 2) =       0.000390221129
  error estimate for blocks of size 2^( 3) =       0.000400064716
  error estimate for blocks of size 2^( 4) =       0.000407621755
  error estimate for blocks of size 2^( 5) =       0.000412951975
  error estimate for blocks of size 2^( 6) =       0.000414476116
  error estimate for blocks of size 2^( 7) =       0.000413465703

      target function =      -0.899815025859
              le_mean =     -17.214616213815
             les_mean =     296.651290839826
             stat err =       0.000412128887
             autocorr =       1.184260995736
   target nu stat err =       0.000412128887
   target dn stat err =       0.008801634368
      target stat err =       0.013299183296
              std dev =       0.535579988341
             le_variance =       0.286845923911


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.899811442496        initial
     2.5000e+00     2.5000e+01             4.4253e-05        -0.899817821629
     1.0000e+01     1.0000e+02             1.1253e-05        -0.899826385723  <--
     4.0000e+01     4.0000e+02             2.8255e-06        -0.899815025859

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 2.2866e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -3.753031e-02 3 1  ON 0
ci_002                -2.875848e-02 3 1  ON 1
ci_003                -2.361442e-02 3 1  ON 2
ci_004                 2.081505e-02 3 1  ON 3
ci_005                 2.133131e-02 3 1  ON 4
ci_006                -1.843770e-02 3 1  ON 5
ci_007                -1.851196e-02 3 1  ON 6
ci_008                -7.764507e-03 3 1  ON 7
ci_009                -1.392684e-02 3 1  ON 8
ci_010                -8.889407e-03 3 1  ON 9
ci_011                -8.975955e-03 3 1  ON 10
ci_012                -9.130514e-03 3 1  ON 11
ci_013                -1.909568e-02 3 1  ON 12
ci_014                 1.113744e-02 3 1  ON 13
ci_015                 1.098350e-02 3 1  ON 14
ci_016                 1.592565e-02 3 1  ON 15
ci_017                 1.562256e-02 3 1  ON 16
ci_018                 9.105202e-03 3 1  ON 17
ci_019                 8.960497e-03 3 1  ON 18
ci_020                 1.509188e-02 3 1  ON 19
ci_021                 1.524094e-02 3 1  ON 20
ci_022                 8.272151e-03 3 1  ON 21
ci_023                 8.319767e-03 3 1  ON 22
ci_024                 8.401800e-03 3 1  ON 23
ci_025                 8.466728e-03 3 1  ON 24
ci_026                 9.915612e-03 3 1  ON 25
ci_027                 9.667665e-03 3 1  ON 26
ci_028                -1.451909e-02 3 1  ON 27
ci_029                -1.479456e-02 3 1  ON 28
ci_030                -8.810039e-03 3 1  ON 29
ci_031                -8.645302e-03 3 1  ON 30
ci_032                -1.435031e-02 3 1  ON 31
ci_033                 4.527036e-03 3 1  ON 32
ci_034                 4.871834e-03 3 1  ON 33
ci_035                -3.331706e-03 3 1  ON 34
ci_036                -1.118692e-02 3 1  ON 35
ci_037                -1.150401e-02 3 1  ON 36
ci_038                 8.810869e-04 3 1  ON 37
ci_039                 1.147879e-03 3 1  ON 38
ci_040                -1.542130e-03 3 1  ON 39
ci_041                 8.188418e-03 3 1  ON 40
ci_042                 8.166503e-03 3 1  ON 41
ci_043                -2.347673e-03 3 1  ON 42
ci_044                -3.941486e-03 3 1  ON 43
ci_045                -1.992489e-03 3 1  ON 44
ci_046                 4.797416e-03 3 1  ON 45
ci_047                 4.593014e-03 3 1  ON 46
ci_048                -1.234539e-02 3 1  ON 47
ci_049                -1.294127e-02 3 1  ON 48
ci_050                 2.839620e-03 3 1  ON 49
ci_051                 2.984791e-03 3 1  ON 50
ci_052                -2.215132e-03 3 1  ON 51
ci_053                -2.220083e-03 3 1  ON 52
ci_054                -2.211507e-03 3 1  ON 53
ci_055                -2.421464e-03 3 1  ON 54
ci_056                 4.638569e-03 3 1  ON 55
ci_057                 4.617582e-03 3 1  ON 56
ci_058                -2.142523e-03 3 1  ON 57
ci_059                -2.047648e-03 3 1  ON 58
ci_060                 4.765772e-03 3 1  ON 59
ci_061                 5.213765e-03 3 1  ON 60
ci_062                -2.956892e-03 3 1  ON 61
ci_063                -2.805340e-03 3 1  ON 62
ci_064                -2.262096e-03 3 1  ON 63
ci_065                -3.391095e-03 3 1  ON 64
ci_066                 4.064029e-03 3 1  ON 65
ci_067                 4.236294e-03 3 1  ON 66
ci_068                -4.261067e-03 3 1  ON 67
ci_069                -4.094494e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9270e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2405
    reference variance = 0.591308
====================================================
  Execution time = 1.3985e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9513e-01
  Total weights = 1.957704660e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4986e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283764566020
                                         uncertainty =       0.001987586153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283764566020
                                         uncertainty =       0.001987586153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376631904
  error estimate for blocks of size 2^( 2) =       0.000387974980
  error estimate for blocks of size 2^( 3) =       0.000398309284
  error estimate for blocks of size 2^( 4) =       0.000406313339
  error estimate for blocks of size 2^( 5) =       0.000410920820
  error estimate for blocks of size 2^( 6) =       0.000413174935
  error estimate for blocks of size 2^( 7) =       0.000414232428

      target function =      -0.920293908965
              le_mean =     -17.214369865120
             les_mean =     296.629659929649
             stat err =       0.000411160381
             autocorr =       1.191758637198
   target nu stat err =       0.000411160381
   target dn stat err =       0.002367417155
      target stat err =       0.003800216254
              std dev =       0.532637946071
             le_variance =       0.283703181595


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721436986512e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920308718228       residual = 2.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920341899505       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920343646587       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920344333663       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920344362336       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920344375414       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920344377349       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920344372048       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920344372855       residual = 7.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 7.059127e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920308718228       residual = 2.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920317212100       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920317656658       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920317830394       residual = 5.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920317837436       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920317840675       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920317841186       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920317839857       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920317840064       residual = 7.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.807700e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920308718228       residual = 2.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920310854479       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920310966115       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920311009673       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920311011425       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920311012233       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920311012362       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920311012030       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920311012082       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 4.546891e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140738 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6492e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -3.752832e-02 3 1  ON 0
ci_002                -2.875818e-02 3 1  ON 1
ci_003                -2.361402e-02 3 1  ON 2
ci_004                 2.081842e-02 3 1  ON 3
ci_005                 2.132350e-02 3 1  ON 4
ci_006                -1.842701e-02 3 1  ON 5
ci_007                -1.850999e-02 3 1  ON 6
ci_008                -7.771440e-03 3 1  ON 7
ci_009                -1.392184e-02 3 1  ON 8
ci_010                -8.883101e-03 3 1  ON 9
ci_011                -8.970996e-03 3 1  ON 10
ci_012                -9.126867e-03 3 1  ON 11
ci_013                -1.909447e-02 3 1  ON 12
ci_014                 1.113625e-02 3 1  ON 13
ci_015                 1.097240e-02 3 1  ON 14
ci_016                 1.592403e-02 3 1  ON 15
ci_017                 1.562487e-02 3 1  ON 16
ci_018                 9.104312e-03 3 1  ON 17
ci_019                 8.970499e-03 3 1  ON 18
ci_020                 1.508171e-02 3 1  ON 19
ci_021                 1.523873e-02 3 1  ON 20
ci_022                 8.272356e-03 3 1  ON 21
ci_023                 8.306377e-03 3 1  ON 22
ci_024                 8.388844e-03 3 1  ON 23
ci_025                 8.461707e-03 3 1  ON 24
ci_026                 9.916510e-03 3 1  ON 25
ci_027                 9.677484e-03 3 1  ON 26
ci_028                -1.452114e-02 3 1  ON 27
ci_029                -1.479800e-02 3 1  ON 28
ci_030                -8.796957e-03 3 1  ON 29
ci_031                -8.637020e-03 3 1  ON 30
ci_032                -1.434320e-02 3 1  ON 31
ci_033                 4.529394e-03 3 1  ON 32
ci_034                 4.872247e-03 3 1  ON 33
ci_035                -3.331952e-03 3 1  ON 34
ci_036                -1.119009e-02 3 1  ON 35
ci_037                -1.149752e-02 3 1  ON 36
ci_038                 8.779937e-04 3 1  ON 37
ci_039                 1.148175e-03 3 1  ON 38
ci_040                -1.542390e-03 3 1  ON 39
ci_041                 8.188483e-03 3 1  ON 40
ci_042                 8.168891e-03 3 1  ON 41
ci_043                -2.347508e-03 3 1  ON 42
ci_044                -3.936928e-03 3 1  ON 43
ci_045                -1.996140e-03 3 1  ON 44
ci_046                 4.793720e-03 3 1  ON 45
ci_047                 4.597048e-03 3 1  ON 46
ci_048                -1.235504e-02 3 1  ON 47
ci_049                -1.294276e-02 3 1  ON 48
ci_050                 2.839314e-03 3 1  ON 49
ci_051                 2.984661e-03 3 1  ON 50
ci_052                -2.203503e-03 3 1  ON 51
ci_053                -2.217357e-03 3 1  ON 52
ci_054                -2.211606e-03 3 1  ON 53
ci_055                -2.421843e-03 3 1  ON 54
ci_056                 4.633038e-03 3 1  ON 55
ci_057                 4.621993e-03 3 1  ON 56
ci_058                -2.124446e-03 3 1  ON 57
ci_059                -2.056553e-03 3 1  ON 58
ci_060                 4.764951e-03 3 1  ON 59
ci_061                 5.214597e-03 3 1  ON 60
ci_062                -2.957991e-03 3 1  ON 61
ci_063                -2.806287e-03 3 1  ON 62
ci_064                -2.260191e-03 3 1  ON 63
ci_065                -3.389793e-03 3 1  ON 64
ci_066                 4.062420e-03 3 1  ON 65
ci_067                 4.236386e-03 3 1  ON 66
ci_068                -4.264019e-03 3 1  ON 67
ci_069                -4.100067e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2361
    reference variance = 0.29014
====================================================
  Execution time = 1.3379e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9772e-01
  Total weights = 1.9577e+06
  Execution time = 1.8544e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286562204424
                                         uncertainty =       0.001833622375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286562204424
                                         uncertainty =       0.001833622375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378498361
  error estimate for blocks of size 2^( 2) =       0.000390061060
  error estimate for blocks of size 2^( 3) =       0.000400739408
  error estimate for blocks of size 2^( 4) =       0.000409183362
  error estimate for blocks of size 2^( 5) =       0.000413913245
  error estimate for blocks of size 2^( 6) =       0.000415480956
  error estimate for blocks of size 2^( 7) =       0.000416074583

      target function =      -0.916204333413
              le_mean =     -17.214608705231
             les_mean =     296.640485212876
             stat err =       0.000413663037
             autocorr =       1.194442985951
   target nu stat err =       0.000413663037
   target dn stat err =       0.002088112800
      target stat err =       0.003341439216
              std dev =       0.535277515972
             le_variance =       0.286522019106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286550240273
                                         uncertainty =       0.001832766162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286550240273
                                         uncertainty =       0.001832766162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378490463
  error estimate for blocks of size 2^( 2) =       0.000390055861
  error estimate for blocks of size 2^( 3) =       0.000400737894
  error estimate for blocks of size 2^( 4) =       0.000409185615
  error estimate for blocks of size 2^( 5) =       0.000413914390
  error estimate for blocks of size 2^( 6) =       0.000415481419
  error estimate for blocks of size 2^( 7) =       0.000416077132

      target function =      -0.916265960176
              le_mean =     -17.214608387807
             les_mean =     296.640434901045
             stat err =       0.000413664639
             autocorr =       1.194502091485
   target nu stat err =       0.000413664639
   target dn stat err =       0.002086648321
      target stat err =       0.003339638160
              std dev =       0.535266345839
             le_variance =       0.286510060988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286555888220
                                         uncertainty =       0.001833177226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286555888220
                                         uncertainty =       0.001833177226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378494192
  error estimate for blocks of size 2^( 2) =       0.000390058269
  error estimate for blocks of size 2^( 3) =       0.000400738499
  error estimate for blocks of size 2^( 4) =       0.000409184379
  error estimate for blocks of size 2^( 5) =       0.000413913691
  error estimate for blocks of size 2^( 6) =       0.000415481058
  error estimate for blocks of size 2^( 7) =       0.000416075749

      target function =      -0.916238712046
              le_mean =     -17.214608521154
             les_mean =     296.640456904795
             stat err =       0.000413663719
             autocorr =       1.194473245325
   target nu stat err =       0.000413663719
   target dn stat err =       0.002087282706
      target stat err =       0.003340414362
              std dev =       0.535271619011
             le_variance =       0.286515706119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286561385442
                                         uncertainty =       0.001833565593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286561385442
                                         uncertainty =       0.001833565593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378497821
  error estimate for blocks of size 2^( 2) =       0.000390060693
  error estimate for blocks of size 2^( 3) =       0.000400739277
  error estimate for blocks of size 2^( 4) =       0.000409183474
  error estimate for blocks of size 2^( 5) =       0.000413913285
  error estimate for blocks of size 2^( 6) =       0.000415480953
  error estimate for blocks of size 2^( 7) =       0.000416074713

      target function =      -0.916208980167
              le_mean =     -17.214608679543
             les_mean =     296.640481358774
             stat err =       0.000413663106
             autocorr =       1.194446798752
   target nu stat err =       0.000413663106
   target dn stat err =       0.002087998390
      target stat err =       0.003341297310
              std dev =       0.535276751360
             le_variance =       0.286521200546


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916204333413        initial
     2.5000e+00     2.5000e+01             7.0591e-05        -0.916265960176  <--
     1.0000e+01     1.0000e+02             1.8077e-05        -0.916238712046
     4.0000e+01     4.0000e+02             4.5469e-06        -0.916208980167

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.2728e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -3.752254e-02 3 1  ON 0
ci_002                -2.875730e-02 3 1  ON 1
ci_003                -2.361285e-02 3 1  ON 2
ci_004                 2.082832e-02 3 1  ON 3
ci_005                 2.130076e-02 3 1  ON 4
ci_006                -1.839566e-02 3 1  ON 5
ci_007                -1.850420e-02 3 1  ON 6
ci_008                -7.791568e-03 3 1  ON 7
ci_009                -1.390728e-02 3 1  ON 8
ci_010                -8.864708e-03 3 1  ON 9
ci_011                -8.956557e-03 3 1  ON 10
ci_012                -9.116244e-03 3 1  ON 11
ci_013                -1.909094e-02 3 1  ON 12
ci_014                 1.113269e-02 3 1  ON 13
ci_015                 1.094010e-02 3 1  ON 14
ci_016                 1.591931e-02 3 1  ON 15
ci_017                 1.563164e-02 3 1  ON 16
ci_018                 9.101700e-03 3 1  ON 17
ci_019                 8.999521e-03 3 1  ON 18
ci_020                 1.505205e-02 3 1  ON 19
ci_021                 1.523225e-02 3 1  ON 20
ci_022                 8.272973e-03 3 1  ON 21
ci_023                 8.267346e-03 3 1  ON 22
ci_024                 8.350950e-03 3 1  ON 23
ci_025                 8.447026e-03 3 1  ON 24
ci_026                 9.919159e-03 3 1  ON 25
ci_027                 9.706007e-03 3 1  ON 26
ci_028                -1.452717e-02 3 1  ON 27
ci_029                -1.480811e-02 3 1  ON 28
ci_030                -8.758942e-03 3 1  ON 29
ci_031                -8.612921e-03 3 1  ON 30
ci_032                -1.432244e-02 3 1  ON 31
ci_033                 4.536283e-03 3 1  ON 32
ci_034                 4.873455e-03 3 1  ON 33
ci_035                -3.332670e-03 3 1  ON 34
ci_036                -1.119930e-02 3 1  ON 35
ci_037                -1.147864e-02 3 1  ON 36
ci_038                 8.689898e-04 3 1  ON 37
ci_039                 1.149036e-03 3 1  ON 38
ci_040                -1.543153e-03 3 1  ON 39
ci_041                 8.188700e-03 3 1  ON 40
ci_042                 8.175876e-03 3 1  ON 41
ci_043                -2.347029e-03 3 1  ON 42
ci_044                -3.923636e-03 3 1  ON 43
ci_045                -2.006761e-03 3 1  ON 44
ci_046                 4.782925e-03 3 1  ON 45
ci_047                 4.608833e-03 3 1  ON 46
ci_048                -1.238314e-02 3 1  ON 47
ci_049                -1.294703e-02 3 1  ON 48
ci_050                 2.838430e-03 3 1  ON 49
ci_051                 2.984287e-03 3 1  ON 50
ci_052                -2.169768e-03 3 1  ON 51
ci_053                -2.209425e-03 3 1  ON 52
ci_054                -2.211861e-03 3 1  ON 53
ci_055                -2.422868e-03 3 1  ON 54
ci_056                 4.616913e-03 3 1  ON 55
ci_057                 4.634847e-03 3 1  ON 56
ci_058                -2.071932e-03 3 1  ON 57
ci_059                -2.082484e-03 3 1  ON 58
ci_060                 4.762564e-03 3 1  ON 59
ci_061                 5.217030e-03 3 1  ON 60
ci_062                -2.961145e-03 3 1  ON 61
ci_063                -2.809026e-03 3 1  ON 62
ci_064                -2.254657e-03 3 1  ON 63
ci_065                -3.386004e-03 3 1  ON 64
ci_066                 4.057725e-03 3 1  ON 65
ci_067                 4.236658e-03 3 1  ON 66
ci_068                -4.272637e-03 3 1  ON 67
ci_069                -4.116351e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9227e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.128
    reference variance = 0.266613
====================================================
  Execution time = 1.3859e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0077e-01
  Total weights = 1.957901274e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286999806725
                                         uncertainty =       0.001490083716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286999806725
                                         uncertainty =       0.001490083716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378802949
  error estimate for blocks of size 2^( 2) =       0.000389965134
  error estimate for blocks of size 2^( 3) =       0.000400611951
  error estimate for blocks of size 2^( 4) =       0.000409125457
  error estimate for blocks of size 2^( 5) =       0.000412634765
  error estimate for blocks of size 2^( 6) =       0.000414600384
  error estimate for blocks of size 2^( 7) =       0.000417609320

      target function =      -0.911449331138
              le_mean =     -17.215282221389
             les_mean =     296.666712980441
             stat err =       0.000413492482
             autocorr =       1.191539741192
   target nu stat err =       0.000413492482
   target dn stat err =       0.002201007596
      target stat err =       0.003482894622
              std dev =       0.535708268041
             le_variance =       0.286983348448


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721528222139e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911461778939       residual = 4.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911488078024       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911492590918       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911493045272       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911493092861       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911493123764       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911493169731       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911493171488       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911493165289       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911493166652       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 1.289702e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911461778939       residual = 4.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911468949228       residual = 4.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911470150146       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911470264100       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911470275051       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911470282951       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911470294403       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911470295082       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911470293456       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911470293765       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 3.462966e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911461778939       residual = 4.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911463613041       residual = 4.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911463918151       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911463946619       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911463949285       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911463951271       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911463954127       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911463954313       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911463953903       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911463953978       residual = 1.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 8.820895e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144411 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6423e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -3.750441e-02 3 1  ON 0
ci_002                -2.875195e-02 3 1  ON 1
ci_003                -2.359356e-02 3 1  ON 2
ci_004                 2.083275e-02 3 1  ON 3
ci_005                 2.126613e-02 3 1  ON 4
ci_006                -1.839709e-02 3 1  ON 5
ci_007                -1.848567e-02 3 1  ON 6
ci_008                -7.775178e-03 3 1  ON 7
ci_009                -1.390105e-02 3 1  ON 8
ci_010                -8.865268e-03 3 1  ON 9
ci_011                -8.945874e-03 3 1  ON 10
ci_012                -9.095601e-03 3 1  ON 11
ci_013                -1.910462e-02 3 1  ON 12
ci_014                 1.115209e-02 3 1  ON 13
ci_015                 1.094155e-02 3 1  ON 14
ci_016                 1.590485e-02 3 1  ON 15
ci_017                 1.564026e-02 3 1  ON 16
ci_018                 9.111133e-03 3 1  ON 17
ci_019                 8.998310e-03 3 1  ON 18
ci_020                 1.502806e-02 3 1  ON 19
ci_021                 1.521999e-02 3 1  ON 20
ci_022                 8.279967e-03 3 1  ON 21
ci_023                 8.237392e-03 3 1  ON 22
ci_024                 8.346461e-03 3 1  ON 23
ci_025                 8.442745e-03 3 1  ON 24
ci_026                 9.917797e-03 3 1  ON 25
ci_027                 9.707651e-03 3 1  ON 26
ci_028                -1.453357e-02 3 1  ON 27
ci_029                -1.479049e-02 3 1  ON 28
ci_030                -8.740702e-03 3 1  ON 29
ci_031                -8.612808e-03 3 1  ON 30
ci_032                -1.432530e-02 3 1  ON 31
ci_033                 4.532960e-03 3 1  ON 32
ci_034                 4.863892e-03 3 1  ON 33
ci_035                -3.334395e-03 3 1  ON 34
ci_036                -1.118878e-02 3 1  ON 35
ci_037                -1.144703e-02 3 1  ON 36
ci_038                 8.657807e-04 3 1  ON 37
ci_039                 1.130855e-03 3 1  ON 38
ci_040                -1.544519e-03 3 1  ON 39
ci_041                 8.171962e-03 3 1  ON 40
ci_042                 8.175538e-03 3 1  ON 41
ci_043                -2.343769e-03 3 1  ON 42
ci_044                -3.935351e-03 3 1  ON 43
ci_045                -2.007837e-03 3 1  ON 44
ci_046                 4.778776e-03 3 1  ON 45
ci_047                 4.632103e-03 3 1  ON 46
ci_048                -1.239262e-02 3 1  ON 47
ci_049                -1.292207e-02 3 1  ON 48
ci_050                 2.855685e-03 3 1  ON 49
ci_051                 2.995534e-03 3 1  ON 50
ci_052                -2.173230e-03 3 1  ON 51
ci_053                -2.208805e-03 3 1  ON 52
ci_054                -2.199584e-03 3 1  ON 53
ci_055                -2.428361e-03 3 1  ON 54
ci_056                 4.627567e-03 3 1  ON 55
ci_057                 4.636790e-03 3 1  ON 56
ci_058                -2.078279e-03 3 1  ON 57
ci_059                -2.106001e-03 3 1  ON 58
ci_060                 4.779602e-03 3 1  ON 59
ci_061                 5.230216e-03 3 1  ON 60
ci_062                -2.953020e-03 3 1  ON 61
ci_063                -2.789458e-03 3 1  ON 62
ci_064                -2.256640e-03 3 1  ON 63
ci_065                -3.388065e-03 3 1  ON 64
ci_066                 4.059768e-03 3 1  ON 65
ci_067                 4.237828e-03 3 1  ON 66
ci_068                -4.269142e-03 3 1  ON 67
ci_069                -4.123011e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.135
    reference variance = 0.243013
====================================================
  Execution time = 1.3515e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0845e-01
  Total weights = 1.9575e+06
  Execution time = 1.8541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284370910120
                                         uncertainty =       0.001774244204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284370910120
                                         uncertainty =       0.001774244204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377085092
  error estimate for blocks of size 2^( 2) =       0.000388142711
  error estimate for blocks of size 2^( 3) =       0.000398746501
  error estimate for blocks of size 2^( 4) =       0.000406780783
  error estimate for blocks of size 2^( 5) =       0.000412002023
  error estimate for blocks of size 2^( 6) =       0.000414958898
  error estimate for blocks of size 2^( 7) =       0.000416055066

      target function =      -0.899646013707
              le_mean =     -17.214032934901
             les_mean =     296.631219011550
             stat err =       0.000412449193
             autocorr =       1.196360839370
   target nu stat err =       0.000412449193
   target dn stat err =       0.012304805057
      target stat err =       0.018556915769
              std dev =       0.533278851907
             le_variance =       0.284386333892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284360371075
                                         uncertainty =       0.001773270464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284360371075
                                         uncertainty =       0.001773270464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377078007
  error estimate for blocks of size 2^( 2) =       0.000388138891
  error estimate for blocks of size 2^( 3) =       0.000398746262
  error estimate for blocks of size 2^( 4) =       0.000406783797
  error estimate for blocks of size 2^( 5) =       0.000412003600
  error estimate for blocks of size 2^( 6) =       0.000414955985
  error estimate for blocks of size 2^( 7) =       0.000416059325

      target function =      -0.898066183881
              le_mean =     -17.214031562244
             les_mean =     296.632196382032
             stat err =       0.000412450676
             autocorr =       1.196414408363
   target nu stat err =       0.000412450676
   target dn stat err =       0.012931172447
      target stat err =       0.019432661415
              std dev =       0.533268831398
             le_variance =       0.284375646541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284364421575
                                         uncertainty =       0.001773657100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284364421575
                                         uncertainty =       0.001773657100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377080738
  error estimate for blocks of size 2^( 2) =       0.000388140071
  error estimate for blocks of size 2^( 3) =       0.000398745761
  error estimate for blocks of size 2^( 4) =       0.000406781758
  error estimate for blocks of size 2^( 5) =       0.000412002256
  error estimate for blocks of size 2^( 6) =       0.000414956679
  error estimate for blocks of size 2^( 7) =       0.000416056889

      target function =      -0.899131439578
              le_mean =     -17.214032068285
             les_mean =     296.631517190453
             stat err =       0.000412449395
             autocorr =       1.196389648380
   target nu stat err =       0.000412449395
   target dn stat err =       0.012638551055
      target stat err =       0.019038172616
              std dev =       0.533272693321
             le_variance =       0.284379765441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284369963068
                                         uncertainty =       0.001774158745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284369963068
                                         uncertainty =       0.001774158745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377084458
  error estimate for blocks of size 2^( 2) =       0.000388142294
  error estimate for blocks of size 2^( 3) =       0.000398746325
  error estimate for blocks of size 2^( 4) =       0.000406780825
  error estimate for blocks of size 2^( 5) =       0.000412001969
  error estimate for blocks of size 2^( 6) =       0.000414958532
  error estimate for blocks of size 2^( 7) =       0.000416055221

      target function =      -0.899583802601
              le_mean =     -17.214032810892
             les_mean =     296.631254329983
             stat err =       0.000412449137
             autocorr =       1.196364541233
   target nu stat err =       0.000412449137
   target dn stat err =       0.012346785237
      target stat err =       0.018617613966
              std dev =       0.533277954479
             le_variance =       0.284385376734


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.899646013707        initial  <--
     6.2500e-01     6.2500e+00             1.2897e-04        -0.898066183881
     2.5000e+00     2.5000e+01             3.4630e-05        -0.899131439578
     1.0000e+01     1.0000e+02             8.8209e-06        -0.899583802601

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9255
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -3.752254e-02 3 1  ON 0
ci_002                -2.875730e-02 3 1  ON 1
ci_003                -2.361285e-02 3 1  ON 2
ci_004                 2.082832e-02 3 1  ON 3
ci_005                 2.130076e-02 3 1  ON 4
ci_006                -1.839566e-02 3 1  ON 5
ci_007                -1.850420e-02 3 1  ON 6
ci_008                -7.791568e-03 3 1  ON 7
ci_009                -1.390728e-02 3 1  ON 8
ci_010                -8.864708e-03 3 1  ON 9
ci_011                -8.956557e-03 3 1  ON 10
ci_012                -9.116244e-03 3 1  ON 11
ci_013                -1.909094e-02 3 1  ON 12
ci_014                 1.113269e-02 3 1  ON 13
ci_015                 1.094010e-02 3 1  ON 14
ci_016                 1.591931e-02 3 1  ON 15
ci_017                 1.563164e-02 3 1  ON 16
ci_018                 9.101700e-03 3 1  ON 17
ci_019                 8.999521e-03 3 1  ON 18
ci_020                 1.505205e-02 3 1  ON 19
ci_021                 1.523225e-02 3 1  ON 20
ci_022                 8.272973e-03 3 1  ON 21
ci_023                 8.267346e-03 3 1  ON 22
ci_024                 8.350950e-03 3 1  ON 23
ci_025                 8.447026e-03 3 1  ON 24
ci_026                 9.919159e-03 3 1  ON 25
ci_027                 9.706007e-03 3 1  ON 26
ci_028                -1.452717e-02 3 1  ON 27
ci_029                -1.480811e-02 3 1  ON 28
ci_030                -8.758942e-03 3 1  ON 29
ci_031                -8.612921e-03 3 1  ON 30
ci_032                -1.432244e-02 3 1  ON 31
ci_033                 4.536283e-03 3 1  ON 32
ci_034                 4.873455e-03 3 1  ON 33
ci_035                -3.332670e-03 3 1  ON 34
ci_036                -1.119930e-02 3 1  ON 35
ci_037                -1.147864e-02 3 1  ON 36
ci_038                 8.689898e-04 3 1  ON 37
ci_039                 1.149036e-03 3 1  ON 38
ci_040                -1.543153e-03 3 1  ON 39
ci_041                 8.188700e-03 3 1  ON 40
ci_042                 8.175876e-03 3 1  ON 41
ci_043                -2.347029e-03 3 1  ON 42
ci_044                -3.923636e-03 3 1  ON 43
ci_045                -2.006761e-03 3 1  ON 44
ci_046                 4.782925e-03 3 1  ON 45
ci_047                 4.608833e-03 3 1  ON 46
ci_048                -1.238314e-02 3 1  ON 47
ci_049                -1.294703e-02 3 1  ON 48
ci_050                 2.838430e-03 3 1  ON 49
ci_051                 2.984287e-03 3 1  ON 50
ci_052                -2.169768e-03 3 1  ON 51
ci_053                -2.209425e-03 3 1  ON 52
ci_054                -2.211861e-03 3 1  ON 53
ci_055                -2.422868e-03 3 1  ON 54
ci_056                 4.616913e-03 3 1  ON 55
ci_057                 4.634847e-03 3 1  ON 56
ci_058                -2.071932e-03 3 1  ON 57
ci_059                -2.082484e-03 3 1  ON 58
ci_060                 4.762564e-03 3 1  ON 59
ci_061                 5.217030e-03 3 1  ON 60
ci_062                -2.961145e-03 3 1  ON 61
ci_063                -2.809026e-03 3 1  ON 62
ci_064                -2.254657e-03 3 1  ON 63
ci_065                -3.386004e-03 3 1  ON 64
ci_066                 4.057725e-03 3 1  ON 65
ci_067                 4.236658e-03 3 1  ON 66
ci_068                -4.272637e-03 3 1  ON 67
ci_069                -4.116351e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9356e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2119
    reference variance = 0.341417
====================================================
  Execution time = 1.3722e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0014e-01
  Total weights = 1.957835619e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5500e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287608410312
                                         uncertainty =       0.002017950556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287608410312
                                         uncertainty =       0.002017950556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379209558
  error estimate for blocks of size 2^( 2) =       0.000390356093
  error estimate for blocks of size 2^( 3) =       0.000400431219
  error estimate for blocks of size 2^( 4) =       0.000407561817
  error estimate for blocks of size 2^( 5) =       0.000413020214
  error estimate for blocks of size 2^( 6) =       0.000416055702
  error estimate for blocks of size 2^( 7) =       0.000418792018

      target function =      -0.912483391030
              le_mean =     -17.213536262437
             les_mean =     296.605970958760
             stat err =       0.000413857438
             autocorr =       1.191085609812
   target nu stat err =       0.000413857438
   target dn stat err =       0.002568057376
      target stat err =       0.004037692196
              std dev =       0.536283300439
             le_variance =       0.287599778330


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721353626244e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912500256308       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912506940978       residual = 9.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912507713981       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912508131699       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912508175953       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912508201090       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912508203571       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912508205175       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912508206355       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.639251e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912500256308       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912501943274       residual = 9.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912502137997       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912502242897       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912502253972       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912502260259       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912502260873       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912502261278       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912502261570       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 4.127629e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912500256308       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912500679049       residual = 9.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912500727822       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912500754077       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912500756846       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912500758418       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912500758571       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912500758673       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912500758746       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 1.033768e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147583 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6281e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -3.751895e-02 3 1  ON 0
ci_002                -2.875653e-02 3 1  ON 1
ci_003                -2.361431e-02 3 1  ON 2
ci_004                 2.082973e-02 3 1  ON 3
ci_005                 2.130048e-02 3 1  ON 4
ci_006                -1.839362e-02 3 1  ON 5
ci_007                -1.850315e-02 3 1  ON 6
ci_008                -7.788968e-03 3 1  ON 7
ci_009                -1.390739e-02 3 1  ON 8
ci_010                -8.863208e-03 3 1  ON 9
ci_011                -8.954328e-03 3 1  ON 10
ci_012                -9.116167e-03 3 1  ON 11
ci_013                -1.909003e-02 3 1  ON 12
ci_014                 1.112913e-02 3 1  ON 13
ci_015                 1.093723e-02 3 1  ON 14
ci_016                 1.591811e-02 3 1  ON 15
ci_017                 1.563229e-02 3 1  ON 16
ci_018                 9.103934e-03 3 1  ON 17
ci_019                 8.997901e-03 3 1  ON 18
ci_020                 1.505340e-02 3 1  ON 19
ci_021                 1.523140e-02 3 1  ON 20
ci_022                 8.273178e-03 3 1  ON 21
ci_023                 8.264502e-03 3 1  ON 22
ci_024                 8.349006e-03 3 1  ON 23
ci_025                 8.444832e-03 3 1  ON 24
ci_026                 9.920409e-03 3 1  ON 25
ci_027                 9.705227e-03 3 1  ON 26
ci_028                -1.452882e-02 3 1  ON 27
ci_029                -1.480481e-02 3 1  ON 28
ci_030                -8.758640e-03 3 1  ON 29
ci_031                -8.615117e-03 3 1  ON 30
ci_032                -1.432146e-02 3 1  ON 31
ci_033                 4.539867e-03 3 1  ON 32
ci_034                 4.871599e-03 3 1  ON 33
ci_035                -3.333016e-03 3 1  ON 34
ci_036                -1.120205e-02 3 1  ON 35
ci_037                -1.147796e-02 3 1  ON 36
ci_038                 8.695210e-04 3 1  ON 37
ci_039                 1.147083e-03 3 1  ON 38
ci_040                -1.546651e-03 3 1  ON 39
ci_041                 8.184816e-03 3 1  ON 40
ci_042                 8.175869e-03 3 1  ON 41
ci_043                -2.347066e-03 3 1  ON 42
ci_044                -3.921681e-03 3 1  ON 43
ci_045                -2.005886e-03 3 1  ON 44
ci_046                 4.782497e-03 3 1  ON 45
ci_047                 4.607504e-03 3 1  ON 46
ci_048                -1.237902e-02 3 1  ON 47
ci_049                -1.294557e-02 3 1  ON 48
ci_050                 2.837647e-03 3 1  ON 49
ci_051                 2.987414e-03 3 1  ON 50
ci_052                -2.168146e-03 3 1  ON 51
ci_053                -2.211144e-03 3 1  ON 52
ci_054                -2.211016e-03 3 1  ON 53
ci_055                -2.423308e-03 3 1  ON 54
ci_056                 4.616116e-03 3 1  ON 55
ci_057                 4.635661e-03 3 1  ON 56
ci_058                -2.070480e-03 3 1  ON 57
ci_059                -2.079253e-03 3 1  ON 58
ci_060                 4.761966e-03 3 1  ON 59
ci_061                 5.217111e-03 3 1  ON 60
ci_062                -2.960725e-03 3 1  ON 61
ci_063                -2.808466e-03 3 1  ON 62
ci_064                -2.254633e-03 3 1  ON 63
ci_065                -3.386666e-03 3 1  ON 64
ci_066                 4.059401e-03 3 1  ON 65
ci_067                 4.235359e-03 3 1  ON 66
ci_068                -4.274449e-03 3 1  ON 67
ci_069                -4.116521e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2254
    reference variance = 0.192241
====================================================
  Execution time = 1.3408e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0192e-01
  Total weights = 1.9578e+06
  Execution time = 1.8486e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288292167471
                                         uncertainty =       0.001579151996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288292167471
                                         uncertainty =       0.001579151996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379667235
  error estimate for blocks of size 2^( 2) =       0.000390833171
  error estimate for blocks of size 2^( 3) =       0.000401243769
  error estimate for blocks of size 2^( 4) =       0.000408077687
  error estimate for blocks of size 2^( 5) =       0.000412584644
  error estimate for blocks of size 2^( 6) =       0.000415662426
  error estimate for blocks of size 2^( 7) =       0.000419001772

      target function =      -0.909668317775
              le_mean =     -17.214754817630
             les_mean =     296.649718439670
             stat err =       0.000413831632
             autocorr =       1.188067538187
   target nu stat err =       0.000413831632
   target dn stat err =       0.002412920816
      target stat err =       0.003786927528
              std dev =       0.536930552339
             le_variance =       0.288294418035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288292044552
                                         uncertainty =       0.001579283164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288292044552
                                         uncertainty =       0.001579283164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379667186
  error estimate for blocks of size 2^( 2) =       0.000390834390
  error estimate for blocks of size 2^( 3) =       0.000401245975
  error estimate for blocks of size 2^( 4) =       0.000408080660
  error estimate for blocks of size 2^( 5) =       0.000412588115
  error estimate for blocks of size 2^( 6) =       0.000415666008
  error estimate for blocks of size 2^( 7) =       0.000419005792

      target function =      -0.909702966242
              le_mean =     -17.214754873852
             les_mean =     296.649697910702
             stat err =       0.000413835144
             autocorr =       1.188088004988
   target nu stat err =       0.000413835144
   target dn stat err =       0.002412521604
      target stat err =       0.003786607475
              std dev =       0.536930483513
             le_variance =       0.288294344126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288292085300
                                         uncertainty =       0.001579217798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288292085300
                                         uncertainty =       0.001579217798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379667197
  error estimate for blocks of size 2^( 2) =       0.000390833773
  error estimate for blocks of size 2^( 3) =       0.000401244868
  error estimate for blocks of size 2^( 4) =       0.000408079173
  error estimate for blocks of size 2^( 5) =       0.000412586384
  error estimate for blocks of size 2^( 6) =       0.000415664222
  error estimate for blocks of size 2^( 7) =       0.000419003790

      target function =      -0.909695715037
              le_mean =     -17.214754843462
             les_mean =     296.649701566392
             stat err =       0.000413833392
             autocorr =       1.188077880300
   target nu stat err =       0.000413833392
   target dn stat err =       0.002412584859
      target stat err =       0.003786643254
              std dev =       0.536930498842
             le_variance =       0.288294360586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288292155026
                                         uncertainty =       0.001579160206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288292155026
                                         uncertainty =       0.001579160206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379667228
  error estimate for blocks of size 2^( 2) =       0.000390833245
  error estimate for blocks of size 2^( 3) =       0.000401243906
  error estimate for blocks of size 2^( 4) =       0.000408077871
  error estimate for blocks of size 2^( 5) =       0.000412584861
  error estimate for blocks of size 2^( 6) =       0.000415662650
  error estimate for blocks of size 2^( 7) =       0.000419002024

      target function =      -0.909673465715
              le_mean =     -17.214754820539
             les_mean =     296.649715202261
             stat err =       0.000413831852
             autocorr =       1.188068836698
   target nu stat err =       0.000413831852
   target dn stat err =       0.002412849805
      target stat err =       0.003786862118
              std dev =       0.536930543634
             le_variance =       0.288294408687


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909668317775        initial
     6.2500e+00     6.2500e+01             1.6393e-05        -0.909702966242  <--
     2.5000e+01     2.5000e+02             4.1276e-06        -0.909695715037
     1.0000e+02     1.0000e+03             1.0338e-06        -0.909673465715

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.2744e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -3.750827e-02 3 1  ON 0
ci_002                -2.875426e-02 3 1  ON 1
ci_003                -2.361865e-02 3 1  ON 2
ci_004                 2.083393e-02 3 1  ON 3
ci_005                 2.129964e-02 3 1  ON 4
ci_006                -1.838756e-02 3 1  ON 5
ci_007                -1.850002e-02 3 1  ON 6
ci_008                -7.781272e-03 3 1  ON 7
ci_009                -1.390773e-02 3 1  ON 8
ci_010                -8.858758e-03 3 1  ON 9
ci_011                -8.947716e-03 3 1  ON 10
ci_012                -9.115939e-03 3 1  ON 11
ci_013                -1.908733e-02 3 1  ON 12
ci_014                 1.111859e-02 3 1  ON 13
ci_015                 1.092870e-02 3 1  ON 14
ci_016                 1.591457e-02 3 1  ON 15
ci_017                 1.563424e-02 3 1  ON 16
ci_018                 9.110551e-03 3 1  ON 17
ci_019                 8.993103e-03 3 1  ON 18
ci_020                 1.505738e-02 3 1  ON 19
ci_021                 1.522887e-02 3 1  ON 20
ci_022                 8.273783e-03 3 1  ON 21
ci_023                 8.256064e-03 3 1  ON 22
ci_024                 8.343228e-03 3 1  ON 23
ci_025                 8.438315e-03 3 1  ON 24
ci_026                 9.924123e-03 3 1  ON 25
ci_027                 9.702913e-03 3 1  ON 26
ci_028                -1.453371e-02 3 1  ON 27
ci_029                -1.479500e-02 3 1  ON 28
ci_030                -8.757733e-03 3 1  ON 29
ci_031                -8.621622e-03 3 1  ON 30
ci_032                -1.431854e-02 3 1  ON 31
ci_033                 4.550503e-03 3 1  ON 32
ci_034                 4.866093e-03 3 1  ON 33
ci_035                -3.334039e-03 3 1  ON 34
ci_036                -1.121020e-02 3 1  ON 35
ci_037                -1.147596e-02 3 1  ON 36
ci_038                 8.710957e-04 3 1  ON 37
ci_039                 1.141296e-03 3 1  ON 38
ci_040                -1.557017e-03 3 1  ON 39
ci_041                 8.173307e-03 3 1  ON 40
ci_042                 8.175839e-03 3 1  ON 41
ci_043                -2.347177e-03 3 1  ON 42
ci_044                -3.915880e-03 3 1  ON 43
ci_045                -2.003294e-03 3 1  ON 44
ci_046                 4.781227e-03 3 1  ON 45
ci_047                 4.603561e-03 3 1  ON 46
ci_048                -1.236675e-02 3 1  ON 47
ci_049                -1.294125e-02 3 1  ON 48
ci_050                 2.835327e-03 3 1  ON 49
ci_051                 2.996672e-03 3 1  ON 50
ci_052                -2.163348e-03 3 1  ON 51
ci_053                -2.216241e-03 3 1  ON 52
ci_054                -2.208512e-03 3 1  ON 53
ci_055                -2.424618e-03 3 1  ON 54
ci_056                 4.613751e-03 3 1  ON 55
ci_057                 4.638077e-03 3 1  ON 56
ci_058                -2.066186e-03 3 1  ON 57
ci_059                -2.069686e-03 3 1  ON 58
ci_060                 4.760190e-03 3 1  ON 59
ci_061                 5.217351e-03 3 1  ON 60
ci_062                -2.959474e-03 3 1  ON 61
ci_063                -2.806800e-03 3 1  ON 62
ci_064                -2.254562e-03 3 1  ON 63
ci_065                -3.388628e-03 3 1  ON 64
ci_066                 4.064367e-03 3 1  ON 65
ci_067                 4.231506e-03 3 1  ON 66
ci_068                -4.279827e-03 3 1  ON 67
ci_069                -4.117030e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9032e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1273
    reference variance = 0.258241
====================================================
  Execution time = 1.3735e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0193e-01
  Total weights = 1.958058485e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5148e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288264506115
                                         uncertainty =       0.001458422373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288264506115
                                         uncertainty =       0.001458422373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379700005
  error estimate for blocks of size 2^( 2) =       0.000391253753
  error estimate for blocks of size 2^( 3) =       0.000401347149
  error estimate for blocks of size 2^( 4) =       0.000409344593
  error estimate for blocks of size 2^( 5) =       0.000415156969
  error estimate for blocks of size 2^( 6) =       0.000417112963
  error estimate for blocks of size 2^( 7) =       0.000417328567

      target function =      -0.909622284211
              le_mean =     -17.215982569934
             les_mean =     296.691988675268
             stat err =       0.000414735773
             autocorr =       1.193058633808
   target nu stat err =       0.000414735773
   target dn stat err =       0.002180633934
      target stat err =       0.003443365309
              std dev =       0.536976896790
             le_variance =       0.288344187686


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721598256993e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909634438310       residual = 8.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909651996077       residual = 8.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909654541048       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909655387950       residual = 5.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909655463525       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909655499080       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909655509064       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909655503884       residual = 9.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909655500857       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909655502310       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 8.017138e-05

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909634438310       residual = 8.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909638992412       residual = 8.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909639645891       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909639861518       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909639879944       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909639888857       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909639891219       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909639890000       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909639889183       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909639889549       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 2.064425e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909634438310       residual = 8.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909635587614       residual = 8.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909635752094       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909635806248       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909635810822       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909635813052       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909635813633       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909635813334       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909635813126       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909635813217       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 5.200119e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151101 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6260e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -3.750814e-02 3 1  ON 0
ci_002                -2.875465e-02 3 1  ON 1
ci_003                -2.362236e-02 3 1  ON 2
ci_004                 2.083294e-02 3 1  ON 3
ci_005                 2.129239e-02 3 1  ON 4
ci_006                -1.838971e-02 3 1  ON 5
ci_007                -1.849231e-02 3 1  ON 6
ci_008                -7.774973e-03 3 1  ON 7
ci_009                -1.389763e-02 3 1  ON 8
ci_010                -8.853270e-03 3 1  ON 9
ci_011                -8.956762e-03 3 1  ON 10
ci_012                -9.111307e-03 3 1  ON 11
ci_013                -1.908942e-02 3 1  ON 12
ci_014                 1.111393e-02 3 1  ON 13
ci_015                 1.092764e-02 3 1  ON 14
ci_016                 1.591181e-02 3 1  ON 15
ci_017                 1.563310e-02 3 1  ON 16
ci_018                 9.113453e-03 3 1  ON 17
ci_019                 8.995669e-03 3 1  ON 18
ci_020                 1.504402e-02 3 1  ON 19
ci_021                 1.522077e-02 3 1  ON 20
ci_022                 8.270435e-03 3 1  ON 21
ci_023                 8.256045e-03 3 1  ON 22
ci_024                 8.335827e-03 3 1  ON 23
ci_025                 8.426922e-03 3 1  ON 24
ci_026                 9.921315e-03 3 1  ON 25
ci_027                 9.700270e-03 3 1  ON 26
ci_028                -1.453025e-02 3 1  ON 27
ci_029                -1.479956e-02 3 1  ON 28
ci_030                -8.761652e-03 3 1  ON 29
ci_031                -8.614421e-03 3 1  ON 30
ci_032                -1.432880e-02 3 1  ON 31
ci_033                 4.546329e-03 3 1  ON 32
ci_034                 4.857221e-03 3 1  ON 33
ci_035                -3.336098e-03 3 1  ON 34
ci_036                -1.121855e-02 3 1  ON 35
ci_037                -1.147883e-02 3 1  ON 36
ci_038                 8.713292e-04 3 1  ON 37
ci_039                 1.137295e-03 3 1  ON 38
ci_040                -1.556862e-03 3 1  ON 39
ci_041                 8.168180e-03 3 1  ON 40
ci_042                 8.167511e-03 3 1  ON 41
ci_043                -2.345896e-03 3 1  ON 42
ci_044                -3.918449e-03 3 1  ON 43
ci_045                -1.995596e-03 3 1  ON 44
ci_046                 4.783709e-03 3 1  ON 45
ci_047                 4.612049e-03 3 1  ON 46
ci_048                -1.238154e-02 3 1  ON 47
ci_049                -1.296190e-02 3 1  ON 48
ci_050                 2.842196e-03 3 1  ON 49
ci_051                 2.990734e-03 3 1  ON 50
ci_052                -2.166782e-03 3 1  ON 51
ci_053                -2.206879e-03 3 1  ON 52
ci_054                -2.211601e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.622380e-03 3 1  ON 55
ci_057                 4.640651e-03 3 1  ON 56
ci_058                -2.069435e-03 3 1  ON 57
ci_059                -2.058579e-03 3 1  ON 58
ci_060                 4.757284e-03 3 1  ON 59
ci_061                 5.216465e-03 3 1  ON 60
ci_062                -2.961274e-03 3 1  ON 61
ci_063                -2.810484e-03 3 1  ON 62
ci_064                -2.261157e-03 3 1  ON 63
ci_065                -3.387807e-03 3 1  ON 64
ci_066                 4.062584e-03 3 1  ON 65
ci_067                 4.230649e-03 3 1  ON 66
ci_068                -4.280040e-03 3 1  ON 67
ci_069                -4.109624e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2378
    reference variance = 0.25677
====================================================
  Execution time = 1.3755e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0246e-01
  Total weights = 1.9577e+06
  Execution time = 1.8319e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287476396638
                                         uncertainty =       0.001771566152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287476396638
                                         uncertainty =       0.001771566152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379131913
  error estimate for blocks of size 2^( 2) =       0.000390750884
  error estimate for blocks of size 2^( 3) =       0.000400836752
  error estimate for blocks of size 2^( 4) =       0.000408781741
  error estimate for blocks of size 2^( 5) =       0.000412935063
  error estimate for blocks of size 2^( 6) =       0.000416429600
  error estimate for blocks of size 2^( 7) =       0.000415764368

      target function =      -0.908829650994
              le_mean =     -17.214852625865
             les_mean =     296.653626509626
             stat err =       0.000413477693
             autocorr =       1.189387811419
   target nu stat err =       0.000413477693
   target dn stat err =       0.002538085762
      target stat err =       0.003970193511
              std dev =       0.536173493978
             le_variance =       0.287482015645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287457610961
                                         uncertainty =       0.001769244429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287457610961
                                         uncertainty =       0.001769244429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379119538
  error estimate for blocks of size 2^( 2) =       0.000390741940
  error estimate for blocks of size 2^( 3) =       0.000400831595
  error estimate for blocks of size 2^( 4) =       0.000408778142
  error estimate for blocks of size 2^( 5) =       0.000412931691
  error estimate for blocks of size 2^( 6) =       0.000416424251
  error estimate for blocks of size 2^( 7) =       0.000415758441

      target function =      -0.908844245665
              le_mean =     -17.214851893205
             les_mean =     296.653591891826
             stat err =       0.000413473131
             autocorr =       1.189439211742
   target nu stat err =       0.000413473131
   target dn stat err =       0.002530391538
      target stat err =       0.003958651007
              std dev =       0.536155993028
             le_variance =       0.287463248860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287466502175
                                         uncertainty =       0.001770361048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287466502175
                                         uncertainty =       0.001770361048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379125395
  error estimate for blocks of size 2^( 2) =       0.000390746141
  error estimate for blocks of size 2^( 3) =       0.000400833969
  error estimate for blocks of size 2^( 4) =       0.000408779767
  error estimate for blocks of size 2^( 5) =       0.000412933210
  error estimate for blocks of size 2^( 6) =       0.000416426720
  error estimate for blocks of size 2^( 7) =       0.000415761197

      target function =      -0.908874351073
              le_mean =     -17.214852221350
             les_mean =     296.653583598652
             stat err =       0.000413475223
             autocorr =       1.189414500172
   target nu stat err =       0.000413475223
   target dn stat err =       0.002533856487
      target stat err =       0.003964163862
              std dev =       0.536164275908
             le_variance =       0.287472130760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287475126030
                                         uncertainty =       0.001771413588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287475126030
                                         uncertainty =       0.001771413588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379131076
  error estimate for blocks of size 2^( 2) =       0.000390750271
  error estimate for blocks of size 2^( 3) =       0.000400836386
  error estimate for blocks of size 2^( 4) =       0.000408781477
  error estimate for blocks of size 2^( 5) =       0.000412934815
  error estimate for blocks of size 2^( 6) =       0.000416429223
  error estimate for blocks of size 2^( 7) =       0.000415763954

      target function =      -0.908835933533
              le_mean =     -17.214852572235
             les_mean =     296.653620588827
             stat err =       0.000413477367
             autocorr =       1.189391188853
   target nu stat err =       0.000413477367
   target dn stat err =       0.002537544654
      target stat err =       0.003969426936
              std dev =       0.536172310209
             le_variance =       0.287480746235


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908829650994        initial
     1.5625e+00     1.5625e+01             8.0171e-05        -0.908844245665
     6.2500e+00     6.2500e+01             2.0644e-05        -0.908874351073  <--
     2.5000e+01     2.5000e+02             5.2001e-06        -0.908835933533

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.2981e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -3.750814e-02 3 1  ON 0
ci_002                -2.875465e-02 3 1  ON 1
ci_003                -2.362236e-02 3 1  ON 2
ci_004                 2.083294e-02 3 1  ON 3
ci_005                 2.129239e-02 3 1  ON 4
ci_006                -1.838971e-02 3 1  ON 5
ci_007                -1.849231e-02 3 1  ON 6
ci_008                -7.774973e-03 3 1  ON 7
ci_009                -1.389763e-02 3 1  ON 8
ci_010                -8.853270e-03 3 1  ON 9
ci_011                -8.956762e-03 3 1  ON 10
ci_012                -9.111307e-03 3 1  ON 11
ci_013                -1.908942e-02 3 1  ON 12
ci_014                 1.111393e-02 3 1  ON 13
ci_015                 1.092764e-02 3 1  ON 14
ci_016                 1.591181e-02 3 1  ON 15
ci_017                 1.563310e-02 3 1  ON 16
ci_018                 9.113453e-03 3 1  ON 17
ci_019                 8.995669e-03 3 1  ON 18
ci_020                 1.504402e-02 3 1  ON 19
ci_021                 1.522077e-02 3 1  ON 20
ci_022                 8.270435e-03 3 1  ON 21
ci_023                 8.256045e-03 3 1  ON 22
ci_024                 8.335827e-03 3 1  ON 23
ci_025                 8.426922e-03 3 1  ON 24
ci_026                 9.921315e-03 3 1  ON 25
ci_027                 9.700270e-03 3 1  ON 26
ci_028                -1.453025e-02 3 1  ON 27
ci_029                -1.479956e-02 3 1  ON 28
ci_030                -8.761652e-03 3 1  ON 29
ci_031                -8.614421e-03 3 1  ON 30
ci_032                -1.432880e-02 3 1  ON 31
ci_033                 4.546329e-03 3 1  ON 32
ci_034                 4.857221e-03 3 1  ON 33
ci_035                -3.336098e-03 3 1  ON 34
ci_036                -1.121855e-02 3 1  ON 35
ci_037                -1.147883e-02 3 1  ON 36
ci_038                 8.713292e-04 3 1  ON 37
ci_039                 1.137295e-03 3 1  ON 38
ci_040                -1.556862e-03 3 1  ON 39
ci_041                 8.168180e-03 3 1  ON 40
ci_042                 8.167511e-03 3 1  ON 41
ci_043                -2.345896e-03 3 1  ON 42
ci_044                -3.918449e-03 3 1  ON 43
ci_045                -1.995596e-03 3 1  ON 44
ci_046                 4.783709e-03 3 1  ON 45
ci_047                 4.612049e-03 3 1  ON 46
ci_048                -1.238154e-02 3 1  ON 47
ci_049                -1.296190e-02 3 1  ON 48
ci_050                 2.842196e-03 3 1  ON 49
ci_051                 2.990734e-03 3 1  ON 50
ci_052                -2.166782e-03 3 1  ON 51
ci_053                -2.206879e-03 3 1  ON 52
ci_054                -2.211601e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.622380e-03 3 1  ON 55
ci_057                 4.640651e-03 3 1  ON 56
ci_058                -2.069435e-03 3 1  ON 57
ci_059                -2.058579e-03 3 1  ON 58
ci_060                 4.757284e-03 3 1  ON 59
ci_061                 5.216465e-03 3 1  ON 60
ci_062                -2.961274e-03 3 1  ON 61
ci_063                -2.810484e-03 3 1  ON 62
ci_064                -2.261157e-03 3 1  ON 63
ci_065                -3.387807e-03 3 1  ON 64
ci_066                 4.062584e-03 3 1  ON 65
ci_067                 4.230649e-03 3 1  ON 66
ci_068                -4.280040e-03 3 1  ON 67
ci_069                -4.109624e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9249e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.238
    reference variance = 0.26219
====================================================
  Execution time = 1.3698e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5333e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9801e-01
  Total weights = 1.958069662e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5015e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285055998103
                                         uncertainty =       0.001509534148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285055998103
                                         uncertainty =       0.001509534148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377557169
  error estimate for blocks of size 2^( 2) =       0.000388834525
  error estimate for blocks of size 2^( 3) =       0.000399082920
  error estimate for blocks of size 2^( 4) =       0.000406565455
  error estimate for blocks of size 2^( 5) =       0.000411798284
  error estimate for blocks of size 2^( 6) =       0.000415020311
  error estimate for blocks of size 2^( 7) =       0.000416011758

      target function =      -0.915773666562
              le_mean =     -17.214506817804
             les_mean =     296.637252783663
             stat err =       0.000412348952
             autocorr =       1.192790984076
   target nu stat err =       0.000412348952
   target dn stat err =       0.002333815595
      target stat err =       0.003713394113
              std dev =       0.533946469301
             le_variance =       0.285098832079


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721450681780e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915787774545       residual = 6.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915805093272       residual = 5.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915806934173       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915807350511       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915807379108       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915807389870       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915807398979       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915807401563       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915807400626       residual = 8.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 6.429846e-05

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915787774545       residual = 6.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915792264004       residual = 5.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915792736513       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915792842188       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915792849104       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915792851756       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915792854067       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915792854711       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915792854479       residual = 7.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.662725e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915787774545       residual = 6.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915788907361       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915789026280       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915789052798       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915789054511       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915789055171       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915789055751       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915789055912       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915789055854       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 4.192885e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154173 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6208e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -3.750365e-02 3 1  ON 0
ci_002                -2.875487e-02 3 1  ON 1
ci_003                -2.362077e-02 3 1  ON 2
ci_004                 2.082460e-02 3 1  ON 3
ci_005                 2.128835e-02 3 1  ON 4
ci_006                -1.838910e-02 3 1  ON 5
ci_007                -1.849246e-02 3 1  ON 6
ci_008                -7.774664e-03 3 1  ON 7
ci_009                -1.388479e-02 3 1  ON 8
ci_010                -8.848221e-03 3 1  ON 9
ci_011                -8.942448e-03 3 1  ON 10
ci_012                -9.109342e-03 3 1  ON 11
ci_013                -1.908983e-02 3 1  ON 12
ci_014                 1.111134e-02 3 1  ON 13
ci_015                 1.093281e-02 3 1  ON 14
ci_016                 1.591464e-02 3 1  ON 15
ci_017                 1.564418e-02 3 1  ON 16
ci_018                 9.119400e-03 3 1  ON 17
ci_019                 8.996182e-03 3 1  ON 18
ci_020                 1.504003e-02 3 1  ON 19
ci_021                 1.521539e-02 3 1  ON 20
ci_022                 8.281768e-03 3 1  ON 21
ci_023                 8.253883e-03 3 1  ON 22
ci_024                 8.331672e-03 3 1  ON 23
ci_025                 8.432578e-03 3 1  ON 24
ci_026                 9.904687e-03 3 1  ON 25
ci_027                 9.696423e-03 3 1  ON 26
ci_028                -1.453234e-02 3 1  ON 27
ci_029                -1.480248e-02 3 1  ON 28
ci_030                -8.763215e-03 3 1  ON 29
ci_031                -8.609231e-03 3 1  ON 30
ci_032                -1.432710e-02 3 1  ON 31
ci_033                 4.548312e-03 3 1  ON 32
ci_034                 4.858469e-03 3 1  ON 33
ci_035                -3.330589e-03 3 1  ON 34
ci_036                -1.122035e-02 3 1  ON 35
ci_037                -1.147110e-02 3 1  ON 36
ci_038                 8.712348e-04 3 1  ON 37
ci_039                 1.142952e-03 3 1  ON 38
ci_040                -1.558681e-03 3 1  ON 39
ci_041                 8.159941e-03 3 1  ON 40
ci_042                 8.167233e-03 3 1  ON 41
ci_043                -2.342473e-03 3 1  ON 42
ci_044                -3.916647e-03 3 1  ON 43
ci_045                -1.989434e-03 3 1  ON 44
ci_046                 4.784054e-03 3 1  ON 45
ci_047                 4.610070e-03 3 1  ON 46
ci_048                -1.238646e-02 3 1  ON 47
ci_049                -1.295490e-02 3 1  ON 48
ci_050                 2.844160e-03 3 1  ON 49
ci_051                 2.992742e-03 3 1  ON 50
ci_052                -2.175403e-03 3 1  ON 51
ci_053                -2.199394e-03 3 1  ON 52
ci_054                -2.205401e-03 3 1  ON 53
ci_055                -2.426908e-03 3 1  ON 54
ci_056                 4.622495e-03 3 1  ON 55
ci_057                 4.632387e-03 3 1  ON 56
ci_058                -2.079731e-03 3 1  ON 57
ci_059                -2.044909e-03 3 1  ON 58
ci_060                 4.766744e-03 3 1  ON 59
ci_061                 5.220065e-03 3 1  ON 60
ci_062                -2.954231e-03 3 1  ON 61
ci_063                -2.806905e-03 3 1  ON 62
ci_064                -2.257858e-03 3 1  ON 63
ci_065                -3.387542e-03 3 1  ON 64
ci_066                 4.061406e-03 3 1  ON 65
ci_067                 4.234690e-03 3 1  ON 66
ci_068                -4.278989e-03 3 1  ON 67
ci_069                -4.118211e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2308
    reference variance = 0.274142
====================================================
  Execution time = 1.3414e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9991e-01
  Total weights = 1.9578e+06
  Execution time = 1.8229e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287821702427
                                         uncertainty =       0.001654016203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287821702427
                                         uncertainty =       0.001654016203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379342414
  error estimate for blocks of size 2^( 2) =       0.000390619514
  error estimate for blocks of size 2^( 3) =       0.000401099026
  error estimate for blocks of size 2^( 4) =       0.000408556468
  error estimate for blocks of size 2^( 5) =       0.000412410792
  error estimate for blocks of size 2^( 6) =       0.000413226251
  error estimate for blocks of size 2^( 7) =       0.000416104725

      target function =      -0.912556146766
              le_mean =     -17.214441418536
             les_mean =     296.637069525737
             stat err =       0.000412574559
             autocorr =       1.182883791207
   target nu stat err =       0.000412574559
   target dn stat err =       0.002320146640
      target stat err =       0.003666622517
              std dev =       0.536471187256
             le_variance =       0.287801334756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287813425101
                                         uncertainty =       0.001654398743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287813425101
                                         uncertainty =       0.001654398743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379336945
  error estimate for blocks of size 2^( 2) =       0.000390615600
  error estimate for blocks of size 2^( 3) =       0.000401097217
  error estimate for blocks of size 2^( 4) =       0.000408556438
  error estimate for blocks of size 2^( 5) =       0.000412411537
  error estimate for blocks of size 2^( 6) =       0.000413224547
  error estimate for blocks of size 2^( 7) =       0.000416100976

      target function =      -0.912768753451
              le_mean =     -17.214441212034
             les_mean =     296.636925413436
             stat err =       0.000412573375
             autocorr =       1.182911110825
   target nu stat err =       0.000412573375
   target dn stat err =       0.002316832851
      target stat err =       0.003663250416
              std dev =       0.536463451734
             le_variance =       0.287793035046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287817248902
                                         uncertainty =       0.001654207692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287817248902
                                         uncertainty =       0.001654207692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379339472
  error estimate for blocks of size 2^( 2) =       0.000390617375
  error estimate for blocks of size 2^( 3) =       0.000401097972
  error estimate for blocks of size 2^( 4) =       0.000408556329
  error estimate for blocks of size 2^( 5) =       0.000412411051
  error estimate for blocks of size 2^( 6) =       0.000413225230
  error estimate for blocks of size 2^( 7) =       0.000416102639

      target function =      -0.912803097650
              le_mean =     -17.214441292499
             les_mean =     296.636906061057
             stat err =       0.000412573812
             autocorr =       1.182897859469
   target nu stat err =       0.000412573812
   target dn stat err =       0.002315607763
      target stat err =       0.003661655531
              std dev =       0.536467025568
             le_variance =       0.287796869522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287821120014
                                         uncertainty =       0.001654039678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287821120014
                                         uncertainty =       0.001654039678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379342030
  error estimate for blocks of size 2^( 2) =       0.000390619231
  error estimate for blocks of size 2^( 3) =       0.000401098879
  error estimate for blocks of size 2^( 4) =       0.000408556435
  error estimate for blocks of size 2^( 5) =       0.000412410814
  error estimate for blocks of size 2^( 6) =       0.000413226096
  error estimate for blocks of size 2^( 7) =       0.000416104425

      target function =      -0.912803757967
              le_mean =     -17.214441408146
             les_mean =     296.636909621044
             stat err =       0.000412574442
             autocorr =       1.182885520302
   target nu stat err =       0.000412574442
   target dn stat err =       0.002314778492
      target stat err =       0.003660398498
              std dev =       0.536470643057
             le_variance =       0.287800750862


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912556146766        initial
     1.5625e+00     1.5625e+01             6.4298e-05        -0.912768753451
     6.2500e+00     6.2500e+01             1.6627e-05        -0.912803097650
     2.5000e+01     2.5000e+02             4.1929e-06        -0.912803757967  <--

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 2.2622e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -3.750701e-02 3 1  ON 0
ci_002                -2.875471e-02 3 1  ON 1
ci_003                -2.362196e-02 3 1  ON 2
ci_004                 2.083084e-02 3 1  ON 3
ci_005                 2.129137e-02 3 1  ON 4
ci_006                -1.838956e-02 3 1  ON 5
ci_007                -1.849235e-02 3 1  ON 6
ci_008                -7.774895e-03 3 1  ON 7
ci_009                -1.389439e-02 3 1  ON 8
ci_010                -8.851996e-03 3 1  ON 9
ci_011                -8.953153e-03 3 1  ON 10
ci_012                -9.110811e-03 3 1  ON 11
ci_013                -1.908952e-02 3 1  ON 12
ci_014                 1.111327e-02 3 1  ON 13
ci_015                 1.092895e-02 3 1  ON 14
ci_016                 1.591252e-02 3 1  ON 15
ci_017                 1.563589e-02 3 1  ON 16
ci_018                 9.114954e-03 3 1  ON 17
ci_019                 8.995799e-03 3 1  ON 18
ci_020                 1.504301e-02 3 1  ON 19
ci_021                 1.521941e-02 3 1  ON 20
ci_022                 8.273290e-03 3 1  ON 21
ci_023                 8.255502e-03 3 1  ON 22
ci_024                 8.334781e-03 3 1  ON 23
ci_025                 8.428347e-03 3 1  ON 24
ci_026                 9.917122e-03 3 1  ON 25
ci_027                 9.699300e-03 3 1  ON 26
ci_028                -1.453078e-02 3 1  ON 27
ci_029                -1.480030e-02 3 1  ON 28
ci_030                -8.762044e-03 3 1  ON 29
ci_031                -8.613114e-03 3 1  ON 30
ci_032                -1.432837e-02 3 1  ON 31
ci_033                 4.546829e-03 3 1  ON 32
ci_034                 4.857536e-03 3 1  ON 33
ci_035                -3.334708e-03 3 1  ON 34
ci_036                -1.121900e-02 3 1  ON 35
ci_037                -1.147688e-02 3 1  ON 36
ci_038                 8.713053e-04 3 1  ON 37
ci_039                 1.138722e-03 3 1  ON 38
ci_040                -1.557321e-03 3 1  ON 39
ci_041                 8.166101e-03 3 1  ON 40
ci_042                 8.167440e-03 3 1  ON 41
ci_043                -2.345033e-03 3 1  ON 42
ci_044                -3.917994e-03 3 1  ON 43
ci_045                -1.994041e-03 3 1  ON 44
ci_046                 4.783796e-03 3 1  ON 45
ci_047                 4.611550e-03 3 1  ON 46
ci_048                -1.238278e-02 3 1  ON 47
ci_049                -1.296013e-02 3 1  ON 48
ci_050                 2.842691e-03 3 1  ON 49
ci_051                 2.991241e-03 3 1  ON 50
ci_052                -2.168956e-03 3 1  ON 51
ci_053                -2.204992e-03 3 1  ON 52
ci_054                -2.210038e-03 3 1  ON 53
ci_055                -2.426866e-03 3 1  ON 54
ci_056                 4.622409e-03 3 1  ON 55
ci_057                 4.638567e-03 3 1  ON 56
ci_058                -2.072034e-03 3 1  ON 57
ci_059                -2.055130e-03 3 1  ON 58
ci_060                 4.759668e-03 3 1  ON 59
ci_061                 5.217373e-03 3 1  ON 60
ci_062                -2.959499e-03 3 1  ON 61
ci_063                -2.809581e-03 3 1  ON 62
ci_064                -2.260324e-03 3 1  ON 63
ci_065                -3.387740e-03 3 1  ON 64
ci_066                 4.062287e-03 3 1  ON 65
ci_067                 4.231669e-03 3 1  ON 66
ci_068                -4.279775e-03 3 1  ON 67
ci_069                -4.111788e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8841e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2151
    reference variance = 0.218981
====================================================
  Execution time = 1.3935e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0178e-01
  Total weights = 1.957775960e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4910e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289174565475
                                         uncertainty =       0.001849580178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289174565475
                                         uncertainty =       0.001849580178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380257535
  error estimate for blocks of size 2^( 2) =       0.000391660182
  error estimate for blocks of size 2^( 3) =       0.000402433479
  error estimate for blocks of size 2^( 4) =       0.000409976918
  error estimate for blocks of size 2^( 5) =       0.000415095441
  error estimate for blocks of size 2^( 6) =       0.000417594585
  error estimate for blocks of size 2^( 7) =       0.000417268143

      target function =      -0.909926407907
              le_mean =     -17.214380865578
             les_mean =     296.636685780996
             stat err =       0.000414983772
             autocorr =       1.190985764562
   target nu stat err =       0.000414983772
   target dn stat err =       0.002407027821
      target stat err =       0.003777834359
              std dev =       0.537765363074
             le_variance =       0.289191585722


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721438086558e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909941239027       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909949363848       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909950575625       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909950846653       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909950854426       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909950845747       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909950847493       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909950845900       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909950846501       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909950846284       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 3.191449e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909941239027       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909943289145       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909943594186       residual = 4.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909943662224       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909943664162       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909943661953       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909943662400       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909943661997       residual = 7.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909943662145       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909943662092       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 8.048130e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909941239027       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909941752752       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909941829145       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909941846172       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909941846656       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909941846101       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909941846214       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909941846112       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909941846149       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909941846136       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 2.016424e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157739 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6436e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -3.750748e-02 3 1  ON 0
ci_002                -2.875407e-02 3 1  ON 1
ci_003                -2.362067e-02 3 1  ON 2
ci_004                 2.082802e-02 3 1  ON 3
ci_005                 2.128963e-02 3 1  ON 4
ci_006                -1.838934e-02 3 1  ON 5
ci_007                -1.849488e-02 3 1  ON 6
ci_008                -7.774856e-03 3 1  ON 7
ci_009                -1.388874e-02 3 1  ON 8
ci_010                -8.848715e-03 3 1  ON 9
ci_011                -8.949374e-03 3 1  ON 10
ci_012                -9.109720e-03 3 1  ON 11
ci_013                -1.908937e-02 3 1  ON 12
ci_014                 1.111221e-02 3 1  ON 13
ci_015                 1.092928e-02 3 1  ON 14
ci_016                 1.591185e-02 3 1  ON 15
ci_017                 1.563273e-02 3 1  ON 16
ci_018                 9.114394e-03 3 1  ON 17
ci_019                 8.996073e-03 3 1  ON 18
ci_020                 1.504496e-02 3 1  ON 19
ci_021                 1.521894e-02 3 1  ON 20
ci_022                 8.272078e-03 3 1  ON 21
ci_023                 8.257326e-03 3 1  ON 22
ci_024                 8.333990e-03 3 1  ON 23
ci_025                 8.424345e-03 3 1  ON 24
ci_026                 9.917629e-03 3 1  ON 25
ci_027                 9.699497e-03 3 1  ON 26
ci_028                -1.453069e-02 3 1  ON 27
ci_029                -1.479621e-02 3 1  ON 28
ci_030                -8.762459e-03 3 1  ON 29
ci_031                -8.611318e-03 3 1  ON 30
ci_032                -1.432458e-02 3 1  ON 31
ci_033                 4.550222e-03 3 1  ON 32
ci_034                 4.858574e-03 3 1  ON 33
ci_035                -3.334034e-03 3 1  ON 34
ci_036                -1.121627e-02 3 1  ON 35
ci_037                -1.147475e-02 3 1  ON 36
ci_038                 8.697484e-04 3 1  ON 37
ci_039                 1.138875e-03 3 1  ON 38
ci_040                -1.557592e-03 3 1  ON 39
ci_041                 8.168247e-03 3 1  ON 40
ci_042                 8.168866e-03 3 1  ON 41
ci_043                -2.345611e-03 3 1  ON 42
ci_044                -3.909946e-03 3 1  ON 43
ci_045                -1.992532e-03 3 1  ON 44
ci_046                 4.783038e-03 3 1  ON 45
ci_047                 4.612379e-03 3 1  ON 46
ci_048                -1.238005e-02 3 1  ON 47
ci_049                -1.295775e-02 3 1  ON 48
ci_050                 2.844732e-03 3 1  ON 49
ci_051                 2.992022e-03 3 1  ON 50
ci_052                -2.173279e-03 3 1  ON 51
ci_053                -2.203239e-03 3 1  ON 52
ci_054                -2.209846e-03 3 1  ON 53
ci_055                -2.425863e-03 3 1  ON 54
ci_056                 4.622068e-03 3 1  ON 55
ci_057                 4.641000e-03 3 1  ON 56
ci_058                -2.071179e-03 3 1  ON 57
ci_059                -2.057755e-03 3 1  ON 58
ci_060                 4.762310e-03 3 1  ON 59
ci_061                 5.214693e-03 3 1  ON 60
ci_062                -2.957305e-03 3 1  ON 61
ci_063                -2.811768e-03 3 1  ON 62
ci_064                -2.261360e-03 3 1  ON 63
ci_065                -3.386635e-03 3 1  ON 64
ci_066                 4.061223e-03 3 1  ON 65
ci_067                 4.230978e-03 3 1  ON 66
ci_068                -4.277481e-03 3 1  ON 67
ci_069                -4.113483e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1692
    reference variance = 0.211244
====================================================
  Execution time = 1.3418e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9891e-01
  Total weights = 1.9576e+06
  Execution time = 1.8773e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286725773452
                                         uncertainty =       0.001736669112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286725773452
                                         uncertainty =       0.001736669112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378630371
  error estimate for blocks of size 2^( 2) =       0.000390565375
  error estimate for blocks of size 2^( 3) =       0.000400790350
  error estimate for blocks of size 2^( 4) =       0.000407795875
  error estimate for blocks of size 2^( 5) =       0.000412585801
  error estimate for blocks of size 2^( 6) =       0.000415422309
  error estimate for blocks of size 2^( 7) =       0.000416915145

      target function =      -0.914345513992
              le_mean =     -17.215162625973
             les_mean =     296.660733939534
             stat err =       0.000413179782
             autocorr =       1.190823047706
   target nu stat err =       0.000413179782
   target dn stat err =       0.002340732801
      target stat err =       0.003717416737
              std dev =       0.535464205502
             le_variance =       0.286721915374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286723762947
                                         uncertainty =       0.001736320521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286723762947
                                         uncertainty =       0.001736320521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378629050
  error estimate for blocks of size 2^( 2) =       0.000390565023
  error estimate for blocks of size 2^( 3) =       0.000400791058
  error estimate for blocks of size 2^( 4) =       0.000407797044
  error estimate for blocks of size 2^( 5) =       0.000412587116
  error estimate for blocks of size 2^( 6) =       0.000415423855
  error estimate for blocks of size 2^( 7) =       0.000416917907

      target function =      -0.914307400904
              le_mean =     -17.215162270797
             les_mean =     296.660746162464
             stat err =       0.000413181481
             autocorr =       1.190841146451
   target nu stat err =       0.000413181481
   target dn stat err =       0.002340649374
      target stat err =       0.003716982758
              std dev =       0.535462337179
             le_variance =       0.286719914537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286724732626
                                         uncertainty =       0.001736492765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286724732626
                                         uncertainty =       0.001736492765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378629687
  error estimate for blocks of size 2^( 2) =       0.000390565179
  error estimate for blocks of size 2^( 3) =       0.000400790690
  error estimate for blocks of size 2^( 4) =       0.000407796448
  error estimate for blocks of size 2^( 5) =       0.000412586447
  error estimate for blocks of size 2^( 6) =       0.000415423068
  error estimate for blocks of size 2^( 7) =       0.000416916516

      target function =      -0.914334225989
              le_mean =     -17.215162443891
             les_mean =     296.660734914650
             stat err =       0.000413180620
             autocorr =       1.190832175658
   target nu stat err =       0.000413180620
   target dn stat err =       0.002340593576
      target stat err =       0.003717112442
              std dev =       0.535463238179
             le_variance =       0.286720879441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286725640068
                                         uncertainty =       0.001736646958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286725640068
                                         uncertainty =       0.001736646958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378630283
  error estimate for blocks of size 2^( 2) =       0.000390565348
  error estimate for blocks of size 2^( 3) =       0.000400790391
  error estimate for blocks of size 2^( 4) =       0.000407795945
  error estimate for blocks of size 2^( 5) =       0.000412585880
  error estimate for blocks of size 2^( 6) =       0.000415422402
  error estimate for blocks of size 2^( 7) =       0.000416915314

      target function =      -0.914345543330
              le_mean =     -17.215162602887
             les_mean =     296.660733126568
             stat err =       0.000413179885
             autocorr =       1.190824192321
   target nu stat err =       0.000413179885
   target dn stat err =       0.002340709121
      target stat err =       0.003717380589
              std dev =       0.535464081527
             le_variance =       0.286721782606


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914345513992        initial
     6.2500e+00     6.2500e+01             3.1914e-05        -0.914307400904
     2.5000e+01     2.5000e+02             8.0481e-06        -0.914334225989
     1.0000e+02     1.0000e+03             2.0164e-06        -0.914345543330  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+02     and shift_s =   1.0000e+03
*****************************************************************************

  Execution time = 2.2700e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -3.750713e-02 3 1  ON 0
ci_002                -2.875455e-02 3 1  ON 1
ci_003                -2.362164e-02 3 1  ON 2
ci_004                 2.083013e-02 3 1  ON 3
ci_005                 2.129094e-02 3 1  ON 4
ci_006                -1.838950e-02 3 1  ON 5
ci_007                -1.849298e-02 3 1  ON 6
ci_008                -7.774885e-03 3 1  ON 7
ci_009                -1.389297e-02 3 1  ON 8
ci_010                -8.851175e-03 3 1  ON 9
ci_011                -8.952206e-03 3 1  ON 10
ci_012                -9.110538e-03 3 1  ON 11
ci_013                -1.908948e-02 3 1  ON 12
ci_014                 1.111301e-02 3 1  ON 13
ci_015                 1.092903e-02 3 1  ON 14
ci_016                 1.591235e-02 3 1  ON 15
ci_017                 1.563510e-02 3 1  ON 16
ci_018                 9.114814e-03 3 1  ON 17
ci_019                 8.995867e-03 3 1  ON 18
ci_020                 1.504350e-02 3 1  ON 19
ci_021                 1.521929e-02 3 1  ON 20
ci_022                 8.272986e-03 3 1  ON 21
ci_023                 8.255959e-03 3 1  ON 22
ci_024                 8.334583e-03 3 1  ON 23
ci_025                 8.427345e-03 3 1  ON 24
ci_026                 9.917249e-03 3 1  ON 25
ci_027                 9.699349e-03 3 1  ON 26
ci_028                -1.453076e-02 3 1  ON 27
ci_029                -1.479927e-02 3 1  ON 28
ci_030                -8.762148e-03 3 1  ON 29
ci_031                -8.612664e-03 3 1  ON 30
ci_032                -1.432742e-02 3 1  ON 31
ci_033                 4.547679e-03 3 1  ON 32
ci_034                 4.857796e-03 3 1  ON 33
ci_035                -3.334539e-03 3 1  ON 34
ci_036                -1.121832e-02 3 1  ON 35
ci_037                -1.147634e-02 3 1  ON 36
ci_038                 8.709152e-04 3 1  ON 37
ci_039                 1.138760e-03 3 1  ON 38
ci_040                -1.557389e-03 3 1  ON 39
ci_041                 8.166638e-03 3 1  ON 40
ci_042                 8.167798e-03 3 1  ON 41
ci_043                -2.345178e-03 3 1  ON 42
ci_044                -3.915978e-03 3 1  ON 43
ci_045                -1.993663e-03 3 1  ON 44
ci_046                 4.783606e-03 3 1  ON 45
ci_047                 4.611758e-03 3 1  ON 46
ci_048                -1.238209e-02 3 1  ON 47
ci_049                -1.295954e-02 3 1  ON 48
ci_050                 2.843203e-03 3 1  ON 49
ci_051                 2.991437e-03 3 1  ON 50
ci_052                -2.170040e-03 3 1  ON 51
ci_053                -2.204553e-03 3 1  ON 52
ci_054                -2.209990e-03 3 1  ON 53
ci_055                -2.426614e-03 3 1  ON 54
ci_056                 4.622323e-03 3 1  ON 55
ci_057                 4.639176e-03 3 1  ON 56
ci_058                -2.071820e-03 3 1  ON 57
ci_059                -2.055788e-03 3 1  ON 58
ci_060                 4.760330e-03 3 1  ON 59
ci_061                 5.216702e-03 3 1  ON 60
ci_062                -2.958949e-03 3 1  ON 61
ci_063                -2.810129e-03 3 1  ON 62
ci_064                -2.260584e-03 3 1  ON 63
ci_065                -3.387463e-03 3 1  ON 64
ci_066                 4.062021e-03 3 1  ON 65
ci_067                 4.231496e-03 3 1  ON 66
ci_068                -4.279200e-03 3 1  ON 67
ci_069                -4.112213e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9142e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1991
    reference variance = 0.264011
====================================================
  Execution time = 1.6168e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0727e-01
  Total weights = 1.957922208e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5201e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291743642734
                                         uncertainty =       0.003028827017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291743642734
                                         uncertainty =       0.003028827017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381879007
  error estimate for blocks of size 2^( 2) =       0.000392959963
  error estimate for blocks of size 2^( 3) =       0.000403608830
  error estimate for blocks of size 2^( 4) =       0.000410919981
  error estimate for blocks of size 2^( 5) =       0.000415618077
  error estimate for blocks of size 2^( 6) =       0.000418602839
  error estimate for blocks of size 2^( 7) =       0.000418284593

      target function =      -0.901445572581
              le_mean =     -17.214965381959
             les_mean =     296.662306474405
             stat err =       0.000415856372
             autocorr =       1.185864730359
   target nu stat err =       0.000415856372
   target dn stat err =       0.005109226190
      target stat err =       0.007772947258
              std dev =       0.540058470659
             le_variance =       0.291663151730


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721496538196e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901512012735       residual = 3.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901516472091       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901516904076       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901517050756       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901517059080       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901517063763       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901517065332       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901517064136       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901517064185       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901517064113       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 7.284568e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901512012735       residual = 3.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901513130224       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901513238410       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901513275124       residual = 5.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901513277208       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901513278377       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901513278770       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901513278471       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901513278483       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901513278465       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 1.824832e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901512012735       residual = 3.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901512292273       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901512319332       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901512328512       residual = 5.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901512329034       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901512329327       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901512329424       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901512329350       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901512329353       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901512329349       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+02 is 4.564393e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.161243 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8697e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -3.750665e-02 3 1  ON 0
ci_002                -2.875491e-02 3 1  ON 1
ci_003                -2.362130e-02 3 1  ON 2
ci_004                 2.083081e-02 3 1  ON 3
ci_005                 2.129070e-02 3 1  ON 4
ci_006                -1.838960e-02 3 1  ON 5
ci_007                -1.849319e-02 3 1  ON 6
ci_008                -7.773858e-03 3 1  ON 7
ci_009                -1.389327e-02 3 1  ON 8
ci_010                -8.849675e-03 3 1  ON 9
ci_011                -8.952039e-03 3 1  ON 10
ci_012                -9.110758e-03 3 1  ON 11
ci_013                -1.908920e-02 3 1  ON 12
ci_014                 1.111361e-02 3 1  ON 13
ci_015                 1.092835e-02 3 1  ON 14
ci_016                 1.591244e-02 3 1  ON 15
ci_017                 1.563495e-02 3 1  ON 16
ci_018                 9.115678e-03 3 1  ON 17
ci_019                 8.996153e-03 3 1  ON 18
ci_020                 1.504296e-02 3 1  ON 19
ci_021                 1.521760e-02 3 1  ON 20
ci_022                 8.272216e-03 3 1  ON 21
ci_023                 8.255629e-03 3 1  ON 22
ci_024                 8.335076e-03 3 1  ON 23
ci_025                 8.427183e-03 3 1  ON 24
ci_026                 9.917012e-03 3 1  ON 25
ci_027                 9.699312e-03 3 1  ON 26
ci_028                -1.453043e-02 3 1  ON 27
ci_029                -1.479929e-02 3 1  ON 28
ci_030                -8.762022e-03 3 1  ON 29
ci_031                -8.613319e-03 3 1  ON 30
ci_032                -1.432799e-02 3 1  ON 31
ci_033                 4.547878e-03 3 1  ON 32
ci_034                 4.855971e-03 3 1  ON 33
ci_035                -3.334217e-03 3 1  ON 34
ci_036                -1.121948e-02 3 1  ON 35
ci_037                -1.147597e-02 3 1  ON 36
ci_038                 8.695310e-04 3 1  ON 37
ci_039                 1.138046e-03 3 1  ON 38
ci_040                -1.557215e-03 3 1  ON 39
ci_041                 8.167104e-03 3 1  ON 40
ci_042                 8.167440e-03 3 1  ON 41
ci_043                -2.344950e-03 3 1  ON 42
ci_044                -3.914873e-03 3 1  ON 43
ci_045                -1.993927e-03 3 1  ON 44
ci_046                 4.783025e-03 3 1  ON 45
ci_047                 4.612141e-03 3 1  ON 46
ci_048                -1.238208e-02 3 1  ON 47
ci_049                -1.295888e-02 3 1  ON 48
ci_050                 2.844916e-03 3 1  ON 49
ci_051                 2.990843e-03 3 1  ON 50
ci_052                -2.170115e-03 3 1  ON 51
ci_053                -2.203495e-03 3 1  ON 52
ci_054                -2.209691e-03 3 1  ON 53
ci_055                -2.426880e-03 3 1  ON 54
ci_056                 4.620986e-03 3 1  ON 55
ci_057                 4.639452e-03 3 1  ON 56
ci_058                -2.071528e-03 3 1  ON 57
ci_059                -2.055881e-03 3 1  ON 58
ci_060                 4.760872e-03 3 1  ON 59
ci_061                 5.217248e-03 3 1  ON 60
ci_062                -2.958632e-03 3 1  ON 61
ci_063                -2.810932e-03 3 1  ON 62
ci_064                -2.260899e-03 3 1  ON 63
ci_065                -3.387346e-03 3 1  ON 64
ci_066                 4.062140e-03 3 1  ON 65
ci_067                 4.230999e-03 3 1  ON 66
ci_068                -4.279375e-03 3 1  ON 67
ci_069                -4.111280e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2291
    reference variance = 0.506877
====================================================
  Execution time = 1.3601e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9552e-01
  Total weights = 1.9578e+06
  Execution time = 1.8311e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283191004885
                                         uncertainty =       0.001669753400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283191004885
                                         uncertainty =       0.001669753400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376281139
  error estimate for blocks of size 2^( 2) =       0.000387558464
  error estimate for blocks of size 2^( 3) =       0.000398145639
  error estimate for blocks of size 2^( 4) =       0.000405393773
  error estimate for blocks of size 2^( 5) =       0.000409931711
  error estimate for blocks of size 2^( 6) =       0.000412753476
  error estimate for blocks of size 2^( 7) =       0.000415533674

      target function =      -0.919686464915
              le_mean =     -17.214579831544
             les_mean =     296.637272634010
             stat err =       0.000410903158
             autocorr =       1.192488114158
   target nu stat err =       0.000410903158
   target dn stat err =       0.002210859671
      target stat err =       0.003554536444
              std dev =       0.532141889888
             le_variance =       0.283174990974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283188500871
                                         uncertainty =       0.001669561284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283188500871
                                         uncertainty =       0.001669561284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376279473
  error estimate for blocks of size 2^( 2) =       0.000387557141
  error estimate for blocks of size 2^( 3) =       0.000398144547
  error estimate for blocks of size 2^( 4) =       0.000405392883
  error estimate for blocks of size 2^( 5) =       0.000409930917
  error estimate for blocks of size 2^( 6) =       0.000412752471
  error estimate for blocks of size 2^( 7) =       0.000415533288

      target function =      -0.919674556806
              le_mean =     -17.214579887928
             les_mean =     296.637282136783
             stat err =       0.000410902390
             autocorr =       1.192494210447
   target nu stat err =       0.000410902390
   target dn stat err =       0.002210171845
      target stat err =       0.003553383844
              std dev =       0.532139534203
             le_variance =       0.283172483861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283189745238
                                         uncertainty =       0.001669656740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283189745238
                                         uncertainty =       0.001669656740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376280301
  error estimate for blocks of size 2^( 2) =       0.000387557798
  error estimate for blocks of size 2^( 3) =       0.000398145089
  error estimate for blocks of size 2^( 4) =       0.000405393324
  error estimate for blocks of size 2^( 5) =       0.000409931310
  error estimate for blocks of size 2^( 6) =       0.000412752969
  error estimate for blocks of size 2^( 7) =       0.000415533478

      target function =      -0.919681386877
              le_mean =     -17.214579859541
             les_mean =     296.637276822875
             stat err =       0.000410902770
             autocorr =       1.192491171668
   target nu stat err =       0.000410902770
   target dn stat err =       0.002210497408
      target stat err =       0.003553938426
              std dev =       0.532140704866
             le_variance =       0.283173729776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283190846823
                                         uncertainty =       0.001669741269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283190846823
                                         uncertainty =       0.001669741269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376281034
  error estimate for blocks of size 2^( 2) =       0.000387558380
  error estimate for blocks of size 2^( 3) =       0.000398145570
  error estimate for blocks of size 2^( 4) =       0.000405393716
  error estimate for blocks of size 2^( 5) =       0.000409931660
  error estimate for blocks of size 2^( 6) =       0.000412753412
  error estimate for blocks of size 2^( 7) =       0.000415533649

      target function =      -0.919685934802
              le_mean =     -17.214579835022
             les_mean =     296.637273090493
             stat err =       0.000410903109
             autocorr =       1.192488496930
   target nu stat err =       0.000410903109
   target dn stat err =       0.002210812720
      target stat err =       0.003554459907
              std dev =       0.532141741192
             le_variance =       0.283174832718


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919686464915        initial  <--
     2.5000e+01     2.5000e+02             7.2846e-06        -0.919674556806
     1.0000e+02     1.0000e+03             1.8248e-06        -0.919681386877
     4.0000e+02     4.0000e+03             4.5644e-07        -0.919685934802

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8380
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -3.750713e-02 3 1  ON 0
ci_002                -2.875455e-02 3 1  ON 1
ci_003                -2.362164e-02 3 1  ON 2
ci_004                 2.083013e-02 3 1  ON 3
ci_005                 2.129094e-02 3 1  ON 4
ci_006                -1.838950e-02 3 1  ON 5
ci_007                -1.849298e-02 3 1  ON 6
ci_008                -7.774885e-03 3 1  ON 7
ci_009                -1.389297e-02 3 1  ON 8
ci_010                -8.851175e-03 3 1  ON 9
ci_011                -8.952206e-03 3 1  ON 10
ci_012                -9.110538e-03 3 1  ON 11
ci_013                -1.908948e-02 3 1  ON 12
ci_014                 1.111301e-02 3 1  ON 13
ci_015                 1.092903e-02 3 1  ON 14
ci_016                 1.591235e-02 3 1  ON 15
ci_017                 1.563510e-02 3 1  ON 16
ci_018                 9.114814e-03 3 1  ON 17
ci_019                 8.995867e-03 3 1  ON 18
ci_020                 1.504350e-02 3 1  ON 19
ci_021                 1.521929e-02 3 1  ON 20
ci_022                 8.272986e-03 3 1  ON 21
ci_023                 8.255959e-03 3 1  ON 22
ci_024                 8.334583e-03 3 1  ON 23
ci_025                 8.427345e-03 3 1  ON 24
ci_026                 9.917249e-03 3 1  ON 25
ci_027                 9.699349e-03 3 1  ON 26
ci_028                -1.453076e-02 3 1  ON 27
ci_029                -1.479927e-02 3 1  ON 28
ci_030                -8.762148e-03 3 1  ON 29
ci_031                -8.612664e-03 3 1  ON 30
ci_032                -1.432742e-02 3 1  ON 31
ci_033                 4.547679e-03 3 1  ON 32
ci_034                 4.857796e-03 3 1  ON 33
ci_035                -3.334539e-03 3 1  ON 34
ci_036                -1.121832e-02 3 1  ON 35
ci_037                -1.147634e-02 3 1  ON 36
ci_038                 8.709152e-04 3 1  ON 37
ci_039                 1.138760e-03 3 1  ON 38
ci_040                -1.557389e-03 3 1  ON 39
ci_041                 8.166638e-03 3 1  ON 40
ci_042                 8.167798e-03 3 1  ON 41
ci_043                -2.345178e-03 3 1  ON 42
ci_044                -3.915978e-03 3 1  ON 43
ci_045                -1.993663e-03 3 1  ON 44
ci_046                 4.783606e-03 3 1  ON 45
ci_047                 4.611758e-03 3 1  ON 46
ci_048                -1.238209e-02 3 1  ON 47
ci_049                -1.295954e-02 3 1  ON 48
ci_050                 2.843203e-03 3 1  ON 49
ci_051                 2.991437e-03 3 1  ON 50
ci_052                -2.170040e-03 3 1  ON 51
ci_053                -2.204553e-03 3 1  ON 52
ci_054                -2.209990e-03 3 1  ON 53
ci_055                -2.426614e-03 3 1  ON 54
ci_056                 4.622323e-03 3 1  ON 55
ci_057                 4.639176e-03 3 1  ON 56
ci_058                -2.071820e-03 3 1  ON 57
ci_059                -2.055788e-03 3 1  ON 58
ci_060                 4.760330e-03 3 1  ON 59
ci_061                 5.216702e-03 3 1  ON 60
ci_062                -2.958949e-03 3 1  ON 61
ci_063                -2.810129e-03 3 1  ON 62
ci_064                -2.260584e-03 3 1  ON 63
ci_065                -3.387463e-03 3 1  ON 64
ci_066                 4.062021e-03 3 1  ON 65
ci_067                 4.231496e-03 3 1  ON 66
ci_068                -4.279200e-03 3 1  ON 67
ci_069                -4.112213e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1542e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2372
    reference variance = 0.233457
====================================================
  Execution time = 1.3733e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0403e-01
  Total weights = 1.957863062e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5187e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290615814936
                                         uncertainty =       0.001699297124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290615814936
                                         uncertainty =       0.001699297124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381188314
  error estimate for blocks of size 2^( 2) =       0.000392354162
  error estimate for blocks of size 2^( 3) =       0.000402665150
  error estimate for blocks of size 2^( 4) =       0.000410297034
  error estimate for blocks of size 2^( 5) =       0.000414874482
  error estimate for blocks of size 2^( 6) =       0.000417762069
  error estimate for blocks of size 2^( 7) =       0.000420440299

      target function =      -0.906443540996
              le_mean =     -17.214746663666
             les_mean =     296.651536249845
             stat err =       0.000415843471
             autocorr =       1.190092227075
   target nu stat err =       0.000415843471
   target dn stat err =       0.002425543792
      target stat err =       0.003780153820
              std dev =       0.539081683079
             le_variance =       0.290609061031


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721474666367e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906458350253       residual = 9.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906458480108       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906458501260       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906458508615       residual = 6.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906458510112       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906458510434       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906458510575       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906458510537       residual = 9.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906458510520       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906458510516       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 4.277105e-07

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906458350253       residual = 9.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906458382724       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906458388013       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906458389852       residual = 6.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906458390226       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906458390307       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906458390342       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906458390332       residual = 9.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906458390327       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906458390328       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+03 is 1.069461e-07

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906458350253       residual = 9.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906458358371       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906458359693       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906458360153       residual = 6.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906458360247       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906458360267       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906458360283       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906458360273       residual = 9.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906458360272       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906458360272       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+03 is 2.673769e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164777 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6262e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -3.750707e-02 3 1  ON 0
ci_002                -2.875454e-02 3 1  ON 1
ci_003                -2.362169e-02 3 1  ON 2
ci_004                 2.083016e-02 3 1  ON 3
ci_005                 2.129090e-02 3 1  ON 4
ci_006                -1.838948e-02 3 1  ON 5
ci_007                -1.849309e-02 3 1  ON 6
ci_008                -7.774877e-03 3 1  ON 7
ci_009                -1.389293e-02 3 1  ON 8
ci_010                -8.851273e-03 3 1  ON 9
ci_011                -8.952214e-03 3 1  ON 10
ci_012                -9.110552e-03 3 1  ON 11
ci_013                -1.908944e-02 3 1  ON 12
ci_014                 1.111297e-02 3 1  ON 13
ci_015                 1.092909e-02 3 1  ON 14
ci_016                 1.591230e-02 3 1  ON 15
ci_017                 1.563512e-02 3 1  ON 16
ci_018                 9.114789e-03 3 1  ON 17
ci_019                 8.995836e-03 3 1  ON 18
ci_020                 1.504348e-02 3 1  ON 19
ci_021                 1.521919e-02 3 1  ON 20
ci_022                 8.273017e-03 3 1  ON 21
ci_023                 8.255883e-03 3 1  ON 22
ci_024                 8.334496e-03 3 1  ON 23
ci_025                 8.427331e-03 3 1  ON 24
ci_026                 9.917161e-03 3 1  ON 25
ci_027                 9.699372e-03 3 1  ON 26
ci_028                -1.453074e-02 3 1  ON 27
ci_029                -1.479936e-02 3 1  ON 28
ci_030                -8.762113e-03 3 1  ON 29
ci_031                -8.612653e-03 3 1  ON 30
ci_032                -1.432740e-02 3 1  ON 31
ci_033                 4.547746e-03 3 1  ON 32
ci_034                 4.857741e-03 3 1  ON 33
ci_035                -3.334550e-03 3 1  ON 34
ci_036                -1.121842e-02 3 1  ON 35
ci_037                -1.147633e-02 3 1  ON 36
ci_038                 8.709252e-04 3 1  ON 37
ci_039                 1.138767e-03 3 1  ON 38
ci_040                -1.557388e-03 3 1  ON 39
ci_041                 8.166727e-03 3 1  ON 40
ci_042                 8.167748e-03 3 1  ON 41
ci_043                -2.345154e-03 3 1  ON 42
ci_044                -3.915892e-03 3 1  ON 43
ci_045                -1.993666e-03 3 1  ON 44
ci_046                 4.783551e-03 3 1  ON 45
ci_047                 4.611750e-03 3 1  ON 46
ci_048                -1.238206e-02 3 1  ON 47
ci_049                -1.295954e-02 3 1  ON 48
ci_050                 2.843160e-03 3 1  ON 49
ci_051                 2.991383e-03 3 1  ON 50
ci_052                -2.170037e-03 3 1  ON 51
ci_053                -2.204577e-03 3 1  ON 52
ci_054                -2.209995e-03 3 1  ON 53
ci_055                -2.426646e-03 3 1  ON 54
ci_056                 4.622330e-03 3 1  ON 55
ci_057                 4.639185e-03 3 1  ON 56
ci_058                -2.071838e-03 3 1  ON 57
ci_059                -2.055832e-03 3 1  ON 58
ci_060                 4.760387e-03 3 1  ON 59
ci_061                 5.216671e-03 3 1  ON 60
ci_062                -2.958953e-03 3 1  ON 61
ci_063                -2.810097e-03 3 1  ON 62
ci_064                -2.260535e-03 3 1  ON 63
ci_065                -3.387468e-03 3 1  ON 64
ci_066                 4.062019e-03 3 1  ON 65
ci_067                 4.231500e-03 3 1  ON 66
ci_068                -4.279194e-03 3 1  ON 67
ci_069                -4.112193e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2065
    reference variance = 0.500449
====================================================
  Execution time = 1.3463e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0006e-01
  Total weights = 1.9575e+06
  Execution time = 1.8277e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287916893015
                                         uncertainty =       0.001528037870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287916893015
                                         uncertainty =       0.001528037870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379391675
  error estimate for blocks of size 2^( 2) =       0.000390959938
  error estimate for blocks of size 2^( 3) =       0.000401007037
  error estimate for blocks of size 2^( 4) =       0.000408613613
  error estimate for blocks of size 2^( 5) =       0.000413726368
  error estimate for blocks of size 2^( 6) =       0.000416193124
  error estimate for blocks of size 2^( 7) =       0.000416871936

      target function =      -0.912567651265
              le_mean =     -17.214706257338
             les_mean =     296.646172429178
             stat err =       0.000413851260
             autocorr =       1.189906866121
   target nu stat err =       0.000413851260
   target dn stat err =       0.002536687560
      target stat err =       0.003999295181
              std dev =       0.536540852053
             le_variance =       0.287876085922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287916815499
                                         uncertainty =       0.001528014353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287916815499
                                         uncertainty =       0.001528014353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379391624
  error estimate for blocks of size 2^( 2) =       0.000390959902
  error estimate for blocks of size 2^( 3) =       0.000401007016
  error estimate for blocks of size 2^( 4) =       0.000408613598
  error estimate for blocks of size 2^( 5) =       0.000413726361
  error estimate for blocks of size 2^( 6) =       0.000416193117
  error estimate for blocks of size 2^( 7) =       0.000416871926

      target function =      -0.912568442026
              le_mean =     -17.214706257889
             les_mean =     296.646171939087
             stat err =       0.000413851250
             autocorr =       1.189907130558
   target nu stat err =       0.000413851250
   target dn stat err =       0.002536632718
      target stat err =       0.003999218217
              std dev =       0.536540779689
             le_variance =       0.287876008269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287916854238
                                         uncertainty =       0.001528026108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287916854238
                                         uncertainty =       0.001528026108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379391649
  error estimate for blocks of size 2^( 2) =       0.000390959920
  error estimate for blocks of size 2^( 3) =       0.000401007026
  error estimate for blocks of size 2^( 4) =       0.000408613606
  error estimate for blocks of size 2^( 5) =       0.000413726365
  error estimate for blocks of size 2^( 6) =       0.000416193120
  error estimate for blocks of size 2^( 7) =       0.000416871931

      target function =      -0.912568053785
              le_mean =     -17.214706257613
             les_mean =     296.646172179513
             stat err =       0.000413851255
             autocorr =       1.189906998367
   target nu stat err =       0.000413851255
   target dn stat err =       0.002536660112
      target stat err =       0.003999256719
              std dev =       0.536540815853
             le_variance =       0.287876047076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287916888166
                                         uncertainty =       0.001528036399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287916888166
                                         uncertainty =       0.001528036399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379391672
  error estimate for blocks of size 2^( 2) =       0.000390959936
  error estimate for blocks of size 2^( 3) =       0.000401007036
  error estimate for blocks of size 2^( 4) =       0.000408613612
  error estimate for blocks of size 2^( 5) =       0.000413726368
  error estimate for blocks of size 2^( 6) =       0.000416193124
  error estimate for blocks of size 2^( 7) =       0.000416871935

      target function =      -0.912567702385
              le_mean =     -17.214706257373
             les_mean =     296.646172397449
             stat err =       0.000413851260
             autocorr =       1.189906882655
   target nu stat err =       0.000413851260
   target dn stat err =       0.002536684127
      target stat err =       0.003999290376
              std dev =       0.536540847527
             le_variance =       0.287876081065


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912567651265        initial
     2.5000e+02     2.5000e+03             4.2771e-07        -0.912568442026  <--
     1.0000e+03     1.0000e+04             1.0695e-07        -0.912568053785
     4.0000e+03     4.0000e+04             2.6738e-08        -0.912567702385

*****************************************************************************
Applying the update for shift_i =   2.5000e+02     and shift_s =   2.5000e+03
*****************************************************************************

  Execution time = 2.2670e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -3.750692e-02 3 1  ON 0
ci_002                -2.875453e-02 3 1  ON 1
ci_003                -2.362184e-02 3 1  ON 2
ci_004                 2.083023e-02 3 1  ON 3
ci_005                 2.129077e-02 3 1  ON 4
ci_006                -1.838940e-02 3 1  ON 5
ci_007                -1.849341e-02 3 1  ON 6
ci_008                -7.774851e-03 3 1  ON 7
ci_009                -1.389278e-02 3 1  ON 8
ci_010                -8.851568e-03 3 1  ON 9
ci_011                -8.952239e-03 3 1  ON 10
ci_012                -9.110593e-03 3 1  ON 11
ci_013                -1.908932e-02 3 1  ON 12
ci_014                 1.111287e-02 3 1  ON 13
ci_015                 1.092926e-02 3 1  ON 14
ci_016                 1.591214e-02 3 1  ON 15
ci_017                 1.563518e-02 3 1  ON 16
ci_018                 9.114714e-03 3 1  ON 17
ci_019                 8.995740e-03 3 1  ON 18
ci_020                 1.504341e-02 3 1  ON 19
ci_021                 1.521890e-02 3 1  ON 20
ci_022                 8.273107e-03 3 1  ON 21
ci_023                 8.255655e-03 3 1  ON 22
ci_024                 8.334237e-03 3 1  ON 23
ci_025                 8.427289e-03 3 1  ON 24
ci_026                 9.916897e-03 3 1  ON 25
ci_027                 9.699439e-03 3 1  ON 26
ci_028                -1.453067e-02 3 1  ON 27
ci_029                -1.479960e-02 3 1  ON 28
ci_030                -8.762008e-03 3 1  ON 29
ci_031                -8.612623e-03 3 1  ON 30
ci_032                -1.432733e-02 3 1  ON 31
ci_033                 4.547945e-03 3 1  ON 32
ci_034                 4.857577e-03 3 1  ON 33
ci_035                -3.334583e-03 3 1  ON 34
ci_036                -1.121871e-02 3 1  ON 35
ci_037                -1.147628e-02 3 1  ON 36
ci_038                 8.709554e-04 3 1  ON 37
ci_039                 1.138790e-03 3 1  ON 38
ci_040                -1.557386e-03 3 1  ON 39
ci_041                 8.166992e-03 3 1  ON 40
ci_042                 8.167598e-03 3 1  ON 41
ci_043                -2.345083e-03 3 1  ON 42
ci_044                -3.915634e-03 3 1  ON 43
ci_045                -1.993675e-03 3 1  ON 44
ci_046                 4.783384e-03 3 1  ON 45
ci_047                 4.611727e-03 3 1  ON 46
ci_048                -1.238196e-02 3 1  ON 47
ci_049                -1.295956e-02 3 1  ON 48
ci_050                 2.843031e-03 3 1  ON 49
ci_051                 2.991221e-03 3 1  ON 50
ci_052                -2.170028e-03 3 1  ON 51
ci_053                -2.204648e-03 3 1  ON 52
ci_054                -2.210011e-03 3 1  ON 53
ci_055                -2.426739e-03 3 1  ON 54
ci_056                 4.622352e-03 3 1  ON 55
ci_057                 4.639213e-03 3 1  ON 56
ci_058                -2.071891e-03 3 1  ON 57
ci_059                -2.055964e-03 3 1  ON 58
ci_060                 4.760559e-03 3 1  ON 59
ci_061                 5.216581e-03 3 1  ON 60
ci_062                -2.958966e-03 3 1  ON 61
ci_063                -2.809999e-03 3 1  ON 62
ci_064                -2.260387e-03 3 1  ON 63
ci_065                -3.387485e-03 3 1  ON 64
ci_066                 4.062015e-03 3 1  ON 65
ci_067                 4.231515e-03 3 1  ON 66
ci_068                -4.279174e-03 3 1  ON 67
ci_069                -4.112136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8938e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2626
    reference variance = 0.208044
====================================================
  Execution time = 1.3723e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9941e-01
  Total weights = 1.957614991e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4801e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286656058488
                                         uncertainty =       0.001816016733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286656058488
                                         uncertainty =       0.001816016733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378566826
  error estimate for blocks of size 2^( 2) =       0.000390310697
  error estimate for blocks of size 2^( 3) =       0.000400689280
  error estimate for blocks of size 2^( 4) =       0.000408789163
  error estimate for blocks of size 2^( 5) =       0.000412651285
  error estimate for blocks of size 2^( 6) =       0.000415658822
  error estimate for blocks of size 2^( 7) =       0.000415161223

      target function =      -0.913595247178
              le_mean =     -17.214250109884
             les_mean =     296.629817153662
             stat err =       0.000413065123
             autocorr =       1.190561808340
   target nu stat err =       0.000413065123
   target dn stat err =       0.002400159537
      target stat err =       0.003795809851
              std dev =       0.535374339483
             le_variance =       0.286625683377


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721425010988e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913610079052       residual = 6.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913610550546       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913610635676       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913610665520       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913610668928       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913610669945       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913610669392       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913610669557       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913610669588       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913610669587       residual = 5.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 2.364626e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913610079052       residual = 6.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913610197035       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913610218331       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913610225795       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913610226647       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913610226901       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913610226763       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913610226804       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913610226811       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913610226811       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 5.916162e-07

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913610079052       residual = 6.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913610108555       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913610113879       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913610115746       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913610115959       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913610116022       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913610115988       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913610115997       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913610116000       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913610115999       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+03 is 1.479328e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168309 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6213e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -3.750669e-02 3 1  ON 0
ci_002                -2.875436e-02 3 1  ON 1
ci_003                -2.362132e-02 3 1  ON 2
ci_004                 2.083028e-02 3 1  ON 3
ci_005                 2.129068e-02 3 1  ON 4
ci_006                -1.838966e-02 3 1  ON 5
ci_007                -1.849352e-02 3 1  ON 6
ci_008                -7.774928e-03 3 1  ON 7
ci_009                -1.389295e-02 3 1  ON 8
ci_010                -8.851569e-03 3 1  ON 9
ci_011                -8.952417e-03 3 1  ON 10
ci_012                -9.110649e-03 3 1  ON 11
ci_013                -1.908949e-02 3 1  ON 12
ci_014                 1.111284e-02 3 1  ON 13
ci_015                 1.092929e-02 3 1  ON 14
ci_016                 1.591200e-02 3 1  ON 15
ci_017                 1.563538e-02 3 1  ON 16
ci_018                 9.114580e-03 3 1  ON 17
ci_019                 8.995706e-03 3 1  ON 18
ci_020                 1.504366e-02 3 1  ON 19
ci_021                 1.521898e-02 3 1  ON 20
ci_022                 8.272890e-03 3 1  ON 21
ci_023                 8.255535e-03 3 1  ON 22
ci_024                 8.334375e-03 3 1  ON 23
ci_025                 8.426698e-03 3 1  ON 24
ci_026                 9.916887e-03 3 1  ON 25
ci_027                 9.699489e-03 3 1  ON 26
ci_028                -1.453088e-02 3 1  ON 27
ci_029                -1.479915e-02 3 1  ON 28
ci_030                -8.761868e-03 3 1  ON 29
ci_031                -8.612399e-03 3 1  ON 30
ci_032                -1.432765e-02 3 1  ON 31
ci_033                 4.547953e-03 3 1  ON 32
ci_034                 4.857242e-03 3 1  ON 33
ci_035                -3.334470e-03 3 1  ON 34
ci_036                -1.121876e-02 3 1  ON 35
ci_037                -1.147624e-02 3 1  ON 36
ci_038                 8.709866e-04 3 1  ON 37
ci_039                 1.138752e-03 3 1  ON 38
ci_040                -1.557361e-03 3 1  ON 39
ci_041                 8.166989e-03 3 1  ON 40
ci_042                 8.167649e-03 3 1  ON 41
ci_043                -2.344994e-03 3 1  ON 42
ci_044                -3.915159e-03 3 1  ON 43
ci_045                -1.993536e-03 3 1  ON 44
ci_046                 4.783283e-03 3 1  ON 45
ci_047                 4.611873e-03 3 1  ON 46
ci_048                -1.238237e-02 3 1  ON 47
ci_049                -1.295942e-02 3 1  ON 48
ci_050                 2.843228e-03 3 1  ON 49
ci_051                 2.991217e-03 3 1  ON 50
ci_052                -2.170253e-03 3 1  ON 51
ci_053                -2.204574e-03 3 1  ON 52
ci_054                -2.210082e-03 3 1  ON 53
ci_055                -2.426748e-03 3 1  ON 54
ci_056                 4.622294e-03 3 1  ON 55
ci_057                 4.639167e-03 3 1  ON 56
ci_058                -2.071805e-03 3 1  ON 57
ci_059                -2.056000e-03 3 1  ON 58
ci_060                 4.760284e-03 3 1  ON 59
ci_061                 5.216421e-03 3 1  ON 60
ci_062                -2.958887e-03 3 1  ON 61
ci_063                -2.810214e-03 3 1  ON 62
ci_064                -2.260417e-03 3 1  ON 63
ci_065                -3.387479e-03 3 1  ON 64
ci_066                 4.062176e-03 3 1  ON 65
ci_067                 4.231497e-03 3 1  ON 66
ci_068                -4.279141e-03 3 1  ON 67
ci_069                -4.112044e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2782
    reference variance = 0.27112
====================================================
  Execution time = 1.3422e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9753e-01
  Total weights = 1.9577e+06
  Execution time = 1.8261e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286016904879
                                         uncertainty =       0.002042963560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286016904879
                                         uncertainty =       0.002042963560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378140377
  error estimate for blocks of size 2^( 2) =       0.000389489407
  error estimate for blocks of size 2^( 3) =       0.000399697491
  error estimate for blocks of size 2^( 4) =       0.000407713910
  error estimate for blocks of size 2^( 5) =       0.000412696144
  error estimate for blocks of size 2^( 6) =       0.000413941606
  error estimate for blocks of size 2^( 7) =       0.000414600522

      target function =      -0.916522650004
              le_mean =     -17.214483960148
             les_mean =     296.635987957467
             stat err =       0.000412238045
             autocorr =       1.188474958995
   target nu stat err =       0.000412238045
   target dn stat err =       0.002249673709
      target stat err =       0.003589962978
              std dev =       0.534771249174
             le_variance =       0.285980288943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286016937816
                                         uncertainty =       0.002042999213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286016937816
                                         uncertainty =       0.002042999213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378140399
  error estimate for blocks of size 2^( 2) =       0.000389489471
  error estimate for blocks of size 2^( 3) =       0.000399697591
  error estimate for blocks of size 2^( 4) =       0.000407714005
  error estimate for blocks of size 2^( 5) =       0.000412696259
  error estimate for blocks of size 2^( 6) =       0.000413941668
  error estimate for blocks of size 2^( 7) =       0.000414600648

      target function =      -0.916523031611
              le_mean =     -17.214483953107
             les_mean =     296.635987471675
             stat err =       0.000412238145
             autocorr =       1.188475391270
   target nu stat err =       0.000412238145
   target dn stat err =       0.002249626695
      target stat err =       0.003589893755
              std dev =       0.534771281339
             le_variance =       0.285980323345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286016921201
                                         uncertainty =       0.002042981399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286016921201
                                         uncertainty =       0.002042981399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378140388
  error estimate for blocks of size 2^( 2) =       0.000389489439
  error estimate for blocks of size 2^( 3) =       0.000399697541
  error estimate for blocks of size 2^( 4) =       0.000407713957
  error estimate for blocks of size 2^( 5) =       0.000412696201
  error estimate for blocks of size 2^( 6) =       0.000413941637
  error estimate for blocks of size 2^( 7) =       0.000414600585

      target function =      -0.916522857162
              le_mean =     -17.214483956603
             les_mean =     296.635987703297
             stat err =       0.000412238095
             autocorr =       1.188475175257
   target nu stat err =       0.000412238095
   target dn stat err =       0.002249649470
      target stat err =       0.003589927368
              std dev =       0.534771265120
             le_variance =       0.285980305998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286016906902
                                         uncertainty =       0.002042965790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286016906902
                                         uncertainty =       0.002042965790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378140378
  error estimate for blocks of size 2^( 2) =       0.000389489411
  error estimate for blocks of size 2^( 3) =       0.000399697497
  error estimate for blocks of size 2^( 4) =       0.000407713916
  error estimate for blocks of size 2^( 5) =       0.000412696151
  error estimate for blocks of size 2^( 6) =       0.000413941609
  error estimate for blocks of size 2^( 7) =       0.000414600530

      target function =      -0.916522677646
              le_mean =     -17.214483959702
             les_mean =     296.635987924499
             stat err =       0.000412238052
             autocorr =       1.188474986022
   target nu stat err =       0.000412238052
   target dn stat err =       0.002249670601
      target stat err =       0.003589958421
              std dev =       0.534771251151
             le_variance =       0.285980291057


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916522650004        initial
     6.2500e+01     6.2500e+02             2.3646e-06        -0.916523031611  <--
     2.5000e+02     2.5000e+03             5.9162e-07        -0.916522857162
     1.0000e+03     1.0000e+04             1.4793e-07        -0.916522677646

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 2.2635e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -3.750602e-02 3 1  ON 0
ci_002                -2.875386e-02 3 1  ON 1
ci_003                -2.361977e-02 3 1  ON 2
ci_004                 2.083046e-02 3 1  ON 3
ci_005                 2.129040e-02 3 1  ON 4
ci_006                -1.839043e-02 3 1  ON 5
ci_007                -1.849384e-02 3 1  ON 6
ci_008                -7.775157e-03 3 1  ON 7
ci_009                -1.389349e-02 3 1  ON 8
ci_010                -8.851570e-03 3 1  ON 9
ci_011                -8.952951e-03 3 1  ON 10
ci_012                -9.110814e-03 3 1  ON 11
ci_013                -1.909001e-02 3 1  ON 12
ci_014                 1.111276e-02 3 1  ON 13
ci_015                 1.092937e-02 3 1  ON 14
ci_016                 1.591159e-02 3 1  ON 15
ci_017                 1.563598e-02 3 1  ON 16
ci_018                 9.114177e-03 3 1  ON 17
ci_019                 8.995605e-03 3 1  ON 18
ci_020                 1.504443e-02 3 1  ON 19
ci_021                 1.521920e-02 3 1  ON 20
ci_022                 8.272238e-03 3 1  ON 21
ci_023                 8.255172e-03 3 1  ON 22
ci_024                 8.334792e-03 3 1  ON 23
ci_025                 8.424925e-03 3 1  ON 24
ci_026                 9.916858e-03 3 1  ON 25
ci_027                 9.699640e-03 3 1  ON 26
ci_028                -1.453151e-02 3 1  ON 27
ci_029                -1.479781e-02 3 1  ON 28
ci_030                -8.761449e-03 3 1  ON 29
ci_031                -8.611729e-03 3 1  ON 30
ci_032                -1.432860e-02 3 1  ON 31
ci_033                 4.547979e-03 3 1  ON 32
ci_034                 4.856239e-03 3 1  ON 33
ci_035                -3.334130e-03 3 1  ON 34
ci_036                -1.121888e-02 3 1  ON 35
ci_037                -1.147614e-02 3 1  ON 36
ci_038                 8.710802e-04 3 1  ON 37
ci_039                 1.138638e-03 3 1  ON 38
ci_040                -1.557287e-03 3 1  ON 39
ci_041                 8.166981e-03 3 1  ON 40
ci_042                 8.167802e-03 3 1  ON 41
ci_043                -2.344726e-03 3 1  ON 42
ci_044                -3.913734e-03 3 1  ON 43
ci_045                -1.993120e-03 3 1  ON 44
ci_046                 4.782981e-03 3 1  ON 45
ci_047                 4.612309e-03 3 1  ON 46
ci_048                -1.238359e-02 3 1  ON 47
ci_049                -1.295900e-02 3 1  ON 48
ci_050                 2.843818e-03 3 1  ON 49
ci_051                 2.991204e-03 3 1  ON 50
ci_052                -2.170926e-03 3 1  ON 51
ci_053                -2.204355e-03 3 1  ON 52
ci_054                -2.210296e-03 3 1  ON 53
ci_055                -2.426774e-03 3 1  ON 54
ci_056                 4.622122e-03 3 1  ON 55
ci_057                 4.639028e-03 3 1  ON 56
ci_058                -2.071544e-03 3 1  ON 57
ci_059                -2.056109e-03 3 1  ON 58
ci_060                 4.759462e-03 3 1  ON 59
ci_061                 5.215942e-03 3 1  ON 60
ci_062                -2.958649e-03 3 1  ON 61
ci_063                -2.810860e-03 3 1  ON 62
ci_064                -2.260508e-03 3 1  ON 63
ci_065                -3.387464e-03 3 1  ON 64
ci_066                 4.062658e-03 3 1  ON 65
ci_067                 4.231445e-03 3 1  ON 66
ci_068                -4.279042e-03 3 1  ON 67
ci_069                -4.111771e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8855e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2527
    reference variance = 0.291655
====================================================
  Execution time = 1.3741e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0233e-01
  Total weights = 1.957670557e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5333e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287728083187
                                         uncertainty =       0.001915723108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287728083187
                                         uncertainty =       0.001915723108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379266284
  error estimate for blocks of size 2^( 2) =       0.000390580054
  error estimate for blocks of size 2^( 3) =       0.000401046543
  error estimate for blocks of size 2^( 4) =       0.000408643718
  error estimate for blocks of size 2^( 5) =       0.000414147845
  error estimate for blocks of size 2^( 6) =       0.000416711452
  error estimate for blocks of size 2^( 7) =       0.000416472451

      target function =      -0.909063161811
              le_mean =     -17.214707952751
             les_mean =     296.648495154870
             stat err =       0.000413993867
             autocorr =       1.191514526651
   target nu stat err =       0.000413993867
   target dn stat err =       0.002833984879
      target stat err =       0.004420583553
              std dev =       0.536363522532
             le_variance =       0.287685828303


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721470795275e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909083530719       residual = 8.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909085601466       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909085957371       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909086117062       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909086144861       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909086147048       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909086149894       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909086149567       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909086149338       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909086149498       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 9.014970e-06

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909083530719       residual = 8.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909084050303       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909084139498       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909084179505       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909084186459       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909084187003       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909084187715       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909084187633       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909084187575       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909084187616       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 2.259931e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909083530719       residual = 8.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909083660734       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909083683047       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909083693054       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909083694793       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909083694928       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909083695106       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909083695086       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909083695072       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909083695081       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 5.653710e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171791 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6283e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -3.750464e-02 3 1  ON 0
ci_002                -2.875334e-02 3 1  ON 1
ci_003                -2.362025e-02 3 1  ON 2
ci_004                 2.083272e-02 3 1  ON 3
ci_005                 2.129016e-02 3 1  ON 4
ci_006                -1.839071e-02 3 1  ON 5
ci_007                -1.849238e-02 3 1  ON 6
ci_008                -7.774675e-03 3 1  ON 7
ci_009                -1.389181e-02 3 1  ON 8
ci_010                -8.851278e-03 3 1  ON 9
ci_011                -8.953760e-03 3 1  ON 10
ci_012                -9.110048e-03 3 1  ON 11
ci_013                -1.909012e-02 3 1  ON 12
ci_014                 1.111223e-02 3 1  ON 13
ci_015                 1.092843e-02 3 1  ON 14
ci_016                 1.591106e-02 3 1  ON 15
ci_017                 1.563649e-02 3 1  ON 16
ci_018                 9.113205e-03 3 1  ON 17
ci_019                 8.996687e-03 3 1  ON 18
ci_020                 1.504365e-02 3 1  ON 19
ci_021                 1.521743e-02 3 1  ON 20
ci_022                 8.272543e-03 3 1  ON 21
ci_023                 8.254617e-03 3 1  ON 22
ci_024                 8.335924e-03 3 1  ON 23
ci_025                 8.424983e-03 3 1  ON 24
ci_026                 9.916829e-03 3 1  ON 25
ci_027                 9.699974e-03 3 1  ON 26
ci_028                -1.453191e-02 3 1  ON 27
ci_029                -1.479699e-02 3 1  ON 28
ci_030                -8.760700e-03 3 1  ON 29
ci_031                -8.611711e-03 3 1  ON 30
ci_032                -1.432910e-02 3 1  ON 31
ci_033                 4.549153e-03 3 1  ON 32
ci_034                 4.854873e-03 3 1  ON 33
ci_035                -3.334046e-03 3 1  ON 34
ci_036                -1.121838e-02 3 1  ON 35
ci_037                -1.147563e-02 3 1  ON 36
ci_038                 8.708341e-04 3 1  ON 37
ci_039                 1.138857e-03 3 1  ON 38
ci_040                -1.558184e-03 3 1  ON 39
ci_041                 8.166821e-03 3 1  ON 40
ci_042                 8.166901e-03 3 1  ON 41
ci_043                -2.344450e-03 3 1  ON 42
ci_044                -3.914643e-03 3 1  ON 43
ci_045                -1.992516e-03 3 1  ON 44
ci_046                 4.783073e-03 3 1  ON 45
ci_047                 4.612429e-03 3 1  ON 46
ci_048                -1.238349e-02 3 1  ON 47
ci_049                -1.295824e-02 3 1  ON 48
ci_050                 2.843952e-03 3 1  ON 49
ci_051                 2.990860e-03 3 1  ON 50
ci_052                -2.171106e-03 3 1  ON 51
ci_053                -2.204040e-03 3 1  ON 52
ci_054                -2.210199e-03 3 1  ON 53
ci_055                -2.427050e-03 3 1  ON 54
ci_056                 4.622676e-03 3 1  ON 55
ci_057                 4.638771e-03 3 1  ON 56
ci_058                -2.069963e-03 3 1  ON 57
ci_059                -2.055655e-03 3 1  ON 58
ci_060                 4.760279e-03 3 1  ON 59
ci_061                 5.214528e-03 3 1  ON 60
ci_062                -2.957991e-03 3 1  ON 61
ci_063                -2.810211e-03 3 1  ON 62
ci_064                -2.260425e-03 3 1  ON 63
ci_065                -3.387032e-03 3 1  ON 64
ci_066                 4.062463e-03 3 1  ON 65
ci_067                 4.231489e-03 3 1  ON 66
ci_068                -4.278971e-03 3 1  ON 67
ci_069                -4.111775e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2205
    reference variance = 0.182625
====================================================
  Execution time = 1.3484e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9892e-01
  Total weights = 1.9578e+06
  Execution time = 1.8135e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285916045094
                                         uncertainty =       0.001607336894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285916045094
                                         uncertainty =       0.001607336894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378088994
  error estimate for blocks of size 2^( 2) =       0.000389683809
  error estimate for blocks of size 2^( 3) =       0.000399910435
  error estimate for blocks of size 2^( 4) =       0.000407323664
  error estimate for blocks of size 2^( 5) =       0.000411402083
  error estimate for blocks of size 2^( 6) =       0.000414362477
  error estimate for blocks of size 2^( 7) =       0.000415888493

      target function =      -0.914369411882
              le_mean =     -17.213961205317
             les_mean =     296.619379963148
             stat err =       0.000412244179
             autocorr =       1.188833386171
   target nu stat err =       0.000412244179
   target dn stat err =       0.002204791334
      target stat err =       0.003501516892
              std dev =       0.534698583655
             le_variance =       0.285902575362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285914260529
                                         uncertainty =       0.001606938332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285914260529
                                         uncertainty =       0.001606938332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378087814
  error estimate for blocks of size 2^( 2) =       0.000389683085
  error estimate for blocks of size 2^( 3) =       0.000399910188
  error estimate for blocks of size 2^( 4) =       0.000407323631
  error estimate for blocks of size 2^( 5) =       0.000411402153
  error estimate for blocks of size 2^( 6) =       0.000414362783
  error estimate for blocks of size 2^( 7) =       0.000415888896

      target function =      -0.914392591458
              le_mean =     -17.213961213653
             les_mean =     296.619365360900
             stat err =       0.000412244366
             autocorr =       1.188841882488
   target nu stat err =       0.000412244366
   target dn stat err =       0.002203684078
      target stat err =       0.003500002962
              std dev =       0.534696914876
             le_variance =       0.285900790777

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285915146792
                                         uncertainty =       0.001607136823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285915146792
                                         uncertainty =       0.001607136823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378088400
  error estimate for blocks of size 2^( 2) =       0.000389683444
  error estimate for blocks of size 2^( 3) =       0.000399910309
  error estimate for blocks of size 2^( 4) =       0.000407323646
  error estimate for blocks of size 2^( 5) =       0.000411402116
  error estimate for blocks of size 2^( 6) =       0.000414362628
  error estimate for blocks of size 2^( 7) =       0.000415888693

      target function =      -0.914381244668
              le_mean =     -17.213961209132
             les_mean =     296.619372493681
             stat err =       0.000412244271
             autocorr =       1.188837649286
   target nu stat err =       0.000412244271
   target dn stat err =       0.002204229657
      target stat err =       0.003500749495
              std dev =       0.534697743638
             le_variance =       0.285901677052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285915932384
                                         uncertainty =       0.001607311851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285915932384
                                         uncertainty =       0.001607311851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378088920
  error estimate for blocks of size 2^( 2) =       0.000389683763
  error estimate for blocks of size 2^( 3) =       0.000399910419
  error estimate for blocks of size 2^( 4) =       0.000407323662
  error estimate for blocks of size 2^( 5) =       0.000411402087
  error estimate for blocks of size 2^( 6) =       0.000414362496
  error estimate for blocks of size 2^( 7) =       0.000415888518

      target function =      -0.914370916152
              le_mean =     -17.213961205756
             les_mean =     296.619379011971
             stat err =       0.000412244191
             autocorr =       1.188833919587
   target nu stat err =       0.000412244191
   target dn stat err =       0.002204720378
      target stat err =       0.003501420020
              std dev =       0.534698478258
             le_variance =       0.285902462652


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914369411882        initial
     1.5625e+01     1.5625e+02             9.0150e-06        -0.914392591458  <--
     6.2500e+01     6.2500e+02             2.2599e-06        -0.914381244668
     2.5000e+02     2.5000e+03             5.6537e-07        -0.914370916152

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 2.2646e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -3.750050e-02 3 1  ON 0
ci_002                -2.875178e-02 3 1  ON 1
ci_003                -2.362170e-02 3 1  ON 2
ci_004                 2.083947e-02 3 1  ON 3
ci_005                 2.128944e-02 3 1  ON 4
ci_006                -1.839153e-02 3 1  ON 5
ci_007                -1.848803e-02 3 1  ON 6
ci_008                -7.773235e-03 3 1  ON 7
ci_009                -1.388682e-02 3 1  ON 8
ci_010                -8.850405e-03 3 1  ON 9
ci_011                -8.956174e-03 3 1  ON 10
ci_012                -9.107758e-03 3 1  ON 11
ci_013                -1.909045e-02 3 1  ON 12
ci_014                 1.111062e-02 3 1  ON 13
ci_015                 1.092560e-02 3 1  ON 14
ci_016                 1.590949e-02 3 1  ON 15
ci_017                 1.563800e-02 3 1  ON 16
ci_018                 9.110302e-03 3 1  ON 17
ci_019                 8.999917e-03 3 1  ON 18
ci_020                 1.504134e-02 3 1  ON 19
ci_021                 1.521216e-02 3 1  ON 20
ci_022                 8.273455e-03 3 1  ON 21
ci_023                 8.252960e-03 3 1  ON 22
ci_024                 8.339305e-03 3 1  ON 23
ci_025                 8.425158e-03 3 1  ON 24
ci_026                 9.916744e-03 3 1  ON 25
ci_027                 9.700971e-03 3 1  ON 26
ci_028                -1.453311e-02 3 1  ON 27
ci_029                -1.479454e-02 3 1  ON 28
ci_030                -8.758461e-03 3 1  ON 29
ci_031                -8.611656e-03 3 1  ON 30
ci_032                -1.433061e-02 3 1  ON 31
ci_033                 4.552658e-03 3 1  ON 32
ci_034                 4.850793e-03 3 1  ON 33
ci_035                -3.333795e-03 3 1  ON 34
ci_036                -1.121690e-02 3 1  ON 35
ci_037                -1.147412e-02 3 1  ON 36
ci_038                 8.700993e-04 3 1  ON 37
ci_039                 1.139511e-03 3 1  ON 38
ci_040                -1.560863e-03 3 1  ON 39
ci_041                 8.166344e-03 3 1  ON 40
ci_042                 8.164212e-03 3 1  ON 41
ci_043                -2.343626e-03 3 1  ON 42
ci_044                -3.917360e-03 3 1  ON 43
ci_045                -1.990712e-03 3 1  ON 44
ci_046                 4.783348e-03 3 1  ON 45
ci_047                 4.612785e-03 3 1  ON 46
ci_048                -1.238321e-02 3 1  ON 47
ci_049                -1.295599e-02 3 1  ON 48
ci_050                 2.844353e-03 3 1  ON 49
ci_051                 2.989834e-03 3 1  ON 50
ci_052                -2.171647e-03 3 1  ON 51
ci_053                -2.203096e-03 3 1  ON 52
ci_054                -2.209910e-03 3 1  ON 53
ci_055                -2.427871e-03 3 1  ON 54
ci_056                 4.624331e-03 3 1  ON 55
ci_057                 4.638005e-03 3 1  ON 56
ci_058                -2.065243e-03 3 1  ON 57
ci_059                -2.054302e-03 3 1  ON 58
ci_060                 4.762718e-03 3 1  ON 59
ci_061                 5.210305e-03 3 1  ON 60
ci_062                -2.956029e-03 3 1  ON 61
ci_063                -2.808275e-03 3 1  ON 62
ci_064                -2.260174e-03 3 1  ON 63
ci_065                -3.385742e-03 3 1  ON 64
ci_066                 4.061879e-03 3 1  ON 65
ci_067                 4.231622e-03 3 1  ON 66
ci_068                -4.278761e-03 3 1  ON 67
ci_069                -4.111786e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8936e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2266
    reference variance = 0.286928
====================================================
  Execution time = 1.3948e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0294e-01
  Total weights = 1.957629370e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5014e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289309886667
                                         uncertainty =       0.001966505986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289309886667
                                         uncertainty =       0.001966505986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380350133
  error estimate for blocks of size 2^( 2) =       0.000391804130
  error estimate for blocks of size 2^( 3) =       0.000402567805
  error estimate for blocks of size 2^( 4) =       0.000409408701
  error estimate for blocks of size 2^( 5) =       0.000414068166
  error estimate for blocks of size 2^( 6) =       0.000416200829
  error estimate for blocks of size 2^( 7) =       0.000417515491

      target function =      -0.908123876915
              le_mean =     -17.214379495467
             les_mean =     296.637800850330
             stat err =       0.000414298297
             autocorr =       1.186476526520
   target nu stat err =       0.000414298297
   target dn stat err =       0.003345582971
      target stat err =       0.005186312874
              std dev =       0.537896316690
             le_variance =       0.289332447509


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721437949547e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908152536839       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908167349340       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908169076949       residual = 5.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908169929190       residual = 8.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908170064639       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908170106117       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908170114799       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908170112978       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908170112611       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908170111619       residual = 9.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 5.625412e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908152536839       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908156295164       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908156731749       residual = 5.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908156946029       residual = 8.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908156979895       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908156990252       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908156992399       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908156991941       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908156991848       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908156991600       residual = 9.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 1.422298e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908152536839       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908153479935       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908153589377       residual = 5.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908153643023       residual = 8.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908153651490       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908153654078       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908153654613       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908153654498       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908153654475       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908153654413       residual = 9.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 3.565854e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175307 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6459e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -3.750168e-02 3 1  ON 0
ci_002                -2.875191e-02 3 1  ON 1
ci_003                -2.361768e-02 3 1  ON 2
ci_004                 2.082525e-02 3 1  ON 3
ci_005                 2.128394e-02 3 1  ON 4
ci_006                -1.839055e-02 3 1  ON 5
ci_007                -1.848636e-02 3 1  ON 6
ci_008                -7.773142e-03 3 1  ON 7
ci_009                -1.388764e-02 3 1  ON 8
ci_010                -8.847753e-03 3 1  ON 9
ci_011                -8.954237e-03 3 1  ON 10
ci_012                -9.099934e-03 3 1  ON 11
ci_013                -1.908349e-02 3 1  ON 12
ci_014                 1.111626e-02 3 1  ON 13
ci_015                 1.092780e-02 3 1  ON 14
ci_016                 1.590924e-02 3 1  ON 15
ci_017                 1.564439e-02 3 1  ON 16
ci_018                 9.107326e-03 3 1  ON 17
ci_019                 9.000783e-03 3 1  ON 18
ci_020                 1.504131e-02 3 1  ON 19
ci_021                 1.520734e-02 3 1  ON 20
ci_022                 8.274352e-03 3 1  ON 21
ci_023                 8.254521e-03 3 1  ON 22
ci_024                 8.343548e-03 3 1  ON 23
ci_025                 8.420734e-03 3 1  ON 24
ci_026                 9.912641e-03 3 1  ON 25
ci_027                 9.695693e-03 3 1  ON 26
ci_028                -1.453380e-02 3 1  ON 27
ci_029                -1.480128e-02 3 1  ON 28
ci_030                -8.751253e-03 3 1  ON 29
ci_031                -8.612233e-03 3 1  ON 30
ci_032                -1.433250e-02 3 1  ON 31
ci_033                 4.549554e-03 3 1  ON 32
ci_034                 4.856312e-03 3 1  ON 33
ci_035                -3.334131e-03 3 1  ON 34
ci_036                -1.122945e-02 3 1  ON 35
ci_037                -1.147251e-02 3 1  ON 36
ci_038                 8.676410e-04 3 1  ON 37
ci_039                 1.138592e-03 3 1  ON 38
ci_040                -1.560976e-03 3 1  ON 39
ci_041                 8.161327e-03 3 1  ON 40
ci_042                 8.163422e-03 3 1  ON 41
ci_043                -2.341490e-03 3 1  ON 42
ci_044                -3.920400e-03 3 1  ON 43
ci_045                -1.992116e-03 3 1  ON 44
ci_046                 4.783534e-03 3 1  ON 45
ci_047                 4.612077e-03 3 1  ON 46
ci_048                -1.238561e-02 3 1  ON 47
ci_049                -1.295727e-02 3 1  ON 48
ci_050                 2.846084e-03 3 1  ON 49
ci_051                 2.986960e-03 3 1  ON 50
ci_052                -2.171955e-03 3 1  ON 51
ci_053                -2.207354e-03 3 1  ON 52
ci_054                -2.209450e-03 3 1  ON 53
ci_055                -2.428387e-03 3 1  ON 54
ci_056                 4.626582e-03 3 1  ON 55
ci_057                 4.635550e-03 3 1  ON 56
ci_058                -2.069654e-03 3 1  ON 57
ci_059                -2.055070e-03 3 1  ON 58
ci_060                 4.764704e-03 3 1  ON 59
ci_061                 5.212000e-03 3 1  ON 60
ci_062                -2.959029e-03 3 1  ON 61
ci_063                -2.812133e-03 3 1  ON 62
ci_064                -2.259955e-03 3 1  ON 63
ci_065                -3.385988e-03 3 1  ON 64
ci_066                 4.068665e-03 3 1  ON 65
ci_067                 4.233355e-03 3 1  ON 66
ci_068                -4.281656e-03 3 1  ON 67
ci_069                -4.111676e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.244
    reference variance = 0.246156
====================================================
  Execution time = 1.4386e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0138e-01
  Total weights = 1.9579e+06
  Execution time = 1.8206e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286838869625
                                         uncertainty =       0.002079258898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286838869625
                                         uncertainty =       0.002079258898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378674090
  error estimate for blocks of size 2^( 2) =       0.000390148738
  error estimate for blocks of size 2^( 3) =       0.000400511103
  error estimate for blocks of size 2^( 4) =       0.000408279126
  error estimate for blocks of size 2^( 5) =       0.000413172278
  error estimate for blocks of size 2^( 6) =       0.000415800374
  error estimate for blocks of size 2^( 7) =       0.000417355797

      target function =      -0.910500992900
              le_mean =     -17.215273877152
             les_mean =     296.667035219995
             stat err =       0.000413651894
             autocorr =       1.193270359171
   target nu stat err =       0.000413651894
   target dn stat err =       0.002590622674
      target stat err =       0.004067776835
              std dev =       0.535526033917
             le_variance =       0.286788133003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286838652402
                                         uncertainty =       0.002079908785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286838652402
                                         uncertainty =       0.002079908785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378673956
  error estimate for blocks of size 2^( 2) =       0.000390149165
  error estimate for blocks of size 2^( 3) =       0.000400511570
  error estimate for blocks of size 2^( 4) =       0.000408280108
  error estimate for blocks of size 2^( 5) =       0.000413173475
  error estimate for blocks of size 2^( 6) =       0.000415800296
  error estimate for blocks of size 2^( 7) =       0.000417359234

      target function =      -0.910482037992
              le_mean =     -17.215274270247
             les_mean =     296.667061010085
             stat err =       0.000413653278
             autocorr =       1.193279192448
   target nu stat err =       0.000413653278
   target dn stat err =       0.002589604536
      target stat err =       0.004066062419
              std dev =       0.535525844235
             le_variance =       0.286787929844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286838677068
                                         uncertainty =       0.002079587614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286838677068
                                         uncertainty =       0.002079587614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378673968
  error estimate for blocks of size 2^( 2) =       0.000390148901
  error estimate for blocks of size 2^( 3) =       0.000400511286
  error estimate for blocks of size 2^( 4) =       0.000408279570
  error estimate for blocks of size 2^( 5) =       0.000413172833
  error estimate for blocks of size 2^( 6) =       0.000415800284
  error estimate for blocks of size 2^( 7) =       0.000417357492

      target function =      -0.910493250558
              le_mean =     -17.215274065203
             les_mean =     296.667046702915
             stat err =       0.000413652545
             autocorr =       1.193274887421
   target nu stat err =       0.000413652545
   target dn stat err =       0.002589867328
      target stat err =       0.004066559630
              std dev =       0.535525860788
             le_variance =       0.286787947573

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286838836035
                                         uncertainty =       0.002079299997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286838836035
                                         uncertainty =       0.002079299997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378674069
  error estimate for blocks of size 2^( 2) =       0.000390148752
  error estimate for blocks of size 2^( 3) =       0.000400511120
  error estimate for blocks of size 2^( 4) =       0.000408279175
  error estimate for blocks of size 2^( 5) =       0.000413172342
  error estimate for blocks of size 2^( 6) =       0.000415800357
  error estimate for blocks of size 2^( 7) =       0.000417356004

      target function =      -0.910501046533
              le_mean =     -17.215273899465
             les_mean =     296.667035954066
             stat err =       0.000413651970
             autocorr =       1.193270933235
   target nu stat err =       0.000413651970
   target dn stat err =       0.002590502434
      target stat err =       0.004067594324
              std dev =       0.535526003396
             le_variance =       0.286788100313


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910500992900        initial
     3.9062e+00     3.9062e+01             5.6254e-05        -0.910482037992
     1.5625e+01     1.5625e+02             1.4223e-05        -0.910493250558
     6.2500e+01     6.2500e+02             3.5659e-06        -0.910501046533  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 2.3597e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -3.750080e-02 3 1  ON 0
ci_002                -2.875181e-02 3 1  ON 1
ci_003                -2.362069e-02 3 1  ON 2
ci_004                 2.083591e-02 3 1  ON 3
ci_005                 2.128806e-02 3 1  ON 4
ci_006                -1.839129e-02 3 1  ON 5
ci_007                -1.848761e-02 3 1  ON 6
ci_008                -7.773211e-03 3 1  ON 7
ci_009                -1.388702e-02 3 1  ON 8
ci_010                -8.849739e-03 3 1  ON 9
ci_011                -8.955688e-03 3 1  ON 10
ci_012                -9.105796e-03 3 1  ON 11
ci_013                -1.908871e-02 3 1  ON 12
ci_014                 1.111204e-02 3 1  ON 13
ci_015                 1.092616e-02 3 1  ON 14
ci_016                 1.590943e-02 3 1  ON 15
ci_017                 1.563960e-02 3 1  ON 16
ci_018                 9.109556e-03 3 1  ON 17
ci_019                 9.000134e-03 3 1  ON 18
ci_020                 1.504133e-02 3 1  ON 19
ci_021                 1.521095e-02 3 1  ON 20
ci_022                 8.273681e-03 3 1  ON 21
ci_023                 8.253352e-03 3 1  ON 22
ci_024                 8.340368e-03 3 1  ON 23
ci_025                 8.424048e-03 3 1  ON 24
ci_026                 9.915716e-03 3 1  ON 25
ci_027                 9.699647e-03 3 1  ON 26
ci_028                -1.453328e-02 3 1  ON 27
ci_029                -1.479623e-02 3 1  ON 28
ci_030                -8.756652e-03 3 1  ON 29
ci_031                -8.611801e-03 3 1  ON 30
ci_032                -1.433108e-02 3 1  ON 31
ci_033                 4.551880e-03 3 1  ON 32
ci_034                 4.852177e-03 3 1  ON 33
ci_035                -3.333879e-03 3 1  ON 34
ci_036                -1.122005e-02 3 1  ON 35
ci_037                -1.147371e-02 3 1  ON 36
ci_038                 8.694825e-04 3 1  ON 37
ci_039                 1.139280e-03 3 1  ON 38
ci_040                -1.560891e-03 3 1  ON 39
ci_041                 8.165085e-03 3 1  ON 40
ci_042                 8.164013e-03 3 1  ON 41
ci_043                -2.343090e-03 3 1  ON 42
ci_044                -3.918123e-03 3 1  ON 43
ci_045                -1.991064e-03 3 1  ON 44
ci_046                 4.783395e-03 3 1  ON 45
ci_047                 4.612607e-03 3 1  ON 46
ci_048                -1.238381e-02 3 1  ON 47
ci_049                -1.295631e-02 3 1  ON 48
ci_050                 2.844787e-03 3 1  ON 49
ci_051                 2.989113e-03 3 1  ON 50
ci_052                -2.171724e-03 3 1  ON 51
ci_053                -2.204165e-03 3 1  ON 52
ci_054                -2.209794e-03 3 1  ON 53
ci_055                -2.428001e-03 3 1  ON 54
ci_056                 4.624895e-03 3 1  ON 55
ci_057                 4.637389e-03 3 1  ON 56
ci_058                -2.066350e-03 3 1  ON 57
ci_059                -2.054495e-03 3 1  ON 58
ci_060                 4.763216e-03 3 1  ON 59
ci_061                 5.210730e-03 3 1  ON 60
ci_062                -2.956781e-03 3 1  ON 61
ci_063                -2.809243e-03 3 1  ON 62
ci_064                -2.260119e-03 3 1  ON 63
ci_065                -3.385804e-03 3 1  ON 64
ci_066                 4.063581e-03 3 1  ON 65
ci_067                 4.232057e-03 3 1  ON 66
ci_068                -4.279487e-03 3 1  ON 67
ci_069                -4.111759e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0063e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1283
    reference variance = 0.163153
====================================================
  Execution time = 1.3978e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9726e-01
  Total weights = 1.957747806e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4888e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285247648149
                                         uncertainty =       0.001799735264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285247648149
                                         uncertainty =       0.001799735264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377614078
  error estimate for blocks of size 2^( 2) =       0.000388612096
  error estimate for blocks of size 2^( 3) =       0.000398984863
  error estimate for blocks of size 2^( 4) =       0.000405841479
  error estimate for blocks of size 2^( 5) =       0.000410912455
  error estimate for blocks of size 2^( 6) =       0.000413393834
  error estimate for blocks of size 2^( 7) =       0.000417187266

      target function =      -0.916947189179
              le_mean =     -17.214339308008
             les_mean =     296.630738798878
             stat err =       0.000411833758
             autocorr =       1.189453677900
   target nu stat err =       0.000411833758
   target dn stat err =       0.002262020357
      target stat err =       0.003611084229
              std dev =       0.534026949803
             le_variance =       0.285184783116


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721433930801e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916960447402       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916963176103       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916963703325       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916963872853       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916963887259       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916963888401       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916963888820       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916963888154       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916963887493       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916963887406       residual = 5.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 1.003834e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916960447402       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916961132147       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916961264327       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916961306781       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916961310380       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916961310661       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916961310766       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916961310599       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916961310434       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916961310412       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 2.517408e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916960447402       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916960618750       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916960651818       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916960662436       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916960663336       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916960663406       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916960663431       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916960663390       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916960663349       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916960663343       residual = 5.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 6.298430e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178830 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6476e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -3.750062e-02 3 1  ON 0
ci_002                -2.875243e-02 3 1  ON 1
ci_003                -2.362099e-02 3 1  ON 2
ci_004                 2.083556e-02 3 1  ON 3
ci_005                 2.128575e-02 3 1  ON 4
ci_006                -1.839173e-02 3 1  ON 5
ci_007                -1.848777e-02 3 1  ON 6
ci_008                -7.772625e-03 3 1  ON 7
ci_009                -1.388660e-02 3 1  ON 8
ci_010                -8.847635e-03 3 1  ON 9
ci_011                -8.955969e-03 3 1  ON 10
ci_012                -9.105394e-03 3 1  ON 11
ci_013                -1.908799e-02 3 1  ON 12
ci_014                 1.111265e-02 3 1  ON 13
ci_015                 1.092645e-02 3 1  ON 14
ci_016                 1.590898e-02 3 1  ON 15
ci_017                 1.563984e-02 3 1  ON 16
ci_018                 9.109922e-03 3 1  ON 17
ci_019                 9.001306e-03 3 1  ON 18
ci_020                 1.504053e-02 3 1  ON 19
ci_021                 1.520844e-02 3 1  ON 20
ci_022                 8.272574e-03 3 1  ON 21
ci_023                 8.253742e-03 3 1  ON 22
ci_024                 8.341216e-03 3 1  ON 23
ci_025                 8.423545e-03 3 1  ON 24
ci_026                 9.914299e-03 3 1  ON 25
ci_027                 9.699444e-03 3 1  ON 26
ci_028                -1.453233e-02 3 1  ON 27
ci_029                -1.479631e-02 3 1  ON 28
ci_030                -8.757076e-03 3 1  ON 29
ci_031                -8.612914e-03 3 1  ON 30
ci_032                -1.433032e-02 3 1  ON 31
ci_033                 4.551423e-03 3 1  ON 32
ci_034                 4.850048e-03 3 1  ON 33
ci_035                -3.333735e-03 3 1  ON 34
ci_036                -1.121984e-02 3 1  ON 35
ci_037                -1.147491e-02 3 1  ON 36
ci_038                 8.695763e-04 3 1  ON 37
ci_039                 1.139927e-03 3 1  ON 38
ci_040                -1.559811e-03 3 1  ON 39
ci_041                 8.164411e-03 3 1  ON 40
ci_042                 8.163324e-03 3 1  ON 41
ci_043                -2.343125e-03 3 1  ON 42
ci_044                -3.916001e-03 3 1  ON 43
ci_045                -1.990781e-03 3 1  ON 44
ci_046                 4.784373e-03 3 1  ON 45
ci_047                 4.612198e-03 3 1  ON 46
ci_048                -1.238381e-02 3 1  ON 47
ci_049                -1.295572e-02 3 1  ON 48
ci_050                 2.844830e-03 3 1  ON 49
ci_051                 2.988765e-03 3 1  ON 50
ci_052                -2.171237e-03 3 1  ON 51
ci_053                -2.204148e-03 3 1  ON 52
ci_054                -2.209022e-03 3 1  ON 53
ci_055                -2.427243e-03 3 1  ON 54
ci_056                 4.624515e-03 3 1  ON 55
ci_057                 4.637383e-03 3 1  ON 56
ci_058                -2.066880e-03 3 1  ON 57
ci_059                -2.053781e-03 3 1  ON 58
ci_060                 4.762836e-03 3 1  ON 59
ci_061                 5.210102e-03 3 1  ON 60
ci_062                -2.956749e-03 3 1  ON 61
ci_063                -2.808677e-03 3 1  ON 62
ci_064                -2.259885e-03 3 1  ON 63
ci_065                -3.385353e-03 3 1  ON 64
ci_066                 4.063002e-03 3 1  ON 65
ci_067                 4.231476e-03 3 1  ON 66
ci_068                -4.278735e-03 3 1  ON 67
ci_069                -4.112860e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1449
    reference variance = 0.252372
====================================================
  Execution time = 1.3374e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9890e-01
  Total weights = 1.9573e+06
  Execution time = 1.8245e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285882418693
                                         uncertainty =       0.001817555914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285882418693
                                         uncertainty =       0.001817555914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378048601
  error estimate for blocks of size 2^( 2) =       0.000389447115
  error estimate for blocks of size 2^( 3) =       0.000399866425
  error estimate for blocks of size 2^( 4) =       0.000408410566
  error estimate for blocks of size 2^( 5) =       0.000412838517
  error estimate for blocks of size 2^( 6) =       0.000415067559
  error estimate for blocks of size 2^( 7) =       0.000417421588

      target function =      -0.914384659822
              le_mean =     -17.214176996371
             les_mean =     296.626792218398
             stat err =       0.000413434558
             autocorr =       1.195964474594
   target nu stat err =       0.000413434558
   target dn stat err =       0.002595258196
      target stat err =       0.004100701515
              std dev =       0.534641458824
             le_variance =       0.285841489493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285881434517
                                         uncertainty =       0.001817476859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285881434517
                                         uncertainty =       0.001817476859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378047963
  error estimate for blocks of size 2^( 2) =       0.000389446997
  error estimate for blocks of size 2^( 3) =       0.000399866784
  error estimate for blocks of size 2^( 4) =       0.000408411393
  error estimate for blocks of size 2^( 5) =       0.000412839642
  error estimate for blocks of size 2^( 6) =       0.000415068942
  error estimate for blocks of size 2^( 7) =       0.000417423132

      target function =      -0.914415134552
              le_mean =     -17.214177049709
             les_mean =     296.626774484908
             stat err =       0.000413435777
             autocorr =       1.195975564714
   target nu stat err =       0.000413435777
   target dn stat err =       0.002594284441
      target stat err =       0.004099478166
              std dev =       0.534640557034
             le_variance =       0.285840525226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285881921471
                                         uncertainty =       0.001817516171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285881921471
                                         uncertainty =       0.001817516171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378048279
  error estimate for blocks of size 2^( 2) =       0.000389447054
  error estimate for blocks of size 2^( 3) =       0.000399866603
  error estimate for blocks of size 2^( 4) =       0.000408410979
  error estimate for blocks of size 2^( 5) =       0.000412839079
  error estimate for blocks of size 2^( 6) =       0.000415068251
  error estimate for blocks of size 2^( 7) =       0.000417422360

      target function =      -0.914401979783
              le_mean =     -17.214177022629
             les_mean =     296.626781999770
             stat err =       0.000413435167
             autocorr =       1.195970039053
   target nu stat err =       0.000413435167
   target dn stat err =       0.002594736042
      target stat err =       0.004100054160
              std dev =       0.534641003159
             le_variance =       0.285841002259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285882356116
                                         uncertainty =       0.001817550938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285882356116
                                         uncertainty =       0.001817550938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378048560
  error estimate for blocks of size 2^( 2) =       0.000389447107
  error estimate for blocks of size 2^( 3) =       0.000399866447
  error estimate for blocks of size 2^( 4) =       0.000408410617
  error estimate for blocks of size 2^( 5) =       0.000412838587
  error estimate for blocks of size 2^( 6) =       0.000415067646
  error estimate for blocks of size 2^( 7) =       0.000417421684

      target function =      -0.914387059377
              le_mean =     -17.214176999602
             les_mean =     296.626790788627
             stat err =       0.000413434634
             autocorr =       1.195965170836
   target nu stat err =       0.000413434634
   target dn stat err =       0.002595188599
      target stat err =       0.004100616034
              std dev =       0.534641401470
             le_variance =       0.285841428166


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914384659822        initial
     1.5625e+01     1.5625e+02             1.0038e-05        -0.914415134552  <--
     6.2500e+01     6.2500e+02             2.5174e-06        -0.914401979783
     2.5000e+02     2.5000e+03             6.2984e-07        -0.914387059377

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 2.2580e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -3.750008e-02 3 1  ON 0
ci_002                -2.875429e-02 3 1  ON 1
ci_003                -2.362190e-02 3 1  ON 2
ci_004                 2.083454e-02 3 1  ON 3
ci_005                 2.127883e-02 3 1  ON 4
ci_006                -1.839308e-02 3 1  ON 5
ci_007                -1.848825e-02 3 1  ON 6
ci_008                -7.770876e-03 3 1  ON 7
ci_009                -1.388532e-02 3 1  ON 8
ci_010                -8.841349e-03 3 1  ON 9
ci_011                -8.956806e-03 3 1  ON 10
ci_012                -9.104193e-03 3 1  ON 11
ci_013                -1.908584e-02 3 1  ON 12
ci_014                 1.111449e-02 3 1  ON 13
ci_015                 1.092734e-02 3 1  ON 14
ci_016                 1.590763e-02 3 1  ON 15
ci_017                 1.564055e-02 3 1  ON 16
ci_018                 9.111011e-03 3 1  ON 17
ci_019                 9.004804e-03 3 1  ON 18
ci_020                 1.503816e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269268e-03 3 1  ON 21
ci_023                 8.254906e-03 3 1  ON 22
ci_024                 8.343750e-03 3 1  ON 23
ci_025                 8.422039e-03 3 1  ON 24
ci_026                 9.910068e-03 3 1  ON 25
ci_027                 9.698834e-03 3 1  ON 26
ci_028                -1.452950e-02 3 1  ON 27
ci_029                -1.479656e-02 3 1  ON 28
ci_030                -8.758339e-03 3 1  ON 29
ci_031                -8.616239e-03 3 1  ON 30
ci_032                -1.432806e-02 3 1  ON 31
ci_033                 4.550060e-03 3 1  ON 32
ci_034                 4.843689e-03 3 1  ON 33
ci_035                -3.333304e-03 3 1  ON 34
ci_036                -1.121920e-02 3 1  ON 35
ci_037                -1.147850e-02 3 1  ON 36
ci_038                 8.698563e-04 3 1  ON 37
ci_039                 1.141858e-03 3 1  ON 38
ci_040                -1.556585e-03 3 1  ON 39
ci_041                 8.162398e-03 3 1  ON 40
ci_042                 8.161268e-03 3 1  ON 41
ci_043                -2.343231e-03 3 1  ON 42
ci_044                -3.909664e-03 3 1  ON 43
ci_045                -1.989934e-03 3 1  ON 44
ci_046                 4.787293e-03 3 1  ON 45
ci_047                 4.610974e-03 3 1  ON 46
ci_048                -1.238382e-02 3 1  ON 47
ci_049                -1.295395e-02 3 1  ON 48
ci_050                 2.844957e-03 3 1  ON 49
ci_051                 2.987726e-03 3 1  ON 50
ci_052                -2.169781e-03 3 1  ON 51
ci_053                -2.204101e-03 3 1  ON 52
ci_054                -2.206717e-03 3 1  ON 53
ci_055                -2.424979e-03 3 1  ON 54
ci_056                 4.623379e-03 3 1  ON 55
ci_057                 4.637364e-03 3 1  ON 56
ci_058                -2.068459e-03 3 1  ON 57
ci_059                -2.051651e-03 3 1  ON 58
ci_060                 4.761702e-03 3 1  ON 59
ci_061                 5.208227e-03 3 1  ON 60
ci_062                -2.956655e-03 3 1  ON 61
ci_063                -2.806988e-03 3 1  ON 62
ci_064                -2.259184e-03 3 1  ON 63
ci_065                -3.384007e-03 3 1  ON 64
ci_066                 4.061273e-03 3 1  ON 65
ci_067                 4.229741e-03 3 1  ON 66
ci_068                -4.276490e-03 3 1  ON 67
ci_069                -4.116149e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9064e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2373
    reference variance = 0.210085
====================================================
  Execution time = 1.3751e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9731e-01
  Total weights = 1.957816814e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4762e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285237674038
                                         uncertainty =       0.001516466474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285237674038
                                         uncertainty =       0.001516466474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377606067
  error estimate for blocks of size 2^( 2) =       0.000388793121
  error estimate for blocks of size 2^( 3) =       0.000399170265
  error estimate for blocks of size 2^( 4) =       0.000406506244
  error estimate for blocks of size 2^( 5) =       0.000411907296
  error estimate for blocks of size 2^( 6) =       0.000413957487
  error estimate for blocks of size 2^( 7) =       0.000414686609

      target function =      -0.916865514911
              le_mean =     -17.214655939781
             les_mean =     296.641687947363
             stat err =       0.000411764409
             autocorr =       1.189103573435
   target nu stat err =       0.000411764409
   target dn stat err =       0.002109694330
      target stat err =       0.003378826999
              std dev =       0.534015620913
             le_variance =       0.285172683379


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721465593978e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916877106678       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916887261960       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916888275552       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916888848044       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916888909475       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916888911374       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916888902829       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916888898290       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916888900218       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916888900515       residual = 2.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.820966e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916877106678       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916879684273       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916879940515       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916880084671       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916880100196       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916880100651       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916880098500       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916880097364       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916880097848       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916880097920       residual = 2.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 7.162776e-06

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916877106678       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916877753547       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916877817787       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916877853891       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916877857783       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916877857895       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916877857357       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916877857073       residual = 5.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916877857194       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916877857212       residual = 2.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 1.797726e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182342 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6237e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -3.749658e-02 3 1  ON 0
ci_002                -2.875516e-02 3 1  ON 1
ci_003                -2.362039e-02 3 1  ON 2
ci_004                 2.083441e-02 3 1  ON 3
ci_005                 2.127607e-02 3 1  ON 4
ci_006                -1.838943e-02 3 1  ON 5
ci_007                -1.848574e-02 3 1  ON 6
ci_008                -7.773242e-03 3 1  ON 7
ci_009                -1.388234e-02 3 1  ON 8
ci_010                -8.836030e-03 3 1  ON 9
ci_011                -8.953389e-03 3 1  ON 10
ci_012                -9.104333e-03 3 1  ON 11
ci_013                -1.908327e-02 3 1  ON 12
ci_014                 1.111666e-02 3 1  ON 13
ci_015                 1.092495e-02 3 1  ON 14
ci_016                 1.590892e-02 3 1  ON 15
ci_017                 1.564121e-02 3 1  ON 16
ci_018                 9.118174e-03 3 1  ON 17
ci_019                 9.003679e-03 3 1  ON 18
ci_020                 1.503862e-02 3 1  ON 19
ci_021                 1.519457e-02 3 1  ON 20
ci_022                 8.269246e-03 3 1  ON 21
ci_023                 8.256567e-03 3 1  ON 22
ci_024                 8.343858e-03 3 1  ON 23
ci_025                 8.418554e-03 3 1  ON 24
ci_026                 9.904351e-03 3 1  ON 25
ci_027                 9.700152e-03 3 1  ON 26
ci_028                -1.452700e-02 3 1  ON 27
ci_029                -1.479216e-02 3 1  ON 28
ci_030                -8.757947e-03 3 1  ON 29
ci_031                -8.619006e-03 3 1  ON 30
ci_032                -1.432934e-02 3 1  ON 31
ci_033                 4.555304e-03 3 1  ON 32
ci_034                 4.838447e-03 3 1  ON 33
ci_035                -3.333091e-03 3 1  ON 34
ci_036                -1.122126e-02 3 1  ON 35
ci_037                -1.147136e-02 3 1  ON 36
ci_038                 8.708866e-04 3 1  ON 37
ci_039                 1.139974e-03 3 1  ON 38
ci_040                -1.554143e-03 3 1  ON 39
ci_041                 8.158191e-03 3 1  ON 40
ci_042                 8.168114e-03 3 1  ON 41
ci_043                -2.343005e-03 3 1  ON 42
ci_044                -3.916215e-03 3 1  ON 43
ci_045                -1.988613e-03 3 1  ON 44
ci_046                 4.786914e-03 3 1  ON 45
ci_047                 4.613516e-03 3 1  ON 46
ci_048                -1.238426e-02 3 1  ON 47
ci_049                -1.295503e-02 3 1  ON 48
ci_050                 2.847997e-03 3 1  ON 49
ci_051                 2.991152e-03 3 1  ON 50
ci_052                -2.170255e-03 3 1  ON 51
ci_053                -2.206801e-03 3 1  ON 52
ci_054                -2.207284e-03 3 1  ON 53
ci_055                -2.423003e-03 3 1  ON 54
ci_056                 4.620967e-03 3 1  ON 55
ci_057                 4.636603e-03 3 1  ON 56
ci_058                -2.064741e-03 3 1  ON 57
ci_059                -2.051973e-03 3 1  ON 58
ci_060                 4.761065e-03 3 1  ON 59
ci_061                 5.209955e-03 3 1  ON 60
ci_062                -2.956652e-03 3 1  ON 61
ci_063                -2.805138e-03 3 1  ON 62
ci_064                -2.260279e-03 3 1  ON 63
ci_065                -3.383362e-03 3 1  ON 64
ci_066                 4.061228e-03 3 1  ON 65
ci_067                 4.230331e-03 3 1  ON 66
ci_068                -4.277468e-03 3 1  ON 67
ci_069                -4.113699e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2812
    reference variance = 0.205769
====================================================
  Execution time = 1.3706e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9922e-01
  Total weights = 1.9578e+06
  Execution time = 1.8193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284989257857
                                         uncertainty =       0.001574686775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284989257857
                                         uncertainty =       0.001574686775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377499736
  error estimate for blocks of size 2^( 2) =       0.000389202337
  error estimate for blocks of size 2^( 3) =       0.000399373062
  error estimate for blocks of size 2^( 4) =       0.000407073332
  error estimate for blocks of size 2^( 5) =       0.000412285544
  error estimate for blocks of size 2^( 6) =       0.000413084847
  error estimate for blocks of size 2^( 7) =       0.000416109115

      target function =      -0.913904157997
              le_mean =     -17.214298630596
             les_mean =     296.631287465190
             stat err =       0.000412138210
             autocorr =       1.191934677298
   target nu stat err =       0.000412138210
   target dn stat err =       0.002482302078
      target stat err =       0.003924021626
              std dev =       0.533865247007
             le_variance =       0.285012101962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284987679480
                                         uncertainty =       0.001575179477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284987679480
                                         uncertainty =       0.001575179477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377498703
  error estimate for blocks of size 2^( 2) =       0.000389201383
  error estimate for blocks of size 2^( 3) =       0.000399372459
  error estimate for blocks of size 2^( 4) =       0.000407072550
  error estimate for blocks of size 2^( 5) =       0.000412284870
  error estimate for blocks of size 2^( 6) =       0.000413083832
  error estimate for blocks of size 2^( 7) =       0.000416108026

      target function =      -0.913780662865
              le_mean =     -17.214298484716
             les_mean =     296.631361839307
             stat err =       0.000412137320
             autocorr =       1.191936054399
   target nu stat err =       0.000412137320
   target dn stat err =       0.002484812537
      target stat err =       0.003926817662
              std dev =       0.533863785565
             le_variance =       0.285010541538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284988405994
                                         uncertainty =       0.001574935219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284988405994
                                         uncertainty =       0.001574935219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377499178
  error estimate for blocks of size 2^( 2) =       0.000389201816
  error estimate for blocks of size 2^( 3) =       0.000399372725
  error estimate for blocks of size 2^( 4) =       0.000407072908
  error estimate for blocks of size 2^( 5) =       0.000412285172
  error estimate for blocks of size 2^( 6) =       0.000413084301
  error estimate for blocks of size 2^( 7) =       0.000416108530

      target function =      -0.913867061787
              le_mean =     -17.214298547707
             les_mean =     296.631308457838
             stat err =       0.000412137728
             autocorr =       1.191935414635
   target nu stat err =       0.000412137728
   target dn stat err =       0.002483270718
      target stat err =       0.003925189645
              std dev =       0.533864457724
             le_variance =       0.285011259221

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284989145253
                                         uncertainty =       0.001574717821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284989145253
                                         uncertainty =       0.001574717821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377499663
  error estimate for blocks of size 2^( 2) =       0.000389202268
  error estimate for blocks of size 2^( 3) =       0.000399373016
  error estimate for blocks of size 2^( 4) =       0.000407073275
  error estimate for blocks of size 2^( 5) =       0.000412285494
  error estimate for blocks of size 2^( 6) =       0.000413084775
  error estimate for blocks of size 2^( 7) =       0.000416109038

      target function =      -0.913900647935
              le_mean =     -17.214298619388
             les_mean =     296.631289335476
             stat err =       0.000412138146
             autocorr =       1.191934773051
   target nu stat err =       0.000412138146
   target dn stat err =       0.002482414265
      target stat err =       0.003924163546
              std dev =       0.533865142619
             le_variance =       0.285011990504


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913904157997        initial  <--
     3.9062e+00     3.9062e+01             2.8210e-05        -0.913780662865
     1.5625e+01     1.5625e+02             7.1628e-06        -0.913867061787
     6.2500e+01     6.2500e+02             1.7977e-06        -0.913900647935

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8998
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -3.750008e-02 3 1  ON 0
ci_002                -2.875429e-02 3 1  ON 1
ci_003                -2.362190e-02 3 1  ON 2
ci_004                 2.083454e-02 3 1  ON 3
ci_005                 2.127883e-02 3 1  ON 4
ci_006                -1.839308e-02 3 1  ON 5
ci_007                -1.848825e-02 3 1  ON 6
ci_008                -7.770876e-03 3 1  ON 7
ci_009                -1.388532e-02 3 1  ON 8
ci_010                -8.841349e-03 3 1  ON 9
ci_011                -8.956806e-03 3 1  ON 10
ci_012                -9.104193e-03 3 1  ON 11
ci_013                -1.908584e-02 3 1  ON 12
ci_014                 1.111449e-02 3 1  ON 13
ci_015                 1.092734e-02 3 1  ON 14
ci_016                 1.590763e-02 3 1  ON 15
ci_017                 1.564055e-02 3 1  ON 16
ci_018                 9.111011e-03 3 1  ON 17
ci_019                 9.004804e-03 3 1  ON 18
ci_020                 1.503816e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269268e-03 3 1  ON 21
ci_023                 8.254906e-03 3 1  ON 22
ci_024                 8.343750e-03 3 1  ON 23
ci_025                 8.422039e-03 3 1  ON 24
ci_026                 9.910068e-03 3 1  ON 25
ci_027                 9.698834e-03 3 1  ON 26
ci_028                -1.452950e-02 3 1  ON 27
ci_029                -1.479656e-02 3 1  ON 28
ci_030                -8.758339e-03 3 1  ON 29
ci_031                -8.616239e-03 3 1  ON 30
ci_032                -1.432806e-02 3 1  ON 31
ci_033                 4.550060e-03 3 1  ON 32
ci_034                 4.843689e-03 3 1  ON 33
ci_035                -3.333304e-03 3 1  ON 34
ci_036                -1.121920e-02 3 1  ON 35
ci_037                -1.147850e-02 3 1  ON 36
ci_038                 8.698563e-04 3 1  ON 37
ci_039                 1.141858e-03 3 1  ON 38
ci_040                -1.556585e-03 3 1  ON 39
ci_041                 8.162398e-03 3 1  ON 40
ci_042                 8.161268e-03 3 1  ON 41
ci_043                -2.343231e-03 3 1  ON 42
ci_044                -3.909664e-03 3 1  ON 43
ci_045                -1.989934e-03 3 1  ON 44
ci_046                 4.787293e-03 3 1  ON 45
ci_047                 4.610974e-03 3 1  ON 46
ci_048                -1.238382e-02 3 1  ON 47
ci_049                -1.295395e-02 3 1  ON 48
ci_050                 2.844957e-03 3 1  ON 49
ci_051                 2.987726e-03 3 1  ON 50
ci_052                -2.169781e-03 3 1  ON 51
ci_053                -2.204101e-03 3 1  ON 52
ci_054                -2.206717e-03 3 1  ON 53
ci_055                -2.424979e-03 3 1  ON 54
ci_056                 4.623379e-03 3 1  ON 55
ci_057                 4.637364e-03 3 1  ON 56
ci_058                -2.068459e-03 3 1  ON 57
ci_059                -2.051651e-03 3 1  ON 58
ci_060                 4.761702e-03 3 1  ON 59
ci_061                 5.208227e-03 3 1  ON 60
ci_062                -2.956655e-03 3 1  ON 61
ci_063                -2.806988e-03 3 1  ON 62
ci_064                -2.259184e-03 3 1  ON 63
ci_065                -3.384007e-03 3 1  ON 64
ci_066                 4.061273e-03 3 1  ON 65
ci_067                 4.229741e-03 3 1  ON 66
ci_068                -4.276490e-03 3 1  ON 67
ci_069                -4.116149e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9143e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2422
    reference variance = 0.268352
====================================================
  Execution time = 1.3733e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5303e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9851e-01
  Total weights = 1.957855877e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5111e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284957058513
                                         uncertainty =       0.001620623007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284957058513
                                         uncertainty =       0.001620623007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377463587
  error estimate for blocks of size 2^( 2) =       0.000388935771
  error estimate for blocks of size 2^( 3) =       0.000399255525
  error estimate for blocks of size 2^( 4) =       0.000407047932
  error estimate for blocks of size 2^( 5) =       0.000412440611
  error estimate for blocks of size 2^( 6) =       0.000412556316
  error estimate for blocks of size 2^( 7) =       0.000414280469

      target function =      -0.914917547075
              le_mean =     -17.216271976671
             les_mean =     296.698535176296
             stat err =       0.000411581332
             autocorr =       1.188943483631
   target nu stat err =       0.000411581332
   target dn stat err =       0.002830571014
      target stat err =       0.004484152383
              std dev =       0.533814124200
             le_variance =       0.284957519195


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721627197667e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914938813273       residual = 2.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914940970290       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914941120786       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914941144507       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914941147002       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914941148843       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914941149629       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914941149799       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914941150000       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 6.019531e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914938813273       residual = 2.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914939353359       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914939391025       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914939396958       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914939397581       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914939398041       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914939398238       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914939398280       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914939398331       residual = 9.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 1.507213e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914938813273       residual = 2.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914938948346       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914938957766       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914938959249       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914938959404       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914938959521       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914938959569       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914938959580       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914938959592       residual = 9.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+02 is 3.769491e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185410 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6254e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -3.749983e-02 3 1  ON 0
ci_002                -2.875422e-02 3 1  ON 1
ci_003                -2.362132e-02 3 1  ON 2
ci_004                 2.083457e-02 3 1  ON 3
ci_005                 2.127881e-02 3 1  ON 4
ci_006                -1.839295e-02 3 1  ON 5
ci_007                -1.848828e-02 3 1  ON 6
ci_008                -7.771105e-03 3 1  ON 7
ci_009                -1.388529e-02 3 1  ON 8
ci_010                -8.840897e-03 3 1  ON 9
ci_011                -8.957256e-03 3 1  ON 10
ci_012                -9.104325e-03 3 1  ON 11
ci_013                -1.908591e-02 3 1  ON 12
ci_014                 1.111462e-02 3 1  ON 13
ci_015                 1.092771e-02 3 1  ON 14
ci_016                 1.590751e-02 3 1  ON 15
ci_017                 1.564036e-02 3 1  ON 16
ci_018                 9.110779e-03 3 1  ON 17
ci_019                 9.004932e-03 3 1  ON 18
ci_020                 1.503822e-02 3 1  ON 19
ci_021                 1.520078e-02 3 1  ON 20
ci_022                 8.268989e-03 3 1  ON 21
ci_023                 8.254858e-03 3 1  ON 22
ci_024                 8.343698e-03 3 1  ON 23
ci_025                 8.422406e-03 3 1  ON 24
ci_026                 9.909976e-03 3 1  ON 25
ci_027                 9.698746e-03 3 1  ON 26
ci_028                -1.452983e-02 3 1  ON 27
ci_029                -1.479647e-02 3 1  ON 28
ci_030                -8.757465e-03 3 1  ON 29
ci_031                -8.616428e-03 3 1  ON 30
ci_032                -1.432810e-02 3 1  ON 31
ci_033                 4.550301e-03 3 1  ON 32
ci_034                 4.843913e-03 3 1  ON 33
ci_035                -3.333484e-03 3 1  ON 34
ci_036                -1.122010e-02 3 1  ON 35
ci_037                -1.147867e-02 3 1  ON 36
ci_038                 8.696658e-04 3 1  ON 37
ci_039                 1.141568e-03 3 1  ON 38
ci_040                -1.556699e-03 3 1  ON 39
ci_041                 8.160891e-03 3 1  ON 40
ci_042                 8.161489e-03 3 1  ON 41
ci_043                -2.343173e-03 3 1  ON 42
ci_044                -3.908518e-03 3 1  ON 43
ci_045                -1.989825e-03 3 1  ON 44
ci_046                 4.787173e-03 3 1  ON 45
ci_047                 4.610899e-03 3 1  ON 46
ci_048                -1.238377e-02 3 1  ON 47
ci_049                -1.295346e-02 3 1  ON 48
ci_050                 2.845122e-03 3 1  ON 49
ci_051                 2.987513e-03 3 1  ON 50
ci_052                -2.170573e-03 3 1  ON 51
ci_053                -2.204283e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424794e-03 3 1  ON 54
ci_056                 4.623300e-03 3 1  ON 55
ci_057                 4.637361e-03 3 1  ON 56
ci_058                -2.068547e-03 3 1  ON 57
ci_059                -2.051955e-03 3 1  ON 58
ci_060                 4.761946e-03 3 1  ON 59
ci_061                 5.208257e-03 3 1  ON 60
ci_062                -2.956648e-03 3 1  ON 61
ci_063                -2.807237e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384210e-03 3 1  ON 64
ci_066                 4.061261e-03 3 1  ON 65
ci_067                 4.229879e-03 3 1  ON 66
ci_068                -4.275660e-03 3 1  ON 67
ci_069                -4.115870e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1573
    reference variance = 0.43353
====================================================
  Execution time = 1.5144e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0737e-01
  Total weights = 1.9577e+06
  Execution time = 2.1173e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293841025816
                                         uncertainty =       0.003589017076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293841025816
                                         uncertainty =       0.003589017076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383317535
  error estimate for blocks of size 2^( 2) =       0.000394806889
  error estimate for blocks of size 2^( 3) =       0.000405502319
  error estimate for blocks of size 2^( 4) =       0.000412952710
  error estimate for blocks of size 2^( 5) =       0.000416917413
  error estimate for blocks of size 2^( 6) =       0.000417567763
  error estimate for blocks of size 2^( 7) =       0.000417173465

      target function =      -0.901347512386
              le_mean =     -17.214336620859
             les_mean =     296.640750955907
             stat err =       0.000416152838
             autocorr =       1.178659465169
   target nu stat err =       0.000416152838
   target dn stat err =       0.004812116834
      target stat err =       0.007314531820
              std dev =       0.542092856647
             le_variance =       0.293864665228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293841643406
                                         uncertainty =       0.003589675611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293841643406
                                         uncertainty =       0.003589675611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383317905
  error estimate for blocks of size 2^( 2) =       0.000394807334
  error estimate for blocks of size 2^( 3) =       0.000405502776
  error estimate for blocks of size 2^( 4) =       0.000412953173
  error estimate for blocks of size 2^( 5) =       0.000416917907
  error estimate for blocks of size 2^( 6) =       0.000417568185
  error estimate for blocks of size 2^( 7) =       0.000417173741

      target function =      -0.901343512890
              le_mean =     -17.214336588921
             les_mean =     296.640752484517
             stat err =       0.000416153251
             autocorr =       1.178659531711
   target nu stat err =       0.000416153251
   target dn stat err =       0.004813139603
      target stat err =       0.007316007474
              std dev =       0.542093379941
             le_variance =       0.293865232575

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293841334100
                                         uncertainty =       0.003589346704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293841334100
                                         uncertainty =       0.003589346704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383317720
  error estimate for blocks of size 2^( 2) =       0.000394807111
  error estimate for blocks of size 2^( 3) =       0.000405502547
  error estimate for blocks of size 2^( 4) =       0.000412952942
  error estimate for blocks of size 2^( 5) =       0.000416917660
  error estimate for blocks of size 2^( 6) =       0.000417567973
  error estimate for blocks of size 2^( 7) =       0.000417173603

      target function =      -0.901345615798
              le_mean =     -17.214336604767
             les_mean =     296.640751647778
             stat err =       0.000416153044
             autocorr =       1.178659498342
   target nu stat err =       0.000416153044
   target dn stat err =       0.004812628406
      target stat err =       0.007315271598
              std dev =       0.542093117786
             le_variance =       0.293864948351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293841064270
                                         uncertainty =       0.003589058287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293841064270
                                         uncertainty =       0.003589058287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383317558
  error estimate for blocks of size 2^( 2) =       0.000394806917
  error estimate for blocks of size 2^( 3) =       0.000405502347
  error estimate for blocks of size 2^( 4) =       0.000412952739
  error estimate for blocks of size 2^( 5) =       0.000416917444
  error estimate for blocks of size 2^( 6) =       0.000417567789
  error estimate for blocks of size 2^( 7) =       0.000417173482

      target function =      -0.901347287865
              le_mean =     -17.214336618835
             les_mean =     296.640751033679
             stat err =       0.000416152864
             autocorr =       1.178659469291
   target nu stat err =       0.000416152864
   target dn stat err =       0.004812180748
      target stat err =       0.007314624446
              std dev =       0.542092889214
             le_variance =       0.293864700536


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.901347512386        initial  <--
     3.9062e+01     3.9062e+02             6.0195e-06        -0.901343512890
     1.5625e+02     1.5625e+03             1.5072e-06        -0.901345615798
     6.2500e+02     6.2500e+03             3.7695e-07        -0.901347287865

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.6599
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -3.750008e-02 3 1  ON 0
ci_002                -2.875429e-02 3 1  ON 1
ci_003                -2.362190e-02 3 1  ON 2
ci_004                 2.083454e-02 3 1  ON 3
ci_005                 2.127883e-02 3 1  ON 4
ci_006                -1.839308e-02 3 1  ON 5
ci_007                -1.848825e-02 3 1  ON 6
ci_008                -7.770876e-03 3 1  ON 7
ci_009                -1.388532e-02 3 1  ON 8
ci_010                -8.841349e-03 3 1  ON 9
ci_011                -8.956806e-03 3 1  ON 10
ci_012                -9.104193e-03 3 1  ON 11
ci_013                -1.908584e-02 3 1  ON 12
ci_014                 1.111449e-02 3 1  ON 13
ci_015                 1.092734e-02 3 1  ON 14
ci_016                 1.590763e-02 3 1  ON 15
ci_017                 1.564055e-02 3 1  ON 16
ci_018                 9.111011e-03 3 1  ON 17
ci_019                 9.004804e-03 3 1  ON 18
ci_020                 1.503816e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269268e-03 3 1  ON 21
ci_023                 8.254906e-03 3 1  ON 22
ci_024                 8.343750e-03 3 1  ON 23
ci_025                 8.422039e-03 3 1  ON 24
ci_026                 9.910068e-03 3 1  ON 25
ci_027                 9.698834e-03 3 1  ON 26
ci_028                -1.452950e-02 3 1  ON 27
ci_029                -1.479656e-02 3 1  ON 28
ci_030                -8.758339e-03 3 1  ON 29
ci_031                -8.616239e-03 3 1  ON 30
ci_032                -1.432806e-02 3 1  ON 31
ci_033                 4.550060e-03 3 1  ON 32
ci_034                 4.843689e-03 3 1  ON 33
ci_035                -3.333304e-03 3 1  ON 34
ci_036                -1.121920e-02 3 1  ON 35
ci_037                -1.147850e-02 3 1  ON 36
ci_038                 8.698563e-04 3 1  ON 37
ci_039                 1.141858e-03 3 1  ON 38
ci_040                -1.556585e-03 3 1  ON 39
ci_041                 8.162398e-03 3 1  ON 40
ci_042                 8.161268e-03 3 1  ON 41
ci_043                -2.343231e-03 3 1  ON 42
ci_044                -3.909664e-03 3 1  ON 43
ci_045                -1.989934e-03 3 1  ON 44
ci_046                 4.787293e-03 3 1  ON 45
ci_047                 4.610974e-03 3 1  ON 46
ci_048                -1.238382e-02 3 1  ON 47
ci_049                -1.295395e-02 3 1  ON 48
ci_050                 2.844957e-03 3 1  ON 49
ci_051                 2.987726e-03 3 1  ON 50
ci_052                -2.169781e-03 3 1  ON 51
ci_053                -2.204101e-03 3 1  ON 52
ci_054                -2.206717e-03 3 1  ON 53
ci_055                -2.424979e-03 3 1  ON 54
ci_056                 4.623379e-03 3 1  ON 55
ci_057                 4.637364e-03 3 1  ON 56
ci_058                -2.068459e-03 3 1  ON 57
ci_059                -2.051651e-03 3 1  ON 58
ci_060                 4.761702e-03 3 1  ON 59
ci_061                 5.208227e-03 3 1  ON 60
ci_062                -2.956655e-03 3 1  ON 61
ci_063                -2.806988e-03 3 1  ON 62
ci_064                -2.259184e-03 3 1  ON 63
ci_065                -3.384007e-03 3 1  ON 64
ci_066                 4.061273e-03 3 1  ON 65
ci_067                 4.229741e-03 3 1  ON 66
ci_068                -4.276490e-03 3 1  ON 67
ci_069                -4.116149e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0920e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1837
    reference variance = 0.331877
====================================================
  Execution time = 1.3735e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5319e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9639e-01
  Total weights = 1.957819671e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4571e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284230091181
                                         uncertainty =       0.001537529354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284230091181
                                         uncertainty =       0.001537529354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376999676
  error estimate for blocks of size 2^( 2) =       0.000387908452
  error estimate for blocks of size 2^( 3) =       0.000398536375
  error estimate for blocks of size 2^( 4) =       0.000405808063
  error estimate for blocks of size 2^( 5) =       0.000411308316
  error estimate for blocks of size 2^( 6) =       0.000412091442
  error estimate for blocks of size 2^( 7) =       0.000413656416

      target function =      -0.918321280900
              le_mean =     -17.214195952987
             les_mean =     296.624931012522
             stat err =       0.000410716059
             autocorr =       1.186865247855
   target nu stat err =       0.000410716059
   target dn stat err =       0.002008087668
      target stat err =       0.003230158070
              std dev =       0.533158055215
             le_variance =       0.284257511841


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721419595299e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918331695527       residual = 6.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918331751549       residual = 7.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918331759598       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918331761817       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918331762193       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918331762151       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918331762258       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918331762317       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918331762317       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918331762317       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+02 is 2.776020e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918331695527       residual = 6.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918331709535       residual = 7.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918331711547       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918331712102       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918331712197       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918331712186       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918331712212       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918331712228       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918331712229       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918331712226       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+03 is 6.941070e-08

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918331695527       residual = 6.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918331699029       residual = 7.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918331699532       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918331699673       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918331699695       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918331699700       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918331699694       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918331699693       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918331699709       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918331699685       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+03 is 1.735331e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188925 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6202e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -3.750004e-02 3 1  ON 0
ci_002                -2.875427e-02 3 1  ON 1
ci_003                -2.362193e-02 3 1  ON 2
ci_004                 2.083454e-02 3 1  ON 3
ci_005                 2.127883e-02 3 1  ON 4
ci_006                -1.839309e-02 3 1  ON 5
ci_007                -1.848824e-02 3 1  ON 6
ci_008                -7.770838e-03 3 1  ON 7
ci_009                -1.388531e-02 3 1  ON 8
ci_010                -8.841353e-03 3 1  ON 9
ci_011                -8.956804e-03 3 1  ON 10
ci_012                -9.104130e-03 3 1  ON 11
ci_013                -1.908582e-02 3 1  ON 12
ci_014                 1.111448e-02 3 1  ON 13
ci_015                 1.092736e-02 3 1  ON 14
ci_016                 1.590762e-02 3 1  ON 15
ci_017                 1.564055e-02 3 1  ON 16
ci_018                 9.111012e-03 3 1  ON 17
ci_019                 9.004820e-03 3 1  ON 18
ci_020                 1.503813e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269272e-03 3 1  ON 21
ci_023                 8.254931e-03 3 1  ON 22
ci_024                 8.343728e-03 3 1  ON 23
ci_025                 8.422044e-03 3 1  ON 24
ci_026                 9.909998e-03 3 1  ON 25
ci_027                 9.698807e-03 3 1  ON 26
ci_028                -1.452952e-02 3 1  ON 27
ci_029                -1.479652e-02 3 1  ON 28
ci_030                -8.758330e-03 3 1  ON 29
ci_031                -8.616230e-03 3 1  ON 30
ci_032                -1.432809e-02 3 1  ON 31
ci_033                 4.550062e-03 3 1  ON 32
ci_034                 4.843673e-03 3 1  ON 33
ci_035                -3.333300e-03 3 1  ON 34
ci_036                -1.121926e-02 3 1  ON 35
ci_037                -1.147845e-02 3 1  ON 36
ci_038                 8.698515e-04 3 1  ON 37
ci_039                 1.141846e-03 3 1  ON 38
ci_040                -1.556580e-03 3 1  ON 39
ci_041                 8.162400e-03 3 1  ON 40
ci_042                 8.161279e-03 3 1  ON 41
ci_043                -2.343215e-03 3 1  ON 42
ci_044                -3.909724e-03 3 1  ON 43
ci_045                -1.989943e-03 3 1  ON 44
ci_046                 4.787303e-03 3 1  ON 45
ci_047                 4.610959e-03 3 1  ON 46
ci_048                -1.238383e-02 3 1  ON 47
ci_049                -1.295394e-02 3 1  ON 48
ci_050                 2.844944e-03 3 1  ON 49
ci_051                 2.987736e-03 3 1  ON 50
ci_052                -2.169788e-03 3 1  ON 51
ci_053                -2.204130e-03 3 1  ON 52
ci_054                -2.206733e-03 3 1  ON 53
ci_055                -2.424972e-03 3 1  ON 54
ci_056                 4.623370e-03 3 1  ON 55
ci_057                 4.637351e-03 3 1  ON 56
ci_058                -2.068454e-03 3 1  ON 57
ci_059                -2.051622e-03 3 1  ON 58
ci_060                 4.761673e-03 3 1  ON 59
ci_061                 5.208228e-03 3 1  ON 60
ci_062                -2.956664e-03 3 1  ON 61
ci_063                -2.806951e-03 3 1  ON 62
ci_064                -2.259176e-03 3 1  ON 63
ci_065                -3.384022e-03 3 1  ON 64
ci_066                 4.061273e-03 3 1  ON 65
ci_067                 4.229744e-03 3 1  ON 66
ci_068                -4.276464e-03 3 1  ON 67
ci_069                -4.116116e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2515
    reference variance = 0.257863
====================================================
  Execution time = 1.3521e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0216e-01
  Total weights = 1.9579e+06
  Execution time = 1.8250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287998153924
                                         uncertainty =       0.001934136678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287998153924
                                         uncertainty =       0.001934136678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379495663
  error estimate for blocks of size 2^( 2) =       0.000390639672
  error estimate for blocks of size 2^( 3) =       0.000401210773
  error estimate for blocks of size 2^( 4) =       0.000409168643
  error estimate for blocks of size 2^( 5) =       0.000413382772
  error estimate for blocks of size 2^( 6) =       0.000416040933
  error estimate for blocks of size 2^( 7) =       0.000416706438

      target function =      -0.909332489851
              le_mean =     -17.214595127059
             les_mean =     296.644441984201
             stat err =       0.000413824697
             autocorr =       1.189102181812
   target nu stat err =       0.000413824697
   target dn stat err =       0.002456210440
      target stat err =       0.003848614152
              std dev =       0.536687913834
             le_variance =       0.288033916855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287998099784
                                         uncertainty =       0.001934132624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287998099784
                                         uncertainty =       0.001934132624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379495628
  error estimate for blocks of size 2^( 2) =       0.000390639646
  error estimate for blocks of size 2^( 3) =       0.000401210757
  error estimate for blocks of size 2^( 4) =       0.000409168633
  error estimate for blocks of size 2^( 5) =       0.000413382765
  error estimate for blocks of size 2^( 6) =       0.000416040930
  error estimate for blocks of size 2^( 7) =       0.000416706430

      target function =      -0.909337077867
              le_mean =     -17.214595127137
             les_mean =     296.644439012614
             stat err =       0.000413824690
             autocorr =       1.189102364589
   target nu stat err =       0.000413824690
   target dn stat err =       0.002455759053
      target stat err =       0.003847968513
              std dev =       0.536687863588
             le_variance =       0.288033862922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287998126847
                                         uncertainty =       0.001934134651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287998126847
                                         uncertainty =       0.001934134651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379495645
  error estimate for blocks of size 2^( 2) =       0.000390639659
  error estimate for blocks of size 2^( 3) =       0.000401210765
  error estimate for blocks of size 2^( 4) =       0.000409168638
  error estimate for blocks of size 2^( 5) =       0.000413382769
  error estimate for blocks of size 2^( 6) =       0.000416040931
  error estimate for blocks of size 2^( 7) =       0.000416706434

      target function =      -0.909334808537
              le_mean =     -17.214595127098
             les_mean =     296.644440482391
             stat err =       0.000413824693
             autocorr =       1.189102273231
   target nu stat err =       0.000413824693
   target dn stat err =       0.002455983632
      target stat err =       0.003848289851
              std dev =       0.536687888704
             le_variance =       0.288033889882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287998150539
                                         uncertainty =       0.001934136425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287998150539
                                         uncertainty =       0.001934136425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379495661
  error estimate for blocks of size 2^( 2) =       0.000390639670
  error estimate for blocks of size 2^( 3) =       0.000401210772
  error estimate for blocks of size 2^( 4) =       0.000409168643
  error estimate for blocks of size 2^( 5) =       0.000413382772
  error estimate for blocks of size 2^( 6) =       0.000416040932
  error estimate for blocks of size 2^( 7) =       0.000416706438

      target function =      -0.909332782245
              le_mean =     -17.214595127064
             les_mean =     296.644441794815
             stat err =       0.000413824696
             autocorr =       1.189102193229
   target nu stat err =       0.000413824696
   target dn stat err =       0.002456181969
      target stat err =       0.003848573453
              std dev =       0.536687910692
             le_variance =       0.288033913483


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909332489851        initial
     3.9062e+02     3.9062e+03             2.7760e-07        -0.909337077867  <--
     1.5625e+03     1.5625e+04             6.9411e-08        -0.909334808537
     6.2500e+03     6.2500e+04             1.7353e-08        -0.909332782245

*****************************************************************************
Applying the update for shift_i =   3.9062e+02     and shift_s =   3.9062e+03
*****************************************************************************

  Execution time = 2.2717e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839313e-02 3 1  ON 5
ci_007                -1.848821e-02 3 1  ON 6
ci_008                -7.770726e-03 3 1  ON 7
ci_009                -1.388527e-02 3 1  ON 8
ci_010                -8.841363e-03 3 1  ON 9
ci_011                -8.956798e-03 3 1  ON 10
ci_012                -9.103941e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111445e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111015e-03 3 1  ON 17
ci_019                 9.004867e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269284e-03 3 1  ON 21
ci_023                 8.255004e-03 3 1  ON 22
ci_024                 8.343663e-03 3 1  ON 23
ci_025                 8.422061e-03 3 1  ON 24
ci_026                 9.909790e-03 3 1  ON 25
ci_027                 9.698723e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758303e-03 3 1  ON 29
ci_031                -8.616204e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550069e-03 3 1  ON 32
ci_034                 4.843627e-03 3 1  ON 33
ci_035                -3.333287e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698373e-04 3 1  ON 37
ci_039                 1.141809e-03 3 1  ON 38
ci_040                -1.556568e-03 3 1  ON 39
ci_041                 8.162407e-03 3 1  ON 40
ci_042                 8.161309e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909901e-03 3 1  ON 43
ci_045                -1.989971e-03 3 1  ON 44
ci_046                 4.787333e-03 3 1  ON 45
ci_047                 4.610914e-03 3 1  ON 46
ci_048                -1.238388e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844904e-03 3 1  ON 49
ci_051                 2.987768e-03 3 1  ON 50
ci_052                -2.169809e-03 3 1  ON 51
ci_053                -2.204218e-03 3 1  ON 52
ci_054                -2.206783e-03 3 1  ON 53
ci_055                -2.424949e-03 3 1  ON 54
ci_056                 4.623343e-03 3 1  ON 55
ci_057                 4.637312e-03 3 1  ON 56
ci_058                -2.068439e-03 3 1  ON 57
ci_059                -2.051535e-03 3 1  ON 58
ci_060                 4.761588e-03 3 1  ON 59
ci_061                 5.208233e-03 3 1  ON 60
ci_062                -2.956691e-03 3 1  ON 61
ci_063                -2.806840e-03 3 1  ON 62
ci_064                -2.259152e-03 3 1  ON 63
ci_065                -3.384067e-03 3 1  ON 64
ci_066                 4.061274e-03 3 1  ON 65
ci_067                 4.229750e-03 3 1  ON 66
ci_068                -4.276384e-03 3 1  ON 67
ci_069                -4.116017e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8925e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2169
    reference variance = 0.152874
====================================================
  Execution time = 1.3784e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5312e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0020e-01
  Total weights = 1.957639038e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5122e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287489117144
                                         uncertainty =       0.001748388995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287489117144
                                         uncertainty =       0.001748388995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379118811
  error estimate for blocks of size 2^( 2) =       0.000390588671
  error estimate for blocks of size 2^( 3) =       0.000400820312
  error estimate for blocks of size 2^( 4) =       0.000408867592
  error estimate for blocks of size 2^( 5) =       0.000413917495
  error estimate for blocks of size 2^( 6) =       0.000416643279
  error estimate for blocks of size 2^( 7) =       0.000417472038

      target function =      -0.912339994511
              le_mean =     -17.214999494022
             les_mean =     296.656410727715
             stat err =       0.000414225101
             autocorr =       1.193774118313
   target nu stat err =       0.000414225101
   target dn stat err =       0.002263211841
      target stat err =       0.003582586804
              std dev =       0.536154963618
             le_variance =       0.287462145013


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721499949402e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912353162940       residual = 7.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912353439397       residual = 5.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912353463728       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912353470476       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912353472905       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912353472718       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912353472638       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912353472639       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912353472646       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+01 is 1.146054e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912353162940       residual = 7.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912353232096       residual = 5.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912353238181       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912353239869       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912353240477       residual = 7.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912353240429       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912353240409       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912353240409       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912353240412       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+02 is 2.866716e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912353162940       residual = 7.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912353180232       residual = 5.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912353181753       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912353182175       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912353182327       residual = 7.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912353182315       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912353182308       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912353182310       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912353182311       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+03 is 7.167778e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191946 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6306e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -3.749987e-02 3 1  ON 0
ci_002                -2.875401e-02 3 1  ON 1
ci_003                -2.362191e-02 3 1  ON 2
ci_004                 2.083441e-02 3 1  ON 3
ci_005                 2.127877e-02 3 1  ON 4
ci_006                -1.839310e-02 3 1  ON 5
ci_007                -1.848818e-02 3 1  ON 6
ci_008                -7.770642e-03 3 1  ON 7
ci_009                -1.388507e-02 3 1  ON 8
ci_010                -8.841306e-03 3 1  ON 9
ci_011                -8.956716e-03 3 1  ON 10
ci_012                -9.103654e-03 3 1  ON 11
ci_013                -1.908579e-02 3 1  ON 12
ci_014                 1.111436e-02 3 1  ON 13
ci_015                 1.092740e-02 3 1  ON 14
ci_016                 1.590751e-02 3 1  ON 15
ci_017                 1.564057e-02 3 1  ON 16
ci_018                 9.111146e-03 3 1  ON 17
ci_019                 9.004951e-03 3 1  ON 18
ci_020                 1.503801e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269293e-03 3 1  ON 21
ci_023                 8.254891e-03 3 1  ON 22
ci_024                 8.343556e-03 3 1  ON 23
ci_025                 8.422021e-03 3 1  ON 24
ci_026                 9.909832e-03 3 1  ON 25
ci_027                 9.698650e-03 3 1  ON 26
ci_028                -1.452964e-02 3 1  ON 27
ci_029                -1.479629e-02 3 1  ON 28
ci_030                -8.758321e-03 3 1  ON 29
ci_031                -8.616299e-03 3 1  ON 30
ci_032                -1.432811e-02 3 1  ON 31
ci_033                 4.550138e-03 3 1  ON 32
ci_034                 4.843517e-03 3 1  ON 33
ci_035                -3.333204e-03 3 1  ON 34
ci_036                -1.121928e-02 3 1  ON 35
ci_037                -1.147827e-02 3 1  ON 36
ci_038                 8.696859e-04 3 1  ON 37
ci_039                 1.141826e-03 3 1  ON 38
ci_040                -1.556688e-03 3 1  ON 39
ci_041                 8.162310e-03 3 1  ON 40
ci_042                 8.161574e-03 3 1  ON 41
ci_043                -2.343098e-03 3 1  ON 42
ci_044                -3.909871e-03 3 1  ON 43
ci_045                -1.989986e-03 3 1  ON 44
ci_046                 4.787383e-03 3 1  ON 45
ci_047                 4.610911e-03 3 1  ON 46
ci_048                -1.238403e-02 3 1  ON 47
ci_049                -1.295383e-02 3 1  ON 48
ci_050                 2.844955e-03 3 1  ON 49
ci_051                 2.987837e-03 3 1  ON 50
ci_052                -2.169975e-03 3 1  ON 51
ci_053                -2.204167e-03 3 1  ON 52
ci_054                -2.206742e-03 3 1  ON 53
ci_055                -2.424914e-03 3 1  ON 54
ci_056                 4.623271e-03 3 1  ON 55
ci_057                 4.637206e-03 3 1  ON 56
ci_058                -2.068451e-03 3 1  ON 57
ci_059                -2.051500e-03 3 1  ON 58
ci_060                 4.761657e-03 3 1  ON 59
ci_061                 5.208165e-03 3 1  ON 60
ci_062                -2.956780e-03 3 1  ON 61
ci_063                -2.806840e-03 3 1  ON 62
ci_064                -2.259183e-03 3 1  ON 63
ci_065                -3.384026e-03 3 1  ON 64
ci_066                 4.061335e-03 3 1  ON 65
ci_067                 4.229814e-03 3 1  ON 66
ci_068                -4.276371e-03 3 1  ON 67
ci_069                -4.116031e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1645
    reference variance = 0.255703
====================================================
  Execution time = 1.3397e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0171e-01
  Total weights = 1.9575e+06
  Execution time = 1.8292e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286291524040
                                         uncertainty =       0.001590354825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286291524040
                                         uncertainty =       0.001590354825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378337901
  error estimate for blocks of size 2^( 2) =       0.000389784430
  error estimate for blocks of size 2^( 3) =       0.000400317969
  error estimate for blocks of size 2^( 4) =       0.000408319134
  error estimate for blocks of size 2^( 5) =       0.000412977125
  error estimate for blocks of size 2^( 6) =       0.000415529589
  error estimate for blocks of size 2^( 7) =       0.000415334240

      target function =      -0.910005275401
              le_mean =     -17.214784079089
             les_mean =     296.650501385637
             stat err =       0.000413040022
             autocorr =       1.191858148451
   target nu stat err =       0.000413040022
   target dn stat err =       0.002995201565
      target stat err =       0.004675893946
              std dev =       0.535050590615
             le_variance =       0.286279134518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286291481656
                                         uncertainty =       0.001590364662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286291481656
                                         uncertainty =       0.001590364662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378337873
  error estimate for blocks of size 2^( 2) =       0.000389784460
  error estimate for blocks of size 2^( 3) =       0.000400318052
  error estimate for blocks of size 2^( 4) =       0.000408319253
  error estimate for blocks of size 2^( 5) =       0.000412977277
  error estimate for blocks of size 2^( 6) =       0.000415529731
  error estimate for blocks of size 2^( 7) =       0.000415334361

      target function =      -0.909996791154
              le_mean =     -17.214784074089
             les_mean =     296.650506689818
             stat err =       0.000413040156
             autocorr =       1.191859095973
   target nu stat err =       0.000413040156
   target dn stat err =       0.002997251077
      target stat err =       0.004678935582
              std dev =       0.535050551343
             le_variance =       0.286279092493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286291502795
                                         uncertainty =       0.001590359746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286291502795
                                         uncertainty =       0.001590359746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378337887
  error estimate for blocks of size 2^( 2) =       0.000389784445
  error estimate for blocks of size 2^( 3) =       0.000400318011
  error estimate for blocks of size 2^( 4) =       0.000408319194
  error estimate for blocks of size 2^( 5) =       0.000412977201
  error estimate for blocks of size 2^( 6) =       0.000415529660
  error estimate for blocks of size 2^( 7) =       0.000415334301

      target function =      -0.910001041170
              le_mean =     -17.214784076581
             les_mean =     296.650504032353
             stat err =       0.000413040089
             autocorr =       1.191858622449
   target nu stat err =       0.000413040089
   target dn stat err =       0.002996223929
      target stat err =       0.004677411203
              std dev =       0.535050570930
             le_variance =       0.286279113452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286291521379
                                         uncertainty =       0.001590355440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286291521379
                                         uncertainty =       0.001590355440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378337899
  error estimate for blocks of size 2^( 2) =       0.000389784432
  error estimate for blocks of size 2^( 3) =       0.000400317974
  error estimate for blocks of size 2^( 4) =       0.000408319141
  error estimate for blocks of size 2^( 5) =       0.000412977134
  error estimate for blocks of size 2^( 6) =       0.000415529598
  error estimate for blocks of size 2^( 7) =       0.000415334248

      target function =      -0.910004747180
              le_mean =     -17.214784078775
             les_mean =     296.650501715767
             stat err =       0.000413040030
             autocorr =       1.191858207703
   target nu stat err =       0.000413040030
   target dn stat err =       0.002995329054
      target stat err =       0.004676083147
              std dev =       0.535050588149
             le_variance =       0.286279131879


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910005275401        initial  <--
     9.7656e+01     9.7656e+02             1.1461e-06        -0.909996791154
     3.9062e+02     3.9062e+03             2.8667e-07        -0.910001041170
     1.5625e+03     1.5625e+04             7.1678e-08        -0.910004747180

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6697
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839313e-02 3 1  ON 5
ci_007                -1.848821e-02 3 1  ON 6
ci_008                -7.770726e-03 3 1  ON 7
ci_009                -1.388527e-02 3 1  ON 8
ci_010                -8.841363e-03 3 1  ON 9
ci_011                -8.956798e-03 3 1  ON 10
ci_012                -9.103941e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111445e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111015e-03 3 1  ON 17
ci_019                 9.004867e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269284e-03 3 1  ON 21
ci_023                 8.255004e-03 3 1  ON 22
ci_024                 8.343663e-03 3 1  ON 23
ci_025                 8.422061e-03 3 1  ON 24
ci_026                 9.909790e-03 3 1  ON 25
ci_027                 9.698723e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758303e-03 3 1  ON 29
ci_031                -8.616204e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550069e-03 3 1  ON 32
ci_034                 4.843627e-03 3 1  ON 33
ci_035                -3.333287e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698373e-04 3 1  ON 37
ci_039                 1.141809e-03 3 1  ON 38
ci_040                -1.556568e-03 3 1  ON 39
ci_041                 8.162407e-03 3 1  ON 40
ci_042                 8.161309e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909901e-03 3 1  ON 43
ci_045                -1.989971e-03 3 1  ON 44
ci_046                 4.787333e-03 3 1  ON 45
ci_047                 4.610914e-03 3 1  ON 46
ci_048                -1.238388e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844904e-03 3 1  ON 49
ci_051                 2.987768e-03 3 1  ON 50
ci_052                -2.169809e-03 3 1  ON 51
ci_053                -2.204218e-03 3 1  ON 52
ci_054                -2.206783e-03 3 1  ON 53
ci_055                -2.424949e-03 3 1  ON 54
ci_056                 4.623343e-03 3 1  ON 55
ci_057                 4.637312e-03 3 1  ON 56
ci_058                -2.068439e-03 3 1  ON 57
ci_059                -2.051535e-03 3 1  ON 58
ci_060                 4.761588e-03 3 1  ON 59
ci_061                 5.208233e-03 3 1  ON 60
ci_062                -2.956691e-03 3 1  ON 61
ci_063                -2.806840e-03 3 1  ON 62
ci_064                -2.259152e-03 3 1  ON 63
ci_065                -3.384067e-03 3 1  ON 64
ci_066                 4.061274e-03 3 1  ON 65
ci_067                 4.229750e-03 3 1  ON 66
ci_068                -4.276384e-03 3 1  ON 67
ci_069                -4.116017e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9000e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1706
    reference variance = 0.296626
====================================================
  Execution time = 1.4004e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5316e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9923e-01
  Total weights = 1.957884666e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4812e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285887386000
                                         uncertainty =       0.002296134346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285887386000
                                         uncertainty =       0.002296134346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378059052
  error estimate for blocks of size 2^( 2) =       0.000389305667
  error estimate for blocks of size 2^( 3) =       0.000399486640
  error estimate for blocks of size 2^( 4) =       0.000407784548
  error estimate for blocks of size 2^( 5) =       0.000412291644
  error estimate for blocks of size 2^( 6) =       0.000413290144
  error estimate for blocks of size 2^( 7) =       0.000416333149

      target function =      -0.913827658516
              le_mean =     -17.215221552594
             les_mean =     296.663086613645
             stat err =       0.000412424871
             autocorr =       1.190064257751
   target nu stat err =       0.000412424871
   target dn stat err =       0.003134026103
      target stat err =       0.004932467215
              std dev =       0.534656239388
             le_variance =       0.285857294317


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721522155259e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913853031746       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913853110705       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913853118081       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913853120056       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913853120403       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913853120447       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913853120419       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913853120419       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913853120429       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913853120428       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+02 is 1.750871e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913853031746       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913853051487       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913853053331       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913853053824       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913853053909       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913853053924       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913853053915       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913853053916       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913853053917       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913853053916       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+03 is 4.377443e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913853031746       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913853036681       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913853037142       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913853037265       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913853037276       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913853037281       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913853037303       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913853037290       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913853037259       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913853037308       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+04 is 1.094377e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.195484 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6494e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -3.749989e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362203e-02 3 1  ON 2
ci_004                 2.083455e-02 3 1  ON 3
ci_005                 2.127886e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848818e-02 3 1  ON 6
ci_008                -7.770718e-03 3 1  ON 7
ci_009                -1.388529e-02 3 1  ON 8
ci_010                -8.841404e-03 3 1  ON 9
ci_011                -8.956773e-03 3 1  ON 10
ci_012                -9.103926e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111445e-02 3 1  ON 13
ci_015                 1.092739e-02 3 1  ON 14
ci_016                 1.590761e-02 3 1  ON 15
ci_017                 1.564052e-02 3 1  ON 16
ci_018                 9.111002e-03 3 1  ON 17
ci_019                 9.004854e-03 3 1  ON 18
ci_020                 1.503806e-02 3 1  ON 19
ci_021                 1.520093e-02 3 1  ON 20
ci_022                 8.269273e-03 3 1  ON 21
ci_023                 8.254991e-03 3 1  ON 22
ci_024                 8.343639e-03 3 1  ON 23
ci_025                 8.422083e-03 3 1  ON 24
ci_026                 9.909796e-03 3 1  ON 25
ci_027                 9.698679e-03 3 1  ON 26
ci_028                -1.452959e-02 3 1  ON 27
ci_029                -1.479644e-02 3 1  ON 28
ci_030                -8.758280e-03 3 1  ON 29
ci_031                -8.616220e-03 3 1  ON 30
ci_032                -1.432815e-02 3 1  ON 31
ci_033                 4.550069e-03 3 1  ON 32
ci_034                 4.843616e-03 3 1  ON 33
ci_035                -3.333285e-03 3 1  ON 34
ci_036                -1.121946e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698321e-04 3 1  ON 37
ci_039                 1.141804e-03 3 1  ON 38
ci_040                -1.556564e-03 3 1  ON 39
ci_041                 8.162409e-03 3 1  ON 40
ci_042                 8.161310e-03 3 1  ON 41
ci_043                -2.343166e-03 3 1  ON 42
ci_044                -3.909896e-03 3 1  ON 43
ci_045                -1.989969e-03 3 1  ON 44
ci_046                 4.787335e-03 3 1  ON 45
ci_047                 4.610920e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295388e-02 3 1  ON 48
ci_050                 2.844916e-03 3 1  ON 49
ci_051                 2.987786e-03 3 1  ON 50
ci_052                -2.169774e-03 3 1  ON 51
ci_053                -2.204212e-03 3 1  ON 52
ci_054                -2.206778e-03 3 1  ON 53
ci_055                -2.424944e-03 3 1  ON 54
ci_056                 4.623336e-03 3 1  ON 55
ci_057                 4.637307e-03 3 1  ON 56
ci_058                -2.068405e-03 3 1  ON 57
ci_059                -2.051529e-03 3 1  ON 58
ci_060                 4.761561e-03 3 1  ON 59
ci_061                 5.208227e-03 3 1  ON 60
ci_062                -2.956683e-03 3 1  ON 61
ci_063                -2.806837e-03 3 1  ON 62
ci_064                -2.259154e-03 3 1  ON 63
ci_065                -3.384065e-03 3 1  ON 64
ci_066                 4.061266e-03 3 1  ON 65
ci_067                 4.229742e-03 3 1  ON 66
ci_068                -4.276375e-03 3 1  ON 67
ci_069                -4.116035e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1947
    reference variance = 0.117133
====================================================
  Execution time = 1.3426e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9618e-01
  Total weights = 1.9577e+06
  Execution time = 1.8142e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283521255740
                                         uncertainty =       0.001368349673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283521255740
                                         uncertainty =       0.001368349673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376562025
  error estimate for blocks of size 2^( 2) =       0.000388215185
  error estimate for blocks of size 2^( 3) =       0.000398087209
  error estimate for blocks of size 2^( 4) =       0.000405867218
  error estimate for blocks of size 2^( 5) =       0.000410495058
  error estimate for blocks of size 2^( 6) =       0.000411939989
  error estimate for blocks of size 2^( 7) =       0.000413940568

      target function =      -0.918632116818
              le_mean =     -17.214684899014
             les_mean =     296.641558774122
             stat err =       0.000410560708
             autocorr =       1.188725899196
   target nu stat err =       0.000410560708
   target dn stat err =       0.002139330297
      target stat err =       0.003436941317
              std dev =       0.532539123505
             le_variance =       0.283597918064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283521249938
                                         uncertainty =       0.001368349908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283521249938
                                         uncertainty =       0.001368349908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376562022
  error estimate for blocks of size 2^( 2) =       0.000388215191
  error estimate for blocks of size 2^( 3) =       0.000398087225
  error estimate for blocks of size 2^( 4) =       0.000405867240
  error estimate for blocks of size 2^( 5) =       0.000410495084
  error estimate for blocks of size 2^( 6) =       0.000411940014
  error estimate for blocks of size 2^( 7) =       0.000413940584

      target function =      -0.918631555181
              le_mean =     -17.214684899629
             les_mean =     296.641559152301
             stat err =       0.000410560730
             autocorr =       1.188726049160
   target nu stat err =       0.000410560730
   target dn stat err =       0.002139348019
      target stat err =       0.003436964495
              std dev =       0.532539118575
             le_variance =       0.283597912812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283521252837
                                         uncertainty =       0.001368349791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283521252837
                                         uncertainty =       0.001368349791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376562024
  error estimate for blocks of size 2^( 2) =       0.000388215188
  error estimate for blocks of size 2^( 3) =       0.000398087217
  error estimate for blocks of size 2^( 4) =       0.000405867229
  error estimate for blocks of size 2^( 5) =       0.000410495071
  error estimate for blocks of size 2^( 6) =       0.000411940002
  error estimate for blocks of size 2^( 7) =       0.000413940576

      target function =      -0.918631836474
              le_mean =     -17.214684899321
             les_mean =     296.641558962905
             stat err =       0.000410560719
             autocorr =       1.188725974190
   target nu stat err =       0.000410560719
   target dn stat err =       0.002139339150
      target stat err =       0.003436952897
              std dev =       0.532539121038
             le_variance =       0.283597915436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283521255377
                                         uncertainty =       0.001368349688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283521255377
                                         uncertainty =       0.001368349688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376562025
  error estimate for blocks of size 2^( 2) =       0.000388215186
  error estimate for blocks of size 2^( 3) =       0.000398087210
  error estimate for blocks of size 2^( 4) =       0.000405867219
  error estimate for blocks of size 2^( 5) =       0.000410495060
  error estimate for blocks of size 2^( 6) =       0.000411939991
  error estimate for blocks of size 2^( 7) =       0.000413940569

      target function =      -0.918632081828
              le_mean =     -17.214684899052
             les_mean =     296.641558797685
             stat err =       0.000410560710
             autocorr =       1.188725908573
   target nu stat err =       0.000410560710
   target dn stat err =       0.002139331403
      target stat err =       0.003436942764
              std dev =       0.532539123197
             le_variance =       0.283597917735


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918632116818        initial  <--
     9.7656e+02     9.7656e+03             1.7509e-07        -0.918631555181
     3.9062e+03     3.9062e+04             4.3774e-08        -0.918631836474
     1.5625e+04     1.5625e+05             1.0944e-08        -0.918632081828

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5972
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839313e-02 3 1  ON 5
ci_007                -1.848821e-02 3 1  ON 6
ci_008                -7.770726e-03 3 1  ON 7
ci_009                -1.388527e-02 3 1  ON 8
ci_010                -8.841363e-03 3 1  ON 9
ci_011                -8.956798e-03 3 1  ON 10
ci_012                -9.103941e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111445e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111015e-03 3 1  ON 17
ci_019                 9.004867e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269284e-03 3 1  ON 21
ci_023                 8.255004e-03 3 1  ON 22
ci_024                 8.343663e-03 3 1  ON 23
ci_025                 8.422061e-03 3 1  ON 24
ci_026                 9.909790e-03 3 1  ON 25
ci_027                 9.698723e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758303e-03 3 1  ON 29
ci_031                -8.616204e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550069e-03 3 1  ON 32
ci_034                 4.843627e-03 3 1  ON 33
ci_035                -3.333287e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698373e-04 3 1  ON 37
ci_039                 1.141809e-03 3 1  ON 38
ci_040                -1.556568e-03 3 1  ON 39
ci_041                 8.162407e-03 3 1  ON 40
ci_042                 8.161309e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909901e-03 3 1  ON 43
ci_045                -1.989971e-03 3 1  ON 44
ci_046                 4.787333e-03 3 1  ON 45
ci_047                 4.610914e-03 3 1  ON 46
ci_048                -1.238388e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844904e-03 3 1  ON 49
ci_051                 2.987768e-03 3 1  ON 50
ci_052                -2.169809e-03 3 1  ON 51
ci_053                -2.204218e-03 3 1  ON 52
ci_054                -2.206783e-03 3 1  ON 53
ci_055                -2.424949e-03 3 1  ON 54
ci_056                 4.623343e-03 3 1  ON 55
ci_057                 4.637312e-03 3 1  ON 56
ci_058                -2.068439e-03 3 1  ON 57
ci_059                -2.051535e-03 3 1  ON 58
ci_060                 4.761588e-03 3 1  ON 59
ci_061                 5.208233e-03 3 1  ON 60
ci_062                -2.956691e-03 3 1  ON 61
ci_063                -2.806840e-03 3 1  ON 62
ci_064                -2.259152e-03 3 1  ON 63
ci_065                -3.384067e-03 3 1  ON 64
ci_066                 4.061274e-03 3 1  ON 65
ci_067                 4.229750e-03 3 1  ON 66
ci_068                -4.276384e-03 3 1  ON 67
ci_069                -4.116017e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9099e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2111
    reference variance = 0.238725
====================================================
  Execution time = 1.3897e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0271e-01
  Total weights = 1.957760343e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4953e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288174816114
                                         uncertainty =       0.002008271468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288174816114
                                         uncertainty =       0.002008271468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379543174
  error estimate for blocks of size 2^( 2) =       0.000390933743
  error estimate for blocks of size 2^( 3) =       0.000401343344
  error estimate for blocks of size 2^( 4) =       0.000409239181
  error estimate for blocks of size 2^( 5) =       0.000414592089
  error estimate for blocks of size 2^( 6) =       0.000417502506
  error estimate for blocks of size 2^( 7) =       0.000420235737

      target function =      -0.908458083566
              le_mean =     -17.215023213528
             les_mean =     296.659732458333
             stat err =       0.000415392378
             autocorr =       1.197828593516
   target nu stat err =       0.000415392378
   target dn stat err =       0.002972636787
      target stat err =       0.004628535827
              std dev =       0.536755104517
             le_variance =       0.288106042225


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721502321353e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908480602193       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908480609482       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908480610244       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908480610399       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908480610421       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908480610430       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908480610423       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908480610421       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908480610440       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+03 is 2.478761e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908480602193       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908480604015       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908480604206       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908480604245       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908480604231       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908480604257       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908480604233       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908480604245       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908480604254       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+04 is 6.196937e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908480602193       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908480602648       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908480602696       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908480602706       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908480602706       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908480602707       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908480602734       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908480602707       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908480602707       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+05 is 1.549236e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198481 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6401e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839313e-02 3 1  ON 5
ci_007                -1.848821e-02 3 1  ON 6
ci_008                -7.770725e-03 3 1  ON 7
ci_009                -1.388527e-02 3 1  ON 8
ci_010                -8.841364e-03 3 1  ON 9
ci_011                -8.956792e-03 3 1  ON 10
ci_012                -9.103938e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111445e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111014e-03 3 1  ON 17
ci_019                 9.004863e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520092e-02 3 1  ON 20
ci_022                 8.269284e-03 3 1  ON 21
ci_023                 8.255003e-03 3 1  ON 22
ci_024                 8.343662e-03 3 1  ON 23
ci_025                 8.422061e-03 3 1  ON 24
ci_026                 9.909789e-03 3 1  ON 25
ci_027                 9.698725e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758305e-03 3 1  ON 29
ci_031                -8.616202e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550072e-03 3 1  ON 32
ci_034                 4.843628e-03 3 1  ON 33
ci_035                -3.333287e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698355e-04 3 1  ON 37
ci_039                 1.141808e-03 3 1  ON 38
ci_040                -1.556567e-03 3 1  ON 39
ci_041                 8.162407e-03 3 1  ON 40
ci_042                 8.161308e-03 3 1  ON 41
ci_043                -2.343170e-03 3 1  ON 42
ci_044                -3.909900e-03 3 1  ON 43
ci_045                -1.989969e-03 3 1  ON 44
ci_046                 4.787333e-03 3 1  ON 45
ci_047                 4.610915e-03 3 1  ON 46
ci_048                -1.238388e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844903e-03 3 1  ON 49
ci_051                 2.987768e-03 3 1  ON 50
ci_052                -2.169810e-03 3 1  ON 51
ci_053                -2.204220e-03 3 1  ON 52
ci_054                -2.206783e-03 3 1  ON 53
ci_055                -2.424949e-03 3 1  ON 54
ci_056                 4.623344e-03 3 1  ON 55
ci_057                 4.637312e-03 3 1  ON 56
ci_058                -2.068440e-03 3 1  ON 57
ci_059                -2.051535e-03 3 1  ON 58
ci_060                 4.761584e-03 3 1  ON 59
ci_061                 5.208232e-03 3 1  ON 60
ci_062                -2.956690e-03 3 1  ON 61
ci_063                -2.806839e-03 3 1  ON 62
ci_064                -2.259152e-03 3 1  ON 63
ci_065                -3.384067e-03 3 1  ON 64
ci_066                 4.061275e-03 3 1  ON 65
ci_067                 4.229750e-03 3 1  ON 66
ci_068                -4.276383e-03 3 1  ON 67
ci_069                -4.116019e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1872
    reference variance = 0.403712
====================================================
  Execution time = 1.3637e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9825e-01
  Total weights = 1.9575e+06
  Execution time = 1.8170e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285968112950
                                         uncertainty =       0.001745488243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285968112950
                                         uncertainty =       0.001745488243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378112820
  error estimate for blocks of size 2^( 2) =       0.000389436971
  error estimate for blocks of size 2^( 3) =       0.000399666814
  error estimate for blocks of size 2^( 4) =       0.000407026720
  error estimate for blocks of size 2^( 5) =       0.000411413158
  error estimate for blocks of size 2^( 6) =       0.000413601238
  error estimate for blocks of size 2^( 7) =       0.000416722631

      target function =      -0.915405734127
              le_mean =     -17.214355556763
             les_mean =     296.632283305233
             stat err =       0.000412190937
             autocorr =       1.188376548574
   target nu stat err =       0.000412190937
   target dn stat err =       0.002354975656
      target stat err =       0.003741799072
              std dev =       0.534732277564
             le_variance =       0.285938608668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285968111167
                                         uncertainty =       0.001745487950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285968111167
                                         uncertainty =       0.001745487950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378112818
  error estimate for blocks of size 2^( 2) =       0.000389436971
  error estimate for blocks of size 2^( 3) =       0.000399666815
  error estimate for blocks of size 2^( 4) =       0.000407026721
  error estimate for blocks of size 2^( 5) =       0.000411413159
  error estimate for blocks of size 2^( 6) =       0.000413601239
  error estimate for blocks of size 2^( 7) =       0.000416722632

      target function =      -0.915405740892
              le_mean =     -17.214355556787
             les_mean =     296.632283301699
             stat err =       0.000412190938
             autocorr =       1.188376562084
   target nu stat err =       0.000412190938
   target dn stat err =       0.002354975190
      target stat err =       0.003741798412
              std dev =       0.534732275876
             le_variance =       0.285938606864

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285968112058
                                         uncertainty =       0.001745488097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285968112058
                                         uncertainty =       0.001745488097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378112819
  error estimate for blocks of size 2^( 2) =       0.000389436971
  error estimate for blocks of size 2^( 3) =       0.000399666814
  error estimate for blocks of size 2^( 4) =       0.000407026720
  error estimate for blocks of size 2^( 5) =       0.000411413159
  error estimate for blocks of size 2^( 6) =       0.000413601239
  error estimate for blocks of size 2^( 7) =       0.000416722631

      target function =      -0.915405737510
              le_mean =     -17.214355556775
             les_mean =     296.632283303465
             stat err =       0.000412190937
             autocorr =       1.188376555325
   target nu stat err =       0.000412190937
   target dn stat err =       0.002354975423
      target stat err =       0.003741798742
              std dev =       0.534732276720
             le_variance =       0.285938607766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285968112838
                                         uncertainty =       0.001745488225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285968112838
                                         uncertainty =       0.001745488225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378112820
  error estimate for blocks of size 2^( 2) =       0.000389436971
  error estimate for blocks of size 2^( 3) =       0.000399666814
  error estimate for blocks of size 2^( 4) =       0.000407026720
  error estimate for blocks of size 2^( 5) =       0.000411413158
  error estimate for blocks of size 2^( 6) =       0.000413601238
  error estimate for blocks of size 2^( 7) =       0.000416722631

      target function =      -0.915405734550
              le_mean =     -17.214355556765
             les_mean =     296.632283305012
             stat err =       0.000412190937
             autocorr =       1.188376549425
   target nu stat err =       0.000412190937
   target dn stat err =       0.002354975627
      target stat err =       0.003741799031
              std dev =       0.534732277458
             le_variance =       0.285938608556


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915405734127        initial
     9.7656e+03     9.7656e+04             2.4788e-08        -0.915405740892  <--
     3.9062e+04     3.9062e+05             6.1969e-09        -0.915405737510
     1.5625e+05     1.5625e+06             1.5492e-09        -0.915405734550

*****************************************************************************
Applying the update for shift_i =   9.7656e+03     and shift_s =   9.7656e+04
*****************************************************************************

  Execution time = 2.2822e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848821e-02 3 1  ON 6
ci_008                -7.770724e-03 3 1  ON 7
ci_009                -1.388527e-02 3 1  ON 8
ci_010                -8.841365e-03 3 1  ON 9
ci_011                -8.956773e-03 3 1  ON 10
ci_012                -9.103930e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111445e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111010e-03 3 1  ON 17
ci_019                 9.004849e-03 3 1  ON 18
ci_020                 1.503806e-02 3 1  ON 19
ci_021                 1.520092e-02 3 1  ON 20
ci_022                 8.269285e-03 3 1  ON 21
ci_023                 8.255000e-03 3 1  ON 22
ci_024                 8.343659e-03 3 1  ON 23
ci_025                 8.422060e-03 3 1  ON 24
ci_026                 9.909784e-03 3 1  ON 25
ci_027                 9.698730e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758310e-03 3 1  ON 29
ci_031                -8.616196e-03 3 1  ON 30
ci_032                -1.432817e-02 3 1  ON 31
ci_033                 4.550080e-03 3 1  ON 32
ci_034                 4.843631e-03 3 1  ON 33
ci_035                -3.333287e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698302e-04 3 1  ON 37
ci_039                 1.141805e-03 3 1  ON 38
ci_040                -1.556567e-03 3 1  ON 39
ci_041                 8.162408e-03 3 1  ON 40
ci_042                 8.161303e-03 3 1  ON 41
ci_043                -2.343171e-03 3 1  ON 42
ci_044                -3.909898e-03 3 1  ON 43
ci_045                -1.989964e-03 3 1  ON 44
ci_046                 4.787335e-03 3 1  ON 45
ci_047                 4.610918e-03 3 1  ON 46
ci_048                -1.238388e-02 3 1  ON 47
ci_049                -1.295391e-02 3 1  ON 48
ci_050                 2.844899e-03 3 1  ON 49
ci_051                 2.987767e-03 3 1  ON 50
ci_052                -2.169812e-03 3 1  ON 51
ci_053                -2.204224e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424950e-03 3 1  ON 54
ci_056                 4.623345e-03 3 1  ON 55
ci_057                 4.637314e-03 3 1  ON 56
ci_058                -2.068441e-03 3 1  ON 57
ci_059                -2.051532e-03 3 1  ON 58
ci_060                 4.761572e-03 3 1  ON 59
ci_061                 5.208229e-03 3 1  ON 60
ci_062                -2.956688e-03 3 1  ON 61
ci_063                -2.806837e-03 3 1  ON 62
ci_064                -2.259152e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061277e-03 3 1  ON 65
ci_067                 4.229749e-03 3 1  ON 66
ci_068                -4.276383e-03 3 1  ON 67
ci_069                -4.116024e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9231e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1847
    reference variance = 0.316898
====================================================
  Execution time = 1.3930e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0410e-01
  Total weights = 1.957498280e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5240e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288812466619
                                         uncertainty =       0.002600817047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288812466619
                                         uncertainty =       0.002600817047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379989042
  error estimate for blocks of size 2^( 2) =       0.000391186832
  error estimate for blocks of size 2^( 3) =       0.000401921816
  error estimate for blocks of size 2^( 4) =       0.000408917357
  error estimate for blocks of size 2^( 5) =       0.000413889001
  error estimate for blocks of size 2^( 6) =       0.000415662539
  error estimate for blocks of size 2^( 7) =       0.000416210942

      target function =      -0.906325336413
              le_mean =     -17.214858415271
             les_mean =     296.655453168744
             stat err =       0.000413669960
             autocorr =       1.185129539785
   target nu stat err =       0.000413669960
   target dn stat err =       0.002917205068
      target stat err =       0.004521338962
              std dev =       0.537385656387
             le_variance =       0.288783343691


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721485841527e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906346966858       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906346997259       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906346999608       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906347000267       residual = 7.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906347000289       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906347000337       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906347000350       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906347000351       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906347000354       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906347000357       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+03 is 7.311336e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906346966858       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906346974458       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906346975046       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906346975210       residual = 7.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906346975217       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906346975223       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906346975232       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906346975227       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906346975224       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906346975229       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+03 is 1.827878e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906346966858       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906346968758       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906346968905       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906346968947       residual = 7.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906346968945       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906346968981       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906346969006       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906346968959       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906346968989       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906346969019       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+04 is 4.569722e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201977 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6464e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875422e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127883e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770719e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841369e-03 3 1  ON 9
ci_011                -8.956767e-03 3 1  ON 10
ci_012                -9.103926e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111443e-02 3 1  ON 13
ci_015                 1.092740e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111005e-03 3 1  ON 17
ci_019                 9.004853e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520092e-02 3 1  ON 20
ci_022                 8.269287e-03 3 1  ON 21
ci_023                 8.254997e-03 3 1  ON 22
ci_024                 8.343658e-03 3 1  ON 23
ci_025                 8.422063e-03 3 1  ON 24
ci_026                 9.909784e-03 3 1  ON 25
ci_027                 9.698729e-03 3 1  ON 26
ci_028                -1.452960e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758309e-03 3 1  ON 29
ci_031                -8.616194e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550094e-03 3 1  ON 32
ci_034                 4.843625e-03 3 1  ON 33
ci_035                -3.333290e-03 3 1  ON 34
ci_036                -1.121943e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698376e-04 3 1  ON 37
ci_039                 1.141807e-03 3 1  ON 38
ci_040                -1.556565e-03 3 1  ON 39
ci_041                 8.162402e-03 3 1  ON 40
ci_042                 8.161284e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909897e-03 3 1  ON 43
ci_045                -1.989954e-03 3 1  ON 44
ci_046                 4.787328e-03 3 1  ON 45
ci_047                 4.610918e-03 3 1  ON 46
ci_048                -1.238388e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844903e-03 3 1  ON 49
ci_051                 2.987766e-03 3 1  ON 50
ci_052                -2.169808e-03 3 1  ON 51
ci_053                -2.204228e-03 3 1  ON 52
ci_054                -2.206783e-03 3 1  ON 53
ci_055                -2.424953e-03 3 1  ON 54
ci_056                 4.623347e-03 3 1  ON 55
ci_057                 4.637319e-03 3 1  ON 56
ci_058                -2.068441e-03 3 1  ON 57
ci_059                -2.051522e-03 3 1  ON 58
ci_060                 4.761568e-03 3 1  ON 59
ci_061                 5.208226e-03 3 1  ON 60
ci_062                -2.956687e-03 3 1  ON 61
ci_063                -2.806841e-03 3 1  ON 62
ci_064                -2.259147e-03 3 1  ON 63
ci_065                -3.384063e-03 3 1  ON 64
ci_066                 4.061284e-03 3 1  ON 65
ci_067                 4.229744e-03 3 1  ON 66
ci_068                -4.276382e-03 3 1  ON 67
ci_069                -4.116032e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2064
    reference variance = 0.138985
====================================================
  Execution time = 1.3748e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9713e-01
  Total weights = 1.9578e+06
  Execution time = 1.8169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285927535825
                                         uncertainty =       0.001385830972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285927535825
                                         uncertainty =       0.001385830972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378050153
  error estimate for blocks of size 2^( 2) =       0.000389761876
  error estimate for blocks of size 2^( 3) =       0.000400063241
  error estimate for blocks of size 2^( 4) =       0.000407676255
  error estimate for blocks of size 2^( 5) =       0.000412395311
  error estimate for blocks of size 2^( 6) =       0.000415439256
  error estimate for blocks of size 2^( 7) =       0.000417225936

      target function =      -0.917152961855
              le_mean =     -17.214483544047
             les_mean =     296.635573094107
             stat err =       0.000413184190
             autocorr =       1.194506603052
   target nu stat err =       0.000413184190
   target dn stat err =       0.001957694688
      target stat err =       0.003147782421
              std dev =       0.534643653018
             le_variance =       0.285843835713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285927529499
                                         uncertainty =       0.001385829969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285927529499
                                         uncertainty =       0.001385829969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378050148
  error estimate for blocks of size 2^( 2) =       0.000389761875
  error estimate for blocks of size 2^( 3) =       0.000400063242
  error estimate for blocks of size 2^( 4) =       0.000407676260
  error estimate for blocks of size 2^( 5) =       0.000412395319
  error estimate for blocks of size 2^( 6) =       0.000415439268
  error estimate for blocks of size 2^( 7) =       0.000417225949

      target function =      -0.917152119912
              le_mean =     -17.214483543462
             les_mean =     296.635573610276
             stat err =       0.000413184199
             autocorr =       1.194506683954
   target nu stat err =       0.000413184199
   target dn stat err =       0.001957844003
      target stat err =       0.003148004802
              std dev =       0.534643647085
             le_variance =       0.285843829368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285927532662
                                         uncertainty =       0.001385830471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285927532662
                                         uncertainty =       0.001385830471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378050150
  error estimate for blocks of size 2^( 2) =       0.000389761875
  error estimate for blocks of size 2^( 3) =       0.000400063241
  error estimate for blocks of size 2^( 4) =       0.000407676257
  error estimate for blocks of size 2^( 5) =       0.000412395315
  error estimate for blocks of size 2^( 6) =       0.000415439262
  error estimate for blocks of size 2^( 7) =       0.000417225942

      target function =      -0.917152541056
              le_mean =     -17.214483543755
             les_mean =     296.635573352081
             stat err =       0.000413184194
             autocorr =       1.194506643504
   target nu stat err =       0.000413184194
   target dn stat err =       0.001957769302
      target stat err =       0.003147893545
              std dev =       0.534643650051
             le_variance =       0.285843832540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285927535430
                                         uncertainty =       0.001385830909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285927535430
                                         uncertainty =       0.001385830909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378050152
  error estimate for blocks of size 2^( 2) =       0.000389761876
  error estimate for blocks of size 2^( 3) =       0.000400063241
  error estimate for blocks of size 2^( 4) =       0.000407676255
  error estimate for blocks of size 2^( 5) =       0.000412395312
  error estimate for blocks of size 2^( 6) =       0.000415439257
  error estimate for blocks of size 2^( 7) =       0.000417225937

      target function =      -0.917152909274
              le_mean =     -17.214483544011
             les_mean =     296.635573126341
             stat err =       0.000413184190
             autocorr =       1.194506608113
   target nu stat err =       0.000413184190
   target dn stat err =       0.001957704010
      target stat err =       0.003147796304
              std dev =       0.534643652647
             le_variance =       0.285843835316


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917152961855        initial  <--
     2.4414e+03     2.4414e+04             7.3113e-08        -0.917152119912
     9.7656e+03     9.7656e+04             1.8279e-08        -0.917152541056
     3.9062e+04     3.9062e+05             4.5697e-09        -0.917152909274

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9346
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848821e-02 3 1  ON 6
ci_008                -7.770724e-03 3 1  ON 7
ci_009                -1.388527e-02 3 1  ON 8
ci_010                -8.841365e-03 3 1  ON 9
ci_011                -8.956773e-03 3 1  ON 10
ci_012                -9.103930e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111445e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111010e-03 3 1  ON 17
ci_019                 9.004849e-03 3 1  ON 18
ci_020                 1.503806e-02 3 1  ON 19
ci_021                 1.520092e-02 3 1  ON 20
ci_022                 8.269285e-03 3 1  ON 21
ci_023                 8.255000e-03 3 1  ON 22
ci_024                 8.343659e-03 3 1  ON 23
ci_025                 8.422060e-03 3 1  ON 24
ci_026                 9.909784e-03 3 1  ON 25
ci_027                 9.698730e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758310e-03 3 1  ON 29
ci_031                -8.616196e-03 3 1  ON 30
ci_032                -1.432817e-02 3 1  ON 31
ci_033                 4.550080e-03 3 1  ON 32
ci_034                 4.843631e-03 3 1  ON 33
ci_035                -3.333287e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698302e-04 3 1  ON 37
ci_039                 1.141805e-03 3 1  ON 38
ci_040                -1.556567e-03 3 1  ON 39
ci_041                 8.162408e-03 3 1  ON 40
ci_042                 8.161303e-03 3 1  ON 41
ci_043                -2.343171e-03 3 1  ON 42
ci_044                -3.909898e-03 3 1  ON 43
ci_045                -1.989964e-03 3 1  ON 44
ci_046                 4.787335e-03 3 1  ON 45
ci_047                 4.610918e-03 3 1  ON 46
ci_048                -1.238388e-02 3 1  ON 47
ci_049                -1.295391e-02 3 1  ON 48
ci_050                 2.844899e-03 3 1  ON 49
ci_051                 2.987767e-03 3 1  ON 50
ci_052                -2.169812e-03 3 1  ON 51
ci_053                -2.204224e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424950e-03 3 1  ON 54
ci_056                 4.623345e-03 3 1  ON 55
ci_057                 4.637314e-03 3 1  ON 56
ci_058                -2.068441e-03 3 1  ON 57
ci_059                -2.051532e-03 3 1  ON 58
ci_060                 4.761572e-03 3 1  ON 59
ci_061                 5.208229e-03 3 1  ON 60
ci_062                -2.956688e-03 3 1  ON 61
ci_063                -2.806837e-03 3 1  ON 62
ci_064                -2.259152e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061277e-03 3 1  ON 65
ci_067                 4.229749e-03 3 1  ON 66
ci_068                -4.276383e-03 3 1  ON 67
ci_069                -4.116024e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9405e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1636
    reference variance = 0.181177
====================================================
  Execution time = 1.4115e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9683e-01
  Total weights = 1.957659229e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5061e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284916589946
                                         uncertainty =       0.001396361635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284916589946
                                         uncertainty =       0.001396361635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377471155
  error estimate for blocks of size 2^( 2) =       0.000388890103
  error estimate for blocks of size 2^( 3) =       0.000399517303
  error estimate for blocks of size 2^( 4) =       0.000407140641
  error estimate for blocks of size 2^( 5) =       0.000411521571
  error estimate for blocks of size 2^( 6) =       0.000415837839
  error estimate for blocks of size 2^( 7) =       0.000417669035

      target function =      -0.917617966092
              le_mean =     -17.214598812056
             les_mean =     296.639242366629
             stat err =       0.000413042272
             autocorr =       1.197350943501
   target nu stat err =       0.000413042272
   target dn stat err =       0.002062181210
      target stat err =       0.003311483275
              std dev =       0.533824827005
             le_variance =       0.284968945927


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721459881206e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917629095703       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917629096509       residual = 4.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917629096617       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917629096647       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917629096650       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917629096669       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917629096649       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917629096649       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917629096656       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+04 is 3.891879e-09

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917629095703       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917629095904       residual = 4.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917629095931       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917629095952       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917629095932       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917629095846       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917629095742       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917629096067       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917629096058       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+04 is 9.729716e-10

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917629095703       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917629095753       residual = 4.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917629095760       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917629095742       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917629095758       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917629095997       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917629096120       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917629095818       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917629095586       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+05 is 2.432430e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205025 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6630e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770724e-03 3 1  ON 7
ci_009                -1.388527e-02 3 1  ON 8
ci_010                -8.841366e-03 3 1  ON 9
ci_011                -8.956774e-03 3 1  ON 10
ci_012                -9.103930e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111445e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111010e-03 3 1  ON 17
ci_019                 9.004849e-03 3 1  ON 18
ci_020                 1.503806e-02 3 1  ON 19
ci_021                 1.520092e-02 3 1  ON 20
ci_022                 8.269284e-03 3 1  ON 21
ci_023                 8.255000e-03 3 1  ON 22
ci_024                 8.343660e-03 3 1  ON 23
ci_025                 8.422060e-03 3 1  ON 24
ci_026                 9.909784e-03 3 1  ON 25
ci_027                 9.698730e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758310e-03 3 1  ON 29
ci_031                -8.616196e-03 3 1  ON 30
ci_032                -1.432817e-02 3 1  ON 31
ci_033                 4.550081e-03 3 1  ON 32
ci_034                 4.843631e-03 3 1  ON 33
ci_035                -3.333287e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698301e-04 3 1  ON 37
ci_039                 1.141805e-03 3 1  ON 38
ci_040                -1.556567e-03 3 1  ON 39
ci_041                 8.162409e-03 3 1  ON 40
ci_042                 8.161303e-03 3 1  ON 41
ci_043                -2.343170e-03 3 1  ON 42
ci_044                -3.909898e-03 3 1  ON 43
ci_045                -1.989964e-03 3 1  ON 44
ci_046                 4.787335e-03 3 1  ON 45
ci_047                 4.610918e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295391e-02 3 1  ON 48
ci_050                 2.844899e-03 3 1  ON 49
ci_051                 2.987767e-03 3 1  ON 50
ci_052                -2.169812e-03 3 1  ON 51
ci_053                -2.204224e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424950e-03 3 1  ON 54
ci_056                 4.623345e-03 3 1  ON 55
ci_057                 4.637315e-03 3 1  ON 56
ci_058                -2.068441e-03 3 1  ON 57
ci_059                -2.051533e-03 3 1  ON 58
ci_060                 4.761572e-03 3 1  ON 59
ci_061                 5.208230e-03 3 1  ON 60
ci_062                -2.956688e-03 3 1  ON 61
ci_063                -2.806836e-03 3 1  ON 62
ci_064                -2.259152e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061277e-03 3 1  ON 65
ci_067                 4.229748e-03 3 1  ON 66
ci_068                -4.276382e-03 3 1  ON 67
ci_069                -4.116024e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2386
    reference variance = 0.25653
====================================================
  Execution time = 1.3435e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0359e-01
  Total weights = 1.9578e+06
  Execution time = 1.8155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288445095139
                                         uncertainty =       0.001948259848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288445095139
                                         uncertainty =       0.001948259848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379789325
  error estimate for blocks of size 2^( 2) =       0.000391160907
  error estimate for blocks of size 2^( 3) =       0.000401521763
  error estimate for blocks of size 2^( 4) =       0.000409823912
  error estimate for blocks of size 2^( 5) =       0.000414848945
  error estimate for blocks of size 2^( 6) =       0.000417754912
  error estimate for blocks of size 2^( 7) =       0.000420710178

      target function =      -0.907115949868
              le_mean =     -17.214453383374
             les_mean =     296.640999550905
             stat err =       0.000415784487
             autocorr =       1.198535922410
   target nu stat err =       0.000415784487
   target dn stat err =       0.003351416340
      target stat err =       0.005184822893
              std dev =       0.537103214751
             le_variance =       0.288479863296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288445094943
                                         uncertainty =       0.001948259833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288445094943
                                         uncertainty =       0.001948259833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379789325
  error estimate for blocks of size 2^( 2) =       0.000391160907
  error estimate for blocks of size 2^( 3) =       0.000401521763
  error estimate for blocks of size 2^( 4) =       0.000409823912
  error estimate for blocks of size 2^( 5) =       0.000414848944
  error estimate for blocks of size 2^( 6) =       0.000417754911
  error estimate for blocks of size 2^( 7) =       0.000420710178

      target function =      -0.907115951091
              le_mean =     -17.214453383396
             les_mean =     296.640999550849
             stat err =       0.000415784486
             autocorr =       1.198535920206
   target nu stat err =       0.000415784486
   target dn stat err =       0.003351416180
      target stat err =       0.005184822663
              std dev =       0.537103214565
             le_variance =       0.288479863096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288445095041
                                         uncertainty =       0.001948259841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288445095041
                                         uncertainty =       0.001948259841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379789325
  error estimate for blocks of size 2^( 2) =       0.000391160907
  error estimate for blocks of size 2^( 3) =       0.000401521763
  error estimate for blocks of size 2^( 4) =       0.000409823912
  error estimate for blocks of size 2^( 5) =       0.000414848945
  error estimate for blocks of size 2^( 6) =       0.000417754912
  error estimate for blocks of size 2^( 7) =       0.000420710178

      target function =      -0.907115950480
              le_mean =     -17.214453383385
             les_mean =     296.640999550877
             stat err =       0.000415784487
             autocorr =       1.198535921309
   target nu stat err =       0.000415784487
   target dn stat err =       0.003351416260
      target stat err =       0.005184822778
              std dev =       0.537103214658
             le_variance =       0.288479863196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288445095126
                                         uncertainty =       0.001948259847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288445095126
                                         uncertainty =       0.001948259847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379789325
  error estimate for blocks of size 2^( 2) =       0.000391160907
  error estimate for blocks of size 2^( 3) =       0.000401521763
  error estimate for blocks of size 2^( 4) =       0.000409823912
  error estimate for blocks of size 2^( 5) =       0.000414848945
  error estimate for blocks of size 2^( 6) =       0.000417754912
  error estimate for blocks of size 2^( 7) =       0.000420710178

      target function =      -0.907115949945
              le_mean =     -17.214453383376
             les_mean =     296.640999550902
             stat err =       0.000415784487
             autocorr =       1.198535922276
   target nu stat err =       0.000415784487
   target dn stat err =       0.003351416330
      target stat err =       0.005184822878
              std dev =       0.537103214739
             le_variance =       0.288479863283


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.907115949868        initial
     2.4414e+04     2.4414e+05             3.8919e-09        -0.907115951091  <--
     9.7656e+04     9.7656e+05             9.7297e-10        -0.907115950480
     3.9062e+05     3.9062e+06             2.4324e-10        -0.907115949945

*****************************************************************************
Applying the update for shift_i =   2.4414e+04     and shift_s =   2.4414e+05
*****************************************************************************

  Execution time = 2.2614e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770723e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841368e-03 3 1  ON 9
ci_011                -8.956775e-03 3 1  ON 10
ci_012                -9.103930e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111445e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111010e-03 3 1  ON 17
ci_019                 9.004851e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520092e-02 3 1  ON 20
ci_022                 8.269284e-03 3 1  ON 21
ci_023                 8.254999e-03 3 1  ON 22
ci_024                 8.343661e-03 3 1  ON 23
ci_025                 8.422062e-03 3 1  ON 24
ci_026                 9.909784e-03 3 1  ON 25
ci_027                 9.698730e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758309e-03 3 1  ON 29
ci_031                -8.616195e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550082e-03 3 1  ON 32
ci_034                 4.843631e-03 3 1  ON 33
ci_035                -3.333287e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698298e-04 3 1  ON 37
ci_039                 1.141804e-03 3 1  ON 38
ci_040                -1.556566e-03 3 1  ON 39
ci_041                 8.162410e-03 3 1  ON 40
ci_042                 8.161305e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909900e-03 3 1  ON 43
ci_045                -1.989963e-03 3 1  ON 44
ci_046                 4.787336e-03 3 1  ON 45
ci_047                 4.610918e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844899e-03 3 1  ON 49
ci_051                 2.987767e-03 3 1  ON 50
ci_052                -2.169814e-03 3 1  ON 51
ci_053                -2.204225e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424950e-03 3 1  ON 54
ci_056                 4.623346e-03 3 1  ON 55
ci_057                 4.637316e-03 3 1  ON 56
ci_058                -2.068442e-03 3 1  ON 57
ci_059                -2.051535e-03 3 1  ON 58
ci_060                 4.761572e-03 3 1  ON 59
ci_061                 5.208232e-03 3 1  ON 60
ci_062                -2.956688e-03 3 1  ON 61
ci_063                -2.806836e-03 3 1  ON 62
ci_064                -2.259152e-03 3 1  ON 63
ci_065                -3.384067e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229748e-03 3 1  ON 66
ci_068                -4.276381e-03 3 1  ON 67
ci_069                -4.116024e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9255e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.168
    reference variance = 0.47376
====================================================
  Execution time = 1.3716e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0036e-01
  Total weights = 1.957760361e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4716e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287355172354
                                         uncertainty =       0.001776567356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287355172354
                                         uncertainty =       0.001776567356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379087348
  error estimate for blocks of size 2^( 2) =       0.000390977952
  error estimate for blocks of size 2^( 3) =       0.000401290384
  error estimate for blocks of size 2^( 4) =       0.000409519016
  error estimate for blocks of size 2^( 5) =       0.000413852099
  error estimate for blocks of size 2^( 6) =       0.000416778166
  error estimate for blocks of size 2^( 7) =       0.000418795339

      target function =      -0.912096945743
              le_mean =     -17.214877660743
             les_mean =     296.652372715267
             stat err =       0.000414736155
             autocorr =       1.196920248376
   target nu stat err =       0.000414736155
   target dn stat err =       0.002602375680
      target stat err =       0.004097094689
              std dev =       0.536110468674
             le_variance =       0.287414434621


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721487766074e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912114493234       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912114501208       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912114502212       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912114502533       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912114502595       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912114502611       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912114502604       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912114502608       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912114502603       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912114502599       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+03 is 2.243927e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912114493234       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912114495227       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912114495478       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912114495559       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912114495588       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912114495573       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912114495631       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912114495545       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912114495610       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912114495592       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+04 is 5.609868e-09

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912114493234       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912114493732       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912114493795       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912114493815       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912114493819       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912114493818       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912114493832       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912114493994       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912114493978       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912114493565       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+04 is 1.402470e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213354 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6205e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362204e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127884e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770723e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841366e-03 3 1  ON 9
ci_011                -8.956775e-03 3 1  ON 10
ci_012                -9.103925e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111445e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111013e-03 3 1  ON 17
ci_019                 9.004852e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269281e-03 3 1  ON 21
ci_023                 8.254995e-03 3 1  ON 22
ci_024                 8.343655e-03 3 1  ON 23
ci_025                 8.422062e-03 3 1  ON 24
ci_026                 9.909789e-03 3 1  ON 25
ci_027                 9.698730e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758308e-03 3 1  ON 29
ci_031                -8.616193e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550084e-03 3 1  ON 32
ci_034                 4.843629e-03 3 1  ON 33
ci_035                -3.333286e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698283e-04 3 1  ON 37
ci_039                 1.141802e-03 3 1  ON 38
ci_040                -1.556568e-03 3 1  ON 39
ci_041                 8.162409e-03 3 1  ON 40
ci_042                 8.161307e-03 3 1  ON 41
ci_043                -2.343168e-03 3 1  ON 42
ci_044                -3.909900e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787334e-03 3 1  ON 45
ci_047                 4.610917e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844897e-03 3 1  ON 49
ci_051                 2.987766e-03 3 1  ON 50
ci_052                -2.169812e-03 3 1  ON 51
ci_053                -2.204227e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424950e-03 3 1  ON 54
ci_056                 4.623345e-03 3 1  ON 55
ci_057                 4.637313e-03 3 1  ON 56
ci_058                -2.068443e-03 3 1  ON 57
ci_059                -2.051537e-03 3 1  ON 58
ci_060                 4.761572e-03 3 1  ON 59
ci_061                 5.208232e-03 3 1  ON 60
ci_062                -2.956689e-03 3 1  ON 61
ci_063                -2.806835e-03 3 1  ON 62
ci_064                -2.259151e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229746e-03 3 1  ON 66
ci_068                -4.276380e-03 3 1  ON 67
ci_069                -4.116027e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1433
    reference variance = 0.175526
====================================================
  Execution time = 1.3588e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0041e-01
  Total weights = 1.9576e+06
  Execution time = 1.8234e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286083413476
                                         uncertainty =       0.001626893168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286083413476
                                         uncertainty =       0.001626893168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378217640
  error estimate for blocks of size 2^( 2) =       0.000389922275
  error estimate for blocks of size 2^( 3) =       0.000400272075
  error estimate for blocks of size 2^( 4) =       0.000407169400
  error estimate for blocks of size 2^( 5) =       0.000411095554
  error estimate for blocks of size 2^( 6) =       0.000414886883
  error estimate for blocks of size 2^( 7) =       0.000416518907

      target function =      -0.912043223167
              le_mean =     -17.214145112368
             les_mean =     296.627205338131
             stat err =       0.000412417686
             autocorr =       1.189025042728
   target nu stat err =       0.000412417686
   target dn stat err =       0.002347077402
      target stat err =       0.003701450158
              std dev =       0.534880516177
             le_variance =       0.286097166586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286083411361
                                         uncertainty =       0.001626893233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286083411361
                                         uncertainty =       0.001626893233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378217639
  error estimate for blocks of size 2^( 2) =       0.000389922275
  error estimate for blocks of size 2^( 3) =       0.000400272075
  error estimate for blocks of size 2^( 4) =       0.000407169402
  error estimate for blocks of size 2^( 5) =       0.000411095556
  error estimate for blocks of size 2^( 6) =       0.000414886885
  error estimate for blocks of size 2^( 7) =       0.000416518910

      target function =      -0.912043195098
              le_mean =     -17.214145112173
             les_mean =     296.627205349550
             stat err =       0.000412417688
             autocorr =       1.189025063363
   target nu stat err =       0.000412417688
   target dn stat err =       0.002347076376
      target stat err =       0.003701448373
              std dev =       0.534880514232
             le_variance =       0.286097164505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286083412418
                                         uncertainty =       0.001626893201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286083412418
                                         uncertainty =       0.001626893201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378217639
  error estimate for blocks of size 2^( 2) =       0.000389922275
  error estimate for blocks of size 2^( 3) =       0.000400272075
  error estimate for blocks of size 2^( 4) =       0.000407169401
  error estimate for blocks of size 2^( 5) =       0.000411095555
  error estimate for blocks of size 2^( 6) =       0.000414886884
  error estimate for blocks of size 2^( 7) =       0.000416518909

      target function =      -0.912043209143
              le_mean =     -17.214145112271
             les_mean =     296.627205343834
             stat err =       0.000412417687
             autocorr =       1.189025053052
   target nu stat err =       0.000412417687
   target dn stat err =       0.002347076888
      target stat err =       0.003701449265
              std dev =       0.534880515205
             le_variance =       0.286097165546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286083413343
                                         uncertainty =       0.001626893172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286083413343
                                         uncertainty =       0.001626893172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378217640
  error estimate for blocks of size 2^( 2) =       0.000389922275
  error estimate for blocks of size 2^( 3) =       0.000400272075
  error estimate for blocks of size 2^( 4) =       0.000407169400
  error estimate for blocks of size 2^( 5) =       0.000411095554
  error estimate for blocks of size 2^( 6) =       0.000414886883
  error estimate for blocks of size 2^( 7) =       0.000416518908

      target function =      -0.912043221415
              le_mean =     -17.214145112356
             les_mean =     296.627205338843
             stat err =       0.000412417686
             autocorr =       1.189025044017
   target nu stat err =       0.000412417686
   target dn stat err =       0.002347077338
      target stat err =       0.003701450046
              std dev =       0.534880516056
             le_variance =       0.286097166456


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912043223167        initial  <--
     6.1035e+03     6.1035e+04             2.2439e-08        -0.912043195098
     2.4414e+04     2.4414e+05             5.6099e-09        -0.912043209143
     9.7656e+04     9.7656e+05             1.4025e-09        -0.912043221415

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8064
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770723e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841368e-03 3 1  ON 9
ci_011                -8.956775e-03 3 1  ON 10
ci_012                -9.103930e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111445e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111010e-03 3 1  ON 17
ci_019                 9.004851e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520092e-02 3 1  ON 20
ci_022                 8.269284e-03 3 1  ON 21
ci_023                 8.254999e-03 3 1  ON 22
ci_024                 8.343661e-03 3 1  ON 23
ci_025                 8.422062e-03 3 1  ON 24
ci_026                 9.909784e-03 3 1  ON 25
ci_027                 9.698730e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758309e-03 3 1  ON 29
ci_031                -8.616195e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550082e-03 3 1  ON 32
ci_034                 4.843631e-03 3 1  ON 33
ci_035                -3.333287e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698298e-04 3 1  ON 37
ci_039                 1.141804e-03 3 1  ON 38
ci_040                -1.556566e-03 3 1  ON 39
ci_041                 8.162410e-03 3 1  ON 40
ci_042                 8.161305e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909900e-03 3 1  ON 43
ci_045                -1.989963e-03 3 1  ON 44
ci_046                 4.787336e-03 3 1  ON 45
ci_047                 4.610918e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844899e-03 3 1  ON 49
ci_051                 2.987767e-03 3 1  ON 50
ci_052                -2.169814e-03 3 1  ON 51
ci_053                -2.204225e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424950e-03 3 1  ON 54
ci_056                 4.623346e-03 3 1  ON 55
ci_057                 4.637316e-03 3 1  ON 56
ci_058                -2.068442e-03 3 1  ON 57
ci_059                -2.051535e-03 3 1  ON 58
ci_060                 4.761572e-03 3 1  ON 59
ci_061                 5.208232e-03 3 1  ON 60
ci_062                -2.956688e-03 3 1  ON 61
ci_063                -2.806836e-03 3 1  ON 62
ci_064                -2.259152e-03 3 1  ON 63
ci_065                -3.384067e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229748e-03 3 1  ON 66
ci_068                -4.276381e-03 3 1  ON 67
ci_069                -4.116024e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9028e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.162
    reference variance = 0.177168
====================================================
  Execution time = 1.4189e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0042e-01
  Total weights = 1.957627568e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.9174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286999369254
                                         uncertainty =       0.001588259369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286999369254
                                         uncertainty =       0.001588259369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378802675
  error estimate for blocks of size 2^( 2) =       0.000390404537
  error estimate for blocks of size 2^( 3) =       0.000400897219
  error estimate for blocks of size 2^( 4) =       0.000408958960
  error estimate for blocks of size 2^( 5) =       0.000414875702
  error estimate for blocks of size 2^( 6) =       0.000416813932
  error estimate for blocks of size 2^( 7) =       0.000416729692

      target function =      -0.912019132713
              le_mean =     -17.214586297353
             les_mean =     296.642398767130
             stat err =       0.000414344572
             autocorr =       1.196457378307
   target nu stat err =       0.000414344572
   target dn stat err =       0.002539629711
      target stat err =       0.003998306149
              std dev =       0.535707880510
             le_variance =       0.286982933240


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721458629735e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912035790916       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912035791722       residual = 8.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912035791793       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912035791801       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912035791882       residual = 9.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912035791843       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912035791725       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912035791774       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912035791743       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912035791856       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+04 is 2.349759e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912035790916       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912035791117       residual = 8.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912035791135       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912035791137       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912035790953       residual = 9.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912035791241       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912035790569       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912035791143       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912035791278       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912035791188       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+05 is 5.874403e-10

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912035790916       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912035790966       residual = 8.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912035790971       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912035790971       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912035790343       residual = 9.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912035790304       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912035790825       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912035790991       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912035791024       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912035790920       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+05 is 1.468601e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216886 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8287e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770723e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841368e-03 3 1  ON 9
ci_011                -8.956775e-03 3 1  ON 10
ci_012                -9.103929e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111445e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111010e-03 3 1  ON 17
ci_019                 9.004850e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520092e-02 3 1  ON 20
ci_022                 8.269284e-03 3 1  ON 21
ci_023                 8.254999e-03 3 1  ON 22
ci_024                 8.343660e-03 3 1  ON 23
ci_025                 8.422061e-03 3 1  ON 24
ci_026                 9.909784e-03 3 1  ON 25
ci_027                 9.698729e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758309e-03 3 1  ON 29
ci_031                -8.616195e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550082e-03 3 1  ON 32
ci_034                 4.843631e-03 3 1  ON 33
ci_035                -3.333287e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698297e-04 3 1  ON 37
ci_039                 1.141804e-03 3 1  ON 38
ci_040                -1.556566e-03 3 1  ON 39
ci_041                 8.162410e-03 3 1  ON 40
ci_042                 8.161305e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909899e-03 3 1  ON 43
ci_045                -1.989963e-03 3 1  ON 44
ci_046                 4.787336e-03 3 1  ON 45
ci_047                 4.610918e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844899e-03 3 1  ON 49
ci_051                 2.987767e-03 3 1  ON 50
ci_052                -2.169814e-03 3 1  ON 51
ci_053                -2.204226e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424950e-03 3 1  ON 54
ci_056                 4.623346e-03 3 1  ON 55
ci_057                 4.637315e-03 3 1  ON 56
ci_058                -2.068442e-03 3 1  ON 57
ci_059                -2.051534e-03 3 1  ON 58
ci_060                 4.761572e-03 3 1  ON 59
ci_061                 5.208232e-03 3 1  ON 60
ci_062                -2.956688e-03 3 1  ON 61
ci_063                -2.806836e-03 3 1  ON 62
ci_064                -2.259152e-03 3 1  ON 63
ci_065                -3.384067e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229747e-03 3 1  ON 66
ci_068                -4.276381e-03 3 1  ON 67
ci_069                -4.116023e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2274
    reference variance = 0.220808
====================================================
  Execution time = 1.3786e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9734e-01
  Total weights = 1.9578e+06
  Execution time = 1.8086e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283998826162
                                         uncertainty =       0.001683984277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283998826162
                                         uncertainty =       0.001683984277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376783960
  error estimate for blocks of size 2^( 2) =       0.000388235935
  error estimate for blocks of size 2^( 3) =       0.000398583215
  error estimate for blocks of size 2^( 4) =       0.000406274131
  error estimate for blocks of size 2^( 5) =       0.000411035403
  error estimate for blocks of size 2^( 6) =       0.000414073101
  error estimate for blocks of size 2^( 7) =       0.000414482231

      target function =      -0.916810093168
              le_mean =     -17.214454023236
             les_mean =     296.634770583616
             stat err =       0.000411466216
             autocorr =       1.192569102188
   target nu stat err =       0.000411466216
   target dn stat err =       0.002655347332
      target stat err =       0.004216457891
              std dev =       0.532852986730
             le_variance =       0.283932305467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283998825850
                                         uncertainty =       0.001683984285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283998825850
                                         uncertainty =       0.001683984285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376783960
  error estimate for blocks of size 2^( 2) =       0.000388235935
  error estimate for blocks of size 2^( 3) =       0.000398583215
  error estimate for blocks of size 2^( 4) =       0.000406274131
  error estimate for blocks of size 2^( 5) =       0.000411035403
  error estimate for blocks of size 2^( 6) =       0.000414073101
  error estimate for blocks of size 2^( 7) =       0.000414482231

      target function =      -0.916810100805
              le_mean =     -17.214454023253
             les_mean =     296.634770579321
             stat err =       0.000411466217
             autocorr =       1.192569104313
   target nu stat err =       0.000411466217
   target dn stat err =       0.002655345841
      target stat err =       0.004216455658
              std dev =       0.532852986437
             le_variance =       0.283932305155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283998826006
                                         uncertainty =       0.001683984281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283998826006
                                         uncertainty =       0.001683984281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376783960
  error estimate for blocks of size 2^( 2) =       0.000388235935
  error estimate for blocks of size 2^( 3) =       0.000398583215
  error estimate for blocks of size 2^( 4) =       0.000406274131
  error estimate for blocks of size 2^( 5) =       0.000411035403
  error estimate for blocks of size 2^( 6) =       0.000414073101
  error estimate for blocks of size 2^( 7) =       0.000414482231

      target function =      -0.916810096987
              le_mean =     -17.214454023245
             les_mean =     296.634770581468
             stat err =       0.000411466217
             autocorr =       1.192569103247
   target nu stat err =       0.000411466217
   target dn stat err =       0.002655346587
      target stat err =       0.004216456774
              std dev =       0.532852986583
             le_variance =       0.283932305311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283998826142
                                         uncertainty =       0.001683984278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283998826142
                                         uncertainty =       0.001683984278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376783960
  error estimate for blocks of size 2^( 2) =       0.000388235935
  error estimate for blocks of size 2^( 3) =       0.000398583215
  error estimate for blocks of size 2^( 4) =       0.000406274131
  error estimate for blocks of size 2^( 5) =       0.000411035403
  error estimate for blocks of size 2^( 6) =       0.000414073101
  error estimate for blocks of size 2^( 7) =       0.000414482231

      target function =      -0.916810093646
              le_mean =     -17.214454023237
             les_mean =     296.634770583348
             stat err =       0.000411466216
             autocorr =       1.192569102322
   target nu stat err =       0.000411466216
   target dn stat err =       0.002655347239
      target stat err =       0.004216457751
              std dev =       0.532852986711
             le_variance =       0.283932305447


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916810093168        initial
     6.1035e+04     6.1035e+05             2.3498e-09        -0.916810100805  <--
     2.4414e+05     2.4414e+06             5.8744e-10        -0.916810096987
     9.7656e+05     9.7656e+06             1.4686e-10        -0.916810093646

*****************************************************************************
Applying the update for shift_i =   6.1035e+04     and shift_s =   6.1035e+05
*****************************************************************************

  Execution time = 2.2948e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770723e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841367e-03 3 1  ON 9
ci_011                -8.956775e-03 3 1  ON 10
ci_012                -9.103929e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111011e-03 3 1  ON 17
ci_019                 9.004850e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520092e-02 3 1  ON 20
ci_022                 8.269284e-03 3 1  ON 21
ci_023                 8.254999e-03 3 1  ON 22
ci_024                 8.343658e-03 3 1  ON 23
ci_025                 8.422061e-03 3 1  ON 24
ci_026                 9.909784e-03 3 1  ON 25
ci_027                 9.698729e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758308e-03 3 1  ON 29
ci_031                -8.616197e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550082e-03 3 1  ON 32
ci_034                 4.843630e-03 3 1  ON 33
ci_035                -3.333287e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698295e-04 3 1  ON 37
ci_039                 1.141804e-03 3 1  ON 38
ci_040                -1.556566e-03 3 1  ON 39
ci_041                 8.162410e-03 3 1  ON 40
ci_042                 8.161303e-03 3 1  ON 41
ci_043                -2.343170e-03 3 1  ON 42
ci_044                -3.909899e-03 3 1  ON 43
ci_045                -1.989963e-03 3 1  ON 44
ci_046                 4.787335e-03 3 1  ON 45
ci_047                 4.610917e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844899e-03 3 1  ON 49
ci_051                 2.987766e-03 3 1  ON 50
ci_052                -2.169814e-03 3 1  ON 51
ci_053                -2.204226e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424950e-03 3 1  ON 54
ci_056                 4.623346e-03 3 1  ON 55
ci_057                 4.637315e-03 3 1  ON 56
ci_058                -2.068442e-03 3 1  ON 57
ci_059                -2.051534e-03 3 1  ON 58
ci_060                 4.761570e-03 3 1  ON 59
ci_061                 5.208232e-03 3 1  ON 60
ci_062                -2.956689e-03 3 1  ON 61
ci_063                -2.806836e-03 3 1  ON 62
ci_064                -2.259152e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229747e-03 3 1  ON 66
ci_068                -4.276381e-03 3 1  ON 67
ci_069                -4.116022e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1240e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2061
    reference variance = 0.148656
====================================================
  Execution time = 1.3868e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9927e-01
  Total weights = 1.957897818e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5088e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287400565236
                                         uncertainty =       0.001810843529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287400565236
                                         uncertainty =       0.001810843529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379070091
  error estimate for blocks of size 2^( 2) =       0.000390650349
  error estimate for blocks of size 2^( 3) =       0.000401467042
  error estimate for blocks of size 2^( 4) =       0.000409154851
  error estimate for blocks of size 2^( 5) =       0.000412949348
  error estimate for blocks of size 2^( 6) =       0.000415801484
  error estimate for blocks of size 2^( 7) =       0.000416487424

      target function =      -0.913787829848
              le_mean =     -17.215021579463
             les_mean =     296.656239660268
             stat err =       0.000413598277
             autocorr =       1.190469854698
   target nu stat err =       0.000413598277
   target dn stat err =       0.002214430514
      target stat err =       0.003519234543
              std dev =       0.536086063472
             le_variance =       0.287388267449


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721502157946e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913800413388       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913800416117       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913800416492       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913800416604       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913800416630       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913800416608       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913800416626       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913800416629       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913800416618       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913800416602       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+04 is 1.006549e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913800413388       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913800414070       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913800414164       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913800414177       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913800414183       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913800414043       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913800414137       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913800414156       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913800414205       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913800414220       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+04 is 2.516380e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913800413388       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913800413558       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913800413582       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913800413589       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913800414070       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913800413263       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913800413946       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913800413923       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913800413506       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913800413334       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+05 is 6.290956e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.220386 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6386e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770723e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841367e-03 3 1  ON 9
ci_011                -8.956776e-03 3 1  ON 10
ci_012                -9.103929e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111011e-03 3 1  ON 17
ci_019                 9.004851e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520092e-02 3 1  ON 20
ci_022                 8.269284e-03 3 1  ON 21
ci_023                 8.254998e-03 3 1  ON 22
ci_024                 8.343659e-03 3 1  ON 23
ci_025                 8.422060e-03 3 1  ON 24
ci_026                 9.909784e-03 3 1  ON 25
ci_027                 9.698727e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758308e-03 3 1  ON 29
ci_031                -8.616197e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550082e-03 3 1  ON 32
ci_034                 4.843630e-03 3 1  ON 33
ci_035                -3.333286e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698293e-04 3 1  ON 37
ci_039                 1.141804e-03 3 1  ON 38
ci_040                -1.556566e-03 3 1  ON 39
ci_041                 8.162410e-03 3 1  ON 40
ci_042                 8.161303e-03 3 1  ON 41
ci_043                -2.343170e-03 3 1  ON 42
ci_044                -3.909897e-03 3 1  ON 43
ci_045                -1.989963e-03 3 1  ON 44
ci_046                 4.787334e-03 3 1  ON 45
ci_047                 4.610917e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844900e-03 3 1  ON 49
ci_051                 2.987765e-03 3 1  ON 50
ci_052                -2.169812e-03 3 1  ON 51
ci_053                -2.204228e-03 3 1  ON 52
ci_054                -2.206781e-03 3 1  ON 53
ci_055                -2.424950e-03 3 1  ON 54
ci_056                 4.623347e-03 3 1  ON 55
ci_057                 4.637315e-03 3 1  ON 56
ci_058                -2.068442e-03 3 1  ON 57
ci_059                -2.051535e-03 3 1  ON 58
ci_060                 4.761569e-03 3 1  ON 59
ci_061                 5.208230e-03 3 1  ON 60
ci_062                -2.956688e-03 3 1  ON 61
ci_063                -2.806837e-03 3 1  ON 62
ci_064                -2.259151e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061277e-03 3 1  ON 65
ci_067                 4.229747e-03 3 1  ON 66
ci_068                -4.276381e-03 3 1  ON 67
ci_069                -4.116022e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.3074
    reference variance = 0.887042
====================================================
  Execution time = 1.3585e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0280e-01
  Total weights = 1.9577e+06
  Execution time = 1.8208e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286859933015
                                         uncertainty =       0.001577871499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286859933015
                                         uncertainty =       0.001577871499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378987002
  error estimate for blocks of size 2^( 2) =       0.000390327793
  error estimate for blocks of size 2^( 3) =       0.000401006295
  error estimate for blocks of size 2^( 4) =       0.000409063689
  error estimate for blocks of size 2^( 5) =       0.000413804448
  error estimate for blocks of size 2^( 6) =       0.000414043466
  error estimate for blocks of size 2^( 7) =       0.000417120403

      target function =      -0.908331451883
              le_mean =     -17.214858478889
             les_mean =     296.654148191946
             stat err =       0.000413508002
             autocorr =       1.190472052062
   target nu stat err =       0.000413508002
   target dn stat err =       0.002902949315
      target stat err =       0.004519432664
              std dev =       0.535968558637
             le_variance =       0.287262295848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286859934610
                                         uncertainty =       0.001577871609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286859934610
                                         uncertainty =       0.001577871609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378987003
  error estimate for blocks of size 2^( 2) =       0.000390327794
  error estimate for blocks of size 2^( 3) =       0.000401006297
  error estimate for blocks of size 2^( 4) =       0.000409063691
  error estimate for blocks of size 2^( 5) =       0.000413804450
  error estimate for blocks of size 2^( 6) =       0.000414043468
  error estimate for blocks of size 2^( 7) =       0.000417120405

      target function =      -0.908331444480
              le_mean =     -17.214858478968
             les_mean =     296.654148199477
             stat err =       0.000413508003
             autocorr =       1.190472056221
   target nu stat err =       0.000413508003
   target dn stat err =       0.002902949663
      target stat err =       0.004519433120
              std dev =       0.535968559987
             le_variance =       0.287262297294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286859933812
                                         uncertainty =       0.001577871554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286859933812
                                         uncertainty =       0.001577871554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378987003
  error estimate for blocks of size 2^( 2) =       0.000390327793
  error estimate for blocks of size 2^( 3) =       0.000401006296
  error estimate for blocks of size 2^( 4) =       0.000409063690
  error estimate for blocks of size 2^( 5) =       0.000413804449
  error estimate for blocks of size 2^( 6) =       0.000414043467
  error estimate for blocks of size 2^( 7) =       0.000417120404

      target function =      -0.908331448183
              le_mean =     -17.214858478928
             les_mean =     296.654148195711
             stat err =       0.000413508003
             autocorr =       1.190472054146
   target nu stat err =       0.000413508003
   target dn stat err =       0.002902949489
      target stat err =       0.004519432892
              std dev =       0.535968559312
             le_variance =       0.287262296571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286859933114
                                         uncertainty =       0.001577871506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286859933114
                                         uncertainty =       0.001577871506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378987002
  error estimate for blocks of size 2^( 2) =       0.000390327793
  error estimate for blocks of size 2^( 3) =       0.000401006295
  error estimate for blocks of size 2^( 4) =       0.000409063689
  error estimate for blocks of size 2^( 5) =       0.000413804448
  error estimate for blocks of size 2^( 6) =       0.000414043466
  error estimate for blocks of size 2^( 7) =       0.000417120404

      target function =      -0.908331451421
              le_mean =     -17.214858478894
             les_mean =     296.654148192417
             stat err =       0.000413508002
             autocorr =       1.190472052318
   target nu stat err =       0.000413508002
   target dn stat err =       0.002902949337
      target stat err =       0.004519432692
              std dev =       0.535968558721
             le_variance =       0.287262295938


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908331451883        initial  <--
     1.5259e+04     1.5259e+05             1.0065e-08        -0.908331444480
     6.1035e+04     6.1035e+05             2.5164e-09        -0.908331448183
     2.4414e+05     2.4414e+06             6.2910e-10        -0.908331451421

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7660
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770723e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841367e-03 3 1  ON 9
ci_011                -8.956775e-03 3 1  ON 10
ci_012                -9.103929e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111011e-03 3 1  ON 17
ci_019                 9.004850e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520092e-02 3 1  ON 20
ci_022                 8.269284e-03 3 1  ON 21
ci_023                 8.254999e-03 3 1  ON 22
ci_024                 8.343658e-03 3 1  ON 23
ci_025                 8.422061e-03 3 1  ON 24
ci_026                 9.909784e-03 3 1  ON 25
ci_027                 9.698729e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758308e-03 3 1  ON 29
ci_031                -8.616197e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550082e-03 3 1  ON 32
ci_034                 4.843630e-03 3 1  ON 33
ci_035                -3.333287e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698295e-04 3 1  ON 37
ci_039                 1.141804e-03 3 1  ON 38
ci_040                -1.556566e-03 3 1  ON 39
ci_041                 8.162410e-03 3 1  ON 40
ci_042                 8.161303e-03 3 1  ON 41
ci_043                -2.343170e-03 3 1  ON 42
ci_044                -3.909899e-03 3 1  ON 43
ci_045                -1.989963e-03 3 1  ON 44
ci_046                 4.787335e-03 3 1  ON 45
ci_047                 4.610917e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844899e-03 3 1  ON 49
ci_051                 2.987766e-03 3 1  ON 50
ci_052                -2.169814e-03 3 1  ON 51
ci_053                -2.204226e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424950e-03 3 1  ON 54
ci_056                 4.623346e-03 3 1  ON 55
ci_057                 4.637315e-03 3 1  ON 56
ci_058                -2.068442e-03 3 1  ON 57
ci_059                -2.051534e-03 3 1  ON 58
ci_060                 4.761570e-03 3 1  ON 59
ci_061                 5.208232e-03 3 1  ON 60
ci_062                -2.956689e-03 3 1  ON 61
ci_063                -2.806836e-03 3 1  ON 62
ci_064                -2.259152e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229747e-03 3 1  ON 66
ci_068                -4.276381e-03 3 1  ON 67
ci_069                -4.116022e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9159e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1875
    reference variance = 0.234083
====================================================
  Execution time = 1.3724e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9902e-01
  Total weights = 1.957525135e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4651e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284536150554
                                         uncertainty =       0.001799570882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284536150554
                                         uncertainty =       0.001799570882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377199151
  error estimate for blocks of size 2^( 2) =       0.000388493753
  error estimate for blocks of size 2^( 3) =       0.000398401547
  error estimate for blocks of size 2^( 4) =       0.000405979110
  error estimate for blocks of size 2^( 5) =       0.000411340158
  error estimate for blocks of size 2^( 6) =       0.000413308762
  error estimate for blocks of size 2^( 7) =       0.000415563233

      target function =      -0.914188625526
              le_mean =     -17.214807855625
             les_mean =     296.648625062647
             stat err =       0.000411547816
             autocorr =       1.190417186045
   target nu stat err =       0.000411547816
   target dn stat err =       0.002621447351
      target stat err =       0.004143442795
              std dev =       0.533440155528
             le_variance =       0.284558399529


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721480785563e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914206396033       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914206396411       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914206396459       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914206396475       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914206396578       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914206396293       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914206396224       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914206396565       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914206396381       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914206396291       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+05 is 1.161216e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914206396033       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914206396128       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914206396140       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914206395977       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914206396487       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914206395500       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914206396118       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914206396561       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914206396151       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914206396477       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+05 is 2.903041e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914206396033       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914206396057       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914206396060       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914206396060       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914206395093       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914206392041       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914206395379       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914206400452       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914206396358       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914206390227       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+06 is 7.257605e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.223818 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6199e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770723e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841367e-03 3 1  ON 9
ci_011                -8.956775e-03 3 1  ON 10
ci_012                -9.103929e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111010e-03 3 1  ON 17
ci_019                 9.004850e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520092e-02 3 1  ON 20
ci_022                 8.269284e-03 3 1  ON 21
ci_023                 8.254999e-03 3 1  ON 22
ci_024                 8.343658e-03 3 1  ON 23
ci_025                 8.422060e-03 3 1  ON 24
ci_026                 9.909784e-03 3 1  ON 25
ci_027                 9.698729e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758308e-03 3 1  ON 29
ci_031                -8.616197e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550082e-03 3 1  ON 32
ci_034                 4.843630e-03 3 1  ON 33
ci_035                -3.333287e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698295e-04 3 1  ON 37
ci_039                 1.141804e-03 3 1  ON 38
ci_040                -1.556566e-03 3 1  ON 39
ci_041                 8.162410e-03 3 1  ON 40
ci_042                 8.161303e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909899e-03 3 1  ON 43
ci_045                -1.989963e-03 3 1  ON 44
ci_046                 4.787335e-03 3 1  ON 45
ci_047                 4.610917e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844899e-03 3 1  ON 49
ci_051                 2.987766e-03 3 1  ON 50
ci_052                -2.169814e-03 3 1  ON 51
ci_053                -2.204226e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424950e-03 3 1  ON 54
ci_056                 4.623346e-03 3 1  ON 55
ci_057                 4.637315e-03 3 1  ON 56
ci_058                -2.068442e-03 3 1  ON 57
ci_059                -2.051534e-03 3 1  ON 58
ci_060                 4.761571e-03 3 1  ON 59
ci_061                 5.208232e-03 3 1  ON 60
ci_062                -2.956689e-03 3 1  ON 61
ci_063                -2.806836e-03 3 1  ON 62
ci_064                -2.259152e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229747e-03 3 1  ON 66
ci_068                -4.276381e-03 3 1  ON 67
ci_069                -4.116022e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2442
    reference variance = 0.169764
====================================================
  Execution time = 1.3454e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0150e-01
  Total weights = 1.9579e+06
  Execution time = 1.8252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287757243403
                                         uncertainty =       0.002014959867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287757243403
                                         uncertainty =       0.002014959867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379332547
  error estimate for blocks of size 2^( 2) =       0.000390551840
  error estimate for blocks of size 2^( 3) =       0.000401382799
  error estimate for blocks of size 2^( 4) =       0.000409291920
  error estimate for blocks of size 2^( 5) =       0.000414322852
  error estimate for blocks of size 2^( 6) =       0.000416355490
  error estimate for blocks of size 2^( 7) =       0.000419739365

      target function =      -0.910340897563
              le_mean =     -17.214276613995
             les_mean =     296.632822194091
             stat err =       0.000414927407
             autocorr =       1.196476100672
   target nu stat err =       0.000414927407
   target dn stat err =       0.003256588186
      target stat err =       0.005074528682
              std dev =       0.536457233259
             le_variance =       0.287786363116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287757243201
                                         uncertainty =       0.002014959836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287757243201
                                         uncertainty =       0.002014959836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379332547
  error estimate for blocks of size 2^( 2) =       0.000390551840
  error estimate for blocks of size 2^( 3) =       0.000401382799
  error estimate for blocks of size 2^( 4) =       0.000409291920
  error estimate for blocks of size 2^( 5) =       0.000414322852
  error estimate for blocks of size 2^( 6) =       0.000416355490
  error estimate for blocks of size 2^( 7) =       0.000419739365

      target function =      -0.910340897583
              le_mean =     -17.214276613989
             les_mean =     296.632822193861
             stat err =       0.000414927407
             autocorr =       1.196476101156
   target nu stat err =       0.000414927407
   target dn stat err =       0.003256588001
      target stat err =       0.005074528399
              std dev =       0.536457233073
             le_variance =       0.287786362916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287757243302
                                         uncertainty =       0.002014959851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287757243302
                                         uncertainty =       0.002014959851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379332547
  error estimate for blocks of size 2^( 2) =       0.000390551840
  error estimate for blocks of size 2^( 3) =       0.000401382799
  error estimate for blocks of size 2^( 4) =       0.000409291920
  error estimate for blocks of size 2^( 5) =       0.000414322852
  error estimate for blocks of size 2^( 6) =       0.000416355490
  error estimate for blocks of size 2^( 7) =       0.000419739365

      target function =      -0.910340897573
              le_mean =     -17.214276613992
             les_mean =     296.632822193976
             stat err =       0.000414927407
             autocorr =       1.196476100910
   target nu stat err =       0.000414927407
   target dn stat err =       0.003256588093
      target stat err =       0.005074528540
              std dev =       0.536457233166
             le_variance =       0.287786363016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287757243390
                                         uncertainty =       0.002014959865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287757243390
                                         uncertainty =       0.002014959865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379332547
  error estimate for blocks of size 2^( 2) =       0.000390551840
  error estimate for blocks of size 2^( 3) =       0.000401382799
  error estimate for blocks of size 2^( 4) =       0.000409291920
  error estimate for blocks of size 2^( 5) =       0.000414322852
  error estimate for blocks of size 2^( 6) =       0.000416355490
  error estimate for blocks of size 2^( 7) =       0.000419739365

      target function =      -0.910340897564
              le_mean =     -17.214276613995
             les_mean =     296.632822194077
             stat err =       0.000414927407
             autocorr =       1.196476100697
   target nu stat err =       0.000414927407
   target dn stat err =       0.003256588174
      target stat err =       0.005074528664
              std dev =       0.536457233248
             le_variance =       0.287786363104


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910340897563        initial
     1.5259e+05     1.5259e+06             1.1612e-09        -0.910340897583  <--
     6.1035e+05     6.1035e+06             2.9030e-10        -0.910340897573
     2.4414e+06     2.4414e+07             7.2576e-11        -0.910340897564

*****************************************************************************
Applying the update for shift_i =   1.5259e+05     and shift_s =   1.5259e+06
*****************************************************************************

  Execution time = 2.2658e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770723e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841367e-03 3 1  ON 9
ci_011                -8.956774e-03 3 1  ON 10
ci_012                -9.103928e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111010e-03 3 1  ON 17
ci_019                 9.004850e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520092e-02 3 1  ON 20
ci_022                 8.269284e-03 3 1  ON 21
ci_023                 8.254999e-03 3 1  ON 22
ci_024                 8.343658e-03 3 1  ON 23
ci_025                 8.422060e-03 3 1  ON 24
ci_026                 9.909783e-03 3 1  ON 25
ci_027                 9.698729e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758308e-03 3 1  ON 29
ci_031                -8.616197e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550082e-03 3 1  ON 32
ci_034                 4.843630e-03 3 1  ON 33
ci_035                -3.333287e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698294e-04 3 1  ON 37
ci_039                 1.141804e-03 3 1  ON 38
ci_040                -1.556566e-03 3 1  ON 39
ci_041                 8.162410e-03 3 1  ON 40
ci_042                 8.161303e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909899e-03 3 1  ON 43
ci_045                -1.989963e-03 3 1  ON 44
ci_046                 4.787335e-03 3 1  ON 45
ci_047                 4.610917e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844899e-03 3 1  ON 49
ci_051                 2.987767e-03 3 1  ON 50
ci_052                -2.169814e-03 3 1  ON 51
ci_053                -2.204227e-03 3 1  ON 52
ci_054                -2.206781e-03 3 1  ON 53
ci_055                -2.424950e-03 3 1  ON 54
ci_056                 4.623347e-03 3 1  ON 55
ci_057                 4.637315e-03 3 1  ON 56
ci_058                -2.068441e-03 3 1  ON 57
ci_059                -2.051534e-03 3 1  ON 58
ci_060                 4.761571e-03 3 1  ON 59
ci_061                 5.208232e-03 3 1  ON 60
ci_062                -2.956689e-03 3 1  ON 61
ci_063                -2.806835e-03 3 1  ON 62
ci_064                -2.259152e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229746e-03 3 1  ON 66
ci_068                -4.276382e-03 3 1  ON 67
ci_069                -4.116022e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8863e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1937
    reference variance = 0.599604
====================================================
  Execution time = 1.3844e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5317e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0394e-01
  Total weights = 1.957599565e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4934e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288322455911
                                         uncertainty =       0.001607061419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288322455911
                                         uncertainty =       0.001607061419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379650883
  error estimate for blocks of size 2^( 2) =       0.000391024392
  error estimate for blocks of size 2^( 3) =       0.000401012535
  error estimate for blocks of size 2^( 4) =       0.000408914594
  error estimate for blocks of size 2^( 5) =       0.000413091161
  error estimate for blocks of size 2^( 6) =       0.000415806032
  error estimate for blocks of size 2^( 7) =       0.000416711859

      target function =      -0.906571550048
              le_mean =     -17.214628273937
             les_mean =     296.647362810271
             stat err =       0.000413630911
             autocorr =       1.187017562351
   target nu stat err =       0.000413630911
   target dn stat err =       0.004018213887
      target stat err =       0.006193303336
              std dev =       0.536907428198
             le_variance =       0.288269586454


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721462827394e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906612855917       residual = 4.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906612859257       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906612859479       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906612859533       residual = 7.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906612859583       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906612859506       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906612859468       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906612859640       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906612859601       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906612859556       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+04 is 6.740053e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906612855917       residual = 4.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906612856752       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906612856807       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906612856821       residual = 7.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906612856823       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906612856823       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906612856823       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906612856572       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906612856823       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906612856823       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+05 is 1.685016e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906612855917       residual = 4.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906612856125       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906612856139       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906612856143       residual = 7.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906612856143       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906612856143       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906612857302       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906612854781       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906612856706       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906612854338       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+05 is 4.212541e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.227330 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6347e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770723e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841368e-03 3 1  ON 9
ci_011                -8.956773e-03 3 1  ON 10
ci_012                -9.103928e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111010e-03 3 1  ON 17
ci_019                 9.004850e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520092e-02 3 1  ON 20
ci_022                 8.269284e-03 3 1  ON 21
ci_023                 8.254999e-03 3 1  ON 22
ci_024                 8.343659e-03 3 1  ON 23
ci_025                 8.422060e-03 3 1  ON 24
ci_026                 9.909783e-03 3 1  ON 25
ci_027                 9.698729e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758307e-03 3 1  ON 29
ci_031                -8.616196e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550082e-03 3 1  ON 32
ci_034                 4.843630e-03 3 1  ON 33
ci_035                -3.333287e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698291e-04 3 1  ON 37
ci_039                 1.141804e-03 3 1  ON 38
ci_040                -1.556565e-03 3 1  ON 39
ci_041                 8.162410e-03 3 1  ON 40
ci_042                 8.161303e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909899e-03 3 1  ON 43
ci_045                -1.989963e-03 3 1  ON 44
ci_046                 4.787334e-03 3 1  ON 45
ci_047                 4.610917e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844900e-03 3 1  ON 49
ci_051                 2.987767e-03 3 1  ON 50
ci_052                -2.169814e-03 3 1  ON 51
ci_053                -2.204226e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424950e-03 3 1  ON 54
ci_056                 4.623348e-03 3 1  ON 55
ci_057                 4.637315e-03 3 1  ON 56
ci_058                -2.068441e-03 3 1  ON 57
ci_059                -2.051533e-03 3 1  ON 58
ci_060                 4.761571e-03 3 1  ON 59
ci_061                 5.208232e-03 3 1  ON 60
ci_062                -2.956689e-03 3 1  ON 61
ci_063                -2.806835e-03 3 1  ON 62
ci_064                -2.259152e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229746e-03 3 1  ON 66
ci_068                -4.276382e-03 3 1  ON 67
ci_069                -4.116024e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1789
    reference variance = 0.26913
====================================================
  Execution time = 1.3452e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0352e-01
  Total weights = 1.9579e+06
  Execution time = 1.8239e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291161792714
                                         uncertainty =       0.002132760620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291161792714
                                         uncertainty =       0.002132760620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381536495
  error estimate for blocks of size 2^( 2) =       0.000393034181
  error estimate for blocks of size 2^( 3) =       0.000403087548
  error estimate for blocks of size 2^( 4) =       0.000410228518
  error estimate for blocks of size 2^( 5) =       0.000413645669
  error estimate for blocks of size 2^( 6) =       0.000415228931
  error estimate for blocks of size 2^( 7) =       0.000417673808

      target function =      -0.907236948196
              le_mean =     -17.214673519904
             les_mean =     296.648501516514
             stat err =       0.000414194232
             autocorr =       1.178517188384
   target nu stat err =       0.000414194232
   target dn stat err =       0.002525279916
      target stat err =       0.003936070088
              std dev =       0.539574085797
             le_variance =       0.291140194063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291161792112
                                         uncertainty =       0.002132760569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291161792112
                                         uncertainty =       0.002132760569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381536495
  error estimate for blocks of size 2^( 2) =       0.000393034180
  error estimate for blocks of size 2^( 3) =       0.000403087548
  error estimate for blocks of size 2^( 4) =       0.000410228518
  error estimate for blocks of size 2^( 5) =       0.000413645669
  error estimate for blocks of size 2^( 6) =       0.000415228931
  error estimate for blocks of size 2^( 7) =       0.000417673808

      target function =      -0.907236948632
              le_mean =     -17.214673519872
             les_mean =     296.648501515132
             stat err =       0.000414194232
             autocorr =       1.178517191147
   target nu stat err =       0.000414194232
   target dn stat err =       0.002525279870
      target stat err =       0.003936070022
              std dev =       0.539574085223
             le_variance =       0.291140193445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291161792413
                                         uncertainty =       0.002132760594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291161792413
                                         uncertainty =       0.002132760594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381536495
  error estimate for blocks of size 2^( 2) =       0.000393034181
  error estimate for blocks of size 2^( 3) =       0.000403087548
  error estimate for blocks of size 2^( 4) =       0.000410228518
  error estimate for blocks of size 2^( 5) =       0.000413645669
  error estimate for blocks of size 2^( 6) =       0.000415228931
  error estimate for blocks of size 2^( 7) =       0.000417673808

      target function =      -0.907236948415
              le_mean =     -17.214673519888
             les_mean =     296.648501515823
             stat err =       0.000414194232
             autocorr =       1.178517189765
   target nu stat err =       0.000414194232
   target dn stat err =       0.002525279893
      target stat err =       0.003936070055
              std dev =       0.539574085510
             le_variance =       0.291140193754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291161792676
                                         uncertainty =       0.002132760617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291161792676
                                         uncertainty =       0.002132760617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381536495
  error estimate for blocks of size 2^( 2) =       0.000393034181
  error estimate for blocks of size 2^( 3) =       0.000403087548
  error estimate for blocks of size 2^( 4) =       0.000410228518
  error estimate for blocks of size 2^( 5) =       0.000413645669
  error estimate for blocks of size 2^( 6) =       0.000415228931
  error estimate for blocks of size 2^( 7) =       0.000417673808

      target function =      -0.907236948223
              le_mean =     -17.214673519902
             les_mean =     296.648501516427
             stat err =       0.000414194232
             autocorr =       1.178517188562
   target nu stat err =       0.000414194232
   target dn stat err =       0.002525279913
      target stat err =       0.003936070083
              std dev =       0.539574085761
             le_variance =       0.291140194025


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.907236948196        initial
     3.8147e+04     3.8147e+05             6.7401e-09        -0.907236948632  <--
     1.5259e+05     1.5259e+06             1.6850e-09        -0.907236948415
     6.1035e+05     6.1035e+06             4.2125e-10        -0.907236948223

*****************************************************************************
Applying the update for shift_i =   3.8147e+04     and shift_s =   3.8147e+05
*****************************************************************************

  Execution time = 2.2656e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770722e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841369e-03 3 1  ON 9
ci_011                -8.956771e-03 3 1  ON 10
ci_012                -9.103928e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590758e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111011e-03 3 1  ON 17
ci_019                 9.004850e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269283e-03 3 1  ON 21
ci_023                 8.254998e-03 3 1  ON 22
ci_024                 8.343659e-03 3 1  ON 23
ci_025                 8.422060e-03 3 1  ON 24
ci_026                 9.909783e-03 3 1  ON 25
ci_027                 9.698729e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758307e-03 3 1  ON 29
ci_031                -8.616192e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550083e-03 3 1  ON 32
ci_034                 4.843629e-03 3 1  ON 33
ci_035                -3.333286e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698283e-04 3 1  ON 37
ci_039                 1.141804e-03 3 1  ON 38
ci_040                -1.556563e-03 3 1  ON 39
ci_041                 8.162409e-03 3 1  ON 40
ci_042                 8.161303e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909900e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787334e-03 3 1  ON 45
ci_047                 4.610916e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844902e-03 3 1  ON 49
ci_051                 2.987766e-03 3 1  ON 50
ci_052                -2.169815e-03 3 1  ON 51
ci_053                -2.204223e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424951e-03 3 1  ON 54
ci_056                 4.623352e-03 3 1  ON 55
ci_057                 4.637314e-03 3 1  ON 56
ci_058                -2.068441e-03 3 1  ON 57
ci_059                -2.051530e-03 3 1  ON 58
ci_060                 4.761570e-03 3 1  ON 59
ci_061                 5.208231e-03 3 1  ON 60
ci_062                -2.956688e-03 3 1  ON 61
ci_063                -2.806834e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061279e-03 3 1  ON 65
ci_067                 4.229746e-03 3 1  ON 66
ci_068                -4.276383e-03 3 1  ON 67
ci_069                -4.116029e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9009e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1838
    reference variance = 0.221069
====================================================
  Execution time = 1.3933e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0257e-01
  Total weights = 1.957851873e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4912e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289223478075
                                         uncertainty =       0.001540865362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289223478075
                                         uncertainty =       0.001540865362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380276222
  error estimate for blocks of size 2^( 2) =       0.000391825198
  error estimate for blocks of size 2^( 3) =       0.000402118899
  error estimate for blocks of size 2^( 4) =       0.000409939940
  error estimate for blocks of size 2^( 5) =       0.000416071802
  error estimate for blocks of size 2^( 6) =       0.000417683824
  error estimate for blocks of size 2^( 7) =       0.000418367180

      target function =      -0.908702857364
              le_mean =     -17.214560801395
             les_mean =     296.643672489972
             stat err =       0.000415515687
             autocorr =       1.193923519168
   target nu stat err =       0.000415515687
   target dn stat err =       0.002161041385
      target stat err =       0.003398225230
              std dev =       0.537791790193
             le_variance =       0.289220009599


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721456080140e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908714575213       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908714578168       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908714578630       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908714578786       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908714578842       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908714578853       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908714578854       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908714578861       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908714578854       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908714578848       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+03 is 1.159340e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908714575213       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908714575952       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908714576068       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908714576107       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908714576121       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908714576130       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908714576149       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908714576178       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908714576089       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908714576124       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+04 is 2.898365e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908714575213       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908714575398       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908714575427       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908714575437       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908714575493       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908714575846       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908714575441       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908714575441       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908714575441       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908714575516       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+05 is 7.245922e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230818 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6433e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770720e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841369e-03 3 1  ON 9
ci_011                -8.956770e-03 3 1  ON 10
ci_012                -9.103926e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590758e-02 3 1  ON 15
ci_017                 1.564055e-02 3 1  ON 16
ci_018                 9.111011e-03 3 1  ON 17
ci_019                 9.004852e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269282e-03 3 1  ON 21
ci_023                 8.254997e-03 3 1  ON 22
ci_024                 8.343662e-03 3 1  ON 23
ci_025                 8.422061e-03 3 1  ON 24
ci_026                 9.909783e-03 3 1  ON 25
ci_027                 9.698731e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758306e-03 3 1  ON 29
ci_031                -8.616192e-03 3 1  ON 30
ci_032                -1.432817e-02 3 1  ON 31
ci_033                 4.550082e-03 3 1  ON 32
ci_034                 4.843627e-03 3 1  ON 33
ci_035                -3.333286e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698281e-04 3 1  ON 37
ci_039                 1.141803e-03 3 1  ON 38
ci_040                -1.556564e-03 3 1  ON 39
ci_041                 8.162409e-03 3 1  ON 40
ci_042                 8.161304e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909901e-03 3 1  ON 43
ci_045                -1.989961e-03 3 1  ON 44
ci_046                 4.787332e-03 3 1  ON 45
ci_047                 4.610917e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295391e-02 3 1  ON 48
ci_050                 2.844904e-03 3 1  ON 49
ci_051                 2.987766e-03 3 1  ON 50
ci_052                -2.169816e-03 3 1  ON 51
ci_053                -2.204222e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424952e-03 3 1  ON 54
ci_056                 4.623352e-03 3 1  ON 55
ci_057                 4.637314e-03 3 1  ON 56
ci_058                -2.068441e-03 3 1  ON 57
ci_059                -2.051529e-03 3 1  ON 58
ci_060                 4.761573e-03 3 1  ON 59
ci_061                 5.208232e-03 3 1  ON 60
ci_062                -2.956688e-03 3 1  ON 61
ci_063                -2.806834e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384065e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229746e-03 3 1  ON 66
ci_068                -4.276383e-03 3 1  ON 67
ci_069                -4.116028e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1738
    reference variance = 0.158021
====================================================
  Execution time = 1.3333e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0384e-01
  Total weights = 1.9580e+06
  Execution time = 1.8290e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290157356533
                                         uncertainty =       0.004102108513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290157356533
                                         uncertainty =       0.004102108513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380897614
  error estimate for blocks of size 2^( 2) =       0.000392641186
  error estimate for blocks of size 2^( 3) =       0.000403304834
  error estimate for blocks of size 2^( 4) =       0.000411406645
  error estimate for blocks of size 2^( 5) =       0.000416087250
  error estimate for blocks of size 2^( 6) =       0.000416797957
  error estimate for blocks of size 2^( 7) =       0.000417569550

      target function =      -0.906730606342
              le_mean =     -17.214471120507
             les_mean =     296.641851680524
             stat err =       0.000415465350
             autocorr =       1.189742880378
   target nu stat err =       0.000415465350
   target dn stat err =       0.004090085895
      target stat err =       0.006303392237
              std dev =       0.538670571787
             le_variance =       0.290165984909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290157352487
                                         uncertainty =       0.004102105237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290157352487
                                         uncertainty =       0.004102105237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380897611
  error estimate for blocks of size 2^( 2) =       0.000392641184
  error estimate for blocks of size 2^( 3) =       0.000403304832
  error estimate for blocks of size 2^( 4) =       0.000411406644
  error estimate for blocks of size 2^( 5) =       0.000416087249
  error estimate for blocks of size 2^( 6) =       0.000416797956
  error estimate for blocks of size 2^( 7) =       0.000417569549

      target function =      -0.906730567192
              le_mean =     -17.214471120467
             les_mean =     296.641851704747
             stat err =       0.000415465349
             autocorr =       1.189742890389
   target nu stat err =       0.000415465349
   target dn stat err =       0.004090083719
      target stat err =       0.006303388383
              std dev =       0.538670568044
             le_variance =       0.290165980877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290157354510
                                         uncertainty =       0.004102106875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290157354510
                                         uncertainty =       0.004102106875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380897613
  error estimate for blocks of size 2^( 2) =       0.000392641185
  error estimate for blocks of size 2^( 3) =       0.000403304833
  error estimate for blocks of size 2^( 4) =       0.000411406644
  error estimate for blocks of size 2^( 5) =       0.000416087249
  error estimate for blocks of size 2^( 6) =       0.000416797956
  error estimate for blocks of size 2^( 7) =       0.000417569549

      target function =      -0.906730586771
              le_mean =     -17.214471120487
             les_mean =     296.641851692632
             stat err =       0.000415465350
             autocorr =       1.189742885386
   target nu stat err =       0.000415465350
   target dn stat err =       0.004090084807
      target stat err =       0.006303390310
              std dev =       0.538670569916
             le_variance =       0.290165982893

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290157356280
                                         uncertainty =       0.004102108309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290157356280
                                         uncertainty =       0.004102108309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380897614
  error estimate for blocks of size 2^( 2) =       0.000392641186
  error estimate for blocks of size 2^( 3) =       0.000403304834
  error estimate for blocks of size 2^( 4) =       0.000411406645
  error estimate for blocks of size 2^( 5) =       0.000416087250
  error estimate for blocks of size 2^( 6) =       0.000416797957
  error estimate for blocks of size 2^( 7) =       0.000417569550

      target function =      -0.906730603896
              le_mean =     -17.214471120504
             les_mean =     296.641851682037
             stat err =       0.000415465350
             autocorr =       1.189742881012
   target nu stat err =       0.000415465350
   target dn stat err =       0.004090085759
      target stat err =       0.006303391996
              std dev =       0.538670571553
             le_variance =       0.290165984657


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.906730606342        initial  <--
     9.5367e+03     9.5367e+04             1.1593e-08        -0.906730567192
     3.8147e+04     3.8147e+05             2.8984e-09        -0.906730586771
     1.5259e+05     1.5259e+06             7.2459e-10        -0.906730603896

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5250
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770722e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841369e-03 3 1  ON 9
ci_011                -8.956771e-03 3 1  ON 10
ci_012                -9.103928e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590758e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111011e-03 3 1  ON 17
ci_019                 9.004850e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269283e-03 3 1  ON 21
ci_023                 8.254998e-03 3 1  ON 22
ci_024                 8.343659e-03 3 1  ON 23
ci_025                 8.422060e-03 3 1  ON 24
ci_026                 9.909783e-03 3 1  ON 25
ci_027                 9.698729e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758307e-03 3 1  ON 29
ci_031                -8.616192e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550083e-03 3 1  ON 32
ci_034                 4.843629e-03 3 1  ON 33
ci_035                -3.333286e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698283e-04 3 1  ON 37
ci_039                 1.141804e-03 3 1  ON 38
ci_040                -1.556563e-03 3 1  ON 39
ci_041                 8.162409e-03 3 1  ON 40
ci_042                 8.161303e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909900e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787334e-03 3 1  ON 45
ci_047                 4.610916e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844902e-03 3 1  ON 49
ci_051                 2.987766e-03 3 1  ON 50
ci_052                -2.169815e-03 3 1  ON 51
ci_053                -2.204223e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424951e-03 3 1  ON 54
ci_056                 4.623352e-03 3 1  ON 55
ci_057                 4.637314e-03 3 1  ON 56
ci_058                -2.068441e-03 3 1  ON 57
ci_059                -2.051530e-03 3 1  ON 58
ci_060                 4.761570e-03 3 1  ON 59
ci_061                 5.208231e-03 3 1  ON 60
ci_062                -2.956688e-03 3 1  ON 61
ci_063                -2.806834e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061279e-03 3 1  ON 65
ci_067                 4.229746e-03 3 1  ON 66
ci_068                -4.276383e-03 3 1  ON 67
ci_069                -4.116029e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8964e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2592
    reference variance = 0.33225
====================================================
  Execution time = 1.4220e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9955e-01
  Total weights = 1.957829680e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5058e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286981176955
                                         uncertainty =       0.001909754594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286981176955
                                         uncertainty =       0.001909754594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378790437
  error estimate for blocks of size 2^( 2) =       0.000390191557
  error estimate for blocks of size 2^( 3) =       0.000401193551
  error estimate for blocks of size 2^( 4) =       0.000408811823
  error estimate for blocks of size 2^( 5) =       0.000414171625
  error estimate for blocks of size 2^( 6) =       0.000415214688
  error estimate for blocks of size 2^( 7) =       0.000417918213

      target function =      -0.913365118403
              le_mean =     -17.214739332739
             les_mean =     296.646798473799
             stat err =       0.000414029087
             autocorr =       1.194713284531
   target nu stat err =       0.000414029087
   target dn stat err =       0.002380064852
      target stat err =       0.003766997376
              std dev =       0.535690573784
             le_variance =       0.286964390841


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721473933274e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913379737283       residual = 2.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913379738225       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913379738293       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913379738321       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913379738327       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913379738265       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913379738383       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913379738353       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913379738432       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913379738294       residual = 7.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+04 is 2.219368e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913379737283       residual = 2.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913379737518       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913379737535       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913379737542       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913379737957       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913379737199       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913379737078       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913379737627       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913379737544       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913379738039       residual = 7.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+05 is 5.548424e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913379737283       residual = 2.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913379737341       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913379737346       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913379737347       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913379736991       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913379737392       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913379737348       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913379739670       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913379735707       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913379737472       residual = 7.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+06 is 1.387106e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.234233 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6735e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770722e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841369e-03 3 1  ON 9
ci_011                -8.956771e-03 3 1  ON 10
ci_012                -9.103928e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590758e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111011e-03 3 1  ON 17
ci_019                 9.004851e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269283e-03 3 1  ON 21
ci_023                 8.254998e-03 3 1  ON 22
ci_024                 8.343659e-03 3 1  ON 23
ci_025                 8.422060e-03 3 1  ON 24
ci_026                 9.909782e-03 3 1  ON 25
ci_027                 9.698728e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758307e-03 3 1  ON 29
ci_031                -8.616193e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550083e-03 3 1  ON 32
ci_034                 4.843628e-03 3 1  ON 33
ci_035                -3.333286e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698283e-04 3 1  ON 37
ci_039                 1.141804e-03 3 1  ON 38
ci_040                -1.556563e-03 3 1  ON 39
ci_041                 8.162409e-03 3 1  ON 40
ci_042                 8.161303e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909900e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787334e-03 3 1  ON 45
ci_047                 4.610916e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844902e-03 3 1  ON 49
ci_051                 2.987766e-03 3 1  ON 50
ci_052                -2.169815e-03 3 1  ON 51
ci_053                -2.204223e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424951e-03 3 1  ON 54
ci_056                 4.623352e-03 3 1  ON 55
ci_057                 4.637314e-03 3 1  ON 56
ci_058                -2.068441e-03 3 1  ON 57
ci_059                -2.051530e-03 3 1  ON 58
ci_060                 4.761570e-03 3 1  ON 59
ci_061                 5.208231e-03 3 1  ON 60
ci_062                -2.956688e-03 3 1  ON 61
ci_063                -2.806834e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229746e-03 3 1  ON 66
ci_068                -4.276383e-03 3 1  ON 67
ci_069                -4.116029e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1276
    reference variance = 0.17077
====================================================
  Execution time = 1.3387e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9354e-01
  Total weights = 1.9577e+06
  Execution time = 1.8205e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281807331986
                                         uncertainty =       0.001543153578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281807331986
                                         uncertainty =       0.001543153578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375363776
  error estimate for blocks of size 2^( 2) =       0.000386819711
  error estimate for blocks of size 2^( 3) =       0.000397377372
  error estimate for blocks of size 2^( 4) =       0.000404967828
  error estimate for blocks of size 2^( 5) =       0.000409034556
  error estimate for blocks of size 2^( 6) =       0.000412749203
  error estimate for blocks of size 2^( 7) =       0.000413454590

      target function =      -0.922808170003
              le_mean =     -17.214558649289
             les_mean =     296.634572087672
             stat err =       0.000410051544
             autocorr =       1.193361949635
   target nu stat err =       0.000410051544
   target dn stat err =       0.001808706966
      target stat err =       0.002954935923
              std dev =       0.530844542198
             le_variance =       0.281795927981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281807332014
                                         uncertainty =       0.001543153567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281807332014
                                         uncertainty =       0.001543153567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375363776
  error estimate for blocks of size 2^( 2) =       0.000386819711
  error estimate for blocks of size 2^( 3) =       0.000397377372
  error estimate for blocks of size 2^( 4) =       0.000404967828
  error estimate for blocks of size 2^( 5) =       0.000409034557
  error estimate for blocks of size 2^( 6) =       0.000412749203
  error estimate for blocks of size 2^( 7) =       0.000413454590

      target function =      -0.922808171373
              le_mean =     -17.214558649308
             les_mean =     296.634572087454
             stat err =       0.000410051544
             autocorr =       1.193361950209
   target nu stat err =       0.000410051544
   target dn stat err =       0.001808706922
      target stat err =       0.002954935864
              std dev =       0.530844542223
             le_variance =       0.281795928008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281807332000
                                         uncertainty =       0.001543153572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281807332000
                                         uncertainty =       0.001543153572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375363776
  error estimate for blocks of size 2^( 2) =       0.000386819711
  error estimate for blocks of size 2^( 3) =       0.000397377372
  error estimate for blocks of size 2^( 4) =       0.000404967828
  error estimate for blocks of size 2^( 5) =       0.000409034557
  error estimate for blocks of size 2^( 6) =       0.000412749203
  error estimate for blocks of size 2^( 7) =       0.000413454590

      target function =      -0.922808170688
              le_mean =     -17.214558649298
             les_mean =     296.634572087563
             stat err =       0.000410051544
             autocorr =       1.193361949917
   target nu stat err =       0.000410051544
   target dn stat err =       0.001808706944
      target stat err =       0.002954935893
              std dev =       0.530844542210
             le_variance =       0.281795927994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281807331988
                                         uncertainty =       0.001543153577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281807331988
                                         uncertainty =       0.001543153577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375363776
  error estimate for blocks of size 2^( 2) =       0.000386819711
  error estimate for blocks of size 2^( 3) =       0.000397377372
  error estimate for blocks of size 2^( 4) =       0.000404967828
  error estimate for blocks of size 2^( 5) =       0.000409034556
  error estimate for blocks of size 2^( 6) =       0.000412749203
  error estimate for blocks of size 2^( 7) =       0.000413454590

      target function =      -0.922808170088
              le_mean =     -17.214558649290
             les_mean =     296.634572087659
             stat err =       0.000410051544
             autocorr =       1.193361949665
   target nu stat err =       0.000410051544
   target dn stat err =       0.001808706963
      target stat err =       0.002954935919
              std dev =       0.530844542199
             le_variance =       0.281795927983


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922808170003        initial
     9.5367e+04     9.5367e+05             2.2194e-09        -0.922808171373  <--
     3.8147e+05     3.8147e+06             5.5484e-10        -0.922808170688
     1.5259e+06     1.5259e+07             1.3871e-10        -0.922808170088

*****************************************************************************
Applying the update for shift_i =   9.5367e+04     and shift_s =   9.5367e+05
*****************************************************************************

  Execution time = 2.2584e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770721e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841369e-03 3 1  ON 9
ci_011                -8.956770e-03 3 1  ON 10
ci_012                -9.103927e-03 3 1  ON 11
ci_013                -1.908576e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590758e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111010e-03 3 1  ON 17
ci_019                 9.004852e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269283e-03 3 1  ON 21
ci_023                 8.254998e-03 3 1  ON 22
ci_024                 8.343660e-03 3 1  ON 23
ci_025                 8.422060e-03 3 1  ON 24
ci_026                 9.909781e-03 3 1  ON 25
ci_027                 9.698726e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758307e-03 3 1  ON 29
ci_031                -8.616193e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550083e-03 3 1  ON 32
ci_034                 4.843628e-03 3 1  ON 33
ci_035                -3.333286e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698284e-04 3 1  ON 37
ci_039                 1.141804e-03 3 1  ON 38
ci_040                -1.556563e-03 3 1  ON 39
ci_041                 8.162409e-03 3 1  ON 40
ci_042                 8.161304e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909899e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787334e-03 3 1  ON 45
ci_047                 4.610916e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844903e-03 3 1  ON 49
ci_051                 2.987766e-03 3 1  ON 50
ci_052                -2.169814e-03 3 1  ON 51
ci_053                -2.204224e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424951e-03 3 1  ON 54
ci_056                 4.623352e-03 3 1  ON 55
ci_057                 4.637314e-03 3 1  ON 56
ci_058                -2.068442e-03 3 1  ON 57
ci_059                -2.051530e-03 3 1  ON 58
ci_060                 4.761570e-03 3 1  ON 59
ci_061                 5.208232e-03 3 1  ON 60
ci_062                -2.956688e-03 3 1  ON 61
ci_063                -2.806834e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229746e-03 3 1  ON 66
ci_068                -4.276382e-03 3 1  ON 67
ci_069                -4.116028e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9325e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2781
    reference variance = 0.328428
====================================================
  Execution time = 1.3959e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0123e-01
  Total weights = 1.957585166e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4938e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287253228074
                                         uncertainty =       0.001752601211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287253228074
                                         uncertainty =       0.001752601211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379037809
  error estimate for blocks of size 2^( 2) =       0.000390072457
  error estimate for blocks of size 2^( 3) =       0.000400160240
  error estimate for blocks of size 2^( 4) =       0.000407366457
  error estimate for blocks of size 2^( 5) =       0.000412624940
  error estimate for blocks of size 2^( 6) =       0.000416329354
  error estimate for blocks of size 2^( 7) =       0.000418948964

      target function =      -0.910750981936
              le_mean =     -17.214652213424
             les_mean =     296.645484519555
             stat err =       0.000413817429
             autocorr =       1.191934776247
   target nu stat err =       0.000413817429
   target dn stat err =       0.002711072647
      target stat err =       0.004248814385
              std dev =       0.536040409808
             le_variance =       0.287339320947


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721465221342e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910769922915       residual = 7.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910769924008       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910769924248       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910769924320       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910769924329       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910769924342       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910769924296       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910769924322       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910769924348       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910769924352       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+04 is 4.018904e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910769922915       residual = 7.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910769923188       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910769923248       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910769923266       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910769923330       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910769923186       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910769923312       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910769923239       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910769923236       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910769923307       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+04 is 1.004728e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910769922915       residual = 7.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910769922983       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910769922998       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910769923000       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910769923003       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910769923003       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910769922900       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910769923003       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910769922909       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910769923602       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+05 is 2.511822e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.237746 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6462e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770721e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841368e-03 3 1  ON 9
ci_011                -8.956770e-03 3 1  ON 10
ci_012                -9.103927e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590758e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111010e-03 3 1  ON 17
ci_019                 9.004851e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269283e-03 3 1  ON 21
ci_023                 8.254998e-03 3 1  ON 22
ci_024                 8.343659e-03 3 1  ON 23
ci_025                 8.422059e-03 3 1  ON 24
ci_026                 9.909782e-03 3 1  ON 25
ci_027                 9.698726e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758306e-03 3 1  ON 29
ci_031                -8.616193e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550084e-03 3 1  ON 32
ci_034                 4.843629e-03 3 1  ON 33
ci_035                -3.333286e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698281e-04 3 1  ON 37
ci_039                 1.141803e-03 3 1  ON 38
ci_040                -1.556563e-03 3 1  ON 39
ci_041                 8.162409e-03 3 1  ON 40
ci_042                 8.161304e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909899e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787334e-03 3 1  ON 45
ci_047                 4.610916e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295391e-02 3 1  ON 48
ci_050                 2.844902e-03 3 1  ON 49
ci_051                 2.987765e-03 3 1  ON 50
ci_052                -2.169815e-03 3 1  ON 51
ci_053                -2.204224e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424951e-03 3 1  ON 54
ci_056                 4.623352e-03 3 1  ON 55
ci_057                 4.637314e-03 3 1  ON 56
ci_058                -2.068443e-03 3 1  ON 57
ci_059                -2.051531e-03 3 1  ON 58
ci_060                 4.761570e-03 3 1  ON 59
ci_061                 5.208231e-03 3 1  ON 60
ci_062                -2.956688e-03 3 1  ON 61
ci_063                -2.806834e-03 3 1  ON 62
ci_064                -2.259152e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229746e-03 3 1  ON 66
ci_068                -4.276382e-03 3 1  ON 67
ci_069                -4.116029e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.287
    reference variance = 0.241834
====================================================
  Execution time = 1.3422e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0536e-01
  Total weights = 1.9575e+06
  Execution time = 1.8183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289297368601
                                         uncertainty =       0.002122036485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289297368601
                                         uncertainty =       0.002122036485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380416996
  error estimate for blocks of size 2^( 2) =       0.000392013820
  error estimate for blocks of size 2^( 3) =       0.000401978253
  error estimate for blocks of size 2^( 4) =       0.000409966711
  error estimate for blocks of size 2^( 5) =       0.000415614464
  error estimate for blocks of size 2^( 6) =       0.000417565502
  error estimate for blocks of size 2^( 7) =       0.000420701458

      target function =      -0.904418593555
              le_mean =     -17.214481712649
             les_mean =     296.643742267707
             stat err =       0.000415962034
             autocorr =       1.195604559796
   target nu stat err =       0.000415962034
   target dn stat err =       0.003060016937
      target stat err =       0.004715089103
              std dev =       0.537990874944
             le_variance =       0.289434181523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289297367805
                                         uncertainty =       0.002122036447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289297367805
                                         uncertainty =       0.002122036447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380416995
  error estimate for blocks of size 2^( 2) =       0.000392013820
  error estimate for blocks of size 2^( 3) =       0.000401978253
  error estimate for blocks of size 2^( 4) =       0.000409966712
  error estimate for blocks of size 2^( 5) =       0.000415614464
  error estimate for blocks of size 2^( 6) =       0.000417565503
  error estimate for blocks of size 2^( 7) =       0.000420701459

      target function =      -0.904418585330
              le_mean =     -17.214481712662
             les_mean =     296.643742273566
             stat err =       0.000415962034
             autocorr =       1.195604566431
   target nu stat err =       0.000415962034
   target dn stat err =       0.003060017500
      target stat err =       0.004715089866
              std dev =       0.537990874252
             le_variance =       0.289434180779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289297368203
                                         uncertainty =       0.002122036466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289297368203
                                         uncertainty =       0.002122036466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380416996
  error estimate for blocks of size 2^( 2) =       0.000392013820
  error estimate for blocks of size 2^( 3) =       0.000401978253
  error estimate for blocks of size 2^( 4) =       0.000409966712
  error estimate for blocks of size 2^( 5) =       0.000415614464
  error estimate for blocks of size 2^( 6) =       0.000417565503
  error estimate for blocks of size 2^( 7) =       0.000420701458

      target function =      -0.904418589443
              le_mean =     -17.214481712655
             les_mean =     296.643742270637
             stat err =       0.000415962034
             autocorr =       1.195604563118
   target nu stat err =       0.000415962034
   target dn stat err =       0.003060017219
      target stat err =       0.004715089485
              std dev =       0.537990874598
             le_variance =       0.289434181151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289297368551
                                         uncertainty =       0.002122036483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289297368551
                                         uncertainty =       0.002122036483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380416996
  error estimate for blocks of size 2^( 2) =       0.000392013820
  error estimate for blocks of size 2^( 3) =       0.000401978253
  error estimate for blocks of size 2^( 4) =       0.000409966711
  error estimate for blocks of size 2^( 5) =       0.000415614464
  error estimate for blocks of size 2^( 6) =       0.000417565502
  error estimate for blocks of size 2^( 7) =       0.000420701458

      target function =      -0.904418593041
              le_mean =     -17.214481712649
             les_mean =     296.643742268074
             stat err =       0.000415962034
             autocorr =       1.195604560209
   target nu stat err =       0.000415962034
   target dn stat err =       0.003060016973
      target stat err =       0.004715089150
              std dev =       0.537990874900
             le_variance =       0.289434181476


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904418593555        initial  <--
     2.3842e+04     2.3842e+05             4.0189e-09        -0.904418585330
     9.5367e+04     9.5367e+05             1.0047e-09        -0.904418589443
     3.8147e+05     3.8147e+06             2.5118e-10        -0.904418593041

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6203
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770721e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841369e-03 3 1  ON 9
ci_011                -8.956770e-03 3 1  ON 10
ci_012                -9.103927e-03 3 1  ON 11
ci_013                -1.908576e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590758e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111010e-03 3 1  ON 17
ci_019                 9.004852e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269283e-03 3 1  ON 21
ci_023                 8.254998e-03 3 1  ON 22
ci_024                 8.343660e-03 3 1  ON 23
ci_025                 8.422060e-03 3 1  ON 24
ci_026                 9.909781e-03 3 1  ON 25
ci_027                 9.698726e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758307e-03 3 1  ON 29
ci_031                -8.616193e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550083e-03 3 1  ON 32
ci_034                 4.843628e-03 3 1  ON 33
ci_035                -3.333286e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698284e-04 3 1  ON 37
ci_039                 1.141804e-03 3 1  ON 38
ci_040                -1.556563e-03 3 1  ON 39
ci_041                 8.162409e-03 3 1  ON 40
ci_042                 8.161304e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909899e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787334e-03 3 1  ON 45
ci_047                 4.610916e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844903e-03 3 1  ON 49
ci_051                 2.987766e-03 3 1  ON 50
ci_052                -2.169814e-03 3 1  ON 51
ci_053                -2.204224e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424951e-03 3 1  ON 54
ci_056                 4.623352e-03 3 1  ON 55
ci_057                 4.637314e-03 3 1  ON 56
ci_058                -2.068442e-03 3 1  ON 57
ci_059                -2.051530e-03 3 1  ON 58
ci_060                 4.761570e-03 3 1  ON 59
ci_061                 5.208232e-03 3 1  ON 60
ci_062                -2.956688e-03 3 1  ON 61
ci_063                -2.806834e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229746e-03 3 1  ON 66
ci_068                -4.276382e-03 3 1  ON 67
ci_069                -4.116028e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9092e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1856
    reference variance = 0.218804
====================================================
  Execution time = 1.3913e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0104e-01
  Total weights = 1.957942415e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4998e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286811574134
                                         uncertainty =       0.001581750915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286811574134
                                         uncertainty =       0.001581750915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378665800
  error estimate for blocks of size 2^( 2) =       0.000390266700
  error estimate for blocks of size 2^( 3) =       0.000400646426
  error estimate for blocks of size 2^( 4) =       0.000408774599
  error estimate for blocks of size 2^( 5) =       0.000413456851
  error estimate for blocks of size 2^( 6) =       0.000416198876
  error estimate for blocks of size 2^( 7) =       0.000416177569

      target function =      -0.911055520609
              le_mean =     -17.214509450724
             les_mean =     296.640378991971
             stat err =       0.000413651974
             autocorr =       1.193323070505
   target nu stat err =       0.000413651974
   target dn stat err =       0.002346755481
      target stat err =       0.003695995856
              std dev =       0.535514309878
             le_variance =       0.286775576084


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721450945072e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911069537280       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911069537473       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911069537498       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911069537492       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911069537507       residual = 9.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911069537075       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911069537551       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911069537427       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911069537538       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911069537411       residual = 6.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+05 is 5.487011e-10

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911069537280       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911069537328       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911069537334       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911069537336       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911069538125       residual = 9.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911069539789       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911069535660       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911069538991       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911069535983       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911069536996       residual = 6.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+05 is 1.371754e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911069537280       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911069537292       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911069537293       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911069537294       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911069537294       residual = 9.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911069537294       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911069537294       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911069537294       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911069546015       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911069539505       residual = 6.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+06 is 3.429381e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.241228 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6422e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770721e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841369e-03 3 1  ON 9
ci_011                -8.956770e-03 3 1  ON 10
ci_012                -9.103927e-03 3 1  ON 11
ci_013                -1.908576e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590758e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111010e-03 3 1  ON 17
ci_019                 9.004852e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269283e-03 3 1  ON 21
ci_023                 8.254998e-03 3 1  ON 22
ci_024                 8.343660e-03 3 1  ON 23
ci_025                 8.422060e-03 3 1  ON 24
ci_026                 9.909781e-03 3 1  ON 25
ci_027                 9.698726e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758307e-03 3 1  ON 29
ci_031                -8.616193e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550083e-03 3 1  ON 32
ci_034                 4.843628e-03 3 1  ON 33
ci_035                -3.333286e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698284e-04 3 1  ON 37
ci_039                 1.141804e-03 3 1  ON 38
ci_040                -1.556563e-03 3 1  ON 39
ci_041                 8.162409e-03 3 1  ON 40
ci_042                 8.161304e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909899e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787334e-03 3 1  ON 45
ci_047                 4.610916e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844903e-03 3 1  ON 49
ci_051                 2.987766e-03 3 1  ON 50
ci_052                -2.169815e-03 3 1  ON 51
ci_053                -2.204224e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424951e-03 3 1  ON 54
ci_056                 4.623352e-03 3 1  ON 55
ci_057                 4.637314e-03 3 1  ON 56
ci_058                -2.068442e-03 3 1  ON 57
ci_059                -2.051530e-03 3 1  ON 58
ci_060                 4.761570e-03 3 1  ON 59
ci_061                 5.208232e-03 3 1  ON 60
ci_062                -2.956688e-03 3 1  ON 61
ci_063                -2.806834e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229746e-03 3 1  ON 66
ci_068                -4.276382e-03 3 1  ON 67
ci_069                -4.116029e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1879
    reference variance = 0.156454
====================================================
  Execution time = 1.3478e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0368e-01
  Total weights = 1.9575e+06
  Execution time = 1.8196e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288299492545
                                         uncertainty =       0.002007369920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288299492545
                                         uncertainty =       0.002007369920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379633273
  error estimate for blocks of size 2^( 2) =       0.000390938719
  error estimate for blocks of size 2^( 3) =       0.000401336416
  error estimate for blocks of size 2^( 4) =       0.000409241559
  error estimate for blocks of size 2^( 5) =       0.000414630400
  error estimate for blocks of size 2^( 6) =       0.000417610641
  error estimate for blocks of size 2^( 7) =       0.000419594064

      target function =      -0.906984187735
              le_mean =     -17.214555366571
             les_mean =     296.644593892500
             stat err =       0.000415269166
             autocorr =       1.196549953366
   target nu stat err =       0.000415269166
   target dn stat err =       0.003315546495
      target stat err =       0.005129732393
              std dev =       0.536882522720
             le_variance =       0.288242843202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288299492501
                                         uncertainty =       0.002007369935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288299492501
                                         uncertainty =       0.002007369935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379633272
  error estimate for blocks of size 2^( 2) =       0.000390938719
  error estimate for blocks of size 2^( 3) =       0.000401336416
  error estimate for blocks of size 2^( 4) =       0.000409241559
  error estimate for blocks of size 2^( 5) =       0.000414630400
  error estimate for blocks of size 2^( 6) =       0.000417610641
  error estimate for blocks of size 2^( 7) =       0.000419594064

      target function =      -0.906984187965
              le_mean =     -17.214555366570
             les_mean =     296.644593892297
             stat err =       0.000415269166
             autocorr =       1.196549953774
   target nu stat err =       0.000415269166
   target dn stat err =       0.003315546233
      target stat err =       0.005129731998
              std dev =       0.536882522679
             le_variance =       0.288242843158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288299492523
                                         uncertainty =       0.002007369928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288299492523
                                         uncertainty =       0.002007369928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379633273
  error estimate for blocks of size 2^( 2) =       0.000390938719
  error estimate for blocks of size 2^( 3) =       0.000401336416
  error estimate for blocks of size 2^( 4) =       0.000409241559
  error estimate for blocks of size 2^( 5) =       0.000414630400
  error estimate for blocks of size 2^( 6) =       0.000417610641
  error estimate for blocks of size 2^( 7) =       0.000419594064

      target function =      -0.906984187850
              le_mean =     -17.214555366571
             les_mean =     296.644593892398
             stat err =       0.000415269166
             autocorr =       1.196549953568
   target nu stat err =       0.000415269166
   target dn stat err =       0.003315546364
      target stat err =       0.005129732195
              std dev =       0.536882522699
             le_variance =       0.288242843180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288299492542
                                         uncertainty =       0.002007369921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288299492542
                                         uncertainty =       0.002007369921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379633273
  error estimate for blocks of size 2^( 2) =       0.000390938719
  error estimate for blocks of size 2^( 3) =       0.000401336416
  error estimate for blocks of size 2^( 4) =       0.000409241559
  error estimate for blocks of size 2^( 5) =       0.000414630400
  error estimate for blocks of size 2^( 6) =       0.000417610641
  error estimate for blocks of size 2^( 7) =       0.000419594064

      target function =      -0.906984187749
              le_mean =     -17.214555366571
             les_mean =     296.644593892487
             stat err =       0.000415269166
             autocorr =       1.196549953400
   target nu stat err =       0.000415269166
   target dn stat err =       0.003315546479
      target stat err =       0.005129732368
              std dev =       0.536882522717
             le_variance =       0.288242843199


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.906984187735        initial
     2.3842e+05     2.3842e+06             5.4870e-10        -0.906984187965  <--
     9.5367e+05     9.5367e+06             1.3718e-10        -0.906984187850
     3.8147e+06     3.8147e+07             3.4294e-11        -0.906984187749

*****************************************************************************
Applying the update for shift_i =   2.3842e+05     and shift_s =   2.3842e+06
*****************************************************************************

  Execution time = 2.5953e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770721e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841369e-03 3 1  ON 9
ci_011                -8.956770e-03 3 1  ON 10
ci_012                -9.103927e-03 3 1  ON 11
ci_013                -1.908576e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590758e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111010e-03 3 1  ON 17
ci_019                 9.004852e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269283e-03 3 1  ON 21
ci_023                 8.254998e-03 3 1  ON 22
ci_024                 8.343659e-03 3 1  ON 23
ci_025                 8.422060e-03 3 1  ON 24
ci_026                 9.909781e-03 3 1  ON 25
ci_027                 9.698727e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758307e-03 3 1  ON 29
ci_031                -8.616193e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550084e-03 3 1  ON 32
ci_034                 4.843628e-03 3 1  ON 33
ci_035                -3.333287e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698284e-04 3 1  ON 37
ci_039                 1.141804e-03 3 1  ON 38
ci_040                -1.556563e-03 3 1  ON 39
ci_041                 8.162409e-03 3 1  ON 40
ci_042                 8.161304e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909899e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787334e-03 3 1  ON 45
ci_047                 4.610915e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844903e-03 3 1  ON 49
ci_051                 2.987766e-03 3 1  ON 50
ci_052                -2.169815e-03 3 1  ON 51
ci_053                -2.204223e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424951e-03 3 1  ON 54
ci_056                 4.623352e-03 3 1  ON 55
ci_057                 4.637314e-03 3 1  ON 56
ci_058                -2.068442e-03 3 1  ON 57
ci_059                -2.051530e-03 3 1  ON 58
ci_060                 4.761570e-03 3 1  ON 59
ci_061                 5.208232e-03 3 1  ON 60
ci_062                -2.956688e-03 3 1  ON 61
ci_063                -2.806834e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229746e-03 3 1  ON 66
ci_068                -4.276382e-03 3 1  ON 67
ci_069                -4.116029e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2383e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2768
    reference variance = 0.279251
====================================================
  Execution time = 1.4195e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5307e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0795e-01
  Total weights = 1.957608992e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287444572386
                                         uncertainty =       0.001787046910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287444572386
                                         uncertainty =       0.001787046910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379088172
  error estimate for blocks of size 2^( 2) =       0.000390351152
  error estimate for blocks of size 2^( 3) =       0.000400581070
  error estimate for blocks of size 2^( 4) =       0.000408211884
  error estimate for blocks of size 2^( 5) =       0.000414314619
  error estimate for blocks of size 2^( 6) =       0.000416313100
  error estimate for blocks of size 2^( 7) =       0.000418930356

      target function =      -0.900384603441
              le_mean =     -17.214967601055
             les_mean =     296.663054887753
             stat err =       0.000414442490
             autocorr =       1.195220628088
   target nu stat err =       0.000414442490
   target dn stat err =       0.006600377599
      target stat err =       0.010002066569
              std dev =       0.536111634242
             le_variance =       0.287415684369


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721496760105e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900494731670       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900494732521       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900494732623       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900494732661       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900494732652       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900494732684       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900494732680       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900494732641       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900494732727       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900494732537       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+04 is 2.243510e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900494731670       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900494731883       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900494731908       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900494731918       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900494731734       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900494731912       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900494731708       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900494731898       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900494731929       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900494732396       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+05 is 5.608782e-10

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900494731670       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900494731723       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900494731730       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900494731732       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900494731330       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900494730780       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900494732519       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900494731668       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900494731868       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900494732313       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+05 is 1.402196e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.244668 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6723e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770721e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841369e-03 3 1  ON 9
ci_011                -8.956771e-03 3 1  ON 10
ci_012                -9.103927e-03 3 1  ON 11
ci_013                -1.908576e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590758e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111011e-03 3 1  ON 17
ci_019                 9.004852e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269283e-03 3 1  ON 21
ci_023                 8.254998e-03 3 1  ON 22
ci_024                 8.343659e-03 3 1  ON 23
ci_025                 8.422060e-03 3 1  ON 24
ci_026                 9.909781e-03 3 1  ON 25
ci_027                 9.698726e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758307e-03 3 1  ON 29
ci_031                -8.616192e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550084e-03 3 1  ON 32
ci_034                 4.843628e-03 3 1  ON 33
ci_035                -3.333287e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698283e-04 3 1  ON 37
ci_039                 1.141803e-03 3 1  ON 38
ci_040                -1.556563e-03 3 1  ON 39
ci_041                 8.162409e-03 3 1  ON 40
ci_042                 8.161303e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909899e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787334e-03 3 1  ON 45
ci_047                 4.610915e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844903e-03 3 1  ON 49
ci_051                 2.987765e-03 3 1  ON 50
ci_052                -2.169814e-03 3 1  ON 51
ci_053                -2.204224e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424951e-03 3 1  ON 54
ci_056                 4.623352e-03 3 1  ON 55
ci_057                 4.637314e-03 3 1  ON 56
ci_058                -2.068442e-03 3 1  ON 57
ci_059                -2.051529e-03 3 1  ON 58
ci_060                 4.761571e-03 3 1  ON 59
ci_061                 5.208231e-03 3 1  ON 60
ci_062                -2.956688e-03 3 1  ON 61
ci_063                -2.806834e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229746e-03 3 1  ON 66
ci_068                -4.276382e-03 3 1  ON 67
ci_069                -4.116029e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2635
    reference variance = 0.22181
====================================================
  Execution time = 1.3957e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0003e-01
  Total weights = 1.9577e+06
  Execution time = 1.8193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287969348274
                                         uncertainty =       0.001599553590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287969348274
                                         uncertainty =       0.001599553590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379414790
  error estimate for blocks of size 2^( 2) =       0.000390618513
  error estimate for blocks of size 2^( 3) =       0.000400971306
  error estimate for blocks of size 2^( 4) =       0.000408230478
  error estimate for blocks of size 2^( 5) =       0.000412867861
  error estimate for blocks of size 2^( 6) =       0.000414260094
  error estimate for blocks of size 2^( 7) =       0.000415614744

      target function =      -0.912626044573
              le_mean =     -17.214464827118
             les_mean =     296.637830223199
             stat err =       0.000412743294
             autocorr =       1.183399933795
   target nu stat err =       0.000412743294
   target dn stat err =       0.002272507256
      target stat err =       0.003594868758
              std dev =       0.536573541176
             le_variance =       0.287911165090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287969348087
                                         uncertainty =       0.001599553629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287969348087
                                         uncertainty =       0.001599553629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379414789
  error estimate for blocks of size 2^( 2) =       0.000390618513
  error estimate for blocks of size 2^( 3) =       0.000400971306
  error estimate for blocks of size 2^( 4) =       0.000408230478
  error estimate for blocks of size 2^( 5) =       0.000412867861
  error estimate for blocks of size 2^( 6) =       0.000414260094
  error estimate for blocks of size 2^( 7) =       0.000415614744

      target function =      -0.912626044830
              le_mean =     -17.214464827111
             les_mean =     296.637830222760
             stat err =       0.000412743294
             autocorr =       1.183399935946
   target nu stat err =       0.000412743294
   target dn stat err =       0.002272507659
      target stat err =       0.003594869374
              std dev =       0.536573541002
             le_variance =       0.287911164903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287969348180
                                         uncertainty =       0.001599553610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287969348180
                                         uncertainty =       0.001599553610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379414790
  error estimate for blocks of size 2^( 2) =       0.000390618513
  error estimate for blocks of size 2^( 3) =       0.000400971306
  error estimate for blocks of size 2^( 4) =       0.000408230478
  error estimate for blocks of size 2^( 5) =       0.000412867861
  error estimate for blocks of size 2^( 6) =       0.000414260094
  error estimate for blocks of size 2^( 7) =       0.000415614744

      target function =      -0.912626044701
              le_mean =     -17.214464827115
             les_mean =     296.637830222979
             stat err =       0.000412743294
             autocorr =       1.183399934878
   target nu stat err =       0.000412743294
   target dn stat err =       0.002272507458
      target stat err =       0.003594869066
              std dev =       0.536573541089
             le_variance =       0.287911164997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287969348262
                                         uncertainty =       0.001599553592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287969348262
                                         uncertainty =       0.001599553592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379414790
  error estimate for blocks of size 2^( 2) =       0.000390618513
  error estimate for blocks of size 2^( 3) =       0.000400971306
  error estimate for blocks of size 2^( 4) =       0.000408230478
  error estimate for blocks of size 2^( 5) =       0.000412867861
  error estimate for blocks of size 2^( 6) =       0.000414260094
  error estimate for blocks of size 2^( 7) =       0.000415614744

      target function =      -0.912626044589
              le_mean =     -17.214464827118
             les_mean =     296.637830223171
             stat err =       0.000412743294
             autocorr =       1.183399933935
   target nu stat err =       0.000412743294
   target dn stat err =       0.002272507281
      target stat err =       0.003594868797
              std dev =       0.536573541165
             le_variance =       0.287911165079


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912626044573        initial
     5.9605e+04     5.9605e+05             2.2435e-09        -0.912626044830  <--
     2.3842e+05     2.3842e+06             5.6088e-10        -0.912626044701
     9.5367e+05     9.5367e+06             1.4022e-10        -0.912626044589

*****************************************************************************
Applying the update for shift_i =   5.9605e+04     and shift_s =   5.9605e+05
*****************************************************************************

  Execution time = 2.3162e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127885e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770721e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841369e-03 3 1  ON 9
ci_011                -8.956772e-03 3 1  ON 10
ci_012                -9.103927e-03 3 1  ON 11
ci_013                -1.908576e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590758e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111012e-03 3 1  ON 17
ci_019                 9.004853e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269282e-03 3 1  ON 21
ci_023                 8.254997e-03 3 1  ON 22
ci_024                 8.343659e-03 3 1  ON 23
ci_025                 8.422060e-03 3 1  ON 24
ci_026                 9.909781e-03 3 1  ON 25
ci_027                 9.698726e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758307e-03 3 1  ON 29
ci_031                -8.616192e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550083e-03 3 1  ON 32
ci_034                 4.843627e-03 3 1  ON 33
ci_035                -3.333286e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698279e-04 3 1  ON 37
ci_039                 1.141803e-03 3 1  ON 38
ci_040                -1.556563e-03 3 1  ON 39
ci_041                 8.162407e-03 3 1  ON 40
ci_042                 8.161302e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909899e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787334e-03 3 1  ON 45
ci_047                 4.610915e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844903e-03 3 1  ON 49
ci_051                 2.987764e-03 3 1  ON 50
ci_052                -2.169813e-03 3 1  ON 51
ci_053                -2.204224e-03 3 1  ON 52
ci_054                -2.206783e-03 3 1  ON 53
ci_055                -2.424950e-03 3 1  ON 54
ci_056                 4.623352e-03 3 1  ON 55
ci_057                 4.637313e-03 3 1  ON 56
ci_058                -2.068442e-03 3 1  ON 57
ci_059                -2.051528e-03 3 1  ON 58
ci_060                 4.761571e-03 3 1  ON 59
ci_061                 5.208230e-03 3 1  ON 60
ci_062                -2.956687e-03 3 1  ON 61
ci_063                -2.806834e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384065e-03 3 1  ON 64
ci_066                 4.061277e-03 3 1  ON 65
ci_067                 4.229746e-03 3 1  ON 66
ci_068                -4.276382e-03 3 1  ON 67
ci_069                -4.116029e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9891e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1586
    reference variance = 0.233219
====================================================
  Execution time = 1.3972e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0056e-01
  Total weights = 1.957909206e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4885e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288108181603
                                         uncertainty =       0.002069889616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288108181603
                                         uncertainty =       0.002069889616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379518244
  error estimate for blocks of size 2^( 2) =       0.000390701673
  error estimate for blocks of size 2^( 3) =       0.000401296414
  error estimate for blocks of size 2^( 4) =       0.000408438858
  error estimate for blocks of size 2^( 5) =       0.000412558489
  error estimate for blocks of size 2^( 6) =       0.000415101876
  error estimate for blocks of size 2^( 7) =       0.000417296151

      target function =      -0.911810901662
              le_mean =     -17.214044149054
             les_mean =     296.623878959885
             stat err =       0.000413348843
             autocorr =       1.186227912488
   target nu stat err =       0.000413348843
   target dn stat err =       0.002676728693
      target stat err =       0.004201210332
              std dev =       0.536719847177
             le_variance =       0.288068194354


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721404414905e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911829243652       residual = 6.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911829245228       residual = 7.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911829245496       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911829245596       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911829245613       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911829245617       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911829245610       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911829245623       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911829245615       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+04 is 7.553221e-09

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911829243652       residual = 6.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911829244046       residual = 7.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911829244113       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911829244138       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911829244143       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911829244143       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911829244143       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911829244143       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911829244143       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+04 is 1.888311e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911829243652       residual = 6.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911829243751       residual = 7.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911829243767       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911829243774       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911829243775       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911829243452       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911829244003       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911829243800       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911829243775       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+05 is 4.720779e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.247715 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6470e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -3.749992e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127884e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770721e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841368e-03 3 1  ON 9
ci_011                -8.956770e-03 3 1  ON 10
ci_012                -9.103927e-03 3 1  ON 11
ci_013                -1.908576e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092741e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111012e-03 3 1  ON 17
ci_019                 9.004851e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269281e-03 3 1  ON 21
ci_023                 8.254997e-03 3 1  ON 22
ci_024                 8.343659e-03 3 1  ON 23
ci_025                 8.422060e-03 3 1  ON 24
ci_026                 9.909780e-03 3 1  ON 25
ci_027                 9.698726e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758307e-03 3 1  ON 29
ci_031                -8.616192e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550084e-03 3 1  ON 32
ci_034                 4.843627e-03 3 1  ON 33
ci_035                -3.333286e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698276e-04 3 1  ON 37
ci_039                 1.141802e-03 3 1  ON 38
ci_040                -1.556563e-03 3 1  ON 39
ci_041                 8.162408e-03 3 1  ON 40
ci_042                 8.161303e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909900e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787334e-03 3 1  ON 45
ci_047                 4.610914e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844903e-03 3 1  ON 49
ci_051                 2.987765e-03 3 1  ON 50
ci_052                -2.169813e-03 3 1  ON 51
ci_053                -2.204224e-03 3 1  ON 52
ci_054                -2.206783e-03 3 1  ON 53
ci_055                -2.424950e-03 3 1  ON 54
ci_056                 4.623352e-03 3 1  ON 55
ci_057                 4.637313e-03 3 1  ON 56
ci_058                -2.068441e-03 3 1  ON 57
ci_059                -2.051528e-03 3 1  ON 58
ci_060                 4.761571e-03 3 1  ON 59
ci_061                 5.208230e-03 3 1  ON 60
ci_062                -2.956687e-03 3 1  ON 61
ci_063                -2.806834e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384065e-03 3 1  ON 64
ci_066                 4.061277e-03 3 1  ON 65
ci_067                 4.229745e-03 3 1  ON 66
ci_068                -4.276381e-03 3 1  ON 67
ci_069                -4.116029e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1205
    reference variance = 0.218655
====================================================
  Execution time = 1.4026e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0584e-01
  Total weights = 1.9580e+06
  Execution time = 1.8076e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290289277517
                                         uncertainty =       0.001634021622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290289277517
                                         uncertainty =       0.001634021622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380983424
  error estimate for blocks of size 2^( 2) =       0.000392348839
  error estimate for blocks of size 2^( 3) =       0.000402920375
  error estimate for blocks of size 2^( 4) =       0.000410867738
  error estimate for blocks of size 2^( 5) =       0.000417626854
  error estimate for blocks of size 2^( 6) =       0.000420149011
  error estimate for blocks of size 2^( 7) =       0.000422569273

      target function =      -0.903692400918
              le_mean =     -17.214586332222
             les_mean =     296.647820316002
             stat err =       0.000417803219
             autocorr =       1.202628252594
   target nu stat err =       0.000417803219
   target dn stat err =       0.002792381184
      target stat err =       0.004306728433
              std dev =       0.538791925222
             le_variance =       0.290296738684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290289275744
                                         uncertainty =       0.001634021602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290289275744
                                         uncertainty =       0.001634021602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380983423
  error estimate for blocks of size 2^( 2) =       0.000392348838
  error estimate for blocks of size 2^( 3) =       0.000402920374
  error estimate for blocks of size 2^( 4) =       0.000410867737
  error estimate for blocks of size 2^( 5) =       0.000417626854
  error estimate for blocks of size 2^( 6) =       0.000420149011
  error estimate for blocks of size 2^( 7) =       0.000422569273

      target function =      -0.903692405228
              le_mean =     -17.214586332248
             les_mean =     296.647820314082
             stat err =       0.000417803219
             autocorr =       1.202628259995
   target nu stat err =       0.000417803219
   target dn stat err =       0.002792381026
      target stat err =       0.004306728237
              std dev =       0.538791923579
             le_variance =       0.290296736914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290289276631
                                         uncertainty =       0.001634021612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290289276631
                                         uncertainty =       0.001634021612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380983423
  error estimate for blocks of size 2^( 2) =       0.000392348838
  error estimate for blocks of size 2^( 3) =       0.000402920374
  error estimate for blocks of size 2^( 4) =       0.000410867738
  error estimate for blocks of size 2^( 5) =       0.000417626854
  error estimate for blocks of size 2^( 6) =       0.000420149011
  error estimate for blocks of size 2^( 7) =       0.000422569273

      target function =      -0.903692403073
              le_mean =     -17.214586332235
             les_mean =     296.647820315042
             stat err =       0.000417803219
             autocorr =       1.202628256286
   target nu stat err =       0.000417803219
   target dn stat err =       0.002792381105
      target stat err =       0.004306728335
              std dev =       0.538791924400
             le_variance =       0.290296737799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290289277406
                                         uncertainty =       0.001634021620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290289277406
                                         uncertainty =       0.001634021620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380983424
  error estimate for blocks of size 2^( 2) =       0.000392348839
  error estimate for blocks of size 2^( 3) =       0.000402920374
  error estimate for blocks of size 2^( 4) =       0.000410867738
  error estimate for blocks of size 2^( 5) =       0.000417626854
  error estimate for blocks of size 2^( 6) =       0.000420149011
  error estimate for blocks of size 2^( 7) =       0.000422569273

      target function =      -0.903692401188
              le_mean =     -17.214586332224
             les_mean =     296.647820315882
             stat err =       0.000417803219
             autocorr =       1.202628253051
   target nu stat err =       0.000417803219
   target dn stat err =       0.002792381174
      target stat err =       0.004306728421
              std dev =       0.538791925119
             le_variance =       0.290296738574


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.903692400918        initial
     1.4901e+04     1.4901e+05             7.5532e-09        -0.903692405228  <--
     5.9605e+04     5.9605e+05             1.8883e-09        -0.903692403073
     2.3842e+05     2.3842e+06             4.7208e-10        -0.903692401188

*****************************************************************************
Applying the update for shift_i =   1.4901e+04     and shift_s =   1.4901e+05
*****************************************************************************

  Execution time = 2.3218e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -3.749991e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362204e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127884e-02 3 1  ON 4
ci_006                -1.839315e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770720e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841367e-03 3 1  ON 9
ci_011                -8.956765e-03 3 1  ON 10
ci_012                -9.103925e-03 3 1  ON 11
ci_013                -1.908576e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092740e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111011e-03 3 1  ON 17
ci_019                 9.004847e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269280e-03 3 1  ON 21
ci_023                 8.254996e-03 3 1  ON 22
ci_024                 8.343659e-03 3 1  ON 23
ci_025                 8.422061e-03 3 1  ON 24
ci_026                 9.909778e-03 3 1  ON 25
ci_027                 9.698728e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758308e-03 3 1  ON 29
ci_031                -8.616191e-03 3 1  ON 30
ci_032                -1.432817e-02 3 1  ON 31
ci_033                 4.550085e-03 3 1  ON 32
ci_034                 4.843626e-03 3 1  ON 33
ci_035                -3.333286e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698268e-04 3 1  ON 37
ci_039                 1.141800e-03 3 1  ON 38
ci_040                -1.556561e-03 3 1  ON 39
ci_041                 8.162413e-03 3 1  ON 40
ci_042                 8.161303e-03 3 1  ON 41
ci_043                -2.343171e-03 3 1  ON 42
ci_044                -3.909903e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787334e-03 3 1  ON 45
ci_047                 4.610911e-03 3 1  ON 46
ci_048                -1.238390e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844905e-03 3 1  ON 49
ci_051                 2.987768e-03 3 1  ON 50
ci_052                -2.169811e-03 3 1  ON 51
ci_053                -2.204225e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424952e-03 3 1  ON 54
ci_056                 4.623352e-03 3 1  ON 55
ci_057                 4.637313e-03 3 1  ON 56
ci_058                -2.068441e-03 3 1  ON 57
ci_059                -2.051527e-03 3 1  ON 58
ci_060                 4.761571e-03 3 1  ON 59
ci_061                 5.208230e-03 3 1  ON 60
ci_062                -2.956687e-03 3 1  ON 61
ci_063                -2.806834e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384065e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229745e-03 3 1  ON 66
ci_068                -4.276381e-03 3 1  ON 67
ci_069                -4.116031e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9694e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1407
    reference variance = 0.24318
====================================================
  Execution time = 1.3910e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0449e-01
  Total weights = 1.957759603e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290103140075
                                         uncertainty =       0.002123392143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290103140075
                                         uncertainty =       0.002123392143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380868437
  error estimate for blocks of size 2^( 2) =       0.000392374719
  error estimate for blocks of size 2^( 3) =       0.000403051322
  error estimate for blocks of size 2^( 4) =       0.000411128299
  error estimate for blocks of size 2^( 5) =       0.000417075194
  error estimate for blocks of size 2^( 6) =       0.000419188574
  error estimate for blocks of size 2^( 7) =       0.000418988927

      target function =      -0.905744552404
              le_mean =     -17.214593311106
             les_mean =     296.646712820234
             stat err =       0.000416595248
             autocorr =       1.196406206594
   target nu stat err =       0.000416595248
   target dn stat err =       0.003003413998
      target stat err =       0.004644367671
              std dev =       0.538629308934
             le_variance =       0.290121532443


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721459331111e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905767193810       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905767212088       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905767213965       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905767214395       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905767214554       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905767214581       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905767214571       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905767214577       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905767214577       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905767214580       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+03 is 3.920408e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905767193810       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905767198380       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905767198849       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905767198956       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905767198976       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905767199010       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905767198994       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905767199015       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905767198994       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905767199020       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+04 is 9.801168e-09

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905767193810       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905767194952       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905767195070       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905767195097       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905767195121       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905767195023       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905767195004       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905767195208       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905767195089       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905767195073       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+04 is 2.450301e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251231 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6406e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -3.749991e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127883e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770714e-03 3 1  ON 7
ci_009                -1.388525e-02 3 1  ON 8
ci_010                -8.841366e-03 3 1  ON 9
ci_011                -8.956774e-03 3 1  ON 10
ci_012                -9.103924e-03 3 1  ON 11
ci_013                -1.908576e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092740e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564055e-02 3 1  ON 16
ci_018                 9.111001e-03 3 1  ON 17
ci_019                 9.004843e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269276e-03 3 1  ON 21
ci_023                 8.254996e-03 3 1  ON 22
ci_024                 8.343666e-03 3 1  ON 23
ci_025                 8.422063e-03 3 1  ON 24
ci_026                 9.909774e-03 3 1  ON 25
ci_027                 9.698730e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758305e-03 3 1  ON 29
ci_031                -8.616196e-03 3 1  ON 30
ci_032                -1.432817e-02 3 1  ON 31
ci_033                 4.550090e-03 3 1  ON 32
ci_034                 4.843623e-03 3 1  ON 33
ci_035                -3.333286e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698274e-04 3 1  ON 37
ci_039                 1.141796e-03 3 1  ON 38
ci_040                -1.556558e-03 3 1  ON 39
ci_041                 8.162416e-03 3 1  ON 40
ci_042                 8.161298e-03 3 1  ON 41
ci_043                -2.343170e-03 3 1  ON 42
ci_044                -3.909902e-03 3 1  ON 43
ci_045                -1.989961e-03 3 1  ON 44
ci_046                 4.787332e-03 3 1  ON 45
ci_047                 4.610909e-03 3 1  ON 46
ci_048                -1.238390e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844906e-03 3 1  ON 49
ci_051                 2.987767e-03 3 1  ON 50
ci_052                -2.169816e-03 3 1  ON 51
ci_053                -2.204223e-03 3 1  ON 52
ci_054                -2.206781e-03 3 1  ON 53
ci_055                -2.424953e-03 3 1  ON 54
ci_056                 4.623354e-03 3 1  ON 55
ci_057                 4.637309e-03 3 1  ON 56
ci_058                -2.068436e-03 3 1  ON 57
ci_059                -2.051524e-03 3 1  ON 58
ci_060                 4.761563e-03 3 1  ON 59
ci_061                 5.208233e-03 3 1  ON 60
ci_062                -2.956686e-03 3 1  ON 61
ci_063                -2.806830e-03 3 1  ON 62
ci_064                -2.259151e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061276e-03 3 1  ON 65
ci_067                 4.229740e-03 3 1  ON 66
ci_068                -4.276389e-03 3 1  ON 67
ci_069                -4.116027e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1041
    reference variance = 0.445918
====================================================
  Execution time = 1.3781e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0418e-01
  Total weights = 1.9578e+06
  Execution time = 1.8087e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288729174818
                                         uncertainty =       0.001535744407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288729174818
                                         uncertainty =       0.001535744407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379987832
  error estimate for blocks of size 2^( 2) =       0.000391291667
  error estimate for blocks of size 2^( 3) =       0.000401603405
  error estimate for blocks of size 2^( 4) =       0.000409741190
  error estimate for blocks of size 2^( 5) =       0.000414572063
  error estimate for blocks of size 2^( 6) =       0.000416355992
  error estimate for blocks of size 2^( 7) =       0.000418740155

      target function =      -0.906228087365
              le_mean =     -17.214301794200
             les_mean =     296.636370501636
             stat err =       0.000414852350
             autocorr =       1.191921703185
   target nu stat err =       0.000414852350
   target dn stat err =       0.002807859249
      target stat err =       0.004350867264
              std dev =       0.537383946221
             le_variance =       0.288781505657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288729171679
                                         uncertainty =       0.001535744641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288729171679
                                         uncertainty =       0.001535744641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379987830
  error estimate for blocks of size 2^( 2) =       0.000391291666
  error estimate for blocks of size 2^( 3) =       0.000401603405
  error estimate for blocks of size 2^( 4) =       0.000409741190
  error estimate for blocks of size 2^( 5) =       0.000414572064
  error estimate for blocks of size 2^( 6) =       0.000416355994
  error estimate for blocks of size 2^( 7) =       0.000418740155

      target function =      -0.906228043134
              le_mean =     -17.214301793850
             les_mean =     296.636370518445
             stat err =       0.000414852351
             autocorr =       1.191921723455
   target nu stat err =       0.000414852351
   target dn stat err =       0.002807866194
      target stat err =       0.004350877325
              std dev =       0.537383943359
             le_variance =       0.288781502581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288729173248
                                         uncertainty =       0.001535744524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288729173248
                                         uncertainty =       0.001535744524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379987831
  error estimate for blocks of size 2^( 2) =       0.000391291666
  error estimate for blocks of size 2^( 3) =       0.000401603405
  error estimate for blocks of size 2^( 4) =       0.000409741190
  error estimate for blocks of size 2^( 5) =       0.000414572063
  error estimate for blocks of size 2^( 6) =       0.000416355993
  error estimate for blocks of size 2^( 7) =       0.000418740155

      target function =      -0.906228065543
              le_mean =     -17.214301794025
             les_mean =     296.636370509848
             stat err =       0.000414852350
             autocorr =       1.191921713307
   target nu stat err =       0.000414852350
   target dn stat err =       0.002807862720
      target stat err =       0.004350872295
              std dev =       0.537383944790
             le_variance =       0.288781504118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288729174621
                                         uncertainty =       0.001535744422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288729174621
                                         uncertainty =       0.001535744422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379987832
  error estimate for blocks of size 2^( 2) =       0.000391291667
  error estimate for blocks of size 2^( 3) =       0.000401603405
  error estimate for blocks of size 2^( 4) =       0.000409741190
  error estimate for blocks of size 2^( 5) =       0.000414572063
  error estimate for blocks of size 2^( 6) =       0.000416355992
  error estimate for blocks of size 2^( 7) =       0.000418740155

      target function =      -0.906228084669
              le_mean =     -17.214301794178
             les_mean =     296.636370502642
             stat err =       0.000414852350
             autocorr =       1.191921704446
   target nu stat err =       0.000414852350
   target dn stat err =       0.002807859683
      target stat err =       0.004350867893
              std dev =       0.537383946043
             le_variance =       0.288781505464


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.906228087365        initial  <--
     3.7253e+03     3.7253e+04             3.9204e-08        -0.906228043134
     1.4901e+04     1.4901e+05             9.8012e-09        -0.906228065543
     5.9605e+04     5.9605e+05             2.4503e-09        -0.906228084669

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9513
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -3.749991e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362204e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127884e-02 3 1  ON 4
ci_006                -1.839315e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770720e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841367e-03 3 1  ON 9
ci_011                -8.956765e-03 3 1  ON 10
ci_012                -9.103925e-03 3 1  ON 11
ci_013                -1.908576e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092740e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111011e-03 3 1  ON 17
ci_019                 9.004847e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269280e-03 3 1  ON 21
ci_023                 8.254996e-03 3 1  ON 22
ci_024                 8.343659e-03 3 1  ON 23
ci_025                 8.422061e-03 3 1  ON 24
ci_026                 9.909778e-03 3 1  ON 25
ci_027                 9.698728e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758308e-03 3 1  ON 29
ci_031                -8.616191e-03 3 1  ON 30
ci_032                -1.432817e-02 3 1  ON 31
ci_033                 4.550085e-03 3 1  ON 32
ci_034                 4.843626e-03 3 1  ON 33
ci_035                -3.333286e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698268e-04 3 1  ON 37
ci_039                 1.141800e-03 3 1  ON 38
ci_040                -1.556561e-03 3 1  ON 39
ci_041                 8.162413e-03 3 1  ON 40
ci_042                 8.161303e-03 3 1  ON 41
ci_043                -2.343171e-03 3 1  ON 42
ci_044                -3.909903e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787334e-03 3 1  ON 45
ci_047                 4.610911e-03 3 1  ON 46
ci_048                -1.238390e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844905e-03 3 1  ON 49
ci_051                 2.987768e-03 3 1  ON 50
ci_052                -2.169811e-03 3 1  ON 51
ci_053                -2.204225e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424952e-03 3 1  ON 54
ci_056                 4.623352e-03 3 1  ON 55
ci_057                 4.637313e-03 3 1  ON 56
ci_058                -2.068441e-03 3 1  ON 57
ci_059                -2.051527e-03 3 1  ON 58
ci_060                 4.761571e-03 3 1  ON 59
ci_061                 5.208230e-03 3 1  ON 60
ci_062                -2.956687e-03 3 1  ON 61
ci_063                -2.806834e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384065e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229745e-03 3 1  ON 66
ci_068                -4.276381e-03 3 1  ON 67
ci_069                -4.116031e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9363e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.2422
    reference variance = 0.247067
====================================================
  Execution time = 1.3978e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5311e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9388e-01
  Total weights = 1.957605779e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282797434342
                                         uncertainty =       0.001536011342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282797434342
                                         uncertainty =       0.001536011342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376003838
  error estimate for blocks of size 2^( 2) =       0.000387080806
  error estimate for blocks of size 2^( 3) =       0.000397220197
  error estimate for blocks of size 2^( 4) =       0.000405163109
  error estimate for blocks of size 2^( 5) =       0.000409294283
  error estimate for blocks of size 2^( 6) =       0.000412596516
  error estimate for blocks of size 2^( 7) =       0.000413984447

      target function =      -0.922271983384
              le_mean =     -17.214670113007
             les_mean =     296.638746247885
             stat err =       0.000410259589
             autocorr =       1.190509660156
   target nu stat err =       0.000410259589
   target dn stat err =       0.001869618098
      target stat err =       0.003046141118
              std dev =       0.531749727775
             le_variance =       0.282757772989


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721467011301e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922281087921       residual = 6.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922281088650       residual = 7.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922281088741       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922281088796       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922281088760       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922281088817       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922281088790       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922281088812       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922281088860       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922281088799       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+04 is 2.655576e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922281087921       residual = 6.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922281088104       residual = 7.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922281088126       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922281088140       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922281088164       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922281088200       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922281088142       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922281088179       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922281088103       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922281088171       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+05 is 6.638949e-10

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922281087921       residual = 6.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922281087967       residual = 7.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922281087973       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922281087976       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922281087976       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922281086920       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922281088131       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922281087949       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922281087884       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922281087325       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+05 is 1.659738e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.254672 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6467e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -3.749991e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362204e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127884e-02 3 1  ON 4
ci_006                -1.839315e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770719e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841367e-03 3 1  ON 9
ci_011                -8.956766e-03 3 1  ON 10
ci_012                -9.103925e-03 3 1  ON 11
ci_013                -1.908576e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092740e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111011e-03 3 1  ON 17
ci_019                 9.004847e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269280e-03 3 1  ON 21
ci_023                 8.254996e-03 3 1  ON 22
ci_024                 8.343659e-03 3 1  ON 23
ci_025                 8.422061e-03 3 1  ON 24
ci_026                 9.909778e-03 3 1  ON 25
ci_027                 9.698728e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758308e-03 3 1  ON 29
ci_031                -8.616191e-03 3 1  ON 30
ci_032                -1.432817e-02 3 1  ON 31
ci_033                 4.550085e-03 3 1  ON 32
ci_034                 4.843626e-03 3 1  ON 33
ci_035                -3.333286e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698268e-04 3 1  ON 37
ci_039                 1.141800e-03 3 1  ON 38
ci_040                -1.556561e-03 3 1  ON 39
ci_041                 8.162413e-03 3 1  ON 40
ci_042                 8.161303e-03 3 1  ON 41
ci_043                -2.343170e-03 3 1  ON 42
ci_044                -3.909903e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787334e-03 3 1  ON 45
ci_047                 4.610911e-03 3 1  ON 46
ci_048                -1.238390e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844905e-03 3 1  ON 49
ci_051                 2.987768e-03 3 1  ON 50
ci_052                -2.169811e-03 3 1  ON 51
ci_053                -2.204225e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424952e-03 3 1  ON 54
ci_056                 4.623353e-03 3 1  ON 55
ci_057                 4.637313e-03 3 1  ON 56
ci_058                -2.068442e-03 3 1  ON 57
ci_059                -2.051526e-03 3 1  ON 58
ci_060                 4.761572e-03 3 1  ON 59
ci_061                 5.208229e-03 3 1  ON 60
ci_062                -2.956687e-03 3 1  ON 61
ci_063                -2.806834e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384065e-03 3 1  ON 64
ci_066                 4.061277e-03 3 1  ON 65
ci_067                 4.229745e-03 3 1  ON 66
ci_068                -4.276380e-03 3 1  ON 67
ci_069                -4.116031e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.267
    reference variance = 0.265095
====================================================
  Execution time = 1.3475e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0446e-01
  Total weights = 1.9579e+06
  Execution time = 1.8184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290942057513
                                         uncertainty =       0.002153912813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290942057513
                                         uncertainty =       0.002153912813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381359993
  error estimate for blocks of size 2^( 2) =       0.000392334623
  error estimate for blocks of size 2^( 3) =       0.000402641380
  error estimate for blocks of size 2^( 4) =       0.000410471730
  error estimate for blocks of size 2^( 5) =       0.000415321366
  error estimate for blocks of size 2^( 6) =       0.000418254372
  error estimate for blocks of size 2^( 7) =       0.000419795496

      target function =      -0.905800661694
              le_mean =     -17.214505984031
             les_mean =     296.643674849200
             stat err =       0.000415960741
             autocorr =       1.189691682794
   target nu stat err =       0.000415960741
   target dn stat err =       0.002727446005
      target stat err =       0.004227513974
              std dev =       0.539324473644
             le_variance =       0.290870887871

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290942057370
                                         uncertainty =       0.002153912840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290942057370
                                         uncertainty =       0.002153912840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381359992
  error estimate for blocks of size 2^( 2) =       0.000392334622
  error estimate for blocks of size 2^( 3) =       0.000402641379
  error estimate for blocks of size 2^( 4) =       0.000410471730
  error estimate for blocks of size 2^( 5) =       0.000415321366
  error estimate for blocks of size 2^( 6) =       0.000418254372
  error estimate for blocks of size 2^( 7) =       0.000419795496

      target function =      -0.905800663301
              le_mean =     -17.214505984033
             les_mean =     296.643674848225
             stat err =       0.000415960741
             autocorr =       1.189691682659
   target nu stat err =       0.000415960741
   target dn stat err =       0.002727445500
      target stat err =       0.004227513228
              std dev =       0.539324473509
             le_variance =       0.290870887726

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290942057441
                                         uncertainty =       0.002153912826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290942057441
                                         uncertainty =       0.002153912826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381359993
  error estimate for blocks of size 2^( 2) =       0.000392334623
  error estimate for blocks of size 2^( 3) =       0.000402641379
  error estimate for blocks of size 2^( 4) =       0.000410471730
  error estimate for blocks of size 2^( 5) =       0.000415321366
  error estimate for blocks of size 2^( 6) =       0.000418254372
  error estimate for blocks of size 2^( 7) =       0.000419795496

      target function =      -0.905800662498
              le_mean =     -17.214505984032
             les_mean =     296.643674848712
             stat err =       0.000415960741
             autocorr =       1.189691682732
   target nu stat err =       0.000415960741
   target dn stat err =       0.002727445752
      target stat err =       0.004227513601
              std dev =       0.539324473577
             le_variance =       0.290870887799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290942057504
                                         uncertainty =       0.002153912815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290942057504
                                         uncertainty =       0.002153912815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381359993
  error estimate for blocks of size 2^( 2) =       0.000392334623
  error estimate for blocks of size 2^( 3) =       0.000402641380
  error estimate for blocks of size 2^( 4) =       0.000410471730
  error estimate for blocks of size 2^( 5) =       0.000415321366
  error estimate for blocks of size 2^( 6) =       0.000418254372
  error estimate for blocks of size 2^( 7) =       0.000419795496

      target function =      -0.905800661795
              le_mean =     -17.214505984031
             les_mean =     296.643674849139
             stat err =       0.000415960741
             autocorr =       1.189691682796
   target nu stat err =       0.000415960741
   target dn stat err =       0.002727445973
      target stat err =       0.004227513927
              std dev =       0.539324473636
             le_variance =       0.290870887862


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.905800661694        initial
     3.7253e+04     3.7253e+05             2.6556e-09        -0.905800663301  <--
     1.4901e+05     1.4901e+06             6.6389e-10        -0.905800662498
     5.9605e+05     5.9605e+06             1.6597e-10        -0.905800661795

*****************************************************************************
Applying the update for shift_i =   3.7253e+04     and shift_s =   3.7253e+05
*****************************************************************************

  Execution time = 2.2648e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -3.749991e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362204e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127884e-02 3 1  ON 4
ci_006                -1.839315e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770718e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841367e-03 3 1  ON 9
ci_011                -8.956766e-03 3 1  ON 10
ci_012                -9.103925e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092740e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564055e-02 3 1  ON 16
ci_018                 9.111010e-03 3 1  ON 17
ci_019                 9.004849e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269280e-03 3 1  ON 21
ci_023                 8.254996e-03 3 1  ON 22
ci_024                 8.343659e-03 3 1  ON 23
ci_025                 8.422060e-03 3 1  ON 24
ci_026                 9.909778e-03 3 1  ON 25
ci_027                 9.698728e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479642e-02 3 1  ON 28
ci_030                -8.758308e-03 3 1  ON 29
ci_031                -8.616192e-03 3 1  ON 30
ci_032                -1.432817e-02 3 1  ON 31
ci_033                 4.550085e-03 3 1  ON 32
ci_034                 4.843627e-03 3 1  ON 33
ci_035                -3.333285e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698265e-04 3 1  ON 37
ci_039                 1.141800e-03 3 1  ON 38
ci_040                -1.556561e-03 3 1  ON 39
ci_041                 8.162413e-03 3 1  ON 40
ci_042                 8.161304e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909902e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787332e-03 3 1  ON 45
ci_047                 4.610911e-03 3 1  ON 46
ci_048                -1.238390e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844905e-03 3 1  ON 49
ci_051                 2.987769e-03 3 1  ON 50
ci_052                -2.169813e-03 3 1  ON 51
ci_053                -2.204225e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424952e-03 3 1  ON 54
ci_056                 4.623353e-03 3 1  ON 55
ci_057                 4.637313e-03 3 1  ON 56
ci_058                -2.068442e-03 3 1  ON 57
ci_059                -2.051526e-03 3 1  ON 58
ci_060                 4.761573e-03 3 1  ON 59
ci_061                 5.208228e-03 3 1  ON 60
ci_062                -2.956686e-03 3 1  ON 61
ci_063                -2.806834e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384065e-03 3 1  ON 64
ci_066                 4.061277e-03 3 1  ON 65
ci_067                 4.229745e-03 3 1  ON 66
ci_068                -4.276380e-03 3 1  ON 67
ci_069                -4.116033e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9123e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2037
    reference variance = 0.192917
====================================================
  Execution time = 1.3843e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5317e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0205e-01
  Total weights = 1.957753489e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5274e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288034907157
                                         uncertainty =       0.001814072052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288034907157
                                         uncertainty =       0.001814072052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379511170
  error estimate for blocks of size 2^( 2) =       0.000390974089
  error estimate for blocks of size 2^( 3) =       0.000401368378
  error estimate for blocks of size 2^( 4) =       0.000408995293
  error estimate for blocks of size 2^( 5) =       0.000414168163
  error estimate for blocks of size 2^( 6) =       0.000416266694
  error estimate for blocks of size 2^( 7) =       0.000415119945

      target function =      -0.909487553729
              le_mean =     -17.214598444755
             les_mean =     296.644454242994
             stat err =       0.000413637524
             autocorr =       1.187929682289
   target nu stat err =       0.000413637524
   target dn stat err =       0.002609242977
      target stat err =       0.004082017923
              std dev =       0.536709843094
             le_variance =       0.288057455674


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721459844475e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909504943169       residual = 1.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909504951313       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909504952201       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909504952379       residual = 7.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909504952427       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909504952436       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909504952434       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909504952463       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909504952445       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909504952448       residual = 6.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+03 is 2.240618e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909504943169       residual = 1.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909504945205       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909504945427       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909504945477       residual = 7.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909504945449       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909504945470       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909504945455       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909504945487       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909504945474       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909504945446       residual = 6.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+04 is 5.601576e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909504943169       residual = 1.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909504943678       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909504943733       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909504943747       residual = 7.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909504943894       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909504943522       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909504943748       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909504943748       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909504944033       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909504943756       residual = 6.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+05 is 1.400396e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.258181 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6382e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -3.749991e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362204e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127884e-02 3 1  ON 4
ci_006                -1.839315e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770716e-03 3 1  ON 7
ci_009                -1.388525e-02 3 1  ON 8
ci_010                -8.841370e-03 3 1  ON 9
ci_011                -8.956766e-03 3 1  ON 10
ci_012                -9.103922e-03 3 1  ON 11
ci_013                -1.908576e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092740e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564054e-02 3 1  ON 16
ci_018                 9.111009e-03 3 1  ON 17
ci_019                 9.004851e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269280e-03 3 1  ON 21
ci_023                 8.254996e-03 3 1  ON 22
ci_024                 8.343657e-03 3 1  ON 23
ci_025                 8.422056e-03 3 1  ON 24
ci_026                 9.909781e-03 3 1  ON 25
ci_027                 9.698729e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758309e-03 3 1  ON 29
ci_031                -8.616193e-03 3 1  ON 30
ci_032                -1.432817e-02 3 1  ON 31
ci_033                 4.550086e-03 3 1  ON 32
ci_034                 4.843627e-03 3 1  ON 33
ci_035                -3.333286e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698273e-04 3 1  ON 37
ci_039                 1.141801e-03 3 1  ON 38
ci_040                -1.556561e-03 3 1  ON 39
ci_041                 8.162412e-03 3 1  ON 40
ci_042                 8.161301e-03 3 1  ON 41
ci_043                -2.343168e-03 3 1  ON 42
ci_044                -3.909901e-03 3 1  ON 43
ci_045                -1.989961e-03 3 1  ON 44
ci_046                 4.787332e-03 3 1  ON 45
ci_047                 4.610911e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844905e-03 3 1  ON 49
ci_051                 2.987767e-03 3 1  ON 50
ci_052                -2.169816e-03 3 1  ON 51
ci_053                -2.204224e-03 3 1  ON 52
ci_054                -2.206781e-03 3 1  ON 53
ci_055                -2.424951e-03 3 1  ON 54
ci_056                 4.623351e-03 3 1  ON 55
ci_057                 4.637312e-03 3 1  ON 56
ci_058                -2.068440e-03 3 1  ON 57
ci_059                -2.051526e-03 3 1  ON 58
ci_060                 4.761579e-03 3 1  ON 59
ci_061                 5.208228e-03 3 1  ON 60
ci_062                -2.956686e-03 3 1  ON 61
ci_063                -2.806835e-03 3 1  ON 62
ci_064                -2.259152e-03 3 1  ON 63
ci_065                -3.384065e-03 3 1  ON 64
ci_066                 4.061276e-03 3 1  ON 65
ci_067                 4.229746e-03 3 1  ON 66
ci_068                -4.276381e-03 3 1  ON 67
ci_069                -4.116034e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2415
    reference variance = 0.172061
====================================================
  Execution time = 1.3610e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0189e-01
  Total weights = 1.9577e+06
  Execution time = 1.8470e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286586666662
                                         uncertainty =       0.001891922883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286586666662
                                         uncertainty =       0.001891922883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378494156
  error estimate for blocks of size 2^( 2) =       0.000389965755
  error estimate for blocks of size 2^( 3) =       0.000400370718
  error estimate for blocks of size 2^( 4) =       0.000407948912
  error estimate for blocks of size 2^( 5) =       0.000413006194
  error estimate for blocks of size 2^( 6) =       0.000414324968
  error estimate for blocks of size 2^( 7) =       0.000417043718

      target function =      -0.909718730135
              le_mean =     -17.214634738120
             les_mean =     296.645539525456
             stat err =       0.000413080948
             autocorr =       1.191110278193
   target nu stat err =       0.000413080948
   target dn stat err =       0.003835045453
      target stat err =       0.005955452266
              std dev =       0.535271569010
             le_variance =       0.286515652590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286586666109
                                         uncertainty =       0.001891923048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286586666109
                                         uncertainty =       0.001891923048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378494156
  error estimate for blocks of size 2^( 2) =       0.000389965755
  error estimate for blocks of size 2^( 3) =       0.000400370718
  error estimate for blocks of size 2^( 4) =       0.000407948912
  error estimate for blocks of size 2^( 5) =       0.000413006193
  error estimate for blocks of size 2^( 6) =       0.000414324967
  error estimate for blocks of size 2^( 7) =       0.000417043717

      target function =      -0.909718441671
              le_mean =     -17.214634738125
             les_mean =     296.645539711067
             stat err =       0.000413080948
             autocorr =       1.191110279548
   target nu stat err =       0.000413080948
   target dn stat err =       0.003835169730
      target stat err =       0.005955638853
              std dev =       0.535271568491
             le_variance =       0.286515652035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286586666385
                                         uncertainty =       0.001891922966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286586666385
                                         uncertainty =       0.001891922966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378494156
  error estimate for blocks of size 2^( 2) =       0.000389965755
  error estimate for blocks of size 2^( 3) =       0.000400370718
  error estimate for blocks of size 2^( 4) =       0.000407948912
  error estimate for blocks of size 2^( 5) =       0.000413006194
  error estimate for blocks of size 2^( 6) =       0.000414324968
  error estimate for blocks of size 2^( 7) =       0.000417043717

      target function =      -0.909718585931
              le_mean =     -17.214634738123
             les_mean =     296.645539618243
             stat err =       0.000413080948
             autocorr =       1.191110278870
   target nu stat err =       0.000413080948
   target dn stat err =       0.003835107589
      target stat err =       0.005955545557
              std dev =       0.535271568751
             le_variance =       0.286515652313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286586666627
                                         uncertainty =       0.001891922894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286586666627
                                         uncertainty =       0.001891922894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378494156
  error estimate for blocks of size 2^( 2) =       0.000389965755
  error estimate for blocks of size 2^( 3) =       0.000400370718
  error estimate for blocks of size 2^( 4) =       0.000407948912
  error estimate for blocks of size 2^( 5) =       0.000413006194
  error estimate for blocks of size 2^( 6) =       0.000414324968
  error estimate for blocks of size 2^( 7) =       0.000417043717

      target function =      -0.909718712112
              le_mean =     -17.214634738121
             les_mean =     296.645539537053
             stat err =       0.000413080948
             autocorr =       1.191110278284
   target nu stat err =       0.000413080948
   target dn stat err =       0.003835053220
      target stat err =       0.005955463927
              std dev =       0.535271568977
             le_variance =       0.286515652556


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909718730135        initial  <--
     9.3132e+03     9.3132e+04             2.2406e-08        -0.909718441671
     3.7253e+04     3.7253e+05             5.6016e-09        -0.909718585931
     1.4901e+05     1.4901e+06             1.4004e-09        -0.909718712112

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9285
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -3.749991e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362204e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127884e-02 3 1  ON 4
ci_006                -1.839315e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770718e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841367e-03 3 1  ON 9
ci_011                -8.956766e-03 3 1  ON 10
ci_012                -9.103925e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092740e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564055e-02 3 1  ON 16
ci_018                 9.111010e-03 3 1  ON 17
ci_019                 9.004849e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269280e-03 3 1  ON 21
ci_023                 8.254996e-03 3 1  ON 22
ci_024                 8.343659e-03 3 1  ON 23
ci_025                 8.422060e-03 3 1  ON 24
ci_026                 9.909778e-03 3 1  ON 25
ci_027                 9.698728e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479642e-02 3 1  ON 28
ci_030                -8.758308e-03 3 1  ON 29
ci_031                -8.616192e-03 3 1  ON 30
ci_032                -1.432817e-02 3 1  ON 31
ci_033                 4.550085e-03 3 1  ON 32
ci_034                 4.843627e-03 3 1  ON 33
ci_035                -3.333285e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698265e-04 3 1  ON 37
ci_039                 1.141800e-03 3 1  ON 38
ci_040                -1.556561e-03 3 1  ON 39
ci_041                 8.162413e-03 3 1  ON 40
ci_042                 8.161304e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909902e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787332e-03 3 1  ON 45
ci_047                 4.610911e-03 3 1  ON 46
ci_048                -1.238390e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844905e-03 3 1  ON 49
ci_051                 2.987769e-03 3 1  ON 50
ci_052                -2.169813e-03 3 1  ON 51
ci_053                -2.204225e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424952e-03 3 1  ON 54
ci_056                 4.623353e-03 3 1  ON 55
ci_057                 4.637313e-03 3 1  ON 56
ci_058                -2.068442e-03 3 1  ON 57
ci_059                -2.051526e-03 3 1  ON 58
ci_060                 4.761573e-03 3 1  ON 59
ci_061                 5.208228e-03 3 1  ON 60
ci_062                -2.956686e-03 3 1  ON 61
ci_063                -2.806834e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384065e-03 3 1  ON 64
ci_066                 4.061277e-03 3 1  ON 65
ci_067                 4.229745e-03 3 1  ON 66
ci_068                -4.276380e-03 3 1  ON 67
ci_069                -4.116033e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9317e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2442
    reference variance = 0.204668
====================================================
  Execution time = 1.3730e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0175e-01
  Total weights = 1.957712610e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5055e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288640336056
                                         uncertainty =       0.001626998680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288640336056
                                         uncertainty =       0.001626998680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379888702
  error estimate for blocks of size 2^( 2) =       0.000391138201
  error estimate for blocks of size 2^( 3) =       0.000401210463
  error estimate for blocks of size 2^( 4) =       0.000408670727
  error estimate for blocks of size 2^( 5) =       0.000413774217
  error estimate for blocks of size 2^( 6) =       0.000415185698
  error estimate for blocks of size 2^( 7) =       0.000416584377

      target function =      -0.909894506846
              le_mean =     -17.216016714939
             les_mean =     296.692980489669
             stat err =       0.000413553755
             autocorr =       1.185089583341
   target nu stat err =       0.000413553755
   target dn stat err =       0.002967247504
      target stat err =       0.004642920341
              std dev =       0.537243755019
             le_variance =       0.288630852307


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721601671494e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909917224131       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909917224760       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909917224818       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909917224838       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909917224842       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909917224950       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909917224688       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909917224843       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909917224843       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909917224843       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+04 is 2.015243e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909917224131       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909917224288       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909917224303       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909917224308       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909917224309       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909917223973       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909917225231       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909917224309       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909917224337       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909917223739       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+05 is 5.038111e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909917224131       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909917224170       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909917224174       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909917224175       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909917226287       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909917224175       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909917222314       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909917225337       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909917226141       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909917228595       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+06 is 1.259528e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.261685 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6245e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -3.749991e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362204e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127884e-02 3 1  ON 4
ci_006                -1.839315e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770718e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841367e-03 3 1  ON 9
ci_011                -8.956766e-03 3 1  ON 10
ci_012                -9.103925e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092740e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564055e-02 3 1  ON 16
ci_018                 9.111010e-03 3 1  ON 17
ci_019                 9.004849e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269280e-03 3 1  ON 21
ci_023                 8.254996e-03 3 1  ON 22
ci_024                 8.343659e-03 3 1  ON 23
ci_025                 8.422059e-03 3 1  ON 24
ci_026                 9.909778e-03 3 1  ON 25
ci_027                 9.698728e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479642e-02 3 1  ON 28
ci_030                -8.758309e-03 3 1  ON 29
ci_031                -8.616192e-03 3 1  ON 30
ci_032                -1.432817e-02 3 1  ON 31
ci_033                 4.550085e-03 3 1  ON 32
ci_034                 4.843627e-03 3 1  ON 33
ci_035                -3.333285e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698265e-04 3 1  ON 37
ci_039                 1.141800e-03 3 1  ON 38
ci_040                -1.556561e-03 3 1  ON 39
ci_041                 8.162412e-03 3 1  ON 40
ci_042                 8.161304e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909903e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787332e-03 3 1  ON 45
ci_047                 4.610911e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844905e-03 3 1  ON 49
ci_051                 2.987769e-03 3 1  ON 50
ci_052                -2.169813e-03 3 1  ON 51
ci_053                -2.204225e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424951e-03 3 1  ON 54
ci_056                 4.623353e-03 3 1  ON 55
ci_057                 4.637312e-03 3 1  ON 56
ci_058                -2.068442e-03 3 1  ON 57
ci_059                -2.051526e-03 3 1  ON 58
ci_060                 4.761573e-03 3 1  ON 59
ci_061                 5.208228e-03 3 1  ON 60
ci_062                -2.956686e-03 3 1  ON 61
ci_063                -2.806834e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384065e-03 3 1  ON 64
ci_066                 4.061277e-03 3 1  ON 65
ci_067                 4.229745e-03 3 1  ON 66
ci_068                -4.276380e-03 3 1  ON 67
ci_069                -4.116033e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.1901
    reference variance = 0.244411
====================================================
  Execution time = 1.3574e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0174e-01
  Total weights = 1.9579e+06
  Execution time = 1.8178e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288951583054
                                         uncertainty =       0.001632675238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288951583054
                                         uncertainty =       0.001632675238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380102282
  error estimate for blocks of size 2^( 2) =       0.000391569857
  error estimate for blocks of size 2^( 3) =       0.000402268442
  error estimate for blocks of size 2^( 4) =       0.000409765549
  error estimate for blocks of size 2^( 5) =       0.000413675191
  error estimate for blocks of size 2^( 6) =       0.000415268148
  error estimate for blocks of size 2^( 7) =       0.000416945465

      target function =      -0.909963061209
              le_mean =     -17.214772148686
             les_mean =     296.650124648150
             stat err =       0.000413913588
             autocorr =       1.185819026532
   target nu stat err =       0.000413913588
   target dn stat err =       0.002286324077
      target stat err =       0.003597667031
              std dev =       0.537545801977
             le_variance =       0.288955489223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288951583061
                                         uncertainty =       0.001632675259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288951583061
                                         uncertainty =       0.001632675259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380102282
  error estimate for blocks of size 2^( 2) =       0.000391569857
  error estimate for blocks of size 2^( 3) =       0.000402268442
  error estimate for blocks of size 2^( 4) =       0.000409765549
  error estimate for blocks of size 2^( 5) =       0.000413675192
  error estimate for blocks of size 2^( 6) =       0.000415268148
  error estimate for blocks of size 2^( 7) =       0.000416945465

      target function =      -0.909963090378
              le_mean =     -17.214772148700
             les_mean =     296.650124629736
             stat err =       0.000413913588
             autocorr =       1.185819026714
   target nu stat err =       0.000413913588
   target dn stat err =       0.002286323587
      target stat err =       0.003597666516
              std dev =       0.537545801982
             le_variance =       0.288955489229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288951583058
                                         uncertainty =       0.001632675248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288951583058
                                         uncertainty =       0.001632675248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380102282
  error estimate for blocks of size 2^( 2) =       0.000391569857
  error estimate for blocks of size 2^( 3) =       0.000402268442
  error estimate for blocks of size 2^( 4) =       0.000409765549
  error estimate for blocks of size 2^( 5) =       0.000413675192
  error estimate for blocks of size 2^( 6) =       0.000415268148
  error estimate for blocks of size 2^( 7) =       0.000416945465

      target function =      -0.909963075800
              le_mean =     -17.214772148693
             les_mean =     296.650124638939
             stat err =       0.000413913588
             autocorr =       1.185819026621
   target nu stat err =       0.000413913588
   target dn stat err =       0.002286323831
      target stat err =       0.003597666773
              std dev =       0.537545801979
             le_variance =       0.288955489226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288951583055
                                         uncertainty =       0.001632675239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288951583055
                                         uncertainty =       0.001632675239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380102282
  error estimate for blocks of size 2^( 2) =       0.000391569857
  error estimate for blocks of size 2^( 3) =       0.000402268442
  error estimate for blocks of size 2^( 4) =       0.000409765549
  error estimate for blocks of size 2^( 5) =       0.000413675191
  error estimate for blocks of size 2^( 6) =       0.000415268148
  error estimate for blocks of size 2^( 7) =       0.000416945465

      target function =      -0.909963063033
              le_mean =     -17.214772148687
             les_mean =     296.650124646999
             stat err =       0.000413913588
             autocorr =       1.185819026544
   target nu stat err =       0.000413913588
   target dn stat err =       0.002286324046
      target stat err =       0.003597666999
              std dev =       0.537545801977
             le_variance =       0.288955489223


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909963061209        initial
     9.3132e+04     9.3132e+05             2.0152e-09        -0.909963090378  <--
     3.7253e+05     3.7253e+06             5.0381e-10        -0.909963075800
     1.4901e+06     1.4901e+07             1.2595e-10        -0.909963063033

*****************************************************************************
Applying the update for shift_i =   9.3132e+04     and shift_s =   9.3132e+05
*****************************************************************************

  Execution time = 2.2775e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -3.749991e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362204e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127884e-02 3 1  ON 4
ci_006                -1.839315e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770718e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841367e-03 3 1  ON 9
ci_011                -8.956766e-03 3 1  ON 10
ci_012                -9.103925e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092740e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564055e-02 3 1  ON 16
ci_018                 9.111010e-03 3 1  ON 17
ci_019                 9.004849e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269281e-03 3 1  ON 21
ci_023                 8.254996e-03 3 1  ON 22
ci_024                 8.343659e-03 3 1  ON 23
ci_025                 8.422059e-03 3 1  ON 24
ci_026                 9.909777e-03 3 1  ON 25
ci_027                 9.698728e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479642e-02 3 1  ON 28
ci_030                -8.758309e-03 3 1  ON 29
ci_031                -8.616192e-03 3 1  ON 30
ci_032                -1.432817e-02 3 1  ON 31
ci_033                 4.550086e-03 3 1  ON 32
ci_034                 4.843627e-03 3 1  ON 33
ci_035                -3.333285e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698265e-04 3 1  ON 37
ci_039                 1.141800e-03 3 1  ON 38
ci_040                -1.556560e-03 3 1  ON 39
ci_041                 8.162412e-03 3 1  ON 40
ci_042                 8.161304e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909904e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787332e-03 3 1  ON 45
ci_047                 4.610911e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844905e-03 3 1  ON 49
ci_051                 2.987769e-03 3 1  ON 50
ci_052                -2.169815e-03 3 1  ON 51
ci_053                -2.204226e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424951e-03 3 1  ON 54
ci_056                 4.623353e-03 3 1  ON 55
ci_057                 4.637312e-03 3 1  ON 56
ci_058                -2.068441e-03 3 1  ON 57
ci_059                -2.051526e-03 3 1  ON 58
ci_060                 4.761573e-03 3 1  ON 59
ci_061                 5.208228e-03 3 1  ON 60
ci_062                -2.956686e-03 3 1  ON 61
ci_063                -2.806834e-03 3 1  ON 62
ci_064                -2.259152e-03 3 1  ON 63
ci_065                -3.384065e-03 3 1  ON 64
ci_066                 4.061277e-03 3 1  ON 65
ci_067                 4.229745e-03 3 1  ON 66
ci_068                -4.276380e-03 3 1  ON 67
ci_069                -4.116032e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9027e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.2315
    reference variance = 0.282713
====================================================
  Execution time = 1.3775e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0145e-01
  Total weights = 1.957852191e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289026943688
                                         uncertainty =       0.001785267299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289026943688
                                         uncertainty =       0.001785267299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380093537
  error estimate for blocks of size 2^( 2) =       0.000391588023
  error estimate for blocks of size 2^( 3) =       0.000402092067
  error estimate for blocks of size 2^( 4) =       0.000410788000
  error estimate for blocks of size 2^( 5) =       0.000416884730
  error estimate for blocks of size 2^( 6) =       0.000419617624
  error estimate for blocks of size 2^( 7) =       0.000422658899

      target function =      -0.910396161018
              le_mean =     -17.215289138863
             les_mean =     296.667628912964
             stat err =       0.000417487313
             autocorr =       1.206439633334
   target nu stat err =       0.000417487313
   target dn stat err =       0.002499586799
      target stat err =       0.003929559426
              std dev =       0.537533434334
             le_variance =       0.288942193027


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721528913886e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910412279628       residual = 6.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910412280616       residual = 4.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910412280716       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910412280754       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910412280760       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910412280718       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910412280744       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910412280792       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910412280717       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+04 is 4.720989e-09

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910412279628       residual = 6.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910412279875       residual = 4.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910412279900       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910412279909       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910412279966       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910412279911       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910412279849       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910412279820       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910412279912       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+04 is 1.180250e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910412279628       residual = 6.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910412279690       residual = 4.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910412279696       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910412279698       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910412279699       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910412279564       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910412280161       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910412279671       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910412279628       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+05 is 2.950628e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.264683 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6280e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -3.749991e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362204e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127884e-02 3 1  ON 4
ci_006                -1.839315e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770717e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841367e-03 3 1  ON 9
ci_011                -8.956766e-03 3 1  ON 10
ci_012                -9.103925e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092740e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564055e-02 3 1  ON 16
ci_018                 9.111010e-03 3 1  ON 17
ci_019                 9.004849e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269281e-03 3 1  ON 21
ci_023                 8.254996e-03 3 1  ON 22
ci_024                 8.343660e-03 3 1  ON 23
ci_025                 8.422059e-03 3 1  ON 24
ci_026                 9.909778e-03 3 1  ON 25
ci_027                 9.698728e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479642e-02 3 1  ON 28
ci_030                -8.758309e-03 3 1  ON 29
ci_031                -8.616193e-03 3 1  ON 30
ci_032                -1.432817e-02 3 1  ON 31
ci_033                 4.550086e-03 3 1  ON 32
ci_034                 4.843627e-03 3 1  ON 33
ci_035                -3.333285e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698262e-04 3 1  ON 37
ci_039                 1.141800e-03 3 1  ON 38
ci_040                -1.556560e-03 3 1  ON 39
ci_041                 8.162412e-03 3 1  ON 40
ci_042                 8.161305e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909904e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787332e-03 3 1  ON 45
ci_047                 4.610911e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844906e-03 3 1  ON 49
ci_051                 2.987769e-03 3 1  ON 50
ci_052                -2.169814e-03 3 1  ON 51
ci_053                -2.204226e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424952e-03 3 1  ON 54
ci_056                 4.623353e-03 3 1  ON 55
ci_057                 4.637312e-03 3 1  ON 56
ci_058                -2.068440e-03 3 1  ON 57
ci_059                -2.051527e-03 3 1  ON 58
ci_060                 4.761573e-03 3 1  ON 59
ci_061                 5.208228e-03 3 1  ON 60
ci_062                -2.956686e-03 3 1  ON 61
ci_063                -2.806835e-03 3 1  ON 62
ci_064                -2.259152e-03 3 1  ON 63
ci_065                -3.384065e-03 3 1  ON 64
ci_066                 4.061277e-03 3 1  ON 65
ci_067                 4.229745e-03 3 1  ON 66
ci_068                -4.276380e-03 3 1  ON 67
ci_069                -4.116033e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.1978
    reference variance = 0.2122
====================================================
  Execution time = 1.3971e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9716e-01
  Total weights = 1.9581e+06
  Execution time = 1.8148e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285535414686
                                         uncertainty =       0.001529770448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285535414686
                                         uncertainty =       0.001529770448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377897564
  error estimate for blocks of size 2^( 2) =       0.000389347672
  error estimate for blocks of size 2^( 3) =       0.000399815229
  error estimate for blocks of size 2^( 4) =       0.000407834471
  error estimate for blocks of size 2^( 5) =       0.000413387646
  error estimate for blocks of size 2^( 6) =       0.000416153504
  error estimate for blocks of size 2^( 7) =       0.000418632148

      target function =      -0.917078335159
              le_mean =     -17.215173941036
             les_mean =     296.659378135798
             stat err =       0.000414001942
             autocorr =       1.200208155078
   target nu stat err =       0.000414001942
   target dn stat err =       0.002046888778
      target stat err =       0.003288145734
              std dev =       0.534427859651
             le_variance =       0.285613137171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285535414320
                                         uncertainty =       0.001529770384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285535414320
                                         uncertainty =       0.001529770384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377897563
  error estimate for blocks of size 2^( 2) =       0.000389347672
  error estimate for blocks of size 2^( 3) =       0.000399815229
  error estimate for blocks of size 2^( 4) =       0.000407834471
  error estimate for blocks of size 2^( 5) =       0.000413387646
  error estimate for blocks of size 2^( 6) =       0.000416153504
  error estimate for blocks of size 2^( 7) =       0.000418632148

      target function =      -0.917078346999
              le_mean =     -17.215173941124
             les_mean =     296.659378131296
             stat err =       0.000414001942
             autocorr =       1.200208157122
   target nu stat err =       0.000414001942
   target dn stat err =       0.002046888673
      target stat err =       0.003288145657
              std dev =       0.534427859303
             le_variance =       0.285613136799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285535414503
                                         uncertainty =       0.001529770416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285535414503
                                         uncertainty =       0.001529770416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377897563
  error estimate for blocks of size 2^( 2) =       0.000389347672
  error estimate for blocks of size 2^( 3) =       0.000399815229
  error estimate for blocks of size 2^( 4) =       0.000407834471
  error estimate for blocks of size 2^( 5) =       0.000413387646
  error estimate for blocks of size 2^( 6) =       0.000416153504
  error estimate for blocks of size 2^( 7) =       0.000418632148

      target function =      -0.917078341080
              le_mean =     -17.215173941080
             les_mean =     296.659378133546
             stat err =       0.000414001942
             autocorr =       1.200208156096
   target nu stat err =       0.000414001942
   target dn stat err =       0.002046888726
      target stat err =       0.003288145695
              std dev =       0.534427859477
             le_variance =       0.285613136985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285535414663
                                         uncertainty =       0.001529770444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285535414663
                                         uncertainty =       0.001529770444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377897564
  error estimate for blocks of size 2^( 2) =       0.000389347672
  error estimate for blocks of size 2^( 3) =       0.000399815229
  error estimate for blocks of size 2^( 4) =       0.000407834471
  error estimate for blocks of size 2^( 5) =       0.000413387646
  error estimate for blocks of size 2^( 6) =       0.000416153504
  error estimate for blocks of size 2^( 7) =       0.000418632148

      target function =      -0.917078335899
              le_mean =     -17.215173941041
             les_mean =     296.659378135516
             stat err =       0.000414001942
             autocorr =       1.200208155197
   target nu stat err =       0.000414001942
   target dn stat err =       0.002046888772
      target stat err =       0.003288145729
              std dev =       0.534427859630
             le_variance =       0.285613137148


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917078335159        initial
     2.3283e+04     2.3283e+05             4.7210e-09        -0.917078346999  <--
     9.3132e+04     9.3132e+05             1.1803e-09        -0.917078341080
     3.7253e+05     3.7253e+06             2.9506e-10        -0.917078335899

*****************************************************************************
Applying the update for shift_i =   2.3283e+04     and shift_s =   2.3283e+05
*****************************************************************************

  Execution time = 2.3150e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -3.749991e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362204e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127884e-02 3 1  ON 4
ci_006                -1.839315e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770717e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841367e-03 3 1  ON 9
ci_011                -8.956767e-03 3 1  ON 10
ci_012                -9.103924e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092740e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564055e-02 3 1  ON 16
ci_018                 9.111011e-03 3 1  ON 17
ci_019                 9.004849e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269281e-03 3 1  ON 21
ci_023                 8.254995e-03 3 1  ON 22
ci_024                 8.343662e-03 3 1  ON 23
ci_025                 8.422057e-03 3 1  ON 24
ci_026                 9.909778e-03 3 1  ON 25
ci_027                 9.698728e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758309e-03 3 1  ON 29
ci_031                -8.616195e-03 3 1  ON 30
ci_032                -1.432817e-02 3 1  ON 31
ci_033                 4.550085e-03 3 1  ON 32
ci_034                 4.843629e-03 3 1  ON 33
ci_035                -3.333284e-03 3 1  ON 34
ci_036                -1.121943e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698254e-04 3 1  ON 37
ci_039                 1.141799e-03 3 1  ON 38
ci_040                -1.556560e-03 3 1  ON 39
ci_041                 8.162413e-03 3 1  ON 40
ci_042                 8.161308e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909904e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787332e-03 3 1  ON 45
ci_047                 4.610910e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844907e-03 3 1  ON 49
ci_051                 2.987769e-03 3 1  ON 50
ci_052                -2.169814e-03 3 1  ON 51
ci_053                -2.204227e-03 3 1  ON 52
ci_054                -2.206783e-03 3 1  ON 53
ci_055                -2.424953e-03 3 1  ON 54
ci_056                 4.623352e-03 3 1  ON 55
ci_057                 4.637313e-03 3 1  ON 56
ci_058                -2.068436e-03 3 1  ON 57
ci_059                -2.051527e-03 3 1  ON 58
ci_060                 4.761574e-03 3 1  ON 59
ci_061                 5.208228e-03 3 1  ON 60
ci_062                -2.956686e-03 3 1  ON 61
ci_063                -2.806837e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229746e-03 3 1  ON 66
ci_068                -4.276381e-03 3 1  ON 67
ci_069                -4.116034e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9437e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.1894
    reference variance = 0.196
====================================================
  Execution time = 1.3919e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0259e-01
  Total weights = 1.957597876e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288427564540
                                         uncertainty =       0.001555906188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288427564540
                                         uncertainty =       0.001555906188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379761964
  error estimate for blocks of size 2^( 2) =       0.000391132496
  error estimate for blocks of size 2^( 3) =       0.000401392963
  error estimate for blocks of size 2^( 4) =       0.000409345293
  error estimate for blocks of size 2^( 5) =       0.000414875650
  error estimate for blocks of size 2^( 6) =       0.000416454777
  error estimate for blocks of size 2^( 7) =       0.000418094081

      target function =      -0.908640623210
              le_mean =     -17.215130631314
             les_mean =     296.663312994436
             stat err =       0.000414692450
             autocorr =       1.192420209792
   target nu stat err =       0.000414692450
   target dn stat err =       0.002565564809
      target stat err =       0.004012644281
              std dev =       0.537064519780
             le_variance =       0.288438298407


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721513063131e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908657405903       residual = 3.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908657419265       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908657420459       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908657420836       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908657420847       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908657420839       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908657420864       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908657420857       residual = 7.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908657420856       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908657420857       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+03 is 2.968591e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908657405903       residual = 3.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908657409243       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908657409542       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908657409636       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908657409676       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908657409631       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908657409717       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908657409611       residual = 7.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908657409658       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908657409662       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+04 is 7.421554e-09

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908657405903       residual = 3.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908657406738       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908657406812       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908657406836       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908657406837       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908657406838       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908657406838       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908657406838       residual = 7.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908657406793       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908657406770       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+04 is 1.855393e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.268144 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6399e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -3.749991e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362204e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127883e-02 3 1  ON 4
ci_006                -1.839315e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770718e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841363e-03 3 1  ON 9
ci_011                -8.956768e-03 3 1  ON 10
ci_012                -9.103921e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092740e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564055e-02 3 1  ON 16
ci_018                 9.111014e-03 3 1  ON 17
ci_019                 9.004852e-03 3 1  ON 18
ci_020                 1.503804e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269277e-03 3 1  ON 21
ci_023                 8.254999e-03 3 1  ON 22
ci_024                 8.343662e-03 3 1  ON 23
ci_025                 8.422057e-03 3 1  ON 24
ci_026                 9.909786e-03 3 1  ON 25
ci_027                 9.698728e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479642e-02 3 1  ON 28
ci_030                -8.758307e-03 3 1  ON 29
ci_031                -8.616196e-03 3 1  ON 30
ci_032                -1.432817e-02 3 1  ON 31
ci_033                 4.550084e-03 3 1  ON 32
ci_034                 4.843628e-03 3 1  ON 33
ci_035                -3.333284e-03 3 1  ON 34
ci_036                -1.121943e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698280e-04 3 1  ON 37
ci_039                 1.141800e-03 3 1  ON 38
ci_040                -1.556559e-03 3 1  ON 39
ci_041                 8.162411e-03 3 1  ON 40
ci_042                 8.161312e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909904e-03 3 1  ON 43
ci_045                -1.989964e-03 3 1  ON 44
ci_046                 4.787330e-03 3 1  ON 45
ci_047                 4.610910e-03 3 1  ON 46
ci_048                -1.238390e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844906e-03 3 1  ON 49
ci_051                 2.987770e-03 3 1  ON 50
ci_052                -2.169818e-03 3 1  ON 51
ci_053                -2.204228e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424952e-03 3 1  ON 54
ci_056                 4.623352e-03 3 1  ON 55
ci_057                 4.637313e-03 3 1  ON 56
ci_058                -2.068440e-03 3 1  ON 57
ci_059                -2.051525e-03 3 1  ON 58
ci_060                 4.761575e-03 3 1  ON 59
ci_061                 5.208228e-03 3 1  ON 60
ci_062                -2.956684e-03 3 1  ON 61
ci_063                -2.806837e-03 3 1  ON 62
ci_064                -2.259151e-03 3 1  ON 63
ci_065                -3.384065e-03 3 1  ON 64
ci_066                 4.061279e-03 3 1  ON 65
ci_067                 4.229745e-03 3 1  ON 66
ci_068                -4.276381e-03 3 1  ON 67
ci_069                -4.116033e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.1434
    reference variance = 0.26144
====================================================
  Execution time = 1.6600e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0449e-01
  Total weights = 1.9576e+06
  Execution time = 1.8123e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290233896433
                                         uncertainty =       0.002203606109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290233896433
                                         uncertainty =       0.002203606109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380983896
  error estimate for blocks of size 2^( 2) =       0.000392373405
  error estimate for blocks of size 2^( 3) =       0.000403025755
  error estimate for blocks of size 2^( 4) =       0.000410830606
  error estimate for blocks of size 2^( 5) =       0.000414640854
  error estimate for blocks of size 2^( 6) =       0.000416327019
  error estimate for blocks of size 2^( 7) =       0.000418586199

      target function =      -0.905748593217
              le_mean =     -17.214717445664
             les_mean =     296.650982742805
             stat err =       0.000415096170
             autocorr =       1.187091552303
   target nu stat err =       0.000415096170
   target dn stat err =       0.002762275654
      target stat err =       0.004280983605
              std dev =       0.538792592666
             le_variance =       0.290297457912

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290233894636
                                         uncertainty =       0.002203606618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290233894636
                                         uncertainty =       0.002203606618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380983895
  error estimate for blocks of size 2^( 2) =       0.000392373404
  error estimate for blocks of size 2^( 3) =       0.000403025754
  error estimate for blocks of size 2^( 4) =       0.000410830603
  error estimate for blocks of size 2^( 5) =       0.000414640851
  error estimate for blocks of size 2^( 6) =       0.000416327016
  error estimate for blocks of size 2^( 7) =       0.000418586195

      target function =      -0.905748563145
              le_mean =     -17.214717445706
             les_mean =     296.650982763920
             stat err =       0.000415096166
             autocorr =       1.187091541991
   target nu stat err =       0.000415096166
   target dn stat err =       0.002762276554
      target stat err =       0.004280984682
              std dev =       0.538792590959
             le_variance =       0.290297456073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290233895535
                                         uncertainty =       0.002203606364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290233895535
                                         uncertainty =       0.002203606364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380983895
  error estimate for blocks of size 2^( 2) =       0.000392373404
  error estimate for blocks of size 2^( 3) =       0.000403025754
  error estimate for blocks of size 2^( 4) =       0.000410830605
  error estimate for blocks of size 2^( 5) =       0.000414640853
  error estimate for blocks of size 2^( 6) =       0.000416327018
  error estimate for blocks of size 2^( 7) =       0.000418586197

      target function =      -0.905748578208
              le_mean =     -17.214717445685
             les_mean =     296.650982753345
             stat err =       0.000415096168
             autocorr =       1.187091547140
   target nu stat err =       0.000415096168
   target dn stat err =       0.002762276104
      target stat err =       0.004280984144
              std dev =       0.538792591813
             le_variance =       0.290297456992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290233896321
                                         uncertainty =       0.002203606141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290233896321
                                         uncertainty =       0.002203606141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380983896
  error estimate for blocks of size 2^( 2) =       0.000392373405
  error estimate for blocks of size 2^( 3) =       0.000403025755
  error estimate for blocks of size 2^( 4) =       0.000410830606
  error estimate for blocks of size 2^( 5) =       0.000414640854
  error estimate for blocks of size 2^( 6) =       0.000416327019
  error estimate for blocks of size 2^( 7) =       0.000418586199

      target function =      -0.905748591344
              le_mean =     -17.214717445667
             les_mean =     296.650982744120
             stat err =       0.000415096169
             autocorr =       1.187091551655
   target nu stat err =       0.000415096169
   target dn stat err =       0.002762275710
      target stat err =       0.004280983673
              std dev =       0.538792592559
             le_variance =       0.290297457797


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.905748593217        initial  <--
     5.8208e+03     5.8208e+04             2.9686e-08        -0.905748563145
     2.3283e+04     2.3283e+05             7.4216e-09        -0.905748578208
     9.3132e+04     9.3132e+05             1.8554e-09        -0.905748591344

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.7492
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -3.749991e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362204e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127884e-02 3 1  ON 4
ci_006                -1.839315e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770717e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841367e-03 3 1  ON 9
ci_011                -8.956767e-03 3 1  ON 10
ci_012                -9.103924e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092740e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564055e-02 3 1  ON 16
ci_018                 9.111011e-03 3 1  ON 17
ci_019                 9.004849e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269281e-03 3 1  ON 21
ci_023                 8.254995e-03 3 1  ON 22
ci_024                 8.343662e-03 3 1  ON 23
ci_025                 8.422057e-03 3 1  ON 24
ci_026                 9.909778e-03 3 1  ON 25
ci_027                 9.698728e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758309e-03 3 1  ON 29
ci_031                -8.616195e-03 3 1  ON 30
ci_032                -1.432817e-02 3 1  ON 31
ci_033                 4.550085e-03 3 1  ON 32
ci_034                 4.843629e-03 3 1  ON 33
ci_035                -3.333284e-03 3 1  ON 34
ci_036                -1.121943e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698254e-04 3 1  ON 37
ci_039                 1.141799e-03 3 1  ON 38
ci_040                -1.556560e-03 3 1  ON 39
ci_041                 8.162413e-03 3 1  ON 40
ci_042                 8.161308e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909904e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787332e-03 3 1  ON 45
ci_047                 4.610910e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844907e-03 3 1  ON 49
ci_051                 2.987769e-03 3 1  ON 50
ci_052                -2.169814e-03 3 1  ON 51
ci_053                -2.204227e-03 3 1  ON 52
ci_054                -2.206783e-03 3 1  ON 53
ci_055                -2.424953e-03 3 1  ON 54
ci_056                 4.623352e-03 3 1  ON 55
ci_057                 4.637313e-03 3 1  ON 56
ci_058                -2.068436e-03 3 1  ON 57
ci_059                -2.051527e-03 3 1  ON 58
ci_060                 4.761574e-03 3 1  ON 59
ci_061                 5.208228e-03 3 1  ON 60
ci_062                -2.956686e-03 3 1  ON 61
ci_063                -2.806837e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229746e-03 3 1  ON 66
ci_068                -4.276381e-03 3 1  ON 67
ci_069                -4.116034e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2156e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2074
    reference variance = 0.211018
====================================================
  Execution time = 1.3943e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0097e-01
  Total weights = 1.957740293e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4953e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287670798141
                                         uncertainty =       0.001950034050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287670798141
                                         uncertainty =       0.001950034050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379221733
  error estimate for blocks of size 2^( 2) =       0.000390743748
  error estimate for blocks of size 2^( 3) =       0.000400872736
  error estimate for blocks of size 2^( 4) =       0.000408423158
  error estimate for blocks of size 2^( 5) =       0.000413851395
  error estimate for blocks of size 2^( 6) =       0.000417111624
  error estimate for blocks of size 2^( 7) =       0.000418285381

      target function =      -0.911180758858
              le_mean =     -17.214182780203
             les_mean =     296.629056927085
             stat err =       0.000414417889
             autocorr =       1.194237079889
   target nu stat err =       0.000414417889
   target dn stat err =       0.002580724910
      target stat err =       0.004050641536
              std dev =       0.536300518392
             le_variance =       0.287618246028


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721418278020e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911197763050       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911197763650       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911197763752       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911197763775       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911197763777       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911197763779       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911197763779       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911197763779       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911197763779       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+04 is 2.288741e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911197763050       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911197763200       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911197763225       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911197763231       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911197763232       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911197763232       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911197763232       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911197763232       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911197763232       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+05 is 5.721858e-10

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911197763050       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911197763087       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911197763094       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911197763095       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911197762793       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911197763095       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911197763096       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911197763096       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911197763095       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+05 is 1.430465e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.271198 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6447e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -3.749991e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362204e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127884e-02 3 1  ON 4
ci_006                -1.839315e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770717e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841366e-03 3 1  ON 9
ci_011                -8.956767e-03 3 1  ON 10
ci_012                -9.103923e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092740e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564055e-02 3 1  ON 16
ci_018                 9.111011e-03 3 1  ON 17
ci_019                 9.004849e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269281e-03 3 1  ON 21
ci_023                 8.254996e-03 3 1  ON 22
ci_024                 8.343662e-03 3 1  ON 23
ci_025                 8.422057e-03 3 1  ON 24
ci_026                 9.909778e-03 3 1  ON 25
ci_027                 9.698728e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758309e-03 3 1  ON 29
ci_031                -8.616195e-03 3 1  ON 30
ci_032                -1.432817e-02 3 1  ON 31
ci_033                 4.550085e-03 3 1  ON 32
ci_034                 4.843628e-03 3 1  ON 33
ci_035                -3.333284e-03 3 1  ON 34
ci_036                -1.121943e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698253e-04 3 1  ON 37
ci_039                 1.141799e-03 3 1  ON 38
ci_040                -1.556560e-03 3 1  ON 39
ci_041                 8.162412e-03 3 1  ON 40
ci_042                 8.161308e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909904e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787332e-03 3 1  ON 45
ci_047                 4.610910e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844906e-03 3 1  ON 49
ci_051                 2.987769e-03 3 1  ON 50
ci_052                -2.169814e-03 3 1  ON 51
ci_053                -2.204226e-03 3 1  ON 52
ci_054                -2.206783e-03 3 1  ON 53
ci_055                -2.424953e-03 3 1  ON 54
ci_056                 4.623352e-03 3 1  ON 55
ci_057                 4.637313e-03 3 1  ON 56
ci_058                -2.068436e-03 3 1  ON 57
ci_059                -2.051527e-03 3 1  ON 58
ci_060                 4.761574e-03 3 1  ON 59
ci_061                 5.208228e-03 3 1  ON 60
ci_062                -2.956686e-03 3 1  ON 61
ci_063                -2.806837e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229746e-03 3 1  ON 66
ci_068                -4.276380e-03 3 1  ON 67
ci_069                -4.116034e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2058
    reference variance = 0.167107
====================================================
  Execution time = 1.3953e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0027e-01
  Total weights = 1.9580e+06
  Execution time = 1.8175e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286273196080
                                         uncertainty =       0.001735315195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286273196080
                                         uncertainty =       0.001735315195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378294847
  error estimate for blocks of size 2^( 2) =       0.000389634820
  error estimate for blocks of size 2^( 3) =       0.000399728483
  error estimate for blocks of size 2^( 4) =       0.000407283524
  error estimate for blocks of size 2^( 5) =       0.000412288203
  error estimate for blocks of size 2^( 6) =       0.000415709499
  error estimate for blocks of size 2^( 7) =       0.000417408197

      target function =      -0.912242017876
              le_mean =     -17.214699522876
             les_mean =     296.646149856714
             stat err =       0.000413172356
             autocorr =       1.192893469073
   target nu stat err =       0.000413172356
   target dn stat err =       0.002629357524
      target stat err =       0.004137794606
              std dev =       0.534989703637
             le_variance =       0.286213982998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286273195898
                                         uncertainty =       0.001735315193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286273195898
                                         uncertainty =       0.001735315193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378294847
  error estimate for blocks of size 2^( 2) =       0.000389634820
  error estimate for blocks of size 2^( 3) =       0.000399728483
  error estimate for blocks of size 2^( 4) =       0.000407283524
  error estimate for blocks of size 2^( 5) =       0.000412288203
  error estimate for blocks of size 2^( 6) =       0.000415709499
  error estimate for blocks of size 2^( 7) =       0.000417408197

      target function =      -0.912242018320
              le_mean =     -17.214699522916
             les_mean =     296.646149857815
             stat err =       0.000413172356
             autocorr =       1.192893470766
   target nu stat err =       0.000413172356
   target dn stat err =       0.002629357508
      target stat err =       0.004137794586
              std dev =       0.534989703467
             le_variance =       0.286213982816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286273195989
                                         uncertainty =       0.001735315194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286273195989
                                         uncertainty =       0.001735315194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378294847
  error estimate for blocks of size 2^( 2) =       0.000389634820
  error estimate for blocks of size 2^( 3) =       0.000399728483
  error estimate for blocks of size 2^( 4) =       0.000407283524
  error estimate for blocks of size 2^( 5) =       0.000412288203
  error estimate for blocks of size 2^( 6) =       0.000415709499
  error estimate for blocks of size 2^( 7) =       0.000417408197

      target function =      -0.912242018098
              le_mean =     -17.214699522896
             les_mean =     296.646149857265
             stat err =       0.000413172356
             autocorr =       1.192893469929
   target nu stat err =       0.000413172356
   target dn stat err =       0.002629357516
      target stat err =       0.004137794596
              std dev =       0.534989703552
             le_variance =       0.286213982907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286273196068
                                         uncertainty =       0.001735315195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286273196068
                                         uncertainty =       0.001735315195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378294847
  error estimate for blocks of size 2^( 2) =       0.000389634820
  error estimate for blocks of size 2^( 3) =       0.000399728483
  error estimate for blocks of size 2^( 4) =       0.000407283524
  error estimate for blocks of size 2^( 5) =       0.000412288203
  error estimate for blocks of size 2^( 6) =       0.000415709499
  error estimate for blocks of size 2^( 7) =       0.000417408197

      target function =      -0.912242017904
              le_mean =     -17.214699522878
             les_mean =     296.646149856783
             stat err =       0.000413172356
             autocorr =       1.192893469181
   target nu stat err =       0.000413172356
   target dn stat err =       0.002629357523
      target stat err =       0.004137794605
              std dev =       0.534989703626
             le_variance =       0.286213982986


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912242017876        initial
     5.8208e+04     5.8208e+05             2.2887e-09        -0.912242018320  <--
     2.3283e+05     2.3283e+06             5.7219e-10        -0.912242018098
     9.3132e+05     9.3132e+06             1.4305e-10        -0.912242017904

*****************************************************************************
Applying the update for shift_i =   5.8208e+04     and shift_s =   5.8208e+05
*****************************************************************************

  Execution time = 2.3161e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -3.749991e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362204e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127884e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770717e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841366e-03 3 1  ON 9
ci_011                -8.956765e-03 3 1  ON 10
ci_012                -9.103923e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092740e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564055e-02 3 1  ON 16
ci_018                 9.111012e-03 3 1  ON 17
ci_019                 9.004849e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269280e-03 3 1  ON 21
ci_023                 8.254996e-03 3 1  ON 22
ci_024                 8.343661e-03 3 1  ON 23
ci_025                 8.422057e-03 3 1  ON 24
ci_026                 9.909779e-03 3 1  ON 25
ci_027                 9.698728e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758308e-03 3 1  ON 29
ci_031                -8.616196e-03 3 1  ON 30
ci_032                -1.432817e-02 3 1  ON 31
ci_033                 4.550086e-03 3 1  ON 32
ci_034                 4.843628e-03 3 1  ON 33
ci_035                -3.333285e-03 3 1  ON 34
ci_036                -1.121943e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698250e-04 3 1  ON 37
ci_039                 1.141799e-03 3 1  ON 38
ci_040                -1.556561e-03 3 1  ON 39
ci_041                 8.162412e-03 3 1  ON 40
ci_042                 8.161308e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909904e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787332e-03 3 1  ON 45
ci_047                 4.610910e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844906e-03 3 1  ON 49
ci_051                 2.987770e-03 3 1  ON 50
ci_052                -2.169814e-03 3 1  ON 51
ci_053                -2.204225e-03 3 1  ON 52
ci_054                -2.206783e-03 3 1  ON 53
ci_055                -2.424952e-03 3 1  ON 54
ci_056                 4.623352e-03 3 1  ON 55
ci_057                 4.637313e-03 3 1  ON 56
ci_058                -2.068435e-03 3 1  ON 57
ci_059                -2.051526e-03 3 1  ON 58
ci_060                 4.761574e-03 3 1  ON 59
ci_061                 5.208228e-03 3 1  ON 60
ci_062                -2.956686e-03 3 1  ON 61
ci_063                -2.806838e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384065e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229745e-03 3 1  ON 66
ci_068                -4.276380e-03 3 1  ON 67
ci_069                -4.116033e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9615e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2071
    reference variance = 0.241138
====================================================
  Execution time = 1.4203e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9427e-01
  Total weights = 1.957813264e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4978e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282426143165
                                         uncertainty =       0.001552167393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282426143165
                                         uncertainty =       0.001552167393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375811813
  error estimate for blocks of size 2^( 2) =       0.000387048148
  error estimate for blocks of size 2^( 3) =       0.000398088553
  error estimate for blocks of size 2^( 4) =       0.000406087075
  error estimate for blocks of size 2^( 5) =       0.000410426338
  error estimate for blocks of size 2^( 6) =       0.000412575009
  error estimate for blocks of size 2^( 7) =       0.000414077297

      target function =      -0.921652745970
              le_mean =     -17.214233730382
             les_mean =     296.624113962352
             stat err =       0.000410791430
             autocorr =       1.194818376298
   target nu stat err =       0.000410791430
   target dn stat err =       0.002424041037
      target stat err =       0.003898220021
              std dev =       0.531478163310
             le_variance =       0.282469038076


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721423373038e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921668126631       residual = 8.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921668128841       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921668129230       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921668129362       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921668129379       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921668129364       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921668129384       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921668129384       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921668129384       residual = 7.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+04 is 7.775757e-09

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921668126631       residual = 8.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921668127183       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921668127281       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921668127312       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921668127336       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921668127319       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921668127319       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921668127319       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921668127319       residual = 7.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+04 is 1.943947e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921668126631       residual = 8.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921668126769       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921668126793       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921668126801       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921668126803       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921668126803       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921668126803       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921668126660       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921668126803       residual = 7.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+05 is 4.859871e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.274185 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6709e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -3.749991e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362204e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127884e-02 3 1  ON 4
ci_006                -1.839315e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770716e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841365e-03 3 1  ON 9
ci_011                -8.956765e-03 3 1  ON 10
ci_012                -9.103922e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092740e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564055e-02 3 1  ON 16
ci_018                 9.111012e-03 3 1  ON 17
ci_019                 9.004848e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269282e-03 3 1  ON 21
ci_023                 8.254995e-03 3 1  ON 22
ci_024                 8.343661e-03 3 1  ON 23
ci_025                 8.422057e-03 3 1  ON 24
ci_026                 9.909779e-03 3 1  ON 25
ci_027                 9.698728e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479642e-02 3 1  ON 28
ci_030                -8.758307e-03 3 1  ON 29
ci_031                -8.616196e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550086e-03 3 1  ON 32
ci_034                 4.843629e-03 3 1  ON 33
ci_035                -3.333285e-03 3 1  ON 34
ci_036                -1.121943e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698251e-04 3 1  ON 37
ci_039                 1.141799e-03 3 1  ON 38
ci_040                -1.556561e-03 3 1  ON 39
ci_041                 8.162414e-03 3 1  ON 40
ci_042                 8.161307e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909902e-03 3 1  ON 43
ci_045                -1.989963e-03 3 1  ON 44
ci_046                 4.787331e-03 3 1  ON 45
ci_047                 4.610910e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844905e-03 3 1  ON 49
ci_051                 2.987771e-03 3 1  ON 50
ci_052                -2.169813e-03 3 1  ON 51
ci_053                -2.204226e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424952e-03 3 1  ON 54
ci_056                 4.623352e-03 3 1  ON 55
ci_057                 4.637313e-03 3 1  ON 56
ci_058                -2.068436e-03 3 1  ON 57
ci_059                -2.051527e-03 3 1  ON 58
ci_060                 4.761573e-03 3 1  ON 59
ci_061                 5.208226e-03 3 1  ON 60
ci_062                -2.956687e-03 3 1  ON 61
ci_063                -2.806838e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229746e-03 3 1  ON 66
ci_068                -4.276381e-03 3 1  ON 67
ci_069                -4.116034e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.161
    reference variance = 0.213472
====================================================
  Execution time = 1.3660e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9999e-01
  Total weights = 1.9579e+06
  Execution time = 1.8205e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287395585057
                                         uncertainty =       0.001794599468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287395585057
                                         uncertainty =       0.001794599468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379061520
  error estimate for blocks of size 2^( 2) =       0.000390655927
  error estimate for blocks of size 2^( 3) =       0.000401129344
  error estimate for blocks of size 2^( 4) =       0.000408775746
  error estimate for blocks of size 2^( 5) =       0.000414095855
  error estimate for blocks of size 2^( 6) =       0.000418297062
  error estimate for blocks of size 2^( 7) =       0.000420060842

      target function =      -0.912685273965
              le_mean =     -17.214634985196
             les_mean =     296.643644597320
             stat err =       0.000415307376
             autocorr =       1.200383148364
   target nu stat err =       0.000415307376
   target dn stat err =       0.002525732843
      target stat err =       0.003983478792
              std dev =       0.536073942640
             le_variance =       0.287375271977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287395585429
                                         uncertainty =       0.001794599584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287395585429
                                         uncertainty =       0.001794599584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379061520
  error estimate for blocks of size 2^( 2) =       0.000390655928
  error estimate for blocks of size 2^( 3) =       0.000401129344
  error estimate for blocks of size 2^( 4) =       0.000408775747
  error estimate for blocks of size 2^( 5) =       0.000414095856
  error estimate for blocks of size 2^( 6) =       0.000418297063
  error estimate for blocks of size 2^( 7) =       0.000420060844

      target function =      -0.912685315166
              le_mean =     -17.214634985102
             les_mean =     296.643644567553
             stat err =       0.000415307377
             autocorr =       1.200383153061
   target nu stat err =       0.000415307377
   target dn stat err =       0.002525732475
      target stat err =       0.003983478583
              std dev =       0.536073942978
             le_variance =       0.287375272340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287395585243
                                         uncertainty =       0.001794599526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287395585243
                                         uncertainty =       0.001794599526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379061520
  error estimate for blocks of size 2^( 2) =       0.000390655928
  error estimate for blocks of size 2^( 3) =       0.000401129344
  error estimate for blocks of size 2^( 4) =       0.000408775747
  error estimate for blocks of size 2^( 5) =       0.000414095856
  error estimate for blocks of size 2^( 6) =       0.000418297062
  error estimate for blocks of size 2^( 7) =       0.000420060843

      target function =      -0.912685294572
              le_mean =     -17.214634985149
             les_mean =     296.643644582432
             stat err =       0.000415307377
             autocorr =       1.200383150716
   target nu stat err =       0.000415307377
   target dn stat err =       0.002525732659
      target stat err =       0.003983478687
              std dev =       0.536073942809
             le_variance =       0.287375272158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287395585080
                                         uncertainty =       0.001794599475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287395585080
                                         uncertainty =       0.001794599475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379061520
  error estimate for blocks of size 2^( 2) =       0.000390655927
  error estimate for blocks of size 2^( 3) =       0.000401129344
  error estimate for blocks of size 2^( 4) =       0.000408775747
  error estimate for blocks of size 2^( 5) =       0.000414095855
  error estimate for blocks of size 2^( 6) =       0.000418297062
  error estimate for blocks of size 2^( 7) =       0.000420060842

      target function =      -0.912685276542
              le_mean =     -17.214634985190
             les_mean =     296.643644595458
             stat err =       0.000415307376
             autocorr =       1.200383148655
   target nu stat err =       0.000415307376
   target dn stat err =       0.002525732820
      target stat err =       0.003983478779
              std dev =       0.536073942661
             le_variance =       0.287375272000


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912685273965        initial
     1.4552e+04     1.4552e+05             7.7758e-09        -0.912685315166  <--
     5.8208e+04     5.8208e+05             1.9439e-09        -0.912685294572
     2.3283e+05     2.3283e+06             4.8599e-10        -0.912685276542

*****************************************************************************
Applying the update for shift_i =   1.4552e+04     and shift_s =   1.4552e+05
*****************************************************************************

  Execution time = 2.2881e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -3.749991e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362204e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127883e-02 3 1  ON 4
ci_006                -1.839315e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770713e-03 3 1  ON 7
ci_009                -1.388526e-02 3 1  ON 8
ci_010                -8.841364e-03 3 1  ON 9
ci_011                -8.956765e-03 3 1  ON 10
ci_012                -9.103922e-03 3 1  ON 11
ci_013                -1.908577e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092740e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564055e-02 3 1  ON 16
ci_018                 9.111011e-03 3 1  ON 17
ci_019                 9.004846e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520091e-02 3 1  ON 20
ci_022                 8.269285e-03 3 1  ON 21
ci_023                 8.254994e-03 3 1  ON 22
ci_024                 8.343660e-03 3 1  ON 23
ci_025                 8.422057e-03 3 1  ON 24
ci_026                 9.909782e-03 3 1  ON 25
ci_027                 9.698730e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479642e-02 3 1  ON 28
ci_030                -8.758305e-03 3 1  ON 29
ci_031                -8.616196e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550087e-03 3 1  ON 32
ci_034                 4.843630e-03 3 1  ON 33
ci_035                -3.333286e-03 3 1  ON 34
ci_036                -1.121943e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698254e-04 3 1  ON 37
ci_039                 1.141797e-03 3 1  ON 38
ci_040                -1.556561e-03 3 1  ON 39
ci_041                 8.162418e-03 3 1  ON 40
ci_042                 8.161306e-03 3 1  ON 41
ci_043                -2.343169e-03 3 1  ON 42
ci_044                -3.909896e-03 3 1  ON 43
ci_045                -1.989963e-03 3 1  ON 44
ci_046                 4.787329e-03 3 1  ON 45
ci_047                 4.610911e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844903e-03 3 1  ON 49
ci_051                 2.987774e-03 3 1  ON 50
ci_052                -2.169811e-03 3 1  ON 51
ci_053                -2.204227e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424951e-03 3 1  ON 54
ci_056                 4.623353e-03 3 1  ON 55
ci_057                 4.637314e-03 3 1  ON 56
ci_058                -2.068438e-03 3 1  ON 57
ci_059                -2.051528e-03 3 1  ON 58
ci_060                 4.761569e-03 3 1  ON 59
ci_061                 5.208221e-03 3 1  ON 60
ci_062                -2.956688e-03 3 1  ON 61
ci_063                -2.806838e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384066e-03 3 1  ON 64
ci_066                 4.061278e-03 3 1  ON 65
ci_067                 4.229747e-03 3 1  ON 66
ci_068                -4.276384e-03 3 1  ON 67
ci_069                -4.116035e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9598e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2087
    reference variance = 0.262274
====================================================
  Execution time = 1.4425e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9641e-01
  Total weights = 1.957904148e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5091e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285145606028
                                         uncertainty =       0.001640448509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285145606028
                                         uncertainty =       0.001640448509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377620970
  error estimate for blocks of size 2^( 2) =       0.000388945250
  error estimate for blocks of size 2^( 3) =       0.000399235071
  error estimate for blocks of size 2^( 4) =       0.000407214401
  error estimate for blocks of size 2^( 5) =       0.000412072979
  error estimate for blocks of size 2^( 6) =       0.000414029523
  error estimate for blocks of size 2^( 7) =       0.000415327406

      target function =      -0.918255234888
              le_mean =     -17.215391797268
             les_mean =     296.666124480157
             stat err =       0.000412161077
             autocorr =       1.191301655212
   target nu stat err =       0.000412161077
   target dn stat err =       0.002261364486
      target stat err =       0.003627407823
              std dev =       0.534036697375
             le_variance =       0.285195194143


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721539179727e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918268666785       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918268676657       residual = 8.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918268677524       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918268677773       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918268677792       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918268677821       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918268677818       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918268677814       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918268677819       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+03 is 5.036940e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918268666785       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918268669253       residual = 8.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918268669470       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918268669533       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918268669544       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918268669532       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918268669555       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918268669538       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918268669588       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+04 is 1.259254e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918268666785       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918268667402       residual = 8.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918268667456       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918268667472       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918268667473       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918268667475       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918268667475       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918268667475       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918268667475       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+04 is 3.148147e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.277180 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6943e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -3.749990e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362204e-02 3 1  ON 2
ci_004                 2.083456e-02 3 1  ON 3
ci_005                 2.127883e-02 3 1  ON 4
ci_006                -1.839315e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770714e-03 3 1  ON 7
ci_009                -1.388525e-02 3 1  ON 8
ci_010                -8.841377e-03 3 1  ON 9
ci_011                -8.956767e-03 3 1  ON 10
ci_012                -9.103925e-03 3 1  ON 11
ci_013                -1.908576e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092740e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564055e-02 3 1  ON 16
ci_018                 9.111010e-03 3 1  ON 17
ci_019                 9.004842e-03 3 1  ON 18
ci_020                 1.503805e-02 3 1  ON 19
ci_021                 1.520090e-02 3 1  ON 20
ci_022                 8.269286e-03 3 1  ON 21
ci_023                 8.254995e-03 3 1  ON 22
ci_024                 8.343660e-03 3 1  ON 23
ci_025                 8.422056e-03 3 1  ON 24
ci_026                 9.909778e-03 3 1  ON 25
ci_027                 9.698732e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479643e-02 3 1  ON 28
ci_030                -8.758302e-03 3 1  ON 29
ci_031                -8.616190e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550086e-03 3 1  ON 32
ci_034                 4.843632e-03 3 1  ON 33
ci_035                -3.333287e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147832e-02 3 1  ON 36
ci_038                 8.698242e-04 3 1  ON 37
ci_039                 1.141796e-03 3 1  ON 38
ci_040                -1.556558e-03 3 1  ON 39
ci_041                 8.162416e-03 3 1  ON 40
ci_042                 8.161305e-03 3 1  ON 41
ci_043                -2.343168e-03 3 1  ON 42
ci_044                -3.909895e-03 3 1  ON 43
ci_045                -1.989962e-03 3 1  ON 44
ci_046                 4.787328e-03 3 1  ON 45
ci_047                 4.610910e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844907e-03 3 1  ON 49
ci_051                 2.987773e-03 3 1  ON 50
ci_052                -2.169818e-03 3 1  ON 51
ci_053                -2.204228e-03 3 1  ON 52
ci_054                -2.206782e-03 3 1  ON 53
ci_055                -2.424954e-03 3 1  ON 54
ci_056                 4.623353e-03 3 1  ON 55
ci_057                 4.637314e-03 3 1  ON 56
ci_058                -2.068435e-03 3 1  ON 57
ci_059                -2.051534e-03 3 1  ON 58
ci_060                 4.761568e-03 3 1  ON 59
ci_061                 5.208218e-03 3 1  ON 60
ci_062                -2.956690e-03 3 1  ON 61
ci_063                -2.806840e-03 3 1  ON 62
ci_064                -2.259153e-03 3 1  ON 63
ci_065                -3.384065e-03 3 1  ON 64
ci_066                 4.061279e-03 3 1  ON 65
ci_067                 4.229744e-03 3 1  ON 66
ci_068                -4.276388e-03 3 1  ON 67
ci_069                -4.116034e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.1883
    reference variance = 0.424252
====================================================
  Execution time = 1.3462e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0319e-01
  Total weights = 1.9580e+06
  Execution time = 1.8215e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286973657429
                                         uncertainty =       0.002169517554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286973657429
                                         uncertainty =       0.002169517554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378776403
  error estimate for blocks of size 2^( 2) =       0.000390343436
  error estimate for blocks of size 2^( 3) =       0.000400898978
  error estimate for blocks of size 2^( 4) =       0.000408788055
  error estimate for blocks of size 2^( 5) =       0.000414293997
  error estimate for blocks of size 2^( 6) =       0.000416669839
  error estimate for blocks of size 2^( 7) =       0.000418764996

      target function =      -0.907733998691
              le_mean =     -17.214436268538
             les_mean =     296.640004567299
             stat err =       0.000414629222
             autocorr =       1.198268055646
   target nu stat err =       0.000414629222
   target dn stat err =       0.003656921119
      target stat err =       0.005656383074
              std dev =       0.535670726347
             le_variance =       0.286943127065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286973655234
                                         uncertainty =       0.002169516701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286973655234
                                         uncertainty =       0.002169516701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378776402
  error estimate for blocks of size 2^( 2) =       0.000390343434
  error estimate for blocks of size 2^( 3) =       0.000400898977
  error estimate for blocks of size 2^( 4) =       0.000408788053
  error estimate for blocks of size 2^( 5) =       0.000414293996
  error estimate for blocks of size 2^( 6) =       0.000416669838
  error estimate for blocks of size 2^( 7) =       0.000418764997

      target function =      -0.907741648064
              le_mean =     -17.214436268391
             les_mean =     296.639999581157
             stat err =       0.000414629221
             autocorr =       1.198268061798
   target nu stat err =       0.000414629221
   target dn stat err =       0.003656671855
      target stat err =       0.005656098011
              std dev =       0.535670724286
             le_variance =       0.286943124857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286973656332
                                         uncertainty =       0.002169517127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286973656332
                                         uncertainty =       0.002169517127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378776402
  error estimate for blocks of size 2^( 2) =       0.000390343435
  error estimate for blocks of size 2^( 3) =       0.000400898977
  error estimate for blocks of size 2^( 4) =       0.000408788054
  error estimate for blocks of size 2^( 5) =       0.000414293996
  error estimate for blocks of size 2^( 6) =       0.000416669839
  error estimate for blocks of size 2^( 7) =       0.000418764996

      target function =      -0.907737981797
              le_mean =     -17.214436268464
             les_mean =     296.640001971000
             stat err =       0.000414629221
             autocorr =       1.198268058725
   target nu stat err =       0.000414629221
   target dn stat err =       0.003656795550
      target stat err =       0.005656241076
              std dev =       0.535670725316
             le_variance =       0.286943125961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286973657292
                                         uncertainty =       0.002169517501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286973657292
                                         uncertainty =       0.002169517501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378776403
  error estimate for blocks of size 2^( 2) =       0.000390343436
  error estimate for blocks of size 2^( 3) =       0.000400898978
  error estimate for blocks of size 2^( 4) =       0.000408788055
  error estimate for blocks of size 2^( 5) =       0.000414293997
  error estimate for blocks of size 2^( 6) =       0.000416669839
  error estimate for blocks of size 2^( 7) =       0.000418764996

      target function =      -0.907734516324
              le_mean =     -17.214436268529
             les_mean =     296.640004229896
             stat err =       0.000414629222
             autocorr =       1.198268056039
   target nu stat err =       0.000414629222
   target dn stat err =       0.003656905308
      target stat err =       0.005656365393
              std dev =       0.535670726218
             le_variance =       0.286943126927


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.907733998691        initial
     3.6380e+03     3.6380e+04             5.0369e-08        -0.907741648064  <--
     1.4552e+04     1.4552e+05             1.2593e-08        -0.907737981797
     5.8208e+04     5.8208e+05             3.1481e-09        -0.907734516324

*****************************************************************************
Applying the update for shift_i =   3.6380e+03     and shift_s =   3.6380e+04
*****************************************************************************

  Execution time = 2.2656e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -3.749989e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362203e-02 3 1  ON 2
ci_004                 2.083455e-02 3 1  ON 3
ci_005                 2.127882e-02 3 1  ON 4
ci_006                -1.839315e-02 3 1  ON 5
ci_007                -1.848821e-02 3 1  ON 6
ci_008                -7.770717e-03 3 1  ON 7
ci_009                -1.388524e-02 3 1  ON 8
ci_010                -8.841414e-03 3 1  ON 9
ci_011                -8.956772e-03 3 1  ON 10
ci_012                -9.103934e-03 3 1  ON 11
ci_013                -1.908575e-02 3 1  ON 12
ci_014                 1.111445e-02 3 1  ON 13
ci_015                 1.092738e-02 3 1  ON 14
ci_016                 1.590758e-02 3 1  ON 15
ci_017                 1.564055e-02 3 1  ON 16
ci_018                 9.111008e-03 3 1  ON 17
ci_019                 9.004831e-03 3 1  ON 18
ci_020                 1.503804e-02 3 1  ON 19
ci_021                 1.520089e-02 3 1  ON 20
ci_022                 8.269287e-03 3 1  ON 21
ci_023                 8.255000e-03 3 1  ON 22
ci_024                 8.343659e-03 3 1  ON 23
ci_025                 8.422052e-03 3 1  ON 24
ci_026                 9.909768e-03 3 1  ON 25
ci_027                 9.698737e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479644e-02 3 1  ON 28
ci_030                -8.758293e-03 3 1  ON 29
ci_031                -8.616173e-03 3 1  ON 30
ci_032                -1.432816e-02 3 1  ON 31
ci_033                 4.550084e-03 3 1  ON 32
ci_034                 4.843636e-03 3 1  ON 33
ci_035                -3.333288e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147831e-02 3 1  ON 36
ci_038                 8.698205e-04 3 1  ON 37
ci_039                 1.141790e-03 3 1  ON 38
ci_040                -1.556550e-03 3 1  ON 39
ci_041                 8.162408e-03 3 1  ON 40
ci_042                 8.161300e-03 3 1  ON 41
ci_043                -2.343165e-03 3 1  ON 42
ci_044                -3.909892e-03 3 1  ON 43
ci_045                -1.989957e-03 3 1  ON 44
ci_046                 4.787326e-03 3 1  ON 45
ci_047                 4.610906e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295390e-02 3 1  ON 48
ci_050                 2.844919e-03 3 1  ON 49
ci_051                 2.987767e-03 3 1  ON 50
ci_052                -2.169838e-03 3 1  ON 51
ci_053                -2.204230e-03 3 1  ON 52
ci_054                -2.206784e-03 3 1  ON 53
ci_055                -2.424965e-03 3 1  ON 54
ci_056                 4.623354e-03 3 1  ON 55
ci_057                 4.637314e-03 3 1  ON 56
ci_058                -2.068423e-03 3 1  ON 57
ci_059                -2.051553e-03 3 1  ON 58
ci_060                 4.761566e-03 3 1  ON 59
ci_061                 5.208209e-03 3 1  ON 60
ci_062                -2.956693e-03 3 1  ON 61
ci_063                -2.806845e-03 3 1  ON 62
ci_064                -2.259154e-03 3 1  ON 63
ci_065                -3.384064e-03 3 1  ON 64
ci_066                 4.061281e-03 3 1  ON 65
ci_067                 4.229735e-03 3 1  ON 66
ci_068                -4.276399e-03 3 1  ON 67
ci_069                -4.116031e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9605e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2032
    reference variance = 0.340797
====================================================
  Execution time = 1.4297e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5313e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9811e-01
  Total weights = 1.957576671e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4982e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285425636515
                                         uncertainty =       0.001492331058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285425636515
                                         uncertainty =       0.001492331058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377815731
  error estimate for blocks of size 2^( 2) =       0.000389266267
  error estimate for blocks of size 2^( 3) =       0.000399878636
  error estimate for blocks of size 2^( 4) =       0.000407654951
  error estimate for blocks of size 2^( 5) =       0.000411867592
  error estimate for blocks of size 2^( 6) =       0.000413630746
  error estimate for blocks of size 2^( 7) =       0.000415746915

      target function =      -0.915596171411
              le_mean =     -17.214865172275
             les_mean =     296.649697768330
             stat err =       0.000412225051
             autocorr =       1.190443227138
   target nu stat err =       0.000412225051
   target dn stat err =       0.002302144693
      target stat err =       0.003665833167
              std dev =       0.534312130457
             le_variance =       0.285489452754


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721486517227e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915609943336       residual = 8.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915609975929       residual = 7.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915609979345       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915609980512       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915609980788       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915609980849       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915609980852       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915609980875       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915609980874       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915609980872       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+02 is 1.080856e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915609943336       residual = 8.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915609951485       residual = 7.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915609952339       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915609952631       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915609952701       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915609952714       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915609952715       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915609952727       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915609952720       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915609952713       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+03 is 2.702298e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915609943336       residual = 8.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915609945374       residual = 7.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915609945587       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915609945660       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915609945673       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915609945681       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915609945688       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915609945690       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915609945694       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915609945682       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+04 is 6.755844e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.280674 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6805e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -3.749989e-02 3 1  ON 0
ci_002                -2.875420e-02 3 1  ON 1
ci_003                -2.362205e-02 3 1  ON 2
ci_004                 2.083455e-02 3 1  ON 3
ci_005                 2.127881e-02 3 1  ON 4
ci_006                -1.839314e-02 3 1  ON 5
ci_007                -1.848820e-02 3 1  ON 6
ci_008                -7.770701e-03 3 1  ON 7
ci_009                -1.388525e-02 3 1  ON 8
ci_010                -8.841387e-03 3 1  ON 9
ci_011                -8.956776e-03 3 1  ON 10
ci_012                -9.103932e-03 3 1  ON 11
ci_013                -1.908575e-02 3 1  ON 12
ci_014                 1.111445e-02 3 1  ON 13
ci_015                 1.092739e-02 3 1  ON 14
ci_016                 1.590760e-02 3 1  ON 15
ci_017                 1.564055e-02 3 1  ON 16
ci_018                 9.111016e-03 3 1  ON 17
ci_019                 9.004825e-03 3 1  ON 18
ci_020                 1.503804e-02 3 1  ON 19
ci_021                 1.520087e-02 3 1  ON 20
ci_022                 8.269285e-03 3 1  ON 21
ci_023                 8.254992e-03 3 1  ON 22
ci_024                 8.343645e-03 3 1  ON 23
ci_025                 8.422061e-03 3 1  ON 24
ci_026                 9.909770e-03 3 1  ON 25
ci_027                 9.698737e-03 3 1  ON 26
ci_028                -1.452961e-02 3 1  ON 27
ci_029                -1.479644e-02 3 1  ON 28
ci_030                -8.758301e-03 3 1  ON 29
ci_031                -8.616194e-03 3 1  ON 30
ci_032                -1.432815e-02 3 1  ON 31
ci_033                 4.550086e-03 3 1  ON 32
ci_034                 4.843633e-03 3 1  ON 33
ci_035                -3.333278e-03 3 1  ON 34
ci_036                -1.121946e-02 3 1  ON 35
ci_037                -1.147829e-02 3 1  ON 36
ci_038                 8.698098e-04 3 1  ON 37
ci_039                 1.141791e-03 3 1  ON 38
ci_040                -1.556559e-03 3 1  ON 39
ci_041                 8.162404e-03 3 1  ON 40
ci_042                 8.161290e-03 3 1  ON 41
ci_043                -2.343159e-03 3 1  ON 42
ci_044                -3.909882e-03 3 1  ON 43
ci_045                -1.989947e-03 3 1  ON 44
ci_046                 4.787318e-03 3 1  ON 45
ci_047                 4.610889e-03 3 1  ON 46
ci_048                -1.238389e-02 3 1  ON 47
ci_049                -1.295388e-02 3 1  ON 48
ci_050                 2.844929e-03 3 1  ON 49
ci_051                 2.987777e-03 3 1  ON 50
ci_052                -2.169830e-03 3 1  ON 51
ci_053                -2.204216e-03 3 1  ON 52
ci_054                -2.206779e-03 3 1  ON 53
ci_055                -2.424959e-03 3 1  ON 54
ci_056                 4.623354e-03 3 1  ON 55
ci_057                 4.637304e-03 3 1  ON 56
ci_058                -2.068411e-03 3 1  ON 57
ci_059                -2.051573e-03 3 1  ON 58
ci_060                 4.761568e-03 3 1  ON 59
ci_061                 5.208207e-03 3 1  ON 60
ci_062                -2.956697e-03 3 1  ON 61
ci_063                -2.806844e-03 3 1  ON 62
ci_064                -2.259141e-03 3 1  ON 63
ci_065                -3.384053e-03 3 1  ON 64
ci_066                 4.061290e-03 3 1  ON 65
ci_067                 4.229726e-03 3 1  ON 66
ci_068                -4.276407e-03 3 1  ON 67
ci_069                -4.116028e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2014
    reference variance = 0.215187
====================================================
  Execution time = 1.3448e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9634e-01
  Total weights = 1.9578e+06
  Execution time = 1.8137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284049355952
                                         uncertainty =       0.001548317456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284049355952
                                         uncertainty =       0.001548317456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376846387
  error estimate for blocks of size 2^( 2) =       0.000388290745
  error estimate for blocks of size 2^( 3) =       0.000398719705
  error estimate for blocks of size 2^( 4) =       0.000406399174
  error estimate for blocks of size 2^( 5) =       0.000411692752
  error estimate for blocks of size 2^( 6) =       0.000415414145
  error estimate for blocks of size 2^( 7) =       0.000414921197

      target function =      -0.918381036930
              le_mean =     -17.214983362373
             les_mean =     296.651988752184
             stat err =       0.000412106817
             autocorr =       1.195889038937
   target nu stat err =       0.000412106817
   target dn stat err =       0.002269736149
      target stat err =       0.003638516280
              std dev =       0.532941271738
             le_variance =       0.284026399122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284049342774
                                         uncertainty =       0.001548315745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284049342774
                                         uncertainty =       0.001548315745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376846378
  error estimate for blocks of size 2^( 2) =       0.000388290740
  error estimate for blocks of size 2^( 3) =       0.000398719705
  error estimate for blocks of size 2^( 4) =       0.000406399177
  error estimate for blocks of size 2^( 5) =       0.000411692753
  error estimate for blocks of size 2^( 6) =       0.000415414145
  error estimate for blocks of size 2^( 7) =       0.000414921194

      target function =      -0.918381199854
              le_mean =     -17.214983364180
             les_mean =     296.651988710928
             stat err =       0.000412106817
             autocorr =       1.195889094843
   target nu stat err =       0.000412106817
   target dn stat err =       0.002269714635
      target stat err =       0.003638484367
              std dev =       0.532941259332
             le_variance =       0.284026385899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284049349362
                                         uncertainty =       0.001548316601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284049349362
                                         uncertainty =       0.001548316601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376846383
  error estimate for blocks of size 2^( 2) =       0.000388290742
  error estimate for blocks of size 2^( 3) =       0.000398719705
  error estimate for blocks of size 2^( 4) =       0.000406399176
  error estimate for blocks of size 2^( 5) =       0.000411692753
  error estimate for blocks of size 2^( 6) =       0.000415414145
  error estimate for blocks of size 2^( 7) =       0.000414921196

      target function =      -0.918381118580
              le_mean =     -17.214983363277
             les_mean =     296.651988731436
             stat err =       0.000412106817
             autocorr =       1.195889066894
   target nu stat err =       0.000412106817
   target dn stat err =       0.002269725391
      target stat err =       0.003638500323
              std dev =       0.532941265534
             le_variance =       0.284026392509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284049355129
                                         uncertainty =       0.001548317349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284049355129
                                         uncertainty =       0.001548317349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376846387
  error estimate for blocks of size 2^( 2) =       0.000388290744
  error estimate for blocks of size 2^( 3) =       0.000398719705
  error estimate for blocks of size 2^( 4) =       0.000406399175
  error estimate for blocks of size 2^( 5) =       0.000411692752
  error estimate for blocks of size 2^( 6) =       0.000415414145
  error estimate for blocks of size 2^( 7) =       0.000414921197

      target function =      -0.918381047157
              le_mean =     -17.214983362486
             les_mean =     296.651988749577
             stat err =       0.000412106817
             autocorr =       1.195889042430
   target nu stat err =       0.000412106817
   target dn stat err =       0.002269734804
      target stat err =       0.003638514285
              std dev =       0.532941270963
             le_variance =       0.284026398296


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918381036930        initial
     9.0949e+02     9.0949e+03             1.0809e-07        -0.918381199854  <--
     3.6380e+03     3.6380e+04             2.7023e-08        -0.918381118580
     1.4552e+04     1.4552e+05             6.7558e-09        -0.918381047157

*****************************************************************************
Applying the update for shift_i =   9.0949e+02     and shift_s =   9.0949e+03
*****************************************************************************

  Execution time = 2.2605e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -3.749990e-02 3 1  ON 0
ci_002                -2.875418e-02 3 1  ON 1
ci_003                -2.362210e-02 3 1  ON 2
ci_004                 2.083454e-02 3 1  ON 3
ci_005                 2.127880e-02 3 1  ON 4
ci_006                -1.839310e-02 3 1  ON 5
ci_007                -1.848817e-02 3 1  ON 6
ci_008                -7.770652e-03 3 1  ON 7
ci_009                -1.388529e-02 3 1  ON 8
ci_010                -8.841306e-03 3 1  ON 9
ci_011                -8.956787e-03 3 1  ON 10
ci_012                -9.103927e-03 3 1  ON 11
ci_013                -1.908572e-02 3 1  ON 12
ci_014                 1.111444e-02 3 1  ON 13
ci_015                 1.092740e-02 3 1  ON 14
ci_016                 1.590766e-02 3 1  ON 15
ci_017                 1.564057e-02 3 1  ON 16
ci_018                 9.111041e-03 3 1  ON 17
ci_019                 9.004807e-03 3 1  ON 18
ci_020                 1.503802e-02 3 1  ON 19
ci_021                 1.520083e-02 3 1  ON 20
ci_022                 8.269280e-03 3 1  ON 21
ci_023                 8.254967e-03 3 1  ON 22
ci_024                 8.343604e-03 3 1  ON 23
ci_025                 8.422087e-03 3 1  ON 24
ci_026                 9.909777e-03 3 1  ON 25
ci_027                 9.698740e-03 3 1  ON 26
ci_028                -1.452958e-02 3 1  ON 27
ci_029                -1.479644e-02 3 1  ON 28
ci_030                -8.758323e-03 3 1  ON 29
ci_031                -8.616256e-03 3 1  ON 30
ci_032                -1.432814e-02 3 1  ON 31
ci_033                 4.550091e-03 3 1  ON 32
ci_034                 4.843624e-03 3 1  ON 33
ci_035                -3.333248e-03 3 1  ON 34
ci_036                -1.121953e-02 3 1  ON 35
ci_037                -1.147823e-02 3 1  ON 36
ci_038                 8.697777e-04 3 1  ON 37
ci_039                 1.141794e-03 3 1  ON 38
ci_040                -1.556587e-03 3 1  ON 39
ci_041                 8.162393e-03 3 1  ON 40
ci_042                 8.161259e-03 3 1  ON 41
ci_043                -2.343143e-03 3 1  ON 42
ci_044                -3.909853e-03 3 1  ON 43
ci_045                -1.989918e-03 3 1  ON 44
ci_046                 4.787293e-03 3 1  ON 45
ci_047                 4.610839e-03 3 1  ON 46
ci_048                -1.238390e-02 3 1  ON 47
ci_049                -1.295382e-02 3 1  ON 48
ci_050                 2.844956e-03 3 1  ON 49
ci_051                 2.987807e-03 3 1  ON 50
ci_052                -2.169806e-03 3 1  ON 51
ci_053                -2.204175e-03 3 1  ON 52
ci_054                -2.206765e-03 3 1  ON 53
ci_055                -2.424941e-03 3 1  ON 54
ci_056                 4.623356e-03 3 1  ON 55
ci_057                 4.637277e-03 3 1  ON 56
ci_058                -2.068374e-03 3 1  ON 57
ci_059                -2.051633e-03 3 1  ON 58
ci_060                 4.761572e-03 3 1  ON 59
ci_061                 5.208202e-03 3 1  ON 60
ci_062                -2.956709e-03 3 1  ON 61
ci_063                -2.806841e-03 3 1  ON 62
ci_064                -2.259105e-03 3 1  ON 63
ci_065                -3.384020e-03 3 1  ON 64
ci_066                 4.061318e-03 3 1  ON 65
ci_067                 4.229700e-03 3 1  ON 66
ci_068                -4.276431e-03 3 1  ON 67
ci_069                -4.116018e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9429e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.1374
    reference variance = 0.291069
====================================================
  Execution time = 1.4042e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9641e-01
  Total weights = 1.957989418e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285026221050
                                         uncertainty =       0.001527405449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285026221050
                                         uncertainty =       0.001527405449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377509116
  error estimate for blocks of size 2^( 2) =       0.000388796377
  error estimate for blocks of size 2^( 3) =       0.000399000156
  error estimate for blocks of size 2^( 4) =       0.000406900917
  error estimate for blocks of size 2^( 5) =       0.000411434026
  error estimate for blocks of size 2^( 6) =       0.000413759696
  error estimate for blocks of size 2^( 7) =       0.000416428142

      target function =      -0.918293083091
              le_mean =     -17.214197738776
             les_mean =     296.625010386487
             stat err =       0.000412130695
             autocorr =       1.191831986701
   target nu stat err =       0.000412130695
   target dn stat err =       0.002014556789
      target stat err =       0.003240414834
              std dev =       0.533878511772
             le_variance =       0.285026265332


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721419773878e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918303562875       residual = 4.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918303649751       residual = 6.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918303663309       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918303665617       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918303665728       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918303665897       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918303665862       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918303665884       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918303665861       residual = 6.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+02 is 4.286613e-07

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918303562875       residual = 4.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918303584599       residual = 6.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918303587989       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918303588567       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918303588594       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918303588635       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918303588628       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918303588633       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918303588627       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+02 is 1.071888e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918303562875       residual = 4.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918303568306       residual = 6.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918303569154       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918303569298       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918303569305       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918303569314       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918303569317       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918303569316       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918303569313       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+03 is 2.679866e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.283716 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6537e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -3.749988e-02 3 1  ON 0
ci_002                -2.875421e-02 3 1  ON 1
ci_003                -2.362202e-02 3 1  ON 2
ci_004                 2.083452e-02 3 1  ON 3
ci_005                 2.127869e-02 3 1  ON 4
ci_006                -1.839308e-02 3 1  ON 5
ci_007                -1.848812e-02 3 1  ON 6
ci_008                -7.770666e-03 3 1  ON 7
ci_009                -1.388521e-02 3 1  ON 8
ci_010                -8.841346e-03 3 1  ON 9
ci_011                -8.956795e-03 3 1  ON 10
ci_012                -9.103878e-03 3 1  ON 11
ci_013                -1.908571e-02 3 1  ON 12
ci_014                 1.111445e-02 3 1  ON 13
ci_015                 1.092744e-02 3 1  ON 14
ci_016                 1.590764e-02 3 1  ON 15
ci_017                 1.564060e-02 3 1  ON 16
ci_018                 9.111057e-03 3 1  ON 17
ci_019                 9.004804e-03 3 1  ON 18
ci_020                 1.503799e-02 3 1  ON 19
ci_021                 1.520085e-02 3 1  ON 20
ci_022                 8.269239e-03 3 1  ON 21
ci_023                 8.254932e-03 3 1  ON 22
ci_024                 8.343607e-03 3 1  ON 23
ci_025                 8.422112e-03 3 1  ON 24
ci_026                 9.909746e-03 3 1  ON 25
ci_027                 9.698720e-03 3 1  ON 26
ci_028                -1.452959e-02 3 1  ON 27
ci_029                -1.479642e-02 3 1  ON 28
ci_030                -8.758287e-03 3 1  ON 29
ci_031                -8.616312e-03 3 1  ON 30
ci_032                -1.432811e-02 3 1  ON 31
ci_033                 4.550124e-03 3 1  ON 32
ci_034                 4.843539e-03 3 1  ON 33
ci_035                -3.333230e-03 3 1  ON 34
ci_036                -1.121954e-02 3 1  ON 35
ci_037                -1.147821e-02 3 1  ON 36
ci_038                 8.697645e-04 3 1  ON 37
ci_039                 1.141781e-03 3 1  ON 38
ci_040                -1.556568e-03 3 1  ON 39
ci_041                 8.162435e-03 3 1  ON 40
ci_042                 8.161225e-03 3 1  ON 41
ci_043                -2.343113e-03 3 1  ON 42
ci_044                -3.909885e-03 3 1  ON 43
ci_045                -1.989921e-03 3 1  ON 44
ci_046                 4.787303e-03 3 1  ON 45
ci_047                 4.610793e-03 3 1  ON 46
ci_048                -1.238392e-02 3 1  ON 47
ci_049                -1.295371e-02 3 1  ON 48
ci_050                 2.844999e-03 3 1  ON 49
ci_051                 2.987781e-03 3 1  ON 50
ci_052                -2.169851e-03 3 1  ON 51
ci_053                -2.204258e-03 3 1  ON 52
ci_054                -2.206807e-03 3 1  ON 53
ci_055                -2.424923e-03 3 1  ON 54
ci_056                 4.623328e-03 3 1  ON 55
ci_057                 4.637276e-03 3 1  ON 56
ci_058                -2.068412e-03 3 1  ON 57
ci_059                -2.051630e-03 3 1  ON 58
ci_060                 4.761611e-03 3 1  ON 59
ci_061                 5.208113e-03 3 1  ON 60
ci_062                -2.956674e-03 3 1  ON 61
ci_063                -2.806835e-03 3 1  ON 62
ci_064                -2.259106e-03 3 1  ON 63
ci_065                -3.384017e-03 3 1  ON 64
ci_066                 4.061295e-03 3 1  ON 65
ci_067                 4.229693e-03 3 1  ON 66
ci_068                -4.276508e-03 3 1  ON 67
ci_069                -4.116050e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2157
    reference variance = 0.239936
====================================================
  Execution time = 1.3622e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0051e-01
  Total weights = 1.9577e+06
  Execution time = 1.8282e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285683958914
                                         uncertainty =       0.001777582678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285683958914
                                         uncertainty =       0.001777582678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377930517
  error estimate for blocks of size 2^( 2) =       0.000389176232
  error estimate for blocks of size 2^( 3) =       0.000399344031
  error estimate for blocks of size 2^( 4) =       0.000407045135
  error estimate for blocks of size 2^( 5) =       0.000411816279
  error estimate for blocks of size 2^( 6) =       0.000414167816
  error estimate for blocks of size 2^( 7) =       0.000415209827

      target function =      -0.911869390093
              le_mean =     -17.214430222718
             les_mean =     296.637118236476
             stat err =       0.000412059764
             autocorr =       1.188766332320
   target nu stat err =       0.000412059764
   target dn stat err =       0.003269377423
      target stat err =       0.005111827582
              std dev =       0.534474462680
             le_variance =       0.285662951257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285683973177
                                         uncertainty =       0.001777586736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285683973177
                                         uncertainty =       0.001777586736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377930526
  error estimate for blocks of size 2^( 2) =       0.000389176242
  error estimate for blocks of size 2^( 3) =       0.000399344047
  error estimate for blocks of size 2^( 4) =       0.000407045160
  error estimate for blocks of size 2^( 5) =       0.000411816304
  error estimate for blocks of size 2^( 6) =       0.000414167842
  error estimate for blocks of size 2^( 7) =       0.000415209873

      target function =      -0.911878746053
              le_mean =     -17.214430228477
             les_mean =     296.637112397335
             stat err =       0.000412059795
             autocorr =       1.188766447243
   target nu stat err =       0.000412059795
   target dn stat err =       0.003269042745
      target stat err =       0.005111418043
              std dev =       0.534474476186
             le_variance =       0.285662965694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285683966040
                                         uncertainty =       0.001777584708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285683966040
                                         uncertainty =       0.001777584708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377930522
  error estimate for blocks of size 2^( 2) =       0.000389176237
  error estimate for blocks of size 2^( 3) =       0.000399344039
  error estimate for blocks of size 2^( 4) =       0.000407045147
  error estimate for blocks of size 2^( 5) =       0.000411816292
  error estimate for blocks of size 2^( 6) =       0.000414167829
  error estimate for blocks of size 2^( 7) =       0.000415209850

      target function =      -0.911874184851
              le_mean =     -17.214430225596
             les_mean =     296.637115241548
             stat err =       0.000412059780
             autocorr =       1.188766389789
   target nu stat err =       0.000412059780
   target dn stat err =       0.003269202178
      target stat err =       0.005111611981
              std dev =       0.534474469427
             le_variance =       0.285662958470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285683959804
                                         uncertainty =       0.001777582932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285683959804
                                         uncertainty =       0.001777582932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377930518
  error estimate for blocks of size 2^( 2) =       0.000389176233
  error estimate for blocks of size 2^( 3) =       0.000399344032
  error estimate for blocks of size 2^( 4) =       0.000407045137
  error estimate for blocks of size 2^( 5) =       0.000411816281
  error estimate for blocks of size 2^( 6) =       0.000414167818
  error estimate for blocks of size 2^( 7) =       0.000415209830

      target function =      -0.911870002425
              le_mean =     -17.214430223077
             les_mean =     296.637117853728
             stat err =       0.000412059766
             autocorr =       1.188766339506
   target nu stat err =       0.000412059766
   target dn stat err =       0.003269354624
      target stat err =       0.005111799405
              std dev =       0.534474463523
             le_variance =       0.285662952158


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911869390093        initial
     2.2737e+02     2.2737e+03             4.2866e-07        -0.911878746053  <--
     9.0949e+02     9.0949e+03             1.0719e-07        -0.911874184851
     3.6380e+03     3.6380e+04             2.6799e-08        -0.911870002425

*****************************************************************************
Applying the update for shift_i =   2.2737e+02     and shift_s =   2.2737e+03
*****************************************************************************

  Execution time = 2.2922e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -3.749981e-02 3 1  ON 0
ci_002                -2.875432e-02 3 1  ON 1
ci_003                -2.362175e-02 3 1  ON 2
ci_004                 2.083446e-02 3 1  ON 3
ci_005                 2.127839e-02 3 1  ON 4
ci_006                -1.839302e-02 3 1  ON 5
ci_007                -1.848799e-02 3 1  ON 6
ci_008                -7.770707e-03 3 1  ON 7
ci_009                -1.388497e-02 3 1  ON 8
ci_010                -8.841466e-03 3 1  ON 9
ci_011                -8.956818e-03 3 1  ON 10
ci_012                -9.103731e-03 3 1  ON 11
ci_013                -1.908567e-02 3 1  ON 12
ci_014                 1.111445e-02 3 1  ON 13
ci_015                 1.092754e-02 3 1  ON 14
ci_016                 1.590759e-02 3 1  ON 15
ci_017                 1.564071e-02 3 1  ON 16
ci_018                 9.111103e-03 3 1  ON 17
ci_019                 9.004795e-03 3 1  ON 18
ci_020                 1.503792e-02 3 1  ON 19
ci_021                 1.520090e-02 3 1  ON 20
ci_022                 8.269116e-03 3 1  ON 21
ci_023                 8.254828e-03 3 1  ON 22
ci_024                 8.343616e-03 3 1  ON 23
ci_025                 8.422187e-03 3 1  ON 24
ci_026                 9.909651e-03 3 1  ON 25
ci_027                 9.698660e-03 3 1  ON 26
ci_028                -1.452963e-02 3 1  ON 27
ci_029                -1.479638e-02 3 1  ON 28
ci_030                -8.758179e-03 3 1  ON 29
ci_031                -8.616480e-03 3 1  ON 30
ci_032                -1.432800e-02 3 1  ON 31
ci_033                 4.550223e-03 3 1  ON 32
ci_034                 4.843282e-03 3 1  ON 33
ci_035                -3.333177e-03 3 1  ON 34
ci_036                -1.121957e-02 3 1  ON 35
ci_037                -1.147815e-02 3 1  ON 36
ci_038                 8.697248e-04 3 1  ON 37
ci_039                 1.141743e-03 3 1  ON 38
ci_040                -1.556512e-03 3 1  ON 39
ci_041                 8.162563e-03 3 1  ON 40
ci_042                 8.161124e-03 3 1  ON 41
ci_043                -2.343023e-03 3 1  ON 42
ci_044                -3.909983e-03 3 1  ON 43
ci_045                -1.989932e-03 3 1  ON 44
ci_046                 4.787335e-03 3 1  ON 45
ci_047                 4.610655e-03 3 1  ON 46
ci_048                -1.238400e-02 3 1  ON 47
ci_049                -1.295339e-02 3 1  ON 48
ci_050                 2.845127e-03 3 1  ON 49
ci_051                 2.987701e-03 3 1  ON 50
ci_052                -2.169985e-03 3 1  ON 51
ci_053                -2.204507e-03 3 1  ON 52
ci_054                -2.206933e-03 3 1  ON 53
ci_055                -2.424871e-03 3 1  ON 54
ci_056                 4.623243e-03 3 1  ON 55
ci_057                 4.637274e-03 3 1  ON 56
ci_058                -2.068526e-03 3 1  ON 57
ci_059                -2.051622e-03 3 1  ON 58
ci_060                 4.761729e-03 3 1  ON 59
ci_061                 5.207848e-03 3 1  ON 60
ci_062                -2.956568e-03 3 1  ON 61
ci_063                -2.806816e-03 3 1  ON 62
ci_064                -2.259110e-03 3 1  ON 63
ci_065                -3.384008e-03 3 1  ON 64
ci_066                 4.061225e-03 3 1  ON 65
ci_067                 4.229672e-03 3 1  ON 66
ci_068                -4.276741e-03 3 1  ON 67
ci_069                -4.116147e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9464e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.262
    reference variance = 0.301665
====================================================
  Execution time = 1.3713e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0967e-01
  Total weights = 1.957632958e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5244e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288146501522
                                         uncertainty =       0.002913665514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288146501522
                                         uncertainty =       0.002913665514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379564384
  error estimate for blocks of size 2^( 2) =       0.000390592028
  error estimate for blocks of size 2^( 3) =       0.000400874429
  error estimate for blocks of size 2^( 4) =       0.000408875931
  error estimate for blocks of size 2^( 5) =       0.000412730139
  error estimate for blocks of size 2^( 6) =       0.000417425807
  error estimate for blocks of size 2^( 7) =       0.000419275650

      target function =      -0.897857038434
              le_mean =     -17.213883448930
             les_mean =     296.627457606034
             stat err =       0.000414576882
             autocorr =       1.192996728966
   target nu stat err =       0.000414576882
   target dn stat err =       0.006215579638
      target stat err =       0.009350158249
              std dev =       0.536785099845
             le_variance =       0.288138243416


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721388344893e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897953479311       residual = 6.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897956926528       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897957121077       residual = 8.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897957198277       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897957212136       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897957219422       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897957218382       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897957218548       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897957218585       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897957218709       residual = 9.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+01 is 4.171443e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897953479311       residual = 6.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897954342019       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897954390695       residual = 8.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897954410004       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897954413469       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897954415291       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897954415031       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897954415073       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897954415082       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897954415113       residual = 9.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+02 is 1.043954e-06

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897953479311       residual = 6.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897953695045       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897953707216       residual = 8.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897953712044       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897953712910       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897953713366       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897953713301       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897953713312       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897953713314       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897953713321       residual = 9.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+02 is 2.610570e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.287202 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6247e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -3.749940e-02 3 1  ON 0
ci_002                -2.875453e-02 3 1  ON 1
ci_003                -2.362183e-02 3 1  ON 2
ci_004                 2.083496e-02 3 1  ON 3
ci_005                 2.127804e-02 3 1  ON 4
ci_006                -1.839298e-02 3 1  ON 5
ci_007                -1.848795e-02 3 1  ON 6
ci_008                -7.770079e-03 3 1  ON 7
ci_009                -1.388497e-02 3 1  ON 8
ci_010                -8.841124e-03 3 1  ON 9
ci_011                -8.957011e-03 3 1  ON 10
ci_012                -9.103619e-03 3 1  ON 11
ci_013                -1.908586e-02 3 1  ON 12
ci_014                 1.111418e-02 3 1  ON 13
ci_015                 1.092739e-02 3 1  ON 14
ci_016                 1.590805e-02 3 1  ON 15
ci_017                 1.564098e-02 3 1  ON 16
ci_018                 9.110233e-03 3 1  ON 17
ci_019                 9.004690e-03 3 1  ON 18
ci_020                 1.503756e-02 3 1  ON 19
ci_021                 1.520115e-02 3 1  ON 20
ci_022                 8.269196e-03 3 1  ON 21
ci_023                 8.254812e-03 3 1  ON 22
ci_024                 8.343028e-03 3 1  ON 23
ci_025                 8.421550e-03 3 1  ON 24
ci_026                 9.908608e-03 3 1  ON 25
ci_027                 9.698642e-03 3 1  ON 26
ci_028                -1.452975e-02 3 1  ON 27
ci_029                -1.479715e-02 3 1  ON 28
ci_030                -8.758116e-03 3 1  ON 29
ci_031                -8.615506e-03 3 1  ON 30
ci_032                -1.432788e-02 3 1  ON 31
ci_033                 4.550559e-03 3 1  ON 32
ci_034                 4.842754e-03 3 1  ON 33
ci_035                -3.333079e-03 3 1  ON 34
ci_036                -1.121969e-02 3 1  ON 35
ci_037                -1.147725e-02 3 1  ON 36
ci_038                 8.700705e-04 3 1  ON 37
ci_039                 1.141652e-03 3 1  ON 38
ci_040                -1.556061e-03 3 1  ON 39
ci_041                 8.162606e-03 3 1  ON 40
ci_042                 8.161015e-03 3 1  ON 41
ci_043                -2.343190e-03 3 1  ON 42
ci_044                -3.910390e-03 3 1  ON 43
ci_045                -1.990445e-03 3 1  ON 44
ci_046                 4.787407e-03 3 1  ON 45
ci_047                 4.610724e-03 3 1  ON 46
ci_048                -1.238420e-02 3 1  ON 47
ci_049                -1.295342e-02 3 1  ON 48
ci_050                 2.844615e-03 3 1  ON 49
ci_051                 2.988113e-03 3 1  ON 50
ci_052                -2.169947e-03 3 1  ON 51
ci_053                -2.204462e-03 3 1  ON 52
ci_054                -2.207301e-03 3 1  ON 53
ci_055                -2.424862e-03 3 1  ON 54
ci_056                 4.623238e-03 3 1  ON 55
ci_057                 4.637627e-03 3 1  ON 56
ci_058                -2.068480e-03 3 1  ON 57
ci_059                -2.051058e-03 3 1  ON 58
ci_060                 4.761392e-03 3 1  ON 59
ci_061                 5.207865e-03 3 1  ON 60
ci_062                -2.956744e-03 3 1  ON 61
ci_063                -2.806750e-03 3 1  ON 62
ci_064                -2.258915e-03 3 1  ON 63
ci_065                -3.383901e-03 3 1  ON 64
ci_066                 4.061092e-03 3 1  ON 65
ci_067                 4.229508e-03 3 1  ON 66
ci_068                -4.276444e-03 3 1  ON 67
ci_069                -4.115829e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2104
    reference variance = 0.25472
====================================================
  Execution time = 1.3479e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9887e-01
  Total weights = 1.9579e+06
  Execution time = 1.8300e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285882047860
                                         uncertainty =       0.001603194042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285882047860
                                         uncertainty =       0.001603194042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378068452
  error estimate for blocks of size 2^( 2) =       0.000389579095
  error estimate for blocks of size 2^( 3) =       0.000399502809
  error estimate for blocks of size 2^( 4) =       0.000407297272
  error estimate for blocks of size 2^( 5) =       0.000412067665
  error estimate for blocks of size 2^( 6) =       0.000414894115
  error estimate for blocks of size 2^( 7) =       0.000415915056

      target function =      -0.914410109613
              le_mean =     -17.214580031794
             les_mean =     296.640646172718
             stat err =       0.000412543527
             autocorr =       1.190689919087
   target nu stat err =       0.000412543527
   target dn stat err =       0.002322137910
      target stat err =       0.003685249697
              std dev =       0.534669531744
             le_variance =       0.285871508175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285881845907
                                         uncertainty =       0.001603171936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285881845907
                                         uncertainty =       0.001603171936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378068318
  error estimate for blocks of size 2^( 2) =       0.000389579270
  error estimate for blocks of size 2^( 3) =       0.000399503273
  error estimate for blocks of size 2^( 4) =       0.000407298008
  error estimate for blocks of size 2^( 5) =       0.000412068388
  error estimate for blocks of size 2^( 6) =       0.000414894848
  error estimate for blocks of size 2^( 7) =       0.000415915890

      target function =      -0.914479644541
              le_mean =     -17.214580016581
             les_mean =     296.640601099150
             stat err =       0.000412544284
             autocorr =       1.190695129701
   target nu stat err =       0.000412544284
   target dn stat err =       0.002311685012
      target stat err =       0.003669813056
              std dev =       0.534669342734
             le_variance =       0.285871306059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285881946033
                                         uncertainty =       0.001603182968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285881946033
                                         uncertainty =       0.001603182968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378068384
  error estimate for blocks of size 2^( 2) =       0.000389579182
  error estimate for blocks of size 2^( 3) =       0.000399503041
  error estimate for blocks of size 2^( 4) =       0.000407297640
  error estimate for blocks of size 2^( 5) =       0.000412068026
  error estimate for blocks of size 2^( 6) =       0.000414894481
  error estimate for blocks of size 2^( 7) =       0.000415915473

      target function =      -0.914446053936
              le_mean =     -17.214580024042
             les_mean =     296.640622876890
             stat err =       0.000412543905
             autocorr =       1.190692526981
   target nu stat err =       0.000412543905
   target dn stat err =       0.002316637461
      target stat err =       0.003677121918
              std dev =       0.534669436443
             le_variance =       0.285871406267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285882035043
                                         uncertainty =       0.001603192656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285882035043
                                         uncertainty =       0.001603192656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378068443
  error estimate for blocks of size 2^( 2) =       0.000389579106
  error estimate for blocks of size 2^( 3) =       0.000399502838
  error estimate for blocks of size 2^( 4) =       0.000407297317
  error estimate for blocks of size 2^( 5) =       0.000412067710
  error estimate for blocks of size 2^( 6) =       0.000414894161
  error estimate for blocks of size 2^( 7) =       0.000415915108

      target function =      -0.914414735485
              le_mean =     -17.214580030809
             les_mean =     296.640643175094
             stat err =       0.000412543574
             autocorr =       1.190690245167
   target nu stat err =       0.000412543574
   target dn stat err =       0.002321418332
      target stat err =       0.003684185838
              std dev =       0.534669519748
             le_variance =       0.285871495348


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914410109613        initial
     5.6843e+01     5.6843e+02             4.1714e-06        -0.914479644541  <--
     2.2737e+02     2.2737e+03             1.0440e-06        -0.914446053936
     9.0949e+02     9.0949e+03             2.6106e-07        -0.914414735485

*****************************************************************************
Applying the update for shift_i =   5.6843e+01     and shift_s =   5.6843e+02
*****************************************************************************

  Execution time = 2.2721e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -3.749816e-02 3 1  ON 0
ci_002                -2.875518e-02 3 1  ON 1
ci_003                -2.362206e-02 3 1  ON 2
ci_004                 2.083649e-02 3 1  ON 3
ci_005                 2.127700e-02 3 1  ON 4
ci_006                -1.839287e-02 3 1  ON 5
ci_007                -1.848784e-02 3 1  ON 6
ci_008                -7.768196e-03 3 1  ON 7
ci_009                -1.388496e-02 3 1  ON 8
ci_010                -8.840101e-03 3 1  ON 9
ci_011                -8.957589e-03 3 1  ON 10
ci_012                -9.103284e-03 3 1  ON 11
ci_013                -1.908641e-02 3 1  ON 12
ci_014                 1.111337e-02 3 1  ON 13
ci_015                 1.092694e-02 3 1  ON 14
ci_016                 1.590943e-02 3 1  ON 15
ci_017                 1.564181e-02 3 1  ON 16
ci_018                 9.107630e-03 3 1  ON 17
ci_019                 9.004378e-03 3 1  ON 18
ci_020                 1.503649e-02 3 1  ON 19
ci_021                 1.520191e-02 3 1  ON 20
ci_022                 8.269434e-03 3 1  ON 21
ci_023                 8.254763e-03 3 1  ON 22
ci_024                 8.341265e-03 3 1  ON 23
ci_025                 8.419641e-03 3 1  ON 24
ci_026                 9.905480e-03 3 1  ON 25
ci_027                 9.698585e-03 3 1  ON 26
ci_028                -1.453012e-02 3 1  ON 27
ci_029                -1.479944e-02 3 1  ON 28
ci_030                -8.757929e-03 3 1  ON 29
ci_031                -8.612587e-03 3 1  ON 30
ci_032                -1.432752e-02 3 1  ON 31
ci_033                 4.551564e-03 3 1  ON 32
ci_034                 4.841173e-03 3 1  ON 33
ci_035                -3.332784e-03 3 1  ON 34
ci_036                -1.122008e-02 3 1  ON 35
ci_037                -1.147454e-02 3 1  ON 36
ci_038                 8.711064e-04 3 1  ON 37
ci_039                 1.141379e-03 3 1  ON 38
ci_040                -1.554709e-03 3 1  ON 39
ci_041                 8.162734e-03 3 1  ON 40
ci_042                 8.160690e-03 3 1  ON 41
ci_043                -2.343693e-03 3 1  ON 42
ci_044                -3.911606e-03 3 1  ON 43
ci_045                -1.991983e-03 3 1  ON 44
ci_046                 4.787622e-03 3 1  ON 45
ci_047                 4.610930e-03 3 1  ON 46
ci_048                -1.238480e-02 3 1  ON 47
ci_049                -1.295351e-02 3 1  ON 48
ci_050                 2.843081e-03 3 1  ON 49
ci_051                 2.989347e-03 3 1  ON 50
ci_052                -2.169836e-03 3 1  ON 51
ci_053                -2.204324e-03 3 1  ON 52
ci_054                -2.208403e-03 3 1  ON 53
ci_055                -2.424834e-03 3 1  ON 54
ci_056                 4.623222e-03 3 1  ON 55
ci_057                 4.638682e-03 3 1  ON 56
ci_058                -2.068344e-03 3 1  ON 57
ci_059                -2.049371e-03 3 1  ON 58
ci_060                 4.760383e-03 3 1  ON 59
ci_061                 5.207915e-03 3 1  ON 60
ci_062                -2.957273e-03 3 1  ON 61
ci_063                -2.806553e-03 3 1  ON 62
ci_064                -2.258330e-03 3 1  ON 63
ci_065                -3.383580e-03 3 1  ON 64
ci_066                 4.060695e-03 3 1  ON 65
ci_067                 4.229018e-03 3 1  ON 66
ci_068                -4.275555e-03 3 1  ON 67
ci_069                -4.114877e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8977e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.2136
    reference variance = 0.301804
====================================================
  Execution time = 1.3988e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9964e-01
  Total weights = 1.957720518e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5241e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287045850643
                                         uncertainty =       0.001805416532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287045850643
                                         uncertainty =       0.001805416532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378832679
  error estimate for blocks of size 2^( 2) =       0.000390123437
  error estimate for blocks of size 2^( 3) =       0.000400461661
  error estimate for blocks of size 2^( 4) =       0.000408010636
  error estimate for blocks of size 2^( 5) =       0.000413030876
  error estimate for blocks of size 2^( 6) =       0.000416159996
  error estimate for blocks of size 2^( 7) =       0.000419845688

      target function =      -0.913233425823
              le_mean =     -17.214379322398
             les_mean =     296.634496618651
             stat err =       0.000414261799
             autocorr =       1.195789961427
   target nu stat err =       0.000414261799
   target dn stat err =       0.002326079486
      target stat err =       0.003681137187
              std dev =       0.535750312367
             le_variance =       0.287028397201


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721437932240e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913247216082       residual = 8.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913249138002       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913249505519       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913249666540       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913249674024       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913249677946       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913249678355       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913249679409       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913249679224       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913249679213       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+01 is 7.756855e-06

solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913247216082       residual = 8.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913247698568       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913247790745       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913247831081       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913247832945       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913247833924       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913247834027       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913247834290       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913247834243       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913247834241       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+01 is 1.946510e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913247216082       residual = 8.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913247336829       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913247359892       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913247369981       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913247370448       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913247370691       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913247370717       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913247370783       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913247370771       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913247370771       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+02 is 4.870857e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.290760 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6521e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -3.749769e-02 3 1  ON 0
ci_002                -2.875375e-02 3 1  ON 1
ci_003                -2.362077e-02 3 1  ON 2
ci_004                 2.083619e-02 3 1  ON 3
ci_005                 2.127573e-02 3 1  ON 4
ci_006                -1.839339e-02 3 1  ON 5
ci_007                -1.848867e-02 3 1  ON 6
ci_008                -7.768042e-03 3 1  ON 7
ci_009                -1.388361e-02 3 1  ON 8
ci_010                -8.838286e-03 3 1  ON 9
ci_011                -8.957427e-03 3 1  ON 10
ci_012                -9.103000e-03 3 1  ON 11
ci_013                -1.908749e-02 3 1  ON 12
ci_014                 1.111336e-02 3 1  ON 13
ci_015                 1.092635e-02 3 1  ON 14
ci_016                 1.590944e-02 3 1  ON 15
ci_017                 1.564252e-02 3 1  ON 16
ci_018                 9.105927e-03 3 1  ON 17
ci_019                 9.003717e-03 3 1  ON 18
ci_020                 1.503751e-02 3 1  ON 19
ci_021                 1.520251e-02 3 1  ON 20
ci_022                 8.269528e-03 3 1  ON 21
ci_023                 8.254048e-03 3 1  ON 22
ci_024                 8.340380e-03 3 1  ON 23
ci_025                 8.419587e-03 3 1  ON 24
ci_026                 9.904725e-03 3 1  ON 25
ci_027                 9.699306e-03 3 1  ON 26
ci_028                -1.453034e-02 3 1  ON 27
ci_029                -1.479905e-02 3 1  ON 28
ci_030                -8.755982e-03 3 1  ON 29
ci_031                -8.612445e-03 3 1  ON 30
ci_032                -1.432737e-02 3 1  ON 31
ci_033                 4.551390e-03 3 1  ON 32
ci_034                 4.839904e-03 3 1  ON 33
ci_035                -3.332381e-03 3 1  ON 34
ci_036                -1.122031e-02 3 1  ON 35
ci_037                -1.147489e-02 3 1  ON 36
ci_038                 8.706620e-04 3 1  ON 37
ci_039                 1.141081e-03 3 1  ON 38
ci_040                -1.555029e-03 3 1  ON 39
ci_041                 8.162669e-03 3 1  ON 40
ci_042                 8.160890e-03 3 1  ON 41
ci_043                -2.343528e-03 3 1  ON 42
ci_044                -3.910329e-03 3 1  ON 43
ci_045                -1.991560e-03 3 1  ON 44
ci_046                 4.787213e-03 3 1  ON 45
ci_047                 4.611130e-03 3 1  ON 46
ci_048                -1.238354e-02 3 1  ON 47
ci_049                -1.295324e-02 3 1  ON 48
ci_050                 2.843608e-03 3 1  ON 49
ci_051                 2.988035e-03 3 1  ON 50
ci_052                -2.170058e-03 3 1  ON 51
ci_053                -2.204327e-03 3 1  ON 52
ci_054                -2.208444e-03 3 1  ON 53
ci_055                -2.425501e-03 3 1  ON 54
ci_056                 4.623526e-03 3 1  ON 55
ci_057                 4.639473e-03 3 1  ON 56
ci_058                -2.068689e-03 3 1  ON 57
ci_059                -2.050252e-03 3 1  ON 58
ci_060                 4.760149e-03 3 1  ON 59
ci_061                 5.208244e-03 3 1  ON 60
ci_062                -2.956273e-03 3 1  ON 61
ci_063                -2.806559e-03 3 1  ON 62
ci_064                -2.258691e-03 3 1  ON 63
ci_065                -3.383326e-03 3 1  ON 64
ci_066                 4.060202e-03 3 1  ON 65
ci_067                 4.228665e-03 3 1  ON 66
ci_068                -4.275610e-03 3 1  ON 67
ci_069                -4.114764e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.341
    reference variance = 0.537041
====================================================
  Execution time = 1.4128e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9982e-01
  Total weights = 1.9575e+06
  Execution time = 1.8360e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287591101759
                                         uncertainty =       0.001764398137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287591101759
                                         uncertainty =       0.001764398137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379200043
  error estimate for blocks of size 2^( 2) =       0.000390365871
  error estimate for blocks of size 2^( 3) =       0.000400443629
  error estimate for blocks of size 2^( 4) =       0.000408015563
  error estimate for blocks of size 2^( 5) =       0.000412179055
  error estimate for blocks of size 2^( 6) =       0.000414927349
  error estimate for blocks of size 2^( 7) =       0.000414656300

      target function =      -0.912934944578
              le_mean =     -17.214765479707
             les_mean =     296.647974846872
             stat err =       0.000412444567
             autocorr =       1.183026349312
   target nu stat err =       0.000412444567
   target dn stat err =       0.002392383463
      target stat err =       0.003781993809
              std dev =       0.536269843685
             le_variance =       0.287585345246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287590122265
                                         uncertainty =       0.001764355073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287590122265
                                         uncertainty =       0.001764355073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379199402
  error estimate for blocks of size 2^( 2) =       0.000390365829
  error estimate for blocks of size 2^( 3) =       0.000400444327
  error estimate for blocks of size 2^( 4) =       0.000408016673
  error estimate for blocks of size 2^( 5) =       0.000412180507
  error estimate for blocks of size 2^( 6) =       0.000414929034
  error estimate for blocks of size 2^( 7) =       0.000414658165

      target function =      -0.912945576240
              le_mean =     -17.214765421271
             les_mean =     296.647965991905
             stat err =       0.000412446095
             autocorr =       1.183039113530
   target nu stat err =       0.000412446095
   target dn stat err =       0.002392391383
      target stat err =       0.003782092542
              std dev =       0.536268937782
             le_variance =       0.287584373630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287590607251
                                         uncertainty =       0.001764376437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287590607251
                                         uncertainty =       0.001764376437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379199720
  error estimate for blocks of size 2^( 2) =       0.000390365848
  error estimate for blocks of size 2^( 3) =       0.000400443977
  error estimate for blocks of size 2^( 4) =       0.000408016118
  error estimate for blocks of size 2^( 5) =       0.000412179782
  error estimate for blocks of size 2^( 6) =       0.000414928193
  error estimate for blocks of size 2^( 7) =       0.000414657234

      target function =      -0.912940454289
              le_mean =     -17.214765450032
             les_mean =     296.647970278846
             stat err =       0.000412445332
             autocorr =       1.183032756877
   target nu stat err =       0.000412445332
   target dn stat err =       0.002392385906
      target stat err =       0.003782042436
              std dev =       0.536269386312
             le_variance =       0.287584854695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287591039576
                                         uncertainty =       0.001764395413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287591039576
                                         uncertainty =       0.001764395413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379200002
  error estimate for blocks of size 2^( 2) =       0.000390365868
  error estimate for blocks of size 2^( 3) =       0.000400443672
  error estimate for blocks of size 2^( 4) =       0.000408015632
  error estimate for blocks of size 2^( 5) =       0.000412179146
  error estimate for blocks of size 2^( 6) =       0.000414927455
  error estimate for blocks of size 2^( 7) =       0.000414656417

      target function =      -0.912935654128
              le_mean =     -17.214765475957
             les_mean =     296.647974261064
             stat err =       0.000412444662
             autocorr =       1.183027151167
   target nu stat err =       0.000412444662
   target dn stat err =       0.002392383590
      target stat err =       0.003781999785
              std dev =       0.536269786169
             le_variance =       0.287585283558


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912934944578        initial
     1.4211e+01     1.4211e+02             7.7569e-06        -0.912945576240  <--
     5.6843e+01     5.6843e+02             1.9465e-06        -0.912940454289
     2.2737e+02     2.2737e+03             4.8709e-07        -0.912935654128

*****************************************************************************
Applying the update for shift_i =   1.4211e+01     and shift_s =   1.4211e+02
*****************************************************************************

  Execution time = 2.3520e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -3.749628e-02 3 1  ON 0
ci_002                -2.874947e-02 3 1  ON 1
ci_003                -2.361691e-02 3 1  ON 2
ci_004                 2.083531e-02 3 1  ON 3
ci_005                 2.127195e-02 3 1  ON 4
ci_006                -1.839494e-02 3 1  ON 5
ci_007                -1.849115e-02 3 1  ON 6
ci_008                -7.767583e-03 3 1  ON 7
ci_009                -1.387959e-02 3 1  ON 8
ci_010                -8.832868e-03 3 1  ON 9
ci_011                -8.956944e-03 3 1  ON 10
ci_012                -9.102153e-03 3 1  ON 11
ci_013                -1.909071e-02 3 1  ON 12
ci_014                 1.111334e-02 3 1  ON 13
ci_015                 1.092459e-02 3 1  ON 14
ci_016                 1.590947e-02 3 1  ON 15
ci_017                 1.564463e-02 3 1  ON 16
ci_018                 9.100846e-03 3 1  ON 17
ci_019                 9.001746e-03 3 1  ON 18
ci_020                 1.504056e-02 3 1  ON 19
ci_021                 1.520432e-02 3 1  ON 20
ci_022                 8.269808e-03 3 1  ON 21
ci_023                 8.251912e-03 3 1  ON 22
ci_024                 8.337735e-03 3 1  ON 23
ci_025                 8.419424e-03 3 1  ON 24
ci_026                 9.902473e-03 3 1  ON 25
ci_027                 9.701454e-03 3 1  ON 26
ci_028                -1.453100e-02 3 1  ON 27
ci_029                -1.479789e-02 3 1  ON 28
ci_030                -8.750172e-03 3 1  ON 29
ci_031                -8.612019e-03 3 1  ON 30
ci_032                -1.432695e-02 3 1  ON 31
ci_033                 4.550869e-03 3 1  ON 32
ci_034                 4.836115e-03 3 1  ON 33
ci_035                -3.331175e-03 3 1  ON 34
ci_036                -1.122100e-02 3 1  ON 35
ci_037                -1.147596e-02 3 1  ON 36
ci_038                 8.693360e-04 3 1  ON 37
ci_039                 1.140194e-03 3 1  ON 38
ci_040                -1.555982e-03 3 1  ON 39
ci_041                 8.162477e-03 3 1  ON 40
ci_042                 8.161485e-03 3 1  ON 41
ci_043                -2.343037e-03 3 1  ON 42
ci_044                -3.906517e-03 3 1  ON 43
ci_045                -1.990299e-03 3 1  ON 44
ci_046                 4.785991e-03 3 1  ON 45
ci_047                 4.611728e-03 3 1  ON 46
ci_048                -1.237977e-02 3 1  ON 47
ci_049                -1.295242e-02 3 1  ON 48
ci_050                 2.845179e-03 3 1  ON 49
ci_051                 2.984120e-03 3 1  ON 50
ci_052                -2.170721e-03 3 1  ON 51
ci_053                -2.204333e-03 3 1  ON 52
ci_054                -2.208567e-03 3 1  ON 53
ci_055                -2.427490e-03 3 1  ON 54
ci_056                 4.624432e-03 3 1  ON 55
ci_057                 4.641832e-03 3 1  ON 56
ci_058                -2.069721e-03 3 1  ON 57
ci_059                -2.052880e-03 3 1  ON 58
ci_060                 4.759450e-03 3 1  ON 59
ci_061                 5.209227e-03 3 1  ON 60
ci_062                -2.953287e-03 3 1  ON 61
ci_063                -2.806576e-03 3 1  ON 62
ci_064                -2.259768e-03 3 1  ON 63
ci_065                -3.382568e-03 3 1  ON 64
ci_066                 4.058728e-03 3 1  ON 65
ci_067                 4.227613e-03 3 1  ON 66
ci_068                -4.275775e-03 3 1  ON 67
ci_069                -4.114428e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0047e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2305
    reference variance = 0.172474
====================================================
  Execution time = 1.6135e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5309e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0214e-01
  Total weights = 1.957600510e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5078e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288863083067
                                         uncertainty =       0.001763508617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288863083067
                                         uncertainty =       0.001763508617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380034980
  error estimate for blocks of size 2^( 2) =       0.000391602917
  error estimate for blocks of size 2^( 3) =       0.000402856625
  error estimate for blocks of size 2^( 4) =       0.000409786221
  error estimate for blocks of size 2^( 5) =       0.000414942421
  error estimate for blocks of size 2^( 6) =       0.000417960712
  error estimate for blocks of size 2^( 7) =       0.000418767771

      target function =      -0.909358978385
              le_mean =     -17.214359956466
             les_mean =     296.636332761100
             stat err =       0.000415364281
             autocorr =       1.194568747780
   target nu stat err =       0.000415364281
   target dn stat err =       0.002647157350
      target stat err =       0.004137102153
              std dev =       0.537450623249
             le_variance =       0.288853172431


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721435995647e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+00, overlap shift 3.5527e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909376696594       residual = 6.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909385122024       residual = 8.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909386121702       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909386460546       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909386492349       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909386517730       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909386519215       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909386520858       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909386519825       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909386519917       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+00 is 4.257914e-05

solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909376696594       residual = 6.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909378836493       residual = 8.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909379089077       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909379174591       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909379182480       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909379188845       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909379189222       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909379189625       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909379189366       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909379189390       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+01 is 1.080358e-05

solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909376696594       residual = 6.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909377233707       residual = 8.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909377297021       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909377318451       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909377320419       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909377322011       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909377322106       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909377322206       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909377322141       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909377322147       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+01 is 2.711005e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.294285 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8653e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -3.749372e-02 3 1  ON 0
ci_002                -2.874977e-02 3 1  ON 1
ci_003                -2.361348e-02 3 1  ON 2
ci_004                 2.083735e-02 3 1  ON 3
ci_005                 2.126706e-02 3 1  ON 4
ci_006                -1.839250e-02 3 1  ON 5
ci_007                -1.849082e-02 3 1  ON 6
ci_008                -7.767546e-03 3 1  ON 7
ci_009                -1.387662e-02 3 1  ON 8
ci_010                -8.829179e-03 3 1  ON 9
ci_011                -8.950331e-03 3 1  ON 10
ci_012                -9.096834e-03 3 1  ON 11
ci_013                -1.908558e-02 3 1  ON 12
ci_014                 1.111048e-02 3 1  ON 13
ci_015                 1.092255e-02 3 1  ON 14
ci_016                 1.590581e-02 3 1  ON 15
ci_017                 1.564381e-02 3 1  ON 16
ci_018                 9.101991e-03 3 1  ON 17
ci_019                 9.001316e-03 3 1  ON 18
ci_020                 1.504394e-02 3 1  ON 19
ci_021                 1.520297e-02 3 1  ON 20
ci_022                 8.269938e-03 3 1  ON 21
ci_023                 8.253792e-03 3 1  ON 22
ci_024                 8.339881e-03 3 1  ON 23
ci_025                 8.411043e-03 3 1  ON 24
ci_026                 9.896402e-03 3 1  ON 25
ci_027                 9.705437e-03 3 1  ON 26
ci_028                -1.452937e-02 3 1  ON 27
ci_029                -1.479506e-02 3 1  ON 28
ci_030                -8.751550e-03 3 1  ON 29
ci_031                -8.611650e-03 3 1  ON 30
ci_032                -1.432774e-02 3 1  ON 31
ci_033                 4.550789e-03 3 1  ON 32
ci_034                 4.831723e-03 3 1  ON 33
ci_035                -3.331074e-03 3 1  ON 34
ci_036                -1.121578e-02 3 1  ON 35
ci_037                -1.147349e-02 3 1  ON 36
ci_038                 8.679724e-04 3 1  ON 37
ci_039                 1.139207e-03 3 1  ON 38
ci_040                -1.555399e-03 3 1  ON 39
ci_041                 8.159933e-03 3 1  ON 40
ci_042                 8.162718e-03 3 1  ON 41
ci_043                -2.343351e-03 3 1  ON 42
ci_044                -3.895713e-03 3 1  ON 43
ci_045                -1.988725e-03 3 1  ON 44
ci_046                 4.782235e-03 3 1  ON 45
ci_047                 4.611711e-03 3 1  ON 46
ci_048                -1.238071e-02 3 1  ON 47
ci_049                -1.295175e-02 3 1  ON 48
ci_050                 2.845473e-03 3 1  ON 49
ci_051                 2.984294e-03 3 1  ON 50
ci_052                -2.171565e-03 3 1  ON 51
ci_053                -2.207392e-03 3 1  ON 52
ci_054                -2.210982e-03 3 1  ON 53
ci_055                -2.425286e-03 3 1  ON 54
ci_056                 4.626202e-03 3 1  ON 55
ci_057                 4.643053e-03 3 1  ON 56
ci_058                -2.067992e-03 3 1  ON 57
ci_059                -2.051972e-03 3 1  ON 58
ci_060                 4.760364e-03 3 1  ON 59
ci_061                 5.204901e-03 3 1  ON 60
ci_062                -2.948468e-03 3 1  ON 61
ci_063                -2.810078e-03 3 1  ON 62
ci_064                -2.260586e-03 3 1  ON 63
ci_065                -3.382771e-03 3 1  ON 64
ci_066                 4.059200e-03 3 1  ON 65
ci_067                 4.228187e-03 3 1  ON 66
ci_068                -4.268908e-03 3 1  ON 67
ci_069                -4.113790e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.181
    reference variance = 0.180004
====================================================
  Execution time = 1.3833e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9832e-01
  Total weights = 1.9577e+06
  Execution time = 1.8378e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285357902387
                                         uncertainty =       0.001565779442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285357902387
                                         uncertainty =       0.001565779442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377766409
  error estimate for blocks of size 2^( 2) =       0.000389252876
  error estimate for blocks of size 2^( 3) =       0.000399623153
  error estimate for blocks of size 2^( 4) =       0.000406260262
  error estimate for blocks of size 2^( 5) =       0.000409923105
  error estimate for blocks of size 2^( 6) =       0.000411384669
  error estimate for blocks of size 2^( 7) =       0.000414167822

      target function =      -0.915304166857
              le_mean =     -17.214226276805
             les_mean =     296.627901204263
             stat err =       0.000410433965
             autocorr =       1.180429106262
   target nu stat err =       0.000410433965
   target dn stat err =       0.002190570201
      target stat err =       0.003487914327
              std dev =       0.534242379124
             le_variance =       0.285414919652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285357033986
                                         uncertainty =       0.001565711073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285357033986
                                         uncertainty =       0.001565711073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377765857
  error estimate for blocks of size 2^( 2) =       0.000389254061
  error estimate for blocks of size 2^( 3) =       0.000399626410
  error estimate for blocks of size 2^( 4) =       0.000406265309
  error estimate for blocks of size 2^( 5) =       0.000409929874
  error estimate for blocks of size 2^( 6) =       0.000411391942
  error estimate for blocks of size 2^( 7) =       0.000414173283

      target function =      -0.915289495491
              le_mean =     -17.214226282879
             les_mean =     296.627910814806
             stat err =       0.000410440102
             autocorr =       1.180467860337
   target nu stat err =       0.000410440102
   target dn stat err =       0.002191179169
      target stat err =       0.003488737523
              std dev =       0.534241598190
             le_variance =       0.285414085236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285357416739
                                         uncertainty =       0.001565744551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285357416739
                                         uncertainty =       0.001565744551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377766099
  error estimate for blocks of size 2^( 2) =       0.000389253447
  error estimate for blocks of size 2^( 3) =       0.000399624772
  error estimate for blocks of size 2^( 4) =       0.000406262784
  error estimate for blocks of size 2^( 5) =       0.000409926500
  error estimate for blocks of size 2^( 6) =       0.000411388323
  error estimate for blocks of size 2^( 7) =       0.000414170531

      target function =      -0.913915406421
              le_mean =     -17.214226269242
             les_mean =     296.628791267662
             stat err =       0.000410437034
             autocorr =       1.180448701226
   target nu stat err =       0.000410437034
   target dn stat err =       0.002363141284
      target stat err =       0.003740856622
              std dev =       0.534241940789
             le_variance =       0.285414451298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285357836366
                                         uncertainty =       0.001565775010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285357836366
                                         uncertainty =       0.001565775010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377766367
  error estimate for blocks of size 2^( 2) =       0.000389252944
  error estimate for blocks of size 2^( 3) =       0.000399623353
  error estimate for blocks of size 2^( 4) =       0.000406260576
  error estimate for blocks of size 2^( 5) =       0.000409923529
  error estimate for blocks of size 2^( 6) =       0.000411385124
  error estimate for blocks of size 2^( 7) =       0.000414168163

      target function =      -0.915303902982
              le_mean =     -17.214226275697
             les_mean =     296.627901335065
             stat err =       0.000410434348
             autocorr =       1.180431575400
   target nu stat err =       0.000410434348
   target dn stat err =       0.002190601732
      target stat err =       0.003487960667
              std dev =       0.534242319370
             le_variance =       0.285414855806


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915304166857        initial  <--
     3.5527e+00     3.5527e+01             4.2579e-05        -0.915289495491
     1.4211e+01     1.4211e+02             1.0804e-05        -0.913915406421
     5.6843e+01     5.6843e+02             2.7110e-06        -0.915303902982

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1218
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -3.749628e-02 3 1  ON 0
ci_002                -2.874947e-02 3 1  ON 1
ci_003                -2.361691e-02 3 1  ON 2
ci_004                 2.083531e-02 3 1  ON 3
ci_005                 2.127195e-02 3 1  ON 4
ci_006                -1.839494e-02 3 1  ON 5
ci_007                -1.849115e-02 3 1  ON 6
ci_008                -7.767583e-03 3 1  ON 7
ci_009                -1.387959e-02 3 1  ON 8
ci_010                -8.832868e-03 3 1  ON 9
ci_011                -8.956944e-03 3 1  ON 10
ci_012                -9.102153e-03 3 1  ON 11
ci_013                -1.909071e-02 3 1  ON 12
ci_014                 1.111334e-02 3 1  ON 13
ci_015                 1.092459e-02 3 1  ON 14
ci_016                 1.590947e-02 3 1  ON 15
ci_017                 1.564463e-02 3 1  ON 16
ci_018                 9.100846e-03 3 1  ON 17
ci_019                 9.001746e-03 3 1  ON 18
ci_020                 1.504056e-02 3 1  ON 19
ci_021                 1.520432e-02 3 1  ON 20
ci_022                 8.269808e-03 3 1  ON 21
ci_023                 8.251912e-03 3 1  ON 22
ci_024                 8.337735e-03 3 1  ON 23
ci_025                 8.419424e-03 3 1  ON 24
ci_026                 9.902473e-03 3 1  ON 25
ci_027                 9.701454e-03 3 1  ON 26
ci_028                -1.453100e-02 3 1  ON 27
ci_029                -1.479789e-02 3 1  ON 28
ci_030                -8.750172e-03 3 1  ON 29
ci_031                -8.612019e-03 3 1  ON 30
ci_032                -1.432695e-02 3 1  ON 31
ci_033                 4.550869e-03 3 1  ON 32
ci_034                 4.836115e-03 3 1  ON 33
ci_035                -3.331175e-03 3 1  ON 34
ci_036                -1.122100e-02 3 1  ON 35
ci_037                -1.147596e-02 3 1  ON 36
ci_038                 8.693360e-04 3 1  ON 37
ci_039                 1.140194e-03 3 1  ON 38
ci_040                -1.555982e-03 3 1  ON 39
ci_041                 8.162477e-03 3 1  ON 40
ci_042                 8.161485e-03 3 1  ON 41
ci_043                -2.343037e-03 3 1  ON 42
ci_044                -3.906517e-03 3 1  ON 43
ci_045                -1.990299e-03 3 1  ON 44
ci_046                 4.785991e-03 3 1  ON 45
ci_047                 4.611728e-03 3 1  ON 46
ci_048                -1.237977e-02 3 1  ON 47
ci_049                -1.295242e-02 3 1  ON 48
ci_050                 2.845179e-03 3 1  ON 49
ci_051                 2.984120e-03 3 1  ON 50
ci_052                -2.170721e-03 3 1  ON 51
ci_053                -2.204333e-03 3 1  ON 52
ci_054                -2.208567e-03 3 1  ON 53
ci_055                -2.427490e-03 3 1  ON 54
ci_056                 4.624432e-03 3 1  ON 55
ci_057                 4.641832e-03 3 1  ON 56
ci_058                -2.069721e-03 3 1  ON 57
ci_059                -2.052880e-03 3 1  ON 58
ci_060                 4.759450e-03 3 1  ON 59
ci_061                 5.209227e-03 3 1  ON 60
ci_062                -2.953287e-03 3 1  ON 61
ci_063                -2.806576e-03 3 1  ON 62
ci_064                -2.259768e-03 3 1  ON 63
ci_065                -3.382568e-03 3 1  ON 64
ci_066                 4.058728e-03 3 1  ON 65
ci_067                 4.227613e-03 3 1  ON 66
ci_068                -4.275775e-03 3 1  ON 67
ci_069                -4.114428e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1780e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.1863
    reference variance = 0.263066
====================================================
  Execution time = 1.3921e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5319e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0335e-01
  Total weights = 1.957614684e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5090e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290182195572
                                         uncertainty =       0.002092154755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290182195572
                                         uncertainty =       0.002092154755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380903507
  error estimate for blocks of size 2^( 2) =       0.000391730776
  error estimate for blocks of size 2^( 3) =       0.000401726460
  error estimate for blocks of size 2^( 4) =       0.000410270583
  error estimate for blocks of size 2^( 5) =       0.000415470919
  error estimate for blocks of size 2^( 6) =       0.000417252634
  error estimate for blocks of size 2^( 7) =       0.000415094841

      target function =      -0.907496144520
              le_mean =     -17.214647945263
             les_mean =     296.647450251286
             stat err =       0.000414522244
             autocorr =       1.184310934506
   target nu stat err =       0.000414522244
   target dn stat err =       0.002802801304
      target stat err =       0.004357958158
              std dev =       0.538678905468
             le_variance =       0.290174963196


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721464794526e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+01, overlap shift 3.5527e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907516240766       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907518469810       residual = 9.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907518616489       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907518642719       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907518651525       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907518653256       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907518653634       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907518653491       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907518653594       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907518653704       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+01 is 5.274941e-06

solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907516240766       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907516798956       residual = 9.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907516835668       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907516842231       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907516844434       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907516844867       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907516844961       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907516844926       residual = 8.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907516844951       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907516844979       residual = 3.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+02 is 1.320936e-06

solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907516240766       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907516380372       residual = 9.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907516389553       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907516391194       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907516391745       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907516391853       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907516391876       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907516391867       residual = 8.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907516391874       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907516391881       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+02 is 3.303720e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.297787 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6441e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -3.749649e-02 3 1  ON 0
ci_002                -2.874934e-02 3 1  ON 1
ci_003                -2.361725e-02 3 1  ON 2
ci_004                 2.083492e-02 3 1  ON 3
ci_005                 2.127160e-02 3 1  ON 4
ci_006                -1.839518e-02 3 1  ON 5
ci_007                -1.849119e-02 3 1  ON 6
ci_008                -7.766992e-03 3 1  ON 7
ci_009                -1.387967e-02 3 1  ON 8
ci_010                -8.832332e-03 3 1  ON 9
ci_011                -8.957975e-03 3 1  ON 10
ci_012                -9.101506e-03 3 1  ON 11
ci_013                -1.909067e-02 3 1  ON 12
ci_014                 1.111313e-02 3 1  ON 13
ci_015                 1.092413e-02 3 1  ON 14
ci_016                 1.590912e-02 3 1  ON 15
ci_017                 1.564496e-02 3 1  ON 16
ci_018                 9.100742e-03 3 1  ON 17
ci_019                 9.001825e-03 3 1  ON 18
ci_020                 1.504065e-02 3 1  ON 19
ci_021                 1.520453e-02 3 1  ON 20
ci_022                 8.270180e-03 3 1  ON 21
ci_023                 8.252082e-03 3 1  ON 22
ci_024                 8.337474e-03 3 1  ON 23
ci_025                 8.419828e-03 3 1  ON 24
ci_026                 9.902277e-03 3 1  ON 25
ci_027                 9.701424e-03 3 1  ON 26
ci_028                -1.453174e-02 3 1  ON 27
ci_029                -1.479792e-02 3 1  ON 28
ci_030                -8.751493e-03 3 1  ON 29
ci_031                -8.611732e-03 3 1  ON 30
ci_032                -1.432712e-02 3 1  ON 31
ci_033                 4.550502e-03 3 1  ON 32
ci_034                 4.835918e-03 3 1  ON 33
ci_035                -3.331166e-03 3 1  ON 34
ci_036                -1.122041e-02 3 1  ON 35
ci_037                -1.147602e-02 3 1  ON 36
ci_038                 8.694127e-04 3 1  ON 37
ci_039                 1.140201e-03 3 1  ON 38
ci_040                -1.555993e-03 3 1  ON 39
ci_041                 8.161577e-03 3 1  ON 40
ci_042                 8.161407e-03 3 1  ON 41
ci_043                -2.343088e-03 3 1  ON 42
ci_044                -3.906630e-03 3 1  ON 43
ci_045                -1.989975e-03 3 1  ON 44
ci_046                 4.785503e-03 3 1  ON 45
ci_047                 4.611720e-03 3 1  ON 46
ci_048                -1.237912e-02 3 1  ON 47
ci_049                -1.295241e-02 3 1  ON 48
ci_050                 2.845544e-03 3 1  ON 49
ci_051                 2.984275e-03 3 1  ON 50
ci_052                -2.171542e-03 3 1  ON 51
ci_053                -2.205355e-03 3 1  ON 52
ci_054                -2.208723e-03 3 1  ON 53
ci_055                -2.427378e-03 3 1  ON 54
ci_056                 4.624432e-03 3 1  ON 55
ci_057                 4.641675e-03 3 1  ON 56
ci_058                -2.069747e-03 3 1  ON 57
ci_059                -2.053059e-03 3 1  ON 58
ci_060                 4.759584e-03 3 1  ON 59
ci_061                 5.208906e-03 3 1  ON 60
ci_062                -2.953488e-03 3 1  ON 61
ci_063                -2.806753e-03 3 1  ON 62
ci_064                -2.259656e-03 3 1  ON 63
ci_065                -3.382580e-03 3 1  ON 64
ci_066                 4.058967e-03 3 1  ON 65
ci_067                 4.227357e-03 3 1  ON 66
ci_068                -4.275510e-03 3 1  ON 67
ci_069                -4.113854e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2338
    reference variance = 0.161892
====================================================
  Execution time = 1.3426e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9904e-01
  Total weights = 1.9577e+06
  Execution time = 1.8259e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285700931447
                                         uncertainty =       0.001736930578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285700931447
                                         uncertainty =       0.001736930578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377916195
  error estimate for blocks of size 2^( 2) =       0.000389420639
  error estimate for blocks of size 2^( 3) =       0.000399630412
  error estimate for blocks of size 2^( 4) =       0.000406963981
  error estimate for blocks of size 2^( 5) =       0.000411738153
  error estimate for blocks of size 2^( 6) =       0.000412953349
  error estimate for blocks of size 2^( 7) =       0.000414646758

      target function =      -0.914136014153
              le_mean =     -17.215129265405
             les_mean =     296.659720022298
             stat err =       0.000411575560
             autocorr =       1.186064070326
   target nu stat err =       0.000411575560
   target dn stat err =       0.002379270926
      target stat err =       0.003773996857
              std dev =       0.534454207863
             le_variance =       0.285641300302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285701482875
                                         uncertainty =       0.001736981437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285701482875
                                         uncertainty =       0.001736981437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377916557
  error estimate for blocks of size 2^( 2) =       0.000389421015
  error estimate for blocks of size 2^( 3) =       0.000399630891
  error estimate for blocks of size 2^( 4) =       0.000406964520
  error estimate for blocks of size 2^( 5) =       0.000411738655
  error estimate for blocks of size 2^( 6) =       0.000412953950
  error estimate for blocks of size 2^( 7) =       0.000414647189

      target function =      -0.914144702380
              le_mean =     -17.215129328552
             les_mean =     296.659716616053
             stat err =       0.000411576078
             autocorr =       1.186064783568
   target nu stat err =       0.000411576078
   target dn stat err =       0.002379796267
      target stat err =       0.003774872500
              std dev =       0.534454720178
             le_variance =       0.285641847920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285701206286
                                         uncertainty =       0.001736956024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285701206286
                                         uncertainty =       0.001736956024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377916375
  error estimate for blocks of size 2^( 2) =       0.000389420826
  error estimate for blocks of size 2^( 3) =       0.000399630651
  error estimate for blocks of size 2^( 4) =       0.000406964250
  error estimate for blocks of size 2^( 5) =       0.000411738403
  error estimate for blocks of size 2^( 6) =       0.000412953649
  error estimate for blocks of size 2^( 7) =       0.000414646973

      target function =      -0.914141663580
              le_mean =     -17.215129296920
             les_mean =     296.659717479681
             stat err =       0.000411575819
             autocorr =       1.186064427957
   target nu stat err =       0.000411575819
   target dn stat err =       0.002379523493
      target stat err =       0.003774429793
              std dev =       0.534454463200
             le_variance =       0.285641573234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285700965671
                                         uncertainty =       0.001736933758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285700965671
                                         uncertainty =       0.001736933758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377916217
  error estimate for blocks of size 2^( 2) =       0.000389420663
  error estimate for blocks of size 2^( 3) =       0.000399630441
  error estimate for blocks of size 2^( 4) =       0.000406964014
  error estimate for blocks of size 2^( 5) =       0.000411738184
  error estimate for blocks of size 2^( 6) =       0.000412953387
  error estimate for blocks of size 2^( 7) =       0.000414646785

      target function =      -0.914136919140
              le_mean =     -17.215129269335
             les_mean =     296.659719576578
             stat err =       0.000411575592
             autocorr =       1.186064115093
   target nu stat err =       0.000411575592
   target dn stat err =       0.002379300774
      target stat err =       0.003774049948
              std dev =       0.534454239658
             le_variance =       0.285641334288


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914136014153        initial
     3.5527e+01     3.5527e+02             5.2749e-06        -0.914144702380  <--
     1.4211e+02     1.4211e+03             1.3209e-06        -0.914141663580
     5.6843e+02     5.6843e+03             3.3037e-07        -0.914136919140

*****************************************************************************
Applying the update for shift_i =   3.5527e+01     and shift_s =   3.5527e+02
*****************************************************************************

  Execution time = 2.2662e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -3.749715e-02 3 1  ON 0
ci_002                -2.874893e-02 3 1  ON 1
ci_003                -2.361827e-02 3 1  ON 2
ci_004                 2.083375e-02 3 1  ON 3
ci_005                 2.127054e-02 3 1  ON 4
ci_006                -1.839589e-02 3 1  ON 5
ci_007                -1.849130e-02 3 1  ON 6
ci_008                -7.765223e-03 3 1  ON 7
ci_009                -1.387991e-02 3 1  ON 8
ci_010                -8.830727e-03 3 1  ON 9
ci_011                -8.961062e-03 3 1  ON 10
ci_012                -9.099568e-03 3 1  ON 11
ci_013                -1.909054e-02 3 1  ON 12
ci_014                 1.111249e-02 3 1  ON 13
ci_015                 1.092275e-02 3 1  ON 14
ci_016                 1.590807e-02 3 1  ON 15
ci_017                 1.564596e-02 3 1  ON 16
ci_018                 9.100433e-03 3 1  ON 17
ci_019                 9.002064e-03 3 1  ON 18
ci_020                 1.504090e-02 3 1  ON 19
ci_021                 1.520516e-02 3 1  ON 20
ci_022                 8.271295e-03 3 1  ON 21
ci_023                 8.252593e-03 3 1  ON 22
ci_024                 8.336690e-03 3 1  ON 23
ci_025                 8.421038e-03 3 1  ON 24
ci_026                 9.901689e-03 3 1  ON 25
ci_027                 9.701332e-03 3 1  ON 26
ci_028                -1.453397e-02 3 1  ON 27
ci_029                -1.479803e-02 3 1  ON 28
ci_030                -8.755447e-03 3 1  ON 29
ci_031                -8.610874e-03 3 1  ON 30
ci_032                -1.432764e-02 3 1  ON 31
ci_033                 4.549401e-03 3 1  ON 32
ci_034                 4.835330e-03 3 1  ON 33
ci_035                -3.331138e-03 3 1  ON 34
ci_036                -1.121867e-02 3 1  ON 35
ci_037                -1.147620e-02 3 1  ON 36
ci_038                 8.696423e-04 3 1  ON 37
ci_039                 1.140222e-03 3 1  ON 38
ci_040                -1.556024e-03 3 1  ON 39
ci_041                 8.158881e-03 3 1  ON 40
ci_042                 8.161174e-03 3 1  ON 41
ci_043                -2.343243e-03 3 1  ON 42
ci_044                -3.906968e-03 3 1  ON 43
ci_045                -1.989005e-03 3 1  ON 44
ci_046                 4.784044e-03 3 1  ON 45
ci_047                 4.611696e-03 3 1  ON 46
ci_048                -1.237717e-02 3 1  ON 47
ci_049                -1.295238e-02 3 1  ON 48
ci_050                 2.846636e-03 3 1  ON 49
ci_051                 2.984738e-03 3 1  ON 50
ci_052                -2.173997e-03 3 1  ON 51
ci_053                -2.208413e-03 3 1  ON 52
ci_054                -2.209189e-03 3 1  ON 53
ci_055                -2.427044e-03 3 1  ON 54
ci_056                 4.624435e-03 3 1  ON 55
ci_057                 4.641206e-03 3 1  ON 56
ci_058                -2.069825e-03 3 1  ON 57
ci_059                -2.053596e-03 3 1  ON 58
ci_060                 4.759988e-03 3 1  ON 59
ci_061                 5.207944e-03 3 1  ON 60
ci_062                -2.954089e-03 3 1  ON 61
ci_063                -2.807282e-03 3 1  ON 62
ci_064                -2.259322e-03 3 1  ON 63
ci_065                -3.382619e-03 3 1  ON 64
ci_066                 4.059680e-03 3 1  ON 65
ci_067                 4.226590e-03 3 1  ON 66
ci_068                -4.274717e-03 3 1  ON 67
ci_069                -4.112136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9111e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.1616
    reference variance = 0.173094
====================================================
  Execution time = 1.4013e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5319e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9696e-01
  Total weights = 1.957688607e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5375e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283929296680
                                         uncertainty =       0.001448339073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283929296680
                                         uncertainty =       0.001448339073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376758189
  error estimate for blocks of size 2^( 2) =       0.000388086630
  error estimate for blocks of size 2^( 3) =       0.000398917314
  error estimate for blocks of size 2^( 4) =       0.000407241913
  error estimate for blocks of size 2^( 5) =       0.000412640768
  error estimate for blocks of size 2^( 6) =       0.000414006982
  error estimate for blocks of size 2^( 7) =       0.000416078297

      target function =      -0.917414169058
              le_mean =     -17.214738402557
             les_mean =     296.644175589445
             stat err =       0.000412491990
             autocorr =       1.198686562619
   target nu stat err =       0.000412491990
   target dn stat err =       0.002133298579
      target stat err =       0.003419784564
              std dev =       0.532816541318
             le_variance =       0.283893466702


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721473840256e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+00, overlap shift 8.8818e+01 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917425890714       residual = 6.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917428458414       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917428959052       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917429155725       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917429152930       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917429174464       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917429173199       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917429173034       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917429172301       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917429172046       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+00 is 1.260916e-05

solving harmonic davidson linear method for identity shift 3.5527e+01, overlap shift 3.5527e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917425890714       residual = 6.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917426536965       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917426662741       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917426712044       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917426711326       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917426716714       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917426716396       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917426716354       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917426716172       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917426716108       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+01 is 3.168391e-06

solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917425890714       residual = 6.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917426052550       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917426084032       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917426096366       residual = 5.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917426096186       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917426097533       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917426097454       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917426097443       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917426097397       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917426097381       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+02 is 7.931105e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.301321 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6560e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -3.749620e-02 3 1  ON 0
ci_002                -2.874935e-02 3 1  ON 1
ci_003                -2.361806e-02 3 1  ON 2
ci_004                 2.083528e-02 3 1  ON 3
ci_005                 2.126958e-02 3 1  ON 4
ci_006                -1.839466e-02 3 1  ON 5
ci_007                -1.849153e-02 3 1  ON 6
ci_008                -7.764981e-03 3 1  ON 7
ci_009                -1.387860e-02 3 1  ON 8
ci_010                -8.828293e-03 3 1  ON 9
ci_011                -8.960021e-03 3 1  ON 10
ci_012                -9.100478e-03 3 1  ON 11
ci_013                -1.908968e-02 3 1  ON 12
ci_014                 1.111341e-02 3 1  ON 13
ci_015                 1.092218e-02 3 1  ON 14
ci_016                 1.590835e-02 3 1  ON 15
ci_017                 1.564743e-02 3 1  ON 16
ci_018                 9.099920e-03 3 1  ON 17
ci_019                 9.001488e-03 3 1  ON 18
ci_020                 1.503773e-02 3 1  ON 19
ci_021                 1.520488e-02 3 1  ON 20
ci_022                 8.271956e-03 3 1  ON 21
ci_023                 8.251555e-03 3 1  ON 22
ci_024                 8.336194e-03 3 1  ON 23
ci_025                 8.419612e-03 3 1  ON 24
ci_026                 9.903514e-03 3 1  ON 25
ci_027                 9.700446e-03 3 1  ON 26
ci_028                -1.453372e-02 3 1  ON 27
ci_029                -1.479961e-02 3 1  ON 28
ci_030                -8.755711e-03 3 1  ON 29
ci_031                -8.610796e-03 3 1  ON 30
ci_032                -1.432728e-02 3 1  ON 31
ci_033                 4.551213e-03 3 1  ON 32
ci_034                 4.833514e-03 3 1  ON 33
ci_035                -3.330690e-03 3 1  ON 34
ci_036                -1.121956e-02 3 1  ON 35
ci_037                -1.147875e-02 3 1  ON 36
ci_038                 8.694642e-04 3 1  ON 37
ci_039                 1.138609e-03 3 1  ON 38
ci_040                -1.556427e-03 3 1  ON 39
ci_041                 8.157602e-03 3 1  ON 40
ci_042                 8.161484e-03 3 1  ON 41
ci_043                -2.343330e-03 3 1  ON 42
ci_044                -3.908296e-03 3 1  ON 43
ci_045                -1.988323e-03 3 1  ON 44
ci_046                 4.783675e-03 3 1  ON 45
ci_047                 4.611316e-03 3 1  ON 46
ci_048                -1.237595e-02 3 1  ON 47
ci_049                -1.295215e-02 3 1  ON 48
ci_050                 2.846148e-03 3 1  ON 49
ci_051                 2.984814e-03 3 1  ON 50
ci_052                -2.172861e-03 3 1  ON 51
ci_053                -2.208717e-03 3 1  ON 52
ci_054                -2.207835e-03 3 1  ON 53
ci_055                -2.426895e-03 3 1  ON 54
ci_056                 4.623531e-03 3 1  ON 55
ci_057                 4.641770e-03 3 1  ON 56
ci_058                -2.069388e-03 3 1  ON 57
ci_059                -2.055460e-03 3 1  ON 58
ci_060                 4.761310e-03 3 1  ON 59
ci_061                 5.208592e-03 3 1  ON 60
ci_062                -2.952654e-03 3 1  ON 61
ci_063                -2.806625e-03 3 1  ON 62
ci_064                -2.258976e-03 3 1  ON 63
ci_065                -3.382226e-03 3 1  ON 64
ci_066                 4.059495e-03 3 1  ON 65
ci_067                 4.225653e-03 3 1  ON 66
ci_068                -4.275383e-03 3 1  ON 67
ci_069                -4.114986e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.3169
    reference variance = 0.761998
====================================================
  Execution time = 1.3537e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0070e-01
  Total weights = 1.9578e+06
  Execution time = 1.8391e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285699571289
                                         uncertainty =       0.001429548596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285699571289
                                         uncertainty =       0.001429548596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377925648
  error estimate for blocks of size 2^( 2) =       0.000389416992
  error estimate for blocks of size 2^( 3) =       0.000400262384
  error estimate for blocks of size 2^( 4) =       0.000407782958
  error estimate for blocks of size 2^( 5) =       0.000412031157
  error estimate for blocks of size 2^( 6) =       0.000413749610
  error estimate for blocks of size 2^( 7) =       0.000415379342

      target function =      -0.911607478696
              le_mean =     -17.213787346760
             les_mean =     296.615170876179
             stat err =       0.000412235767
             autocorr =       1.189812721529
   target nu stat err =       0.000412235767
   target dn stat err =       0.003098778148
      target stat err =       0.004841694388
              std dev =       0.534467576269
             le_variance =       0.285655590082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285698392446
                                         uncertainty =       0.001429595193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285698392446
                                         uncertainty =       0.001429595193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377924857
  error estimate for blocks of size 2^( 2) =       0.000389416513
  error estimate for blocks of size 2^( 3) =       0.000400262199
  error estimate for blocks of size 2^( 4) =       0.000407783020
  error estimate for blocks of size 2^( 5) =       0.000412031307
  error estimate for blocks of size 2^( 6) =       0.000413749482
  error estimate for blocks of size 2^( 7) =       0.000415378889

      target function =      -0.911599851737
              le_mean =     -17.213787215372
             les_mean =     296.615171260512
             stat err =       0.000412235675
             autocorr =       1.189817164524
   target nu stat err =       0.000412235675
   target dn stat err =       0.003101491650
      target stat err =       0.004845764523
              std dev =       0.534466458724
             le_variance =       0.285654395501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285698972153
                                         uncertainty =       0.001429571964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285698972153
                                         uncertainty =       0.001429571964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377925246
  error estimate for blocks of size 2^( 2) =       0.000389416747
  error estimate for blocks of size 2^( 3) =       0.000400262287
  error estimate for blocks of size 2^( 4) =       0.000407782985
  error estimate for blocks of size 2^( 5) =       0.000412031229
  error estimate for blocks of size 2^( 6) =       0.000413749542
  error estimate for blocks of size 2^( 7) =       0.000415379110

      target function =      -0.911603810962
              le_mean =     -17.213787279809
             les_mean =     296.615170930801
             stat err =       0.000412235716
             autocorr =       1.189814958179
   target nu stat err =       0.000412235716
   target dn stat err =       0.003100134346
      target stat err =       0.004843730139
              std dev =       0.534467008362
             le_variance =       0.285654983027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285699495601
                                         uncertainty =       0.001429551508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285699495601
                                         uncertainty =       0.001429551508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377925597
  error estimate for blocks of size 2^( 2) =       0.000389416961
  error estimate for blocks of size 2^( 3) =       0.000400262371
  error estimate for blocks of size 2^( 4) =       0.000407782961
  error estimate for blocks of size 2^( 5) =       0.000412031166
  error estimate for blocks of size 2^( 6) =       0.000413749601
  error estimate for blocks of size 2^( 7) =       0.000415379312

      target function =      -0.911607036397
              le_mean =     -17.213787338284
             les_mean =     296.615170868854
             stat err =       0.000412235760
             autocorr =       1.189813001695
   target nu stat err =       0.000412235760
   target dn stat err =       0.003098947282
      target stat err =       0.004841948429
              std dev =       0.534467504534
             le_variance =       0.285655513403


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911607478696        initial  <--
     8.8818e+00     8.8818e+01             1.2609e-05        -0.911599851737
     3.5527e+01     3.5527e+02             3.1684e-06        -0.911603810962
     1.4211e+02     1.4211e+03             7.9311e-07        -0.911607036397

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8436
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -3.749715e-02 3 1  ON 0
ci_002                -2.874893e-02 3 1  ON 1
ci_003                -2.361827e-02 3 1  ON 2
ci_004                 2.083375e-02 3 1  ON 3
ci_005                 2.127054e-02 3 1  ON 4
ci_006                -1.839589e-02 3 1  ON 5
ci_007                -1.849130e-02 3 1  ON 6
ci_008                -7.765223e-03 3 1  ON 7
ci_009                -1.387991e-02 3 1  ON 8
ci_010                -8.830727e-03 3 1  ON 9
ci_011                -8.961062e-03 3 1  ON 10
ci_012                -9.099568e-03 3 1  ON 11
ci_013                -1.909054e-02 3 1  ON 12
ci_014                 1.111249e-02 3 1  ON 13
ci_015                 1.092275e-02 3 1  ON 14
ci_016                 1.590807e-02 3 1  ON 15
ci_017                 1.564596e-02 3 1  ON 16
ci_018                 9.100433e-03 3 1  ON 17
ci_019                 9.002064e-03 3 1  ON 18
ci_020                 1.504090e-02 3 1  ON 19
ci_021                 1.520516e-02 3 1  ON 20
ci_022                 8.271295e-03 3 1  ON 21
ci_023                 8.252593e-03 3 1  ON 22
ci_024                 8.336690e-03 3 1  ON 23
ci_025                 8.421038e-03 3 1  ON 24
ci_026                 9.901689e-03 3 1  ON 25
ci_027                 9.701332e-03 3 1  ON 26
ci_028                -1.453397e-02 3 1  ON 27
ci_029                -1.479803e-02 3 1  ON 28
ci_030                -8.755447e-03 3 1  ON 29
ci_031                -8.610874e-03 3 1  ON 30
ci_032                -1.432764e-02 3 1  ON 31
ci_033                 4.549401e-03 3 1  ON 32
ci_034                 4.835330e-03 3 1  ON 33
ci_035                -3.331138e-03 3 1  ON 34
ci_036                -1.121867e-02 3 1  ON 35
ci_037                -1.147620e-02 3 1  ON 36
ci_038                 8.696423e-04 3 1  ON 37
ci_039                 1.140222e-03 3 1  ON 38
ci_040                -1.556024e-03 3 1  ON 39
ci_041                 8.158881e-03 3 1  ON 40
ci_042                 8.161174e-03 3 1  ON 41
ci_043                -2.343243e-03 3 1  ON 42
ci_044                -3.906968e-03 3 1  ON 43
ci_045                -1.989005e-03 3 1  ON 44
ci_046                 4.784044e-03 3 1  ON 45
ci_047                 4.611696e-03 3 1  ON 46
ci_048                -1.237717e-02 3 1  ON 47
ci_049                -1.295238e-02 3 1  ON 48
ci_050                 2.846636e-03 3 1  ON 49
ci_051                 2.984738e-03 3 1  ON 50
ci_052                -2.173997e-03 3 1  ON 51
ci_053                -2.208413e-03 3 1  ON 52
ci_054                -2.209189e-03 3 1  ON 53
ci_055                -2.427044e-03 3 1  ON 54
ci_056                 4.624435e-03 3 1  ON 55
ci_057                 4.641206e-03 3 1  ON 56
ci_058                -2.069825e-03 3 1  ON 57
ci_059                -2.053596e-03 3 1  ON 58
ci_060                 4.759988e-03 3 1  ON 59
ci_061                 5.207944e-03 3 1  ON 60
ci_062                -2.954089e-03 3 1  ON 61
ci_063                -2.807282e-03 3 1  ON 62
ci_064                -2.259322e-03 3 1  ON 63
ci_065                -3.382619e-03 3 1  ON 64
ci_066                 4.059680e-03 3 1  ON 65
ci_067                 4.226590e-03 3 1  ON 66
ci_068                -4.274717e-03 3 1  ON 67
ci_069                -4.112136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9410e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2038
    reference variance = 0.365084
====================================================
  Execution time = 1.4490e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0049e-01
  Total weights = 1.958010705e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5057e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287253091021
                                         uncertainty =       0.002109365638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287253091021
                                         uncertainty =       0.002109365638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378986162
  error estimate for blocks of size 2^( 2) =       0.000390637987
  error estimate for blocks of size 2^( 3) =       0.000400895016
  error estimate for blocks of size 2^( 4) =       0.000408957512
  error estimate for blocks of size 2^( 5) =       0.000414618661
  error estimate for blocks of size 2^( 6) =       0.000416615095
  error estimate for blocks of size 2^( 7) =       0.000417468977

      target function =      -0.911885974337
              le_mean =     -17.214903630308
             les_mean =     296.653399761430
             stat err =       0.000414415061
             autocorr =       1.195705858611
   target nu stat err =       0.000414415061
   target dn stat err =       0.002874821570
      target stat err =       0.004511993405
              std dev =       0.535967369607
             le_variance =       0.287261021283


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721490363031e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+01, overlap shift 8.8818e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911907437420       residual = 2.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911908416942       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911908540872       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911908563769       residual = 7.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911908567702       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911908568631       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911908568020       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911908567883       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911908567985       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911908567992       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+01 is 1.582067e-06

solving harmonic davidson linear method for identity shift 3.5527e+02, overlap shift 3.5527e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911907437420       residual = 2.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911907682466       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911907713465       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911907719191       residual = 7.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911907720174       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911907720407       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911907720253       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911907720219       residual = 9.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911907720245       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911907720247       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+02 is 3.957752e-07

solving harmonic davidson linear method for identity shift 1.4211e+03, overlap shift 1.4211e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911907437420       residual = 2.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911907498692       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911907506443       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911907507876       residual = 7.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911907508121       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911907508179       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911907508140       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911907508132       residual = 9.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911907508137       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911907508140       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+03 is 9.895997e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.304772 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7005e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -3.749687e-02 3 1  ON 0
ci_002                -2.874884e-02 3 1  ON 1
ci_003                -2.361821e-02 3 1  ON 2
ci_004                 2.083380e-02 3 1  ON 3
ci_005                 2.127027e-02 3 1  ON 4
ci_006                -1.839590e-02 3 1  ON 5
ci_007                -1.849127e-02 3 1  ON 6
ci_008                -7.764926e-03 3 1  ON 7
ci_009                -1.387978e-02 3 1  ON 8
ci_010                -8.830383e-03 3 1  ON 9
ci_011                -8.961067e-03 3 1  ON 10
ci_012                -9.099675e-03 3 1  ON 11
ci_013                -1.909057e-02 3 1  ON 12
ci_014                 1.111270e-02 3 1  ON 13
ci_015                 1.092265e-02 3 1  ON 14
ci_016                 1.590814e-02 3 1  ON 15
ci_017                 1.564602e-02 3 1  ON 16
ci_018                 9.100634e-03 3 1  ON 17
ci_019                 9.001882e-03 3 1  ON 18
ci_020                 1.504117e-02 3 1  ON 19
ci_021                 1.520496e-02 3 1  ON 20
ci_022                 8.271248e-03 3 1  ON 21
ci_023                 8.252663e-03 3 1  ON 22
ci_024                 8.336784e-03 3 1  ON 23
ci_025                 8.420838e-03 3 1  ON 24
ci_026                 9.901425e-03 3 1  ON 25
ci_027                 9.701562e-03 3 1  ON 26
ci_028                -1.453371e-02 3 1  ON 27
ci_029                -1.479818e-02 3 1  ON 28
ci_030                -8.755843e-03 3 1  ON 29
ci_031                -8.610929e-03 3 1  ON 30
ci_032                -1.432763e-02 3 1  ON 31
ci_033                 4.549445e-03 3 1  ON 32
ci_034                 4.835143e-03 3 1  ON 33
ci_035                -3.331081e-03 3 1  ON 34
ci_036                -1.121891e-02 3 1  ON 35
ci_037                -1.147608e-02 3 1  ON 36
ci_038                 8.695417e-04 3 1  ON 37
ci_039                 1.140162e-03 3 1  ON 38
ci_040                -1.556009e-03 3 1  ON 39
ci_041                 8.159177e-03 3 1  ON 40
ci_042                 8.161133e-03 3 1  ON 41
ci_043                -2.343228e-03 3 1  ON 42
ci_044                -3.907156e-03 3 1  ON 43
ci_045                -1.989041e-03 3 1  ON 44
ci_046                 4.783906e-03 3 1  ON 45
ci_047                 4.611786e-03 3 1  ON 46
ci_048                -1.237707e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.846415e-03 3 1  ON 49
ci_051                 2.985009e-03 3 1  ON 50
ci_052                -2.174350e-03 3 1  ON 51
ci_053                -2.208363e-03 3 1  ON 52
ci_054                -2.208984e-03 3 1  ON 53
ci_055                -2.427034e-03 3 1  ON 54
ci_056                 4.624426e-03 3 1  ON 55
ci_057                 4.640930e-03 3 1  ON 56
ci_058                -2.069898e-03 3 1  ON 57
ci_059                -2.053615e-03 3 1  ON 58
ci_060                 4.760071e-03 3 1  ON 59
ci_061                 5.207700e-03 3 1  ON 60
ci_062                -2.953946e-03 3 1  ON 61
ci_063                -2.807361e-03 3 1  ON 62
ci_064                -2.259289e-03 3 1  ON 63
ci_065                -3.382663e-03 3 1  ON 64
ci_066                 4.059857e-03 3 1  ON 65
ci_067                 4.226569e-03 3 1  ON 66
ci_068                -4.274477e-03 3 1  ON 67
ci_069                -4.111810e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2684
    reference variance = 0.357117
====================================================
  Execution time = 1.3513e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0172e-01
  Total weights = 1.9576e+06
  Execution time = 1.8313e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287117670626
                                         uncertainty =       0.002376193834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287117670626
                                         uncertainty =       0.002376193834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378877857
  error estimate for blocks of size 2^( 2) =       0.000390203809
  error estimate for blocks of size 2^( 3) =       0.000400226414
  error estimate for blocks of size 2^( 4) =       0.000407717522
  error estimate for blocks of size 2^( 5) =       0.000411861317
  error estimate for blocks of size 2^( 6) =       0.000414556447
  error estimate for blocks of size 2^( 7) =       0.000416368271

      target function =      -0.909979444495
              le_mean =     -17.214902681688
             les_mean =     296.654596512830
             stat err =       0.000412625890
             autocorr =       1.186081409181
   target nu stat err =       0.000412625890
   target dn stat err =       0.003172960824
      target stat err =       0.004948073150
              std dev =       0.535814203889
             le_variance =       0.287096861089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287117486297
                                         uncertainty =       0.002376200269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287117486297
                                         uncertainty =       0.002376200269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378877737
  error estimate for blocks of size 2^( 2) =       0.000390203740
  error estimate for blocks of size 2^( 3) =       0.000400226407
  error estimate for blocks of size 2^( 4) =       0.000407717550
  error estimate for blocks of size 2^( 5) =       0.000411861360
  error estimate for blocks of size 2^( 6) =       0.000414556477
  error estimate for blocks of size 2^( 7) =       0.000416368274

      target function =      -0.909983761285
              le_mean =     -17.214902684403
             les_mean =     296.654593809815
             stat err =       0.000412625915
             autocorr =       1.186082308808
   target nu stat err =       0.000412625915
   target dn stat err =       0.003172956640
      target stat err =       0.004948113264
              std dev =       0.535814033832
             le_variance =       0.287096678851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287117578220
                                         uncertainty =       0.002376197049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287117578220
                                         uncertainty =       0.002376197049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378877797
  error estimate for blocks of size 2^( 2) =       0.000390203774
  error estimate for blocks of size 2^( 3) =       0.000400226410
  error estimate for blocks of size 2^( 4) =       0.000407717536
  error estimate for blocks of size 2^( 5) =       0.000411861339
  error estimate for blocks of size 2^( 6) =       0.000414556462
  error estimate for blocks of size 2^( 7) =       0.000416368273

      target function =      -0.909981770654
              le_mean =     -17.214902683022
             les_mean =     296.654595051830
             stat err =       0.000412625902
             autocorr =       1.186081859411
   target nu stat err =       0.000412625902
   target dn stat err =       0.003172958194
      target stat err =       0.004948094191
              std dev =       0.535814118637
             le_variance =       0.287096769730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287117659053
                                         uncertainty =       0.002376194235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287117659053
                                         uncertainty =       0.002376194235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378877849
  error estimate for blocks of size 2^( 2) =       0.000390203805
  error estimate for blocks of size 2^( 3) =       0.000400226414
  error estimate for blocks of size 2^( 4) =       0.000407717524
  error estimate for blocks of size 2^( 5) =       0.000411861320
  error estimate for blocks of size 2^( 6) =       0.000414556449
  error estimate for blocks of size 2^( 7) =       0.000416368271

      target function =      -0.909979751304
              le_mean =     -17.214902681852
             les_mean =     296.654596319718
             stat err =       0.000412625891
             autocorr =       1.186081465481
   target nu stat err =       0.000412625891
   target dn stat err =       0.003172960432
      target stat err =       0.004948075856
              std dev =       0.535814193212
             le_variance =       0.287096849647


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909979444495        initial
     8.8818e+01     8.8818e+02             1.5821e-06        -0.909983761285  <--
     3.5527e+02     3.5527e+03             3.9578e-07        -0.909981770654
     1.4211e+03     1.4211e+04             9.8960e-08        -0.909979751304

*****************************************************************************
Applying the update for shift_i =   8.8818e+01     and shift_s =   8.8818e+02
*****************************************************************************

  Execution time = 2.2778e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -3.749601e-02 3 1  ON 0
ci_002                -2.874858e-02 3 1  ON 1
ci_003                -2.361802e-02 3 1  ON 2
ci_004                 2.083397e-02 3 1  ON 3
ci_005                 2.126945e-02 3 1  ON 4
ci_006                -1.839594e-02 3 1  ON 5
ci_007                -1.849120e-02 3 1  ON 6
ci_008                -7.764036e-03 3 1  ON 7
ci_009                -1.387941e-02 3 1  ON 8
ci_010                -8.829351e-03 3 1  ON 9
ci_011                -8.961082e-03 3 1  ON 10
ci_012                -9.099994e-03 3 1  ON 11
ci_013                -1.909068e-02 3 1  ON 12
ci_014                 1.111334e-02 3 1  ON 13
ci_015                 1.092234e-02 3 1  ON 14
ci_016                 1.590836e-02 3 1  ON 15
ci_017                 1.564622e-02 3 1  ON 16
ci_018                 9.101237e-03 3 1  ON 17
ci_019                 9.001338e-03 3 1  ON 18
ci_020                 1.504200e-02 3 1  ON 19
ci_021                 1.520437e-02 3 1  ON 20
ci_022                 8.271107e-03 3 1  ON 21
ci_023                 8.252872e-03 3 1  ON 22
ci_024                 8.337064e-03 3 1  ON 23
ci_025                 8.420239e-03 3 1  ON 24
ci_026                 9.900636e-03 3 1  ON 25
ci_027                 9.702253e-03 3 1  ON 26
ci_028                -1.453294e-02 3 1  ON 27
ci_029                -1.479864e-02 3 1  ON 28
ci_030                -8.757029e-03 3 1  ON 29
ci_031                -8.611095e-03 3 1  ON 30
ci_032                -1.432762e-02 3 1  ON 31
ci_033                 4.549578e-03 3 1  ON 32
ci_034                 4.834583e-03 3 1  ON 33
ci_035                -3.330911e-03 3 1  ON 34
ci_036                -1.121962e-02 3 1  ON 35
ci_037                -1.147574e-02 3 1  ON 36
ci_038                 8.692400e-04 3 1  ON 37
ci_039                 1.139985e-03 3 1  ON 38
ci_040                -1.555962e-03 3 1  ON 39
ci_041                 8.160065e-03 3 1  ON 40
ci_042                 8.161007e-03 3 1  ON 41
ci_043                -2.343181e-03 3 1  ON 42
ci_044                -3.907721e-03 3 1  ON 43
ci_045                -1.989148e-03 3 1  ON 44
ci_046                 4.783492e-03 3 1  ON 45
ci_047                 4.612055e-03 3 1  ON 46
ci_048                -1.237677e-02 3 1  ON 47
ci_049                -1.295192e-02 3 1  ON 48
ci_050                 2.845755e-03 3 1  ON 49
ci_051                 2.985823e-03 3 1  ON 50
ci_052                -2.175407e-03 3 1  ON 51
ci_053                -2.208213e-03 3 1  ON 52
ci_054                -2.208368e-03 3 1  ON 53
ci_055                -2.427003e-03 3 1  ON 54
ci_056                 4.624398e-03 3 1  ON 55
ci_057                 4.640101e-03 3 1  ON 56
ci_058                -2.070116e-03 3 1  ON 57
ci_059                -2.053673e-03 3 1  ON 58
ci_060                 4.760320e-03 3 1  ON 59
ci_061                 5.206969e-03 3 1  ON 60
ci_062                -2.953517e-03 3 1  ON 61
ci_063                -2.807599e-03 3 1  ON 62
ci_064                -2.259189e-03 3 1  ON 63
ci_065                -3.382796e-03 3 1  ON 64
ci_066                 4.060388e-03 3 1  ON 65
ci_067                 4.226506e-03 3 1  ON 66
ci_068                -4.273757e-03 3 1  ON 67
ci_069                -4.110835e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9790e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.1782
    reference variance = 0.138789
====================================================
  Execution time = 1.4390e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5309e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9838e-01
  Total weights = 1.957838234e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4976e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285115572341
                                         uncertainty =       0.001566549245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285115572341
                                         uncertainty =       0.001566549245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377571093
  error estimate for blocks of size 2^( 2) =       0.000388883691
  error estimate for blocks of size 2^( 3) =       0.000399473985
  error estimate for blocks of size 2^( 4) =       0.000407460074
  error estimate for blocks of size 2^( 5) =       0.000412331362
  error estimate for blocks of size 2^( 6) =       0.000414896979
  error estimate for blocks of size 2^( 7) =       0.000414382975

      target function =      -0.915182191609
              le_mean =     -17.215128497769
             les_mean =     296.659024954634
             stat err =       0.000412267847
             autocorr =       1.192233872352
   target nu stat err =       0.000412267847
   target dn stat err =       0.002155209289
      target stat err =       0.003439411975
              std dev =       0.533966161047
             le_variance =       0.285119861144


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721512849777e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+01, overlap shift 2.2204e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915194170829       residual = 6.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915195165013       residual = 6.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915195330203       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915195356506       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915195369088       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915195373434       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915195373915       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915195373956       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915195374036       residual = 9.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+01 is 3.322589e-06

solving harmonic davidson linear method for identity shift 8.8818e+01, overlap shift 8.8818e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915194170829       residual = 6.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915194420036       residual = 6.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915194461415       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915194467995       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915194471145       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915194472232       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915194472352       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915194472363       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915194472382       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+01 is 8.325524e-07

solving harmonic davidson linear method for identity shift 3.5527e+02, overlap shift 3.5527e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915194170829       residual = 6.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915194233172       residual = 6.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915194243522       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915194245167       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915194245955       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915194246227       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915194246257       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915194246260       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915194246265       residual = 9.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+02 is 2.082575e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.307833 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6897e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -3.749571e-02 3 1  ON 0
ci_002                -2.874872e-02 3 1  ON 1
ci_003                -2.361819e-02 3 1  ON 2
ci_004                 2.083342e-02 3 1  ON 3
ci_005                 2.126948e-02 3 1  ON 4
ci_006                -1.839525e-02 3 1  ON 5
ci_007                -1.849072e-02 3 1  ON 6
ci_008                -7.763973e-03 3 1  ON 7
ci_009                -1.387962e-02 3 1  ON 8
ci_010                -8.828914e-03 3 1  ON 9
ci_011                -8.960775e-03 3 1  ON 10
ci_012                -9.099339e-03 3 1  ON 11
ci_013                -1.909094e-02 3 1  ON 12
ci_014                 1.111292e-02 3 1  ON 13
ci_015                 1.092212e-02 3 1  ON 14
ci_016                 1.590765e-02 3 1  ON 15
ci_017                 1.564575e-02 3 1  ON 16
ci_018                 9.101425e-03 3 1  ON 17
ci_019                 9.001890e-03 3 1  ON 18
ci_020                 1.504178e-02 3 1  ON 19
ci_021                 1.520491e-02 3 1  ON 20
ci_022                 8.271420e-03 3 1  ON 21
ci_023                 8.252871e-03 3 1  ON 22
ci_024                 8.337483e-03 3 1  ON 23
ci_025                 8.419970e-03 3 1  ON 24
ci_026                 9.901158e-03 3 1  ON 25
ci_027                 9.702545e-03 3 1  ON 26
ci_028                -1.453283e-02 3 1  ON 27
ci_029                -1.479838e-02 3 1  ON 28
ci_030                -8.756627e-03 3 1  ON 29
ci_031                -8.610570e-03 3 1  ON 30
ci_032                -1.432753e-02 3 1  ON 31
ci_033                 4.549632e-03 3 1  ON 32
ci_034                 4.834928e-03 3 1  ON 33
ci_035                -3.330816e-03 3 1  ON 34
ci_036                -1.121953e-02 3 1  ON 35
ci_037                -1.147639e-02 3 1  ON 36
ci_038                 8.697166e-04 3 1  ON 37
ci_039                 1.139272e-03 3 1  ON 38
ci_040                -1.555827e-03 3 1  ON 39
ci_041                 8.159891e-03 3 1  ON 40
ci_042                 8.161032e-03 3 1  ON 41
ci_043                -2.343256e-03 3 1  ON 42
ci_044                -3.907692e-03 3 1  ON 43
ci_045                -1.989112e-03 3 1  ON 44
ci_046                 4.782659e-03 3 1  ON 45
ci_047                 4.611839e-03 3 1  ON 46
ci_048                -1.237671e-02 3 1  ON 47
ci_049                -1.295120e-02 3 1  ON 48
ci_050                 2.846458e-03 3 1  ON 49
ci_051                 2.986004e-03 3 1  ON 50
ci_052                -2.175599e-03 3 1  ON 51
ci_053                -2.209026e-03 3 1  ON 52
ci_054                -2.208416e-03 3 1  ON 53
ci_055                -2.426922e-03 3 1  ON 54
ci_056                 4.623857e-03 3 1  ON 55
ci_057                 4.640573e-03 3 1  ON 56
ci_058                -2.070254e-03 3 1  ON 57
ci_059                -2.053439e-03 3 1  ON 58
ci_060                 4.760236e-03 3 1  ON 59
ci_061                 5.206684e-03 3 1  ON 60
ci_062                -2.953509e-03 3 1  ON 61
ci_063                -2.807970e-03 3 1  ON 62
ci_064                -2.259513e-03 3 1  ON 63
ci_065                -3.382955e-03 3 1  ON 64
ci_066                 4.060588e-03 3 1  ON 65
ci_067                 4.226713e-03 3 1  ON 66
ci_068                -4.273451e-03 3 1  ON 67
ci_069                -4.111011e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.1589
    reference variance = 0.284246
====================================================
  Execution time = 1.3413e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9868e-01
  Total weights = 1.9579e+06
  Execution time = 1.8365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287131882180
                                         uncertainty =       0.001925746630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287131882180
                                         uncertainty =       0.001925746630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378917053
  error estimate for blocks of size 2^( 2) =       0.000390401260
  error estimate for blocks of size 2^( 3) =       0.000401166042
  error estimate for blocks of size 2^( 4) =       0.000409603269
  error estimate for blocks of size 2^( 5) =       0.000413956062
  error estimate for blocks of size 2^( 6) =       0.000415093311
  error estimate for blocks of size 2^( 7) =       0.000417867812

      target function =      -0.914733491202
              le_mean =     -17.214279256652
             les_mean =     296.630088278143
             stat err =       0.000414130113
             autocorr =       1.194497710363
   target nu stat err =       0.000414130113
   target dn stat err =       0.002442002007
      target stat err =       0.003869740568
              std dev =       0.535869634810
             le_variance =       0.287156265511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287131908778
                                         uncertainty =       0.001925785671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287131908778
                                         uncertainty =       0.001925785671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378917065
  error estimate for blocks of size 2^( 2) =       0.000390401311
  error estimate for blocks of size 2^( 3) =       0.000401166070
  error estimate for blocks of size 2^( 4) =       0.000409603394
  error estimate for blocks of size 2^( 5) =       0.000413956300
  error estimate for blocks of size 2^( 6) =       0.000415093543
  error estimate for blocks of size 2^( 7) =       0.000417867989

      target function =      -0.914730725720
              le_mean =     -17.214279251211
             les_mean =     296.630089864669
             stat err =       0.000414130307
             autocorr =       1.194498745625
   target nu stat err =       0.000414130307
   target dn stat err =       0.002442145830
      target stat err =       0.003869937923
              std dev =       0.535869652455
             le_variance =       0.287156284422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287131894670
                                         uncertainty =       0.001925766184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287131894670
                                         uncertainty =       0.001925766184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378917058
  error estimate for blocks of size 2^( 2) =       0.000390401285
  error estimate for blocks of size 2^( 3) =       0.000401166055
  error estimate for blocks of size 2^( 4) =       0.000409603331
  error estimate for blocks of size 2^( 5) =       0.000413956180
  error estimate for blocks of size 2^( 6) =       0.000415093427
  error estimate for blocks of size 2^( 7) =       0.000417867900

      target function =      -0.914732215204
              le_mean =     -17.214279253824
             les_mean =     296.630088999210
             stat err =       0.000414130210
             autocorr =       1.194498229433
   target nu stat err =       0.000414130210
   target dn stat err =       0.002442073652
      target stat err =       0.003869839724
              std dev =       0.535869642868
             le_variance =       0.287156274147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287131883656
                                         uncertainty =       0.001925749074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287131883656
                                         uncertainty =       0.001925749074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378917053
  error estimate for blocks of size 2^( 2) =       0.000390401263
  error estimate for blocks of size 2^( 3) =       0.000401166044
  error estimate for blocks of size 2^( 4) =       0.000409603277
  error estimate for blocks of size 2^( 5) =       0.000413956076
  error estimate for blocks of size 2^( 6) =       0.000415093325
  error estimate for blocks of size 2^( 7) =       0.000417867823

      target function =      -0.914733343416
              le_mean =     -17.214279256287
             les_mean =     296.630088360385
             stat err =       0.000414130125
             autocorr =       1.194497775312
   target nu stat err =       0.000414130125
   target dn stat err =       0.002442010921
      target stat err =       0.003869752995
              std dev =       0.535869635737
             le_variance =       0.287156266505


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914733491202        initial  <--
     2.2204e+01     2.2204e+02             3.3226e-06        -0.914730725720
     8.8818e+01     8.8818e+02             8.3255e-07        -0.914732215204
     3.5527e+02     3.5527e+03             2.0826e-07        -0.914733343416

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7200
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -3.749601e-02 3 1  ON 0
ci_002                -2.874858e-02 3 1  ON 1
ci_003                -2.361802e-02 3 1  ON 2
ci_004                 2.083397e-02 3 1  ON 3
ci_005                 2.126945e-02 3 1  ON 4
ci_006                -1.839594e-02 3 1  ON 5
ci_007                -1.849120e-02 3 1  ON 6
ci_008                -7.764036e-03 3 1  ON 7
ci_009                -1.387941e-02 3 1  ON 8
ci_010                -8.829351e-03 3 1  ON 9
ci_011                -8.961082e-03 3 1  ON 10
ci_012                -9.099994e-03 3 1  ON 11
ci_013                -1.909068e-02 3 1  ON 12
ci_014                 1.111334e-02 3 1  ON 13
ci_015                 1.092234e-02 3 1  ON 14
ci_016                 1.590836e-02 3 1  ON 15
ci_017                 1.564622e-02 3 1  ON 16
ci_018                 9.101237e-03 3 1  ON 17
ci_019                 9.001338e-03 3 1  ON 18
ci_020                 1.504200e-02 3 1  ON 19
ci_021                 1.520437e-02 3 1  ON 20
ci_022                 8.271107e-03 3 1  ON 21
ci_023                 8.252872e-03 3 1  ON 22
ci_024                 8.337064e-03 3 1  ON 23
ci_025                 8.420239e-03 3 1  ON 24
ci_026                 9.900636e-03 3 1  ON 25
ci_027                 9.702253e-03 3 1  ON 26
ci_028                -1.453294e-02 3 1  ON 27
ci_029                -1.479864e-02 3 1  ON 28
ci_030                -8.757029e-03 3 1  ON 29
ci_031                -8.611095e-03 3 1  ON 30
ci_032                -1.432762e-02 3 1  ON 31
ci_033                 4.549578e-03 3 1  ON 32
ci_034                 4.834583e-03 3 1  ON 33
ci_035                -3.330911e-03 3 1  ON 34
ci_036                -1.121962e-02 3 1  ON 35
ci_037                -1.147574e-02 3 1  ON 36
ci_038                 8.692400e-04 3 1  ON 37
ci_039                 1.139985e-03 3 1  ON 38
ci_040                -1.555962e-03 3 1  ON 39
ci_041                 8.160065e-03 3 1  ON 40
ci_042                 8.161007e-03 3 1  ON 41
ci_043                -2.343181e-03 3 1  ON 42
ci_044                -3.907721e-03 3 1  ON 43
ci_045                -1.989148e-03 3 1  ON 44
ci_046                 4.783492e-03 3 1  ON 45
ci_047                 4.612055e-03 3 1  ON 46
ci_048                -1.237677e-02 3 1  ON 47
ci_049                -1.295192e-02 3 1  ON 48
ci_050                 2.845755e-03 3 1  ON 49
ci_051                 2.985823e-03 3 1  ON 50
ci_052                -2.175407e-03 3 1  ON 51
ci_053                -2.208213e-03 3 1  ON 52
ci_054                -2.208368e-03 3 1  ON 53
ci_055                -2.427003e-03 3 1  ON 54
ci_056                 4.624398e-03 3 1  ON 55
ci_057                 4.640101e-03 3 1  ON 56
ci_058                -2.070116e-03 3 1  ON 57
ci_059                -2.053673e-03 3 1  ON 58
ci_060                 4.760320e-03 3 1  ON 59
ci_061                 5.206969e-03 3 1  ON 60
ci_062                -2.953517e-03 3 1  ON 61
ci_063                -2.807599e-03 3 1  ON 62
ci_064                -2.259189e-03 3 1  ON 63
ci_065                -3.382796e-03 3 1  ON 64
ci_066                 4.060388e-03 3 1  ON 65
ci_067                 4.226506e-03 3 1  ON 66
ci_068                -4.273757e-03 3 1  ON 67
ci_069                -4.110835e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9623e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2443
    reference variance = 0.277209
====================================================
  Execution time = 1.3803e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0379e-01
  Total weights = 1.957948124e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4834e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286743432198
                                         uncertainty =       0.001716437550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286743432198
                                         uncertainty =       0.001716437550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378622833
  error estimate for blocks of size 2^( 2) =       0.000389957880
  error estimate for blocks of size 2^( 3) =       0.000400615174
  error estimate for blocks of size 2^( 4) =       0.000408127747
  error estimate for blocks of size 2^( 5) =       0.000413576082
  error estimate for blocks of size 2^( 6) =       0.000416169777
  error estimate for blocks of size 2^( 7) =       0.000415864177

      target function =      -0.906771227334
              le_mean =     -17.215329927914
             les_mean =     296.671375484790
             stat err =       0.000413434446
             autocorr =       1.192338899324
   target nu stat err =       0.000413434446
   target dn stat err =       0.003534036713
      target stat err =       0.005466609345
              std dev =       0.535453546011
             le_variance =       0.286710499936


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721532992791e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+02, overlap shift 2.2204e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906802977227       residual = 9.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906803145601       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906803170162       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906803181522       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906803183613       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906803184328       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906803184532       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906803184545       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906803184492       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906803184478       residual = 6.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+02 is 6.159664e-07

solving harmonic davidson linear method for identity shift 8.8818e+02, overlap shift 8.8818e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906802977227       residual = 9.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906803019332       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906803025473       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906803028313       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906803028836       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906803029015       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906803029067       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906803029070       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906803029056       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906803029053       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+02 is 1.540283e-07

solving harmonic davidson linear method for identity shift 3.5527e+03, overlap shift 3.5527e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906802977227       residual = 9.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906802987754       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906802989290       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906802990000       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906802990130       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906802990177       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906802990190       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906802990185       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906802990183       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906802990187       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+03 is 3.850936e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.311334 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6296e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -3.749598e-02 3 1  ON 0
ci_002                -2.874856e-02 3 1  ON 1
ci_003                -2.361798e-02 3 1  ON 2
ci_004                 2.083400e-02 3 1  ON 3
ci_005                 2.126940e-02 3 1  ON 4
ci_006                -1.839596e-02 3 1  ON 5
ci_007                -1.849121e-02 3 1  ON 6
ci_008                -7.764073e-03 3 1  ON 7
ci_009                -1.387935e-02 3 1  ON 8
ci_010                -8.829307e-03 3 1  ON 9
ci_011                -8.961071e-03 3 1  ON 10
ci_012                -9.099840e-03 3 1  ON 11
ci_013                -1.909070e-02 3 1  ON 12
ci_014                 1.111334e-02 3 1  ON 13
ci_015                 1.092235e-02 3 1  ON 14
ci_016                 1.590833e-02 3 1  ON 15
ci_017                 1.564621e-02 3 1  ON 16
ci_018                 9.101153e-03 3 1  ON 17
ci_019                 9.001383e-03 3 1  ON 18
ci_020                 1.504192e-02 3 1  ON 19
ci_021                 1.520435e-02 3 1  ON 20
ci_022                 8.271091e-03 3 1  ON 21
ci_023                 8.252842e-03 3 1  ON 22
ci_024                 8.336915e-03 3 1  ON 23
ci_025                 8.420240e-03 3 1  ON 24
ci_026                 9.900621e-03 3 1  ON 25
ci_027                 9.702301e-03 3 1  ON 26
ci_028                -1.453301e-02 3 1  ON 27
ci_029                -1.479871e-02 3 1  ON 28
ci_030                -8.756993e-03 3 1  ON 29
ci_031                -8.611107e-03 3 1  ON 30
ci_032                -1.432763e-02 3 1  ON 31
ci_033                 4.549654e-03 3 1  ON 32
ci_034                 4.834575e-03 3 1  ON 33
ci_035                -3.330937e-03 3 1  ON 34
ci_036                -1.121961e-02 3 1  ON 35
ci_037                -1.147565e-02 3 1  ON 36
ci_038                 8.691824e-04 3 1  ON 37
ci_039                 1.139953e-03 3 1  ON 38
ci_040                -1.555927e-03 3 1  ON 39
ci_041                 8.159982e-03 3 1  ON 40
ci_042                 8.160967e-03 3 1  ON 41
ci_043                -2.343150e-03 3 1  ON 42
ci_044                -3.907796e-03 3 1  ON 43
ci_045                -1.989129e-03 3 1  ON 44
ci_046                 4.783461e-03 3 1  ON 45
ci_047                 4.612084e-03 3 1  ON 46
ci_048                -1.237686e-02 3 1  ON 47
ci_049                -1.295198e-02 3 1  ON 48
ci_050                 2.845784e-03 3 1  ON 49
ci_051                 2.985845e-03 3 1  ON 50
ci_052                -2.175428e-03 3 1  ON 51
ci_053                -2.208259e-03 3 1  ON 52
ci_054                -2.208295e-03 3 1  ON 53
ci_055                -2.426966e-03 3 1  ON 54
ci_056                 4.624374e-03 3 1  ON 55
ci_057                 4.640062e-03 3 1  ON 56
ci_058                -2.070211e-03 3 1  ON 57
ci_059                -2.053745e-03 3 1  ON 58
ci_060                 4.760403e-03 3 1  ON 59
ci_061                 5.206953e-03 3 1  ON 60
ci_062                -2.953556e-03 3 1  ON 61
ci_063                -2.807574e-03 3 1  ON 62
ci_064                -2.259208e-03 3 1  ON 63
ci_065                -3.382809e-03 3 1  ON 64
ci_066                 4.060391e-03 3 1  ON 65
ci_067                 4.226489e-03 3 1  ON 66
ci_068                -4.273886e-03 3 1  ON 67
ci_069                -4.110779e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.1876
    reference variance = 0.2292
====================================================
  Execution time = 1.3477e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0199e-01
  Total weights = 1.9577e+06
  Execution time = 1.8337e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286470697980
                                         uncertainty =       0.001664789313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286470697980
                                         uncertainty =       0.001664789313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378469312
  error estimate for blocks of size 2^( 2) =       0.000389328964
  error estimate for blocks of size 2^( 3) =       0.000399658878
  error estimate for blocks of size 2^( 4) =       0.000408234284
  error estimate for blocks of size 2^( 5) =       0.000413361456
  error estimate for blocks of size 2^( 6) =       0.000415887357
  error estimate for blocks of size 2^( 7) =       0.000417233256

      target function =      -0.909574148431
              le_mean =     -17.214364485685
             les_mean =     296.636335412799
             stat err =       0.000413679088
             autocorr =       1.194719063649
   target nu stat err =       0.000413679088
   target dn stat err =       0.003862552628
      target stat err =       0.005992790436
              std dev =       0.535236433669
             le_variance =       0.286478039926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286470622151
                                         uncertainty =       0.001664785789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286470622151
                                         uncertainty =       0.001664785789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378469262
  error estimate for blocks of size 2^( 2) =       0.000389328909
  error estimate for blocks of size 2^( 3) =       0.000399658828
  error estimate for blocks of size 2^( 4) =       0.000408234239
  error estimate for blocks of size 2^( 5) =       0.000413361416
  error estimate for blocks of size 2^( 6) =       0.000415887340
  error estimate for blocks of size 2^( 7) =       0.000417233248

      target function =      -0.909575103922
              le_mean =     -17.214364494840
             les_mean =     296.636335108350
             stat err =       0.000413679061
             autocorr =       1.194719219382
   target nu stat err =       0.000413679061
   target dn stat err =       0.003862495828
      target stat err =       0.005992716109
              std dev =       0.535236363697
             le_variance =       0.286477965024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286470660043
                                         uncertainty =       0.001664787550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286470660043
                                         uncertainty =       0.001664787550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378469287
  error estimate for blocks of size 2^( 2) =       0.000389328936
  error estimate for blocks of size 2^( 3) =       0.000399658853
  error estimate for blocks of size 2^( 4) =       0.000408234262
  error estimate for blocks of size 2^( 5) =       0.000413361436
  error estimate for blocks of size 2^( 6) =       0.000415887348
  error estimate for blocks of size 2^( 7) =       0.000417233252

      target function =      -0.909574627940
              le_mean =     -17.214364490262
             les_mean =     296.636335259405
             stat err =       0.000413679074
             autocorr =       1.194719141534
   target nu stat err =       0.000413679074
   target dn stat err =       0.003862524206
      target stat err =       0.005992753262
              std dev =       0.535236398662
             le_variance =       0.286478002452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286470693236
                                         uncertainty =       0.001664789092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286470693236
                                         uncertainty =       0.001664789092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378469309
  error estimate for blocks of size 2^( 2) =       0.000389328961
  error estimate for blocks of size 2^( 3) =       0.000399658874
  error estimate for blocks of size 2^( 4) =       0.000408234281
  error estimate for blocks of size 2^( 5) =       0.000413361453
  error estimate for blocks of size 2^( 6) =       0.000415887356
  error estimate for blocks of size 2^( 7) =       0.000417233255

      target function =      -0.909574208555
              le_mean =     -17.214364486257
             les_mean =     296.636335393498
             stat err =       0.000413679086
             autocorr =       1.194719073390
   target nu stat err =       0.000413679086
   target dn stat err =       0.003862549074
      target stat err =       0.005992785789
              std dev =       0.535236429291
             le_variance =       0.286478035240


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909574148431        initial
     2.2204e+02     2.2204e+03             6.1597e-07        -0.909575103922  <--
     8.8818e+02     8.8818e+03             1.5403e-07        -0.909574627940
     3.5527e+03     3.5527e+04             3.8509e-08        -0.909574208555

*****************************************************************************
Applying the update for shift_i =   2.2204e+02     and shift_s =   2.2204e+03
*****************************************************************************

  Execution time = 2.2754e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -3.749588e-02 3 1  ON 0
ci_002                -2.874850e-02 3 1  ON 1
ci_003                -2.361786e-02 3 1  ON 2
ci_004                 2.083408e-02 3 1  ON 3
ci_005                 2.126924e-02 3 1  ON 4
ci_006                -1.839604e-02 3 1  ON 5
ci_007                -1.849124e-02 3 1  ON 6
ci_008                -7.764185e-03 3 1  ON 7
ci_009                -1.387916e-02 3 1  ON 8
ci_010                -8.829175e-03 3 1  ON 9
ci_011                -8.961035e-03 3 1  ON 10
ci_012                -9.099378e-03 3 1  ON 11
ci_013                -1.909079e-02 3 1  ON 12
ci_014                 1.111334e-02 3 1  ON 13
ci_015                 1.092238e-02 3 1  ON 14
ci_016                 1.590827e-02 3 1  ON 15
ci_017                 1.564620e-02 3 1  ON 16
ci_018                 9.100901e-03 3 1  ON 17
ci_019                 9.001519e-03 3 1  ON 18
ci_020                 1.504168e-02 3 1  ON 19
ci_021                 1.520431e-02 3 1  ON 20
ci_022                 8.271045e-03 3 1  ON 21
ci_023                 8.252752e-03 3 1  ON 22
ci_024                 8.336470e-03 3 1  ON 23
ci_025                 8.420243e-03 3 1  ON 24
ci_026                 9.900578e-03 3 1  ON 25
ci_027                 9.702448e-03 3 1  ON 26
ci_028                -1.453322e-02 3 1  ON 27
ci_029                -1.479890e-02 3 1  ON 28
ci_030                -8.756887e-03 3 1  ON 29
ci_031                -8.611142e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.549882e-03 3 1  ON 32
ci_034                 4.834550e-03 3 1  ON 33
ci_035                -3.331017e-03 3 1  ON 34
ci_036                -1.121961e-02 3 1  ON 35
ci_037                -1.147538e-02 3 1  ON 36
ci_038                 8.690097e-04 3 1  ON 37
ci_039                 1.139858e-03 3 1  ON 38
ci_040                -1.555821e-03 3 1  ON 39
ci_041                 8.159733e-03 3 1  ON 40
ci_042                 8.160847e-03 3 1  ON 41
ci_043                -2.343058e-03 3 1  ON 42
ci_044                -3.908021e-03 3 1  ON 43
ci_045                -1.989073e-03 3 1  ON 44
ci_046                 4.783367e-03 3 1  ON 45
ci_047                 4.612173e-03 3 1  ON 46
ci_048                -1.237711e-02 3 1  ON 47
ci_049                -1.295213e-02 3 1  ON 48
ci_050                 2.845870e-03 3 1  ON 49
ci_051                 2.985911e-03 3 1  ON 50
ci_052                -2.175489e-03 3 1  ON 51
ci_053                -2.208399e-03 3 1  ON 52
ci_054                -2.208074e-03 3 1  ON 53
ci_055                -2.426854e-03 3 1  ON 54
ci_056                 4.624301e-03 3 1  ON 55
ci_057                 4.639944e-03 3 1  ON 56
ci_058                -2.070497e-03 3 1  ON 57
ci_059                -2.053962e-03 3 1  ON 58
ci_060                 4.760652e-03 3 1  ON 59
ci_061                 5.206904e-03 3 1  ON 60
ci_062                -2.953671e-03 3 1  ON 61
ci_063                -2.807500e-03 3 1  ON 62
ci_064                -2.259265e-03 3 1  ON 63
ci_065                -3.382845e-03 3 1  ON 64
ci_066                 4.060400e-03 3 1  ON 65
ci_067                 4.226439e-03 3 1  ON 66
ci_068                -4.274274e-03 3 1  ON 67
ci_069                -4.110612e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9057e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.1659
    reference variance = 0.208731
====================================================
  Execution time = 1.3825e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0186e-01
  Total weights = 1.958034618e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4941e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287949235619
                                         uncertainty =       0.001930953479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287949235619
                                         uncertainty =       0.001930953479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379427618
  error estimate for blocks of size 2^( 2) =       0.000391010849
  error estimate for blocks of size 2^( 3) =       0.000401097588
  error estimate for blocks of size 2^( 4) =       0.000409391688
  error estimate for blocks of size 2^( 5) =       0.000414357010
  error estimate for blocks of size 2^( 6) =       0.000416570487
  error estimate for blocks of size 2^( 7) =       0.000417705257

      target function =      -0.909782801397
              le_mean =     -17.214627373947
             les_mean =     296.645256834660
             stat err =       0.000414506111
             autocorr =       1.193449359848
   target nu stat err =       0.000414506111
   target dn stat err =       0.002742959470
      target stat err =       0.004288413965
              std dev =       0.536591683319
             le_variance =       0.287930634607


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721462737395e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+01, overlap shift 5.5511e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909801995509       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909802624083       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909802692815       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909802713206       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909802718394       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909802719344       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909802719947       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909802719615       residual = 8.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909802719742       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909802719733       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+01 is 2.347541e-06

solving harmonic davidson linear method for identity shift 2.2204e+02, overlap shift 2.2204e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909801995509       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909802152819       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909802170016       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909802175116       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909802176413       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909802176651       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909802176801       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909802176719       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909802176750       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909802176748       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+02 is 5.874352e-07

solving harmonic davidson linear method for identity shift 8.8818e+02, overlap shift 8.8818e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909801995509       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909802034847       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909802039147       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909802040422       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909802040747       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909802040806       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909802040844       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909802040823       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909802040831       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909802040830       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+02 is 1.468932e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.314809 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6330e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -3.749553e-02 3 1  ON 0
ci_002                -2.874839e-02 3 1  ON 1
ci_003                -2.361802e-02 3 1  ON 2
ci_004                 2.083433e-02 3 1  ON 3
ci_005                 2.126921e-02 3 1  ON 4
ci_006                -1.839598e-02 3 1  ON 5
ci_007                -1.849117e-02 3 1  ON 6
ci_008                -7.763935e-03 3 1  ON 7
ci_009                -1.387906e-02 3 1  ON 8
ci_010                -8.829324e-03 3 1  ON 9
ci_011                -8.961288e-03 3 1  ON 10
ci_012                -9.099144e-03 3 1  ON 11
ci_013                -1.909081e-02 3 1  ON 12
ci_014                 1.111331e-02 3 1  ON 13
ci_015                 1.092195e-02 3 1  ON 14
ci_016                 1.590831e-02 3 1  ON 15
ci_017                 1.564609e-02 3 1  ON 16
ci_018                 9.101103e-03 3 1  ON 17
ci_019                 9.001544e-03 3 1  ON 18
ci_020                 1.504171e-02 3 1  ON 19
ci_021                 1.520416e-02 3 1  ON 20
ci_022                 8.270891e-03 3 1  ON 21
ci_023                 8.252600e-03 3 1  ON 22
ci_024                 8.336286e-03 3 1  ON 23
ci_025                 8.420176e-03 3 1  ON 24
ci_026                 9.900408e-03 3 1  ON 25
ci_027                 9.702365e-03 3 1  ON 26
ci_028                -1.453330e-02 3 1  ON 27
ci_029                -1.479845e-02 3 1  ON 28
ci_030                -8.756587e-03 3 1  ON 29
ci_031                -8.611322e-03 3 1  ON 30
ci_032                -1.432777e-02 3 1  ON 31
ci_033                 4.550277e-03 3 1  ON 32
ci_034                 4.834510e-03 3 1  ON 33
ci_035                -3.331009e-03 3 1  ON 34
ci_036                -1.121944e-02 3 1  ON 35
ci_037                -1.147524e-02 3 1  ON 36
ci_038                 8.689822e-04 3 1  ON 37
ci_039                 1.139644e-03 3 1  ON 38
ci_040                -1.555753e-03 3 1  ON 39
ci_041                 8.159475e-03 3 1  ON 40
ci_042                 8.161186e-03 3 1  ON 41
ci_043                -2.343245e-03 3 1  ON 42
ci_044                -3.907984e-03 3 1  ON 43
ci_045                -1.989104e-03 3 1  ON 44
ci_046                 4.783286e-03 3 1  ON 45
ci_047                 4.612175e-03 3 1  ON 46
ci_048                -1.237703e-02 3 1  ON 47
ci_049                -1.295239e-02 3 1  ON 48
ci_050                 2.845724e-03 3 1  ON 49
ci_051                 2.985825e-03 3 1  ON 50
ci_052                -2.175105e-03 3 1  ON 51
ci_053                -2.208313e-03 3 1  ON 52
ci_054                -2.207800e-03 3 1  ON 53
ci_055                -2.427219e-03 3 1  ON 54
ci_056                 4.624250e-03 3 1  ON 55
ci_057                 4.639916e-03 3 1  ON 56
ci_058                -2.070408e-03 3 1  ON 57
ci_059                -2.053999e-03 3 1  ON 58
ci_060                 4.760065e-03 3 1  ON 59
ci_061                 5.206897e-03 3 1  ON 60
ci_062                -2.953673e-03 3 1  ON 61
ci_063                -2.807415e-03 3 1  ON 62
ci_064                -2.259465e-03 3 1  ON 63
ci_065                -3.382778e-03 3 1  ON 64
ci_066                 4.060511e-03 3 1  ON 65
ci_067                 4.226272e-03 3 1  ON 66
ci_068                -4.274389e-03 3 1  ON 67
ci_069                -4.110638e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2714
    reference variance = 0.302878
====================================================
  Execution time = 1.3723e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0277e-01
  Total weights = 1.9577e+06
  Execution time = 1.8084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288177972282
                                         uncertainty =       0.001253951175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288177972282
                                         uncertainty =       0.001253951175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379574941
  error estimate for blocks of size 2^( 2) =       0.000390934697
  error estimate for blocks of size 2^( 3) =       0.000401368204
  error estimate for blocks of size 2^( 4) =       0.000408964078
  error estimate for blocks of size 2^( 5) =       0.000413843608
  error estimate for blocks of size 2^( 6) =       0.000417565268
  error estimate for blocks of size 2^( 7) =       0.000419315636

      target function =      -0.908392550454
              le_mean =     -17.214621912937
             les_mean =     296.645974009346
             stat err =       0.000414922148
             autocorr =       1.194918175927
   target nu stat err =       0.000414922148
   target dn stat err =       0.002475903976
      target stat err =       0.003871099541
              std dev =       0.536800030047
             le_variance =       0.288154272258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288177729516
                                         uncertainty =       0.001253974676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288177729516
                                         uncertainty =       0.001253974676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379574780
  error estimate for blocks of size 2^( 2) =       0.000390934625
  error estimate for blocks of size 2^( 3) =       0.000401368263
  error estimate for blocks of size 2^( 4) =       0.000408964159
  error estimate for blocks of size 2^( 5) =       0.000413843676
  error estimate for blocks of size 2^( 6) =       0.000417565363
  error estimate for blocks of size 2^( 7) =       0.000419315763

      target function =      -0.908379136195
              le_mean =     -17.214621891075
             les_mean =     296.645981984127
             stat err =       0.000414922240
             autocorr =       1.194919723088
   target nu stat err =       0.000414922240
   target dn stat err =       0.002475659179
      target stat err =       0.003870616816
              std dev =       0.536799802119
             le_variance =       0.288154027555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288177850558
                                         uncertainty =       0.001253962931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288177850558
                                         uncertainty =       0.001253962931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379574861
  error estimate for blocks of size 2^( 2) =       0.000390934661
  error estimate for blocks of size 2^( 3) =       0.000401368233
  error estimate for blocks of size 2^( 4) =       0.000408964119
  error estimate for blocks of size 2^( 5) =       0.000413843642
  error estimate for blocks of size 2^( 6) =       0.000417565316
  error estimate for blocks of size 2^( 7) =       0.000419315699

      target function =      -0.908387850330
              le_mean =     -17.214621901978
             les_mean =     296.645976690473
             stat err =       0.000414922194
             autocorr =       1.194918950243
   target nu stat err =       0.000414922194
   target dn stat err =       0.002475767799
      target stat err =       0.003870854165
              std dev =       0.536799915765
             le_variance =       0.288154149565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288177957038
                                         uncertainty =       0.001253952644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288177957038
                                         uncertainty =       0.001253952644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379574931
  error estimate for blocks of size 2^( 2) =       0.000390934692
  error estimate for blocks of size 2^( 3) =       0.000401368207
  error estimate for blocks of size 2^( 4) =       0.000408964083
  error estimate for blocks of size 2^( 5) =       0.000413843613
  error estimate for blocks of size 2^( 6) =       0.000417565274
  error estimate for blocks of size 2^( 7) =       0.000419315644

      target function =      -0.908392105667
              le_mean =     -17.214621911564
             les_mean =     296.645974251573
             stat err =       0.000414922154
             autocorr =       1.194918272756
   target nu stat err =       0.000414922154
   target dn stat err =       0.002475886177
      target stat err =       0.003871068890
              std dev =       0.536800015736
             le_variance =       0.288154256894


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908392550454        initial  <--
     5.5511e+01     5.5511e+02             2.3475e-06        -0.908379136195
     2.2204e+02     2.2204e+03             5.8744e-07        -0.908387850330
     8.8818e+02     8.8818e+03             1.4689e-07        -0.908392105667

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8357
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -3.749588e-02 3 1  ON 0
ci_002                -2.874850e-02 3 1  ON 1
ci_003                -2.361786e-02 3 1  ON 2
ci_004                 2.083408e-02 3 1  ON 3
ci_005                 2.126924e-02 3 1  ON 4
ci_006                -1.839604e-02 3 1  ON 5
ci_007                -1.849124e-02 3 1  ON 6
ci_008                -7.764185e-03 3 1  ON 7
ci_009                -1.387916e-02 3 1  ON 8
ci_010                -8.829175e-03 3 1  ON 9
ci_011                -8.961035e-03 3 1  ON 10
ci_012                -9.099378e-03 3 1  ON 11
ci_013                -1.909079e-02 3 1  ON 12
ci_014                 1.111334e-02 3 1  ON 13
ci_015                 1.092238e-02 3 1  ON 14
ci_016                 1.590827e-02 3 1  ON 15
ci_017                 1.564620e-02 3 1  ON 16
ci_018                 9.100901e-03 3 1  ON 17
ci_019                 9.001519e-03 3 1  ON 18
ci_020                 1.504168e-02 3 1  ON 19
ci_021                 1.520431e-02 3 1  ON 20
ci_022                 8.271045e-03 3 1  ON 21
ci_023                 8.252752e-03 3 1  ON 22
ci_024                 8.336470e-03 3 1  ON 23
ci_025                 8.420243e-03 3 1  ON 24
ci_026                 9.900578e-03 3 1  ON 25
ci_027                 9.702448e-03 3 1  ON 26
ci_028                -1.453322e-02 3 1  ON 27
ci_029                -1.479890e-02 3 1  ON 28
ci_030                -8.756887e-03 3 1  ON 29
ci_031                -8.611142e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.549882e-03 3 1  ON 32
ci_034                 4.834550e-03 3 1  ON 33
ci_035                -3.331017e-03 3 1  ON 34
ci_036                -1.121961e-02 3 1  ON 35
ci_037                -1.147538e-02 3 1  ON 36
ci_038                 8.690097e-04 3 1  ON 37
ci_039                 1.139858e-03 3 1  ON 38
ci_040                -1.555821e-03 3 1  ON 39
ci_041                 8.159733e-03 3 1  ON 40
ci_042                 8.160847e-03 3 1  ON 41
ci_043                -2.343058e-03 3 1  ON 42
ci_044                -3.908021e-03 3 1  ON 43
ci_045                -1.989073e-03 3 1  ON 44
ci_046                 4.783367e-03 3 1  ON 45
ci_047                 4.612173e-03 3 1  ON 46
ci_048                -1.237711e-02 3 1  ON 47
ci_049                -1.295213e-02 3 1  ON 48
ci_050                 2.845870e-03 3 1  ON 49
ci_051                 2.985911e-03 3 1  ON 50
ci_052                -2.175489e-03 3 1  ON 51
ci_053                -2.208399e-03 3 1  ON 52
ci_054                -2.208074e-03 3 1  ON 53
ci_055                -2.426854e-03 3 1  ON 54
ci_056                 4.624301e-03 3 1  ON 55
ci_057                 4.639944e-03 3 1  ON 56
ci_058                -2.070497e-03 3 1  ON 57
ci_059                -2.053962e-03 3 1  ON 58
ci_060                 4.760652e-03 3 1  ON 59
ci_061                 5.206904e-03 3 1  ON 60
ci_062                -2.953671e-03 3 1  ON 61
ci_063                -2.807500e-03 3 1  ON 62
ci_064                -2.259265e-03 3 1  ON 63
ci_065                -3.382845e-03 3 1  ON 64
ci_066                 4.060400e-03 3 1  ON 65
ci_067                 4.226439e-03 3 1  ON 66
ci_068                -4.274274e-03 3 1  ON 67
ci_069                -4.110612e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9172e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2708
    reference variance = 0.51366
====================================================
  Execution time = 1.3783e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5308e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0212e-01
  Total weights = 1.958109422e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4957e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287544671843
                                         uncertainty =       0.001743965252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287544671843
                                         uncertainty =       0.001743965252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379203535
  error estimate for blocks of size 2^( 2) =       0.000390718229
  error estimate for blocks of size 2^( 3) =       0.000401050963
  error estimate for blocks of size 2^( 4) =       0.000409055912
  error estimate for blocks of size 2^( 5) =       0.000414034379
  error estimate for blocks of size 2^( 6) =       0.000417369540
  error estimate for blocks of size 2^( 7) =       0.000420076125

      target function =      -0.909386962591
              le_mean =     -17.214429365602
             les_mean =     296.638701784099
             stat err =       0.000415133989
             autocorr =       1.198482867256
   target nu stat err =       0.000415133989
   target dn stat err =       0.002724198079
      target stat err =       0.004254820456
              std dev =       0.536274782369
             le_variance =       0.287590642205


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721442936560e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+02, overlap shift 5.5511e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909405742418       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909405802699       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909405815715       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909405820560       residual = 6.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909405821106       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909405821244       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909405821338       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909405821273       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909405821274       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909405821271       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+02 is 2.097125e-07

solving harmonic davidson linear method for identity shift 2.2204e+03, overlap shift 2.2204e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909405742418       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909405757490       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909405760744       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909405761955       residual = 6.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909405762093       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909405762126       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909405762150       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909405762134       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909405762137       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909405762133       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+03 is 5.243204e-08

solving harmonic davidson linear method for identity shift 8.8818e+03, overlap shift 8.8818e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909405742418       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909405746186       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909405746999       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909405747305       residual = 6.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909405747336       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909405747349       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909405747338       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909405747352       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909405747347       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909405747341       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+03 is 1.310825e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.318269 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6289e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_001                -3.749587e-02 3 1  ON 0
ci_002                -2.874850e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083406e-02 3 1  ON 3
ci_005                 2.126925e-02 3 1  ON 4
ci_006                -1.839603e-02 3 1  ON 5
ci_007                -1.849120e-02 3 1  ON 6
ci_008                -7.764155e-03 3 1  ON 7
ci_009                -1.387913e-02 3 1  ON 8
ci_010                -8.829183e-03 3 1  ON 9
ci_011                -8.961044e-03 3 1  ON 10
ci_012                -9.099347e-03 3 1  ON 11
ci_013                -1.909080e-02 3 1  ON 12
ci_014                 1.111335e-02 3 1  ON 13
ci_015                 1.092238e-02 3 1  ON 14
ci_016                 1.590827e-02 3 1  ON 15
ci_017                 1.564623e-02 3 1  ON 16
ci_018                 9.100874e-03 3 1  ON 17
ci_019                 9.001536e-03 3 1  ON 18
ci_020                 1.504164e-02 3 1  ON 19
ci_021                 1.520434e-02 3 1  ON 20
ci_022                 8.271057e-03 3 1  ON 21
ci_023                 8.252774e-03 3 1  ON 22
ci_024                 8.336437e-03 3 1  ON 23
ci_025                 8.420208e-03 3 1  ON 24
ci_026                 9.900570e-03 3 1  ON 25
ci_027                 9.702454e-03 3 1  ON 26
ci_028                -1.453319e-02 3 1  ON 27
ci_029                -1.479892e-02 3 1  ON 28
ci_030                -8.756902e-03 3 1  ON 29
ci_031                -8.611108e-03 3 1  ON 30
ci_032                -1.432768e-02 3 1  ON 31
ci_033                 4.549878e-03 3 1  ON 32
ci_034                 4.834533e-03 3 1  ON 33
ci_035                -3.331017e-03 3 1  ON 34
ci_036                -1.121959e-02 3 1  ON 35
ci_037                -1.147533e-02 3 1  ON 36
ci_038                 8.690040e-04 3 1  ON 37
ci_039                 1.139848e-03 3 1  ON 38
ci_040                -1.555822e-03 3 1  ON 39
ci_041                 8.159745e-03 3 1  ON 40
ci_042                 8.160869e-03 3 1  ON 41
ci_043                -2.343045e-03 3 1  ON 42
ci_044                -3.908066e-03 3 1  ON 43
ci_045                -1.989070e-03 3 1  ON 44
ci_046                 4.783356e-03 3 1  ON 45
ci_047                 4.612164e-03 3 1  ON 46
ci_048                -1.237716e-02 3 1  ON 47
ci_049                -1.295212e-02 3 1  ON 48
ci_050                 2.845839e-03 3 1  ON 49
ci_051                 2.985870e-03 3 1  ON 50
ci_052                -2.175484e-03 3 1  ON 51
ci_053                -2.208409e-03 3 1  ON 52
ci_054                -2.208065e-03 3 1  ON 53
ci_055                -2.426850e-03 3 1  ON 54
ci_056                 4.624296e-03 3 1  ON 55
ci_057                 4.639950e-03 3 1  ON 56
ci_058                -2.070513e-03 3 1  ON 57
ci_059                -2.053973e-03 3 1  ON 58
ci_060                 4.760654e-03 3 1  ON 59
ci_061                 5.206872e-03 3 1  ON 60
ci_062                -2.953642e-03 3 1  ON 61
ci_063                -2.807482e-03 3 1  ON 62
ci_064                -2.259265e-03 3 1  ON 63
ci_065                -3.382839e-03 3 1  ON 64
ci_066                 4.060396e-03 3 1  ON 65
ci_067                 4.226416e-03 3 1  ON 66
ci_068                -4.274296e-03 3 1  ON 67
ci_069                -4.110651e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2221
    reference variance = 0.684147
====================================================
  Execution time = 1.5883e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0007e-01
  Total weights = 1.9576e+06
  Execution time = 1.8169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286869192355
                                         uncertainty =       0.001864127890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286869192355
                                         uncertainty =       0.001864127890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378790824
  error estimate for blocks of size 2^( 2) =       0.000390184203
  error estimate for blocks of size 2^( 3) =       0.000400380190
  error estimate for blocks of size 2^( 4) =       0.000408937886
  error estimate for blocks of size 2^( 5) =       0.000413189014
  error estimate for blocks of size 2^( 6) =       0.000414648205
  error estimate for blocks of size 2^( 7) =       0.000413864273

      target function =      -0.912546113075
              le_mean =     -17.215158929739
             les_mean =     296.661762029336
             stat err =       0.000412659845
             autocorr =       1.186821817428
   target nu stat err =       0.000412659845
   target dn stat err =       0.002468652978
      target stat err =       0.003898136778
              std dev =       0.535691120188
             le_variance =       0.286964976248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286869181259
                                         uncertainty =       0.001864126141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286869181259
                                         uncertainty =       0.001864126141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378790817
  error estimate for blocks of size 2^( 2) =       0.000390184205
  error estimate for blocks of size 2^( 3) =       0.000400380204
  error estimate for blocks of size 2^( 4) =       0.000408937910
  error estimate for blocks of size 2^( 5) =       0.000413189040
  error estimate for blocks of size 2^( 6) =       0.000414648234
  error estimate for blocks of size 2^( 7) =       0.000413864306

      target function =      -0.912546065053
              le_mean =     -17.215158933216
             les_mean =     296.661762179807
             stat err =       0.000412659872
             autocorr =       1.186822020237
   target nu stat err =       0.000412659872
   target dn stat err =       0.002468662532
      target stat err =       0.003898151006
              std dev =       0.535691110617
             le_variance =       0.286964965995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286869186804
                                         uncertainty =       0.001864127015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286869186804
                                         uncertainty =       0.001864127015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378790820
  error estimate for blocks of size 2^( 2) =       0.000390184204
  error estimate for blocks of size 2^( 3) =       0.000400380197
  error estimate for blocks of size 2^( 4) =       0.000408937898
  error estimate for blocks of size 2^( 5) =       0.000413189027
  error estimate for blocks of size 2^( 6) =       0.000414648219
  error estimate for blocks of size 2^( 7) =       0.000413864290

      target function =      -0.912546089292
              le_mean =     -17.215158931477
             les_mean =     296.661762104421
             stat err =       0.000412659859
             autocorr =       1.186821918846
   target nu stat err =       0.000412659859
   target dn stat err =       0.002468657753
      target stat err =       0.003898143891
              std dev =       0.535691115400
             le_variance =       0.286964971118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286869191661
                                         uncertainty =       0.001864127781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286869191661
                                         uncertainty =       0.001864127781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378790823
  error estimate for blocks of size 2^( 2) =       0.000390184203
  error estimate for blocks of size 2^( 3) =       0.000400380191
  error estimate for blocks of size 2^( 4) =       0.000408937888
  error estimate for blocks of size 2^( 5) =       0.000413189016
  error estimate for blocks of size 2^( 6) =       0.000414648206
  error estimate for blocks of size 2^( 7) =       0.000413864275

      target function =      -0.912546110127
              le_mean =     -17.215158929956
             les_mean =     296.661762038705
             stat err =       0.000412659846
             autocorr =       1.186821830107
   target nu stat err =       0.000412659846
   target dn stat err =       0.002468653574
      target stat err =       0.003898137667
              std dev =       0.535691119589
             le_variance =       0.286964975607


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912546113075        initial  <--
     5.5511e+02     5.5511e+03             2.0971e-07        -0.912546065053
     2.2204e+03     2.2204e+04             5.2432e-08        -0.912546089292
     8.8818e+03     8.8818e+04             1.3108e-08        -0.912546110127

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.0727
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_001                -3.749588e-02 3 1  ON 0
ci_002                -2.874850e-02 3 1  ON 1
ci_003                -2.361786e-02 3 1  ON 2
ci_004                 2.083408e-02 3 1  ON 3
ci_005                 2.126924e-02 3 1  ON 4
ci_006                -1.839604e-02 3 1  ON 5
ci_007                -1.849124e-02 3 1  ON 6
ci_008                -7.764185e-03 3 1  ON 7
ci_009                -1.387916e-02 3 1  ON 8
ci_010                -8.829175e-03 3 1  ON 9
ci_011                -8.961035e-03 3 1  ON 10
ci_012                -9.099378e-03 3 1  ON 11
ci_013                -1.909079e-02 3 1  ON 12
ci_014                 1.111334e-02 3 1  ON 13
ci_015                 1.092238e-02 3 1  ON 14
ci_016                 1.590827e-02 3 1  ON 15
ci_017                 1.564620e-02 3 1  ON 16
ci_018                 9.100901e-03 3 1  ON 17
ci_019                 9.001519e-03 3 1  ON 18
ci_020                 1.504168e-02 3 1  ON 19
ci_021                 1.520431e-02 3 1  ON 20
ci_022                 8.271045e-03 3 1  ON 21
ci_023                 8.252752e-03 3 1  ON 22
ci_024                 8.336470e-03 3 1  ON 23
ci_025                 8.420243e-03 3 1  ON 24
ci_026                 9.900578e-03 3 1  ON 25
ci_027                 9.702448e-03 3 1  ON 26
ci_028                -1.453322e-02 3 1  ON 27
ci_029                -1.479890e-02 3 1  ON 28
ci_030                -8.756887e-03 3 1  ON 29
ci_031                -8.611142e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.549882e-03 3 1  ON 32
ci_034                 4.834550e-03 3 1  ON 33
ci_035                -3.331017e-03 3 1  ON 34
ci_036                -1.121961e-02 3 1  ON 35
ci_037                -1.147538e-02 3 1  ON 36
ci_038                 8.690097e-04 3 1  ON 37
ci_039                 1.139858e-03 3 1  ON 38
ci_040                -1.555821e-03 3 1  ON 39
ci_041                 8.159733e-03 3 1  ON 40
ci_042                 8.160847e-03 3 1  ON 41
ci_043                -2.343058e-03 3 1  ON 42
ci_044                -3.908021e-03 3 1  ON 43
ci_045                -1.989073e-03 3 1  ON 44
ci_046                 4.783367e-03 3 1  ON 45
ci_047                 4.612173e-03 3 1  ON 46
ci_048                -1.237711e-02 3 1  ON 47
ci_049                -1.295213e-02 3 1  ON 48
ci_050                 2.845870e-03 3 1  ON 49
ci_051                 2.985911e-03 3 1  ON 50
ci_052                -2.175489e-03 3 1  ON 51
ci_053                -2.208399e-03 3 1  ON 52
ci_054                -2.208074e-03 3 1  ON 53
ci_055                -2.426854e-03 3 1  ON 54
ci_056                 4.624301e-03 3 1  ON 55
ci_057                 4.639944e-03 3 1  ON 56
ci_058                -2.070497e-03 3 1  ON 57
ci_059                -2.053962e-03 3 1  ON 58
ci_060                 4.760652e-03 3 1  ON 59
ci_061                 5.206904e-03 3 1  ON 60
ci_062                -2.953671e-03 3 1  ON 61
ci_063                -2.807500e-03 3 1  ON 62
ci_064                -2.259265e-03 3 1  ON 63
ci_065                -3.382845e-03 3 1  ON 64
ci_066                 4.060400e-03 3 1  ON 65
ci_067                 4.226439e-03 3 1  ON 66
ci_068                -4.274274e-03 3 1  ON 67
ci_069                -4.110612e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1368e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.2159
    reference variance = 0.203414
====================================================
  Execution time = 1.3705e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0073e-01
  Total weights = 1.957500884e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4935e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288483268286
                                         uncertainty =       0.001805233542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288483268286
                                         uncertainty =       0.001805233542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379859103
  error estimate for blocks of size 2^( 2) =       0.000391530721
  error estimate for blocks of size 2^( 3) =       0.000402077230
  error estimate for blocks of size 2^( 4) =       0.000409350842
  error estimate for blocks of size 2^( 5) =       0.000413608525
  error estimate for blocks of size 2^( 6) =       0.000417392363
  error estimate for blocks of size 2^( 7) =       0.000418438679

      target function =      -0.911522820505
              le_mean =     -17.215026344050
             les_mean =     296.657859236166
             stat err =       0.000414697602
             autocorr =       1.191840039426
   target nu stat err =       0.000414697602
   target dn stat err =       0.002533657907
      target stat err =       0.003988299158
              std dev =       0.537201895720
             le_variance =       0.288585876765


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721502634405e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+03, overlap shift 5.5511e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911539492845       residual = 6.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911539497955       residual = 7.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911539498565       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911539498724       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911539498743       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911539498744       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911539498740       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911539498740       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911539498740       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+03 is 1.868257e-08

solving harmonic davidson linear method for identity shift 2.2204e+04, overlap shift 2.2204e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911539492845       residual = 6.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911539494123       residual = 7.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911539494275       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911539494315       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911539494320       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911539494320       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911539494319       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911539494319       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911539494330       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+04 is 4.670688e-09

solving harmonic davidson linear method for identity shift 8.8818e+04, overlap shift 8.8818e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911539492845       residual = 6.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911539493165       residual = 7.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911539493203       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911539493213       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911539493214       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911539493252       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911539493214       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911539493168       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911539493231       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+04 is 1.167675e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.321245 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6207e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_001                -3.749588e-02 3 1  ON 0
ci_002                -2.874850e-02 3 1  ON 1
ci_003                -2.361787e-02 3 1  ON 2
ci_004                 2.083408e-02 3 1  ON 3
ci_005                 2.126925e-02 3 1  ON 4
ci_006                -1.839604e-02 3 1  ON 5
ci_007                -1.849124e-02 3 1  ON 6
ci_008                -7.764183e-03 3 1  ON 7
ci_009                -1.387915e-02 3 1  ON 8
ci_010                -8.829171e-03 3 1  ON 9
ci_011                -8.961031e-03 3 1  ON 10
ci_012                -9.099375e-03 3 1  ON 11
ci_013                -1.909079e-02 3 1  ON 12
ci_014                 1.111334e-02 3 1  ON 13
ci_015                 1.092238e-02 3 1  ON 14
ci_016                 1.590827e-02 3 1  ON 15
ci_017                 1.564620e-02 3 1  ON 16
ci_018                 9.100900e-03 3 1  ON 17
ci_019                 9.001519e-03 3 1  ON 18
ci_020                 1.504168e-02 3 1  ON 19
ci_021                 1.520431e-02 3 1  ON 20
ci_022                 8.271043e-03 3 1  ON 21
ci_023                 8.252751e-03 3 1  ON 22
ci_024                 8.336469e-03 3 1  ON 23
ci_025                 8.420244e-03 3 1  ON 24
ci_026                 9.900576e-03 3 1  ON 25
ci_027                 9.702450e-03 3 1  ON 26
ci_028                -1.453322e-02 3 1  ON 27
ci_029                -1.479890e-02 3 1  ON 28
ci_030                -8.756885e-03 3 1  ON 29
ci_031                -8.611143e-03 3 1  ON 30
ci_032                -1.432767e-02 3 1  ON 31
ci_033                 4.549883e-03 3 1  ON 32
ci_034                 4.834549e-03 3 1  ON 33
ci_035                -3.331016e-03 3 1  ON 34
ci_036                -1.121960e-02 3 1  ON 35
ci_037                -1.147538e-02 3 1  ON 36
ci_038                 8.690098e-04 3 1  ON 37
ci_039                 1.139857e-03 3 1  ON 38
ci_040                -1.555820e-03 3 1  ON 39
ci_041                 8.159733e-03 3 1  ON 40
ci_042                 8.160845e-03 3 1  ON 41
ci_043                -2.343058e-03 3 1  ON 42
ci_044                -3.908026e-03 3 1  ON 43
ci_045                -1.989074e-03 3 1  ON 44
ci_046                 4.783366e-03 3 1  ON 45
ci_047                 4.612172e-03 3 1  ON 46
ci_048                -1.237711e-02 3 1  ON 47
ci_049                -1.295213e-02 3 1  ON 48
ci_050                 2.845871e-03 3 1  ON 49
ci_051                 2.985911e-03 3 1  ON 50
ci_052                -2.175492e-03 3 1  ON 51
ci_053                -2.208396e-03 3 1  ON 52
ci_054                -2.208074e-03 3 1  ON 53
ci_055                -2.426854e-03 3 1  ON 54
ci_056                 4.624301e-03 3 1  ON 55
ci_057                 4.639944e-03 3 1  ON 56
ci_058                -2.070497e-03 3 1  ON 57
ci_059                -2.053962e-03 3 1  ON 58
ci_060                 4.760650e-03 3 1  ON 59
ci_061                 5.206902e-03 3 1  ON 60
ci_062                -2.953670e-03 3 1  ON 61
ci_063                -2.807498e-03 3 1  ON 62
ci_064                -2.259266e-03 3 1  ON 63
ci_065                -3.382844e-03 3 1  ON 64
ci_066                 4.060400e-03 3 1  ON 65
ci_067                 4.226438e-03 3 1  ON 66
ci_068                -4.274275e-03 3 1  ON 67
ci_069                -4.110616e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.1861
    reference variance = 0.182233
====================================================
  Execution time = 1.3392e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9956e-01
  Total weights = 1.9575e+06
  Execution time = 1.8096e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285416085282
                                         uncertainty =       0.002052758512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285416085282
                                         uncertainty =       0.002052758512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377754784
  error estimate for blocks of size 2^( 2) =       0.000389187871
  error estimate for blocks of size 2^( 3) =       0.000399780429
  error estimate for blocks of size 2^( 4) =       0.000407804498
  error estimate for blocks of size 2^( 5) =       0.000413612231
  error estimate for blocks of size 2^( 6) =       0.000417520195
  error estimate for blocks of size 2^( 7) =       0.000418636638

      target function =      -0.913351880233
              le_mean =     -17.214163233868
             les_mean =     296.626980804161
             stat err =       0.000414393391
             autocorr =       1.203388051482
   target nu stat err =       0.000414393391
   target dn stat err =       0.002816792084
      target stat err =       0.004431085575
              std dev =       0.534225938113
             le_variance =       0.285397352952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285416086509
                                         uncertainty =       0.002052760108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285416086509
                                         uncertainty =       0.002052760108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377754784
  error estimate for blocks of size 2^( 2) =       0.000389187874
  error estimate for blocks of size 2^( 3) =       0.000399780433
  error estimate for blocks of size 2^( 4) =       0.000407804503
  error estimate for blocks of size 2^( 5) =       0.000413612237
  error estimate for blocks of size 2^( 6) =       0.000417520201
  error estimate for blocks of size 2^( 7) =       0.000418636645

      target function =      -0.913352128807
              le_mean =     -17.214163233916
             les_mean =     296.626980645695
             stat err =       0.000414393397
             autocorr =       1.203388080284
   target nu stat err =       0.000414393397
   target dn stat err =       0.002816796636
      target stat err =       0.004431094937
              std dev =       0.534225939270
             le_variance =       0.285397354189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285416085896
                                         uncertainty =       0.002052759310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285416085896
                                         uncertainty =       0.002052759310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377754784
  error estimate for blocks of size 2^( 2) =       0.000389187873
  error estimate for blocks of size 2^( 3) =       0.000399780431
  error estimate for blocks of size 2^( 4) =       0.000407804501
  error estimate for blocks of size 2^( 5) =       0.000413612234
  error estimate for blocks of size 2^( 6) =       0.000417520198
  error estimate for blocks of size 2^( 7) =       0.000418636642

      target function =      -0.913352005465
              le_mean =     -17.214163233892
             les_mean =     296.626980724319
             stat err =       0.000414393394
             autocorr =       1.203388065886
   target nu stat err =       0.000414393394
   target dn stat err =       0.002816794358
      target stat err =       0.004431090261
              std dev =       0.534225938691
             le_variance =       0.285397353571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285416085359
                                         uncertainty =       0.002052758612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285416085359
                                         uncertainty =       0.002052758612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377754784
  error estimate for blocks of size 2^( 2) =       0.000389187872
  error estimate for blocks of size 2^( 3) =       0.000399780430
  error estimate for blocks of size 2^( 4) =       0.000407804499
  error estimate for blocks of size 2^( 5) =       0.000413612231
  error estimate for blocks of size 2^( 6) =       0.000417520196
  error estimate for blocks of size 2^( 7) =       0.000418636639

      target function =      -0.913351895992
              le_mean =     -17.214163233871
             les_mean =     296.626980794114
             stat err =       0.000414393391
             autocorr =       1.203388053285
   target nu stat err =       0.000414393391
   target dn stat err =       0.002816792368
      target stat err =       0.004431086161
              std dev =       0.534225938185
             le_variance =       0.285397353029


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913351880233        initial
     5.5511e+03     5.5511e+04             1.8683e-08        -0.913352128807  <--
     2.2204e+04     2.2204e+05             4.6707e-09        -0.913352005465
     8.8818e+04     8.8818e+05             1.1677e-09        -0.913351895992

*****************************************************************************
Applying the update for shift_i =   5.5511e+03     and shift_s =   5.5511e+04
*****************************************************************************

  Execution time = 2.2531e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_001                -3.749588e-02 3 1  ON 0
ci_002                -2.874849e-02 3 1  ON 1
ci_003                -2.361787e-02 3 1  ON 2
ci_004                 2.083408e-02 3 1  ON 3
ci_005                 2.126925e-02 3 1  ON 4
ci_006                -1.839603e-02 3 1  ON 5
ci_007                -1.849123e-02 3 1  ON 6
ci_008                -7.764174e-03 3 1  ON 7
ci_009                -1.387914e-02 3 1  ON 8
ci_010                -8.829161e-03 3 1  ON 9
ci_011                -8.961019e-03 3 1  ON 10
ci_012                -9.099365e-03 3 1  ON 11
ci_013                -1.909079e-02 3 1  ON 12
ci_014                 1.111333e-02 3 1  ON 13
ci_015                 1.092238e-02 3 1  ON 14
ci_016                 1.590827e-02 3 1  ON 15
ci_017                 1.564620e-02 3 1  ON 16
ci_018                 9.100896e-03 3 1  ON 17
ci_019                 9.001521e-03 3 1  ON 18
ci_020                 1.504168e-02 3 1  ON 19
ci_021                 1.520430e-02 3 1  ON 20
ci_022                 8.271037e-03 3 1  ON 21
ci_023                 8.252749e-03 3 1  ON 22
ci_024                 8.336467e-03 3 1  ON 23
ci_025                 8.420248e-03 3 1  ON 24
ci_026                 9.900569e-03 3 1  ON 25
ci_027                 9.702455e-03 3 1  ON 26
ci_028                -1.453322e-02 3 1  ON 27
ci_029                -1.479890e-02 3 1  ON 28
ci_030                -8.756880e-03 3 1  ON 29
ci_031                -8.611144e-03 3 1  ON 30
ci_032                -1.432767e-02 3 1  ON 31
ci_033                 4.549883e-03 3 1  ON 32
ci_034                 4.834545e-03 3 1  ON 33
ci_035                -3.331015e-03 3 1  ON 34
ci_036                -1.121959e-02 3 1  ON 35
ci_037                -1.147539e-02 3 1  ON 36
ci_038                 8.690098e-04 3 1  ON 37
ci_039                 1.139855e-03 3 1  ON 38
ci_040                -1.555816e-03 3 1  ON 39
ci_041                 8.159736e-03 3 1  ON 40
ci_042                 8.160838e-03 3 1  ON 41
ci_043                -2.343059e-03 3 1  ON 42
ci_044                -3.908040e-03 3 1  ON 43
ci_045                -1.989077e-03 3 1  ON 44
ci_046                 4.783362e-03 3 1  ON 45
ci_047                 4.612170e-03 3 1  ON 46
ci_048                -1.237712e-02 3 1  ON 47
ci_049                -1.295213e-02 3 1  ON 48
ci_050                 2.845872e-03 3 1  ON 49
ci_051                 2.985912e-03 3 1  ON 50
ci_052                -2.175499e-03 3 1  ON 51
ci_053                -2.208390e-03 3 1  ON 52
ci_054                -2.208073e-03 3 1  ON 53
ci_055                -2.426852e-03 3 1  ON 54
ci_056                 4.624300e-03 3 1  ON 55
ci_057                 4.639941e-03 3 1  ON 56
ci_058                -2.070497e-03 3 1  ON 57
ci_059                -2.053962e-03 3 1  ON 58
ci_060                 4.760644e-03 3 1  ON 59
ci_061                 5.206895e-03 3 1  ON 60
ci_062                -2.953667e-03 3 1  ON 61
ci_063                -2.807491e-03 3 1  ON 62
ci_064                -2.259267e-03 3 1  ON 63
ci_065                -3.382840e-03 3 1  ON 64
ci_066                 4.060399e-03 3 1  ON 65
ci_067                 4.226433e-03 3 1  ON 66
ci_068                -4.274276e-03 3 1  ON 67
ci_069                -4.110628e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8745e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.2808
    reference variance = 0.376405
====================================================
  Execution time = 1.3723e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0331e-01
  Total weights = 1.957887314e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5231e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290597458119
                                         uncertainty =       0.001796145889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290597458119
                                         uncertainty =       0.001796145889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381170362
  error estimate for blocks of size 2^( 2) =       0.000392238839
  error estimate for blocks of size 2^( 3) =       0.000402319163
  error estimate for blocks of size 2^( 4) =       0.000410070062
  error estimate for blocks of size 2^( 5) =       0.000413876606
  error estimate for blocks of size 2^( 6) =       0.000415782547
  error estimate for blocks of size 2^( 7) =       0.000418996206

      target function =      -0.907548542158
              le_mean =     -17.214888784782
             les_mean =     296.655704368254
             stat err =       0.000414681355
             autocorr =       1.183561335158
   target nu stat err =       0.000414681355
   target dn stat err =       0.002445329015
      target stat err =       0.003819716218
              std dev =       0.539056295519
             le_variance =       0.290581689738


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721488878478e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+03, overlap shift 1.3878e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907563736878       residual = 7.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907563760697       residual = 8.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907563764030       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907563764596       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907563764667       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907563764766       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907563764781       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907563764790       residual = 8.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907563764786       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907563764779       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+03 is 9.124646e-08

solving harmonic davidson linear method for identity shift 5.5511e+03, overlap shift 5.5511e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907563736878       residual = 7.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907563742833       residual = 8.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907563743667       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907563743810       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907563743838       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907563743851       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907563743851       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907563743863       residual = 8.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907563743851       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907563743854       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+03 is 2.281249e-08

solving harmonic davidson linear method for identity shift 2.2204e+04, overlap shift 2.2204e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907563736878       residual = 7.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907563738367       residual = 8.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907563738576       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907563738612       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907563738688       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907563738643       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907563738631       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907563738580       residual = 8.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907563738609       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907563738659       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+04 is 5.703176e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.324718 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6255e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_001                -3.749587e-02 3 1  ON 0
ci_002                -2.874850e-02 3 1  ON 1
ci_003                -2.361787e-02 3 1  ON 2
ci_004                 2.083408e-02 3 1  ON 3
ci_005                 2.126924e-02 3 1  ON 4
ci_006                -1.839604e-02 3 1  ON 5
ci_007                -1.849123e-02 3 1  ON 6
ci_008                -7.764160e-03 3 1  ON 7
ci_009                -1.387914e-02 3 1  ON 8
ci_010                -8.829167e-03 3 1  ON 9
ci_011                -8.961007e-03 3 1  ON 10
ci_012                -9.099351e-03 3 1  ON 11
ci_013                -1.909078e-02 3 1  ON 12
ci_014                 1.111332e-02 3 1  ON 13
ci_015                 1.092238e-02 3 1  ON 14
ci_016                 1.590826e-02 3 1  ON 15
ci_017                 1.564620e-02 3 1  ON 16
ci_018                 9.100902e-03 3 1  ON 17
ci_019                 9.001528e-03 3 1  ON 18
ci_020                 1.504167e-02 3 1  ON 19
ci_021                 1.520430e-02 3 1  ON 20
ci_022                 8.271035e-03 3 1  ON 21
ci_023                 8.252740e-03 3 1  ON 22
ci_024                 8.336477e-03 3 1  ON 23
ci_025                 8.420244e-03 3 1  ON 24
ci_026                 9.900564e-03 3 1  ON 25
ci_027                 9.702444e-03 3 1  ON 26
ci_028                -1.453323e-02 3 1  ON 27
ci_029                -1.479891e-02 3 1  ON 28
ci_030                -8.756879e-03 3 1  ON 29
ci_031                -8.611140e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.549875e-03 3 1  ON 32
ci_034                 4.834524e-03 3 1  ON 33
ci_035                -3.331011e-03 3 1  ON 34
ci_036                -1.121960e-02 3 1  ON 35
ci_037                -1.147537e-02 3 1  ON 36
ci_038                 8.690040e-04 3 1  ON 37
ci_039                 1.139852e-03 3 1  ON 38
ci_040                -1.555817e-03 3 1  ON 39
ci_041                 8.159730e-03 3 1  ON 40
ci_042                 8.160832e-03 3 1  ON 41
ci_043                -2.343056e-03 3 1  ON 42
ci_044                -3.908017e-03 3 1  ON 43
ci_045                -1.989072e-03 3 1  ON 44
ci_046                 4.783360e-03 3 1  ON 45
ci_047                 4.612175e-03 3 1  ON 46
ci_048                -1.237712e-02 3 1  ON 47
ci_049                -1.295213e-02 3 1  ON 48
ci_050                 2.845883e-03 3 1  ON 49
ci_051                 2.985918e-03 3 1  ON 50
ci_052                -2.175510e-03 3 1  ON 51
ci_053                -2.208386e-03 3 1  ON 52
ci_054                -2.208062e-03 3 1  ON 53
ci_055                -2.426855e-03 3 1  ON 54
ci_056                 4.624298e-03 3 1  ON 55
ci_057                 4.639948e-03 3 1  ON 56
ci_058                -2.070489e-03 3 1  ON 57
ci_059                -2.053951e-03 3 1  ON 58
ci_060                 4.760647e-03 3 1  ON 59
ci_061                 5.206900e-03 3 1  ON 60
ci_062                -2.953668e-03 3 1  ON 61
ci_063                -2.807496e-03 3 1  ON 62
ci_064                -2.259264e-03 3 1  ON 63
ci_065                -3.382836e-03 3 1  ON 64
ci_066                 4.060395e-03 3 1  ON 65
ci_067                 4.226429e-03 3 1  ON 66
ci_068                -4.274271e-03 3 1  ON 67
ci_069                -4.110632e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.2354
    reference variance = 0.421185
====================================================
  Execution time = 1.3418e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0066e-01
  Total weights = 1.9577e+06
  Execution time = 1.8059e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288067165868
                                         uncertainty =       0.001387346049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288067165868
                                         uncertainty =       0.001387346049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379481240
  error estimate for blocks of size 2^( 2) =       0.000391284219
  error estimate for blocks of size 2^( 3) =       0.000401733079
  error estimate for blocks of size 2^( 4) =       0.000409007077
  error estimate for blocks of size 2^( 5) =       0.000414110646
  error estimate for blocks of size 2^( 6) =       0.000417288946
  error estimate for blocks of size 2^( 7) =       0.000418783463

      target function =      -0.911616665729
              le_mean =     -17.215235457268
             les_mean =     296.664996587659
             stat err =       0.000414797533
             autocorr =       1.194790354185
   target nu stat err =       0.000414797533
   target dn stat err =       0.002140031863
      target stat err =       0.003391772227
              std dev =       0.536667515764
             le_variance =       0.288012022477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288067154501
                                         uncertainty =       0.001387345629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288067154501
                                         uncertainty =       0.001387345629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379481232
  error estimate for blocks of size 2^( 2) =       0.000391284215
  error estimate for blocks of size 2^( 3) =       0.000401733080
  error estimate for blocks of size 2^( 4) =       0.000409007081
  error estimate for blocks of size 2^( 5) =       0.000414110653
  error estimate for blocks of size 2^( 6) =       0.000417288953
  error estimate for blocks of size 2^( 7) =       0.000418783475

      target function =      -0.911616695776
              le_mean =     -17.215235456981
             les_mean =     296.664996558715
             stat err =       0.000414797540
             autocorr =       1.194790444856
   target nu stat err =       0.000414797540
   target dn stat err =       0.002139990299
      target stat err =       0.003391709419
              std dev =       0.536667505126
             le_variance =       0.288012011059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288067160184
                                         uncertainty =       0.001387345839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288067160184
                                         uncertainty =       0.001387345839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379481236
  error estimate for blocks of size 2^( 2) =       0.000391284217
  error estimate for blocks of size 2^( 3) =       0.000401733080
  error estimate for blocks of size 2^( 4) =       0.000409007079
  error estimate for blocks of size 2^( 5) =       0.000414110649
  error estimate for blocks of size 2^( 6) =       0.000417288949
  error estimate for blocks of size 2^( 7) =       0.000418783469

      target function =      -0.911616680931
              le_mean =     -17.215235457125
             les_mean =     296.664996573070
             stat err =       0.000414797537
             autocorr =       1.194790399519
   target nu stat err =       0.000414797537
   target dn stat err =       0.002140011073
      target stat err =       0.003391740813
              std dev =       0.536667510445
             le_variance =       0.288012016767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288067165158
                                         uncertainty =       0.001387346023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288067165158
                                         uncertainty =       0.001387346023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379481239
  error estimate for blocks of size 2^( 2) =       0.000391284219
  error estimate for blocks of size 2^( 3) =       0.000401733080
  error estimate for blocks of size 2^( 4) =       0.000409007077
  error estimate for blocks of size 2^( 5) =       0.000414110647
  error estimate for blocks of size 2^( 6) =       0.000417288946
  error estimate for blocks of size 2^( 7) =       0.000418783463

      target function =      -0.911616667649
              le_mean =     -17.215235457250
             les_mean =     296.664996585822
             stat err =       0.000414797533
             autocorr =       1.194790359847
   target nu stat err =       0.000414797533
   target dn stat err =       0.002140029263
      target stat err =       0.003391768300
              std dev =       0.536667515099
             le_variance =       0.288012021763


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911616665729        initial
     1.3878e+03     1.3878e+04             9.1246e-08        -0.911616695776  <--
     5.5511e+03     5.5511e+04             2.2812e-08        -0.911616680931
     2.2204e+04     2.2204e+05             5.7032e-09        -0.911616667649

*****************************************************************************
Applying the update for shift_i =   1.3878e+03     and shift_s =   1.3878e+04
*****************************************************************************

  Execution time = 2.2513e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_001                -3.749586e-02 3 1  ON 0
ci_002                -2.874851e-02 3 1  ON 1
ci_003                -2.361787e-02 3 1  ON 2
ci_004                 2.083406e-02 3 1  ON 3
ci_005                 2.126923e-02 3 1  ON 4
ci_006                -1.839607e-02 3 1  ON 5
ci_007                -1.849122e-02 3 1  ON 6
ci_008                -7.764118e-03 3 1  ON 7
ci_009                -1.387912e-02 3 1  ON 8
ci_010                -8.829185e-03 3 1  ON 9
ci_011                -8.960970e-03 3 1  ON 10
ci_012                -9.099308e-03 3 1  ON 11
ci_013                -1.909075e-02 3 1  ON 12
ci_014                 1.111330e-02 3 1  ON 13
ci_015                 1.092239e-02 3 1  ON 14
ci_016                 1.590824e-02 3 1  ON 15
ci_017                 1.564619e-02 3 1  ON 16
ci_018                 9.100921e-03 3 1  ON 17
ci_019                 9.001548e-03 3 1  ON 18
ci_020                 1.504165e-02 3 1  ON 19
ci_021                 1.520429e-02 3 1  ON 20
ci_022                 8.271031e-03 3 1  ON 21
ci_023                 8.252711e-03 3 1  ON 22
ci_024                 8.336506e-03 3 1  ON 23
ci_025                 8.420231e-03 3 1  ON 24
ci_026                 9.900546e-03 3 1  ON 25
ci_027                 9.702410e-03 3 1  ON 26
ci_028                -1.453325e-02 3 1  ON 27
ci_029                -1.479892e-02 3 1  ON 28
ci_030                -8.756875e-03 3 1  ON 29
ci_031                -8.611127e-03 3 1  ON 30
ci_032                -1.432764e-02 3 1  ON 31
ci_033                 4.549850e-03 3 1  ON 32
ci_034                 4.834463e-03 3 1  ON 33
ci_035                -3.330998e-03 3 1  ON 34
ci_036                -1.121963e-02 3 1  ON 35
ci_037                -1.147533e-02 3 1  ON 36
ci_038                 8.689867e-04 3 1  ON 37
ci_039                 1.139843e-03 3 1  ON 38
ci_040                -1.555817e-03 3 1  ON 39
ci_041                 8.159713e-03 3 1  ON 40
ci_042                 8.160814e-03 3 1  ON 41
ci_043                -2.343046e-03 3 1  ON 42
ci_044                -3.907948e-03 3 1  ON 43
ci_045                -1.989060e-03 3 1  ON 44
ci_046                 4.783353e-03 3 1  ON 45
ci_047                 4.612189e-03 3 1  ON 46
ci_048                -1.237711e-02 3 1  ON 47
ci_049                -1.295213e-02 3 1  ON 48
ci_050                 2.845915e-03 3 1  ON 49
ci_051                 2.985939e-03 3 1  ON 50
ci_052                -2.175544e-03 3 1  ON 51
ci_053                -2.208375e-03 3 1  ON 52
ci_054                -2.208029e-03 3 1  ON 53
ci_055                -2.426866e-03 3 1  ON 54
ci_056                 4.624293e-03 3 1  ON 55
ci_057                 4.639967e-03 3 1  ON 56
ci_058                -2.070467e-03 3 1  ON 57
ci_059                -2.053918e-03 3 1  ON 58
ci_060                 4.760658e-03 3 1  ON 59
ci_061                 5.206917e-03 3 1  ON 60
ci_062                -2.953672e-03 3 1  ON 61
ci_063                -2.807508e-03 3 1  ON 62
ci_064                -2.259256e-03 3 1  ON 63
ci_065                -3.382824e-03 3 1  ON 64
ci_066                 4.060384e-03 3 1  ON 65
ci_067                 4.226417e-03 3 1  ON 66
ci_068                -4.274255e-03 3 1  ON 67
ci_069                -4.110643e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8774e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.2352
    reference variance = 0.168795
====================================================
  Execution time = 1.3899e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0001e-01
  Total weights = 1.957352629e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5118e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286912423438
                                         uncertainty =       0.002192116079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286912423438
                                         uncertainty =       0.002192116079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378714191
  error estimate for blocks of size 2^( 2) =       0.000390266560
  error estimate for blocks of size 2^( 3) =       0.000400389981
  error estimate for blocks of size 2^( 4) =       0.000407798494
  error estimate for blocks of size 2^( 5) =       0.000410879191
  error estimate for blocks of size 2^( 6) =       0.000412978992
  error estimate for blocks of size 2^( 7) =       0.000414741352

      target function =      -0.912638486851
              le_mean =     -17.214818047646
             les_mean =     296.649967919916
             stat err =       0.000411599507
             autocorr =       1.181208421544
   target nu stat err =       0.000411599507
   target dn stat err =       0.003100111688
      target stat err =       0.004863754334
              std dev =       0.535582744953
             le_variance =       0.286848876691


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721481804765e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+02, overlap shift 3.4694e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912663364779       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912663582430       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912663597005       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912663602506       residual = 6.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912663603319       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912663603656       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912663603771       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912663603818       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912663603771       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912663603778       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+02 is 4.795347e-07

solving harmonic davidson linear method for identity shift 1.3878e+03, overlap shift 1.3878e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912663364779       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912663419201       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912663422845       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912663424221       residual = 6.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912663424424       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912663424506       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912663424536       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912663424551       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912663424537       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912663424537       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+03 is 1.199037e-07

solving harmonic davidson linear method for identity shift 5.5511e+03, overlap shift 5.5511e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912663364779       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912663378385       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912663379296       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912663379641       residual = 6.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912663379691       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912663379714       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912663379709       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912663379726       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912663379719       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912663379722       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+03 is 2.997718e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.328201 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6420e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_001                -3.749580e-02 3 1  ON 0
ci_002                -2.874848e-02 3 1  ON 1
ci_003                -2.361790e-02 3 1  ON 2
ci_004                 2.083405e-02 3 1  ON 3
ci_005                 2.126916e-02 3 1  ON 4
ci_006                -1.839607e-02 3 1  ON 5
ci_007                -1.849117e-02 3 1  ON 6
ci_008                -7.764064e-03 3 1  ON 7
ci_009                -1.387908e-02 3 1  ON 8
ci_010                -8.829251e-03 3 1  ON 9
ci_011                -8.960856e-03 3 1  ON 10
ci_012                -9.099287e-03 3 1  ON 11
ci_013                -1.909080e-02 3 1  ON 12
ci_014                 1.111321e-02 3 1  ON 13
ci_015                 1.092239e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564622e-02 3 1  ON 16
ci_018                 9.100901e-03 3 1  ON 17
ci_019                 9.001428e-03 3 1  ON 18
ci_020                 1.504166e-02 3 1  ON 19
ci_021                 1.520426e-02 3 1  ON 20
ci_022                 8.271012e-03 3 1  ON 21
ci_023                 8.252705e-03 3 1  ON 22
ci_024                 8.336527e-03 3 1  ON 23
ci_025                 8.420196e-03 3 1  ON 24
ci_026                 9.900525e-03 3 1  ON 25
ci_027                 9.702488e-03 3 1  ON 26
ci_028                -1.453330e-02 3 1  ON 27
ci_029                -1.479895e-02 3 1  ON 28
ci_030                -8.756867e-03 3 1  ON 29
ci_031                -8.611088e-03 3 1  ON 30
ci_032                -1.432765e-02 3 1  ON 31
ci_033                 4.549858e-03 3 1  ON 32
ci_034                 4.834477e-03 3 1  ON 33
ci_035                -3.331000e-03 3 1  ON 34
ci_036                -1.121958e-02 3 1  ON 35
ci_037                -1.147538e-02 3 1  ON 36
ci_038                 8.690161e-04 3 1  ON 37
ci_039                 1.139795e-03 3 1  ON 38
ci_040                -1.555824e-03 3 1  ON 39
ci_041                 8.159727e-03 3 1  ON 40
ci_042                 8.160781e-03 3 1  ON 41
ci_043                -2.343060e-03 3 1  ON 42
ci_044                -3.907958e-03 3 1  ON 43
ci_045                -1.989103e-03 3 1  ON 44
ci_046                 4.783326e-03 3 1  ON 45
ci_047                 4.612198e-03 3 1  ON 46
ci_048                -1.237713e-02 3 1  ON 47
ci_049                -1.295220e-02 3 1  ON 48
ci_050                 2.845911e-03 3 1  ON 49
ci_051                 2.985930e-03 3 1  ON 50
ci_052                -2.175647e-03 3 1  ON 51
ci_053                -2.208334e-03 3 1  ON 52
ci_054                -2.208020e-03 3 1  ON 53
ci_055                -2.426861e-03 3 1  ON 54
ci_056                 4.624248e-03 3 1  ON 55
ci_057                 4.639934e-03 3 1  ON 56
ci_058                -2.070471e-03 3 1  ON 57
ci_059                -2.053832e-03 3 1  ON 58
ci_060                 4.760689e-03 3 1  ON 59
ci_061                 5.206901e-03 3 1  ON 60
ci_062                -2.953664e-03 3 1  ON 61
ci_063                -2.807516e-03 3 1  ON 62
ci_064                -2.259242e-03 3 1  ON 63
ci_065                -3.382826e-03 3 1  ON 64
ci_066                 4.060370e-03 3 1  ON 65
ci_067                 4.226407e-03 3 1  ON 66
ci_068                -4.274265e-03 3 1  ON 67
ci_069                -4.110726e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.277
    reference variance = 0.27842
====================================================
  Execution time = 1.3621e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0005e-01
  Total weights = 1.9578e+06
  Execution time = 1.8115e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285219147960
                                         uncertainty =       0.001650137009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285219147960
                                         uncertainty =       0.001650137009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377693356
  error estimate for blocks of size 2^( 2) =       0.000388819896
  error estimate for blocks of size 2^( 3) =       0.000399211165
  error estimate for blocks of size 2^( 4) =       0.000406847465
  error estimate for blocks of size 2^( 5) =       0.000410926855
  error estimate for blocks of size 2^( 6) =       0.000414460428
  error estimate for blocks of size 2^( 7) =       0.000414635833

      target function =      -0.912599872092
              le_mean =     -17.214242348433
             les_mean =     296.630190830116
             stat err =       0.000411717645
             autocorr =       1.188284056754
   target nu stat err =       0.000411717645
   target dn stat err =       0.002465134587
      target stat err =       0.003886279236
              std dev =       0.534139066166
             le_variance =       0.285304542005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285219060004
                                         uncertainty =       0.001650137109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285219060004
                                         uncertainty =       0.001650137109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377693297
  error estimate for blocks of size 2^( 2) =       0.000388819865
  error estimate for blocks of size 2^( 3) =       0.000399211169
  error estimate for blocks of size 2^( 4) =       0.000406847492
  error estimate for blocks of size 2^( 5) =       0.000410926896
  error estimate for blocks of size 2^( 6) =       0.000414460478
  error estimate for blocks of size 2^( 7) =       0.000414635880

      target function =      -0.912600369809
              le_mean =     -17.214242350034
             les_mean =     296.630190563925
             stat err =       0.000411717687
             autocorr =       1.188284666968
   target nu stat err =       0.000411717687
   target dn stat err =       0.002465170488
      target stat err =       0.003886338196
              std dev =       0.534138982813
             le_variance =       0.285304452960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285219103964
                                         uncertainty =       0.001650137059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285219103964
                                         uncertainty =       0.001650137059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377693326
  error estimate for blocks of size 2^( 2) =       0.000388819881
  error estimate for blocks of size 2^( 3) =       0.000399211167
  error estimate for blocks of size 2^( 4) =       0.000406847478
  error estimate for blocks of size 2^( 5) =       0.000410926875
  error estimate for blocks of size 2^( 6) =       0.000414460453
  error estimate for blocks of size 2^( 7) =       0.000414635857

      target function =      -0.912600125309
              le_mean =     -17.214242349232
             les_mean =     296.630190694162
             stat err =       0.000411717666
             autocorr =       1.188284361922
   target nu stat err =       0.000411717666
   target dn stat err =       0.002465152412
      target stat err =       0.003886308562
              std dev =       0.534139024473
             le_variance =       0.285304497465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285219142459
                                         uncertainty =       0.001650137015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285219142459
                                         uncertainty =       0.001650137015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377693352
  error estimate for blocks of size 2^( 2) =       0.000388819894
  error estimate for blocks of size 2^( 3) =       0.000399211165
  error estimate for blocks of size 2^( 4) =       0.000406847466
  error estimate for blocks of size 2^( 5) =       0.000410926857
  error estimate for blocks of size 2^( 6) =       0.000414460431
  error estimate for blocks of size 2^( 7) =       0.000414635836

      target function =      -0.912599904249
              le_mean =     -17.214242348533
             les_mean =     296.630190812791
             stat err =       0.000411717648
             autocorr =       1.188284094904
   target nu stat err =       0.000411717648
   target dn stat err =       0.002465136801
      target stat err =       0.003886282885
              std dev =       0.534139060953
             le_variance =       0.285304536436


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912599872092        initial
     3.4694e+02     3.4694e+03             4.7953e-07        -0.912600369809  <--
     1.3878e+03     1.3878e+04             1.1990e-07        -0.912600125309
     5.5511e+03     5.5511e+04             2.9977e-08        -0.912599904249

*****************************************************************************
Applying the update for shift_i =   3.4694e+02     and shift_s =   3.4694e+03
*****************************************************************************

  Execution time = 2.2922e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_001                -3.749562e-02 3 1  ON 0
ci_002                -2.874840e-02 3 1  ON 1
ci_003                -2.361798e-02 3 1  ON 2
ci_004                 2.083400e-02 3 1  ON 3
ci_005                 2.126897e-02 3 1  ON 4
ci_006                -1.839609e-02 3 1  ON 5
ci_007                -1.849102e-02 3 1  ON 6
ci_008                -7.763902e-03 3 1  ON 7
ci_009                -1.387896e-02 3 1  ON 8
ci_010                -8.829449e-03 3 1  ON 9
ci_011                -8.960515e-03 3 1  ON 10
ci_012                -9.099221e-03 3 1  ON 11
ci_013                -1.909096e-02 3 1  ON 12
ci_014                 1.111292e-02 3 1  ON 13
ci_015                 1.092242e-02 3 1  ON 14
ci_016                 1.590829e-02 3 1  ON 15
ci_017                 1.564631e-02 3 1  ON 16
ci_018                 9.100842e-03 3 1  ON 17
ci_019                 9.001069e-03 3 1  ON 18
ci_020                 1.504169e-02 3 1  ON 19
ci_021                 1.520417e-02 3 1  ON 20
ci_022                 8.270956e-03 3 1  ON 21
ci_023                 8.252685e-03 3 1  ON 22
ci_024                 8.336592e-03 3 1  ON 23
ci_025                 8.420088e-03 3 1  ON 24
ci_026                 9.900461e-03 3 1  ON 25
ci_027                 9.702724e-03 3 1  ON 26
ci_028                -1.453346e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756841e-03 3 1  ON 29
ci_031                -8.610972e-03 3 1  ON 30
ci_032                -1.432769e-02 3 1  ON 31
ci_033                 4.549884e-03 3 1  ON 32
ci_034                 4.834519e-03 3 1  ON 33
ci_035                -3.331007e-03 3 1  ON 34
ci_036                -1.121942e-02 3 1  ON 35
ci_037                -1.147551e-02 3 1  ON 36
ci_038                 8.691045e-04 3 1  ON 37
ci_039                 1.139652e-03 3 1  ON 38
ci_040                -1.555842e-03 3 1  ON 39
ci_041                 8.159768e-03 3 1  ON 40
ci_042                 8.160682e-03 3 1  ON 41
ci_043                -2.343100e-03 3 1  ON 42
ci_044                -3.907988e-03 3 1  ON 43
ci_045                -1.989233e-03 3 1  ON 44
ci_046                 4.783247e-03 3 1  ON 45
ci_047                 4.612223e-03 3 1  ON 46
ci_048                -1.237717e-02 3 1  ON 47
ci_049                -1.295240e-02 3 1  ON 48
ci_050                 2.845898e-03 3 1  ON 49
ci_051                 2.985904e-03 3 1  ON 50
ci_052                -2.175957e-03 3 1  ON 51
ci_053                -2.208210e-03 3 1  ON 52
ci_054                -2.207994e-03 3 1  ON 53
ci_055                -2.426846e-03 3 1  ON 54
ci_056                 4.624111e-03 3 1  ON 55
ci_057                 4.639837e-03 3 1  ON 56
ci_058                -2.070484e-03 3 1  ON 57
ci_059                -2.053573e-03 3 1  ON 58
ci_060                 4.760783e-03 3 1  ON 59
ci_061                 5.206852e-03 3 1  ON 60
ci_062                -2.953640e-03 3 1  ON 61
ci_063                -2.807541e-03 3 1  ON 62
ci_064                -2.259200e-03 3 1  ON 63
ci_065                -3.382831e-03 3 1  ON 64
ci_066                 4.060327e-03 3 1  ON 65
ci_067                 4.226378e-03 3 1  ON 66
ci_068                -4.274295e-03 3 1  ON 67
ci_069                -4.110976e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9349e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.2517
    reference variance = 0.167835
====================================================
  Execution time = 1.3744e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0011e-01
  Total weights = 1.957654787e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4914e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286950987397
                                         uncertainty =       0.002105594017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286950987397
                                         uncertainty =       0.002105594017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378750173
  error estimate for blocks of size 2^( 2) =       0.000390452093
  error estimate for blocks of size 2^( 3) =       0.000400718375
  error estimate for blocks of size 2^( 4) =       0.000408551326
  error estimate for blocks of size 2^( 5) =       0.000412458223
  error estimate for blocks of size 2^( 6) =       0.000415472227
  error estimate for blocks of size 2^( 7) =       0.000414852540

      target function =      -0.912482811470
              le_mean =     -17.214801488451
             les_mean =     296.649502856110
             stat err =       0.000412833579
             autocorr =       1.188076347744
   target nu stat err =       0.000412833579
   target dn stat err =       0.002646954611
      target stat err =       0.004167554555
              std dev =       0.535633631058
             le_variance =       0.286903386720


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721480148845e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+01, overlap shift 8.6736e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912500861826       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912501509811       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912501591033       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912501606222       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912501607507       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912501607482       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912501606992       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912501606773       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912501606814       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912501606829       residual = 6.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+01 is 2.215328e-06

solving harmonic davidson linear method for identity shift 3.4694e+02, overlap shift 3.4694e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912500861826       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912501023934       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912501044250       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912501048048       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912501048369       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912501048363       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912501048240       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912501048185       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912501048196       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912501048200       residual = 6.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+02 is 5.541759e-07

solving harmonic davidson linear method for identity shift 1.3878e+03, overlap shift 1.3878e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912500861826       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912500902360       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912500907440       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912500908388       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912500908471       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912500908468       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912500908438       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912500908424       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912500908426       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912500908428       residual = 6.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+03 is 1.385655e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.331683 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6244e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126881e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764073e-03 3 1  ON 7
ci_009                -1.387890e-02 3 1  ON 8
ci_010                -8.829284e-03 3 1  ON 9
ci_011                -8.959961e-03 3 1  ON 10
ci_012                -9.098939e-03 3 1  ON 11
ci_013                -1.909113e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590826e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100982e-03 3 1  ON 17
ci_019                 9.001130e-03 3 1  ON 18
ci_020                 1.504176e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270880e-03 3 1  ON 21
ci_023                 8.252611e-03 3 1  ON 22
ci_024                 8.336511e-03 3 1  ON 23
ci_025                 8.419979e-03 3 1  ON 24
ci_026                 9.900452e-03 3 1  ON 25
ci_027                 9.702752e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756951e-03 3 1  ON 29
ci_031                -8.610837e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550061e-03 3 1  ON 32
ci_034                 4.834245e-03 3 1  ON 33
ci_035                -3.330946e-03 3 1  ON 34
ci_036                -1.121940e-02 3 1  ON 35
ci_037                -1.147551e-02 3 1  ON 36
ci_038                 8.690581e-04 3 1  ON 37
ci_039                 1.139690e-03 3 1  ON 38
ci_040                -1.555748e-03 3 1  ON 39
ci_041                 8.159893e-03 3 1  ON 40
ci_042                 8.160704e-03 3 1  ON 41
ci_043                -2.343101e-03 3 1  ON 42
ci_044                -3.907829e-03 3 1  ON 43
ci_045                -1.989376e-03 3 1  ON 44
ci_046                 4.783179e-03 3 1  ON 45
ci_047                 4.612304e-03 3 1  ON 46
ci_048                -1.237723e-02 3 1  ON 47
ci_049                -1.295228e-02 3 1  ON 48
ci_050                 2.845581e-03 3 1  ON 49
ci_051                 2.985874e-03 3 1  ON 50
ci_052                -2.175768e-03 3 1  ON 51
ci_053                -2.207813e-03 3 1  ON 52
ci_054                -2.208052e-03 3 1  ON 53
ci_055                -2.426845e-03 3 1  ON 54
ci_056                 4.623981e-03 3 1  ON 55
ci_057                 4.639859e-03 3 1  ON 56
ci_058                -2.070626e-03 3 1  ON 57
ci_059                -2.053364e-03 3 1  ON 58
ci_060                 4.760645e-03 3 1  ON 59
ci_061                 5.206740e-03 3 1  ON 60
ci_062                -2.953745e-03 3 1  ON 61
ci_063                -2.807728e-03 3 1  ON 62
ci_064                -2.259141e-03 3 1  ON 63
ci_065                -3.382802e-03 3 1  ON 64
ci_066                 4.060412e-03 3 1  ON 65
ci_067                 4.226252e-03 3 1  ON 66
ci_068                -4.274512e-03 3 1  ON 67
ci_069                -4.110919e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.2286
    reference variance = 0.276984
====================================================
  Execution time = 1.3521e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9694e-01
  Total weights = 1.9577e+06
  Execution time = 1.8067e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284048436766
                                         uncertainty =       0.001645951698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284048436766
                                         uncertainty =       0.001645951698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376861261
  error estimate for blocks of size 2^( 2) =       0.000388372946
  error estimate for blocks of size 2^( 3) =       0.000398375428
  error estimate for blocks of size 2^( 4) =       0.000406412681
  error estimate for blocks of size 2^( 5) =       0.000411643109
  error estimate for blocks of size 2^( 6) =       0.000414793951
  error estimate for blocks of size 2^( 7) =       0.000415745325

      target function =      -0.917423845629
              le_mean =     -17.215417765417
             les_mean =     296.667545834939
             stat err =       0.000412148767
             autocorr =       1.196038102099
   target nu stat err =       0.000412148767
   target dn stat err =       0.002418870476
      target stat err =       0.003864085744
              std dev =       0.532962306431
             le_variance =       0.284048820076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284048321423
                                         uncertainty =       0.001645934255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284048321423
                                         uncertainty =       0.001645934255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376861187
  error estimate for blocks of size 2^( 2) =       0.000388372995
  error estimate for blocks of size 2^( 3) =       0.000398375602
  error estimate for blocks of size 2^( 4) =       0.000406412921
  error estimate for blocks of size 2^( 5) =       0.000411643430
  error estimate for blocks of size 2^( 6) =       0.000414794279
  error estimate for blocks of size 2^( 7) =       0.000415745847

      target function =      -0.917418328311
              le_mean =     -17.215417766848
             les_mean =     296.667549396004
             stat err =       0.000412149119
             autocorr =       1.196040618975
   target nu stat err =       0.000412149119
   target dn stat err =       0.002419012672
      target stat err =       0.003864259748
              std dev =       0.532962201637
             le_variance =       0.284048708374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284048378933
                                         uncertainty =       0.001645942969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284048378933
                                         uncertainty =       0.001645942969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376861224
  error estimate for blocks of size 2^( 2) =       0.000388372970
  error estimate for blocks of size 2^( 3) =       0.000398375515
  error estimate for blocks of size 2^( 4) =       0.000406412801
  error estimate for blocks of size 2^( 5) =       0.000411643270
  error estimate for blocks of size 2^( 6) =       0.000414794115
  error estimate for blocks of size 2^( 7) =       0.000415745586

      target function =      -0.917425390900
              le_mean =     -17.215417766149
             les_mean =     296.667544875959
             stat err =       0.000412148943
             autocorr =       1.196039361503
   target nu stat err =       0.000412148943
   target dn stat err =       0.002418909427
      target stat err =       0.003864158755
              std dev =       0.532962253884
             le_variance =       0.284048764065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284048429522
                                         uncertainty =       0.001645950606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284048429522
                                         uncertainty =       0.001645950606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376861256
  error estimate for blocks of size 2^( 2) =       0.000388372949
  error estimate for blocks of size 2^( 3) =       0.000398375439
  error estimate for blocks of size 2^( 4) =       0.000406412696
  error estimate for blocks of size 2^( 5) =       0.000411643129
  error estimate for blocks of size 2^( 6) =       0.000414793971
  error estimate for blocks of size 2^( 7) =       0.000415745358

      target function =      -0.917424736829
              le_mean =     -17.215417765511
             les_mean =     296.667545270757
             stat err =       0.000412148789
             autocorr =       1.196038259600
   target nu stat err =       0.000412148789
   target dn stat err =       0.002418870875
      target stat err =       0.003864093750
              std dev =       0.532962299848
             le_variance =       0.284048813059


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917423845629        initial
     8.6736e+01     8.6736e+02             2.2153e-06        -0.917418328311
     3.4694e+02     3.4694e+03             5.5418e-07        -0.917425390900  <--
     1.3878e+03     1.3878e+04             1.3857e-07        -0.917424736829

*****************************************************************************
Applying the update for shift_i =   3.4694e+02     and shift_s =   3.4694e+03
*****************************************************************************

  Execution time = 2.2634e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126881e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764073e-03 3 1  ON 7
ci_009                -1.387890e-02 3 1  ON 8
ci_010                -8.829284e-03 3 1  ON 9
ci_011                -8.959961e-03 3 1  ON 10
ci_012                -9.098939e-03 3 1  ON 11
ci_013                -1.909113e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590826e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100982e-03 3 1  ON 17
ci_019                 9.001130e-03 3 1  ON 18
ci_020                 1.504176e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270880e-03 3 1  ON 21
ci_023                 8.252611e-03 3 1  ON 22
ci_024                 8.336511e-03 3 1  ON 23
ci_025                 8.419979e-03 3 1  ON 24
ci_026                 9.900452e-03 3 1  ON 25
ci_027                 9.702752e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756951e-03 3 1  ON 29
ci_031                -8.610837e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550061e-03 3 1  ON 32
ci_034                 4.834245e-03 3 1  ON 33
ci_035                -3.330946e-03 3 1  ON 34
ci_036                -1.121940e-02 3 1  ON 35
ci_037                -1.147551e-02 3 1  ON 36
ci_038                 8.690581e-04 3 1  ON 37
ci_039                 1.139690e-03 3 1  ON 38
ci_040                -1.555748e-03 3 1  ON 39
ci_041                 8.159893e-03 3 1  ON 40
ci_042                 8.160704e-03 3 1  ON 41
ci_043                -2.343101e-03 3 1  ON 42
ci_044                -3.907829e-03 3 1  ON 43
ci_045                -1.989376e-03 3 1  ON 44
ci_046                 4.783179e-03 3 1  ON 45
ci_047                 4.612304e-03 3 1  ON 46
ci_048                -1.237723e-02 3 1  ON 47
ci_049                -1.295228e-02 3 1  ON 48
ci_050                 2.845581e-03 3 1  ON 49
ci_051                 2.985874e-03 3 1  ON 50
ci_052                -2.175768e-03 3 1  ON 51
ci_053                -2.207813e-03 3 1  ON 52
ci_054                -2.208052e-03 3 1  ON 53
ci_055                -2.426845e-03 3 1  ON 54
ci_056                 4.623981e-03 3 1  ON 55
ci_057                 4.639859e-03 3 1  ON 56
ci_058                -2.070626e-03 3 1  ON 57
ci_059                -2.053364e-03 3 1  ON 58
ci_060                 4.760645e-03 3 1  ON 59
ci_061                 5.206740e-03 3 1  ON 60
ci_062                -2.953745e-03 3 1  ON 61
ci_063                -2.807728e-03 3 1  ON 62
ci_064                -2.259141e-03 3 1  ON 63
ci_065                -3.382802e-03 3 1  ON 64
ci_066                 4.060412e-03 3 1  ON 65
ci_067                 4.226252e-03 3 1  ON 66
ci_068                -4.274512e-03 3 1  ON 67
ci_069                -4.110919e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8885e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.2146
    reference variance = 0.287291
====================================================
  Execution time = 1.3703e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9865e-01
  Total weights = 1.957896960e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5062e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285830832358
                                         uncertainty =       0.001691540726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285830832358
                                         uncertainty =       0.001691540726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378010397
  error estimate for blocks of size 2^( 2) =       0.000389322114
  error estimate for blocks of size 2^( 3) =       0.000399519387
  error estimate for blocks of size 2^( 4) =       0.000407374760
  error estimate for blocks of size 2^( 5) =       0.000412487385
  error estimate for blocks of size 2^( 6) =       0.000415183579
  error estimate for blocks of size 2^( 7) =       0.000416496524

      target function =      -0.914764917114
              le_mean =     -17.214714021686
             les_mean =     296.645030225360
             stat err =       0.000412885562
             autocorr =       1.193031480753
   target nu stat err =       0.000412885562
   target dn stat err =       0.002165274335
      target stat err =       0.003449268172
              std dev =       0.534587429463
             le_variance =       0.285783719740


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721471402169e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+01, overlap shift 8.6736e+02 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914777013228       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914777596958       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914777680466       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914777712958       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914777715096       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914777715533       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914777715810       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914777715658       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914777715682       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914777715699       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+01 is 1.669163e-06

solving harmonic davidson linear method for identity shift 3.4694e+02, overlap shift 3.4694e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914777013228       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914777159262       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914777180150       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914777188276       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914777188810       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914777188919       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914777188988       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914777188950       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914777188956       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914777188961       residual = 2.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+02 is 4.175764e-07

solving harmonic davidson linear method for identity shift 1.3878e+03, overlap shift 1.3878e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914777013228       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914777049743       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914777054966       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914777056997       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914777057130       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914777057159       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914777057174       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914777057166       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914777057167       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914777057168       residual = 2.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+03 is 1.044120e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.335169 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6224e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_001                -3.749546e-02 3 1  ON 0
ci_002                -2.874830e-02 3 1  ON 1
ci_003                -2.361773e-02 3 1  ON 2
ci_004                 2.083400e-02 3 1  ON 3
ci_005                 2.126859e-02 3 1  ON 4
ci_006                -1.839581e-02 3 1  ON 5
ci_007                -1.849081e-02 3 1  ON 6
ci_008                -7.763844e-03 3 1  ON 7
ci_009                -1.387886e-02 3 1  ON 8
ci_010                -8.828925e-03 3 1  ON 9
ci_011                -8.960024e-03 3 1  ON 10
ci_012                -9.098733e-03 3 1  ON 11
ci_013                -1.909113e-02 3 1  ON 12
ci_014                 1.111271e-02 3 1  ON 13
ci_015                 1.092250e-02 3 1  ON 14
ci_016                 1.590830e-02 3 1  ON 15
ci_017                 1.564649e-02 3 1  ON 16
ci_018                 9.100960e-03 3 1  ON 17
ci_019                 9.000978e-03 3 1  ON 18
ci_020                 1.504198e-02 3 1  ON 19
ci_021                 1.520355e-02 3 1  ON 20
ci_022                 8.270715e-03 3 1  ON 21
ci_023                 8.252816e-03 3 1  ON 22
ci_024                 8.336326e-03 3 1  ON 23
ci_025                 8.419792e-03 3 1  ON 24
ci_026                 9.900239e-03 3 1  ON 25
ci_027                 9.702925e-03 3 1  ON 26
ci_028                -1.453315e-02 3 1  ON 27
ci_029                -1.479923e-02 3 1  ON 28
ci_030                -8.756758e-03 3 1  ON 29
ci_031                -8.610743e-03 3 1  ON 30
ci_032                -1.432761e-02 3 1  ON 31
ci_033                 4.550160e-03 3 1  ON 32
ci_034                 4.833994e-03 3 1  ON 33
ci_035                -3.330871e-03 3 1  ON 34
ci_036                -1.121948e-02 3 1  ON 35
ci_037                -1.147562e-02 3 1  ON 36
ci_038                 8.690276e-04 3 1  ON 37
ci_039                 1.139668e-03 3 1  ON 38
ci_040                -1.555713e-03 3 1  ON 39
ci_041                 8.160311e-03 3 1  ON 40
ci_042                 8.160459e-03 3 1  ON 41
ci_043                -2.342998e-03 3 1  ON 42
ci_044                -3.908048e-03 3 1  ON 43
ci_045                -1.989296e-03 3 1  ON 44
ci_046                 4.783120e-03 3 1  ON 45
ci_047                 4.612427e-03 3 1  ON 46
ci_048                -1.237745e-02 3 1  ON 47
ci_049                -1.295199e-02 3 1  ON 48
ci_050                 2.845614e-03 3 1  ON 49
ci_051                 2.985944e-03 3 1  ON 50
ci_052                -2.175847e-03 3 1  ON 51
ci_053                -2.207846e-03 3 1  ON 52
ci_054                -2.208050e-03 3 1  ON 53
ci_055                -2.426927e-03 3 1  ON 54
ci_056                 4.624090e-03 3 1  ON 55
ci_057                 4.639833e-03 3 1  ON 56
ci_058                -2.070602e-03 3 1  ON 57
ci_059                -2.053183e-03 3 1  ON 58
ci_060                 4.760719e-03 3 1  ON 59
ci_061                 5.206602e-03 3 1  ON 60
ci_062                -2.953602e-03 3 1  ON 61
ci_063                -2.807739e-03 3 1  ON 62
ci_064                -2.259102e-03 3 1  ON 63
ci_065                -3.382812e-03 3 1  ON 64
ci_066                 4.060362e-03 3 1  ON 65
ci_067                 4.226241e-03 3 1  ON 66
ci_068                -4.274263e-03 3 1  ON 67
ci_069                -4.110692e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.2311
    reference variance = 0.227275
====================================================
  Execution time = 1.3493e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9967e-01
  Total weights = 1.9577e+06
  Execution time = 1.8115e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285700110678
                                         uncertainty =       0.001779313044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285700110678
                                         uncertainty =       0.001779313044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377967957
  error estimate for blocks of size 2^( 2) =       0.000389375786
  error estimate for blocks of size 2^( 3) =       0.000400381727
  error estimate for blocks of size 2^( 4) =       0.000407487357
  error estimate for blocks of size 2^( 5) =       0.000411674002
  error estimate for blocks of size 2^( 6) =       0.000414654629
  error estimate for blocks of size 2^( 7) =       0.000418573486

      target function =      -0.913175773560
              le_mean =     -17.214736838051
             les_mean =     296.646834379708
             stat err =       0.000413097368
             autocorr =       1.194524025481
   target nu stat err =       0.000413097368
   target dn stat err =       0.002388055379
      target stat err =       0.003777350162
              std dev =       0.534527411635
             le_variance =       0.285719553789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285700049161
                                         uncertainty =       0.001779320212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285700049161
                                         uncertainty =       0.001779320212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377967916
  error estimate for blocks of size 2^( 2) =       0.000389375874
  error estimate for blocks of size 2^( 3) =       0.000400381935
  error estimate for blocks of size 2^( 4) =       0.000407487616
  error estimate for blocks of size 2^( 5) =       0.000411674275
  error estimate for blocks of size 2^( 6) =       0.000414654860
  error estimate for blocks of size 2^( 7) =       0.000418573624

      target function =      -0.913172881377
              le_mean =     -17.214736824646
             les_mean =     296.646835776133
             stat err =       0.000413097594
             autocorr =       1.194525590461
   target nu stat err =       0.000413097594
   target dn stat err =       0.002388474874
      target stat err =       0.003777967203
              std dev =       0.534527352978
             le_variance =       0.285719491082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285700079767
                                         uncertainty =       0.001779316627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285700079767
                                         uncertainty =       0.001779316627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377967937
  error estimate for blocks of size 2^( 2) =       0.000389375830
  error estimate for blocks of size 2^( 3) =       0.000400381831
  error estimate for blocks of size 2^( 4) =       0.000407487486
  error estimate for blocks of size 2^( 5) =       0.000411674138
  error estimate for blocks of size 2^( 6) =       0.000414654745
  error estimate for blocks of size 2^( 7) =       0.000418573555

      target function =      -0.913174346052
              le_mean =     -17.214736831329
             les_mean =     296.646835065289
             stat err =       0.000413097481
             autocorr =       1.194524808491
   target nu stat err =       0.000413097481
   target dn stat err =       0.002388264830
      target stat err =       0.003777658382
              std dev =       0.534527382163
             le_variance =       0.285719522282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285700106798
                                         uncertainty =       0.001779313491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285700106798
                                         uncertainty =       0.001779313491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377967955
  error estimate for blocks of size 2^( 2) =       0.000389375791
  error estimate for blocks of size 2^( 3) =       0.000400381740
  error estimate for blocks of size 2^( 4) =       0.000407487373
  error estimate for blocks of size 2^( 5) =       0.000411674019
  error estimate for blocks of size 2^( 6) =       0.000414654644
  error estimate for blocks of size 2^( 7) =       0.000418573494

      target function =      -0.913175597382
              le_mean =     -17.214736837209
             les_mean =     296.646834463888
             stat err =       0.000413097382
             autocorr =       1.194524123379
   target nu stat err =       0.000413097382
   target dn stat err =       0.002388081518
      target stat err =       0.003777388643
              std dev =       0.534527407936
             le_variance =       0.285719549835


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913175773560        initial  <--
     8.6736e+01     8.6736e+02             1.6692e-06        -0.913172881377
     3.4694e+02     3.4694e+03             4.1758e-07        -0.913174346052
     1.3878e+03     1.3878e+04             1.0441e-07        -0.913175597382

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6371
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126881e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764073e-03 3 1  ON 7
ci_009                -1.387890e-02 3 1  ON 8
ci_010                -8.829284e-03 3 1  ON 9
ci_011                -8.959961e-03 3 1  ON 10
ci_012                -9.098939e-03 3 1  ON 11
ci_013                -1.909113e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590826e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100982e-03 3 1  ON 17
ci_019                 9.001130e-03 3 1  ON 18
ci_020                 1.504176e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270880e-03 3 1  ON 21
ci_023                 8.252611e-03 3 1  ON 22
ci_024                 8.336511e-03 3 1  ON 23
ci_025                 8.419979e-03 3 1  ON 24
ci_026                 9.900452e-03 3 1  ON 25
ci_027                 9.702752e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756951e-03 3 1  ON 29
ci_031                -8.610837e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550061e-03 3 1  ON 32
ci_034                 4.834245e-03 3 1  ON 33
ci_035                -3.330946e-03 3 1  ON 34
ci_036                -1.121940e-02 3 1  ON 35
ci_037                -1.147551e-02 3 1  ON 36
ci_038                 8.690581e-04 3 1  ON 37
ci_039                 1.139690e-03 3 1  ON 38
ci_040                -1.555748e-03 3 1  ON 39
ci_041                 8.159893e-03 3 1  ON 40
ci_042                 8.160704e-03 3 1  ON 41
ci_043                -2.343101e-03 3 1  ON 42
ci_044                -3.907829e-03 3 1  ON 43
ci_045                -1.989376e-03 3 1  ON 44
ci_046                 4.783179e-03 3 1  ON 45
ci_047                 4.612304e-03 3 1  ON 46
ci_048                -1.237723e-02 3 1  ON 47
ci_049                -1.295228e-02 3 1  ON 48
ci_050                 2.845581e-03 3 1  ON 49
ci_051                 2.985874e-03 3 1  ON 50
ci_052                -2.175768e-03 3 1  ON 51
ci_053                -2.207813e-03 3 1  ON 52
ci_054                -2.208052e-03 3 1  ON 53
ci_055                -2.426845e-03 3 1  ON 54
ci_056                 4.623981e-03 3 1  ON 55
ci_057                 4.639859e-03 3 1  ON 56
ci_058                -2.070626e-03 3 1  ON 57
ci_059                -2.053364e-03 3 1  ON 58
ci_060                 4.760645e-03 3 1  ON 59
ci_061                 5.206740e-03 3 1  ON 60
ci_062                -2.953745e-03 3 1  ON 61
ci_063                -2.807728e-03 3 1  ON 62
ci_064                -2.259141e-03 3 1  ON 63
ci_065                -3.382802e-03 3 1  ON 64
ci_066                 4.060412e-03 3 1  ON 65
ci_067                 4.226252e-03 3 1  ON 66
ci_068                -4.274512e-03 3 1  ON 67
ci_069                -4.110919e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8868e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.2249
    reference variance = 0.264412
====================================================
  Execution time = 1.3714e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5313e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0097e-01
  Total weights = 1.958015087e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287306956175
                                         uncertainty =       0.001688340291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287306956175
                                         uncertainty =       0.001688340291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378973210
  error estimate for blocks of size 2^( 2) =       0.000390360868
  error estimate for blocks of size 2^( 3) =       0.000401329885
  error estimate for blocks of size 2^( 4) =       0.000409045616
  error estimate for blocks of size 2^( 5) =       0.000414236007
  error estimate for blocks of size 2^( 6) =       0.000418178586
  error estimate for blocks of size 2^( 7) =       0.000420457310

      target function =      -0.911150509403
              le_mean =     -17.214885311393
             les_mean =     296.653245479412
             stat err =       0.000415479380
             autocorr =       1.201937619622
   target nu stat err =       0.000415479380
   target dn stat err =       0.002754453272
      target stat err =       0.004321033994
              std dev =       0.535949053661
             le_variance =       0.287241388121


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721488531139e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+02, overlap shift 8.6736e+03 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911170130647       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911170174857       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911170181979       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911170183580       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911170183690       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911170183638       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911170183659       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911170183660       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911170183658       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911170183657       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+02 is 1.523379e-07

solving harmonic davidson linear method for identity shift 3.4694e+03, overlap shift 3.4694e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911170130647       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911170141700       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911170143481       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911170143881       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911170143908       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911170143896       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911170143901       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911170143908       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911170143901       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911170143900       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+03 is 3.808670e-08

solving harmonic davidson linear method for identity shift 1.3878e+04, overlap shift 1.3878e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911170130647       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911170133410       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911170133855       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911170133955       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911170133962       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911170133964       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911170133968       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911170133940       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911170133974       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911170133926       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+04 is 9.521813e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.338672 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6194e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_001                -3.749559e-02 3 1  ON 0
ci_002                -2.874829e-02 3 1  ON 1
ci_003                -2.361783e-02 3 1  ON 2
ci_004                 2.083398e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849087e-02 3 1  ON 6
ci_008                -7.764092e-03 3 1  ON 7
ci_009                -1.387891e-02 3 1  ON 8
ci_010                -8.829260e-03 3 1  ON 9
ci_011                -8.959947e-03 3 1  ON 10
ci_012                -9.098924e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092238e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564652e-02 3 1  ON 16
ci_018                 9.100977e-03 3 1  ON 17
ci_019                 9.001149e-03 3 1  ON 18
ci_020                 1.504176e-02 3 1  ON 19
ci_021                 1.520376e-02 3 1  ON 20
ci_022                 8.270888e-03 3 1  ON 21
ci_023                 8.252594e-03 3 1  ON 22
ci_024                 8.336517e-03 3 1  ON 23
ci_025                 8.419969e-03 3 1  ON 24
ci_026                 9.900438e-03 3 1  ON 25
ci_027                 9.702759e-03 3 1  ON 26
ci_028                -1.453334e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756947e-03 3 1  ON 29
ci_031                -8.610838e-03 3 1  ON 30
ci_032                -1.432768e-02 3 1  ON 31
ci_033                 4.550057e-03 3 1  ON 32
ci_034                 4.834243e-03 3 1  ON 33
ci_035                -3.330939e-03 3 1  ON 34
ci_036                -1.121942e-02 3 1  ON 35
ci_037                -1.147549e-02 3 1  ON 36
ci_038                 8.690558e-04 3 1  ON 37
ci_039                 1.139688e-03 3 1  ON 38
ci_040                -1.555742e-03 3 1  ON 39
ci_041                 8.159871e-03 3 1  ON 40
ci_042                 8.160710e-03 3 1  ON 41
ci_043                -2.343101e-03 3 1  ON 42
ci_044                -3.907831e-03 3 1  ON 43
ci_045                -1.989374e-03 3 1  ON 44
ci_046                 4.783172e-03 3 1  ON 45
ci_047                 4.612314e-03 3 1  ON 46
ci_048                -1.237726e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845585e-03 3 1  ON 49
ci_051                 2.985847e-03 3 1  ON 50
ci_052                -2.175759e-03 3 1  ON 51
ci_053                -2.207817e-03 3 1  ON 52
ci_054                -2.208040e-03 3 1  ON 53
ci_055                -2.426852e-03 3 1  ON 54
ci_056                 4.623975e-03 3 1  ON 55
ci_057                 4.639875e-03 3 1  ON 56
ci_058                -2.070614e-03 3 1  ON 57
ci_059                -2.053359e-03 3 1  ON 58
ci_060                 4.760655e-03 3 1  ON 59
ci_061                 5.206732e-03 3 1  ON 60
ci_062                -2.953747e-03 3 1  ON 61
ci_063                -2.807728e-03 3 1  ON 62
ci_064                -2.259136e-03 3 1  ON 63
ci_065                -3.382797e-03 3 1  ON 64
ci_066                 4.060410e-03 3 1  ON 65
ci_067                 4.226255e-03 3 1  ON 66
ci_068                -4.274550e-03 3 1  ON 67
ci_069                -4.110920e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.2512
    reference variance = 0.185643
====================================================
  Execution time = 1.3307e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0546e-01
  Total weights = 1.9578e+06
  Execution time = 1.8086e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289027509101
                                         uncertainty =       0.002258711841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289027509101
                                         uncertainty =       0.002258711841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380118366
  error estimate for blocks of size 2^( 2) =       0.000391291379
  error estimate for blocks of size 2^( 3) =       0.000401790555
  error estimate for blocks of size 2^( 4) =       0.000409676631
  error estimate for blocks of size 2^( 5) =       0.000415239558
  error estimate for blocks of size 2^( 6) =       0.000415126391
  error estimate for blocks of size 2^( 7) =       0.000414825718

      target function =      -0.904227931649
              le_mean =     -17.215126583016
             les_mean =     296.666044102485
             stat err =       0.000413717075
             autocorr =       1.184593054766
   target nu stat err =       0.000413717075
   target dn stat err =       0.003488595424
      target stat err =       0.005365517096
              std dev =       0.537568548973
             le_variance =       0.288979944845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289027512053
                                         uncertainty =       0.002258715224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289027512053
                                         uncertainty =       0.002258715224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380118368
  error estimate for blocks of size 2^( 2) =       0.000391291385
  error estimate for blocks of size 2^( 3) =       0.000401790567
  error estimate for blocks of size 2^( 4) =       0.000409676650
  error estimate for blocks of size 2^( 5) =       0.000415239577
  error estimate for blocks of size 2^( 6) =       0.000415126413
  error estimate for blocks of size 2^( 7) =       0.000414825746

      target function =      -0.904227584827
              le_mean =     -17.215126584812
             les_mean =     296.666044391211
             stat err =       0.000413717097
             autocorr =       1.184593169245
   target nu stat err =       0.000413717097
   target dn stat err =       0.003488636852
      target stat err =       0.005365575682
              std dev =       0.537568551733
             le_variance =       0.288979947813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289027510576
                                         uncertainty =       0.002258713532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289027510576
                                         uncertainty =       0.002258713532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380118367
  error estimate for blocks of size 2^( 2) =       0.000391291382
  error estimate for blocks of size 2^( 3) =       0.000401790561
  error estimate for blocks of size 2^( 4) =       0.000409676641
  error estimate for blocks of size 2^( 5) =       0.000415239568
  error estimate for blocks of size 2^( 6) =       0.000415126402
  error estimate for blocks of size 2^( 7) =       0.000414825732

      target function =      -0.904227758470
              le_mean =     -17.215126583914
             les_mean =     296.666044246695
             stat err =       0.000413717086
             autocorr =       1.184593111988
   target nu stat err =       0.000413717086
   target dn stat err =       0.003488616138
      target stat err =       0.005365546391
              std dev =       0.537568550352
             le_variance =       0.288979946328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289027509285
                                         uncertainty =       0.002258712053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289027509285
                                         uncertainty =       0.002258712053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380118366
  error estimate for blocks of size 2^( 2) =       0.000391291379
  error estimate for blocks of size 2^( 3) =       0.000401790556
  error estimate for blocks of size 2^( 4) =       0.000409676632
  error estimate for blocks of size 2^( 5) =       0.000415239559
  error estimate for blocks of size 2^( 6) =       0.000415126392
  error estimate for blocks of size 2^( 7) =       0.000414825720

      target function =      -0.904227910027
              le_mean =     -17.215126583128
             les_mean =     296.666044120494
             stat err =       0.000413717076
             autocorr =       1.184593061921
   target nu stat err =       0.000413717076
   target dn stat err =       0.003488598013
      target stat err =       0.005365520758
              std dev =       0.537568549145
             le_variance =       0.288979945030


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904227931649        initial  <--
     8.6736e+02     8.6736e+03             1.5234e-07        -0.904227584827
     3.4694e+03     3.4694e+04             3.8087e-08        -0.904227758470
     1.3878e+04     1.3878e+05             9.5218e-09        -0.904227910027

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.4387
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126881e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764073e-03 3 1  ON 7
ci_009                -1.387890e-02 3 1  ON 8
ci_010                -8.829284e-03 3 1  ON 9
ci_011                -8.959961e-03 3 1  ON 10
ci_012                -9.098939e-03 3 1  ON 11
ci_013                -1.909113e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590826e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100982e-03 3 1  ON 17
ci_019                 9.001130e-03 3 1  ON 18
ci_020                 1.504176e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270880e-03 3 1  ON 21
ci_023                 8.252611e-03 3 1  ON 22
ci_024                 8.336511e-03 3 1  ON 23
ci_025                 8.419979e-03 3 1  ON 24
ci_026                 9.900452e-03 3 1  ON 25
ci_027                 9.702752e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756951e-03 3 1  ON 29
ci_031                -8.610837e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550061e-03 3 1  ON 32
ci_034                 4.834245e-03 3 1  ON 33
ci_035                -3.330946e-03 3 1  ON 34
ci_036                -1.121940e-02 3 1  ON 35
ci_037                -1.147551e-02 3 1  ON 36
ci_038                 8.690581e-04 3 1  ON 37
ci_039                 1.139690e-03 3 1  ON 38
ci_040                -1.555748e-03 3 1  ON 39
ci_041                 8.159893e-03 3 1  ON 40
ci_042                 8.160704e-03 3 1  ON 41
ci_043                -2.343101e-03 3 1  ON 42
ci_044                -3.907829e-03 3 1  ON 43
ci_045                -1.989376e-03 3 1  ON 44
ci_046                 4.783179e-03 3 1  ON 45
ci_047                 4.612304e-03 3 1  ON 46
ci_048                -1.237723e-02 3 1  ON 47
ci_049                -1.295228e-02 3 1  ON 48
ci_050                 2.845581e-03 3 1  ON 49
ci_051                 2.985874e-03 3 1  ON 50
ci_052                -2.175768e-03 3 1  ON 51
ci_053                -2.207813e-03 3 1  ON 52
ci_054                -2.208052e-03 3 1  ON 53
ci_055                -2.426845e-03 3 1  ON 54
ci_056                 4.623981e-03 3 1  ON 55
ci_057                 4.639859e-03 3 1  ON 56
ci_058                -2.070626e-03 3 1  ON 57
ci_059                -2.053364e-03 3 1  ON 58
ci_060                 4.760645e-03 3 1  ON 59
ci_061                 5.206740e-03 3 1  ON 60
ci_062                -2.953745e-03 3 1  ON 61
ci_063                -2.807728e-03 3 1  ON 62
ci_064                -2.259141e-03 3 1  ON 63
ci_065                -3.382802e-03 3 1  ON 64
ci_066                 4.060412e-03 3 1  ON 65
ci_067                 4.226252e-03 3 1  ON 66
ci_068                -4.274512e-03 3 1  ON 67
ci_069                -4.110919e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8656e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.2435
    reference variance = 0.335311
====================================================
  Execution time = 1.3842e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5307e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0124e-01
  Total weights = 1.957838160e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4898e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288986943235
                                         uncertainty =       0.001983006087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288986943235
                                         uncertainty =       0.001983006087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380206838
  error estimate for blocks of size 2^( 2) =       0.000391668478
  error estimate for blocks of size 2^( 3) =       0.000402016406
  error estimate for blocks of size 2^( 4) =       0.000409935138
  error estimate for blocks of size 2^( 5) =       0.000414905125
  error estimate for blocks of size 2^( 6) =       0.000418420663
  error estimate for blocks of size 2^( 7) =       0.000421039154

      target function =      -0.910719207611
              le_mean =     -17.215278318818
             les_mean =     296.667048263217
             stat err =       0.000416075020
             autocorr =       1.197576976478
   target nu stat err =       0.000416075020
   target dn stat err =       0.002453635901
      target stat err =       0.003861866853
              std dev =       0.537693667251
             le_variance =       0.289114479802


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721527831882e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+03, overlap shift 8.6736e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910734629066       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910734634033       residual = 8.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910734634641       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910734634789       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910734634827       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910734634835       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910734634839       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910734634842       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910734634839       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910734634850       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+03 is 1.148239e-08

solving harmonic davidson linear method for identity shift 3.4694e+04, overlap shift 3.4694e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910734629066       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910734630308       residual = 8.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910734630460       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910734630499       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910734630506       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910734630509       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910734630461       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910734630419       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910734630559       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910734630515       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+04 is 2.870617e-09

solving harmonic davidson linear method for identity shift 1.3878e+05, overlap shift 1.3878e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910734629066       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910734629377       residual = 8.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910734629415       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910734629424       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910734629520       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910734629578       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910734629092       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910734629527       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910734629671       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910734629458       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+05 is 7.176556e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.342117 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6341e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126881e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764071e-03 3 1  ON 7
ci_009                -1.387889e-02 3 1  ON 8
ci_010                -8.829281e-03 3 1  ON 9
ci_011                -8.959959e-03 3 1  ON 10
ci_012                -9.098937e-03 3 1  ON 11
ci_013                -1.909113e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590826e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100983e-03 3 1  ON 17
ci_019                 9.001128e-03 3 1  ON 18
ci_020                 1.504176e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270879e-03 3 1  ON 21
ci_023                 8.252613e-03 3 1  ON 22
ci_024                 8.336510e-03 3 1  ON 23
ci_025                 8.419978e-03 3 1  ON 24
ci_026                 9.900449e-03 3 1  ON 25
ci_027                 9.702753e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756951e-03 3 1  ON 29
ci_031                -8.610838e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550062e-03 3 1  ON 32
ci_034                 4.834244e-03 3 1  ON 33
ci_035                -3.330945e-03 3 1  ON 34
ci_036                -1.121940e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690565e-04 3 1  ON 37
ci_039                 1.139690e-03 3 1  ON 38
ci_040                -1.555747e-03 3 1  ON 39
ci_041                 8.159896e-03 3 1  ON 40
ci_042                 8.160705e-03 3 1  ON 41
ci_043                -2.343101e-03 3 1  ON 42
ci_044                -3.907831e-03 3 1  ON 43
ci_045                -1.989376e-03 3 1  ON 44
ci_046                 4.783179e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237723e-02 3 1  ON 47
ci_049                -1.295228e-02 3 1  ON 48
ci_050                 2.845581e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175769e-03 3 1  ON 51
ci_053                -2.207811e-03 3 1  ON 52
ci_054                -2.208052e-03 3 1  ON 53
ci_055                -2.426846e-03 3 1  ON 54
ci_056                 4.623982e-03 3 1  ON 55
ci_057                 4.639858e-03 3 1  ON 56
ci_058                -2.070627e-03 3 1  ON 57
ci_059                -2.053363e-03 3 1  ON 58
ci_060                 4.760645e-03 3 1  ON 59
ci_061                 5.206737e-03 3 1  ON 60
ci_062                -2.953744e-03 3 1  ON 61
ci_063                -2.807727e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382803e-03 3 1  ON 64
ci_066                 4.060413e-03 3 1  ON 65
ci_067                 4.226250e-03 3 1  ON 66
ci_068                -4.274512e-03 3 1  ON 67
ci_069                -4.110921e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.1732
    reference variance = 0.138732
====================================================
  Execution time = 1.3415e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0101e-01
  Total weights = 1.9578e+06
  Execution time = 1.8085e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286139691408
                                         uncertainty =       0.001459208797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286139691408
                                         uncertainty =       0.001459208797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378265286
  error estimate for blocks of size 2^( 2) =       0.000389677016
  error estimate for blocks of size 2^( 3) =       0.000400009463
  error estimate for blocks of size 2^( 4) =       0.000407532735
  error estimate for blocks of size 2^( 5) =       0.000411944957
  error estimate for blocks of size 2^( 6) =       0.000415165269
  error estimate for blocks of size 2^( 7) =       0.000416421865

      target function =      -0.911084953022
              le_mean =     -17.214535051540
             les_mean =     296.641231071447
             stat err =       0.000412766206
             autocorr =       1.190735475404
   target nu stat err =       0.000412766206
   target dn stat err =       0.003343241402
      target stat err =       0.005217456427
              std dev =       0.534947897954
             le_variance =       0.286169253525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286139688534
                                         uncertainty =       0.001459208595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286139688534
                                         uncertainty =       0.001459208595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378265284
  error estimate for blocks of size 2^( 2) =       0.000389677015
  error estimate for blocks of size 2^( 3) =       0.000400009463
  error estimate for blocks of size 2^( 4) =       0.000407532735
  error estimate for blocks of size 2^( 5) =       0.000411944958
  error estimate for blocks of size 2^( 6) =       0.000415165270
  error estimate for blocks of size 2^( 7) =       0.000416421867

      target function =      -0.911084977686
              le_mean =     -17.214535051683
             les_mean =     296.641231060494
             stat err =       0.000412766208
             autocorr =       1.190735494976
   target nu stat err =       0.000412766208
   target dn stat err =       0.003343236018
      target stat err =       0.005217448457
              std dev =       0.534947895282
             le_variance =       0.286169250667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286139689971
                                         uncertainty =       0.001459208696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286139689971
                                         uncertainty =       0.001459208696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378265285
  error estimate for blocks of size 2^( 2) =       0.000389677015
  error estimate for blocks of size 2^( 3) =       0.000400009463
  error estimate for blocks of size 2^( 4) =       0.000407532735
  error estimate for blocks of size 2^( 5) =       0.000411944957
  error estimate for blocks of size 2^( 6) =       0.000415165269
  error estimate for blocks of size 2^( 7) =       0.000416421866

      target function =      -0.911084965355
              le_mean =     -17.214535051611
             les_mean =     296.641231065970
             stat err =       0.000412766207
             autocorr =       1.190735485199
   target nu stat err =       0.000412766207
   target dn stat err =       0.003343238710
      target stat err =       0.005217452442
              std dev =       0.534947896618
             le_variance =       0.286169252096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286139691229
                                         uncertainty =       0.001459208784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286139691229
                                         uncertainty =       0.001459208784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378265286
  error estimate for blocks of size 2^( 2) =       0.000389677016
  error estimate for blocks of size 2^( 3) =       0.000400009463
  error estimate for blocks of size 2^( 4) =       0.000407532735
  error estimate for blocks of size 2^( 5) =       0.000411944957
  error estimate for blocks of size 2^( 6) =       0.000415165269
  error estimate for blocks of size 2^( 7) =       0.000416421865

      target function =      -0.911084954563
              le_mean =     -17.214535051549
             les_mean =     296.641231070762
             stat err =       0.000412766206
             autocorr =       1.190735476633
   target nu stat err =       0.000412766206
   target dn stat err =       0.003343241065
      target stat err =       0.005217455929
              std dev =       0.534947897787
             le_variance =       0.286169253346


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911084953022        initial
     8.6736e+03     8.6736e+04             1.1482e-08        -0.911084977686  <--
     3.4694e+04     3.4694e+05             2.8706e-09        -0.911084965355
     1.3878e+05     1.3878e+06             7.1766e-10        -0.911084954563

*****************************************************************************
Applying the update for shift_i =   8.6736e+03     and shift_s =   8.6736e+04
*****************************************************************************

  Execution time = 2.2536e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764066e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100986e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336509e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900441e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610840e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550067e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330944e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690515e-04 3 1  ON 37
ci_039                 1.139692e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159902e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907836e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845581e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274511e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8883e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.2056
    reference variance = 0.161215
====================================================
  Execution time = 1.6057e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5303e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9682e-01
  Total weights = 1.957819829e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4869e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286065101296
                                         uncertainty =       0.001616943377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286065101296
                                         uncertainty =       0.001616943377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378190552
  error estimate for blocks of size 2^( 2) =       0.000389950433
  error estimate for blocks of size 2^( 3) =       0.000400336780
  error estimate for blocks of size 2^( 4) =       0.000407781756
  error estimate for blocks of size 2^( 5) =       0.000412047555
  error estimate for blocks of size 2^( 6) =       0.000414102700
  error estimate for blocks of size 2^( 7) =       0.000415192163

      target function =      -0.917658692990
              le_mean =     -17.213951389202
             les_mean =     296.616937648547
             stat err =       0.000412281043
             autocorr =       1.188407498711
   target nu stat err =       0.000412281043
   target dn stat err =       0.001938924372
      target stat err =       0.003119037735
              std dev =       0.534842207536
             le_variance =       0.286056186962


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721395138920e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+03, overlap shift 2.1684e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917668352046       residual = 6.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917668363548       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917668364757       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917668365316       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917668365428       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917668365414       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917668365404       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917668365403       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917668365411       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+03 is 5.450700e-08

solving harmonic davidson linear method for identity shift 8.6736e+03, overlap shift 8.6736e+04 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917668352046       residual = 6.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917668354922       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917668355224       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917668355364       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917668355387       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917668355371       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917668355394       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917668355389       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917668355384       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+03 is 1.362710e-08

solving harmonic davidson linear method for identity shift 3.4694e+04, overlap shift 3.4694e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917668352046       residual = 6.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917668352765       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917668352841       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917668352876       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917668352925       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917668352893       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917668352901       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917668352901       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917668352929       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+04 is 3.406797e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.345162 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8553e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_001                -3.749560e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361785e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839598e-02 3 1  ON 5
ci_007                -1.849088e-02 3 1  ON 6
ci_008                -7.764066e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829267e-03 3 1  ON 9
ci_011                -8.959954e-03 3 1  ON 10
ci_012                -9.098927e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111279e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100989e-03 3 1  ON 17
ci_019                 9.001133e-03 3 1  ON 18
ci_020                 1.504176e-02 3 1  ON 19
ci_021                 1.520373e-02 3 1  ON 20
ci_022                 8.270881e-03 3 1  ON 21
ci_023                 8.252621e-03 3 1  ON 22
ci_024                 8.336506e-03 3 1  ON 23
ci_025                 8.419972e-03 3 1  ON 24
ci_026                 9.900439e-03 3 1  ON 25
ci_027                 9.702753e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756944e-03 3 1  ON 29
ci_031                -8.610846e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834248e-03 3 1  ON 33
ci_035                -3.330944e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147551e-02 3 1  ON 36
ci_038                 8.690547e-04 3 1  ON 37
ci_039                 1.139689e-03 3 1  ON 38
ci_040                -1.555746e-03 3 1  ON 39
ci_041                 8.159892e-03 3 1  ON 40
ci_042                 8.160705e-03 3 1  ON 41
ci_043                -2.343095e-03 3 1  ON 42
ci_044                -3.907832e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783179e-03 3 1  ON 45
ci_047                 4.612306e-03 3 1  ON 46
ci_048                -1.237723e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845582e-03 3 1  ON 49
ci_051                 2.985871e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207814e-03 3 1  ON 52
ci_054                -2.208050e-03 3 1  ON 53
ci_055                -2.426848e-03 3 1  ON 54
ci_056                 4.623980e-03 3 1  ON 55
ci_057                 4.639854e-03 3 1  ON 56
ci_058                -2.070624e-03 3 1  ON 57
ci_059                -2.053357e-03 3 1  ON 58
ci_060                 4.760641e-03 3 1  ON 59
ci_061                 5.206728e-03 3 1  ON 60
ci_062                -2.953741e-03 3 1  ON 61
ci_063                -2.807726e-03 3 1  ON 62
ci_064                -2.259141e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060419e-03 3 1  ON 65
ci_067                 4.226239e-03 3 1  ON 66
ci_068                -4.274505e-03 3 1  ON 67
ci_069                -4.110932e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.1995
    reference variance = 0.195066
====================================================
  Execution time = 1.3500e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9705e-01
  Total weights = 1.9577e+06
  Execution time = 1.8085e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285343396771
                                         uncertainty =       0.001608985460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285343396771
                                         uncertainty =       0.001608985460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377699981
  error estimate for blocks of size 2^( 2) =       0.000389034803
  error estimate for blocks of size 2^( 3) =       0.000399284377
  error estimate for blocks of size 2^( 4) =       0.000406795307
  error estimate for blocks of size 2^( 5) =       0.000411844244
  error estimate for blocks of size 2^( 6) =       0.000415109771
  error estimate for blocks of size 2^( 7) =       0.000418715691

      target function =      -0.917254626469
              le_mean =     -17.214925232225
             les_mean =     296.650703593579
             stat err =       0.000413116253
             autocorr =       1.196329017363
   target nu stat err =       0.000413116253
   target dn stat err =       0.002491690936
      target stat err =       0.003971795647
              std dev =       0.534148436182
             le_variance =       0.285314551876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285343391840
                                         uncertainty =       0.001608985900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285343391840
                                         uncertainty =       0.001608985900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377699978
  error estimate for blocks of size 2^( 2) =       0.000389034801
  error estimate for blocks of size 2^( 3) =       0.000399284376
  error estimate for blocks of size 2^( 4) =       0.000406795309
  error estimate for blocks of size 2^( 5) =       0.000411844246
  error estimate for blocks of size 2^( 6) =       0.000415109772
  error estimate for blocks of size 2^( 7) =       0.000418715697

      target function =      -0.917254598477
              le_mean =     -17.214925231963
             les_mean =     296.650703602395
             stat err =       0.000413116256
             autocorr =       1.196329053480
   target nu stat err =       0.000413116256
   target dn stat err =       0.002491690714
      target stat err =       0.003971795066
              std dev =       0.534148431574
             le_variance =       0.285314546953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285343394305
                                         uncertainty =       0.001608985680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285343394305
                                         uncertainty =       0.001608985680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377699980
  error estimate for blocks of size 2^( 2) =       0.000389034802
  error estimate for blocks of size 2^( 3) =       0.000399284377
  error estimate for blocks of size 2^( 4) =       0.000406795308
  error estimate for blocks of size 2^( 5) =       0.000411844245
  error estimate for blocks of size 2^( 6) =       0.000415109772
  error estimate for blocks of size 2^( 7) =       0.000418715694

      target function =      -0.917254612539
              le_mean =     -17.214925232094
             les_mean =     296.650703597944
             stat err =       0.000413116255
             autocorr =       1.196329035420
   target nu stat err =       0.000413116255
   target dn stat err =       0.002491690825
      target stat err =       0.003971795357
              std dev =       0.534148433878
             le_variance =       0.285314549414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285343396463
                                         uncertainty =       0.001608985488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285343396463
                                         uncertainty =       0.001608985488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377699981
  error estimate for blocks of size 2^( 2) =       0.000389034803
  error estimate for blocks of size 2^( 3) =       0.000399284377
  error estimate for blocks of size 2^( 4) =       0.000406795307
  error estimate for blocks of size 2^( 5) =       0.000411844244
  error estimate for blocks of size 2^( 6) =       0.000415109771
  error estimate for blocks of size 2^( 7) =       0.000418715692

      target function =      -0.917254624735
              le_mean =     -17.214925232209
             les_mean =     296.650703594120
             stat err =       0.000413116253
             autocorr =       1.196329019617
   target nu stat err =       0.000413116253
   target dn stat err =       0.002491690922
      target stat err =       0.003971795611
              std dev =       0.534148435894
             le_variance =       0.285314551568


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917254626469        initial  <--
     2.1684e+03     2.1684e+04             5.4507e-08        -0.917254598477
     8.6736e+03     8.6736e+04             1.3627e-08        -0.917254612539
     3.4694e+04     3.4694e+05             3.4068e-09        -0.917254624735

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6342
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764066e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100986e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336509e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900441e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610840e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550067e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330944e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690515e-04 3 1  ON 37
ci_039                 1.139692e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159902e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907836e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845581e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274511e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1193e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.2264
    reference variance = 0.255018
====================================================
  Execution time = 1.3884e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5303e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0579e-01
  Total weights = 1.957494355e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5170e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289795011444
                                         uncertainty =       0.002188195611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289795011444
                                         uncertainty =       0.002188195611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380633520
  error estimate for blocks of size 2^( 2) =       0.000391857387
  error estimate for blocks of size 2^( 3) =       0.000402660849
  error estimate for blocks of size 2^( 4) =       0.000410343301
  error estimate for blocks of size 2^( 5) =       0.000415909706
  error estimate for blocks of size 2^( 6) =       0.000419228020
  error estimate for blocks of size 2^( 7) =       0.000419054199

      target function =      -0.903721546827
              le_mean =     -17.214894007127
             les_mean =     296.658366170296
             stat err =       0.000416133806
             autocorr =       1.195231239238
   target nu stat err =       0.000416133806
   target dn stat err =       0.004287444245
      target stat err =       0.006565672509
              std dev =       0.538297086095
             le_variance =       0.289763752899


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721489400713e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+04, overlap shift 2.1684e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903768303869       residual = 4.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903768310835       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903768311264       residual = 6.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903768311382       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903768311387       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903768311405       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903768311398       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903768311425       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903768311414       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903768311419       residual = 8.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+04 is 9.628873e-09

solving harmonic davidson linear method for identity shift 8.6736e+04, overlap shift 8.6736e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903768303869       residual = 4.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903768305611       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903768305718       residual = 6.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903768305805       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903768305750       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903768305570       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903768305904       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903768305690       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903768305509       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903768305763       residual = 8.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+04 is 2.407224e-09

solving harmonic davidson linear method for identity shift 3.4694e+05, overlap shift 3.4694e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903768303869       residual = 4.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903768304305       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903768304332       residual = 6.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903768304339       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903768304370       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903768303888       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903768303864       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903768304272       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903768304341       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903768304705       residual = 8.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+05 is 6.018064e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.348674 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6410e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387889e-02 3 1  ON 8
ci_010                -8.829271e-03 3 1  ON 9
ci_011                -8.959954e-03 3 1  ON 10
ci_012                -9.098931e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100986e-03 3 1  ON 17
ci_019                 9.001123e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270878e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336510e-03 3 1  ON 23
ci_025                 8.419975e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610838e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550067e-03 3 1  ON 32
ci_034                 4.834239e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690504e-04 3 1  ON 37
ci_039                 1.139692e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159902e-03 3 1  ON 40
ci_042                 8.160709e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907836e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612306e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295228e-02 3 1  ON 48
ci_050                 2.845581e-03 3 1  ON 49
ci_051                 2.985872e-03 3 1  ON 50
ci_052                -2.175770e-03 3 1  ON 51
ci_053                -2.207809e-03 3 1  ON 52
ci_054                -2.208052e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070629e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206728e-03 3 1  ON 60
ci_062                -2.953741e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226241e-03 3 1  ON 66
ci_068                -4.274512e-03 3 1  ON 67
ci_069                -4.110929e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.2172
    reference variance = 0.23699
====================================================
  Execution time = 1.3753e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0485e-01
  Total weights = 1.9575e+06
  Execution time = 1.8104e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289294857004
                                         uncertainty =       0.002371671926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289294857004
                                         uncertainty =       0.002371671926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380298996
  error estimate for blocks of size 2^( 2) =       0.000391651557
  error estimate for blocks of size 2^( 3) =       0.000402109120
  error estimate for blocks of size 2^( 4) =       0.000410797897
  error estimate for blocks of size 2^( 5) =       0.000416098249
  error estimate for blocks of size 2^( 6) =       0.000418850609
  error estimate for blocks of size 2^( 7) =       0.000419312207

      target function =      -0.905175768000
              le_mean =     -17.214565296523
             les_mean =     296.646108596102
             stat err =       0.000416264741
             autocorr =       1.198088486843
   target nu stat err =       0.000416264741
   target dn stat err =       0.004072302480
      target stat err =       0.006256197074
              std dev =       0.537823997366
             le_variance =       0.289254652143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289294855597
                                         uncertainty =       0.002371671631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289294855597
                                         uncertainty =       0.002371671631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380298995
  error estimate for blocks of size 2^( 2) =       0.000391651557
  error estimate for blocks of size 2^( 3) =       0.000402109120
  error estimate for blocks of size 2^( 4) =       0.000410797898
  error estimate for blocks of size 2^( 5) =       0.000416098250
  error estimate for blocks of size 2^( 6) =       0.000418850610
  error estimate for blocks of size 2^( 7) =       0.000419312207

      target function =      -0.905175743254
              le_mean =     -17.214565296571
             les_mean =     296.646108613994
             stat err =       0.000416264741
             autocorr =       1.198088495791
   target nu stat err =       0.000416264741
   target dn stat err =       0.004072301663
      target stat err =       0.006256195496
              std dev =       0.537823996060
             le_variance =       0.289254650738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289294856301
                                         uncertainty =       0.002371671779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289294856301
                                         uncertainty =       0.002371671779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380298995
  error estimate for blocks of size 2^( 2) =       0.000391651557
  error estimate for blocks of size 2^( 3) =       0.000402109120
  error estimate for blocks of size 2^( 4) =       0.000410797897
  error estimate for blocks of size 2^( 5) =       0.000416098250
  error estimate for blocks of size 2^( 6) =       0.000418850609
  error estimate for blocks of size 2^( 7) =       0.000419312207

      target function =      -0.905175755628
              le_mean =     -17.214565296547
             les_mean =     296.646108605047
             stat err =       0.000416264741
             autocorr =       1.198088491313
   target nu stat err =       0.000416264741
   target dn stat err =       0.004072302071
      target stat err =       0.006256196285
              std dev =       0.537823996713
             le_variance =       0.289254651440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289294856916
                                         uncertainty =       0.002371671908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289294856916
                                         uncertainty =       0.002371671908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380298996
  error estimate for blocks of size 2^( 2) =       0.000391651557
  error estimate for blocks of size 2^( 3) =       0.000402109120
  error estimate for blocks of size 2^( 4) =       0.000410797897
  error estimate for blocks of size 2^( 5) =       0.000416098249
  error estimate for blocks of size 2^( 6) =       0.000418850609
  error estimate for blocks of size 2^( 7) =       0.000419312207

      target function =      -0.905175766453
              le_mean =     -17.214565296526
             les_mean =     296.646108597220
             stat err =       0.000416264741
             autocorr =       1.198088487402
   target nu stat err =       0.000416264741
   target dn stat err =       0.004072302429
      target stat err =       0.006256196976
              std dev =       0.537823997284
             le_variance =       0.289254652055


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.905175768000        initial  <--
     2.1684e+04     2.1684e+05             9.6289e-09        -0.905175743254
     8.6736e+04     8.6736e+05             2.4072e-09        -0.905175755628
     3.4694e+05     3.4694e+06             6.0181e-10        -0.905175766453

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9149
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764066e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100986e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336509e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900441e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610840e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550067e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330944e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690515e-04 3 1  ON 37
ci_039                 1.139692e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159902e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907836e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845581e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274511e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9335e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.1846
    reference variance = 0.294497
====================================================
  Execution time = 1.3963e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0144e-01
  Total weights = 1.957762273e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287422096105
                                         uncertainty =       0.001639935005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287422096105
                                         uncertainty =       0.001639935005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379140841
  error estimate for blocks of size 2^( 2) =       0.000390533762
  error estimate for blocks of size 2^( 3) =       0.000401045584
  error estimate for blocks of size 2^( 4) =       0.000408689158
  error estimate for blocks of size 2^( 5) =       0.000413257392
  error estimate for blocks of size 2^( 6) =       0.000415056094
  error estimate for blocks of size 2^( 7) =       0.000414586786

      target function =      -0.910462845748
              le_mean =     -17.213462846836
             les_mean =     296.604748125618
             stat err =       0.000412897358
             autocorr =       1.185995573250
   target nu stat err =       0.000412897358
   target dn stat err =       0.003082960231
      target stat err =       0.004802795464
              std dev =       0.536186119913
             le_variance =       0.287495555188


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721346284684e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+05, overlap shift 2.1684e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910487247249       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910487247520       residual = 9.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910487247544       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910487247553       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910487247553       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910487247554       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910487247554       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910487247554       residual = 8.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910487246843       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910487247554       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+05 is 6.024026e-10

solving harmonic davidson linear method for identity shift 8.6736e+05, overlap shift 8.6736e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910487247249       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910487247317       residual = 9.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910487247323       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910487247311       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910487247325       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910487247325       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910487247325       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910487247325       residual = 8.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910487247325       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910487246941       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+05 is 1.506007e-10

solving harmonic davidson linear method for identity shift 3.4694e+06, overlap shift 3.4694e+07 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910487247249       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910487247266       residual = 9.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910487247268       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910487248688       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910487249508       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910487247268       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910487247268       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910487248297       residual = 8.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910487237873       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910487246228       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+06 is 3.765016e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.352128 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6435e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764066e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100986e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900441e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610840e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550067e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330944e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690515e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159902e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907836e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845581e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274511e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.1209
    reference variance = 0.393741
====================================================
  Execution time = 1.3907e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9956e-01
  Total weights = 1.9580e+06
  Execution time = 1.8106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286952555766
                                         uncertainty =       0.002005008534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286952555766
                                         uncertainty =       0.002005008534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378888786
  error estimate for blocks of size 2^( 2) =       0.000390118866
  error estimate for blocks of size 2^( 3) =       0.000400534461
  error estimate for blocks of size 2^( 4) =       0.000408531714
  error estimate for blocks of size 2^( 5) =       0.000413098980
  error estimate for blocks of size 2^( 6) =       0.000415648801
  error estimate for blocks of size 2^( 7) =       0.000415194417

      target function =      -0.913341978816
              le_mean =     -17.214732906773
             les_mean =     296.646586484661
             stat err =       0.000413118478
             autocorr =       1.188846372827
   target nu stat err =       0.000413118478
   target dn stat err =       0.003001482575
      target stat err =       0.004719090308
              std dev =       0.535829660329
             le_variance =       0.287113424889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286952555623
                                         uncertainty =       0.002005008511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286952555623
                                         uncertainty =       0.002005008511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378888786
  error estimate for blocks of size 2^( 2) =       0.000390118866
  error estimate for blocks of size 2^( 3) =       0.000400534461
  error estimate for blocks of size 2^( 4) =       0.000408531714
  error estimate for blocks of size 2^( 5) =       0.000413098980
  error estimate for blocks of size 2^( 6) =       0.000415648801
  error estimate for blocks of size 2^( 7) =       0.000415194416

      target function =      -0.913341978448
              le_mean =     -17.214732906771
             les_mean =     296.646586484857
             stat err =       0.000413118478
             autocorr =       1.188846373307
   target nu stat err =       0.000413118478
   target dn stat err =       0.003001482614
      target stat err =       0.004719090364
              std dev =       0.535829660193
             le_variance =       0.287113424742

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286952555695
                                         uncertainty =       0.002005008523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286952555695
                                         uncertainty =       0.002005008523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378888786
  error estimate for blocks of size 2^( 2) =       0.000390118866
  error estimate for blocks of size 2^( 3) =       0.000400534461
  error estimate for blocks of size 2^( 4) =       0.000408531714
  error estimate for blocks of size 2^( 5) =       0.000413098980
  error estimate for blocks of size 2^( 6) =       0.000415648801
  error estimate for blocks of size 2^( 7) =       0.000415194416

      target function =      -0.913341978632
              le_mean =     -17.214732906772
             les_mean =     296.646586484759
             stat err =       0.000413118478
             autocorr =       1.188846373064
   target nu stat err =       0.000413118478
   target dn stat err =       0.003001482595
      target stat err =       0.004719090336
              std dev =       0.535829660261
             le_variance =       0.287113424816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286952555757
                                         uncertainty =       0.002005008532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286952555757
                                         uncertainty =       0.002005008532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378888786
  error estimate for blocks of size 2^( 2) =       0.000390118866
  error estimate for blocks of size 2^( 3) =       0.000400534461
  error estimate for blocks of size 2^( 4) =       0.000408531714
  error estimate for blocks of size 2^( 5) =       0.000413098980
  error estimate for blocks of size 2^( 6) =       0.000415648801
  error estimate for blocks of size 2^( 7) =       0.000415194417

      target function =      -0.913341978793
              le_mean =     -17.214732906773
             les_mean =     296.646586484673
             stat err =       0.000413118478
             autocorr =       1.188846372860
   target nu stat err =       0.000413118478
   target dn stat err =       0.003001482578
      target stat err =       0.004719090312
              std dev =       0.535829660321
             le_variance =       0.287113424880


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913341978816        initial  <--
     2.1684e+05     2.1684e+06             6.0240e-10        -0.913341978448
     8.6736e+05     8.6736e+06             1.5060e-10        -0.913341978632
     3.4694e+06     3.4694e+07             3.7650e-11        -0.913341978793

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1802
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764066e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100986e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336509e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900441e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610840e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550067e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330944e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690515e-04 3 1  ON 37
ci_039                 1.139692e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159902e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907836e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845581e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274511e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9623e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.2536
    reference variance = 0.32856
====================================================
  Execution time = 1.3836e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9803e-01
  Total weights = 1.958038643e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5037e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285142279945
                                         uncertainty =       0.001520767494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285142279945
                                         uncertainty =       0.001520767494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377688209
  error estimate for blocks of size 2^( 2) =       0.000389058864
  error estimate for blocks of size 2^( 3) =       0.000399525407
  error estimate for blocks of size 2^( 4) =       0.000406710350
  error estimate for blocks of size 2^( 5) =       0.000412361370
  error estimate for blocks of size 2^( 6) =       0.000414487612
  error estimate for blocks of size 2^( 7) =       0.000416593473

      target function =      -0.915741440493
              le_mean =     -17.214225565815
             les_mean =     296.627596582507
             stat err =       0.000412538201
             autocorr =       1.193057807056
   target nu stat err =       0.000412538201
   target dn stat err =       0.002172954749
      target stat err =       0.003464960564
              std dev =       0.534131788110
             le_variance =       0.285296767069


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721422556581e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+06, overlap shift 2.1684e+07 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915753631548       residual = 7.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915753631562       residual = 6.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915753631564       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915753631565       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915753631565       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915753631565       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915753631565       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915753631565       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915753628187       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915753631565       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+06 is 5.794340e-11

solving harmonic davidson linear method for identity shift 8.6736e+06, overlap shift 8.6736e+07 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915753631548       residual = 7.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915753631551       residual = 6.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915753631552       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915753631552       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915753631552       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915753631552       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915753631552       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915753619955       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915753631552       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915753626329       residual = 2.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+06 is 1.448589e-11

solving harmonic davidson linear method for identity shift 3.4694e+07, overlap shift 3.4694e+08 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915753631548       residual = 7.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915753631548       residual = 6.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915753631549       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915753631549       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915753627822       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915753631549       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915753616588       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915753631549       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915753662580       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915753660115       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+07 is 3.621457e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.355652 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6350e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764066e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100986e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336509e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900441e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610840e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550067e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330944e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690515e-04 3 1  ON 37
ci_039                 1.139692e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159902e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907836e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845581e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274511e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.1492
    reference variance = 0.833274
====================================================
  Execution time = 1.3553e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0186e-01
  Total weights = 1.9575e+06
  Execution time = 1.8079e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287876992121
                                         uncertainty =       0.001738534599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287876992121
                                         uncertainty =       0.001738534599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379439912
  error estimate for blocks of size 2^( 2) =       0.000390642083
  error estimate for blocks of size 2^( 3) =       0.000401069434
  error estimate for blocks of size 2^( 4) =       0.000408992133
  error estimate for blocks of size 2^( 5) =       0.000413829160
  error estimate for blocks of size 2^( 6) =       0.000416560363
  error estimate for blocks of size 2^( 7) =       0.000415484752

      target function =      -0.909777569059
              le_mean =     -17.215052332024
             les_mean =     296.659883112383
             stat err =       0.000413716602
             autocorr =       1.188830331361
   target nu stat err =       0.000413716602
   target dn stat err =       0.002408101774
      target stat err =       0.003782577838
              std dev =       0.536609069142
             le_variance =       0.287949293085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287876992121
                                         uncertainty =       0.001738534599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287876992121
                                         uncertainty =       0.001738534599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379439912
  error estimate for blocks of size 2^( 2) =       0.000390642083
  error estimate for blocks of size 2^( 3) =       0.000401069434
  error estimate for blocks of size 2^( 4) =       0.000408992133
  error estimate for blocks of size 2^( 5) =       0.000413829160
  error estimate for blocks of size 2^( 6) =       0.000416560363
  error estimate for blocks of size 2^( 7) =       0.000415484752

      target function =      -0.909777569303
              le_mean =     -17.215052332023
             les_mean =     296.659883112216
             stat err =       0.000413716602
             autocorr =       1.188830331408
   target nu stat err =       0.000413716602
   target dn stat err =       0.002408101745
      target stat err =       0.003782577796
              std dev =       0.536609069140
             le_variance =       0.287949293084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287876992121
                                         uncertainty =       0.001738534599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287876992121
                                         uncertainty =       0.001738534599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379439912
  error estimate for blocks of size 2^( 2) =       0.000390642083
  error estimate for blocks of size 2^( 3) =       0.000401069434
  error estimate for blocks of size 2^( 4) =       0.000408992133
  error estimate for blocks of size 2^( 5) =       0.000413829160
  error estimate for blocks of size 2^( 6) =       0.000416560363
  error estimate for blocks of size 2^( 7) =       0.000415484752

      target function =      -0.909777569181
              le_mean =     -17.215052332023
             les_mean =     296.659883112299
             stat err =       0.000413716602
             autocorr =       1.188830331385
   target nu stat err =       0.000413716602
   target dn stat err =       0.002408101759
      target stat err =       0.003782577817
              std dev =       0.536609069141
             le_variance =       0.287949293085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287876992121
                                         uncertainty =       0.001738534599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287876992121
                                         uncertainty =       0.001738534599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379439912
  error estimate for blocks of size 2^( 2) =       0.000390642083
  error estimate for blocks of size 2^( 3) =       0.000401069434
  error estimate for blocks of size 2^( 4) =       0.000408992133
  error estimate for blocks of size 2^( 5) =       0.000413829160
  error estimate for blocks of size 2^( 6) =       0.000416560363
  error estimate for blocks of size 2^( 7) =       0.000415484752

      target function =      -0.909777569074
              le_mean =     -17.215052332024
             les_mean =     296.659883112372
             stat err =       0.000413716602
             autocorr =       1.188830331367
   target nu stat err =       0.000413716602
   target dn stat err =       0.002408101772
      target stat err =       0.003782577835
              std dev =       0.536609069141
             le_variance =       0.287949293085


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909777569059        initial
     2.1684e+06     2.1684e+07             5.7943e-11        -0.909777569303  <--
     8.6736e+06     8.6736e+07             1.4486e-11        -0.909777569181
     3.4694e+07     3.4694e+08             3.6215e-12        -0.909777569074

*****************************************************************************
Applying the update for shift_i =   2.1684e+06     and shift_s =   2.1684e+07
*****************************************************************************

  Execution time = 2.2701e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764066e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100986e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336509e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900441e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610840e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550067e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330944e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690515e-04 3 1  ON 37
ci_039                 1.139692e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159902e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907836e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845581e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274511e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9058e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.2449
    reference variance = 0.282286
====================================================
  Execution time = 1.3879e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9931e-01
  Total weights = 1.957756871e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4878e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287024138030
                                         uncertainty =       0.001940529703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287024138030
                                         uncertainty =       0.001940529703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378827248
  error estimate for blocks of size 2^( 2) =       0.000390353794
  error estimate for blocks of size 2^( 3) =       0.000401001659
  error estimate for blocks of size 2^( 4) =       0.000409196911
  error estimate for blocks of size 2^( 5) =       0.000413813980
  error estimate for blocks of size 2^( 6) =       0.000415601735
  error estimate for blocks of size 2^( 7) =       0.000415174963

      target function =      -0.913730256298
              le_mean =     -17.214917104325
             les_mean =     296.652680098119
             stat err =       0.000413446897
             autocorr =       1.191124218914
   target nu stat err =       0.000413446897
   target dn stat err =       0.002426974600
      target stat err =       0.003842780294
              std dev =       0.535742632543
             le_variance =       0.287020168324


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721491710432e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+05, overlap shift 5.4210e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913745543149       residual = 5.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913745543189       residual = 7.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913745543193       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913745543195       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913745543195       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913745543195       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913745544033       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913745543596       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913745543419       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913745543195       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+05 is 1.668139e-10

solving harmonic davidson linear method for identity shift 2.1684e+06, overlap shift 2.1684e+07 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913745543149       residual = 5.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913745543159       residual = 7.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913745543160       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913745543160       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913745543108       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913745543160       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913745543160       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913745543160       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913745543160       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913745543160       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+06 is 4.170347e-11

solving harmonic davidson linear method for identity shift 8.6736e+06, overlap shift 8.6736e+07 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913745543149       residual = 5.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913745543151       residual = 7.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913745543151       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913745543152       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913745543152       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913745557455       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913745542727       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913745543152       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913745543152       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913745518822       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+06 is 1.042588e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.359147 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6376e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764066e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100986e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336509e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900441e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610840e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550067e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330944e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690515e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159902e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907836e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845581e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274511e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.1496
    reference variance = 0.184456
====================================================
  Execution time = 1.3419e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9748e-01
  Total weights = 1.9575e+06
  Execution time = 1.8088e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285852875843
                                         uncertainty =       0.001542298854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285852875843
                                         uncertainty =       0.001542298854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378083470
  error estimate for blocks of size 2^( 2) =       0.000389863444
  error estimate for blocks of size 2^( 3) =       0.000400309591
  error estimate for blocks of size 2^( 4) =       0.000408456446
  error estimate for blocks of size 2^( 5) =       0.000412541051
  error estimate for blocks of size 2^( 6) =       0.000414686128
  error estimate for blocks of size 2^( 7) =       0.000415552484

      target function =      -0.916608740841
              le_mean =     -17.214365254792
             les_mean =     296.631850711344
             stat err =       0.000412809027
             autocorr =       1.192128279001
   target nu stat err =       0.000412809027
   target dn stat err =       0.001856873406
      target stat err =       0.002989767750
              std dev =       0.534690771395
             le_variance =       0.285894221015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285852875858
                                         uncertainty =       0.001542298856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285852875858
                                         uncertainty =       0.001542298856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378083470
  error estimate for blocks of size 2^( 2) =       0.000389863444
  error estimate for blocks of size 2^( 3) =       0.000400309591
  error estimate for blocks of size 2^( 4) =       0.000408456446
  error estimate for blocks of size 2^( 5) =       0.000412541051
  error estimate for blocks of size 2^( 6) =       0.000414686128
  error estimate for blocks of size 2^( 7) =       0.000415552484

      target function =      -0.916608741284
              le_mean =     -17.214365254792
             les_mean =     296.631850711062
             stat err =       0.000412809027
             autocorr =       1.192128279082
   target nu stat err =       0.000412809027
   target dn stat err =       0.001856873399
      target stat err =       0.002989767742
              std dev =       0.534690771408
             le_variance =       0.285894221029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285852875851
                                         uncertainty =       0.001542298855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285852875851
                                         uncertainty =       0.001542298855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378083470
  error estimate for blocks of size 2^( 2) =       0.000389863444
  error estimate for blocks of size 2^( 3) =       0.000400309591
  error estimate for blocks of size 2^( 4) =       0.000408456446
  error estimate for blocks of size 2^( 5) =       0.000412541051
  error estimate for blocks of size 2^( 6) =       0.000414686128
  error estimate for blocks of size 2^( 7) =       0.000415552484

      target function =      -0.916608741063
              le_mean =     -17.214365254792
             les_mean =     296.631850711203
             stat err =       0.000412809027
             autocorr =       1.192128279040
   target nu stat err =       0.000412809027
   target dn stat err =       0.001856873402
      target stat err =       0.002989767746
              std dev =       0.534690771401
             le_variance =       0.285894221022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285852875844
                                         uncertainty =       0.001542298854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285852875844
                                         uncertainty =       0.001542298854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378083470
  error estimate for blocks of size 2^( 2) =       0.000389863444
  error estimate for blocks of size 2^( 3) =       0.000400309591
  error estimate for blocks of size 2^( 4) =       0.000408456446
  error estimate for blocks of size 2^( 5) =       0.000412541051
  error estimate for blocks of size 2^( 6) =       0.000414686128
  error estimate for blocks of size 2^( 7) =       0.000415552484

      target function =      -0.916608740869
              le_mean =     -17.214365254792
             les_mean =     296.631850711326
             stat err =       0.000412809027
             autocorr =       1.192128278996
   target nu stat err =       0.000412809027
   target dn stat err =       0.001856873405
      target stat err =       0.002989767750
              std dev =       0.534690771395
             le_variance =       0.285894221015


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916608740841        initial
     5.4210e+05     5.4210e+06             1.6681e-10        -0.916608741284  <--
     2.1684e+06     2.1684e+07             4.1703e-11        -0.916608741063
     8.6736e+06     8.6736e+07             1.0426e-11        -0.916608740869

*****************************************************************************
Applying the update for shift_i =   5.4210e+05     and shift_s =   5.4210e+06
*****************************************************************************

  Execution time = 2.2822e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764066e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100986e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336509e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900441e-03 3 1  ON 25
ci_027                 9.702757e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610840e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550067e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330944e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690515e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159902e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907836e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845581e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274511e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9205e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.2463
    reference variance = 0.218658
====================================================
  Execution time = 1.3898e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0231e-01
  Total weights = 1.957432884e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5518e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288834226237
                                         uncertainty =       0.002998393551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288834226237
                                         uncertainty =       0.002998393551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380033769
  error estimate for blocks of size 2^( 2) =       0.000391028538
  error estimate for blocks of size 2^( 3) =       0.000401251667
  error estimate for blocks of size 2^( 4) =       0.000409270330
  error estimate for blocks of size 2^( 5) =       0.000414099633
  error estimate for blocks of size 2^( 6) =       0.000416034690
  error estimate for blocks of size 2^( 7) =       0.000418002983

      target function =      -0.909081072624
              le_mean =     -17.214538596447
             les_mean =     296.642644084666
             stat err =       0.000414351909
             autocorr =       1.188760349226
   target nu stat err =       0.000414351909
   target dn stat err =       0.003976204766
      target stat err =       0.006162246771
              std dev =       0.537448909650
             le_variance =       0.288851330484


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721453859645e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+05, overlap shift 1.3553e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909121672178       residual = 9.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909121672444       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909121672475       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909121672457       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909121672455       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909121672574       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909121672423       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909121672519       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909121672699       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909121672496       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+05 is 1.180326e-09

solving harmonic davidson linear method for identity shift 5.4210e+05, overlap shift 5.4210e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909121672178       residual = 9.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909121672244       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909121672252       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909121672256       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909121671680       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909121672241       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909121672799       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909121673011       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909121672100       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909121672323       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+05 is 2.950815e-10

solving harmonic davidson linear method for identity shift 2.1684e+06, overlap shift 2.1684e+07 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909121672178       residual = 9.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909121672195       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909121672197       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909121672198       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909121671890       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909121672134       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909121672312       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909121674637       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909121670998       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909121668444       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+06 is 7.377040e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.362603 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6462e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764066e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336509e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900441e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610840e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550067e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330944e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690515e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159902e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907836e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612306e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845581e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807724e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274511e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.1967
    reference variance = 0.190342
====================================================
  Execution time = 1.3525e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9780e-01
  Total weights = 1.9577e+06
  Execution time = 1.8262e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283423458889
                                         uncertainty =       0.001555399393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283423458889
                                         uncertainty =       0.001555399393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376445578
  error estimate for blocks of size 2^( 2) =       0.000387735386
  error estimate for blocks of size 2^( 3) =       0.000398503334
  error estimate for blocks of size 2^( 4) =       0.000406744735
  error estimate for blocks of size 2^( 5) =       0.000412131712
  error estimate for blocks of size 2^( 6) =       0.000414968483
  error estimate for blocks of size 2^( 7) =       0.000416988936

      target function =      -0.916097820608
              le_mean =     -17.214738530616
             les_mean =     296.645020179102
             stat err =       0.000412708466
             autocorr =       1.201938803852
   target nu stat err =       0.000412708466
   target dn stat err =       0.002155880214
      target stat err =       0.003444830120
              std dev =       0.532374441884
             le_variance =       0.283422546371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283423458905
                                         uncertainty =       0.001555399388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283423458905
                                         uncertainty =       0.001555399388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376445578
  error estimate for blocks of size 2^( 2) =       0.000387735386
  error estimate for blocks of size 2^( 3) =       0.000398503334
  error estimate for blocks of size 2^( 4) =       0.000406744735
  error estimate for blocks of size 2^( 5) =       0.000412131712
  error estimate for blocks of size 2^( 6) =       0.000414968483
  error estimate for blocks of size 2^( 7) =       0.000416988936

      target function =      -0.916097818242
              le_mean =     -17.214738530615
             les_mean =     296.645020180568
             stat err =       0.000412708466
             autocorr =       1.201938803774
   target nu stat err =       0.000412708466
   target dn stat err =       0.002155880287
      target stat err =       0.003444830215
              std dev =       0.532374441899
             le_variance =       0.283422546387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283423458897
                                         uncertainty =       0.001555399391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283423458897
                                         uncertainty =       0.001555399391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376445578
  error estimate for blocks of size 2^( 2) =       0.000387735386
  error estimate for blocks of size 2^( 3) =       0.000398503334
  error estimate for blocks of size 2^( 4) =       0.000406744735
  error estimate for blocks of size 2^( 5) =       0.000412131712
  error estimate for blocks of size 2^( 6) =       0.000414968483
  error estimate for blocks of size 2^( 7) =       0.000416988936

      target function =      -0.916097819425
              le_mean =     -17.214738530616
             les_mean =     296.645020179835
             stat err =       0.000412708466
             autocorr =       1.201938803809
   target nu stat err =       0.000412708466
   target dn stat err =       0.002155880250
      target stat err =       0.003444830168
              std dev =       0.532374441892
             le_variance =       0.283422546379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283423458890
                                         uncertainty =       0.001555399393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283423458890
                                         uncertainty =       0.001555399393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376445578
  error estimate for blocks of size 2^( 2) =       0.000387735386
  error estimate for blocks of size 2^( 3) =       0.000398503334
  error estimate for blocks of size 2^( 4) =       0.000406744735
  error estimate for blocks of size 2^( 5) =       0.000412131712
  error estimate for blocks of size 2^( 6) =       0.000414968483
  error estimate for blocks of size 2^( 7) =       0.000416988936

      target function =      -0.916097820460
              le_mean =     -17.214738530616
             les_mean =     296.645020179194
             stat err =       0.000412708466
             autocorr =       1.201938803849
   target nu stat err =       0.000412708466
   target dn stat err =       0.002155880218
      target stat err =       0.003444830126
              std dev =       0.532374441885
             le_variance =       0.283422546372


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916097820608        initial  <--
     1.3553e+05     1.3553e+06             1.1803e-09        -0.916097818242
     5.4210e+05     5.4210e+06             2.9508e-10        -0.916097819425
     2.1684e+06     2.1684e+07             7.3770e-11        -0.916097820460

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6528
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764066e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100986e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336509e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900441e-03 3 1  ON 25
ci_027                 9.702757e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610840e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550067e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330944e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690515e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159902e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907836e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845581e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274511e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9123e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.3183
    reference variance = 0.405796
====================================================
  Execution time = 1.3770e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0031e-01
  Total weights = 1.957367171e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4951e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286448401803
                                         uncertainty =       0.001744128730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286448401803
                                         uncertainty =       0.001744128730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378553523
  error estimate for blocks of size 2^( 2) =       0.000390034802
  error estimate for blocks of size 2^( 3) =       0.000400726292
  error estimate for blocks of size 2^( 4) =       0.000408077794
  error estimate for blocks of size 2^( 5) =       0.000413322779
  error estimate for blocks of size 2^( 6) =       0.000416022748
  error estimate for blocks of size 2^( 7) =       0.000416855131

      target function =      -0.912156344702
              le_mean =     -17.215436987184
             les_mean =     296.671582018732
             stat err =       0.000413569613
             autocorr =       1.193555611056
   target nu stat err =       0.000413569613
   target dn stat err =       0.002209678087
      target stat err =       0.003502410901
              std dev =       0.535355525805
             le_variance =       0.286605539010


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721543698718e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+06, overlap shift 1.3553e+07 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912168881020       residual = 9.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912168881048       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912168881054       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912168881055       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912168880970       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912168881055       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912168881335       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912168881365       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912168881143       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912168881128       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+06 is 1.156474e-10

solving harmonic davidson linear method for identity shift 5.4210e+06, overlap shift 5.4210e+07 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912168881020       residual = 9.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912168881027       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912168881028       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912168881340       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912168879750       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912168876937       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912168876269       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912168893122       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912168891464       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912168896899       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+06 is 2.891181e-11

solving harmonic davidson linear method for identity shift 2.1684e+07, overlap shift 2.1684e+08 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912168881020       residual = 9.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912168881022       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912168881022       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912168876526       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912168871190       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912168914100       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912168895219       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912168897255       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912168881022       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912168956245       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+07 is 7.227957e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.366063 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6275e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764066e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100986e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336509e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900441e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610840e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550067e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690515e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159902e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907836e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845581e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274511e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2329
    reference variance = 0.309485
====================================================
  Execution time = 1.3736e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9893e-01
  Total weights = 1.9575e+06
  Execution time = 1.8061e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287830171715
                                         uncertainty =       0.001460295172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287830171715
                                         uncertainty =       0.001460295172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379328021
  error estimate for blocks of size 2^( 2) =       0.000390598656
  error estimate for blocks of size 2^( 3) =       0.000400967912
  error estimate for blocks of size 2^( 4) =       0.000408390097
  error estimate for blocks of size 2^( 5) =       0.000412826805
  error estimate for blocks of size 2^( 6) =       0.000416292653
  error estimate for blocks of size 2^( 7) =       0.000417923109

      target function =      -0.914319884869
              le_mean =     -17.215009271060
             les_mean =     296.655476011443
             stat err =       0.000413858166
             autocorr =       1.190345970658
   target nu stat err =       0.000413858166
   target dn stat err =       0.002019669499
      target stat err =       0.003226378961
              std dev =       0.536450832484
             le_variance =       0.287779495672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287830171697
                                         uncertainty =       0.001460295170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287830171697
                                         uncertainty =       0.001460295170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379328021
  error estimate for blocks of size 2^( 2) =       0.000390598656
  error estimate for blocks of size 2^( 3) =       0.000400967912
  error estimate for blocks of size 2^( 4) =       0.000408390097
  error estimate for blocks of size 2^( 5) =       0.000412826805
  error estimate for blocks of size 2^( 6) =       0.000416292653
  error estimate for blocks of size 2^( 7) =       0.000417923109

      target function =      -0.914319884883
              le_mean =     -17.215009271060
             les_mean =     296.655476011457
             stat err =       0.000413858166
             autocorr =       1.190345970843
   target nu stat err =       0.000413858166
   target dn stat err =       0.002019669501
      target stat err =       0.003226378965
              std dev =       0.536450832467
             le_variance =       0.287779495654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287830171706
                                         uncertainty =       0.001460295171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287830171706
                                         uncertainty =       0.001460295171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379328021
  error estimate for blocks of size 2^( 2) =       0.000390598656
  error estimate for blocks of size 2^( 3) =       0.000400967912
  error estimate for blocks of size 2^( 4) =       0.000408390097
  error estimate for blocks of size 2^( 5) =       0.000412826805
  error estimate for blocks of size 2^( 6) =       0.000416292653
  error estimate for blocks of size 2^( 7) =       0.000417923109

      target function =      -0.914319884876
              le_mean =     -17.215009271060
             les_mean =     296.655476011450
             stat err =       0.000413858166
             autocorr =       1.190345970748
   target nu stat err =       0.000413858166
   target dn stat err =       0.002019669500
      target stat err =       0.003226378963
              std dev =       0.536450832475
             le_variance =       0.287779495663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287830171714
                                         uncertainty =       0.001460295171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287830171714
                                         uncertainty =       0.001460295171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379328021
  error estimate for blocks of size 2^( 2) =       0.000390598656
  error estimate for blocks of size 2^( 3) =       0.000400967912
  error estimate for blocks of size 2^( 4) =       0.000408390097
  error estimate for blocks of size 2^( 5) =       0.000412826805
  error estimate for blocks of size 2^( 6) =       0.000416292653
  error estimate for blocks of size 2^( 7) =       0.000417923109

      target function =      -0.914319884869
              le_mean =     -17.215009271060
             les_mean =     296.655476011444
             stat err =       0.000413858166
             autocorr =       1.190345970669
   target nu stat err =       0.000413858166
   target dn stat err =       0.002019669499
      target stat err =       0.003226378961
              std dev =       0.536450832483
             le_variance =       0.287779495671


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914319884869        initial
     1.3553e+06     1.3553e+07             1.1565e-10        -0.914319884883  <--
     5.4210e+06     5.4210e+07             2.8912e-11        -0.914319884876
     2.1684e+07     2.1684e+08             7.2280e-12        -0.914319884869

*****************************************************************************
Applying the update for shift_i =   1.3553e+06     and shift_s =   1.3553e+07
*****************************************************************************

  Execution time = 2.2880e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764066e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336509e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900441e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610840e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550067e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690515e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159902e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907836e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845581e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274511e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9176e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.1776
    reference variance = 0.374349
====================================================
  Execution time = 1.3895e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5315e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0379e-01
  Total weights = 1.957739116e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4861e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288105704929
                                         uncertainty =       0.002269819399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288105704929
                                         uncertainty =       0.002269819399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379580862
  error estimate for blocks of size 2^( 2) =       0.000391032252
  error estimate for blocks of size 2^( 3) =       0.000401659322
  error estimate for blocks of size 2^( 4) =       0.000409470072
  error estimate for blocks of size 2^( 5) =       0.000413541998
  error estimate for blocks of size 2^( 6) =       0.000415697909
  error estimate for blocks of size 2^( 7) =       0.000417158185

      target function =      -0.906792163363
              le_mean =     -17.215076994302
             les_mean =     296.662663812106
             stat err =       0.000413967041
             autocorr =       1.189386256235
   target nu stat err =       0.000413967041
   target dn stat err =       0.003264048078
      target stat err =       0.005054040368
              std dev =       0.536808402401
             le_variance =       0.288163260888


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721507699430e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+05, overlap shift 3.3881e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906819534064       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906819534227       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906819534250       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906819534256       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906819534285       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906819533751       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906819534027       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906819533894       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906819534257       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906819534497       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+05 is 4.640735e-10

solving harmonic davidson linear method for identity shift 1.3553e+06, overlap shift 1.3553e+07 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906819534064       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906819534105       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906819534111       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906819534112       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906819534112       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906819534112       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906819534654       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906819534089       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906819533756       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906819531389       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+06 is 1.160184e-10

solving harmonic davidson linear method for identity shift 5.4210e+06, overlap shift 5.4210e+07 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906819534064       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906819534074       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906819534076       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906819530553       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906819532325       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906819535713       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906819528732       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906819546246       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906819535301       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906819536363       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+06 is 2.900462e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.369685 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6391e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764066e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336509e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900441e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550067e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159902e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907836e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845581e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274511e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.2541
    reference variance = 0.776254
====================================================
  Execution time = 1.3751e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9718e-01
  Total weights = 1.9578e+06
  Execution time = 2.1247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285448571791
                                         uncertainty =       0.001462830023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285448571791
                                         uncertainty =       0.001462830023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377798522
  error estimate for blocks of size 2^( 2) =       0.000388977856
  error estimate for blocks of size 2^( 3) =       0.000399016522
  error estimate for blocks of size 2^( 4) =       0.000406685822
  error estimate for blocks of size 2^( 5) =       0.000410337446
  error estimate for blocks of size 2^( 6) =       0.000412151795
  error estimate for blocks of size 2^( 7) =       0.000415081119

      target function =      -0.917071243452
              le_mean =     -17.214386151195
             les_mean =     296.632272120282
             stat err =       0.000411064046
             autocorr =       1.183854900769
   target nu stat err =       0.000411064046
   target dn stat err =       0.002188246637
      target stat err =       0.003498816586
              std dev =       0.534287793000
             le_variance =       0.285463445748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285448571746
                                         uncertainty =       0.001462830021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285448571746
                                         uncertainty =       0.001462830021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377798522
  error estimate for blocks of size 2^( 2) =       0.000388977856
  error estimate for blocks of size 2^( 3) =       0.000399016522
  error estimate for blocks of size 2^( 4) =       0.000406685822
  error estimate for blocks of size 2^( 5) =       0.000410337446
  error estimate for blocks of size 2^( 6) =       0.000412151795
  error estimate for blocks of size 2^( 7) =       0.000415081119

      target function =      -0.917071243607
              le_mean =     -17.214386151197
             les_mean =     296.632272120266
             stat err =       0.000411064046
             autocorr =       1.183854901351
   target nu stat err =       0.000411064046
   target dn stat err =       0.002188246600
      target stat err =       0.003498816531
              std dev =       0.534287792957
             le_variance =       0.285463445703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285448571769
                                         uncertainty =       0.001462830022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285448571769
                                         uncertainty =       0.001462830022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377798522
  error estimate for blocks of size 2^( 2) =       0.000388977856
  error estimate for blocks of size 2^( 3) =       0.000399016522
  error estimate for blocks of size 2^( 4) =       0.000406685822
  error estimate for blocks of size 2^( 5) =       0.000410337446
  error estimate for blocks of size 2^( 6) =       0.000412151795
  error estimate for blocks of size 2^( 7) =       0.000415081119

      target function =      -0.917071243530
              le_mean =     -17.214386151196
             les_mean =     296.632272120274
             stat err =       0.000411064046
             autocorr =       1.183854901056
   target nu stat err =       0.000411064046
   target dn stat err =       0.002188246618
      target stat err =       0.003498816559
              std dev =       0.534287792978
             le_variance =       0.285463445726

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285448571788
                                         uncertainty =       0.001462830023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285448571788
                                         uncertainty =       0.001462830023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377798522
  error estimate for blocks of size 2^( 2) =       0.000388977856
  error estimate for blocks of size 2^( 3) =       0.000399016522
  error estimate for blocks of size 2^( 4) =       0.000406685822
  error estimate for blocks of size 2^( 5) =       0.000410337446
  error estimate for blocks of size 2^( 6) =       0.000412151795
  error estimate for blocks of size 2^( 7) =       0.000415081119

      target function =      -0.917071243462
              le_mean =     -17.214386151195
             les_mean =     296.632272120282
             stat err =       0.000411064046
             autocorr =       1.183854900818
   target nu stat err =       0.000411064046
   target dn stat err =       0.002188246634
      target stat err =       0.003498816583
              std dev =       0.534287792997
             le_variance =       0.285463445746


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917071243452        initial
     3.3881e+05     3.3881e+06             4.6407e-10        -0.917071243607  <--
     1.3553e+06     1.3553e+07             1.1602e-10        -0.917071243530
     5.4210e+06     5.4210e+07             2.9005e-11        -0.917071243462

*****************************************************************************
Applying the update for shift_i =   3.3881e+05     and shift_s =   3.3881e+06
*****************************************************************************

  Execution time = 2.5242e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1640e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.1813
    reference variance = 0.150305
====================================================
  Execution time = 1.4043e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0352e-01
  Total weights = 1.957730167e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4990e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289024749328
                                         uncertainty =       0.001535452589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289024749328
                                         uncertainty =       0.001535452589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380124333
  error estimate for blocks of size 2^( 2) =       0.000391468323
  error estimate for blocks of size 2^( 3) =       0.000401552132
  error estimate for blocks of size 2^( 4) =       0.000409574073
  error estimate for blocks of size 2^( 5) =       0.000413824113
  error estimate for blocks of size 2^( 6) =       0.000416270962
  error estimate for blocks of size 2^( 7) =       0.000418816777

      target function =      -0.907241706463
              le_mean =     -17.214305453293
             les_mean =     296.635836336509
             stat err =       0.000414621481
             autocorr =       1.189740528735
   target nu stat err =       0.000414621481
   target dn stat err =       0.002590628993
      target stat err =       0.004032147668
              std dev =       0.537576986657
             le_variance =       0.288989016584


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721430545329e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+04, overlap shift 8.4703e+05 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907258576700       residual = 7.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907258577017       residual = 8.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907258577065       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907258577083       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907258577008       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907258577020       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907258577102       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907258576983       residual = 8.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907258577018       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907258577157       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+04 is 1.346652e-09

solving harmonic davidson linear method for identity shift 3.3881e+05, overlap shift 3.3881e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907258576700       residual = 7.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907258576779       residual = 8.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907258576791       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907258576795       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907258576712       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907258576534       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907258577037       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907258576744       residual = 8.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907258576753       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907258577046       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+05 is 3.366633e-10

solving harmonic davidson linear method for identity shift 1.3553e+06, overlap shift 1.3553e+07 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907258576700       residual = 7.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907258576719       residual = 8.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907258576722       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907258576724       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907258576407       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907258576724       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907258577573       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907258578275       residual = 8.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907258577751       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907258578222       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+06 is 8.416584e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.373136 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6551e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959955e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100986e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419975e-03 3 1  ON 24
ci_026                 9.900441e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610840e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690515e-04 3 1  ON 37
ci_039                 1.139692e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989374e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845581e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274511e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.1738
    reference variance = 0.26319
====================================================
  Execution time = 1.3512e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9793e-01
  Total weights = 1.9578e+06
  Execution time = 1.8110e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285140299945
                                         uncertainty =       0.001590648114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285140299945
                                         uncertainty =       0.001590648114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377565524
  error estimate for blocks of size 2^( 2) =       0.000388804897
  error estimate for blocks of size 2^( 3) =       0.000398979696
  error estimate for blocks of size 2^( 4) =       0.000406375706
  error estimate for blocks of size 2^( 5) =       0.000410653977
  error estimate for blocks of size 2^( 6) =       0.000413706306
  error estimate for blocks of size 2^( 7) =       0.000414274203

      target function =      -0.915888032004
              le_mean =     -17.215031278835
             les_mean =     296.655228091187
             stat err =       0.000411252548
             autocorr =       1.186403829801
   target nu stat err =       0.000411252548
   target dn stat err =       0.002147248369
      target stat err =       0.003431439617
              std dev =       0.533958284934
             le_variance =       0.285111450049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285140300020
                                         uncertainty =       0.001590648126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285140300020
                                         uncertainty =       0.001590648126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377565524
  error estimate for blocks of size 2^( 2) =       0.000388804897
  error estimate for blocks of size 2^( 3) =       0.000398979696
  error estimate for blocks of size 2^( 4) =       0.000406375706
  error estimate for blocks of size 2^( 5) =       0.000410653977
  error estimate for blocks of size 2^( 6) =       0.000413706306
  error estimate for blocks of size 2^( 7) =       0.000414274204

      target function =      -0.915888029706
              le_mean =     -17.215031278839
             les_mean =     296.655228092810
             stat err =       0.000411252548
             autocorr =       1.186403831351
   target nu stat err =       0.000411252548
   target dn stat err =       0.002147248223
      target stat err =       0.003431439378
              std dev =       0.533958285005
             le_variance =       0.285111450125

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285140299983
                                         uncertainty =       0.001590648120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285140299983
                                         uncertainty =       0.001590648120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377565524
  error estimate for blocks of size 2^( 2) =       0.000388804897
  error estimate for blocks of size 2^( 3) =       0.000398979696
  error estimate for blocks of size 2^( 4) =       0.000406375706
  error estimate for blocks of size 2^( 5) =       0.000410653977
  error estimate for blocks of size 2^( 6) =       0.000413706306
  error estimate for blocks of size 2^( 7) =       0.000414274203

      target function =      -0.915888030855
              le_mean =     -17.215031278837
             les_mean =     296.655228091998
             stat err =       0.000411252548
             autocorr =       1.186403830564
   target nu stat err =       0.000411252548
   target dn stat err =       0.002147248296
      target stat err =       0.003431439498
              std dev =       0.533958284969
             le_variance =       0.285111450087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285140299950
                                         uncertainty =       0.001590648115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285140299950
                                         uncertainty =       0.001590648115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377565524
  error estimate for blocks of size 2^( 2) =       0.000388804897
  error estimate for blocks of size 2^( 3) =       0.000398979696
  error estimate for blocks of size 2^( 4) =       0.000406375706
  error estimate for blocks of size 2^( 5) =       0.000410653977
  error estimate for blocks of size 2^( 6) =       0.000413706306
  error estimate for blocks of size 2^( 7) =       0.000414274203

      target function =      -0.915888031860
              le_mean =     -17.215031278835
             les_mean =     296.655228091289
             stat err =       0.000411252548
             autocorr =       1.186403829888
   target nu stat err =       0.000411252548
   target dn stat err =       0.002147248360
      target stat err =       0.003431439602
              std dev =       0.533958284938
             le_variance =       0.285111450054


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915888032004        initial  <--
     8.4703e+04     8.4703e+05             1.3467e-09        -0.915888029706
     3.3881e+05     3.3881e+06             3.3666e-10        -0.915888030855
     1.3553e+06     1.3553e+07             8.4166e-11        -0.915888031860

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6798
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9237e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.3271
    reference variance = 0.351834
====================================================
  Execution time = 1.4691e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0338e-01
  Total weights = 1.957592038e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5297e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287904948327
                                         uncertainty =       0.002053663562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287904948327
                                         uncertainty =       0.002053663562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379524828
  error estimate for blocks of size 2^( 2) =       0.000390898487
  error estimate for blocks of size 2^( 3) =       0.000401145971
  error estimate for blocks of size 2^( 4) =       0.000408748973
  error estimate for blocks of size 2^( 5) =       0.000414020979
  error estimate for blocks of size 2^( 6) =       0.000417042882
  error estimate for blocks of size 2^( 7) =       0.000415441770

      target function =      -0.907405589794
              le_mean =     -17.215215073604
             les_mean =     296.667006071128
             stat err =       0.000413813651
             autocorr =       1.188855970977
   target nu stat err =       0.000413813651
   target dn stat err =       0.003921376942
      target stat err =       0.006063680606
              std dev =       0.536729158362
             le_variance =       0.288078189436


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721521507360e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+05, overlap shift 8.4703e+06 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907445265424       residual = 9.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907445265473       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907445265484       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907445265652       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907445265019       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907445265493       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907445267837       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907445265907       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907445264130       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907445266485       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+05 is 1.462819e-10

solving harmonic davidson linear method for identity shift 3.3881e+06, overlap shift 3.3881e+07 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907445265424       residual = 9.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907445265437       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907445265439       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907445265440       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907445265440       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907445265517       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907445265440       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907445265440       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907445270190       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907445270566       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+06 is 3.657049e-11

solving harmonic davidson linear method for identity shift 1.3553e+07, overlap shift 1.3553e+08 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907445265424       residual = 9.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907445265427       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907445265428       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907445265428       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907445265428       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907445278367       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907445287147       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907445284289       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907445265737       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907445277242       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+07 is 9.142630e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.376641 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7233e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.193
    reference variance = 0.202311
====================================================
  Execution time = 1.3381e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0122e-01
  Total weights = 1.9577e+06
  Execution time = 1.8081e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288274442596
                                         uncertainty =       0.001768708568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288274442596
                                         uncertainty =       0.001768708568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379688782
  error estimate for blocks of size 2^( 2) =       0.000391258415
  error estimate for blocks of size 2^( 3) =       0.000401589340
  error estimate for blocks of size 2^( 4) =       0.000410054921
  error estimate for blocks of size 2^( 5) =       0.000413837041
  error estimate for blocks of size 2^( 6) =       0.000417438404
  error estimate for blocks of size 2^( 7) =       0.000419294713

      target function =      -0.910793895917
              le_mean =     -17.213993186586
             les_mean =     296.622782464224
             stat err =       0.000415156270
             autocorr =       1.195549800165
   target nu stat err =       0.000415156270
   target dn stat err =       0.002793353366
      target stat err =       0.004369703937
              std dev =       0.536961024324
             le_variance =       0.288327141643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288274442597
                                         uncertainty =       0.001768708569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288274442597
                                         uncertainty =       0.001768708569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379688782
  error estimate for blocks of size 2^( 2) =       0.000391258415
  error estimate for blocks of size 2^( 3) =       0.000401589340
  error estimate for blocks of size 2^( 4) =       0.000410054921
  error estimate for blocks of size 2^( 5) =       0.000413837041
  error estimate for blocks of size 2^( 6) =       0.000417438404
  error estimate for blocks of size 2^( 7) =       0.000419294713

      target function =      -0.910793895889
              le_mean =     -17.213993186586
             les_mean =     296.622782464220
             stat err =       0.000415156270
             autocorr =       1.195549800333
   target nu stat err =       0.000415156270
   target dn stat err =       0.002793353360
      target stat err =       0.004369703928
              std dev =       0.536961024325
             le_variance =       0.288327141644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288274442597
                                         uncertainty =       0.001768708569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288274442597
                                         uncertainty =       0.001768708569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379688782
  error estimate for blocks of size 2^( 2) =       0.000391258415
  error estimate for blocks of size 2^( 3) =       0.000401589340
  error estimate for blocks of size 2^( 4) =       0.000410054921
  error estimate for blocks of size 2^( 5) =       0.000413837041
  error estimate for blocks of size 2^( 6) =       0.000417438404
  error estimate for blocks of size 2^( 7) =       0.000419294713

      target function =      -0.910793895903
              le_mean =     -17.213993186586
             les_mean =     296.622782464222
             stat err =       0.000415156270
             autocorr =       1.195549800250
   target nu stat err =       0.000415156270
   target dn stat err =       0.002793353363
      target stat err =       0.004369703932
              std dev =       0.536961024324
             le_variance =       0.288327141643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288274442596
                                         uncertainty =       0.001768708568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288274442596
                                         uncertainty =       0.001768708568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379688782
  error estimate for blocks of size 2^( 2) =       0.000391258415
  error estimate for blocks of size 2^( 3) =       0.000401589340
  error estimate for blocks of size 2^( 4) =       0.000410054921
  error estimate for blocks of size 2^( 5) =       0.000413837041
  error estimate for blocks of size 2^( 6) =       0.000417438404
  error estimate for blocks of size 2^( 7) =       0.000419294713

      target function =      -0.910793895915
              le_mean =     -17.213993186586
             les_mean =     296.622782464224
             stat err =       0.000415156270
             autocorr =       1.195549800192
   target nu stat err =       0.000415156270
   target dn stat err =       0.002793353366
      target stat err =       0.004369703936
              std dev =       0.536961024324
             le_variance =       0.288327141643


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910793895917        initial  <--
     8.4703e+05     8.4703e+06             1.4628e-10        -0.910793895889
     3.3881e+06     3.3881e+07             3.6570e-11        -0.910793895903
     1.3553e+07     1.3553e+08             9.1426e-12        -0.910793895915

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5859
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9826e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.1584
    reference variance = 4.83698
====================================================
  Execution time = 1.4324e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9663e-01
  Total weights = 1.957747641e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4810e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283849780692
                                         uncertainty =       0.001569366328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283849780692
                                         uncertainty =       0.001569366328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376789692
  error estimate for blocks of size 2^( 2) =       0.000388141272
  error estimate for blocks of size 2^( 3) =       0.000398962458
  error estimate for blocks of size 2^( 4) =       0.000406394501
  error estimate for blocks of size 2^( 5) =       0.000410402305
  error estimate for blocks of size 2^( 6) =       0.000412850915
  error estimate for blocks of size 2^( 7) =       0.000412906003

      target function =      -0.917913308776
              le_mean =     -17.215495942090
             les_mean =     296.669925912607
             stat err =       0.000410638431
             autocorr =       1.187739386893
   target nu stat err =       0.000410638431
   target dn stat err =       0.002235972871
      target stat err =       0.003585793689
              std dev =       0.532861092358
             le_variance =       0.283940943749


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721549594209e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+06, overlap shift 8.4703e+07 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917926615685       residual = 4.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917926615687       residual = 6.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917926615687       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917926615687       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917926615687       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917926615687       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917926616105       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917926614492       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917926623346       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917926606988       residual = 1.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+06 is 1.090321e-11

solving harmonic davidson linear method for identity shift 3.3881e+07, overlap shift 3.3881e+08 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917926615685       residual = 4.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917926615685       residual = 6.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917926615685       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917926615685       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917926615685       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917926615685       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917926615685       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917926615685       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917926615685       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917926615685       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+07 is 2.725668e-12

solving harmonic davidson linear method for identity shift 1.3553e+08, overlap shift 1.3553e+09 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917926615685       residual = 4.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917926615685       residual = 6.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917926615685       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917926615685       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917926603255       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917926801027       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917926650494       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917926724760       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917926813325       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917926391837       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+08 is 6.814394e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.380171 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6814e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.2407
    reference variance = 0.425376
====================================================
  Execution time = 1.3420e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9798e-01
  Total weights = 1.9580e+06
  Execution time = 1.8064e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284917527303
                                         uncertainty =       0.001473950761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284917527303
                                         uncertainty =       0.001473950761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377474062
  error estimate for blocks of size 2^( 2) =       0.000389301526
  error estimate for blocks of size 2^( 3) =       0.000399632665
  error estimate for blocks of size 2^( 4) =       0.000407901259
  error estimate for blocks of size 2^( 5) =       0.000411954416
  error estimate for blocks of size 2^( 6) =       0.000413085828
  error estimate for blocks of size 2^( 7) =       0.000412829430

      target function =      -0.915818355317
              le_mean =     -17.214763436267
             les_mean =     296.646055354375
             stat err =       0.000411442733
             autocorr =       1.188076930509
   target nu stat err =       0.000411442733
   target dn stat err =       0.002230905685
      target stat err =       0.003557389102
              std dev =       0.533828938221
             le_variance =       0.284973335282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284917527302
                                         uncertainty =       0.001473950761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284917527302
                                         uncertainty =       0.001473950761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377474062
  error estimate for blocks of size 2^( 2) =       0.000389301526
  error estimate for blocks of size 2^( 3) =       0.000399632665
  error estimate for blocks of size 2^( 4) =       0.000407901259
  error estimate for blocks of size 2^( 5) =       0.000411954416
  error estimate for blocks of size 2^( 6) =       0.000413085828
  error estimate for blocks of size 2^( 7) =       0.000412829430

      target function =      -0.915818355317
              le_mean =     -17.214763436267
             les_mean =     296.646055354372
             stat err =       0.000411442733
             autocorr =       1.188076930504
   target nu stat err =       0.000411442733
   target dn stat err =       0.002230905685
      target stat err =       0.003557389103
              std dev =       0.533828938220
             le_variance =       0.284973335281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284917527302
                                         uncertainty =       0.001473950761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284917527302
                                         uncertainty =       0.001473950761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377474062
  error estimate for blocks of size 2^( 2) =       0.000389301526
  error estimate for blocks of size 2^( 3) =       0.000399632665
  error estimate for blocks of size 2^( 4) =       0.000407901259
  error estimate for blocks of size 2^( 5) =       0.000411954416
  error estimate for blocks of size 2^( 6) =       0.000413085828
  error estimate for blocks of size 2^( 7) =       0.000412829430

      target function =      -0.915818355317
              le_mean =     -17.214763436267
             les_mean =     296.646055354373
             stat err =       0.000411442733
             autocorr =       1.188076930514
   target nu stat err =       0.000411442733
   target dn stat err =       0.002230905685
      target stat err =       0.003557389103
              std dev =       0.533828938221
             le_variance =       0.284973335282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284917527303
                                         uncertainty =       0.001473950761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284917527303
                                         uncertainty =       0.001473950761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377474062
  error estimate for blocks of size 2^( 2) =       0.000389301526
  error estimate for blocks of size 2^( 3) =       0.000399632665
  error estimate for blocks of size 2^( 4) =       0.000407901259
  error estimate for blocks of size 2^( 5) =       0.000411954416
  error estimate for blocks of size 2^( 6) =       0.000413085828
  error estimate for blocks of size 2^( 7) =       0.000412829430

      target function =      -0.915818355317
              le_mean =     -17.214763436267
             les_mean =     296.646055354374
             stat err =       0.000411442733
             autocorr =       1.188076930499
   target nu stat err =       0.000411442733
   target dn stat err =       0.002230905685
      target stat err =       0.003557389102
              std dev =       0.533828938221
             le_variance =       0.284973335282


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915818355317        initial  <--
     8.4703e+06     8.4703e+07             1.0903e-11        -0.915818355317
     3.3881e+07     3.3881e+08             2.7257e-12        -0.915818355317
     1.3553e+08     1.3553e+09             6.8144e-13        -0.915818355317

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5392
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9360e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.2365
    reference variance = 0.201257
====================================================
  Execution time = 1.4017e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9776e-01
  Total weights = 1.957540571e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5114e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283965899033
                                         uncertainty =       0.001472800124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283965899033
                                         uncertainty =       0.001472800124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376764537
  error estimate for blocks of size 2^( 2) =       0.000388173798
  error estimate for blocks of size 2^( 3) =       0.000398566180
  error estimate for blocks of size 2^( 4) =       0.000406684635
  error estimate for blocks of size 2^( 5) =       0.000412575611
  error estimate for blocks of size 2^( 6) =       0.000415737682
  error estimate for blocks of size 2^( 7) =       0.000415966633

      target function =      -0.916151269725
              le_mean =     -17.214660044720
             les_mean =     296.642283097182
             stat err =       0.000412741140
             autocorr =       1.200094604283
   target nu stat err =       0.000412741140
   target dn stat err =       0.002433260607
      target stat err =       0.003870425079
              std dev =       0.532825518004
             le_variance =       0.283903032636


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721466004472e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+07, overlap shift 8.4703e+08 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916166634032       residual = 7.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916166634033       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916166634033       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916166634033       residual = 4.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916166626695       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916166618010       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916166646096       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916166734877       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916166643680       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916166755604       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+07 is 1.627245e-12

solving harmonic davidson linear method for identity shift 3.3881e+08, overlap shift 3.3881e+09 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916166634032       residual = 7.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916166634032       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916166634032       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916166765068       residual = 4.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916166633882       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916166665540       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916166436466       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916167146017       residual = 8.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916166322002       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916166053555       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+08 is 4.067898e-13

solving harmonic davidson linear method for identity shift 1.3553e+09, overlap shift 1.3553e+10 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916166634032       residual = 7.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916166634032       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916166634032       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916166664394       residual = 4.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916166582442       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916166680754       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916166106267       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916165069654       residual = 9.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916168104791       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916166269686       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+09 is 1.016679e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.383618 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6538e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.318
    reference variance = 0.351759
====================================================
  Execution time = 1.3573e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9596e-01
  Total weights = 1.9578e+06
  Execution time = 1.8125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284068537204
                                         uncertainty =       0.001386316794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284068537204
                                         uncertainty =       0.001386316794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376842688
  error estimate for blocks of size 2^( 2) =       0.000388584790
  error estimate for blocks of size 2^( 3) =       0.000399576278
  error estimate for blocks of size 2^( 4) =       0.000407310343
  error estimate for blocks of size 2^( 5) =       0.000412493898
  error estimate for blocks of size 2^( 6) =       0.000415594268
  error estimate for blocks of size 2^( 7) =       0.000415429049

      target function =      -0.918977308698
              le_mean =     -17.214771985902
             les_mean =     296.644337511247
             stat err =       0.000412706889
             autocorr =       1.199397807609
   target nu stat err =       0.000412706889
   target dn stat err =       0.001981002087
      target stat err =       0.003197287784
              std dev =       0.532936040867
             le_variance =       0.284020823655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284068537203
                                         uncertainty =       0.001386316794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284068537203
                                         uncertainty =       0.001386316794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376842688
  error estimate for blocks of size 2^( 2) =       0.000388584790
  error estimate for blocks of size 2^( 3) =       0.000399576278
  error estimate for blocks of size 2^( 4) =       0.000407310343
  error estimate for blocks of size 2^( 5) =       0.000412493898
  error estimate for blocks of size 2^( 6) =       0.000415594268
  error estimate for blocks of size 2^( 7) =       0.000415429049

      target function =      -0.918977308677
              le_mean =     -17.214771985902
             les_mean =     296.644337511260
             stat err =       0.000412706889
             autocorr =       1.199397807614
   target nu stat err =       0.000412706889
   target dn stat err =       0.001981002086
      target stat err =       0.003197287783
              std dev =       0.532936040867
             le_variance =       0.284020823655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284068537204
                                         uncertainty =       0.001386316794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284068537204
                                         uncertainty =       0.001386316794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376842688
  error estimate for blocks of size 2^( 2) =       0.000388584790
  error estimate for blocks of size 2^( 3) =       0.000399576278
  error estimate for blocks of size 2^( 4) =       0.000407310343
  error estimate for blocks of size 2^( 5) =       0.000412493898
  error estimate for blocks of size 2^( 6) =       0.000415594268
  error estimate for blocks of size 2^( 7) =       0.000415429049

      target function =      -0.918977308688
              le_mean =     -17.214771985902
             les_mean =     296.644337511254
             stat err =       0.000412706889
             autocorr =       1.199397807612
   target nu stat err =       0.000412706889
   target dn stat err =       0.001981002087
      target stat err =       0.003197287784
              std dev =       0.532936040867
             le_variance =       0.284020823655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284068537204
                                         uncertainty =       0.001386316794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284068537204
                                         uncertainty =       0.001386316794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376842688
  error estimate for blocks of size 2^( 2) =       0.000388584790
  error estimate for blocks of size 2^( 3) =       0.000399576278
  error estimate for blocks of size 2^( 4) =       0.000407310343
  error estimate for blocks of size 2^( 5) =       0.000412493898
  error estimate for blocks of size 2^( 6) =       0.000415594268
  error estimate for blocks of size 2^( 7) =       0.000415429049

      target function =      -0.918977308697
              le_mean =     -17.214771985902
             les_mean =     296.644337511248
             stat err =       0.000412706889
             autocorr =       1.199397807613
   target nu stat err =       0.000412706889
   target dn stat err =       0.001981002087
      target stat err =       0.003197287784
              std dev =       0.532936040867
             le_variance =       0.284020823655


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918977308698        initial  <--
     8.4703e+07     8.4703e+08             1.6272e-12        -0.918977308677
     3.3881e+08     3.3881e+09             4.0679e-13        -0.918977308688
     1.3553e+09     1.3553e+10             1.0167e-13        -0.918977308697

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7605
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9305e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.2097
    reference variance = 0.196165
====================================================
  Execution time = 1.3775e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9932e-01
  Total weights = 1.957667724e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286084350863
                                         uncertainty =       0.002026112725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286084350863
                                         uncertainty =       0.002026112725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378252973
  error estimate for blocks of size 2^( 2) =       0.000390028059
  error estimate for blocks of size 2^( 3) =       0.000400313340
  error estimate for blocks of size 2^( 4) =       0.000407965722
  error estimate for blocks of size 2^( 5) =       0.000412863663
  error estimate for blocks of size 2^( 6) =       0.000416066111
  error estimate for blocks of size 2^( 7) =       0.000416295998

      target function =      -0.913742121952
              le_mean =     -17.214172848741
             les_mean =     296.627063263972
             stat err =       0.000413297874
             autocorr =       1.193882653977
   target nu stat err =       0.000413297874
   target dn stat err =       0.002508879661
      target stat err =       0.003962740762
              std dev =       0.534930483949
             le_variance =       0.286150622657


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721417284874e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+08, overlap shift 8.4703e+09 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913758479766       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913758479766       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913758479766       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913758479766       residual = 9.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913758551761       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913758623478       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913758439816       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913757382420       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913758437931       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913757929239       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+08 is 1.385081e-13

solving harmonic davidson linear method for identity shift 3.3881e+09, overlap shift 3.3881e+10 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913758479766       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913758479766       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913758479766       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913761190324       residual = 8.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913758478938       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913758715584       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913763751470       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913747790674       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913757231137       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913756924622       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+09 is 3.461458e-14

solving harmonic davidson linear method for identity shift 1.3553e+10, overlap shift 1.3553e+11 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913758479766       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913758479766       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913758479766       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913769248890       residual = 8.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913758479207       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913758673972       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913732310728       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913765167918       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913760272837       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913738472948       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913768778472       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913763098031       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913768955425       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913747518414       residual = 6.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913765223126       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913739525325       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913762816011       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913768539593       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913766062384       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913746813922       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913727736707       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913759071366       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913736687655       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913761059165       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913752572623       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913779536235       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913768713709       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913724975447       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913753926307       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913751865866       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913789443854       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913756529181       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913738938427       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913754321103       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913779012149       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913753035955       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913768029260       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913777916284       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913740140390       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.913729788449       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.913777104814       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.913755566732       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.913752057707       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.913758281418       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.913748781625       residual = 2.48e-08           smallest_sin_value = 9.99e-01
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.913741961486       residual = 4.64e-08           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.913760199434       residual = 4.36e-08           smallest_sin_value = 9.96e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.913750762490       residual = 1.94e-08           smallest_sin_value = 9.96e-01
davidson iteration   48 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         48 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+10 is 8.659103e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.578219 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6465e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.2012
    reference variance = 0.261193
====================================================
  Execution time = 1.3801e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0282e-01
  Total weights = 1.9577e+06
  Execution time = 1.8167e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287461120792
                                         uncertainty =       0.001852904176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287461120792
                                         uncertainty =       0.001852904176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379116210
  error estimate for blocks of size 2^( 2) =       0.000390367223
  error estimate for blocks of size 2^( 3) =       0.000400619358
  error estimate for blocks of size 2^( 4) =       0.000408586831
  error estimate for blocks of size 2^( 5) =       0.000413201347
  error estimate for blocks of size 2^( 6) =       0.000414624716
  error estimate for blocks of size 2^( 7) =       0.000416877157

      target function =      -0.908304604234
              le_mean =     -17.214338559311
             les_mean =     296.636273270814
             stat err =       0.000413322513
             autocorr =       1.188593673968
   target nu stat err =       0.000413322513
   target dn stat err =       0.003494888349
      target stat err =       0.005415155009
              std dev =       0.536151285609
             le_variance =       0.287458201060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287461120792
                                         uncertainty =       0.001852904176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287461120792
                                         uncertainty =       0.001852904176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379116210
  error estimate for blocks of size 2^( 2) =       0.000390367223
  error estimate for blocks of size 2^( 3) =       0.000400619358
  error estimate for blocks of size 2^( 4) =       0.000408586831
  error estimate for blocks of size 2^( 5) =       0.000413201347
  error estimate for blocks of size 2^( 6) =       0.000414624716
  error estimate for blocks of size 2^( 7) =       0.000416877157

      target function =      -0.908304604234
              le_mean =     -17.214338559311
             les_mean =     296.636273270814
             stat err =       0.000413322513
             autocorr =       1.188593673961
   target nu stat err =       0.000413322513
   target dn stat err =       0.003494888349
      target stat err =       0.005415155009
              std dev =       0.536151285609
             le_variance =       0.287458201060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287461120792
                                         uncertainty =       0.001852904176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287461120792
                                         uncertainty =       0.001852904176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379116210
  error estimate for blocks of size 2^( 2) =       0.000390367223
  error estimate for blocks of size 2^( 3) =       0.000400619358
  error estimate for blocks of size 2^( 4) =       0.000408586831
  error estimate for blocks of size 2^( 5) =       0.000413201347
  error estimate for blocks of size 2^( 6) =       0.000414624716
  error estimate for blocks of size 2^( 7) =       0.000416877157

      target function =      -0.908304604234
              le_mean =     -17.214338559311
             les_mean =     296.636273270814
             stat err =       0.000413322513
             autocorr =       1.188593673961
   target nu stat err =       0.000413322513
   target dn stat err =       0.003494888349
      target stat err =       0.005415155009
              std dev =       0.536151285609
             le_variance =       0.287458201060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287461120792
                                         uncertainty =       0.001852904176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287461120792
                                         uncertainty =       0.001852904176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379116210
  error estimate for blocks of size 2^( 2) =       0.000390367223
  error estimate for blocks of size 2^( 3) =       0.000400619358
  error estimate for blocks of size 2^( 4) =       0.000408586831
  error estimate for blocks of size 2^( 5) =       0.000413201347
  error estimate for blocks of size 2^( 6) =       0.000414624716
  error estimate for blocks of size 2^( 7) =       0.000416877157

      target function =      -0.908304604234
              le_mean =     -17.214338559311
             les_mean =     296.636273270814
             stat err =       0.000413322513
             autocorr =       1.188593673959
   target nu stat err =       0.000413322513
   target dn stat err =       0.003494888349
      target stat err =       0.005415155009
              std dev =       0.536151285609
             le_variance =       0.287458201060


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908304604234        initial  <--
     8.4703e+08     8.4703e+09             1.3851e-13        -0.908304604234
     3.3881e+09     3.3881e+10             3.4615e-14        -0.908304604234
     1.3553e+10     1.3553e+11             8.6591e-15        -0.908304604234

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0954
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9568e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.2418
    reference variance = 0.196068
====================================================
  Execution time = 1.3916e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5311e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0277e-01
  Total weights = 1.957745209e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289472388591
                                         uncertainty =       0.001836396488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289472388591
                                         uncertainty =       0.001836396488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380419004
  error estimate for blocks of size 2^( 2) =       0.000392153901
  error estimate for blocks of size 2^( 3) =       0.000402323368
  error estimate for blocks of size 2^( 4) =       0.000409765173
  error estimate for blocks of size 2^( 5) =       0.000414382877
  error estimate for blocks of size 2^( 6) =       0.000417908243
  error estimate for blocks of size 2^( 7) =       0.000418449521

      target function =      -0.908367032016
              le_mean =     -17.215221738384
             les_mean =     296.666625309686
             stat err =       0.000415126454
             autocorr =       1.190793372950
   target nu stat err =       0.000415126454
   target dn stat err =       0.002518477419
      target stat err =       0.003939740230
              std dev =       0.537993715537
             le_variance =       0.289437237957


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721522173838e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+09, overlap shift 8.4703e+10 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908383277965       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908383277965       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908383277965       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908383277965       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908388064452       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908383277965       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908390421950       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908378223487       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908359349795       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908389626040       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908409890944       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908421442741       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.908366129552       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.908370480401       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.908383744848       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.908382845170       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.908383696764       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.908383690715       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.908370985381       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908377572538       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.908386786301       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.908384767852       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908382084929       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.908388859026       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.908389855377       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908377450370       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.908378180478       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.908379234537       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.908382840547       residual = 6.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         28 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+09 is 1.703409e-14

solving harmonic davidson linear method for identity shift 3.3881e+10, overlap shift 3.3881e+11 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908383277965       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908383277965       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908383277965       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908378364388       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908394008042       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908384937657       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908405002263       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908386412057       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908462096370       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908264477108       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908376541393       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908351623845       residual = 5.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.908493542140       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.908345103065       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.908335698394       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.908317834137       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.908360844148       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.908369721338       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.908421615414       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908388210992       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.908324507087       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.908457141250       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908341046001       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.908345329894       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.908393857823       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908548970177       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.908369059540       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.908400016375       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.908383046410       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908397481865       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.908460922280       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.908336326977       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.908352917152       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908393042356       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.908389508012       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.908376446755       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.908361444282       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.908442592381       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.908407237098       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.908394090294       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.908361983823       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.908428401784       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.908368047391       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.908392795708       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.908373973386       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.908406369703       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.908432662660       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.908357083282       residual = 9.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.908386455196       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.908377685162       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.908336387364       residual = 5.67e-07           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.908450211738       residual = 1.44e-07           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.908367039310       residual = 1.77e-07           smallest_sin_value = 9.98e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.908348421988       residual = 9.40e-08           smallest_sin_value = 9.96e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+10 is 4.260248e-15

solving harmonic davidson linear method for identity shift 1.3553e+11, overlap shift 1.3553e+12 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908383277965       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908383277965       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908383277965       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908383277965       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908385899487       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908434776089       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908476262819       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908493210158       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908205503483       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908038790380       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908471615130       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908024690970       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.908351934535       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.908498123929       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.908478844297       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.908160150287       residual = 6.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.908260465222       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.908416631561       residual = 9.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.908391758091       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908183144334       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.908128670843       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.908524645897       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908407763140       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.908415255156       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.908213870849       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908315605763       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.908382861760       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.908299601872       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.908544950640       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908405406279       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.908446560935       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.908430309014       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.908287012716       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908356700256       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.908395577343       residual = 8.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.908390069400       residual = 6.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.908478228242       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.908245824947       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.908313826376       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.908340574079       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.908466732941       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.908346234914       residual = 1.19e-04           smallest_sin_value = 9.99e-01
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.908342979176       residual = 1.12e-04           smallest_sin_value = 9.98e-01
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.908548633996       residual = 1.95e-04           smallest_sin_value = 9.94e-01
davidson iteration   44 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         44 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+11 is 1.078453e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.683640 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6498e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.2482
    reference variance = 0.240399
====================================================
  Execution time = 1.4071e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9988e-01
  Total weights = 1.9577e+06
  Execution time = 1.8187e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287258093975
                                         uncertainty =       0.001943386290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287258093975
                                         uncertainty =       0.001943386290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379007903
  error estimate for blocks of size 2^( 2) =       0.000390265479
  error estimate for blocks of size 2^( 3) =       0.000400711129
  error estimate for blocks of size 2^( 4) =       0.000408889439
  error estimate for blocks of size 2^( 5) =       0.000413532105
  error estimate for blocks of size 2^( 6) =       0.000415651622
  error estimate for blocks of size 2^( 7) =       0.000419170549

      target function =      -0.912851315432
              le_mean =     -17.214251334411
             les_mean =     296.630330511618
             stat err =       0.000414310929
             autocorr =       1.194967920565
   target nu stat err =       0.000414310929
   target dn stat err =       0.003214135588
      target stat err =       0.005036664833
              std dev =       0.535998116700
             le_variance =       0.287293981106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287258093975
                                         uncertainty =       0.001943386290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287258093975
                                         uncertainty =       0.001943386290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379007903
  error estimate for blocks of size 2^( 2) =       0.000390265479
  error estimate for blocks of size 2^( 3) =       0.000400711129
  error estimate for blocks of size 2^( 4) =       0.000408889439
  error estimate for blocks of size 2^( 5) =       0.000413532105
  error estimate for blocks of size 2^( 6) =       0.000415651622
  error estimate for blocks of size 2^( 7) =       0.000419170549

      target function =      -0.912851315432
              le_mean =     -17.214251334411
             les_mean =     296.630330511618
             stat err =       0.000414310929
             autocorr =       1.194967920566
   target nu stat err =       0.000414310929
   target dn stat err =       0.003214135588
      target stat err =       0.005036664833
              std dev =       0.535998116700
             le_variance =       0.287293981106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287258093975
                                         uncertainty =       0.001943386290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287258093975
                                         uncertainty =       0.001943386290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379007903
  error estimate for blocks of size 2^( 2) =       0.000390265479
  error estimate for blocks of size 2^( 3) =       0.000400711129
  error estimate for blocks of size 2^( 4) =       0.000408889439
  error estimate for blocks of size 2^( 5) =       0.000413532105
  error estimate for blocks of size 2^( 6) =       0.000415651622
  error estimate for blocks of size 2^( 7) =       0.000419170549

      target function =      -0.912851315432
              le_mean =     -17.214251334411
             les_mean =     296.630330511618
             stat err =       0.000414310929
             autocorr =       1.194967920566
   target nu stat err =       0.000414310929
   target dn stat err =       0.003214135588
      target stat err =       0.005036664833
              std dev =       0.535998116700
             le_variance =       0.287293981106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287258093975
                                         uncertainty =       0.001943386290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287258093975
                                         uncertainty =       0.001943386290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379007903
  error estimate for blocks of size 2^( 2) =       0.000390265479
  error estimate for blocks of size 2^( 3) =       0.000400711129
  error estimate for blocks of size 2^( 4) =       0.000408889439
  error estimate for blocks of size 2^( 5) =       0.000413532105
  error estimate for blocks of size 2^( 6) =       0.000415651622
  error estimate for blocks of size 2^( 7) =       0.000419170549

      target function =      -0.912851315432
              le_mean =     -17.214251334411
             les_mean =     296.630330511618
             stat err =       0.000414310929
             autocorr =       1.194967920566
   target nu stat err =       0.000414310929
   target dn stat err =       0.003214135588
      target stat err =       0.005036664833
              std dev =       0.535998116700
             le_variance =       0.287293981106


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912851315432        initial
     8.4703e+09     8.4703e+10             1.7034e-14        -0.912851315432  <--
     3.3881e+10     3.3881e+11             4.2602e-15        -0.912851315432
     1.3553e+11     1.3553e+12             1.0785e-15        -0.912851315432

*****************************************************************************
Applying the update for shift_i =   8.4703e+09     and shift_s =   8.4703e+10
*****************************************************************************

  Execution time = 2.3273e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9777e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.2276
    reference variance = 0.409735
====================================================
  Execution time = 1.3800e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0474e-01
  Total weights = 1.958087798e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4965e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290899952781
                                         uncertainty =       0.002888498507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290899952781
                                         uncertainty =       0.002888498507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381389280
  error estimate for blocks of size 2^( 2) =       0.000392802482
  error estimate for blocks of size 2^( 3) =       0.000402987416
  error estimate for blocks of size 2^( 4) =       0.000411417397
  error estimate for blocks of size 2^( 5) =       0.000415668477
  error estimate for blocks of size 2^( 6) =       0.000418925252
  error estimate for blocks of size 2^( 7) =       0.000419048489

      target function =      -0.905307831179
              le_mean =     -17.215067880996
             les_mean =     296.663301798348
             stat err =       0.000416264904
             autocorr =       1.191249215056
   target nu stat err =       0.000416264904
   target dn stat err =       0.004615158786
      target stat err =       0.007089078141
              std dev =       0.539365892878
             le_variance =       0.290915566400


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721506788100e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+09, overlap shift 2.1176e+10 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905362788594       residual = 2.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905362788594       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905362788594       residual = 6.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905362193581       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905362788594       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905362788594       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905362788594       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905362925216       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905361580366       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905358009695       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905370351189       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1176e+09 is 1.125788e-13

solving harmonic davidson linear method for identity shift 8.4703e+09, overlap shift 8.4703e+10 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905362788594       residual = 2.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905362788594       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905362788594       residual = 6.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905362788594       residual = 8.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905362788594       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905355428896       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905365764215       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905372031032       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905363727361       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905359700194       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905353001817       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.905363851999       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.905357203024       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.905367418716       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.905358642674       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.905352076568       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.905362256796       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+09 is 2.814506e-14

solving harmonic davidson linear method for identity shift 3.3881e+10, overlap shift 3.3881e+11 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905362788594       residual = 2.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905362788594       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905362788594       residual = 6.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905388622111       residual = 8.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905346029567       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905378308282       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905350939023       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905421469787       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905369645508       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905388837819       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905324310354       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.905351428483       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.905416350455       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.905373559897       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.905367991007       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.905323597413       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.905319540644       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.905370878247       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.905283051619       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.905338994630       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.905352546906       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.905376400691       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.905344425221       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.905376041713       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.905376475956       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.905351476557       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.905367227417       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.905381237795       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.905331871879       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.905351604585       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.905353041715       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.905363183835       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.905363785940       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.905367902104       residual = 9.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.905364505790       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.905363519180       residual = 9.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.905371396555       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.905362262607       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.905361898644       residual = 8.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.905369386933       residual = 8.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.905353811718       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.905354230002       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.905367410207       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.905352761773       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.905377370229       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.905372091484       residual = 1.17e-05           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.905365418351       residual = 1.58e-06           smallest_sin_value = 9.97e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.905363892356       residual = 2.18e-07           smallest_sin_value = 9.97e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.905375800838       residual = 2.01e-07           smallest_sin_value = 9.96e-01
davidson iteration   49 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         49 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+10 is 7.036938e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.734125 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6353e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.2557
    reference variance = 0.21127
====================================================
  Execution time = 1.3732e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9858e-01
  Total weights = 1.9578e+06
  Execution time = 1.8138e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285057101515
                                         uncertainty =       0.001669935700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285057101515
                                         uncertainty =       0.001669935700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377524395
  error estimate for blocks of size 2^( 2) =       0.000388758304
  error estimate for blocks of size 2^( 3) =       0.000399123809
  error estimate for blocks of size 2^( 4) =       0.000406884138
  error estimate for blocks of size 2^( 5) =       0.000412058040
  error estimate for blocks of size 2^( 6) =       0.000414291230
  error estimate for blocks of size 2^( 7) =       0.000415851380

      target function =      -0.914848993610
              le_mean =     -17.215373095038
             les_mean =     296.667653541686
             stat err =       0.000412271197
             autocorr =       1.192548217075
   target nu stat err =       0.000412271197
   target dn stat err =       0.002318157153
      target stat err =       0.003687991039
              std dev =       0.533900119653
             le_variance =       0.285049337765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285057101515
                                         uncertainty =       0.001669935700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285057101515
                                         uncertainty =       0.001669935700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377524395
  error estimate for blocks of size 2^( 2) =       0.000388758304
  error estimate for blocks of size 2^( 3) =       0.000399123809
  error estimate for blocks of size 2^( 4) =       0.000406884138
  error estimate for blocks of size 2^( 5) =       0.000412058040
  error estimate for blocks of size 2^( 6) =       0.000414291230
  error estimate for blocks of size 2^( 7) =       0.000415851380

      target function =      -0.914848993610
              le_mean =     -17.215373095038
             les_mean =     296.667653541686
             stat err =       0.000412271197
             autocorr =       1.192548217070
   target nu stat err =       0.000412271197
   target dn stat err =       0.002318157153
      target stat err =       0.003687991039
              std dev =       0.533900119653
             le_variance =       0.285049337765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285057101515
                                         uncertainty =       0.001669935700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285057101515
                                         uncertainty =       0.001669935700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377524395
  error estimate for blocks of size 2^( 2) =       0.000388758304
  error estimate for blocks of size 2^( 3) =       0.000399123809
  error estimate for blocks of size 2^( 4) =       0.000406884138
  error estimate for blocks of size 2^( 5) =       0.000412058040
  error estimate for blocks of size 2^( 6) =       0.000414291230
  error estimate for blocks of size 2^( 7) =       0.000415851380

      target function =      -0.914848993610
              le_mean =     -17.215373095038
             les_mean =     296.667653541686
             stat err =       0.000412271197
             autocorr =       1.192548217072
   target nu stat err =       0.000412271197
   target dn stat err =       0.002318157153
      target stat err =       0.003687991039
              std dev =       0.533900119653
             le_variance =       0.285049337765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285057101515
                                         uncertainty =       0.001669935700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285057101515
                                         uncertainty =       0.001669935700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377524395
  error estimate for blocks of size 2^( 2) =       0.000388758304
  error estimate for blocks of size 2^( 3) =       0.000399123809
  error estimate for blocks of size 2^( 4) =       0.000406884138
  error estimate for blocks of size 2^( 5) =       0.000412058040
  error estimate for blocks of size 2^( 6) =       0.000414291230
  error estimate for blocks of size 2^( 7) =       0.000415851380

      target function =      -0.914848993610
              le_mean =     -17.215373095038
             les_mean =     296.667653541686
             stat err =       0.000412271197
             autocorr =       1.192548217075
   target nu stat err =       0.000412271197
   target dn stat err =       0.002318157153
      target stat err =       0.003687991039
              std dev =       0.533900119653
             le_variance =       0.285049337765


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914848993610        initial  <--
     2.1176e+09     2.1176e+10             1.1258e-13        -0.914848993610
     8.4703e+09     8.4703e+10             2.8145e-14        -0.914848993610
     3.3881e+10     3.3881e+11             7.0369e-15        -0.914848993610

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9072
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9266e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.2248
    reference variance = 0.164363
====================================================
  Execution time = 1.3685e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9971e-01
  Total weights = 1.957981857e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.0243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287128434095
                                         uncertainty =       0.002219061177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287128434095
                                         uncertainty =       0.002219061177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378857343
  error estimate for blocks of size 2^( 2) =       0.000390461569
  error estimate for blocks of size 2^( 3) =       0.000400869496
  error estimate for blocks of size 2^( 4) =       0.000408817996
  error estimate for blocks of size 2^( 5) =       0.000413837166
  error estimate for blocks of size 2^( 6) =       0.000416297993
  error estimate for blocks of size 2^( 7) =       0.000417919068

      target function =      -0.913094498526
              le_mean =     -17.214757395832
             les_mean =     296.647584240469
             stat err =       0.000414218056
             autocorr =       1.195381783525
   target nu stat err =       0.000414218056
   target dn stat err =       0.003364971689
      target stat err =       0.005276260860
              std dev =       0.535785192615
             le_variance =       0.287065772626


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721475739583e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+10, overlap shift 2.1176e+11 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913124414208       residual = 3.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913124414208       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913124414208       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913124414208       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913124414208       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913124414208       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913124414208       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913112665554       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913124414208       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913121911852       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913087673091       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913127779048       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913131555367       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913159871495       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913167016799       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913119409957       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913121160482       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913110705357       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913131824886       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913100335468       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913122255955       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913127909412       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913136344787       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913101305770       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913124993419       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913133489332       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913161818919       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913148596455       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913147295773       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913145992617       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913109726661       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913120255150       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913123333865       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913139196281       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913144879336       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913102779807       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913124723722       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913108159162       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913119604038       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.913147522653       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.913112436655       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.913109547042       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.913109737164       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.913108243853       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.913128290411       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.913117113280       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.913124722958       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.913117162356       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.913146754496       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.913120363700       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.913179769333       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.913133277200       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.913118252695       residual = 6.80e-06           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.913123537709       residual = 6.02e-07           smallest_sin_value = 9.98e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1176e+10 is 4.403351e-15

solving harmonic davidson linear method for identity shift 8.4703e+10, overlap shift 8.4703e+11 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913124414208       residual = 3.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913124414208       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913124414208       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913124414208       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913068266981       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913128031051       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913199150863       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913255417340       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913129201180       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913084344465       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912978678678       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913124587151       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913117909485       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913148727515       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913080529542       residual = 9.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913393209650       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913008677180       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913147923144       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912981137360       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913032470340       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912935227866       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913056560959       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913224601100       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912994329120       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913147315790       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913176932982       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913303838559       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913284153581       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912966443196       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913200525442       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913121883154       residual = 9.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913098710355       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913279578794       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913242811045       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913116320847       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913104559733       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913168917637       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913266587166       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913197266890       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.913207699684       residual = 6.66e-07           smallest_sin_value = 9.99e-01
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.913096795934       residual = 2.04e-06           smallest_sin_value = 9.98e-01
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.913183918655       residual = 1.09e-06           smallest_sin_value = 9.98e-01
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.913327074009       residual = 1.69e-06           smallest_sin_value = 9.97e-01
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.913103459517       residual = 3.08e-07           smallest_sin_value = 9.90e-01
davidson iteration   44 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         44 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+10 is 1.099987e-15

solving harmonic davidson linear method for identity shift 3.3881e+11, overlap shift 3.3881e+12 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913124414208       residual = 3.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913124414208       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913124414208       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913184203305       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913124414208       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913124414208       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913348156761       residual = 5.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913384133904       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913160191638       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912635196065       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913318371384       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913302782591       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913589997747       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912458518356       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912897266520       residual = 7.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912691505712       residual = 7.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913649179580       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912911653073       residual = 7.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913578951529       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913326188387       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913260133736       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912707860213       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912846828273       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913268976382       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912851639646       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913389045027       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913050961007       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913536325739       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913665869646       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913182835738       residual = 7.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913032078767       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913019964771       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912822179857       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913471570690       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913237276784       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912797967605       residual = 9.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912777429533       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913316888668       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913152650743       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.912684077409       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.913312901634       residual = 7.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.912853478424       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.913259562721       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.913056052371       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.913662405869       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.913205347355       residual = 6.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.913171057800       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.913087820589       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.912640087392       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.913444875497       residual = 1.68e-05           smallest_sin_value = 9.99e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.912995136724       residual = 8.42e-06           smallest_sin_value = 9.96e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.913056365424       residual = 1.92e-05           smallest_sin_value = 9.92e-01
davidson iteration   52 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         52 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+11 is 2.758750e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.883988 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8282e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.233
    reference variance = 0.248836
====================================================
  Execution time = 1.3785e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0200e-01
  Total weights = 1.9577e+06
  Execution time = 1.8203e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287961883647
                                         uncertainty =       0.001734042971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287961883647
                                         uncertainty =       0.001734042971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379425215
  error estimate for blocks of size 2^( 2) =       0.000390798533
  error estimate for blocks of size 2^( 3) =       0.000401009142
  error estimate for blocks of size 2^( 4) =       0.000409301859
  error estimate for blocks of size 2^( 5) =       0.000413487507
  error estimate for blocks of size 2^( 6) =       0.000417811377
  error estimate for blocks of size 2^( 7) =       0.000419501354

      target function =      -0.909563321420
              le_mean =     -17.214505382898
             les_mean =     296.641200546713
             stat err =       0.000415025524
             autocorr =       1.196457386669
   target nu stat err =       0.000415025524
   target dn stat err =       0.002921743336
      target stat err =       0.004557587558
              std dev =       0.536588285166
             le_variance =       0.287926987777

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287961883647
                                         uncertainty =       0.001734042971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287961883647
                                         uncertainty =       0.001734042971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379425215
  error estimate for blocks of size 2^( 2) =       0.000390798533
  error estimate for blocks of size 2^( 3) =       0.000401009142
  error estimate for blocks of size 2^( 4) =       0.000409301859
  error estimate for blocks of size 2^( 5) =       0.000413487507
  error estimate for blocks of size 2^( 6) =       0.000417811377
  error estimate for blocks of size 2^( 7) =       0.000419501354

      target function =      -0.909563321420
              le_mean =     -17.214505382898
             les_mean =     296.641200546713
             stat err =       0.000415025524
             autocorr =       1.196457386668
   target nu stat err =       0.000415025524
   target dn stat err =       0.002921743336
      target stat err =       0.004557587558
              std dev =       0.536588285166
             le_variance =       0.287926987777

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287961883647
                                         uncertainty =       0.001734042971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287961883647
                                         uncertainty =       0.001734042971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379425215
  error estimate for blocks of size 2^( 2) =       0.000390798533
  error estimate for blocks of size 2^( 3) =       0.000401009142
  error estimate for blocks of size 2^( 4) =       0.000409301859
  error estimate for blocks of size 2^( 5) =       0.000413487507
  error estimate for blocks of size 2^( 6) =       0.000417811377
  error estimate for blocks of size 2^( 7) =       0.000419501354

      target function =      -0.909563321420
              le_mean =     -17.214505382898
             les_mean =     296.641200546713
             stat err =       0.000415025524
             autocorr =       1.196457386668
   target nu stat err =       0.000415025524
   target dn stat err =       0.002921743336
      target stat err =       0.004557587558
              std dev =       0.536588285166
             le_variance =       0.287926987777

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287961883647
                                         uncertainty =       0.001734042971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287961883647
                                         uncertainty =       0.001734042971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379425215
  error estimate for blocks of size 2^( 2) =       0.000390798533
  error estimate for blocks of size 2^( 3) =       0.000401009142
  error estimate for blocks of size 2^( 4) =       0.000409301859
  error estimate for blocks of size 2^( 5) =       0.000413487507
  error estimate for blocks of size 2^( 6) =       0.000417811377
  error estimate for blocks of size 2^( 7) =       0.000419501354

      target function =      -0.909563321420
              le_mean =     -17.214505382898
             les_mean =     296.641200546713
             stat err =       0.000415025524
             autocorr =       1.196457386665
   target nu stat err =       0.000415025524
   target dn stat err =       0.002921743336
      target stat err =       0.004557587558
              std dev =       0.536588285166
             le_variance =       0.287926987777


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909563321420        initial
     2.1176e+10     2.1176e+11             4.4034e-15        -0.909563321420
     8.4703e+10     8.4703e+11             1.1000e-15        -0.909563321420
     3.3881e+11     3.3881e+12             2.7588e-16        -0.909563321420  <--

*****************************************************************************
Applying the update for shift_i =   3.3881e+11     and shift_s =   3.3881e+12
*****************************************************************************

  Execution time = 2.2992e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1281e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.1765
    reference variance = 0.251448
====================================================
  Execution time = 1.3869e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9684e-01
  Total weights = 1.957641973e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4957e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286023549325
                                         uncertainty =       0.001556676842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286023549325
                                         uncertainty =       0.001556676842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378162067
  error estimate for blocks of size 2^( 2) =       0.000389616522
  error estimate for blocks of size 2^( 3) =       0.000399962194
  error estimate for blocks of size 2^( 4) =       0.000406765615
  error estimate for blocks of size 2^( 5) =       0.000412399328
  error estimate for blocks of size 2^( 6) =       0.000415991021
  error estimate for blocks of size 2^( 7) =       0.000417309765

      target function =      -0.917606641981
              le_mean =     -17.214257207948
             les_mean =     296.627494193451
             stat err =       0.000413116432
             autocorr =       1.193408186585
   target nu stat err =       0.000413116432
   target dn stat err =       0.002053871564
      target stat err =       0.003296595950
              std dev =       0.534801924622
             le_variance =       0.286013098580


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721425720795e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+10, overlap shift 8.4703e+11 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917617495784       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917617495784       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917617495784       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917617495784       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917621994113       residual = 9.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917619300664       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917710625405       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917696202363       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917494048099       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917596899271       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917773921884       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917693730906       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917761466371       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917789178886       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917611521179       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917595498959       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917578720388       residual = 9.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917643628914       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917678387752       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917604649062       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917634480754       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917635469474       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917615958151       residual = 8.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917639002549       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917525869093       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917614735344       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917627475031       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917620360977       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917622037114       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917600851401       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917645425446       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917575902721       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917635263645       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917585726413       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917624528233       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917627079901       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917584133562       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917636652434       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.917638402908       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.917608910451       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.917627047608       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.917595449128       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.917626389448       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.917596219375       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.917599567881       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.917623119028       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.917642943083       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.917582970630       residual = 8.68e-05           smallest_sin_value = 9.99e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.917570695211       residual = 1.82e-04           smallest_sin_value = 9.98e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.917559442526       residual = 7.36e-07           smallest_sin_value = 9.94e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.917623667646       residual = 1.92e-06           smallest_sin_value = 9.93e-01
davidson iteration   51 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         51 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+10 is 1.855668e-15

solving harmonic davidson linear method for identity shift 3.3881e+11, overlap shift 3.3881e+12 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917617495784       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917617495784       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917617495784       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917617495784       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917617495784       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917617403103       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917838494405       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917822280051       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916911655244       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916665657808       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917680658744       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917584889382       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917691755770       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917297884347       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917821695382       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917538402437       residual = 8.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917532068403       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917632583160       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917711162804       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917446189709       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917874251835       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917579742935       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917615415175       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917257609336       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917592963717       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917555374538       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917713667309       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917570832707       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917322769213       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917413667812       residual = 7.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917731956888       residual = 8.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917465351995       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917354784191       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917867343400       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917604137529       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917546384898       residual = 5.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.917869029572       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.918084752658       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.917438554578       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.917719014998       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.917524297854       residual = 8.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.917536086770       residual = 5.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.917788102175       residual = 8.55e-04           smallest_sin_value = 9.99e-01
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.917699313608       residual = 1.17e-03           smallest_sin_value = 9.98e-01
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.917239720899       residual = 1.02e-03           smallest_sin_value = 9.93e-01
davidson iteration   45 stopping due to small subspace S singular value of 9.75e-01
davidson solver did not converge after         45 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+11 is 4.682296e-16

solving harmonic davidson linear method for identity shift 1.3553e+12, overlap shift 1.3553e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917617495784       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917617495784       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917617495784       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917617495784       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917617495938       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918007417325       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918710579967       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916980881695       residual = 7.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917383174696       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916502014399       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914466771377       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915275031429       residual = 7.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917615389288       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919085086186       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918471733723       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918349418438       residual = 9.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916984279900       residual = 4.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916882265130       residual = 2.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915492584671       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916292296560       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916234430438       residual = 6.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918383958446       residual = 9.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918000434815       residual = 4.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918129555962       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917388123425       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916596842653       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917193885720       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918007513474       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917896351746       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918442537088       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918534352769       residual = 8.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917248054117       residual = 4.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917441621021       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917829755498       residual = 3.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918458167472       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918624594378       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.918738063430       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917447451618       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916764505512       residual = 8.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.916797173730       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.918263149005       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.917868078674       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.916872599191       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.917860976443       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.918693261049       residual = 6.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.918137062181       residual = 4.66e-03           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.917649486067       residual = 9.54e-03           smallest_sin_value = 9.99e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.915497673090       residual = 4.01e-02           smallest_sin_value = 9.95e-01
davidson iteration   48 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         48 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+12 is 1.145952e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.016374 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6504e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.1679
    reference variance = 0.187843
====================================================
  Execution time = 1.3781e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0226e-01
  Total weights = 1.9577e+06
  Execution time = 1.8416e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289411170961
                                         uncertainty =       0.001589702651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289411170961
                                         uncertainty =       0.001589702651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380450371
  error estimate for blocks of size 2^( 2) =       0.000392035626
  error estimate for blocks of size 2^( 3) =       0.000402302891
  error estimate for blocks of size 2^( 4) =       0.000410490313
  error estimate for blocks of size 2^( 5) =       0.000415824031
  error estimate for blocks of size 2^( 6) =       0.000417674334
  error estimate for blocks of size 2^( 7) =       0.000419991030

      target function =      -0.909167265850
              le_mean =     -17.214799196302
             les_mean =     296.651570742547
             stat err =       0.000415994927
             autocorr =       1.195583861163
   target nu stat err =       0.000415994927
   target dn stat err =       0.002346270672
      target stat err =       0.003682979674
              std dev =       0.538038075106
             le_variance =       0.289484970264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289411170961
                                         uncertainty =       0.001589702651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289411170961
                                         uncertainty =       0.001589702651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380450371
  error estimate for blocks of size 2^( 2) =       0.000392035626
  error estimate for blocks of size 2^( 3) =       0.000402302891
  error estimate for blocks of size 2^( 4) =       0.000410490313
  error estimate for blocks of size 2^( 5) =       0.000415824031
  error estimate for blocks of size 2^( 6) =       0.000417674334
  error estimate for blocks of size 2^( 7) =       0.000419991030

      target function =      -0.909167265850
              le_mean =     -17.214799196302
             les_mean =     296.651570742547
             stat err =       0.000415994927
             autocorr =       1.195583861164
   target nu stat err =       0.000415994927
   target dn stat err =       0.002346270672
      target stat err =       0.003682979674
              std dev =       0.538038075106
             le_variance =       0.289484970264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289411170961
                                         uncertainty =       0.001589702651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289411170961
                                         uncertainty =       0.001589702651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380450371
  error estimate for blocks of size 2^( 2) =       0.000392035626
  error estimate for blocks of size 2^( 3) =       0.000402302891
  error estimate for blocks of size 2^( 4) =       0.000410490313
  error estimate for blocks of size 2^( 5) =       0.000415824031
  error estimate for blocks of size 2^( 6) =       0.000417674334
  error estimate for blocks of size 2^( 7) =       0.000419991030

      target function =      -0.909167265850
              le_mean =     -17.214799196302
             les_mean =     296.651570742547
             stat err =       0.000415994927
             autocorr =       1.195583861164
   target nu stat err =       0.000415994927
   target dn stat err =       0.002346270672
      target stat err =       0.003682979674
              std dev =       0.538038075106
             le_variance =       0.289484970264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289411170961
                                         uncertainty =       0.001589702651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289411170961
                                         uncertainty =       0.001589702651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380450371
  error estimate for blocks of size 2^( 2) =       0.000392035626
  error estimate for blocks of size 2^( 3) =       0.000402302891
  error estimate for blocks of size 2^( 4) =       0.000410490313
  error estimate for blocks of size 2^( 5) =       0.000415824031
  error estimate for blocks of size 2^( 6) =       0.000417674334
  error estimate for blocks of size 2^( 7) =       0.000419991030

      target function =      -0.909167265850
              le_mean =     -17.214799196302
             les_mean =     296.651570742547
             stat err =       0.000415994927
             autocorr =       1.195583861165
   target nu stat err =       0.000415994927
   target dn stat err =       0.002346270672
      target stat err =       0.003682979674
              std dev =       0.538038075106
             le_variance =       0.289484970264


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909167265850        initial
     8.4703e+10     8.4703e+11             1.8557e-15        -0.909167265850
     3.3881e+11     3.3881e+12             4.6823e-16        -0.909167265850  <--
     1.3553e+12     1.3553e+13             1.1460e-16        -0.909167265850

*****************************************************************************
Applying the update for shift_i =   3.3881e+11     and shift_s =   3.3881e+12
*****************************************************************************

  Execution time = 2.3051e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9563e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2436
    reference variance = 0.1695
====================================================
  Execution time = 1.4084e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9860e-01
  Total weights = 1.957910678e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4964e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285156012061
                                         uncertainty =       0.001580813045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285156012061
                                         uncertainty =       0.001580813045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377569711
  error estimate for blocks of size 2^( 2) =       0.000389055070
  error estimate for blocks of size 2^( 3) =       0.000399616192
  error estimate for blocks of size 2^( 4) =       0.000406777985
  error estimate for blocks of size 2^( 5) =       0.000412269289
  error estimate for blocks of size 2^( 6) =       0.000415497531
  error estimate for blocks of size 2^( 7) =       0.000417139257

      target function =      -0.914846570789
              le_mean =     -17.214758058696
             les_mean =     296.646492616044
             stat err =       0.000412921016
             autocorr =       1.196023405720
   target nu stat err =       0.000412921016
   target dn stat err =       0.002241827180
      target stat err =       0.003567153579
              std dev =       0.533964206132
             le_variance =       0.285117773430


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721475805870e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+10, overlap shift 8.4703e+11 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914859522410       residual = 9.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914859522410       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914859522410       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914859522410       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914859522384       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914832691201       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914849856063       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915017731299       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914846676427       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914990837832       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914726877934       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914903274207       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914828260745       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914824677041       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914946869825       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914819590772       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914779875650       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914818213514       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914836197067       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914939509361       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914803847776       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914845135579       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914923091210       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914864586763       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914808870707       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914860502105       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914929943717       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914869552525       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914895326489       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914830212270       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914824195589       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914948378942       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914912606543       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914850435203       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914916068276       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914908864077       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914880274079       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914869326375       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914946570866       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914813363013       residual = 9.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.914816114451       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.914857642355       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.914879819776       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.914847650663       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.914847553047       residual = 9.35e-06           smallest_sin_value = 9.98e-01
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.914861661489       residual = 3.85e-05           smallest_sin_value = 9.97e-01
davidson iteration   46 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         46 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+10 is 1.437833e-15

solving harmonic davidson linear method for identity shift 3.3881e+11, overlap shift 3.3881e+12 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914859522410       residual = 9.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914859522410       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914859522410       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914859522411       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914913022418       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915123342985       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914876666062       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914557220183       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914681103958       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915097513012       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914920143453       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914550144875       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915776226362       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914350194894       residual = 8.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915119353344       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915732296321       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914572799638       residual = 7.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914605876257       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914852813617       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914919006796       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914899992628       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915297126337       residual = 3.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914367465857       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914853390093       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914686022145       residual = 9.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914588232539       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914908091198       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914733653156       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914816272820       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914848385704       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915255634826       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914922522739       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914500930921       residual = 4.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914681451910       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914992044644       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914802426939       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914706249017       residual = 7.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914966156298       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914612000355       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914979616890       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.914943360936       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.914692330911       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.914718720669       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.914956368521       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.914873823763       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.914595561213       residual = 1.25e-03           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.914643000241       residual = 1.26e-03           smallest_sin_value = 9.98e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.914582343187       residual = 3.93e-03           smallest_sin_value = 9.94e-01
davidson iteration   48 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         48 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+11 is 3.610138e-16

solving harmonic davidson linear method for identity shift 1.3553e+12, overlap shift 1.3553e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914859522410       residual = 9.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914859522410       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914859522410       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914859522410       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914859522410       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915985777355       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914858734191       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915351118147       residual = 8.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913816279506       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915299585375       residual = 6.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914665732530       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915867542165       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917781277608       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913523457895       residual = 6.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915081697442       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916261837601       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915755172622       residual = 4.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915089915851       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916495190567       residual = 4.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916458902853       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913890045236       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913297654111       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912242133301       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916160377367       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912633788978       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912464555858       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915435921491       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915773891430       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915215364840       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915828053940       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917166021456       residual = 9.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915500693179       residual = 6.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914879230988       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919015143300       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914750560715       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914484821034       residual = 8.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916905615041       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914434724596       residual = 5.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915544204738       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915125852162       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.913476237332       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.914087561734       residual = 5.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.915843761859       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.915079029550       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.914838842148       residual = 9.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.911994182669       residual = 5.34e-04           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.914499286584       residual = 2.10e-03           smallest_sin_value = 9.99e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.914592737589       residual = 1.99e-04           smallest_sin_value = 9.99e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.914512948899       residual = 3.09e-04           smallest_sin_value = 9.97e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.915110448952       residual = 1.34e-03           smallest_sin_value = 9.91e-01
davidson iteration   50 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         50 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+12 is 8.869032e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.143338 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6714e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2561
    reference variance = 0.199813
====================================================
  Execution time = 1.3898e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0130e-01
  Total weights = 1.9576e+06
  Execution time = 1.8382e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288049751656
                                         uncertainty =       0.001502053333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288049751656
                                         uncertainty =       0.001502053333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379478966
  error estimate for blocks of size 2^( 2) =       0.000390987583
  error estimate for blocks of size 2^( 3) =       0.000401246559
  error estimate for blocks of size 2^( 4) =       0.000409131983
  error estimate for blocks of size 2^( 5) =       0.000413970902
  error estimate for blocks of size 2^( 6) =       0.000416205436
  error estimate for blocks of size 2^( 7) =       0.000417536806

      target function =      -0.910644708477
              le_mean =     -17.215050498652
             les_mean =     296.659259758490
             stat err =       0.000414211282
             autocorr =       1.191429721287
   target nu stat err =       0.000414211282
   target dn stat err =       0.002282883782
      target stat err =       0.003599707583
              std dev =       0.536664300292
             le_variance =       0.288008571208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288049751656
                                         uncertainty =       0.001502053333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288049751656
                                         uncertainty =       0.001502053333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379478966
  error estimate for blocks of size 2^( 2) =       0.000390987583
  error estimate for blocks of size 2^( 3) =       0.000401246559
  error estimate for blocks of size 2^( 4) =       0.000409131983
  error estimate for blocks of size 2^( 5) =       0.000413970902
  error estimate for blocks of size 2^( 6) =       0.000416205436
  error estimate for blocks of size 2^( 7) =       0.000417536806

      target function =      -0.910644708477
              le_mean =     -17.215050498652
             les_mean =     296.659259758490
             stat err =       0.000414211282
             autocorr =       1.191429721287
   target nu stat err =       0.000414211282
   target dn stat err =       0.002282883782
      target stat err =       0.003599707583
              std dev =       0.536664300292
             le_variance =       0.288008571208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288049751656
                                         uncertainty =       0.001502053333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288049751656
                                         uncertainty =       0.001502053333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379478966
  error estimate for blocks of size 2^( 2) =       0.000390987583
  error estimate for blocks of size 2^( 3) =       0.000401246559
  error estimate for blocks of size 2^( 4) =       0.000409131983
  error estimate for blocks of size 2^( 5) =       0.000413970902
  error estimate for blocks of size 2^( 6) =       0.000416205436
  error estimate for blocks of size 2^( 7) =       0.000417536806

      target function =      -0.910644708477
              le_mean =     -17.215050498652
             les_mean =     296.659259758490
             stat err =       0.000414211282
             autocorr =       1.191429721286
   target nu stat err =       0.000414211282
   target dn stat err =       0.002282883782
      target stat err =       0.003599707583
              std dev =       0.536664300292
             le_variance =       0.288008571208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288049751656
                                         uncertainty =       0.001502053333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288049751656
                                         uncertainty =       0.001502053333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379478966
  error estimate for blocks of size 2^( 2) =       0.000390987583
  error estimate for blocks of size 2^( 3) =       0.000401246559
  error estimate for blocks of size 2^( 4) =       0.000409131983
  error estimate for blocks of size 2^( 5) =       0.000413970902
  error estimate for blocks of size 2^( 6) =       0.000416205436
  error estimate for blocks of size 2^( 7) =       0.000417536806

      target function =      -0.910644708477
              le_mean =     -17.215050498652
             les_mean =     296.659259758490
             stat err =       0.000414211282
             autocorr =       1.191429721287
   target nu stat err =       0.000414211282
   target dn stat err =       0.002282883782
      target stat err =       0.003599707583
              std dev =       0.536664300292
             le_variance =       0.288008571208


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910644708477        initial
     8.4703e+10     8.4703e+11             1.4378e-15        -0.910644708477
     3.3881e+11     3.3881e+12             3.6101e-16        -0.910644708477
     1.3553e+12     1.3553e+13             8.8690e-17        -0.910644708477  <--

*****************************************************************************
Applying the update for shift_i =   1.3553e+12     and shift_s =   1.3553e+13
*****************************************************************************

  Execution time = 2.3135e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9855e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.2329
    reference variance = 0.181927
====================================================
  Execution time = 1.3827e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5309e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9926e-01
  Total weights = 1.958024054e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284190780502
                                         uncertainty =       0.001698359182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284190780502
                                         uncertainty =       0.001698359182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376981148
  error estimate for blocks of size 2^( 2) =       0.000388403159
  error estimate for blocks of size 2^( 3) =       0.000398929188
  error estimate for blocks of size 2^( 4) =       0.000407128824
  error estimate for blocks of size 2^( 5) =       0.000413046262
  error estimate for blocks of size 2^( 6) =       0.000415843469
  error estimate for blocks of size 2^( 7) =       0.000416555026

      target function =      -0.913805467723
              le_mean =     -17.214570228283
             les_mean =     296.640689437668
             stat err =       0.000413143395
             autocorr =       1.201053528521
   target nu stat err =       0.000413143395
   target dn stat err =       0.003174128783
      target stat err =       0.004988183977
              std dev =       0.533131851865
             le_variance =       0.284229571473


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721457022828e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+11, overlap shift 3.3881e+12 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913831529161       residual = 4.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913831529161       residual = 6.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913831529161       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913831529161       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913831529132       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913890775623       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914023532061       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913945778918       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913211631685       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913409980421       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913816426075       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913677988431       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913768681714       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914506545529       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914054000507       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913443306996       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913572471133       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913564685858       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913673080922       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913334752161       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913365462711       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913799362032       residual = 7.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913606979763       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914134048999       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913571445424       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913988552756       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914606914514       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914038031604       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913345422006       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913619970719       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913444828695       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913212057088       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913841656559       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914146442302       residual = 8.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913573396805       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913903354723       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912847653312       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913684593078       residual = 9.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913655097294       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.913711268090       residual = 6.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.913959205295       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.913712808773       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.913716735980       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.913850977024       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.914022961536       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.913574466451       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.913656849024       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.914140097555       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.913961524889       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.913459698756       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.913407330839       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.914379229923       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.913681450049       residual = 1.34e-05           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.913178752051       residual = 1.76e-05           smallest_sin_value = 9.99e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.913294485845       residual = 1.82e-05           smallest_sin_value = 9.96e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.914745357153       residual = 6.16e-05           smallest_sin_value = 9.92e-01
davidson iteration   56 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         56 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+11 is 3.256190e-16

solving harmonic davidson linear method for identity shift 1.3553e+12, overlap shift 1.3553e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913831529161       residual = 4.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913831529161       residual = 6.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913831529161       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913831529161       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913831528620       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914437456142       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914984259138       residual = 5.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914714112896       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912886116184       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911916201030       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916868820346       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915098487930       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914464721378       residual = 7.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916472170684       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911794179157       residual = 7.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913844126684       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915426034834       residual = 6.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913937875835       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912391624505       residual = 9.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912341413755       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917692733821       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911259438101       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914645608706       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913848248896       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912069461359       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912038509882       residual = 6.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913495431915       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916921327638       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914746030006       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915390502270       residual = 4.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913008486690       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917112815503       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914768625402       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913392388036       residual = 7.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912747394436       residual = 6.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914445941402       residual = 8.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913251784375       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911510551509       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916331956971       residual = 7.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915011435806       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.913321436889       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.911330450455       residual = 6.64e-04           smallest_sin_value = 9.99e-01
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.914248052569       residual = 4.01e-04           smallest_sin_value = 9.99e-01
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.912291270144       residual = 6.65e-04           smallest_sin_value = 9.96e-01
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.913408563530       residual = 8.24e-04           smallest_sin_value = 9.93e-01
davidson iteration   45 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         45 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+12 is 7.888683e-17

solving harmonic davidson linear method for identity shift 5.4210e+12, overlap shift 5.4210e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913831529161       residual = 4.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913831529161       residual = 6.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913831529161       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914237188661       residual = 5.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909547465652       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913183305042       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919075947906       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914511477071       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907335679988       residual = 2.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924255536115       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915924514606       residual = 2.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910429115994       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.900612390246       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912392988194       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.921513087837       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912044355499       residual = 7.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910251333547       residual = 6.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911025964476       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918120471513       residual = 6.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917790689579       residual = 5.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920784356629       residual = 4.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918041676517       residual = 6.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911976184152       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919806168066       residual = 1.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.927840312177       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913919375055       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917623897362       residual = 4.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915246533601       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914927826060       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913771071230       residual = 9.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912979612921       residual = 8.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.906694917358       residual = 4.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918578644859       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913554259163       residual = 8.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917943370140       residual = 8.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912898375994       residual = 4.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.920418538840       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.919616910656       residual = 6.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.905043776272       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.920434428831       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.910747923818       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.911850362406       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.912573715887       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.919026782932       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.915216476265       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.915075976593       residual = 1.39e-02           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.907051557786       residual = 4.37e-03           smallest_sin_value = 9.98e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.913787952118       residual = 1.39e-02           smallest_sin_value = 9.93e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.912535281907       residual = 1.32e-02           smallest_sin_value = 9.91e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.913746436596       residual = 2.23e-02           smallest_sin_value = 9.90e-01
davidson iteration   50 stopping due to small subspace S singular value of 9.68e-01
davidson solver did not converge after         50 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+12 is 2.071732e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.298093 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6502e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.1916
    reference variance = 0.376617
====================================================
  Execution time = 1.3734e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0205e-01
  Total weights = 1.9580e+06
  Execution time = 1.8364e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288813526979
                                         uncertainty =       0.002675246110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288813526979
                                         uncertainty =       0.002675246110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380004850
  error estimate for blocks of size 2^( 2) =       0.000391309642
  error estimate for blocks of size 2^( 3) =       0.000401506238
  error estimate for blocks of size 2^( 4) =       0.000408868824
  error estimate for blocks of size 2^( 5) =       0.000414053265
  error estimate for blocks of size 2^( 6) =       0.000416375074
  error estimate for blocks of size 2^( 7) =       0.000417639529

      target function =      -0.909482378224
              le_mean =     -17.214591305871
             les_mean =     296.644207144164
             stat err =       0.000414234173
             autocorr =       1.188265720671
   target nu stat err =       0.000414234173
   target dn stat err =       0.003096658062
      target stat err =       0.004823861125
              std dev =       0.537408012700
             le_variance =       0.288807372114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288813526979
                                         uncertainty =       0.002675246110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288813526979
                                         uncertainty =       0.002675246110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380004850
  error estimate for blocks of size 2^( 2) =       0.000391309642
  error estimate for blocks of size 2^( 3) =       0.000401506238
  error estimate for blocks of size 2^( 4) =       0.000408868824
  error estimate for blocks of size 2^( 5) =       0.000414053265
  error estimate for blocks of size 2^( 6) =       0.000416375074
  error estimate for blocks of size 2^( 7) =       0.000417639529

      target function =      -0.909482378224
              le_mean =     -17.214591305871
             les_mean =     296.644207144164
             stat err =       0.000414234173
             autocorr =       1.188265720670
   target nu stat err =       0.000414234173
   target dn stat err =       0.003096658062
      target stat err =       0.004823861125
              std dev =       0.537408012700
             le_variance =       0.288807372114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288813526979
                                         uncertainty =       0.002675246110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288813526979
                                         uncertainty =       0.002675246110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380004850
  error estimate for blocks of size 2^( 2) =       0.000391309642
  error estimate for blocks of size 2^( 3) =       0.000401506238
  error estimate for blocks of size 2^( 4) =       0.000408868824
  error estimate for blocks of size 2^( 5) =       0.000414053265
  error estimate for blocks of size 2^( 6) =       0.000416375074
  error estimate for blocks of size 2^( 7) =       0.000417639529

      target function =      -0.909482378224
              le_mean =     -17.214591305871
             les_mean =     296.644207144164
             stat err =       0.000414234173
             autocorr =       1.188265720670
   target nu stat err =       0.000414234173
   target dn stat err =       0.003096658062
      target stat err =       0.004823861125
              std dev =       0.537408012700
             le_variance =       0.288807372114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288813526979
                                         uncertainty =       0.002675246110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288813526979
                                         uncertainty =       0.002675246110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380004850
  error estimate for blocks of size 2^( 2) =       0.000391309642
  error estimate for blocks of size 2^( 3) =       0.000401506238
  error estimate for blocks of size 2^( 4) =       0.000408868824
  error estimate for blocks of size 2^( 5) =       0.000414053265
  error estimate for blocks of size 2^( 6) =       0.000416375074
  error estimate for blocks of size 2^( 7) =       0.000417639529

      target function =      -0.909482378224
              le_mean =     -17.214591305871
             les_mean =     296.644207144164
             stat err =       0.000414234173
             autocorr =       1.188265720671
   target nu stat err =       0.000414234173
   target dn stat err =       0.003096658062
      target stat err =       0.004823861125
              std dev =       0.537408012700
             le_variance =       0.288807372114


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909482378224        initial
     3.3881e+11     3.3881e+12             3.2562e-16        -0.909482378224
     1.3553e+12     1.3553e+13             7.8887e-17        -0.909482378224
     5.4210e+12     5.4210e+13             2.0717e-17        -0.909482378224  <--

*****************************************************************************
Applying the update for shift_i =   5.4210e+12     and shift_s =   5.4210e+13
*****************************************************************************

  Execution time = 2.2969e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9492e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.2157
    reference variance = 0.151527
====================================================
  Execution time = 1.3724e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0211e-01
  Total weights = 1.957764689e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4901e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288062670890
                                         uncertainty =       0.002322383080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288062670890
                                         uncertainty =       0.002322383080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379542780
  error estimate for blocks of size 2^( 2) =       0.000391151707
  error estimate for blocks of size 2^( 3) =       0.000401359767
  error estimate for blocks of size 2^( 4) =       0.000408822156
  error estimate for blocks of size 2^( 5) =       0.000413714608
  error estimate for blocks of size 2^( 6) =       0.000417316476
  error estimate for blocks of size 2^( 7) =       0.000420666098

      target function =      -0.909405334566
              le_mean =     -17.214254677092
             les_mean =     296.632672399071
             stat err =       0.000415129834
             autocorr =       1.196317407730
   target nu stat err =       0.000415129834
   target dn stat err =       0.003457436316
      target stat err =       0.005370537814
              std dev =       0.536754547637
             le_variance =       0.288105444409


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721425467709e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+12, overlap shift 1.3553e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909435889720       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909435889720       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909435889720       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909435889720       residual = 6.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909435889720       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909435840116       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909419458182       residual = 9.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907039794280       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907754368320       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910413675926       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908288781557       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908736073587       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911572801972       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.909911058078       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911294470960       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911361710960       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.909795353950       residual = 5.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.909169538600       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.908855826266       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910291441517       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.908633797735       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909639815419       residual = 8.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.909213811725       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.909723141147       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.907316664097       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910088054956       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911106362600       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910241208124       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911109437642       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910690155916       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910483318879       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.908764809134       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.909257439732       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.909266104560       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.910524551180       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910090807499       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.908288003797       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.910405128172       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.910179776501       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.911311067832       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.909006769550       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.908569780176       residual = 9.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.909393990483       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.910077183041       residual = 9.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.908502606216       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.910007509115       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.909322688086       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.909212933479       residual = 4.96e-05           smallest_sin_value = 9.99e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.910848677517       residual = 2.70e-04           smallest_sin_value = 9.97e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.909793042255       residual = 5.28e-04           smallest_sin_value = 9.92e-01
davidson iteration   50 stopping due to small subspace S singular value of 9.66e-01
davidson solver did not converge after         50 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+12 is 1.124783e-16

solving harmonic davidson linear method for identity shift 5.4210e+12, overlap shift 5.4210e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909435889720       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909435889720       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909435889720       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909435889720       residual = 6.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909589996891       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909438207157       residual = 8.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907154355934       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914839768583       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931731526033       residual = 9.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926596132198       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.892827873376       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906398948253       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.902693267691       residual = 8.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.902445716460       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.895032696372       residual = 8.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922679829412       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915718432209       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.886783534151       residual = 5.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.908912167704       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911977694953       residual = 8.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911428261150       residual = 2.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910231121469       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.906457135615       residual = 5.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.909485994606       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.907559760556       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909564764214       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913469371381       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.906781304385       residual = 7.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913616158800       residual = 8.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910581864627       residual = 4.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910708216594       residual = 1.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913572885038       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.909999949910       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.907433872363       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.906220380635       residual = 9.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910944445861       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.909784241109       residual = 3.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.908049551607       residual = 7.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.908627800750       residual = 1.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.909804962343       residual = 4.17e-03           smallest_sin_value = 9.99e-01
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.907890104700       residual = 1.28e-02           smallest_sin_value = 9.99e-01
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.913137406600       residual = 3.37e-03           smallest_sin_value = 9.98e-01
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.906275347847       residual = 2.11e-03           smallest_sin_value = 9.97e-01
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.910613873891       residual = 9.04e-03           smallest_sin_value = 9.91e-01
davidson iteration   44 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         44 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+12 is 2.994933e-17

solving harmonic davidson linear method for identity shift 2.1684e+13, overlap shift 2.1684e+14 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909435889720       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909435889720       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.381802 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6304e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.1995
    reference variance = 0.304705
====================================================
  Execution time = 1.3638e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0244e-01
  Total weights = 1.9580e+06
  Execution time = 1.8345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287549461036
                                         uncertainty =       0.001901802440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287549461036
                                         uncertainty =       0.001901802440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379213012
  error estimate for blocks of size 2^( 2) =       0.000390743013
  error estimate for blocks of size 2^( 3) =       0.000401088393
  error estimate for blocks of size 2^( 4) =       0.000408527294
  error estimate for blocks of size 2^( 5) =       0.000414549490
  error estimate for blocks of size 2^( 6) =       0.000418155692
  error estimate for blocks of size 2^( 7) =       0.000418836555

      target function =      -0.908892600182
              le_mean =     -17.214579038360
             les_mean =     296.644167640056
             stat err =       0.000415017258
             autocorr =       1.197749094157
   target nu stat err =       0.000415017258
   target dn stat err =       0.003150781287
      target stat err =       0.004900187185
              std dev =       0.536288184578
             le_variance =       0.287605016918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287549461036
                                         uncertainty =       0.001901802440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287549461036
                                         uncertainty =       0.001901802440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379213012
  error estimate for blocks of size 2^( 2) =       0.000390743013
  error estimate for blocks of size 2^( 3) =       0.000401088393
  error estimate for blocks of size 2^( 4) =       0.000408527294
  error estimate for blocks of size 2^( 5) =       0.000414549490
  error estimate for blocks of size 2^( 6) =       0.000418155692
  error estimate for blocks of size 2^( 7) =       0.000418836555

      target function =      -0.908892600182
              le_mean =     -17.214579038360
             les_mean =     296.644167640056
             stat err =       0.000415017258
             autocorr =       1.197749094156
   target nu stat err =       0.000415017258
   target dn stat err =       0.003150781287
      target stat err =       0.004900187185
              std dev =       0.536288184578
             le_variance =       0.287605016918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287549461036
                                         uncertainty =       0.001901802440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287549461036
                                         uncertainty =       0.001901802440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379213012
  error estimate for blocks of size 2^( 2) =       0.000390743013
  error estimate for blocks of size 2^( 3) =       0.000401088393
  error estimate for blocks of size 2^( 4) =       0.000408527294
  error estimate for blocks of size 2^( 5) =       0.000414549490
  error estimate for blocks of size 2^( 6) =       0.000418155692
  error estimate for blocks of size 2^( 7) =       0.000418836555

      target function =      -0.908892600182
              le_mean =     -17.214579038360
             les_mean =     296.644167640056
             stat err =       0.000415017258
             autocorr =       1.197749094155
   target nu stat err =       0.000415017258
   target dn stat err =       0.003150781287
      target stat err =       0.004900187185
              std dev =       0.536288184578
             le_variance =       0.287605016918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287549461036
                                         uncertainty =       0.001901802440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287549461036
                                         uncertainty =       0.001901802440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379213012
  error estimate for blocks of size 2^( 2) =       0.000390743013
  error estimate for blocks of size 2^( 3) =       0.000401088393
  error estimate for blocks of size 2^( 4) =       0.000408527294
  error estimate for blocks of size 2^( 5) =       0.000414549490
  error estimate for blocks of size 2^( 6) =       0.000418155692
  error estimate for blocks of size 2^( 7) =       0.000418836555

      target function =      -0.908892600182
              le_mean =     -17.214579038360
             les_mean =     296.644167640056
             stat err =       0.000415017258
             autocorr =       1.197749094155
   target nu stat err =       0.000415017258
   target dn stat err =       0.003150781287
      target stat err =       0.004900187185
              std dev =       0.536288184578
             le_variance =       0.287605016918


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908892600182        initial
     1.3553e+12     1.3553e+13             1.1248e-16        -0.908892600182
     5.4210e+12     5.4210e+13             2.9949e-17        -0.908892600182  <--
     2.1684e+13     2.1684e+14             0.0000e+00        -0.908892600182

*****************************************************************************
Applying the update for shift_i =   5.4210e+12     and shift_s =   5.4210e+13
*****************************************************************************

  Execution time = 2.2920e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9230e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.066
    reference variance = 0.253863
====================================================
  Execution time = 1.3887e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0429e-01
  Total weights = 1.957285108e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4724e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290125013405
                                         uncertainty =       0.002331785099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290125013405
                                         uncertainty =       0.002331785099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380846029
  error estimate for blocks of size 2^( 2) =       0.000392323319
  error estimate for blocks of size 2^( 3) =       0.000402508789
  error estimate for blocks of size 2^( 4) =       0.000410206794
  error estimate for blocks of size 2^( 5) =       0.000415028643
  error estimate for blocks of size 2^( 6) =       0.000417333203
  error estimate for blocks of size 2^( 7) =       0.000420381856

      target function =      -0.906024314131
              le_mean =     -17.215048742105
             les_mean =     296.662194898815
             stat err =       0.000415737624
             autocorr =       1.191625523370
   target nu stat err =       0.000415737624
   target dn stat err =       0.003102811765
      target stat err =       0.004801408806
              std dev =       0.538597618980
             le_variance =       0.290087395171


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721504874211e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+12, overlap shift 1.3553e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906048935494       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906048935494       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906048935494       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906047741354       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906211285404       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906765836659       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907498715891       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906592771941       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906131269769       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905703628712       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910851116667       residual = 9.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906339205520       residual = 6.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.905608551667       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.905866362833       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.906954710538       residual = 8.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.904240701111       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.904968928428       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.906196680699       residual = 9.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.906443715121       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.905635242579       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.905721273154       residual = 9.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.907250695240       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.904042434973       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.904502596025       residual = 6.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.908124572508       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908116791361       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.905047895640       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.904250197453       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.903537096209       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908023135936       residual = 6.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.905516214727       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.905082997978       residual = 6.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.907991072643       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.906250835231       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.905643117236       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.907705719477       residual = 9.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.903937885463       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.904641813187       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.905132394792       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.903393860680       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.905605009534       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.906779287875       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.906868232697       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.906423356637       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.905907156705       residual = 8.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.905626448077       residual = 8.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.908204309453       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.906378805002       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.903203216190       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.905458233249       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.905986045272       residual = 6.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.905731377331       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.905219792337       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.906329348066       residual = 1.20e-04           smallest_sin_value = 9.99e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.904748731011       residual = 5.00e-04           smallest_sin_value = 9.99e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.905189437359       residual = 7.25e-04           smallest_sin_value = 9.97e-01
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.907126898065       residual = 4.48e-04           smallest_sin_value = 9.96e-01
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.907500261033       residual = 8.21e-04           smallest_sin_value = 9.92e-01
davidson iteration   58 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         58 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+12 is 1.365804e-16

solving harmonic davidson linear method for identity shift 5.4210e+12, overlap shift 5.4210e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906048935494       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906048935494       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906048935494       residual = 9.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906048935494       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904997880328       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905824142873       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913092684281       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910094830504       residual = 5.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.899322339886       residual = 5.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902573848842       residual = 2.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.904866909528       residual = 4.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908791101758       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.905236671572       residual = 6.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.903729584097       residual = 5.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922263668338       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.897311514199       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919453690685       residual = 6.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916782644636       residual = 5.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916757940200       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.907400410812       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.904938320134       residual = 3.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.903363793933       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.906325900545       residual = 4.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.909124540941       residual = 8.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.908286202017       residual = 8.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.900433275188       residual = 5.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911870018911       residual = 6.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913149163325       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.897790990797       residual = 7.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.906896671686       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.892077878832       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909755380499       residual = 7.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910351132755       residual = 5.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908054385509       residual = 6.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.907592378406       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.897641396005       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912259191202       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915619388647       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.903577170939       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.901991412901       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.914951283826       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.909293166045       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.911981482790       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.903228747734       residual = 9.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.898109685552       residual = 3.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.908353340038       residual = 5.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.911291048775       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.900676774155       residual = 6.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.911602672636       residual = 4.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.898305537921       residual = 5.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.906418888454       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.907545370324       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.916320680787       residual = 1.40e-02           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.917925978088       residual = 1.05e-02           smallest_sin_value = 9.99e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.917304415945       residual = 3.38e-03           smallest_sin_value = 9.98e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.901518830302       residual = 1.57e-02           smallest_sin_value = 9.98e-01
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.905843389221       residual = 9.45e-03           smallest_sin_value = 9.98e-01
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.907757709380       residual = 9.48e-02           smallest_sin_value = 9.95e-01
davidson iteration   58 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         58 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+12 is 2.864629e-17

solving harmonic davidson linear method for identity shift 2.1684e+13, overlap shift 2.1684e+14 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906048935494       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906048935494       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.32e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.536583 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6524e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.2565
    reference variance = 0.472944
====================================================
  Execution time = 1.3543e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0288e-01
  Total weights = 1.9576e+06
  Execution time = 1.8419e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287710914440
                                         uncertainty =       0.001844285666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287710914440
                                         uncertainty =       0.001844285666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379310846
  error estimate for blocks of size 2^( 2) =       0.000390693282
  error estimate for blocks of size 2^( 3) =       0.000400995939
  error estimate for blocks of size 2^( 4) =       0.000408787726
  error estimate for blocks of size 2^( 5) =       0.000413991328
  error estimate for blocks of size 2^( 6) =       0.000417605398
  error estimate for blocks of size 2^( 7) =       0.000417974327

      target function =      -0.908193236934
              le_mean =     -17.214577040198
             les_mean =     296.644545765961
             stat err =       0.000414589695
             autocorr =       1.194665945287
   target nu stat err =       0.000414589695
   target dn stat err =       0.003813667409
      target stat err =       0.005902672044
              std dev =       0.536426542470
             le_variance =       0.287753435467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287710914440
                                         uncertainty =       0.001844285666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287710914440
                                         uncertainty =       0.001844285666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379310846
  error estimate for blocks of size 2^( 2) =       0.000390693282
  error estimate for blocks of size 2^( 3) =       0.000400995939
  error estimate for blocks of size 2^( 4) =       0.000408787726
  error estimate for blocks of size 2^( 5) =       0.000413991328
  error estimate for blocks of size 2^( 6) =       0.000417605398
  error estimate for blocks of size 2^( 7) =       0.000417974327

      target function =      -0.908193236934
              le_mean =     -17.214577040198
             les_mean =     296.644545765961
             stat err =       0.000414589695
             autocorr =       1.194665945288
   target nu stat err =       0.000414589695
   target dn stat err =       0.003813667409
      target stat err =       0.005902672044
              std dev =       0.536426542470
             le_variance =       0.287753435467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287710914440
                                         uncertainty =       0.001844285666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287710914440
                                         uncertainty =       0.001844285666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379310846
  error estimate for blocks of size 2^( 2) =       0.000390693282
  error estimate for blocks of size 2^( 3) =       0.000400995939
  error estimate for blocks of size 2^( 4) =       0.000408787726
  error estimate for blocks of size 2^( 5) =       0.000413991328
  error estimate for blocks of size 2^( 6) =       0.000417605398
  error estimate for blocks of size 2^( 7) =       0.000417974327

      target function =      -0.908193236934
              le_mean =     -17.214577040198
             les_mean =     296.644545765961
             stat err =       0.000414589695
             autocorr =       1.194665945288
   target nu stat err =       0.000414589695
   target dn stat err =       0.003813667409
      target stat err =       0.005902672044
              std dev =       0.536426542470
             le_variance =       0.287753435467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287710914440
                                         uncertainty =       0.001844285666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287710914440
                                         uncertainty =       0.001844285666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379310846
  error estimate for blocks of size 2^( 2) =       0.000390693282
  error estimate for blocks of size 2^( 3) =       0.000400995939
  error estimate for blocks of size 2^( 4) =       0.000408787726
  error estimate for blocks of size 2^( 5) =       0.000413991328
  error estimate for blocks of size 2^( 6) =       0.000417605398
  error estimate for blocks of size 2^( 7) =       0.000417974327

      target function =      -0.908193236934
              le_mean =     -17.214577040198
             les_mean =     296.644545765961
             stat err =       0.000414589695
             autocorr =       1.194665945287
   target nu stat err =       0.000414589695
   target dn stat err =       0.003813667409
      target stat err =       0.005902672044
              std dev =       0.536426542470
             le_variance =       0.287753435467


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908193236934        initial
     1.3553e+12     1.3553e+13             1.3658e-16        -0.908193236934  <--
     5.4210e+12     5.4210e+13             2.8646e-17        -0.908193236934
     2.1684e+13     2.1684e+14             0.0000e+00        -0.908193236934

*****************************************************************************
Applying the update for shift_i =   1.3553e+12     and shift_s =   1.3553e+13
*****************************************************************************

  Execution time = 2.2810e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9343e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.1579
    reference variance = 0.138428
====================================================
  Execution time = 1.3814e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9951e-01
  Total weights = 1.957883159e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284866439722
                                         uncertainty =       0.001558723760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284866439722
                                         uncertainty =       0.001558723760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377399480
  error estimate for blocks of size 2^( 2) =       0.000388677225
  error estimate for blocks of size 2^( 3) =       0.000398888074
  error estimate for blocks of size 2^( 4) =       0.000406105178
  error estimate for blocks of size 2^( 5) =       0.000410280281
  error estimate for blocks of size 2^( 6) =       0.000413208335
  error estimate for blocks of size 2^( 7) =       0.000415982053

      target function =      -0.913402358600
              le_mean =     -17.215039491294
             les_mean =     296.657097030656
             stat err =       0.000411393962
             autocorr =       1.188264797253
   target nu stat err =       0.000411393962
   target dn stat err =       0.002962616955
      target stat err =       0.004662176373
              std dev =       0.533723463351
             le_variance =       0.284860735332


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721503949129e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+11, overlap shift 3.3881e+12 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913425216225       residual = 2.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913425216225       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913425216225       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913425216225       residual = 8.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913425252629       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913436943074       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913702905144       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914529747486       residual = 9.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913674582339       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912723310960       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912883138139       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913884488147       residual = 5.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913493484458       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913394809410       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913367674625       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913530876606       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913504857122       residual = 7.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913471798463       residual = 8.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913436340171       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913274209861       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913388547306       residual = 9.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913495844307       residual = 5.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913427423217       residual = 6.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913461184171       residual = 7.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913616454998       residual = 6.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913429089640       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913384385449       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913403619574       residual = 7.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913477501135       residual = 7.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913423113815       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913331501158       residual = 4.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913528427353       residual = 6.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913362037155       residual = 8.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913379944793       residual = 6.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913267181816       residual = 5.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913352049337       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913369969416       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913414566757       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913448134339       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.913604906532       residual = 4.52e-05           smallest_sin_value = 9.99e-01
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.913428412220       residual = 1.02e-05           smallest_sin_value = 9.99e-01
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.913400976484       residual = 4.19e-05           smallest_sin_value = 9.98e-01
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.913419143796       residual = 8.06e-05           smallest_sin_value = 9.98e-01
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.913501782601       residual = 4.27e-06           smallest_sin_value = 9.97e-01
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.913395949425       residual = 2.63e-06           smallest_sin_value = 9.97e-01
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.913573276286       residual = 1.44e-05           smallest_sin_value = 9.94e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.913343034816       residual = 6.26e-06           smallest_sin_value = 9.94e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.913625174344       residual = 1.90e-05           smallest_sin_value = 9.94e-01
davidson iteration   48 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         48 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+11 is 4.961201e-16

solving harmonic davidson linear method for identity shift 1.3553e+12, overlap shift 1.3553e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913425216225       residual = 2.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913425216225       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913425216225       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913425216224       residual = 8.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913409162311       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913424748857       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914386398605       residual = 5.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913941361979       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910915941654       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916893855342       residual = 7.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911420536667       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914194876887       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912081500565       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916479194919       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913585516059       residual = 5.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914125176783       residual = 6.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912556073382       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913379077263       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913982704423       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913057921776       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913958298045       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912407606045       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914262590663       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912652948818       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913999812528       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914105862392       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913477971027       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912699829144       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913085801151       residual = 8.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913705463578       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913383746277       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913518251829       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914856537626       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912765163244       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914666031999       residual = 6.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912116304789       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913771898471       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913177110385       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912614073648       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.913505306138       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.912878437668       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.913771348805       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.913097745026       residual = 9.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.913295920834       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.911582382250       residual = 6.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.912361209614       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.913005364207       residual = 8.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.913685579182       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.913007154892       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.914920605513       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.914072823125       residual = 2.81e-04           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.912547915799       residual = 3.98e-04           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.912836223927       residual = 2.20e-04           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.913370636441       residual = 5.65e-04           smallest_sin_value = 9.98e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.913026526316       residual = 2.06e-04           smallest_sin_value = 9.98e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.916329252478       residual = 2.42e-04           smallest_sin_value = 9.97e-01
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.913332936655       residual = 6.05e-04           smallest_sin_value = 9.96e-01
davidson iteration   57 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         57 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+12 is 1.182345e-16

solving harmonic davidson linear method for identity shift 5.4210e+12, overlap shift 5.4210e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913425216225       residual = 2.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913425216225       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913425216225       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913425216225       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913425209871       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913925915626       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913888432723       residual = 8.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916826571766       residual = 5.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919036731933       residual = 6.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914498554751       residual = 6.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.927342016333       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917078369355       residual = 4.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912465777727       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914713282541       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914525007084       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913882938915       residual = 4.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913041741146       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912734972695       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916210138002       residual = 6.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914080627993       residual = 1.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914141244640       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914982035424       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910993427097       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911920261533       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915411335765       residual = 9.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909948860575       residual = 8.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913831833631       residual = 7.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914196383183       residual = 1.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913927594791       residual = 1.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913464414791       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914424479868       residual = 1.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912393176395       residual = 1.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914251610866       residual = 1.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911787190217       residual = 1.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915685594088       residual = 5.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912888864367       residual = 4.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912083372125       residual = 3.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915561034894       residual = 3.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915709677529       residual = 7.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914606544230       residual = 4.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.914570090938       residual = 3.09e-01           smallest_sin_value = 9.99e-01
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.915819523364       residual = 2.59e-01           smallest_sin_value = 9.95e-01
davidson iteration   42 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         42 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+12 is 3.172343e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.679972 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6442e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.2551
    reference variance = 0.252793
====================================================
  Execution time = 1.3470e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9582e-01
  Total weights = 1.9578e+06
  Execution time = 1.8365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284632766072
                                         uncertainty =       0.001522317263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284632766072
                                         uncertainty =       0.001522317263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377263263
  error estimate for blocks of size 2^( 2) =       0.000388710957
  error estimate for blocks of size 2^( 3) =       0.000398487894
  error estimate for blocks of size 2^( 4) =       0.000406339945
  error estimate for blocks of size 2^( 5) =       0.000410634693
  error estimate for blocks of size 2^( 6) =       0.000412792489
  error estimate for blocks of size 2^( 7) =       0.000414384925

      target function =      -0.919192075407
              le_mean =     -17.214817009619
             les_mean =     296.645748413214
             stat err =       0.000411038013
             autocorr =       1.187066207908
   target nu stat err =       0.000411038013
   target dn stat err =       0.002272216616
      target stat err =       0.003647173517
              std dev =       0.533530822886
             le_variance =       0.284655138969

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284632766072
                                         uncertainty =       0.001522317263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284632766072
                                         uncertainty =       0.001522317263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377263263
  error estimate for blocks of size 2^( 2) =       0.000388710957
  error estimate for blocks of size 2^( 3) =       0.000398487894
  error estimate for blocks of size 2^( 4) =       0.000406339945
  error estimate for blocks of size 2^( 5) =       0.000410634693
  error estimate for blocks of size 2^( 6) =       0.000412792489
  error estimate for blocks of size 2^( 7) =       0.000414384925

      target function =      -0.919192075407
              le_mean =     -17.214817009619
             les_mean =     296.645748413214
             stat err =       0.000411038013
             autocorr =       1.187066207907
   target nu stat err =       0.000411038013
   target dn stat err =       0.002272216616
      target stat err =       0.003647173517
              std dev =       0.533530822886
             le_variance =       0.284655138969

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284632766072
                                         uncertainty =       0.001522317263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284632766072
                                         uncertainty =       0.001522317263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377263263
  error estimate for blocks of size 2^( 2) =       0.000388710957
  error estimate for blocks of size 2^( 3) =       0.000398487894
  error estimate for blocks of size 2^( 4) =       0.000406339945
  error estimate for blocks of size 2^( 5) =       0.000410634693
  error estimate for blocks of size 2^( 6) =       0.000412792489
  error estimate for blocks of size 2^( 7) =       0.000414384925

      target function =      -0.919192075407
              le_mean =     -17.214817009619
             les_mean =     296.645748413214
             stat err =       0.000411038013
             autocorr =       1.187066207903
   target nu stat err =       0.000411038013
   target dn stat err =       0.002272216616
      target stat err =       0.003647173517
              std dev =       0.533530822886
             le_variance =       0.284655138969

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284632766072
                                         uncertainty =       0.001522317263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284632766072
                                         uncertainty =       0.001522317263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377263263
  error estimate for blocks of size 2^( 2) =       0.000388710957
  error estimate for blocks of size 2^( 3) =       0.000398487894
  error estimate for blocks of size 2^( 4) =       0.000406339945
  error estimate for blocks of size 2^( 5) =       0.000410634693
  error estimate for blocks of size 2^( 6) =       0.000412792489
  error estimate for blocks of size 2^( 7) =       0.000414384925

      target function =      -0.919192075407
              le_mean =     -17.214817009619
             les_mean =     296.645748413214
             stat err =       0.000411038013
             autocorr =       1.187066207910
   target nu stat err =       0.000411038013
   target dn stat err =       0.002272216616
      target stat err =       0.003647173517
              std dev =       0.533530822886
             le_variance =       0.284655138969


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919192075407        initial
     3.3881e+11     3.3881e+12             4.9612e-16        -0.919192075407
     1.3553e+12     1.3553e+13             1.1823e-16        -0.919192075407
     5.4210e+12     5.4210e+13             3.1723e-17        -0.919192075407  <--

*****************************************************************************
Applying the update for shift_i =   5.4210e+12     and shift_s =   5.4210e+13
*****************************************************************************

  Execution time = 2.2703e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9152e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.2409
    reference variance = 0.176564
====================================================
  Execution time = 1.3861e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5318e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9929e-01
  Total weights = 1.957725401e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286079374960
                                         uncertainty =       0.002024143873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286079374960
                                         uncertainty =       0.002024143873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378413599
  error estimate for blocks of size 2^( 2) =       0.000389707207
  error estimate for blocks of size 2^( 3) =       0.000400147332
  error estimate for blocks of size 2^( 4) =       0.000407749361
  error estimate for blocks of size 2^( 5) =       0.000412665429
  error estimate for blocks of size 2^( 6) =       0.000414425813
  error estimate for blocks of size 2^( 7) =       0.000415478331

      target function =      -0.913792720700
              le_mean =     -17.214004771181
             les_mean =     296.621246166964
             stat err =       0.000412579734
             autocorr =       1.188727506717
   target nu stat err =       0.000412579734
   target dn stat err =       0.002676451495
      target stat err =       0.004218286057
              std dev =       0.535157643744
             le_variance =       0.286393703657


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721400477118e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+12, overlap shift 1.3553e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913811076196       residual = 6.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913811076196       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913811076196       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913811076196       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914052715318       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913810702000       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913694526924       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914466237102       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913057860157       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915325946979       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912490251953       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916155605333       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913439854866       residual = 4.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912702200038       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913811842629       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917277179718       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917410252065       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916320734328       residual = 6.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912877835330       residual = 7.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913476114895       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911760933613       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910381312193       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914027730056       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913840490335       residual = 8.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913686748864       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913877320120       residual = 6.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912792095314       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914246556103       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911602381540       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911680026920       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913934774661       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913622902159       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914085464710       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913334647637       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914596510435       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911826215677       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914419889834       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914452489400       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913746452125       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914234118507       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.915518406480       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.914249219780       residual = 9.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.914325245498       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.913941362906       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.914075661632       residual = 1.49e-04           smallest_sin_value = 9.99e-01
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.912788006694       residual = 4.54e-04           smallest_sin_value = 9.98e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.915367211224       residual = 3.65e-04           smallest_sin_value = 9.97e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.916445153072       residual = 9.04e-04           smallest_sin_value = 9.91e-01
davidson iteration   48 stopping due to small subspace S singular value of 9.58e-01
davidson solver did not converge after         48 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+12 is 7.149408e-17

solving harmonic davidson linear method for identity shift 5.4210e+12, overlap shift 5.4210e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913811076196       residual = 6.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913811076196       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913811076196       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913811076197       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911483010817       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914646199970       residual = 9.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909327602602       residual = 8.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907881194426       residual = 7.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908214805897       residual = 2.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914654385288       residual = 1.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920951737584       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.901877710002       residual = 3.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.906932795255       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.903996752127       residual = 2.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.927768586901       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929601268168       residual = 4.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913860486843       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912401217009       residual = 8.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913682706175       residual = 8.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916147839270       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.909070628203       residual = 3.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914123949436       residual = 3.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910554265529       residual = 3.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914893461510       residual = 4.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914397562017       residual = 2.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914902896799       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910932765302       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912521593338       residual = 6.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.921235485607       residual = 8.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910081610736       residual = 8.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.923463534605       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909712722783       residual = 8.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918538007229       residual = 6.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.909111113718       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916228466538       residual = 8.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918606672913       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911627988711       residual = 9.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.918305097140       residual = 5.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913219159555       residual = 8.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914163005627       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.915325509316       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.909457344280       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.911671373735       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.916937233955       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.913821288967       residual = 7.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.918440150947       residual = 1.10e-02           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.910987607757       residual = 2.38e-02           smallest_sin_value = 9.97e-01
davidson iteration   47 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         47 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+12 is 1.929940e-17

solving harmonic davidson linear method for identity shift 2.1684e+13, overlap shift 2.1684e+14 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913811076196       residual = 6.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913811076196       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913811076196       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913811076196       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916358466360       residual = 6.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905133326339       residual = 3.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910620737218       residual = 3.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.928363537161       residual = 1.40e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931732682093       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926852721075       residual = 1.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.871939455416       residual = 1.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920371783387       residual = 2.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.869411535790       residual = 3.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934332953625       residual = 4.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.871611031201       residual = 8.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.898108042718       residual = 5.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919238117839       residual = 8.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912925469092       residual = 8.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910574583923       residual = 9.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.926259303387       residual = 1.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912503182170       residual = 7.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909181527999       residual = 2.96e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919838725750       residual = 4.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912850499096       residual = 7.72e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.891852230766       residual = 1.30e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909566791127       residual = 2.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.927260414377       residual = 3.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.904479015682       residual = 4.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913683948953       residual = 4.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917558149776       residual = 1.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910535963162       residual = 1.79e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909415936771       residual = 8.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912953024473       residual = 8.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.925837169924       residual = 1.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912762773440       residual = 9.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.924371124485       residual = 1.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913000910889       residual = 1.79e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916707297346       residual = 2.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.904880671185       residual = 1.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.910385638474       residual = 8.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.915786836258       residual = 1.09e+00           smallest_sin_value = 9.99e-01
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.911456074496       residual = 2.21e+00           smallest_sin_value = 9.98e-01
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.912607374259       residual = 2.26e-02           smallest_sin_value = 9.95e-01
davidson iteration   43 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         43 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+13 is 3.971207e-18

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.793038 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6471e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.2553
    reference variance = 0.414771
====================================================
  Execution time = 1.3693e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0526e-01
  Total weights = 1.9573e+06
  Execution time = 1.8393e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288545398564
                                         uncertainty =       0.002144847241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288545398564
                                         uncertainty =       0.002144847241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379826583
  error estimate for blocks of size 2^( 2) =       0.000390977882
  error estimate for blocks of size 2^( 3) =       0.000401467074
  error estimate for blocks of size 2^( 4) =       0.000409238667
  error estimate for blocks of size 2^( 5) =       0.000414051292
  error estimate for blocks of size 2^( 6) =       0.000417804807
  error estimate for blocks of size 2^( 7) =       0.000419236561

      target function =      -0.904549436881
              le_mean =     -17.214845306936
             les_mean =     296.656155264820
             stat err =       0.000415082832
             autocorr =       1.194259841716
   target nu stat err =       0.000415082832
   target dn stat err =       0.003719488520
      target stat err =       0.005716159022
              std dev =       0.537155905155
             le_variance =       0.288536466442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288545398564
                                         uncertainty =       0.002144847241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288545398564
                                         uncertainty =       0.002144847241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379826583
  error estimate for blocks of size 2^( 2) =       0.000390977882
  error estimate for blocks of size 2^( 3) =       0.000401467074
  error estimate for blocks of size 2^( 4) =       0.000409238667
  error estimate for blocks of size 2^( 5) =       0.000414051292
  error estimate for blocks of size 2^( 6) =       0.000417804807
  error estimate for blocks of size 2^( 7) =       0.000419236561

      target function =      -0.904549436881
              le_mean =     -17.214845306936
             les_mean =     296.656155264820
             stat err =       0.000415082832
             autocorr =       1.194259841718
   target nu stat err =       0.000415082832
   target dn stat err =       0.003719488520
      target stat err =       0.005716159022
              std dev =       0.537155905155
             le_variance =       0.288536466442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288545398564
                                         uncertainty =       0.002144847241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288545398564
                                         uncertainty =       0.002144847241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379826583
  error estimate for blocks of size 2^( 2) =       0.000390977882
  error estimate for blocks of size 2^( 3) =       0.000401467074
  error estimate for blocks of size 2^( 4) =       0.000409238667
  error estimate for blocks of size 2^( 5) =       0.000414051292
  error estimate for blocks of size 2^( 6) =       0.000417804807
  error estimate for blocks of size 2^( 7) =       0.000419236561

      target function =      -0.904549436881
              le_mean =     -17.214845306936
             les_mean =     296.656155264820
             stat err =       0.000415082832
             autocorr =       1.194259841715
   target nu stat err =       0.000415082832
   target dn stat err =       0.003719488520
      target stat err =       0.005716159022
              std dev =       0.537155905155
             le_variance =       0.288536466442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288545398564
                                         uncertainty =       0.002144847241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288545398564
                                         uncertainty =       0.002144847241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379826583
  error estimate for blocks of size 2^( 2) =       0.000390977882
  error estimate for blocks of size 2^( 3) =       0.000401467074
  error estimate for blocks of size 2^( 4) =       0.000409238667
  error estimate for blocks of size 2^( 5) =       0.000414051292
  error estimate for blocks of size 2^( 6) =       0.000417804807
  error estimate for blocks of size 2^( 7) =       0.000419236561

      target function =      -0.904549436881
              le_mean =     -17.214845306936
             les_mean =     296.656155264820
             stat err =       0.000415082832
             autocorr =       1.194259841719
   target nu stat err =       0.000415082832
   target dn stat err =       0.003719488520
      target stat err =       0.005716159022
              std dev =       0.537155905155
             le_variance =       0.288536466442


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904549436881        initial
     1.3553e+12     1.3553e+13             7.1494e-17        -0.904549436881
     5.4210e+12     5.4210e+13             1.9299e-17        -0.904549436881
     2.1684e+13     2.1684e+14             3.9712e-18        -0.904549436881  <--

*****************************************************************************
Applying the update for shift_i =   2.1684e+13     and shift_s =   2.1684e+14
*****************************************************************************

  Execution time = 2.6359e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2836e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.191
    reference variance = 0.223614
====================================================
  Execution time = 1.4043e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0599e-01
  Total weights = 1.957792065e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4947e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291463226549
                                         uncertainty =       0.004865079360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291463226549
                                         uncertainty =       0.004865079360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381691121
  error estimate for blocks of size 2^( 2) =       0.000393071923
  error estimate for blocks of size 2^( 3) =       0.000402994270
  error estimate for blocks of size 2^( 4) =       0.000410445563
  error estimate for blocks of size 2^( 5) =       0.000415459960
  error estimate for blocks of size 2^( 6) =       0.000417906197
  error estimate for blocks of size 2^( 7) =       0.000420598328

      target function =      -0.903391957035
              le_mean =     -17.214452880760
             les_mean =     296.643376541549
             stat err =       0.000416102512
             autocorr =       1.188438082375
   target nu stat err =       0.000416102512
   target dn stat err =       0.006203862922
      target stat err =       0.009457944134
              std dev =       0.539792760595
             le_variance =       0.291376224390


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721445288076e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+12, overlap shift 5.4210e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903489334415       residual = 6.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903489334415       residual = 5.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903489334415       residual = 8.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903489334412       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903810684558       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904506716114       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903297819786       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903743463019       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901762208743       residual = 5.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902671186711       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905527330042       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.901175852139       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.899965453711       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.900738155834       residual = 8.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.904195072179       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.902253851599       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.899839601330       residual = 6.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.903055776652       residual = 6.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.903410311159       residual = 3.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.903838835049       residual = 4.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.903277206057       residual = 4.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.903427760248       residual = 1.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.904496632436       residual = 9.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.902035012349       residual = 2.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.902393683930       residual = 1.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.904005620911       residual = 2.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.905477570843       residual = 2.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.901876144590       residual = 2.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.906791905591       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.901952910603       residual = 6.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.901889216162       residual = 5.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.902294724756       residual = 1.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.900575001536       residual = 3.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.904367918085       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.902390897371       residual = 2.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.902947818641       residual = 1.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.908486388604       residual = 4.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.903972826912       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.902668284578       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.905016374105       residual = 2.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.904544949756       residual = 3.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.902856397290       residual = 2.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.904363709673       residual = 2.74e-02           smallest_sin_value = 9.98e-01
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.899624771110       residual = 2.29e-02           smallest_sin_value = 9.96e-01
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.902492748911       residual = 8.96e-03           smallest_sin_value = 9.90e-01
davidson iteration   45 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         45 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+12 is 6.240354e-17

solving harmonic davidson linear method for identity shift 2.1684e+13, overlap shift 2.1684e+14 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903489334415       residual = 6.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903489334415       residual = 6.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 8.6736e+13, overlap shift 8.6736e+14 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903489334415       residual = 6.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903489334415       residual = 6.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.832146 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6583e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2673
    reference variance = 0.240746
====================================================
  Execution time = 1.3969e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0588e-01
  Total weights = 1.9575e+06
  Execution time = 1.8382e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290004495852
                                         uncertainty =       0.002002796356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290004495852
                                         uncertainty =       0.002002796356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380784970
  error estimate for blocks of size 2^( 2) =       0.000392489204
  error estimate for blocks of size 2^( 3) =       0.000402856272
  error estimate for blocks of size 2^( 4) =       0.000410391186
  error estimate for blocks of size 2^( 5) =       0.000414671411
  error estimate for blocks of size 2^( 6) =       0.000415968206
  error estimate for blocks of size 2^( 7) =       0.000416167604

      target function =      -0.903610363205
              le_mean =     -17.214356115098
             les_mean =     296.639939373894
             stat err =       0.000414299602
             autocorr =       1.183775741884
   target nu stat err =       0.000414299602
   target dn stat err =       0.004187942679
      target stat err =       0.006406709952
              std dev =       0.538511268534
             le_variance =       0.289994386338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290004495852
                                         uncertainty =       0.002002796356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290004495852
                                         uncertainty =       0.002002796356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380784970
  error estimate for blocks of size 2^( 2) =       0.000392489204
  error estimate for blocks of size 2^( 3) =       0.000402856272
  error estimate for blocks of size 2^( 4) =       0.000410391186
  error estimate for blocks of size 2^( 5) =       0.000414671411
  error estimate for blocks of size 2^( 6) =       0.000415968206
  error estimate for blocks of size 2^( 7) =       0.000416167604

      target function =      -0.903610363205
              le_mean =     -17.214356115098
             les_mean =     296.639939373894
             stat err =       0.000414299602
             autocorr =       1.183775741885
   target nu stat err =       0.000414299602
   target dn stat err =       0.004187942679
      target stat err =       0.006406709952
              std dev =       0.538511268534
             le_variance =       0.289994386338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290004495852
                                         uncertainty =       0.002002796356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290004495852
                                         uncertainty =       0.002002796356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380784970
  error estimate for blocks of size 2^( 2) =       0.000392489204
  error estimate for blocks of size 2^( 3) =       0.000402856272
  error estimate for blocks of size 2^( 4) =       0.000410391186
  error estimate for blocks of size 2^( 5) =       0.000414671411
  error estimate for blocks of size 2^( 6) =       0.000415968206
  error estimate for blocks of size 2^( 7) =       0.000416167604

      target function =      -0.903610363205
              le_mean =     -17.214356115098
             les_mean =     296.639939373894
             stat err =       0.000414299602
             autocorr =       1.183775741884
   target nu stat err =       0.000414299602
   target dn stat err =       0.004187942679
      target stat err =       0.006406709952
              std dev =       0.538511268534
             le_variance =       0.289994386338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290004495852
                                         uncertainty =       0.002002796356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290004495852
                                         uncertainty =       0.002002796356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380784970
  error estimate for blocks of size 2^( 2) =       0.000392489204
  error estimate for blocks of size 2^( 3) =       0.000402856272
  error estimate for blocks of size 2^( 4) =       0.000410391186
  error estimate for blocks of size 2^( 5) =       0.000414671411
  error estimate for blocks of size 2^( 6) =       0.000415968206
  error estimate for blocks of size 2^( 7) =       0.000416167604

      target function =      -0.903610363205
              le_mean =     -17.214356115098
             les_mean =     296.639939373894
             stat err =       0.000414299602
             autocorr =       1.183775741884
   target nu stat err =       0.000414299602
   target dn stat err =       0.004187942679
      target stat err =       0.006406709952
              std dev =       0.538511268534
             le_variance =       0.289994386338


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.903610363205        initial
     5.4210e+12     5.4210e+13             6.2404e-17        -0.903610363205  <--
     2.1684e+13     2.1684e+14             0.0000e+00        -0.903610363205
     8.6736e+13     8.6736e+14             0.0000e+00        -0.903610363205

*****************************************************************************
Applying the update for shift_i =   5.4210e+12     and shift_s =   5.4210e+13
*****************************************************************************

  Execution time = 2.3221e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9810e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.2159
    reference variance = 0.219853
====================================================
  Execution time = 1.3967e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9963e-01
  Total weights = 1.957782944e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4817e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287143853720
                                         uncertainty =       0.001904576110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287143853720
                                         uncertainty =       0.001904576110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378882684
  error estimate for blocks of size 2^( 2) =       0.000390216629
  error estimate for blocks of size 2^( 3) =       0.000400180067
  error estimate for blocks of size 2^( 4) =       0.000407662118
  error estimate for blocks of size 2^( 5) =       0.000412741915
  error estimate for blocks of size 2^( 6) =       0.000416628513
  error estimate for blocks of size 2^( 7) =       0.000420131985

      target function =      -0.913243180510
              le_mean =     -17.214662907535
             les_mean =     296.644246620284
             stat err =       0.000414291133
             autocorr =       1.195643649492
   target nu stat err =       0.000414291133
   target dn stat err =       0.002468600088
      target stat err =       0.003900809207
              std dev =       0.535821030077
             le_variance =       0.287104176273


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721466290753e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+12, overlap shift 1.3553e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913258855709       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913258855709       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913258855709       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913258855708       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914382616378       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913628849001       residual = 9.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913558143339       residual = 8.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912672535808       residual = 8.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913367674735       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912224100484       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912731743374       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909395819790       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914791535464       residual = 2.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915797925336       residual = 8.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915638043307       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910253137097       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911003315675       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915692709543       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911675242837       residual = 6.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913801220528       residual = 8.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914230649585       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913623190134       residual = 5.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911040258072       residual = 4.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913877946495       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914217162349       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915092605930       residual = 7.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914767216116       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915302556929       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912618473148       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914136334150       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914168875831       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909554433305       residual = 7.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912380756649       residual = 7.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913415436642       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917266128062       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913815188492       residual = 3.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912879210307       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912152092383       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912835977019       residual = 6.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.911703456796       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.915833910318       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.911638464635       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.911710439871       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.911883492046       residual = 8.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.913507904587       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.914701493762       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.911703481765       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.913133922027       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.913876434083       residual = 5.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.912552758841       residual = 8.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.913657166135       residual = 5.83e-04           smallest_sin_value = 9.98e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.916179879487       residual = 1.75e-04           smallest_sin_value = 9.98e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.913193748267       residual = 2.33e-04           smallest_sin_value = 9.97e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+12 is 7.833647e-17

solving harmonic davidson linear method for identity shift 5.4210e+12, overlap shift 5.4210e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913258855709       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913258855709       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913258855709       residual = 6.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913258855709       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913258855709       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910392414465       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916972294138       residual = 2.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918489555736       residual = 5.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904558490973       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912776337441       residual = 7.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916265766427       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918171847813       residual = 4.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912723440027       residual = 5.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916507422943       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.907988082851       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916683188687       residual = 4.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.921689991325       residual = 6.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924182960724       residual = 3.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915831989047       residual = 9.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918876336307       residual = 2.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920839075516       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.908771627371       residual = 1.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911266268206       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919290221766       residual = 4.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917289379284       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909799157392       residual = 9.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.905971322609       residual = 5.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915123822736       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913483286077       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908610180365       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916527984102       residual = 5.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910064361963       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914395170226       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.923237930106       residual = 4.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913903767048       residual = 4.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915002827853       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913034660499       residual = 6.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.917297328246       residual = 5.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.909654156667       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.912397691541       residual = 9.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.910324394426       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.915163773036       residual = 1.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.914418700054       residual = 6.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.917919387512       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.918254084901       residual = 7.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.908972541054       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.913338100183       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.912545833952       residual = 1.13e-01           smallest_sin_value = 9.99e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.912004201558       residual = 6.90e-03           smallest_sin_value = 9.97e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.907060883418       residual = 7.91e-03           smallest_sin_value = 9.97e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.906221898075       residual = 1.70e-02           smallest_sin_value = 9.96e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.918331885446       residual = 6.23e-03           smallest_sin_value = 9.93e-01
davidson iteration   52 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         52 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+12 is 1.845552e-17

solving harmonic davidson linear method for identity shift 2.1684e+13, overlap shift 2.1684e+14 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913258855709       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913258855709       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.26e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.944788 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6567e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.2711
    reference variance = 0.268023
====================================================
  Execution time = 1.3599e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9753e-01
  Total weights = 1.9576e+06
  Execution time = 1.8340e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284930525092
                                         uncertainty =       0.001679006375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284930525092
                                         uncertainty =       0.001679006375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377451231
  error estimate for blocks of size 2^( 2) =       0.000388903741
  error estimate for blocks of size 2^( 3) =       0.000399813647
  error estimate for blocks of size 2^( 4) =       0.000408043618
  error estimate for blocks of size 2^( 5) =       0.000413147638
  error estimate for blocks of size 2^( 6) =       0.000416480787
  error estimate for blocks of size 2^( 7) =       0.000418611524

      target function =      -0.916531940864
              le_mean =     -17.214119296536
             les_mean =     296.623433470361
             stat err =       0.000414070892
             autocorr =       1.203449060838
   target nu stat err =       0.000414070892
   target dn stat err =       0.002237869853
      target stat err =       0.003570115753
              std dev =       0.533796649471
             le_variance =       0.284938862987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284930525092
                                         uncertainty =       0.001679006375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284930525092
                                         uncertainty =       0.001679006375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377451231
  error estimate for blocks of size 2^( 2) =       0.000388903741
  error estimate for blocks of size 2^( 3) =       0.000399813647
  error estimate for blocks of size 2^( 4) =       0.000408043618
  error estimate for blocks of size 2^( 5) =       0.000413147638
  error estimate for blocks of size 2^( 6) =       0.000416480787
  error estimate for blocks of size 2^( 7) =       0.000418611524

      target function =      -0.916531940864
              le_mean =     -17.214119296536
             les_mean =     296.623433470361
             stat err =       0.000414070892
             autocorr =       1.203449060840
   target nu stat err =       0.000414070892
   target dn stat err =       0.002237869853
      target stat err =       0.003570115753
              std dev =       0.533796649471
             le_variance =       0.284938862987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284930525092
                                         uncertainty =       0.001679006375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284930525092
                                         uncertainty =       0.001679006375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377451231
  error estimate for blocks of size 2^( 2) =       0.000388903741
  error estimate for blocks of size 2^( 3) =       0.000399813647
  error estimate for blocks of size 2^( 4) =       0.000408043618
  error estimate for blocks of size 2^( 5) =       0.000413147638
  error estimate for blocks of size 2^( 6) =       0.000416480787
  error estimate for blocks of size 2^( 7) =       0.000418611524

      target function =      -0.916531940864
              le_mean =     -17.214119296536
             les_mean =     296.623433470361
             stat err =       0.000414070892
             autocorr =       1.203449060840
   target nu stat err =       0.000414070892
   target dn stat err =       0.002237869853
      target stat err =       0.003570115753
              std dev =       0.533796649471
             le_variance =       0.284938862987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284930525092
                                         uncertainty =       0.001679006375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284930525092
                                         uncertainty =       0.001679006375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377451231
  error estimate for blocks of size 2^( 2) =       0.000388903741
  error estimate for blocks of size 2^( 3) =       0.000399813647
  error estimate for blocks of size 2^( 4) =       0.000408043618
  error estimate for blocks of size 2^( 5) =       0.000413147638
  error estimate for blocks of size 2^( 6) =       0.000416480787
  error estimate for blocks of size 2^( 7) =       0.000418611524

      target function =      -0.916531940864
              le_mean =     -17.214119296536
             les_mean =     296.623433470361
             stat err =       0.000414070892
             autocorr =       1.203449060841
   target nu stat err =       0.000414070892
   target dn stat err =       0.002237869853
      target stat err =       0.003570115753
              std dev =       0.533796649471
             le_variance =       0.284938862987


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916531940864        initial
     1.3553e+12     1.3553e+13             7.8336e-17        -0.916531940864
     5.4210e+12     5.4210e+13             1.8456e-17        -0.916531940864  <--
     2.1684e+13     2.1684e+14             0.0000e+00        -0.916531940864

*****************************************************************************
Applying the update for shift_i =   5.4210e+12     and shift_s =   5.4210e+13
*****************************************************************************

  Execution time = 2.2824e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9397e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.2785
    reference variance = 0.342006
====================================================
  Execution time = 1.3759e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0120e-01
  Total weights = 1.957476899e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4771e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285443501569
                                         uncertainty =       0.001791181917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285443501569
                                         uncertainty =       0.001791181917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377777836
  error estimate for blocks of size 2^( 2) =       0.000389144989
  error estimate for blocks of size 2^( 3) =       0.000400191433
  error estimate for blocks of size 2^( 4) =       0.000407835568
  error estimate for blocks of size 2^( 5) =       0.000412642447
  error estimate for blocks of size 2^( 6) =       0.000413739077
  error estimate for blocks of size 2^( 7) =       0.000415895248

      target function =      -0.910793646350
              le_mean =     -17.214995042789
             les_mean =     296.657249400941
             stat err =       0.000412528085
             autocorr =       1.192433290996
   target nu stat err =       0.000412528085
   target dn stat err =       0.002954742599
      target stat err =       0.004623750524
              std dev =       0.534258539003
             le_variance =       0.285432186498


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721499504279e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+12, overlap shift 1.3553e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910816388459       residual = 7.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910816388459       residual = 8.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910816388459       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910816388459       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910816388459       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910816388459       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910816388459       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910816388459       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910816388459       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910816388459       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910816388459       residual = 8.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910318167797       residual = 3.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912647819860       residual = 5.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910963690045       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910369141279       residual = 6.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911256082492       residual = 6.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911390784266       residual = 9.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910576622597       residual = 5.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.909032259488       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908157371102       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910547888487       residual = 7.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909112431548       residual = 9.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.909713162155       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911451851260       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910856775977       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911794934558       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910001968901       residual = 5.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.908440784676       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.909489720574       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.909555621137       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910835387468       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910427490515       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.909174980139       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910353947991       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.909177512757       residual = 9.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.909855277382       residual = 6.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.910571067895       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911272433059       residual = 4.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.911020797946       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.909988626423       residual = 9.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.911046560263       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.911717526055       residual = 6.28e-04           smallest_sin_value = 9.99e-01
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.911832763631       residual = 6.28e-04           smallest_sin_value = 9.98e-01
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.911600763846       residual = 2.08e-03           smallest_sin_value = 9.96e-01
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.910265421144       residual = 3.37e-04           smallest_sin_value = 9.96e-01
davidson iteration   45 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         45 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+12 is 8.604611e-17

solving harmonic davidson linear method for identity shift 5.4210e+12, overlap shift 5.4210e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910816388459       residual = 7.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910816388459       residual = 8.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910816388459       residual = 5.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910816388459       residual = 7.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909596013839       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909667345197       residual = 9.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913707227394       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907538558227       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.899268502264       residual = 6.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902356658763       residual = 6.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912520516748       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912889978589       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.909411754723       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.909168766656       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.904654387121       residual = 5.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912528689833       residual = 4.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911589276723       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911235008158       residual = 7.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912711652090       residual = 9.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908819866419       residual = 5.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.907694808313       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910838661326       residual = 2.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910612432459       residual = 6.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.905041417129       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.909512400762       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.902879825389       residual = 6.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911740184026       residual = 1.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910541969231       residual = 2.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.909091550141       residual = 3.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910978405270       residual = 1.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.909795712521       residual = 2.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911287005228       residual = 4.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.908806254279       residual = 8.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914813603088       residual = 1.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.907541877401       residual = 1.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910520594971       residual = 8.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915377516391       residual = 1.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912574526868       residual = 5.69e-01           smallest_sin_value = 9.99e-01
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.904289017695       residual = 3.15e-01           smallest_sin_value = 9.96e-01
davidson iteration   39 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         39 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+12 is 1.565968e-17

solving harmonic davidson linear method for identity shift 2.1684e+13, overlap shift 2.1684e+14 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910816388459       residual = 7.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910816388459       residual = 7.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.005715 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6303e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.264
    reference variance = 2.93799
====================================================
  Execution time = 1.3348e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0264e-01
  Total weights = 1.9580e+06
  Execution time = 1.8331e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287012501821
                                         uncertainty =       0.001411830843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287012501821
                                         uncertainty =       0.001411830843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378882522
  error estimate for blocks of size 2^( 2) =       0.000390176842
  error estimate for blocks of size 2^( 3) =       0.000401086056
  error estimate for blocks of size 2^( 4) =       0.000408855791
  error estimate for blocks of size 2^( 5) =       0.000413458510
  error estimate for blocks of size 2^( 6) =       0.000416267515
  error estimate for blocks of size 2^( 7) =       0.000418663019

      target function =      -0.908585455973
              le_mean =     -17.214253444107
             les_mean =     296.633166081216
             stat err =       0.000414311209
             autocorr =       1.195760554717
   target nu stat err =       0.000414311209
   target dn stat err =       0.003154133171
      target stat err =       0.004898869904
              std dev =       0.535820801170
             le_variance =       0.287103930967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287012501821
                                         uncertainty =       0.001411830843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287012501821
                                         uncertainty =       0.001411830843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378882522
  error estimate for blocks of size 2^( 2) =       0.000390176842
  error estimate for blocks of size 2^( 3) =       0.000401086056
  error estimate for blocks of size 2^( 4) =       0.000408855791
  error estimate for blocks of size 2^( 5) =       0.000413458510
  error estimate for blocks of size 2^( 6) =       0.000416267515
  error estimate for blocks of size 2^( 7) =       0.000418663019

      target function =      -0.908585455973
              le_mean =     -17.214253444107
             les_mean =     296.633166081216
             stat err =       0.000414311209
             autocorr =       1.195760554717
   target nu stat err =       0.000414311209
   target dn stat err =       0.003154133171
      target stat err =       0.004898869904
              std dev =       0.535820801170
             le_variance =       0.287103930967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287012501821
                                         uncertainty =       0.001411830843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287012501821
                                         uncertainty =       0.001411830843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378882522
  error estimate for blocks of size 2^( 2) =       0.000390176842
  error estimate for blocks of size 2^( 3) =       0.000401086056
  error estimate for blocks of size 2^( 4) =       0.000408855791
  error estimate for blocks of size 2^( 5) =       0.000413458510
  error estimate for blocks of size 2^( 6) =       0.000416267515
  error estimate for blocks of size 2^( 7) =       0.000418663019

      target function =      -0.908585455973
              le_mean =     -17.214253444107
             les_mean =     296.633166081216
             stat err =       0.000414311209
             autocorr =       1.195760554717
   target nu stat err =       0.000414311209
   target dn stat err =       0.003154133171
      target stat err =       0.004898869904
              std dev =       0.535820801170
             le_variance =       0.287103930967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287012501821
                                         uncertainty =       0.001411830843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287012501821
                                         uncertainty =       0.001411830843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378882522
  error estimate for blocks of size 2^( 2) =       0.000390176842
  error estimate for blocks of size 2^( 3) =       0.000401086056
  error estimate for blocks of size 2^( 4) =       0.000408855791
  error estimate for blocks of size 2^( 5) =       0.000413458510
  error estimate for blocks of size 2^( 6) =       0.000416267515
  error estimate for blocks of size 2^( 7) =       0.000418663019

      target function =      -0.908585455973
              le_mean =     -17.214253444107
             les_mean =     296.633166081216
             stat err =       0.000414311209
             autocorr =       1.195760554717
   target nu stat err =       0.000414311209
   target dn stat err =       0.003154133171
      target stat err =       0.004898869904
              std dev =       0.535820801170
             le_variance =       0.287103930967


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908585455973        initial
     1.3553e+12     1.3553e+13             8.6046e-17        -0.908585455973  <--
     5.4210e+12     5.4210e+13             1.5660e-17        -0.908585455973
     2.1684e+13     2.1684e+14             0.0000e+00        -0.908585455973

*****************************************************************************
Applying the update for shift_i =   1.3553e+12     and shift_s =   1.3553e+13
*****************************************************************************

  Execution time = 2.2563e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8872e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.23
    reference variance = 0.254919
====================================================
  Execution time = 1.4062e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0152e-01
  Total weights = 1.957858845e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4905e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286882359848
                                         uncertainty =       0.001547023957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286882359848
                                         uncertainty =       0.001547023957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378748985
  error estimate for blocks of size 2^( 2) =       0.000390181172
  error estimate for blocks of size 2^( 3) =       0.000400609316
  error estimate for blocks of size 2^( 4) =       0.000409050204
  error estimate for blocks of size 2^( 5) =       0.000413308880
  error estimate for blocks of size 2^( 6) =       0.000417340101
  error estimate for blocks of size 2^( 7) =       0.000419546655

      target function =      -0.910314658123
              le_mean =     -17.214407205156
             les_mean =     296.637336165927
             stat err =       0.000414811460
             autocorr =       1.199495262890
   target nu stat err =       0.000414811460
   target dn stat err =       0.002867196390
      target stat err =       0.004480969318
              std dev =       0.535631950926
             le_variance =       0.286901586853


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721440720516e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+11, overlap shift 3.3881e+12 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910335883655       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910335883655       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910335883655       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910335883655       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910335883655       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910366888232       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910222815375       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909573022411       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910303049286       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911161783151       residual = 7.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911199583123       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909929315546       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910670125943       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910650698236       residual = 7.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910273942158       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910994496985       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910025026457       residual = 6.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910101594072       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910127563031       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910753992190       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910003881091       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910362256711       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.909984759953       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910626391431       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910461418802       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909783902466       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910274981030       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910324176135       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.909949131663       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911105173986       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910770254554       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910257539255       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910222576158       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910283295348       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.910059510730       residual = 7.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910233252996       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.910164239023       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.910523767184       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.910172702405       residual = 9.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.910282901108       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.910067322564       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.910227710141       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.910189692042       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.910143205553       residual = 2.40e-03           smallest_sin_value = 9.99e-01
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.910664209147       residual = 3.79e-03           smallest_sin_value = 9.98e-01
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.910249603142       residual = 1.46e-05           smallest_sin_value = 9.94e-01
davidson iteration   46 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         46 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+11 is 4.057816e-16

solving harmonic davidson linear method for identity shift 1.3553e+12, overlap shift 1.3553e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910335883655       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910335883655       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910335883655       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910335883659       residual = 7.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910335883669       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910335883655       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910335883655       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909440571219       residual = 8.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912816407952       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909784349832       residual = 8.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909080900860       residual = 8.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908214225448       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.909345263319       residual = 6.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914361524580       residual = 5.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.905956014314       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913643318101       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912965278885       residual = 6.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912501635008       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.907750639274       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911132577124       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.909409607764       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909299153418       residual = 5.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911595943240       residual = 7.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910862393049       residual = 7.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912018784398       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909337329564       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911321011739       residual = 4.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911418989892       residual = 5.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910188719535       residual = 5.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910240397558       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911232775130       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909767266278       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.907764365928       residual = 8.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908994275045       residual = 5.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912605770390       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910906369385       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911692987392       residual = 7.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912835758452       residual = 8.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.909821063875       residual = 2.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.909100501774       residual = 4.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.909572568061       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.909722382473       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.910732222642       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.910462617932       residual = 5.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.908452006148       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.910547231277       residual = 4.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.912028812902       residual = 4.04e-04           smallest_sin_value = 9.99e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.909094057627       residual = 4.97e-04           smallest_sin_value = 9.99e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.909188917794       residual = 6.48e-04           smallest_sin_value = 9.96e-01
davidson iteration   49 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         49 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+12 is 1.014727e-16

solving harmonic davidson linear method for identity shift 5.4210e+12, overlap shift 5.4210e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910335883655       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910335883655       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910335883655       residual = 7.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910335883653       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910324247179       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910335842224       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908609003270       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910723065729       residual = 4.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906222690421       residual = 4.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915885837783       residual = 4.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.904175784144       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913353209271       residual = 9.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916322048542       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919448518800       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924896647852       residual = 4.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.900161406193       residual = 3.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915952272667       residual = 6.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.898486954735       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.900510311791       residual = 7.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916536255390       residual = 2.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915125360422       residual = 3.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.903976272365       residual = 5.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918840687847       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.904905940997       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920663567179       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914136913136       residual = 7.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.923321281830       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.901693829894       residual = 4.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911447986723       residual = 8.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.907783633166       residual = 5.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912714007290       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.901447298762       residual = 6.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920113822139       residual = 7.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908920441248       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.904975139263       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916168501108       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916315398725       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915909582687       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916808661390       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.902682669817       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.919666958257       residual = 3.89e-03           smallest_sin_value = 9.99e-01
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.915078525751       residual = 1.07e-02           smallest_sin_value = 9.98e-01
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.907363935644       residual = 1.35e-02           smallest_sin_value = 9.97e-01
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.911820671034       residual = 8.82e-03           smallest_sin_value = 9.95e-01
davidson iteration   44 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         44 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+12 is 2.471792e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.124413 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6677e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.2023
    reference variance = 0.295094
====================================================
  Execution time = 1.3373e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0539e-01
  Total weights = 1.9576e+06
  Execution time = 1.8454e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287899511659
                                         uncertainty =       0.001732887528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287899511659
                                         uncertainty =       0.001732887528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379401810
  error estimate for blocks of size 2^( 2) =       0.000390897470
  error estimate for blocks of size 2^( 3) =       0.000400749432
  error estimate for blocks of size 2^( 4) =       0.000407915984
  error estimate for blocks of size 2^( 5) =       0.000412837472
  error estimate for blocks of size 2^( 6) =       0.000415438684
  error estimate for blocks of size 2^( 7) =       0.000417062296

      target function =      -0.904380364373
              le_mean =     -17.214169950525
             les_mean =     296.633037249604
             stat err =       0.000413313609
             autocorr =       1.186753751475
   target nu stat err =       0.000413313609
   target dn stat err =       0.003631087120
      target stat err =       0.005572892424
              std dev =       0.536555185419
             le_variance =       0.287891467000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287899511659
                                         uncertainty =       0.001732887528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287899511659
                                         uncertainty =       0.001732887528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379401810
  error estimate for blocks of size 2^( 2) =       0.000390897470
  error estimate for blocks of size 2^( 3) =       0.000400749432
  error estimate for blocks of size 2^( 4) =       0.000407915984
  error estimate for blocks of size 2^( 5) =       0.000412837472
  error estimate for blocks of size 2^( 6) =       0.000415438684
  error estimate for blocks of size 2^( 7) =       0.000417062296

      target function =      -0.904380364373
              le_mean =     -17.214169950525
             les_mean =     296.633037249604
             stat err =       0.000413313609
             autocorr =       1.186753751475
   target nu stat err =       0.000413313609
   target dn stat err =       0.003631087120
      target stat err =       0.005572892424
              std dev =       0.536555185419
             le_variance =       0.287891467000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287899511659
                                         uncertainty =       0.001732887528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287899511659
                                         uncertainty =       0.001732887528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379401810
  error estimate for blocks of size 2^( 2) =       0.000390897470
  error estimate for blocks of size 2^( 3) =       0.000400749432
  error estimate for blocks of size 2^( 4) =       0.000407915984
  error estimate for blocks of size 2^( 5) =       0.000412837472
  error estimate for blocks of size 2^( 6) =       0.000415438684
  error estimate for blocks of size 2^( 7) =       0.000417062296

      target function =      -0.904380364373
              le_mean =     -17.214169950525
             les_mean =     296.633037249604
             stat err =       0.000413313609
             autocorr =       1.186753751473
   target nu stat err =       0.000413313609
   target dn stat err =       0.003631087120
      target stat err =       0.005572892424
              std dev =       0.536555185419
             le_variance =       0.287891467000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287899511659
                                         uncertainty =       0.001732887528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287899511659
                                         uncertainty =       0.001732887528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379401810
  error estimate for blocks of size 2^( 2) =       0.000390897470
  error estimate for blocks of size 2^( 3) =       0.000400749432
  error estimate for blocks of size 2^( 4) =       0.000407915984
  error estimate for blocks of size 2^( 5) =       0.000412837472
  error estimate for blocks of size 2^( 6) =       0.000415438684
  error estimate for blocks of size 2^( 7) =       0.000417062296

      target function =      -0.904380364373
              le_mean =     -17.214169950525
             les_mean =     296.633037249604
             stat err =       0.000413313609
             autocorr =       1.186753751474
   target nu stat err =       0.000413313609
   target dn stat err =       0.003631087120
      target stat err =       0.005572892424
              std dev =       0.536555185419
             le_variance =       0.287891467000


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904380364373        initial
     3.3881e+11     3.3881e+12             4.0578e-16        -0.904380364373  <--
     1.3553e+12     1.3553e+13             1.0147e-16        -0.904380364373
     5.4210e+12     5.4210e+13             2.4718e-17        -0.904380364373

*****************************************************************************
Applying the update for shift_i =   3.3881e+11     and shift_s =   3.3881e+12
*****************************************************************************

  Execution time = 2.2650e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9369e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.1903
    reference variance = 0.299348
====================================================
  Execution time = 1.3808e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5314e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0103e-01
  Total weights = 1.958026758e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285372371352
                                         uncertainty =       0.001464629417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285372371352
                                         uncertainty =       0.001464629417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377774551
  error estimate for blocks of size 2^( 2) =       0.000388973668
  error estimate for blocks of size 2^( 3) =       0.000399394355
  error estimate for blocks of size 2^( 4) =       0.000407071191
  error estimate for blocks of size 2^( 5) =       0.000412731711
  error estimate for blocks of size 2^( 6) =       0.000415157503
  error estimate for blocks of size 2^( 7) =       0.000417769016

      target function =      -0.911078605052
              le_mean =     -17.214179456650
             les_mean =     296.629006348745
             stat err =       0.000413182355
             autocorr =       1.196239494820
   target nu stat err =       0.000413182355
   target dn stat err =       0.002824025925
      target stat err =       0.004420177615
              std dev =       0.534253893958
             le_variance =       0.285427223210


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721417945665e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+10, overlap shift 8.4703e+11 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911099199476       residual = 9.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911099199476       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911099199476       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911089056462       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911099199476       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911106855641       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911099041416       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911134690089       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911259504698       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911066775327       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911007655113       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911115385940       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911196798333       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911099271181       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910952999756       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910827301293       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911098995932       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911118957011       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910977767622       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910933017712       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911062736791       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911068806153       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911053382584       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911008726128       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911081175193       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911175960799       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911159567993       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911358834801       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911027853681       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911141617018       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911150819284       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911122348031       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911132459319       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911000033701       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911029933551       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911052998258       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911011026369       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911035001189       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.911166439297       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.911144001953       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.911061222025       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.911143907932       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.911068790105       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.911178463427       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.911069895965       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.911105997964       residual = 1.11e-06           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.911097468841       residual = 2.22e-06           smallest_sin_value = 9.98e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.911107321112       residual = 3.27e-06           smallest_sin_value = 9.98e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.911159777812       residual = 2.45e-06           smallest_sin_value = 9.98e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.911063289646       residual = 6.02e-07           smallest_sin_value = 9.96e-01
davidson iteration   50 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         50 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+10 is 1.689962e-15

solving harmonic davidson linear method for identity shift 3.3881e+11, overlap shift 3.3881e+12 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911099199476       residual = 9.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911099199476       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911099199476       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911099199476       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911096283344       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911268725884       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911089946928       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911669236263       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911262973166       residual = 7.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910611020840       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911159200689       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911337612562       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911232030865       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911041720680       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911489886136       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910447871613       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911276066250       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911643563848       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910954958131       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911129930188       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911065807815       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911275344723       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911154945774       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910939654707       residual = 6.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911013105591       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911158859465       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911442073323       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910638059059       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911775806206       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911032388350       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911408116098       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910787169285       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911141484915       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911111648290       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911118571635       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910937107560       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.910965877647       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911218263729       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.911222686392       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.911030721876       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.911045160993       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.910669496493       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.911000989028       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.911049701275       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.911148404770       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.911125053138       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.911415822244       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.911555648032       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.911091873559       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.911012706972       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.910734103127       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.911105889531       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.910820458874       residual = 9.59e-06           smallest_sin_value = 9.98e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.910745262844       residual = 2.21e-05           smallest_sin_value = 9.94e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+11 is 4.173957e-16

solving harmonic davidson linear method for identity shift 1.3553e+12, overlap shift 1.3553e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911099199476       residual = 9.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911099199476       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911099199476       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911099199475       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912100967988       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911119772678       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912034185662       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913059522966       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908280021533       residual = 5.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909808753856       residual = 6.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910798668171       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909827240393       residual = 5.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913369231755       residual = 7.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910973919958       residual = 7.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911055741025       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911649294876       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913067017136       residual = 9.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910984498715       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910541423221       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911061059393       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911608454539       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911198331733       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911039731426       residual = 8.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911131653254       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911367337032       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910986117110       residual = 5.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910564381873       residual = 3.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911139532374       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911374117391       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911180261832       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910895372153       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910077933691       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910618318651       residual = 4.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910741536334       residual = 4.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911762250886       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910811925443       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911378323765       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911160436049       residual = 7.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.911740696613       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.911080662271       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.911485100301       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.911366751908       residual = 3.32e-04           smallest_sin_value = 9.99e-01
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.910579733991       residual = 4.57e-04           smallest_sin_value = 9.97e-01
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.910371675883       residual = 1.78e-03           smallest_sin_value = 9.95e-01
davidson iteration   44 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         44 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+12 is 1.044132e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.268137 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6447e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.1787
    reference variance = 0.329564
====================================================
  Execution time = 1.3445e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0333e-01
  Total weights = 1.9577e+06
  Execution time = 1.8388e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285808470387
                                         uncertainty =       0.001688983484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285808470387
                                         uncertainty =       0.001688983484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378028350
  error estimate for blocks of size 2^( 2) =       0.000389315038
  error estimate for blocks of size 2^( 3) =       0.000399527908
  error estimate for blocks of size 2^( 4) =       0.000406791134
  error estimate for blocks of size 2^( 5) =       0.000411499517
  error estimate for blocks of size 2^( 6) =       0.000412675624
  error estimate for blocks of size 2^( 7) =       0.000413560811

      target function =      -0.907469958638
              le_mean =     -17.214270412820
             les_mean =     296.634436523617
             stat err =       0.000411131771
             autocorr =       1.182805507430
   target nu stat err =       0.000411131771
   target dn stat err =       0.005800522045
      target stat err =       0.008922525696
              std dev =       0.534612819122
             le_variance =       0.285810866369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285808470387
                                         uncertainty =       0.001688983484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285808470387
                                         uncertainty =       0.001688983484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378028350
  error estimate for blocks of size 2^( 2) =       0.000389315038
  error estimate for blocks of size 2^( 3) =       0.000399527908
  error estimate for blocks of size 2^( 4) =       0.000406791134
  error estimate for blocks of size 2^( 5) =       0.000411499517
  error estimate for blocks of size 2^( 6) =       0.000412675624
  error estimate for blocks of size 2^( 7) =       0.000413560811

      target function =      -0.907469958638
              le_mean =     -17.214270412820
             les_mean =     296.634436523617
             stat err =       0.000411131771
             autocorr =       1.182805507433
   target nu stat err =       0.000411131771
   target dn stat err =       0.005800522045
      target stat err =       0.008922525696
              std dev =       0.534612819122
             le_variance =       0.285810866369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285808470387
                                         uncertainty =       0.001688983484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285808470387
                                         uncertainty =       0.001688983484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378028350
  error estimate for blocks of size 2^( 2) =       0.000389315038
  error estimate for blocks of size 2^( 3) =       0.000399527908
  error estimate for blocks of size 2^( 4) =       0.000406791134
  error estimate for blocks of size 2^( 5) =       0.000411499517
  error estimate for blocks of size 2^( 6) =       0.000412675624
  error estimate for blocks of size 2^( 7) =       0.000413560811

      target function =      -0.907469958638
              le_mean =     -17.214270412820
             les_mean =     296.634436523617
             stat err =       0.000411131771
             autocorr =       1.182805507432
   target nu stat err =       0.000411131771
   target dn stat err =       0.005800522045
      target stat err =       0.008922525696
              std dev =       0.534612819122
             le_variance =       0.285810866369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285808470387
                                         uncertainty =       0.001688983484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285808470387
                                         uncertainty =       0.001688983484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378028350
  error estimate for blocks of size 2^( 2) =       0.000389315038
  error estimate for blocks of size 2^( 3) =       0.000399527908
  error estimate for blocks of size 2^( 4) =       0.000406791134
  error estimate for blocks of size 2^( 5) =       0.000411499517
  error estimate for blocks of size 2^( 6) =       0.000412675624
  error estimate for blocks of size 2^( 7) =       0.000413560811

      target function =      -0.907469958638
              le_mean =     -17.214270412820
             les_mean =     296.634436523617
             stat err =       0.000411131771
             autocorr =       1.182805507432
   target nu stat err =       0.000411131771
   target dn stat err =       0.005800522045
      target stat err =       0.008922525696
              std dev =       0.534612819122
             le_variance =       0.285810866369


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.907469958638        initial
     8.4703e+10     8.4703e+11             1.6900e-15        -0.907469958638  <--
     3.3881e+11     3.3881e+12             4.1740e-16        -0.907469958638
     1.3553e+12     1.3553e+13             1.0441e-16        -0.907469958638

*****************************************************************************
Applying the update for shift_i =   8.4703e+10     and shift_s =   8.4703e+11
*****************************************************************************

  Execution time = 2.2691e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9145e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.2227
    reference variance = 0.304125
====================================================
  Execution time = 1.4010e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0525e-01
  Total weights = 1.957911027e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4950e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287846891203
                                         uncertainty =       0.002326887185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287846891203
                                         uncertainty =       0.002326887185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379346916
  error estimate for blocks of size 2^( 2) =       0.000390488104
  error estimate for blocks of size 2^( 3) =       0.000400795156
  error estimate for blocks of size 2^( 4) =       0.000407847830
  error estimate for blocks of size 2^( 5) =       0.000412561702
  error estimate for blocks of size 2^( 6) =       0.000414071883
  error estimate for blocks of size 2^( 7) =       0.000415515523

      target function =      -0.904557297120
              le_mean =     -17.214547153398
             les_mean =     296.645879534369
             stat err =       0.000412499234
             autocorr =       1.182423842467
   target nu stat err =       0.000412499234
   target dn stat err =       0.004763568305
      target stat err =       0.007295102276
              std dev =       0.536477553410
             le_variance =       0.287808165313


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721454715340e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+10, overlap shift 2.1176e+11 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904615482030       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904615482030       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904615482030       residual = 5.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904615482030       residual = 9.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904621317651       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904615482030       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904678724091       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904544839719       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904572670241       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904582330332       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.904607557690       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.904586320095       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.904635329605       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.904602388941       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.904612400826       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.904578522747       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.904608852796       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.904617134525       residual = 7.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1176e+10 is 9.214702e-15

solving harmonic davidson linear method for identity shift 8.4703e+10, overlap shift 8.4703e+11 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904615482030       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904615482030       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904615482030       residual = 5.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904615482030       residual = 9.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904568479166       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904662749252       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904455047967       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904596895505       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904700044588       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904706441299       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.904575323987       residual = 8.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.904651021819       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.904692197808       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.904541039034       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.904610158236       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.904471244336       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.904617375711       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.904717947743       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.904556726488       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.904530246533       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.904607622531       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.904641006625       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.904694316156       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.904647740247       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.904663683571       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.904834045212       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.904639282938       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.904539605739       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.904559742445       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.904629141065       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.904742594816       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.904695023956       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.904696254154       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.904550792032       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.904688253749       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.904635439309       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.904615604226       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.904630675725       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.904771691112       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.904728902388       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.904623590849       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.904695490128       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.904653169834       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.904758140223       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.904536002553       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.904517214785       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.904618979656       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.904674911768       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.904533690552       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.904550698652       residual = 4.33e-06           smallest_sin_value = 9.99e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.904580320763       residual = 1.26e-06           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.904575608732       residual = 2.75e-06           smallest_sin_value = 9.96e-01
davidson iteration   52 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         52 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+10 is 2.272708e-15

solving harmonic davidson linear method for identity shift 3.3881e+11, overlap shift 3.3881e+12 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904615482030       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904615482030       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904615482030       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904668650431       residual = 9.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904635811426       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904558097568       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904551120339       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904316307506       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904947889133       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904988197090       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.904624888785       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.904542126228       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.903981364376       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.904689296919       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.904212147831       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.904671431369       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.904662977851       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.903820180419       residual = 5.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.904853850084       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.904584258445       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.903940027095       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.904668297057       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.903976906122       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.903900234725       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.905572745421       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.903674966315       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.904834491378       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.905028251500       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.904021093793       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.905051220780       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.904388891388       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.904936078898       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.904012455762       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.904732317697       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.904834559283       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.906257677709       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.904603156703       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.904986376910       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.904782254033       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.905153281549       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.904163940369       residual = 6.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.904459062931       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.905332107702       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.904400785649       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.904153746372       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.904354603927       residual = 5.11e-05           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.904422288001       residual = 2.08e-05           smallest_sin_value = 9.99e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.903871152007       residual = 3.05e-05           smallest_sin_value = 9.99e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.904174598322       residual = 3.01e-05           smallest_sin_value = 9.97e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.904193220151       residual = 5.15e-05           smallest_sin_value = 9.95e-01
davidson iteration   50 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         50 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+11 is 5.649794e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.375228 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6618e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.2881
    reference variance = 0.316455
====================================================
  Execution time = 1.3518e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0183e-01
  Total weights = 1.9578e+06
  Execution time = 1.8373e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287474044672
                                         uncertainty =       0.001571526613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287474044672
                                         uncertainty =       0.001571526613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379116756
  error estimate for blocks of size 2^( 2) =       0.000390549463
  error estimate for blocks of size 2^( 3) =       0.000400608837
  error estimate for blocks of size 2^( 4) =       0.000409076113
  error estimate for blocks of size 2^( 5) =       0.000414242626
  error estimate for blocks of size 2^( 6) =       0.000416910321
  error estimate for blocks of size 2^( 7) =       0.000416845338

      target function =      -0.909846973705
              le_mean =     -17.214095229847
             les_mean =     296.626908506721
             stat err =       0.000414268600
             autocorr =       1.194037790829
   target nu stat err =       0.000414268600
   target dn stat err =       0.002648471049
      target stat err =       0.004141118877
              std dev =       0.536152058655
             le_variance =       0.287459030000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287474044672
                                         uncertainty =       0.001571526613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287474044672
                                         uncertainty =       0.001571526613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379116756
  error estimate for blocks of size 2^( 2) =       0.000390549463
  error estimate for blocks of size 2^( 3) =       0.000400608837
  error estimate for blocks of size 2^( 4) =       0.000409076113
  error estimate for blocks of size 2^( 5) =       0.000414242626
  error estimate for blocks of size 2^( 6) =       0.000416910321
  error estimate for blocks of size 2^( 7) =       0.000416845338

      target function =      -0.909846973705
              le_mean =     -17.214095229847
             les_mean =     296.626908506721
             stat err =       0.000414268600
             autocorr =       1.194037790829
   target nu stat err =       0.000414268600
   target dn stat err =       0.002648471049
      target stat err =       0.004141118877
              std dev =       0.536152058655
             le_variance =       0.287459030000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287474044672
                                         uncertainty =       0.001571526613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287474044672
                                         uncertainty =       0.001571526613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379116756
  error estimate for blocks of size 2^( 2) =       0.000390549463
  error estimate for blocks of size 2^( 3) =       0.000400608837
  error estimate for blocks of size 2^( 4) =       0.000409076113
  error estimate for blocks of size 2^( 5) =       0.000414242626
  error estimate for blocks of size 2^( 6) =       0.000416910321
  error estimate for blocks of size 2^( 7) =       0.000416845338

      target function =      -0.909846973705
              le_mean =     -17.214095229847
             les_mean =     296.626908506721
             stat err =       0.000414268600
             autocorr =       1.194037790829
   target nu stat err =       0.000414268600
   target dn stat err =       0.002648471049
      target stat err =       0.004141118877
              std dev =       0.536152058655
             le_variance =       0.287459030000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287474044672
                                         uncertainty =       0.001571526613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287474044672
                                         uncertainty =       0.001571526613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379116756
  error estimate for blocks of size 2^( 2) =       0.000390549463
  error estimate for blocks of size 2^( 3) =       0.000400608837
  error estimate for blocks of size 2^( 4) =       0.000409076113
  error estimate for blocks of size 2^( 5) =       0.000414242626
  error estimate for blocks of size 2^( 6) =       0.000416910321
  error estimate for blocks of size 2^( 7) =       0.000416845338

      target function =      -0.909846973705
              le_mean =     -17.214095229847
             les_mean =     296.626908506721
             stat err =       0.000414268600
             autocorr =       1.194037790828
   target nu stat err =       0.000414268600
   target dn stat err =       0.002648471049
      target stat err =       0.004141118877
              std dev =       0.536152058655
             le_variance =       0.287459030000


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909846973705        initial
     2.1176e+10     2.1176e+11             9.2147e-15        -0.909846973705
     8.4703e+10     8.4703e+11             2.2727e-15        -0.909846973705
     3.3881e+11     3.3881e+12             5.6498e-16        -0.909846973705  <--

*****************************************************************************
Applying the update for shift_i =   3.3881e+11     and shift_s =   3.3881e+12
*****************************************************************************

  Execution time = 2.2766e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9390e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2711
    reference variance = 0.294729
====================================================
  Execution time = 1.3827e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9900e-01
  Total weights = 1.957401399e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5016e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287256234604
                                         uncertainty =       0.001938537205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287256234604
                                         uncertainty =       0.001938537205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379007996
  error estimate for blocks of size 2^( 2) =       0.000390798638
  error estimate for blocks of size 2^( 3) =       0.000400540893
  error estimate for blocks of size 2^( 4) =       0.000407778583
  error estimate for blocks of size 2^( 5) =       0.000412244518
  error estimate for blocks of size 2^( 6) =       0.000415056842
  error estimate for blocks of size 2^( 7) =       0.000416620227

      target function =      -0.914216092914
              le_mean =     -17.214700135061
             les_mean =     296.644902411853
             stat err =       0.000412925043
             autocorr =       1.186986283037
   target nu stat err =       0.000412925043
   target dn stat err =       0.002446500523
      target stat err =       0.003874985090
              std dev =       0.535998247724
             le_variance =       0.287294121563


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721470013506e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+10, overlap shift 8.4703e+11 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914231503253       residual = 6.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914231503253       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914231503253       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914231503253       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914231503253       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914231503253       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914273967007       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914320938388       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914209670339       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914284042012       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914219394547       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914239693183       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914250065614       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914322418073       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914251760620       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914255590466       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914268100156       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914432745625       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914173282043       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914251166889       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914370589730       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914209517330       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914283777882       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914162543444       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914186008263       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914099450986       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914247716917       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914379931841       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914136170611       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914282273382       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914220062979       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914325530609       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914170949610       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914294098519       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914175330826       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914225267032       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914252779905       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914147612615       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914161200160       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914162925008       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.914186971880       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.914296103428       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.914170777895       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.914317666001       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.914100183743       residual = 9.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.914150350850       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.914287266829       residual = 4.60e-06           smallest_sin_value = 9.99e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.914078258760       residual = 3.92e-06           smallest_sin_value = 9.99e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.914260983533       residual = 4.82e-06           smallest_sin_value = 9.99e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.914287428992       residual = 3.31e-06           smallest_sin_value = 9.97e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.914241532154       residual = 2.53e-06           smallest_sin_value = 9.96e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.914120995920       residual = 9.49e-06           smallest_sin_value = 9.95e-01
davidson iteration   52 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         52 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+10 is 1.363307e-15

solving harmonic davidson linear method for identity shift 3.3881e+11, overlap shift 3.3881e+12 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914231503253       residual = 6.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914231503253       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914231503253       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914089169551       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914185281318       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914164196607       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914568794375       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913618434015       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913546831893       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914738386478       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914858075484       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913977455390       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914402390814       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915038394997       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914598363292       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914373112949       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914268930907       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914274031061       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914269853192       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914305288035       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914174229606       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914185933191       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914192681234       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914168201625       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914309331447       residual = 8.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914311681317       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914296301976       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914160702283       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914296719453       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914196110484       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914156259361       residual = 9.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914227391770       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914154647820       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914204333650       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914298907212       residual = 7.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914197109290       residual = 7.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914240305817       residual = 5.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914249786500       residual = 5.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914321547906       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914319113194       residual = 5.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.914267206666       residual = 7.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.914159026146       residual = 4.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.914240227630       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.914177754297       residual = 4.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.914076507498       residual = 6.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.914226790165       residual = 5.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.914160542721       residual = 5.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.914086825392       residual = 5.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.914120893717       residual = 5.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.914215374323       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.914239439377       residual = 6.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.914270354972       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.914153910201       residual = 1.13e-03           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.914249597879       residual = 1.74e-03           smallest_sin_value = 9.98e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.914271175612       residual = 1.05e-03           smallest_sin_value = 9.98e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.914081949482       residual = 2.41e-03           smallest_sin_value = 9.95e-01
davidson iteration   56 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         56 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+11 is 3.436719e-16

solving harmonic davidson linear method for identity shift 1.3553e+12, overlap shift 1.3553e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914231503253       residual = 6.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914231503253       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914231503253       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914231503253       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913192279461       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912920247668       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914152439498       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916316636388       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915172775427       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909931298419       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919401043499       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915808406024       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914580643203       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915753836818       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912778210468       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917405119525       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914543800343       residual = 5.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914970000435       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910604324379       residual = 6.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914136404897       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914102799729       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914462292871       residual = 5.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914190465991       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914543939491       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914328114065       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914260130125       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914142348308       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914096166599       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914314357801       residual = 5.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914279137830       residual = 5.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914258933773       residual = 4.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914663050220       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914504621646       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914262400826       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914399856090       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914790907552       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913327407462       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914073696231       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914268452170       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914537982967       residual = 1.14e-03           smallest_sin_value = 9.99e-01
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.914394653215       residual = 2.74e-03           smallest_sin_value = 9.98e-01
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.913951726820       residual = 2.27e-03           smallest_sin_value = 9.98e-01
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.914153940942       residual = 3.67e-03           smallest_sin_value = 9.96e-01
davidson iteration   43 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         43 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+12 is 8.812985e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.532095 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6492e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2336
    reference variance = 0.37183
====================================================
  Execution time = 1.3658e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0376e-01
  Total weights = 1.9578e+06
  Execution time = 1.8479e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290497585420
                                         uncertainty =       0.002046508947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290497585420
                                         uncertainty =       0.002046508947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381092802
  error estimate for blocks of size 2^( 2) =       0.000392206220
  error estimate for blocks of size 2^( 3) =       0.000402084650
  error estimate for blocks of size 2^( 4) =       0.000410321151
  error estimate for blocks of size 2^( 5) =       0.000414955420
  error estimate for blocks of size 2^( 6) =       0.000416729522
  error estimate for blocks of size 2^( 7) =       0.000417384468

      target function =      -0.906887018559
              le_mean =     -17.214050408642
             les_mean =     296.627293927369
             stat err =       0.000414847640
             autocorr =       1.184992923284
   target nu stat err =       0.000414847640
   target dn stat err =       0.002620624098
      target stat err =       0.004072425476
              std dev =       0.538946608554
             le_variance =       0.290463446872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290497585420
                                         uncertainty =       0.002046508947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290497585420
                                         uncertainty =       0.002046508947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381092802
  error estimate for blocks of size 2^( 2) =       0.000392206220
  error estimate for blocks of size 2^( 3) =       0.000402084650
  error estimate for blocks of size 2^( 4) =       0.000410321151
  error estimate for blocks of size 2^( 5) =       0.000414955420
  error estimate for blocks of size 2^( 6) =       0.000416729522
  error estimate for blocks of size 2^( 7) =       0.000417384468

      target function =      -0.906887018559
              le_mean =     -17.214050408642
             les_mean =     296.627293927369
             stat err =       0.000414847640
             autocorr =       1.184992923283
   target nu stat err =       0.000414847640
   target dn stat err =       0.002620624098
      target stat err =       0.004072425476
              std dev =       0.538946608554
             le_variance =       0.290463446872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290497585420
                                         uncertainty =       0.002046508947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290497585420
                                         uncertainty =       0.002046508947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381092802
  error estimate for blocks of size 2^( 2) =       0.000392206220
  error estimate for blocks of size 2^( 3) =       0.000402084650
  error estimate for blocks of size 2^( 4) =       0.000410321151
  error estimate for blocks of size 2^( 5) =       0.000414955420
  error estimate for blocks of size 2^( 6) =       0.000416729522
  error estimate for blocks of size 2^( 7) =       0.000417384468

      target function =      -0.906887018559
              le_mean =     -17.214050408642
             les_mean =     296.627293927369
             stat err =       0.000414847640
             autocorr =       1.184992923285
   target nu stat err =       0.000414847640
   target dn stat err =       0.002620624098
      target stat err =       0.004072425476
              std dev =       0.538946608554
             le_variance =       0.290463446872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290497585420
                                         uncertainty =       0.002046508947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290497585420
                                         uncertainty =       0.002046508947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381092802
  error estimate for blocks of size 2^( 2) =       0.000392206220
  error estimate for blocks of size 2^( 3) =       0.000402084650
  error estimate for blocks of size 2^( 4) =       0.000410321151
  error estimate for blocks of size 2^( 5) =       0.000414955420
  error estimate for blocks of size 2^( 6) =       0.000416729522
  error estimate for blocks of size 2^( 7) =       0.000417384468

      target function =      -0.906887018559
              le_mean =     -17.214050408642
             les_mean =     296.627293927369
             stat err =       0.000414847640
             autocorr =       1.184992923283
   target nu stat err =       0.000414847640
   target dn stat err =       0.002620624098
      target stat err =       0.004072425476
              std dev =       0.538946608554
             le_variance =       0.290463446872


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.906887018559        initial
     8.4703e+10     8.4703e+11             1.3633e-15        -0.906887018559
     3.3881e+11     3.3881e+12             3.4367e-16        -0.906887018559  <--
     1.3553e+12     1.3553e+13             8.8130e-17        -0.906887018559

*****************************************************************************
Applying the update for shift_i =   3.3881e+11     and shift_s =   3.3881e+12
*****************************************************************************

  Execution time = 2.2992e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9490e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.1932
    reference variance = 0.198308
====================================================
  Execution time = 1.3777e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9900e-01
  Total weights = 1.957809398e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5416e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285788746031
                                         uncertainty =       0.001744571229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285788746031
                                         uncertainty =       0.001744571229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378224585
  error estimate for blocks of size 2^( 2) =       0.000389614137
  error estimate for blocks of size 2^( 3) =       0.000399931948
  error estimate for blocks of size 2^( 4) =       0.000408025947
  error estimate for blocks of size 2^( 5) =       0.000412793413
  error estimate for blocks of size 2^( 6) =       0.000416241965
  error estimate for blocks of size 2^( 7) =       0.000419033670

      target function =      -0.914202565285
              le_mean =     -17.215099570787
             les_mean =     296.658651796960
             stat err =       0.000414023749
             autocorr =       1.198259816680
   target nu stat err =       0.000414023749
   target dn stat err =       0.002825126781
      target stat err =       0.004459717888
              std dev =       0.534890338186
             le_variance =       0.286107673885


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721509957079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+10, overlap shift 8.4703e+11 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914223272778       residual = 3.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914223272778       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914223272778       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914223272778       residual = 7.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914223272778       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914222820158       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914239912785       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914372410525       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914192059513       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914167321472       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914291951724       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914055300373       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914057135797       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914320716255       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914143994033       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914363628316       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914109777501       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914172666578       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914410671120       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914291967341       residual = 9.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914400781242       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914198155351       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914140027476       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914355212710       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914150513555       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914097429800       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914272990752       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914248415481       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914341980726       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914103369932       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914415317239       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914177506885       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914216185494       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914134926356       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914266658378       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914269892545       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914165258816       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914187753909       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914314320798       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914196437197       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.914143456661       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.914328406897       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.914117305887       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.914209335535       residual = 8.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.914307625351       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.914289353017       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.914341790557       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.914096902345       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.914111756816       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.914369127886       residual = 3.05e-05           smallest_sin_value = 9.99e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.914259030064       residual = 2.08e-06           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.914238650017       residual = 2.25e-06           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.914215045811       residual = 2.06e-06           smallest_sin_value = 9.97e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+10 is 2.490416e-15

solving harmonic davidson linear method for identity shift 3.3881e+11, overlap shift 3.3881e+12 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914223272778       residual = 3.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914223272778       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914223272778       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914223272778       residual = 7.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914226437941       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914384898636       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914582061640       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913456474875       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914328698947       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914356243484       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913587087731       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914646724352       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913810617852       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914650290831       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914303702440       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914363249762       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914146035311       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914066493539       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914288409919       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913958623248       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914227431330       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914209876439       residual = 6.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914262893766       residual = 8.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914323841882       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914611436344       residual = 7.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914306606826       residual = 6.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914188903801       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914327981709       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914147035064       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914227985431       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914320746390       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914236999809       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914330077550       residual = 9.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914086837039       residual = 9.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914260076364       residual = 7.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914241083572       residual = 7.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914166960870       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914136152944       residual = 6.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.914130593625       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914235350721       residual = 8.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.913995572537       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.914258272259       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.914131341944       residual = 7.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.914162961599       residual = 7.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.914297765439       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.914069466062       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.914081613103       residual = 1.95e-03           smallest_sin_value = 9.99e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.914142193555       residual = 4.79e-03           smallest_sin_value = 9.94e-01
davidson iteration   48 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         48 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+11 is 6.253872e-16

solving harmonic davidson linear method for identity shift 1.3553e+12, overlap shift 1.3553e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914223272778       residual = 3.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914223272778       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914223272778       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914223272778       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915030862755       residual = 9.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914220125378       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913542533725       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915366988117       residual = 5.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915612816616       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913831390836       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914293715472       residual = 8.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914869794990       residual = 6.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917802733799       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915521108187       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913842571602       residual = 6.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913796206908       residual = 8.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911834396518       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914568936650       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912311069775       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914705999171       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914216694831       residual = 9.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913595709281       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916001042273       residual = 7.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917552122396       residual = 6.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916606906196       residual = 5.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913909732052       residual = 7.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916026395166       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915521955883       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913444396256       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913135373192       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913481935325       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912796392052       residual = 5.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915046846441       residual = 8.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913092357930       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915040816473       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913403083844       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913885787945       residual = 8.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915551575896       residual = 9.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915505519010       residual = 8.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914150386144       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.914214027624       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.914624731563       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.914334957964       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.917309955639       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.913314727612       residual = 6.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.911300485813       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.914715139183       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.912198388247       residual = 1.15e-03           smallest_sin_value = 9.99e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.914953006964       residual = 6.79e-04           smallest_sin_value = 9.99e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.915762390716       residual = 2.65e-04           smallest_sin_value = 9.99e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.911884452876       residual = 5.89e-04           smallest_sin_value = 9.96e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.913045159414       residual = 1.58e-03           smallest_sin_value = 9.94e-01
davidson iteration   52 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         52 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+12 is 1.515166e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.686683 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6479e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.2465
    reference variance = 0.180266
====================================================
  Execution time = 1.6086e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9852e-01
  Total weights = 1.9581e+06
  Execution time = 1.8319e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286048562843
                                         uncertainty =       0.001386716596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286048562843
                                         uncertainty =       0.001386716596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378163775
  error estimate for blocks of size 2^( 2) =       0.000389366880
  error estimate for blocks of size 2^( 3) =       0.000399528070
  error estimate for blocks of size 2^( 4) =       0.000407516914
  error estimate for blocks of size 2^( 5) =       0.000412258715
  error estimate for blocks of size 2^( 6) =       0.000414470579
  error estimate for blocks of size 2^( 7) =       0.000415649419

      target function =      -0.914953309762
              le_mean =     -17.215093956281
             les_mean =     296.657982697341
             stat err =       0.000412473907
             autocorr =       1.189688082277
   target nu stat err =       0.000412473907
   target dn stat err =       0.002186562958
      target stat err =       0.003485507277
              std dev =       0.534804339404
             le_variance =       0.286015681445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286048562843
                                         uncertainty =       0.001386716596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286048562843
                                         uncertainty =       0.001386716596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378163775
  error estimate for blocks of size 2^( 2) =       0.000389366880
  error estimate for blocks of size 2^( 3) =       0.000399528070
  error estimate for blocks of size 2^( 4) =       0.000407516914
  error estimate for blocks of size 2^( 5) =       0.000412258715
  error estimate for blocks of size 2^( 6) =       0.000414470579
  error estimate for blocks of size 2^( 7) =       0.000415649419

      target function =      -0.914953309762
              le_mean =     -17.215093956281
             les_mean =     296.657982697341
             stat err =       0.000412473907
             autocorr =       1.189688082277
   target nu stat err =       0.000412473907
   target dn stat err =       0.002186562958
      target stat err =       0.003485507277
              std dev =       0.534804339404
             le_variance =       0.286015681445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286048562843
                                         uncertainty =       0.001386716596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286048562843
                                         uncertainty =       0.001386716596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378163775
  error estimate for blocks of size 2^( 2) =       0.000389366880
  error estimate for blocks of size 2^( 3) =       0.000399528070
  error estimate for blocks of size 2^( 4) =       0.000407516914
  error estimate for blocks of size 2^( 5) =       0.000412258715
  error estimate for blocks of size 2^( 6) =       0.000414470579
  error estimate for blocks of size 2^( 7) =       0.000415649419

      target function =      -0.914953309762
              le_mean =     -17.215093956281
             les_mean =     296.657982697341
             stat err =       0.000412473907
             autocorr =       1.189688082280
   target nu stat err =       0.000412473907
   target dn stat err =       0.002186562958
      target stat err =       0.003485507277
              std dev =       0.534804339404
             le_variance =       0.286015681445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286048562843
                                         uncertainty =       0.001386716596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286048562843
                                         uncertainty =       0.001386716596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378163775
  error estimate for blocks of size 2^( 2) =       0.000389366880
  error estimate for blocks of size 2^( 3) =       0.000399528070
  error estimate for blocks of size 2^( 4) =       0.000407516914
  error estimate for blocks of size 2^( 5) =       0.000412258715
  error estimate for blocks of size 2^( 6) =       0.000414470579
  error estimate for blocks of size 2^( 7) =       0.000415649419

      target function =      -0.914953309762
              le_mean =     -17.215093956281
             les_mean =     296.657982697341
             stat err =       0.000412473907
             autocorr =       1.189688082277
   target nu stat err =       0.000412473907
   target dn stat err =       0.002186562958
      target stat err =       0.003485507277
              std dev =       0.534804339404
             le_variance =       0.286015681445


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914953309762        initial
     8.4703e+10     8.4703e+11             2.4904e-15        -0.914953309762
     3.3881e+11     3.3881e+12             6.2539e-16        -0.914953309762
     1.3553e+12     1.3553e+13             1.5152e-16        -0.914953309762  <--

*****************************************************************************
Applying the update for shift_i =   1.3553e+12     and shift_s =   1.3553e+13
*****************************************************************************

  Execution time = 2.5395e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1881e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.2556
    reference variance = 0.311701
====================================================
  Execution time = 1.3770e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0187e-01
  Total weights = 1.958015120e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5096e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284883003288
                                         uncertainty =       0.001553590142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284883003288
                                         uncertainty =       0.001553590142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377372543
  error estimate for blocks of size 2^( 2) =       0.000388629069
  error estimate for blocks of size 2^( 3) =       0.000399045024
  error estimate for blocks of size 2^( 4) =       0.000406390556
  error estimate for blocks of size 2^( 5) =       0.000411848529
  error estimate for blocks of size 2^( 6) =       0.000416171790
  error estimate for blocks of size 2^( 7) =       0.000417875612

      target function =      -0.909730922695
              le_mean =     -17.214041916443
             les_mean =     296.625105943921
             stat err =       0.000413071621
             autocorr =       1.198147048891
   target nu stat err =       0.000413071621
   target dn stat err =       0.005734324175
      target stat err =       0.008861665184
              std dev =       0.533685368155
             le_variance =       0.284820072182


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721404191644e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+11, overlap shift 3.3881e+12 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909816038210       residual = 9.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909816038210       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909816038210       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909816038210       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909816038210       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909816038210       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909816038210       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910227555228       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909816038210       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909949206259       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909999478786       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909638162803       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910228916599       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.909673346352       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910161374326       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.909784730642       residual = 7.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.909971434631       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.909952483337       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.909905965433       residual = 5.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.909774578634       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.909793735240       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909714326140       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.909835201994       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.909899773038       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.909812742479       residual = 5.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909917603454       residual = 8.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.909892062116       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.909907410176       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.909854539856       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.909876774623       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.909648021313       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909753890572       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.909746601668       residual = 6.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.909656938794       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.909949701432       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.909783488425       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.909894716035       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.909758537910       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.909734188012       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.909727002332       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.909764667498       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.909870453456       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.909772366390       residual = 3.68e-04           smallest_sin_value = 9.98e-01
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.909852284354       residual = 9.43e-04           smallest_sin_value = 9.98e-01
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.910371252893       residual = 1.23e-05           smallest_sin_value = 9.93e-01
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.909650204869       residual = 1.89e-05           smallest_sin_value = 9.92e-01
davidson iteration   46 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         46 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+11 is 3.996470e-16

solving harmonic davidson linear method for identity shift 1.3553e+12, overlap shift 1.3553e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909816038210       residual = 9.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909816038210       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909816038210       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909816038210       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910280388977       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910809189268       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911498368123       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907855606760       residual = 8.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906893533333       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912972897548       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.907114963243       residual = 6.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.907682084839       residual = 8.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910701251980       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.905813192557       residual = 8.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910193760809       residual = 5.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910264189984       residual = 3.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.909733192698       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.909567808569       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.909944952148       residual = 9.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.909835882809       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.909718980158       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909868568084       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.909872066216       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.909967679981       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.909852955193       residual = 7.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909562196438       residual = 9.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.909569318929       residual = 4.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.909738488512       residual = 4.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.909656444111       residual = 4.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910157808773       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.909855749589       residual = 3.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909917437669       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.909783614029       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.909796369245       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.909701997085       residual = 7.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.909702282649       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.909944688623       residual = 6.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.909945955015       residual = 2.94e-03           smallest_sin_value = 9.99e-01
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.910019558243       residual = 2.06e-03           smallest_sin_value = 9.99e-01
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.909731342991       residual = 2.45e-03           smallest_sin_value = 9.97e-01
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.909797898530       residual = 7.02e-03           smallest_sin_value = 9.95e-01
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.910010239778       residual = 2.25e-04           smallest_sin_value = 9.90e-01
davidson iteration   42 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         42 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+12 is 9.776571e-17

solving harmonic davidson linear method for identity shift 5.4210e+12, overlap shift 5.4210e+13 and omega -1.7751e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909816038210       residual = 9.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909816038210       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909816038210       residual = 6.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909816038210       residual = 8.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909816038210       residual = 9.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904875765306       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910907564149       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908413630473       residual = 8.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912851173886       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915554752813       residual = 9.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925171676715       residual = 4.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.903336555989       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913765723694       residual = 7.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.909377341508       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.903963043791       residual = 2.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919199771488       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.901945251015       residual = 6.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911478670977       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.904989564088       residual = 6.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910504177237       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912071136299       residual = 3.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909665335213       residual = 1.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908975422493       residual = 1.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911683659555       residual = 3.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910011246666       residual = 2.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909065013260       residual = 2.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912402062916       residual = 4.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910994933514       residual = 9.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.909953913599       residual = 2.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910065607195       residual = 4.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910849934086       residual = 6.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910106976590       residual = 2.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.909660118204       residual = 8.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908002083714       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.910731347423       residual = 6.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910508760736       residual = 2.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.910017712660       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.910022406725       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.909087340402       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.907823646963       residual = 4.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.909565993729       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.909117434156       residual = 1.90e-02           smallest_sin_value = 9.99e-01
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.908455856505       residual = 2.06e-02           smallest_sin_value = 9.98e-01
davidson iteration   43: stopping due to imaginary component in cost function
davidson solver did not converge after         43 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+12 is 2.002342e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.787816 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6387e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.2212
    reference variance = 0.111144
====================================================
  Execution time = 1.3375e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0062e-01
  Total weights = 1.9575e+06
  Execution time = 1.8403e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287166329963
                                         uncertainty =       0.001840432072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287166329963
                                         uncertainty =       0.001840432072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378879608
  error estimate for blocks of size 2^( 2) =       0.000389973564
  error estimate for blocks of size 2^( 3) =       0.000400982331
  error estimate for blocks of size 2^( 4) =       0.000408626744
  error estimate for blocks of size 2^( 5) =       0.000412594075
  error estimate for blocks of size 2^( 6) =       0.000414808539
  error estimate for blocks of size 2^( 7) =       0.000417761662

      target function =      -0.911695672914
              le_mean =     -17.214492156033
             les_mean =     296.639364954576
             stat err =       0.000413447755
             autocorr =       1.190799966042
   target nu stat err =       0.000413447755
   target dn stat err =       0.002939941474
      target stat err =       0.004606050804
              std dev =       0.535816679915
             le_variance =       0.287099514475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287166329963
                                         uncertainty =       0.001840432072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287166329963
                                         uncertainty =       0.001840432072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378879608
  error estimate for blocks of size 2^( 2) =       0.000389973564
  error estimate for blocks of size 2^( 3) =       0.000400982331
  error estimate for blocks of size 2^( 4) =       0.000408626744
  error estimate for blocks of size 2^( 5) =       0.000412594075
  error estimate for blocks of size 2^( 6) =       0.000414808539
  error estimate for blocks of size 2^( 7) =       0.000417761662

      target function =      -0.911695672914
              le_mean =     -17.214492156033
             les_mean =     296.639364954576
             stat err =       0.000413447755
             autocorr =       1.190799966042
   target nu stat err =       0.000413447755
   target dn stat err =       0.002939941474
      target stat err =       0.004606050804
              std dev =       0.535816679915
             le_variance =       0.287099514475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287166329963
                                         uncertainty =       0.001840432072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287166329963
                                         uncertainty =       0.001840432072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378879608
  error estimate for blocks of size 2^( 2) =       0.000389973564
  error estimate for blocks of size 2^( 3) =       0.000400982331
  error estimate for blocks of size 2^( 4) =       0.000408626744
  error estimate for blocks of size 2^( 5) =       0.000412594075
  error estimate for blocks of size 2^( 6) =       0.000414808539
  error estimate for blocks of size 2^( 7) =       0.000417761662

      target function =      -0.911695672914
              le_mean =     -17.214492156033
             les_mean =     296.639364954576
             stat err =       0.000413447755
             autocorr =       1.190799966042
   target nu stat err =       0.000413447755
   target dn stat err =       0.002939941474
      target stat err =       0.004606050804
              std dev =       0.535816679915
             le_variance =       0.287099514475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287166329963
                                         uncertainty =       0.001840432072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287166329963
                                         uncertainty =       0.001840432072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378879608
  error estimate for blocks of size 2^( 2) =       0.000389973564
  error estimate for blocks of size 2^( 3) =       0.000400982331
  error estimate for blocks of size 2^( 4) =       0.000408626744
  error estimate for blocks of size 2^( 5) =       0.000412594075
  error estimate for blocks of size 2^( 6) =       0.000414808539
  error estimate for blocks of size 2^( 7) =       0.000417761662

      target function =      -0.911695672914
              le_mean =     -17.214492156033
             les_mean =     296.639364954576
             stat err =       0.000413447755
             autocorr =       1.190799966038
   target nu stat err =       0.000413447755
   target dn stat err =       0.002939941474
      target stat err =       0.004606050804
              std dev =       0.535816679915
             le_variance =       0.287099514475


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911695672914        initial
     3.3881e+11     3.3881e+12             3.9965e-16        -0.911695672914  <--
     1.3553e+12     1.3553e+13             9.7766e-17        -0.911695672914
     5.4210e+12     5.4210e+13             2.0023e-17        -0.911695672914

*****************************************************************************
Applying the update for shift_i =   3.3881e+11     and shift_s =   3.3881e+12
*****************************************************************************

  Execution time = 2.2634e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_001                -3.749561e-02 3 1  ON 0
ci_002                -2.874832e-02 3 1  ON 1
ci_003                -2.361784e-02 3 1  ON 2
ci_004                 2.083399e-02 3 1  ON 3
ci_005                 2.126880e-02 3 1  ON 4
ci_006                -1.839599e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -7.764065e-03 3 1  ON 7
ci_009                -1.387888e-02 3 1  ON 8
ci_010                -8.829272e-03 3 1  ON 9
ci_011                -8.959956e-03 3 1  ON 10
ci_012                -9.098933e-03 3 1  ON 11
ci_013                -1.909114e-02 3 1  ON 12
ci_014                 1.111280e-02 3 1  ON 13
ci_015                 1.092241e-02 3 1  ON 14
ci_016                 1.590825e-02 3 1  ON 15
ci_017                 1.564650e-02 3 1  ON 16
ci_018                 9.100985e-03 3 1  ON 17
ci_019                 9.001122e-03 3 1  ON 18
ci_020                 1.504177e-02 3 1  ON 19
ci_021                 1.520374e-02 3 1  ON 20
ci_022                 8.270877e-03 3 1  ON 21
ci_023                 8.252620e-03 3 1  ON 22
ci_024                 8.336508e-03 3 1  ON 23
ci_025                 8.419976e-03 3 1  ON 24
ci_026                 9.900440e-03 3 1  ON 25
ci_027                 9.702756e-03 3 1  ON 26
ci_028                -1.453333e-02 3 1  ON 27
ci_029                -1.479907e-02 3 1  ON 28
ci_030                -8.756952e-03 3 1  ON 29
ci_031                -8.610841e-03 3 1  ON 30
ci_032                -1.432766e-02 3 1  ON 31
ci_033                 4.550066e-03 3 1  ON 32
ci_034                 4.834241e-03 3 1  ON 33
ci_035                -3.330943e-03 3 1  ON 34
ci_036                -1.121939e-02 3 1  ON 35
ci_037                -1.147550e-02 3 1  ON 36
ci_038                 8.690516e-04 3 1  ON 37
ci_039                 1.139691e-03 3 1  ON 38
ci_040                -1.555743e-03 3 1  ON 39
ci_041                 8.159903e-03 3 1  ON 40
ci_042                 8.160707e-03 3 1  ON 41
ci_043                -2.343099e-03 3 1  ON 42
ci_044                -3.907837e-03 3 1  ON 43
ci_045                -1.989375e-03 3 1  ON 44
ci_046                 4.783180e-03 3 1  ON 45
ci_047                 4.612305e-03 3 1  ON 46
ci_048                -1.237724e-02 3 1  ON 47
ci_049                -1.295227e-02 3 1  ON 48
ci_050                 2.845580e-03 3 1  ON 49
ci_051                 2.985873e-03 3 1  ON 50
ci_052                -2.175771e-03 3 1  ON 51
ci_053                -2.207808e-03 3 1  ON 52
ci_054                -2.208051e-03 3 1  ON 53
ci_055                -2.426851e-03 3 1  ON 54
ci_056                 4.623985e-03 3 1  ON 55
ci_057                 4.639855e-03 3 1  ON 56
ci_058                -2.070630e-03 3 1  ON 57
ci_059                -2.053358e-03 3 1  ON 58
ci_060                 4.760642e-03 3 1  ON 59
ci_061                 5.206729e-03 3 1  ON 60
ci_062                -2.953742e-03 3 1  ON 61
ci_063                -2.807725e-03 3 1  ON 62
ci_064                -2.259142e-03 3 1  ON 63
ci_065                -3.382808e-03 3 1  ON 64
ci_066                 4.060415e-03 3 1  ON 65
ci_067                 4.226243e-03 3 1  ON 66
ci_068                -4.274510e-03 3 1  ON 67
ci_069                -4.110928e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9027e+01 secs
  Total Execution time = 3.9596e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
