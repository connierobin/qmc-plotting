--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            n0268.savio3
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4123

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
Rank =    0  Free Memory = 89883 MB
Rank =    1  Free Memory = 89879 MB
Rank =    2  Free Memory = 89879 MB
Rank =    3  Free Memory = 89879 MB
Rank =    4  Free Memory = 89879 MB
Rank =    5  Free Memory = 89879 MB
Rank =    6  Free Memory = 89879 MB
Rank =    7  Free Memory = 89878 MB
Rank =    8  Free Memory = 89878 MB
Rank =    9  Free Memory = 89878 MB
Rank =   10  Free Memory = 89878 MB
Rank =   11  Free Memory = 89878 MB
Rank =   12  Free Memory = 89878 MB
Rank =   13  Free Memory = 89877 MB
Rank =   14  Free Memory = 89877 MB
Rank =   15  Free Memory = 89877 MB
Rank =   16  Free Memory = 89877 MB
Rank =   17  Free Memory = 89877 MB
Rank =   18  Free Memory = 89877 MB
Rank =   19  Free Memory = 89877 MB
Rank =   20  Free Memory = 89877 MB
Rank =   21  Free Memory = 89877 MB
Rank =   22  Free Memory = 89877 MB
Rank =   23  Free Memory = 89877 MB
Rank =   24  Free Memory = 89877 MB
Rank =   25  Free Memory = 89877 MB
Rank =   26  Free Memory = 89877 MB
Rank =   27  Free Memory = 89877 MB
Rank =   28  Free Memory = 89877 MB
Rank =   29  Free Memory = 89877 MB
Rank =   30  Free Memory = 89877 MB
Rank =   31  Free Memory = 89877 MB
Rank =   32  Free Memory = 89877 MB
Rank =   33  Free Memory = 89877 MB
Rank =   34  Free Memory = 89877 MB
Rank =   35  Free Memory = 89877 MB
Rank =   36  Free Memory = 89877 MB
Rank =   37  Free Memory = 89877 MB
Rank =   38  Free Memory = 89877 MB
Rank =   39  Free Memory = 89877 MB
Rank =   40  Free Memory = 89528 MB
Rank =   41  Free Memory = 89528 MB
Rank =   42  Free Memory = 89528 MB
Rank =   43  Free Memory = 89528 MB
Rank =   44  Free Memory = 89528 MB
Rank =   45  Free Memory = 89528 MB
Rank =   46  Free Memory = 89528 MB
Rank =   47  Free Memory = 89528 MB
Rank =   48  Free Memory = 89528 MB
Rank =   49  Free Memory = 89528 MB
Rank =   50  Free Memory = 89528 MB
Rank =   51  Free Memory = 89528 MB
Rank =   52  Free Memory = 89528 MB
Rank =   53  Free Memory = 89528 MB
Rank =   54  Free Memory = 89528 MB
Rank =   55  Free Memory = 89528 MB
Rank =   56  Free Memory = 89528 MB
Rank =   57  Free Memory = 89528 MB
Rank =   58  Free Memory = 89528 MB
Rank =   59  Free Memory = 89528 MB
Rank =   60  Free Memory = 89528 MB
Rank =   61  Free Memory = 89528 MB
Rank =   62  Free Memory = 89528 MB
Rank =   63  Free Memory = 89528 MB
Rank =   64  Free Memory = 89528 MB
Rank =   65  Free Memory = 89528 MB
Rank =   66  Free Memory = 89528 MB
Rank =   67  Free Memory = 89528 MB
Rank =   68  Free Memory = 89528 MB
Rank =   69  Free Memory = 89528 MB
Rank =   70  Free Memory = 89528 MB
Rank =   71  Free Memory = 89528 MB
Rank =   72  Free Memory = 89528 MB
Rank =   73  Free Memory = 89528 MB
Rank =   74  Free Memory = 89528 MB
Rank =   75  Free Memory = 89528 MB
Rank =   76  Free Memory = 89528 MB
Rank =   77  Free Memory = 89528 MB
Rank =   78  Free Memory = 89528 MB
Rank =   79  Free Memory = 89528 MB
Rank =   80  Free Memory = 88352 MB
Rank =   81  Free Memory = 88352 MB
Rank =   82  Free Memory = 88352 MB
Rank =   83  Free Memory = 88352 MB
Rank =   84  Free Memory = 88352 MB
Rank =   85  Free Memory = 88352 MB
Rank =   86  Free Memory = 88352 MB
Rank =   87  Free Memory = 88352 MB
Rank =   88  Free Memory = 88352 MB
Rank =   89  Free Memory = 88352 MB
Rank =   90  Free Memory = 88352 MB
Rank =   91  Free Memory = 88352 MB
Rank =   92  Free Memory = 88352 MB
Rank =   93  Free Memory = 88352 MB
Rank =   94  Free Memory = 88352 MB
Rank =   95  Free Memory = 88352 MB
Rank =   96  Free Memory = 88352 MB
Rank =   97  Free Memory = 88352 MB
Rank =   98  Free Memory = 88352 MB
Rank =   99  Free Memory = 88352 MB
Rank =  100  Free Memory = 88352 MB
Rank =  101  Free Memory = 88352 MB
Rank =  102  Free Memory = 88352 MB
Rank =  103  Free Memory = 88352 MB
Rank =  104  Free Memory = 88352 MB
Rank =  105  Free Memory = 88352 MB
Rank =  106  Free Memory = 88352 MB
Rank =  107  Free Memory = 88352 MB
Rank =  108  Free Memory = 88352 MB
Rank =  109  Free Memory = 88352 MB
Rank =  110  Free Memory = 88352 MB
Rank =  111  Free Memory = 88352 MB
Rank =  112  Free Memory = 88352 MB
Rank =  113  Free Memory = 88351 MB
Rank =  114  Free Memory = 88351 MB
Rank =  115  Free Memory = 88351 MB
Rank =  116  Free Memory = 88351 MB
Rank =  117  Free Memory = 88351 MB
Rank =  118  Free Memory = 88351 MB
Rank =  119  Free Memory = 88351 MB
Rank =  120  Free Memory = 91409 MB
Rank =  121  Free Memory = 91409 MB
Rank =  122  Free Memory = 91409 MB
  Input file(s): opt_h2o_1b1_gvptt_run003d.xml 
Rank =  123  Free Memory = 91409 MB
Rank =  124  Free Memory = 91409 MB
Rank =  125  Free Memory = 91409 MB
Rank =  126  Free Memory = 91409 MB
Rank =  127  Free Memory = 91409 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 40
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run003d.xml

  Project = H2O
  date    = 2023-04-02 10:30:39 PDT
  host    = n0265.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 959

  Range of prime numbers to use as seeds over processors and threads = 7573-8737


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.078319e-01    1         1  ON     0
     uu_1                 1.417410e-01    1         1  ON     1
     uu_2                 4.087059e-02    1         1  ON     2
     uu_3                -2.053758e-02    1         1  ON     3
     uu_4                -6.439066e-02    1         1  ON     4
     uu_5                -9.731408e-02    1         1  ON     5
     uu_6                -1.228888e-01    1         1  ON     6
     uu_7                -1.345031e-01    1         1  ON     7
     uu_8                -1.263069e-01    1         1  ON     8
     uu_9                -9.639190e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.395403e-01    1         1  ON     0
     ud_1                 1.758796e-01    1         1  ON     1
     ud_2                 5.973553e-02    1         1  ON     2
     ud_3                -8.531853e-03    1         1  ON     3
     ud_4                -6.521414e-02    1         1  ON     4
     ud_5                -1.055299e-01    1         1  ON     5
     ud_6                -1.316859e-01    1         1  ON     6
     ud_7                -1.471938e-01    1         1  ON     7
     ud_8                -1.486211e-01    1         1  ON     8
     ud_9                -1.396792e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.471182e-01    1         1  ON     0
     eO_1                -4.315174e-01    1         1  ON     1
     eO_2                -1.816300e-02    1         1  ON     2
     eO_3                 2.953329e-01    1         1  ON     3
     eO_4                 5.135685e-01    1         1  ON     4
     eO_5                 4.702068e-01    1         1  ON     5
     eO_6                 2.408177e-01    1         1  ON     6
     eO_7                -5.352170e-02    1         1  ON     7
     eO_8                -2.059231e-01    1         1  ON     8
     eO_9                -6.546965e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.314856e-01    1         1  ON     0
     eH1_1                -1.337524e-01    1         1  ON     1
     eH1_2                -8.940675e-02    1         1  ON     2
     eH1_3                -3.617800e-02    1         1  ON     3
     eH1_4                 1.141233e-02    1         1  ON     4
     eH1_5                 4.421722e-02    1         1  ON     5
     eH1_6                 9.863349e-02    1         1  ON     6
     eH1_7                 1.437569e-01    1         1  ON     7
     eH1_8                 1.557627e-01    1         1  ON     8
     eH1_9                 4.167682e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.289961e-01    1         1  ON     0
     eH2_1                -1.317036e-01    1         1  ON     1
     eH2_2                -8.704156e-02    1         1  ON     2
     eH2_3                -3.383059e-02    1         1  ON     3
     eH2_4                 1.374843e-02    1         1  ON     4
     eH2_5                 4.823889e-02    1         1  ON     5
     eH2_6                 1.028465e-01    1         1  ON     6
     eH2_7                 1.498761e-01    1         1  ON     7
     eH2_8                 1.612679e-01    1         1  ON     8
     eH2_9                 2.375196e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 2.588480e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.6621e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
[n0265.savio3:146409] 127 more processes have sent help message help-mpi-btl-openib.txt / no device params found
[n0265.savio3:146409] Set MCA parameter "orte_base_help_aggregate" to 0 to see all help / error messages
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9329
    reference variance = 0.293349
====================================================
  Execution time = 2.3138e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3100e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7104e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331029184591
                                         uncertainty =       0.002801604564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331029184591
                                         uncertainty =       0.002801604564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406818631
  error estimate for blocks of size 2^( 2) =       0.000420004494
  error estimate for blocks of size 2^( 3) =       0.000433110832
  error estimate for blocks of size 2^( 4) =       0.000446095262
  error estimate for blocks of size 2^( 5) =       0.000457069944
  error estimate for blocks of size 2^( 6) =       0.000463800755
  error estimate for blocks of size 2^( 7) =       0.000469034601

      target function =                  N/A
              le_mean =     -16.905762989851
             les_mean =     286.135824900926
             stat err =       0.000459000141
             autocorr =       1.272986999814
              std dev =       0.575328425705
             le_variance =       0.331002797424


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690576298985e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905762989851       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905785663864       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905792045680       residual = 9.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905793539525       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905795982708       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905797782577       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905799931669       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905800947835       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905800555532       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905800038219       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905800033327       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905800144281       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.100857e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905762989851       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905771752665       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905774983320       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905775768270       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905776528321       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905777236855       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905777620802       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905777760754       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905777667804       residual = 9.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 6.892799e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905762989851       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905765526763       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905766593435       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905766875385       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905767076819       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905767340455       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905767415430       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905767406683       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905767393306       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.873561e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006743 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8861e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.078708e-01                 1 1 ON  0
uu_1  1.417525e-01                 1 1 ON  1
uu_2  4.087784e-02                 1 1 ON  2
uu_3  -2.054081e-02                1 1 ON  3
uu_4  -6.438714e-02                1 1 ON  4
uu_5  -9.734971e-02                1 1 ON  5
uu_6  -1.228916e-01                1 1 ON  6
uu_7  -1.346063e-01                1 1 ON  7
uu_8  -1.264276e-01                1 1 ON  8
uu_9  -9.643157e-02                1 1 ON  9
ud_0  4.402135e-01                 1 1 ON  10
ud_1  1.764008e-01                 1 1 ON  11
ud_2  5.947314e-02                 1 1 ON  12
ud_3  -8.944855e-03                1 1 ON  13
ud_4  -6.522919e-02                1 1 ON  14
ud_5  -1.055501e-01                1 1 ON  15
ud_6  -1.318082e-01                1 1 ON  16
ud_7  -1.473672e-01                1 1 ON  17
ud_8  -1.487638e-01                1 1 ON  18
ud_9  -1.396802e-01                1 1 ON  19
eO_0  -7.478075e-01                1 1 ON  20
eO_1  -4.316034e-01                1 1 ON  21
eO_2  -1.782773e-02                1 1 ON  22
eO_3  2.956265e-01                 1 1 ON  23
eO_4  5.137374e-01                 1 1 ON  24
eO_5  4.702827e-01                 1 1 ON  25
eO_6  2.409868e-01                 1 1 ON  26
eO_7  -5.346764e-02                1 1 ON  27
eO_8  -2.060870e-01                1 1 ON  28
eO_9  -6.560879e-02                1 1 ON  29
eH1_0 -2.317881e-01                1 1 ON  30
eH1_1 -1.340445e-01                1 1 ON  31
eH1_2 -8.939878e-02                1 1 ON  32
eH1_3 -3.615513e-02                1 1 ON  33
eH1_4 1.137760e-02                 1 1 ON  34
eH1_5 4.426386e-02                 1 1 ON  35
eH1_6 9.865911e-02                 1 1 ON  36
eH1_7 1.438871e-01                 1 1 ON  37
eH1_8 1.559732e-01                 1 1 ON  38
eH1_9 4.183956e-02                 1 1 ON  39
eH2_0 -2.294139e-01                1 1 ON  40
eH2_1 -1.318077e-01                1 1 ON  41
eH2_2 -8.686285e-02                1 1 ON  42
eH2_3 -3.374219e-02                1 1 ON  43
eH2_4 1.367172e-02                 1 1 ON  44
eH2_5 4.822564e-02                 1 1 ON  45
eH2_6 1.028339e-01                 1 1 ON  46
eH2_7 1.499029e-01                 1 1 ON  47
eH2_8 1.613973e-01                 1 1 ON  48
eH2_9 2.393793e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8547
    reference variance = 0.135451
====================================================
  Execution time = 2.0082e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4281e-01
  Total weights = 2.0000e+06
  Execution time = 1.8867e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342323033903
                                         uncertainty =       0.010251205454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342323033903
                                         uncertainty =       0.010251205454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413695564
  error estimate for blocks of size 2^( 2) =       0.000426609406
  error estimate for blocks of size 2^( 3) =       0.000439534121
  error estimate for blocks of size 2^( 4) =       0.000452242660
  error estimate for blocks of size 2^( 5) =       0.000463245242
  error estimate for blocks of size 2^( 6) =       0.000472413041
  error estimate for blocks of size 2^( 7) =       0.000478363500

      target function =                  N/A
              le_mean =     -16.905317021383
             les_mean =     286.132031460924
             stat err =       0.000466566110
             autocorr =       1.271934224462
              std dev =       0.585053876660
             le_variance =       0.342288038595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343800740109
                                         uncertainty =       0.010297582918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343800740109
                                         uncertainty =       0.010297582918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414586923
  error estimate for blocks of size 2^( 2) =       0.000427421599
  error estimate for blocks of size 2^( 3) =       0.000440267853
  error estimate for blocks of size 2^( 4) =       0.000452913751
  error estimate for blocks of size 2^( 5) =       0.000463878431
  error estimate for blocks of size 2^( 6) =       0.000473024314
  error estimate for blocks of size 2^( 7) =       0.000478957962

      target function =                  N/A
              le_mean =     -16.905327308756
             les_mean =     286.133855877321
             stat err =       0.000467193614
             autocorr =       1.269879751225
              std dev =       0.586314448938
             le_variance =       0.343764633034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343400842382
                                         uncertainty =       0.010280277409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343400842382
                                         uncertainty =       0.010280277409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414345875
  error estimate for blocks of size 2^( 2) =       0.000427196960
  error estimate for blocks of size 2^( 3) =       0.000440061714
  error estimate for blocks of size 2^( 4) =       0.000452723142
  error estimate for blocks of size 2^( 5) =       0.000463699465
  error estimate for blocks of size 2^( 6) =       0.000472849857
  error estimate for blocks of size 2^( 7) =       0.000478787987

      target function =                  N/A
              le_mean =     -16.905323461373
             les_mean =     286.133326170214
             stat err =       0.000467015112
             autocorr =       1.270386381944
              std dev =       0.585973555943
             le_variance =       0.343365008264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342467854678
                                         uncertainty =       0.010254873362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342467854678
                                         uncertainty =       0.010254873362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413782996
  error estimate for blocks of size 2^( 2) =       0.000426687141
  error estimate for blocks of size 2^( 3) =       0.000439602805
  error estimate for blocks of size 2^( 4) =       0.000452304366
  error estimate for blocks of size 2^( 5) =       0.000463303261
  error estimate for blocks of size 2^( 6) =       0.000472468471
  error estimate for blocks of size 2^( 7) =       0.000478417107

      target function =                  N/A
              le_mean =     -16.905316860920
             les_mean =     286.132170733227
             stat err =       0.000466623301
             autocorr =       1.271708468522
              std dev =       0.585177525499
             le_variance =       0.342432736349


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905317021383        initial
     2.5000e-01     2.5000e+00             2.1009e-03       -16.905327308756  <--
     1.0000e+00     1.0000e+01             6.8928e-04       -16.905323461373
     4.0000e+00     4.0000e+01             1.8736e-04       -16.905316860920

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9622e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.080533e-01 1 1  ON 0
 uu_1                 1.418105e-01 1 1  ON 1
 uu_2                 4.088314e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.443905e-02 1 1  ON 4
 uu_5                -9.744972e-02 1 1  ON 5
 uu_6                -1.229860e-01 1 1  ON 6
 uu_7                -1.348724e-01 1 1  ON 7
 uu_8                -1.267608e-01 1 1  ON 8
 uu_9                -9.655856e-02 1 1  ON 9
 ud_0                 4.414939e-01 1 1  ON 10
 ud_1                 1.771919e-01 1 1  ON 11
 ud_2                 5.932961e-02 1 1  ON 12
 ud_3                -9.550093e-03 1 1  ON 13
 ud_4                -6.542311e-02 1 1  ON 14
 ud_5                -1.056293e-01 1 1  ON 15
 ud_6                -1.320063e-01 1 1  ON 16
 ud_7                -1.477148e-01 1 1  ON 17
 ud_8                -1.491272e-01 1 1  ON 18
 ud_9                -1.396813e-01 1 1  ON 19
 eO_0                -7.492191e-01 1 1  ON 20
 eO_1                -4.319466e-01 1 1  ON 21
 eO_2                -1.735054e-02 1 1  ON 22
 eO_3                 2.961208e-01 1 1  ON 23
 eO_4                 5.143436e-01 1 1  ON 24
 eO_5                 4.707077e-01 1 1  ON 25
 eO_6                 2.415329e-01 1 1  ON 26
 eO_7                -5.327315e-02 1 1  ON 27
 eO_8                -2.065831e-01 1 1  ON 28
 eO_9                -6.604336e-02 1 1  ON 29
eH1_0                -2.326804e-01 1 1  ON 30
eH1_1                -1.347251e-01 1 1  ON 31
eH1_2                -8.948065e-02 1 1  ON 32
eH1_3                -3.620155e-02 1 1  ON 33
eH1_4                 1.124321e-02 1 1  ON 34
eH1_5                 4.433427e-02 1 1  ON 35
eH1_6                 9.877180e-02 1 1  ON 36
eH1_7                 1.442945e-01 1 1  ON 37
eH1_8                 1.566306e-01 1 1  ON 38
eH1_9                 4.235411e-02 1 1  ON 39
eH2_0                -2.304311e-01 1 1  ON 40
eH2_1                -1.320605e-01 1 1  ON 41
eH2_2                -8.661215e-02 1 1  ON 42
eH2_3                -3.358576e-02 1 1  ON 43
eH2_4                 1.348966e-02 1 1  ON 44
eH2_5                 4.812453e-02 1 1  ON 45
eH2_6                 1.028288e-01 1 1  ON 46
eH2_7                 1.500086e-01 1 1  ON 47
eH2_8                 1.618073e-01 1 1  ON 48
eH2_9                 2.452383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8490e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8672
    reference variance = 0.179761
====================================================
  Execution time = 2.0567e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5541e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355496390519
                                         uncertainty =       0.015322410868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355496390519
                                         uncertainty =       0.015322410868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421548758
  error estimate for blocks of size 2^( 2) =       0.000433436761
  error estimate for blocks of size 2^( 3) =       0.000445984003
  error estimate for blocks of size 2^( 4) =       0.000458056504
  error estimate for blocks of size 2^( 5) =       0.000468358764
  error estimate for blocks of size 2^( 6) =       0.000476399997
  error estimate for blocks of size 2^( 7) =       0.000481022705

      target function =                  N/A
              le_mean =     -16.905600093316
             les_mean =     286.154721047357
             stat err =       0.000470959493
             autocorr =       1.248163512552
              std dev =       0.596159970078
             le_variance =       0.355406709924


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690560009332e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905600093316       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905606847143       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905612849367       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905613992689       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905617435728       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905612781174       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905614728690       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905618676650       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905620527217       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905620448166       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905620327509       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905619839553       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905619526966       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905620040873       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 4.664255e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905600093316       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905604132940       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905609139568       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905607301229       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905609776743       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905608725695       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905608922218       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905610218235       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905610137566       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905610046331       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905610054408       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.724387e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905600093316       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905601642544       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905604096279       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905603632911       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905603915039       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905604007056       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905603732858       residual = 8.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905603975409       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905604008585       residual = 4.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.382762e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.012002 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6199e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.079956e-01 1 1  ON 0
 uu_1                 1.418698e-01 1 1  ON 1
 uu_2                 4.096977e-02 1 1  ON 2
 uu_3                -2.061957e-02 1 1  ON 3
 uu_4                -6.449212e-02 1 1  ON 4
 uu_5                -9.760097e-02 1 1  ON 5
 uu_6                -1.233522e-01 1 1  ON 6
 uu_7                -1.348619e-01 1 1  ON 7
 uu_8                -1.267181e-01 1 1  ON 8
 uu_9                -9.683254e-02 1 1  ON 9
 ud_0                 4.426319e-01 1 1  ON 10
 ud_1                 1.780186e-01 1 1  ON 11
 ud_2                 5.924591e-02 1 1  ON 12
 ud_3                -1.012499e-02 1 1  ON 13
 ud_4                -6.568475e-02 1 1  ON 14
 ud_5                -1.059132e-01 1 1  ON 15
 ud_6                -1.322166e-01 1 1  ON 16
 ud_7                -1.478093e-01 1 1  ON 17
 ud_8                -1.493029e-01 1 1  ON 18
 ud_9                -1.398085e-01 1 1  ON 19
 eO_0                -7.509435e-01 1 1  ON 20
 eO_1                -4.327254e-01 1 1  ON 21
 eO_2                -1.709399e-02 1 1  ON 22
 eO_3                 2.969667e-01 1 1  ON 23
 eO_4                 5.151256e-01 1 1  ON 24
 eO_5                 4.715994e-01 1 1  ON 25
 eO_6                 2.422305e-01 1 1  ON 26
 eO_7                -5.287511e-02 1 1  ON 27
 eO_8                -2.072495e-01 1 1  ON 28
 eO_9                -6.664427e-02 1 1  ON 29
eH1_0                -2.342156e-01 1 1  ON 30
eH1_1                -1.350278e-01 1 1  ON 31
eH1_2                -8.960684e-02 1 1  ON 32
eH1_3                -3.624885e-02 1 1  ON 33
eH1_4                 1.109242e-02 1 1  ON 34
eH1_5                 4.432978e-02 1 1  ON 35
eH1_6                 9.921014e-02 1 1  ON 36
eH1_7                 1.448379e-01 1 1  ON 37
eH1_8                 1.571193e-01 1 1  ON 38
eH1_9                 4.301295e-02 1 1  ON 39
eH2_0                -2.315149e-01 1 1  ON 40
eH2_1                -1.323471e-01 1 1  ON 41
eH2_2                -8.654309e-02 1 1  ON 42
eH2_3                -3.356977e-02 1 1  ON 43
eH2_4                 1.348665e-02 1 1  ON 44
eH2_5                 4.790968e-02 1 1  ON 45
eH2_6                 1.026119e-01 1 1  ON 46
eH2_7                 1.499743e-01 1 1  ON 47
eH2_8                 1.623917e-01 1 1  ON 48
eH2_9                 2.560469e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9388
    reference variance = 0.261635
====================================================
  Execution time = 2.0220e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3488e-01
  Total weights = 2.0000e+06
  Execution time = 1.8952e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334204956884
                                         uncertainty =       0.002743305883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334204956884
                                         uncertainty =       0.002743305883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408755564
  error estimate for blocks of size 2^( 2) =       0.000421684206
  error estimate for blocks of size 2^( 3) =       0.000435276597
  error estimate for blocks of size 2^( 4) =       0.000448643868
  error estimate for blocks of size 2^( 5) =       0.000460746621
  error estimate for blocks of size 2^( 6) =       0.000471839271
  error estimate for blocks of size 2^( 7) =       0.000479564639

      target function =                  N/A
              le_mean =     -16.905773403250
             les_mean =     286.139336417010
             stat err =       0.000465198600
             autocorr =       1.295237599754
              std dev =       0.578067662176
             le_variance =       0.334162222053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335725385968
                                         uncertainty =       0.002759807001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335725385968
                                         uncertainty =       0.002759807001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409684207
  error estimate for blocks of size 2^( 2) =       0.000422562838
  error estimate for blocks of size 2^( 3) =       0.000436093112
  error estimate for blocks of size 2^( 4) =       0.000449385925
  error estimate for blocks of size 2^( 5) =       0.000461439457
  error estimate for blocks of size 2^( 6) =       0.000472524215
  error estimate for blocks of size 2^( 7) =       0.000480220614

      target function =                  N/A
              le_mean =     -16.905766877470
             les_mean =     286.140635846168
             stat err =       0.000465892553
             autocorr =       1.293222022499
              std dev =       0.579380961591
             le_variance =       0.335682298654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335680186286
                                         uncertainty =       0.002760503329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335680186286
                                         uncertainty =       0.002760503329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409656622
  error estimate for blocks of size 2^( 2) =       0.000422533505
  error estimate for blocks of size 2^( 3) =       0.000436067136
  error estimate for blocks of size 2^( 4) =       0.000449369904
  error estimate for blocks of size 2^( 5) =       0.000461433000
  error estimate for blocks of size 2^( 6) =       0.000472528337
  error estimate for blocks of size 2^( 7) =       0.000480218986

      target function =                  N/A
              le_mean =     -16.905766232933
             les_mean =     286.140568851242
             stat err =       0.000465887557
             autocorr =       1.293368449469
              std dev =       0.579341951250
             le_variance =       0.335637096478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334439605767
                                         uncertainty =       0.002746320491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334439605767
                                         uncertainty =       0.002746320491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408899005
  error estimate for blocks of size 2^( 2) =       0.000421817434
  error estimate for blocks of size 2^( 3) =       0.000435398229
  error estimate for blocks of size 2^( 4) =       0.000448754033
  error estimate for blocks of size 2^( 5) =       0.000460850122
  error estimate for blocks of size 2^( 6) =       0.000471943998
  error estimate for blocks of size 2^( 7) =       0.000479660887

      target function =                  N/A
              le_mean =     -16.905769745468
             les_mean =     286.139447312498
             stat err =       0.000465302260
             autocorr =       1.294905918766
              std dev =       0.578270518808
             le_variance =       0.334396792922


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905773403250        initial  <--
     6.2500e-02     6.2500e-01             4.6643e-03       -16.905766877470
     2.5000e-01     2.5000e+00             1.7244e-03       -16.905766232933
     1.0000e+00     1.0000e+01             5.3828e-04       -16.905769745468

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7678
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.080533e-01 1 1  ON 0
 uu_1                 1.418105e-01 1 1  ON 1
 uu_2                 4.088314e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.443905e-02 1 1  ON 4
 uu_5                -9.744972e-02 1 1  ON 5
 uu_6                -1.229860e-01 1 1  ON 6
 uu_7                -1.348724e-01 1 1  ON 7
 uu_8                -1.267608e-01 1 1  ON 8
 uu_9                -9.655856e-02 1 1  ON 9
 ud_0                 4.414939e-01 1 1  ON 10
 ud_1                 1.771919e-01 1 1  ON 11
 ud_2                 5.932961e-02 1 1  ON 12
 ud_3                -9.550093e-03 1 1  ON 13
 ud_4                -6.542311e-02 1 1  ON 14
 ud_5                -1.056293e-01 1 1  ON 15
 ud_6                -1.320063e-01 1 1  ON 16
 ud_7                -1.477148e-01 1 1  ON 17
 ud_8                -1.491272e-01 1 1  ON 18
 ud_9                -1.396813e-01 1 1  ON 19
 eO_0                -7.492191e-01 1 1  ON 20
 eO_1                -4.319466e-01 1 1  ON 21
 eO_2                -1.735054e-02 1 1  ON 22
 eO_3                 2.961208e-01 1 1  ON 23
 eO_4                 5.143436e-01 1 1  ON 24
 eO_5                 4.707077e-01 1 1  ON 25
 eO_6                 2.415329e-01 1 1  ON 26
 eO_7                -5.327315e-02 1 1  ON 27
 eO_8                -2.065831e-01 1 1  ON 28
 eO_9                -6.604336e-02 1 1  ON 29
eH1_0                -2.326804e-01 1 1  ON 30
eH1_1                -1.347251e-01 1 1  ON 31
eH1_2                -8.948065e-02 1 1  ON 32
eH1_3                -3.620155e-02 1 1  ON 33
eH1_4                 1.124321e-02 1 1  ON 34
eH1_5                 4.433427e-02 1 1  ON 35
eH1_6                 9.877180e-02 1 1  ON 36
eH1_7                 1.442945e-01 1 1  ON 37
eH1_8                 1.566306e-01 1 1  ON 38
eH1_9                 4.235411e-02 1 1  ON 39
eH2_0                -2.304311e-01 1 1  ON 40
eH2_1                -1.320605e-01 1 1  ON 41
eH2_2                -8.661215e-02 1 1  ON 42
eH2_3                -3.358576e-02 1 1  ON 43
eH2_4                 1.348966e-02 1 1  ON 44
eH2_5                 4.812453e-02 1 1  ON 45
eH2_6                 1.028288e-01 1 1  ON 46
eH2_7                 1.500086e-01 1 1  ON 47
eH2_8                 1.618073e-01 1 1  ON 48
eH2_9                 2.452383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5974e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8744
    reference variance = 0.323957
====================================================
  Execution time = 2.0570e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3455e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5719e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334570902433
                                         uncertainty =       0.003655598852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334570902433
                                         uncertainty =       0.003655598852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408993669
  error estimate for blocks of size 2^( 2) =       0.000421663663
  error estimate for blocks of size 2^( 3) =       0.000434474315
  error estimate for blocks of size 2^( 4) =       0.000447298555
  error estimate for blocks of size 2^( 5) =       0.000458650423
  error estimate for blocks of size 2^( 6) =       0.000466689236
  error estimate for blocks of size 2^( 7) =       0.000472823798

      target function =                  N/A
              le_mean =     -16.906107741560
             les_mean =     286.151030444748
             stat err =       0.000461365503
             autocorr =       1.272497875410
              std dev =       0.578404393814
             le_variance =       0.334551642784


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690610774156e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906107741560       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906107012626       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906107277489       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906109763891       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906109838006       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906110946155       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906110368431       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906110214244       residual = 8.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906110565676       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906110532000       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 6.910169e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906107741560       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906107517319       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906107532403       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906108117160       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906108353911       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906108474640       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906108526303       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906108421768       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906108489998       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.935922e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906107741560       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906107682072       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906107679821       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906107812267       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906107896481       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906107914971       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906107935412       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906107914472       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906107927441       residual = 2.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 4.996896e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015361 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6151e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.080204e-01 1 1  ON 0
 uu_1                 1.418018e-01 1 1  ON 1
 uu_2                 4.090367e-02 1 1  ON 2
 uu_3                -2.054587e-02 1 1  ON 3
 uu_4                -6.443178e-02 1 1  ON 4
 uu_5                -9.744940e-02 1 1  ON 5
 uu_6                -1.230075e-01 1 1  ON 6
 uu_7                -1.348943e-01 1 1  ON 7
 uu_8                -1.267968e-01 1 1  ON 8
 uu_9                -9.658087e-02 1 1  ON 9
 ud_0                 4.416731e-01 1 1  ON 10
 ud_1                 1.773089e-01 1 1  ON 11
 ud_2                 5.928989e-02 1 1  ON 12
 ud_3                -9.670079e-03 1 1  ON 13
 ud_4                -6.544977e-02 1 1  ON 14
 ud_5                -1.056937e-01 1 1  ON 15
 ud_6                -1.320516e-01 1 1  ON 16
 ud_7                -1.477203e-01 1 1  ON 17
 ud_8                -1.491323e-01 1 1  ON 18
 ud_9                -1.396641e-01 1 1  ON 19
 eO_0                -7.494127e-01 1 1  ON 20
 eO_1                -4.320004e-01 1 1  ON 21
 eO_2                -1.728643e-02 1 1  ON 22
 eO_3                 2.962331e-01 1 1  ON 23
 eO_4                 5.143936e-01 1 1  ON 24
 eO_5                 4.707829e-01 1 1  ON 25
 eO_6                 2.415669e-01 1 1  ON 26
 eO_7                -5.325875e-02 1 1  ON 27
 eO_8                -2.066325e-01 1 1  ON 28
 eO_9                -6.609140e-02 1 1  ON 29
eH1_0                -2.328246e-01 1 1  ON 30
eH1_1                -1.347845e-01 1 1  ON 31
eH1_2                -8.946680e-02 1 1  ON 32
eH1_3                -3.622741e-02 1 1  ON 33
eH1_4                 1.124605e-02 1 1  ON 34
eH1_5                 4.434555e-02 1 1  ON 35
eH1_6                 9.876114e-02 1 1  ON 36
eH1_7                 1.443433e-01 1 1  ON 37
eH1_8                 1.567121e-01 1 1  ON 38
eH1_9                 4.243102e-02 1 1  ON 39
eH2_0                -2.305707e-01 1 1  ON 40
eH2_1                -1.321019e-01 1 1  ON 41
eH2_2                -8.666098e-02 1 1  ON 42
eH2_3                -3.357248e-02 1 1  ON 43
eH2_4                 1.354547e-02 1 1  ON 44
eH2_5                 4.808666e-02 1 1  ON 45
eH2_6                 1.028576e-01 1 1  ON 46
eH2_7                 1.500243e-01 1 1  ON 47
eH2_8                 1.618529e-01 1 1  ON 48
eH2_9                 2.461614e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8735
    reference variance = 0.307393
====================================================
  Execution time = 2.0005e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3373e-01
  Total weights = 2.0000e+06
  Execution time = 1.8834e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333652860538
                                         uncertainty =       0.003648246061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333652860538
                                         uncertainty =       0.003648246061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408413997
  error estimate for blocks of size 2^( 2) =       0.000421922396
  error estimate for blocks of size 2^( 3) =       0.000435857960
  error estimate for blocks of size 2^( 4) =       0.000448934528
  error estimate for blocks of size 2^( 5) =       0.000459126273
  error estimate for blocks of size 2^( 6) =       0.000467042653
  error estimate for blocks of size 2^( 7) =       0.000472205284

      target function =                  N/A
              le_mean =     -16.905625888063
             les_mean =     286.133790486952
             stat err =       0.000461827184
             autocorr =       1.278667862972
              std dev =       0.577584614234
             le_variance =       0.333603986600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334051095500
                                         uncertainty =       0.003656363761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334051095500
                                         uncertainty =       0.003656363761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408657544
  error estimate for blocks of size 2^( 2) =       0.000422149970
  error estimate for blocks of size 2^( 3) =       0.000436068078
  error estimate for blocks of size 2^( 4) =       0.000449131600
  error estimate for blocks of size 2^( 5) =       0.000459311563
  error estimate for blocks of size 2^( 6) =       0.000467219395
  error estimate for blocks of size 2^( 7) =       0.000472369381

      target function =                  N/A
              le_mean =     -16.905625857186
             les_mean =     286.134187432420
             stat err =       0.000462007985
             autocorr =       1.278144402315
              std dev =       0.577929040855
             le_variance =       0.334001976264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333898017548
                                         uncertainty =       0.003653446666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333898017548
                                         uncertainty =       0.003653446666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408563949
  error estimate for blocks of size 2^( 2) =       0.000422062080
  error estimate for blocks of size 2^( 3) =       0.000435986401
  error estimate for blocks of size 2^( 4) =       0.000449054926
  error estimate for blocks of size 2^( 5) =       0.000459239503
  error estimate for blocks of size 2^( 6) =       0.000467150240
  error estimate for blocks of size 2^( 7) =       0.000472304429

      target function =                  N/A
              le_mean =     -16.905625650080
             les_mean =     286.134027455100
             stat err =       0.000461937274
             autocorr =       1.278338677809
              std dev =       0.577796678225
             le_variance =       0.333849001368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333684686964
                                         uncertainty =       0.003648941677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333684686964
                                         uncertainty =       0.003648941677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408433467
  error estimate for blocks of size 2^( 2) =       0.000421940483
  error estimate for blocks of size 2^( 3) =       0.000435874522
  error estimate for blocks of size 2^( 4) =       0.000448950026
  error estimate for blocks of size 2^( 5) =       0.000459140815
  error estimate for blocks of size 2^( 6) =       0.000467056417
  error estimate for blocks of size 2^( 7) =       0.000472217901

      target function =                  N/A
              le_mean =     -16.905625811092
             les_mean =     286.133819692246
             stat err =       0.000461841290
             autocorr =       1.278624059788
              std dev =       0.577612148771
             le_variance =       0.333635794408


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905625888063        initial  <--
     6.2500e-01     6.2500e+00             6.9102e-04       -16.905625857186
     2.5000e+00     2.5000e+01             1.9359e-04       -16.905625650080
     1.0000e+01     1.0000e+02             4.9969e-05       -16.905625811092

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5076
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.080533e-01 1 1  ON 0
 uu_1                 1.418105e-01 1 1  ON 1
 uu_2                 4.088314e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.443905e-02 1 1  ON 4
 uu_5                -9.744972e-02 1 1  ON 5
 uu_6                -1.229860e-01 1 1  ON 6
 uu_7                -1.348724e-01 1 1  ON 7
 uu_8                -1.267608e-01 1 1  ON 8
 uu_9                -9.655856e-02 1 1  ON 9
 ud_0                 4.414939e-01 1 1  ON 10
 ud_1                 1.771919e-01 1 1  ON 11
 ud_2                 5.932961e-02 1 1  ON 12
 ud_3                -9.550093e-03 1 1  ON 13
 ud_4                -6.542311e-02 1 1  ON 14
 ud_5                -1.056293e-01 1 1  ON 15
 ud_6                -1.320063e-01 1 1  ON 16
 ud_7                -1.477148e-01 1 1  ON 17
 ud_8                -1.491272e-01 1 1  ON 18
 ud_9                -1.396813e-01 1 1  ON 19
 eO_0                -7.492191e-01 1 1  ON 20
 eO_1                -4.319466e-01 1 1  ON 21
 eO_2                -1.735054e-02 1 1  ON 22
 eO_3                 2.961208e-01 1 1  ON 23
 eO_4                 5.143436e-01 1 1  ON 24
 eO_5                 4.707077e-01 1 1  ON 25
 eO_6                 2.415329e-01 1 1  ON 26
 eO_7                -5.327315e-02 1 1  ON 27
 eO_8                -2.065831e-01 1 1  ON 28
 eO_9                -6.604336e-02 1 1  ON 29
eH1_0                -2.326804e-01 1 1  ON 30
eH1_1                -1.347251e-01 1 1  ON 31
eH1_2                -8.948065e-02 1 1  ON 32
eH1_3                -3.620155e-02 1 1  ON 33
eH1_4                 1.124321e-02 1 1  ON 34
eH1_5                 4.433427e-02 1 1  ON 35
eH1_6                 9.877180e-02 1 1  ON 36
eH1_7                 1.442945e-01 1 1  ON 37
eH1_8                 1.566306e-01 1 1  ON 38
eH1_9                 4.235411e-02 1 1  ON 39
eH2_0                -2.304311e-01 1 1  ON 40
eH2_1                -1.320605e-01 1 1  ON 41
eH2_2                -8.661215e-02 1 1  ON 42
eH2_3                -3.358576e-02 1 1  ON 43
eH2_4                 1.348966e-02 1 1  ON 44
eH2_5                 4.812453e-02 1 1  ON 45
eH2_6                 1.028288e-01 1 1  ON 46
eH2_7                 1.500086e-01 1 1  ON 47
eH2_8                 1.618073e-01 1 1  ON 48
eH2_9                 2.452383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5666e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6890e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9149
    reference variance = 0.181209
====================================================
  Execution time = 2.0840e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3424e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6201e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334187237116
                                         uncertainty =       0.003505194007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334187237116
                                         uncertainty =       0.003505194007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408803982
  error estimate for blocks of size 2^( 2) =       0.000421809745
  error estimate for blocks of size 2^( 3) =       0.000435295381
  error estimate for blocks of size 2^( 4) =       0.000448462666
  error estimate for blocks of size 2^( 5) =       0.000459363203
  error estimate for blocks of size 2^( 6) =       0.000467475249
  error estimate for blocks of size 2^( 7) =       0.000471706866

      target function =                  N/A
              le_mean =     -16.905595882033
             les_mean =     286.133413351279
             stat err =       0.000461751996
             autocorr =       1.275813894407
              std dev =       0.578136136046
             le_variance =       0.334241391802


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690559588203e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905595882033       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905595972744       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905596130659       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905596135026       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905596176582       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905596209128       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905596258023       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905596262883       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905596279879       residual = 1.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 7.102932e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905595882033       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905595905257       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905595946346       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905595945900       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905595954704       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905595963399       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905595976583       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905595977134       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905595981117       residual = 1.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.814742e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905595882033       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905595887874       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905595898252       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905595898052       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905595900135       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905595902338       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905595905696       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905595905801       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905595906774       residual = 9.48e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 4.560926e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.018535 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6477e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.080569e-01 1 1  ON 0
 uu_1                 1.418085e-01 1 1  ON 1
 uu_2                 4.088717e-02 1 1  ON 2
 uu_3                -2.057509e-02 1 1  ON 3
 uu_4                -6.444294e-02 1 1  ON 4
 uu_5                -9.745337e-02 1 1  ON 5
 uu_6                -1.229947e-01 1 1  ON 6
 uu_7                -1.348776e-01 1 1  ON 7
 uu_8                -1.267577e-01 1 1  ON 8
 uu_9                -9.655593e-02 1 1  ON 9
 ud_0                 4.415121e-01 1 1  ON 10
 ud_1                 1.772019e-01 1 1  ON 11
 ud_2                 5.932220e-02 1 1  ON 12
 ud_3                -9.561148e-03 1 1  ON 13
 ud_4                -6.542436e-02 1 1  ON 14
 ud_5                -1.056359e-01 1 1  ON 15
 ud_6                -1.320084e-01 1 1  ON 16
 ud_7                -1.477200e-01 1 1  ON 17
 ud_8                -1.491253e-01 1 1  ON 18
 ud_9                -1.396797e-01 1 1  ON 19
 eO_0                -7.492367e-01 1 1  ON 20
 eO_1                -4.319529e-01 1 1  ON 21
 eO_2                -1.734524e-02 1 1  ON 22
 eO_3                 2.961288e-01 1 1  ON 23
 eO_4                 5.143515e-01 1 1  ON 24
 eO_5                 4.707125e-01 1 1  ON 25
 eO_6                 2.415370e-01 1 1  ON 26
 eO_7                -5.327116e-02 1 1  ON 27
 eO_8                -2.065867e-01 1 1  ON 28
 eO_9                -6.604741e-02 1 1  ON 29
eH1_0                -2.326924e-01 1 1  ON 30
eH1_1                -1.347348e-01 1 1  ON 31
eH1_2                -8.948484e-02 1 1  ON 32
eH1_3                -3.620219e-02 1 1  ON 33
eH1_4                 1.124420e-02 1 1  ON 34
eH1_5                 4.433171e-02 1 1  ON 35
eH1_6                 9.877548e-02 1 1  ON 36
eH1_7                 1.443014e-01 1 1  ON 37
eH1_8                 1.566390e-01 1 1  ON 38
eH1_9                 4.236205e-02 1 1  ON 39
eH2_0                -2.304425e-01 1 1  ON 40
eH2_1                -1.320656e-01 1 1  ON 41
eH2_2                -8.661385e-02 1 1  ON 42
eH2_3                -3.358546e-02 1 1  ON 43
eH2_4                 1.349575e-02 1 1  ON 44
eH2_5                 4.812013e-02 1 1  ON 45
eH2_6                 1.028248e-01 1 1  ON 46
eH2_7                 1.500115e-01 1 1  ON 47
eH2_8                 1.618154e-01 1 1  ON 48
eH2_9                 2.453302e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9023
    reference variance = 0.240003
====================================================
  Execution time = 2.0288e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4652e-01
  Total weights = 2.0000e+06
  Execution time = 1.8887e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346634962360
                                         uncertainty =       0.010730684861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346634962360
                                         uncertainty =       0.010730684861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416236391
  error estimate for blocks of size 2^( 2) =       0.000428765029
  error estimate for blocks of size 2^( 3) =       0.000442024247
  error estimate for blocks of size 2^( 4) =       0.000453386399
  error estimate for blocks of size 2^( 5) =       0.000462677802
  error estimate for blocks of size 2^( 6) =       0.000469775040
  error estimate for blocks of size 2^( 7) =       0.000477047938

      target function =                  N/A
              le_mean =     -16.906272438016
             les_mean =     286.168553041459
             stat err =       0.000465721795
             autocorr =       1.251909775641
              std dev =       0.588647149236
             le_variance =       0.346505466303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346700878621
                                         uncertainty =       0.010733134780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346700878621
                                         uncertainty =       0.010733134780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416275955
  error estimate for blocks of size 2^( 2) =       0.000428801819
  error estimate for blocks of size 2^( 3) =       0.000442058541
  error estimate for blocks of size 2^( 4) =       0.000453418699
  error estimate for blocks of size 2^( 5) =       0.000462708664
  error estimate for blocks of size 2^( 6) =       0.000469804765
  error estimate for blocks of size 2^( 7) =       0.000477076882

      target function =                  N/A
              le_mean =     -16.906272763324
             les_mean =     286.168629915953
             stat err =       0.000465752252
             autocorr =       1.251835537597
              std dev =       0.588703101179
             le_variance =       0.346571341337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346668681436
                                         uncertainty =       0.010731926267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346668681436
                                         uncertainty =       0.010731926267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416256630
  error estimate for blocks of size 2^( 2) =       0.000428783835
  error estimate for blocks of size 2^( 3) =       0.000442041770
  error estimate for blocks of size 2^( 4) =       0.000453402904
  error estimate for blocks of size 2^( 5) =       0.000462693573
  error estimate for blocks of size 2^( 6) =       0.000469790226
  error estimate for blocks of size 2^( 7) =       0.000477062741

      target function =                  N/A
              le_mean =     -16.906272604923
             les_mean =     286.168592382807
             stat err =       0.000465737361
             autocorr =       1.251871717846
              std dev =       0.588675771640
             le_variance =       0.346539164116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346639198426
                                         uncertainty =       0.010730840470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346639198426
                                         uncertainty =       0.010730840470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416238934
  error estimate for blocks of size 2^( 2) =       0.000428767391
  error estimate for blocks of size 2^( 3) =       0.000442026447
  error estimate for blocks of size 2^( 4) =       0.000453388471
  error estimate for blocks of size 2^( 5) =       0.000462679782
  error estimate for blocks of size 2^( 6) =       0.000469776947
  error estimate for blocks of size 2^( 7) =       0.000477049797

      target function =                  N/A
              le_mean =     -16.906272458638
             les_mean =     286.168557972122
             stat err =       0.000465723749
             autocorr =       1.251904987410
              std dev =       0.588650745086
             le_variance =       0.346509699690


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906272438016        initial
     6.2500e+00     6.2500e+01             7.1029e-05       -16.906272763324  <--
     2.5000e+01     2.5000e+02             1.8147e-05       -16.906272604923
     1.0000e+02     1.0000e+03             4.5609e-06       -16.906272458638

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.9847e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.080677e-01 1 1  ON 0
 uu_1                 1.418034e-01 1 1  ON 1
 uu_2                 4.089822e-02 1 1  ON 2
 uu_3                -2.057703e-02 1 1  ON 3
 uu_4                -6.445452e-02 1 1  ON 4
 uu_5                -9.746433e-02 1 1  ON 5
 uu_6                -1.230201e-01 1 1  ON 6
 uu_7                -1.348930e-01 1 1  ON 7
 uu_8                -1.267482e-01 1 1  ON 8
 uu_9                -9.654807e-02 1 1  ON 9
 ud_0                 4.415650e-01 1 1  ON 10
 ud_1                 1.772307e-01 1 1  ON 11
 ud_2                 5.930180e-02 1 1  ON 12
 ud_3                -9.593254e-03 1 1  ON 13
 ud_4                -6.542893e-02 1 1  ON 14
 ud_5                -1.056550e-01 1 1  ON 15
 ud_6                -1.320146e-01 1 1  ON 16
 ud_7                -1.477353e-01 1 1  ON 17
 ud_8                -1.491199e-01 1 1  ON 18
 ud_9                -1.396746e-01 1 1  ON 19
 eO_0                -7.492887e-01 1 1  ON 20
 eO_1                -4.319714e-01 1 1  ON 21
 eO_2                -1.733025e-02 1 1  ON 22
 eO_3                 2.961521e-01 1 1  ON 23
 eO_4                 5.143757e-01 1 1  ON 24
 eO_5                 4.707271e-01 1 1  ON 25
 eO_6                 2.415491e-01 1 1  ON 26
 eO_7                -5.326521e-02 1 1  ON 27
 eO_8                -2.065973e-01 1 1  ON 28
 eO_9                -6.605954e-02 1 1  ON 29
eH1_0                -2.327285e-01 1 1  ON 30
eH1_1                -1.347634e-01 1 1  ON 31
eH1_2                -8.949738e-02 1 1  ON 32
eH1_3                -3.620437e-02 1 1  ON 33
eH1_4                 1.124697e-02 1 1  ON 34
eH1_5                 4.432413e-02 1 1  ON 35
eH1_6                 9.878655e-02 1 1  ON 36
eH1_7                 1.443222e-01 1 1  ON 37
eH1_8                 1.566641e-01 1 1  ON 38
eH1_9                 4.238580e-02 1 1  ON 39
eH2_0                -2.304764e-01 1 1  ON 40
eH2_1                -1.320810e-01 1 1  ON 41
eH2_2                -8.661889e-02 1 1  ON 42
eH2_3                -3.358465e-02 1 1  ON 43
eH2_4                 1.351354e-02 1 1  ON 44
eH2_5                 4.810719e-02 1 1  ON 45
eH2_6                 1.028129e-01 1 1  ON 46
eH2_7                 1.500199e-01 1 1  ON 47
eH2_8                 1.618397e-01 1 1  ON 48
eH2_9                 2.456052e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6330e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9065
    reference variance = 0.490945
====================================================
  Execution time = 2.0559e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3431e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6311e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334345406470
                                         uncertainty =       0.003405348896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334345406470
                                         uncertainty =       0.003405348896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408848928
  error estimate for blocks of size 2^( 2) =       0.000421309083
  error estimate for blocks of size 2^( 3) =       0.000434560577
  error estimate for blocks of size 2^( 4) =       0.000446589084
  error estimate for blocks of size 2^( 5) =       0.000458259723
  error estimate for blocks of size 2^( 6) =       0.000467700637
  error estimate for blocks of size 2^( 7) =       0.000474889668

      target function =                  N/A
              le_mean =     -16.905748495610
             les_mean =     286.138646920838
             stat err =       0.000461859778
             autocorr =       1.276128945062
              std dev =       0.578199698357
             le_variance =       0.334314891180


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574849561e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905748495610       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905749243702       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905750161527       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905750904697       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905750639262       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905750837017       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905750824747       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905750985537       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905750976343       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 3.010804e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905748495610       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905748701233       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905748942421       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905749147515       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905749081126       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905749127319       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905749125961       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905749164772       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905749159642       residual = 1.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 7.932586e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905748495610       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905748548326       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905748609455       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905748662127       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905748645685       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905748656794       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905748656714       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905748665844       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905748665064       residual = 1.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 2.011926e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.021726 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6198e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.080660e-01 1 1  ON 0
 uu_1                 1.418247e-01 1 1  ON 1
 uu_2                 4.091006e-02 1 1  ON 2
 uu_3                -2.056074e-02 1 1  ON 3
 uu_4                -6.445630e-02 1 1  ON 4
 uu_5                -9.747042e-02 1 1  ON 5
 uu_6                -1.230670e-01 1 1  ON 6
 uu_7                -1.349148e-01 1 1  ON 7
 uu_8                -1.267607e-01 1 1  ON 8
 uu_9                -9.654683e-02 1 1  ON 9
 ud_0                 4.416345e-01 1 1  ON 10
 ud_1                 1.772735e-01 1 1  ON 11
 ud_2                 5.928271e-02 1 1  ON 12
 ud_3                -9.643767e-03 1 1  ON 13
 ud_4                -6.543441e-02 1 1  ON 14
 ud_5                -1.056655e-01 1 1  ON 15
 ud_6                -1.320353e-01 1 1  ON 16
 ud_7                -1.477432e-01 1 1  ON 17
 ud_8                -1.491218e-01 1 1  ON 18
 ud_9                -1.396770e-01 1 1  ON 19
 eO_0                -7.493681e-01 1 1  ON 20
 eO_1                -4.319841e-01 1 1  ON 21
 eO_2                -1.731330e-02 1 1  ON 22
 eO_3                 2.961915e-01 1 1  ON 23
 eO_4                 5.144252e-01 1 1  ON 24
 eO_5                 4.707394e-01 1 1  ON 25
 eO_6                 2.415655e-01 1 1  ON 26
 eO_7                -5.326382e-02 1 1  ON 27
 eO_8                -2.066223e-01 1 1  ON 28
 eO_9                -6.607689e-02 1 1  ON 29
eH1_0                -2.327912e-01 1 1  ON 30
eH1_1                -1.347856e-01 1 1  ON 31
eH1_2                -8.950262e-02 1 1  ON 32
eH1_3                -3.620535e-02 1 1  ON 33
eH1_4                 1.125079e-02 1 1  ON 34
eH1_5                 4.434120e-02 1 1  ON 35
eH1_6                 9.879172e-02 1 1  ON 36
eH1_7                 1.443329e-01 1 1  ON 37
eH1_8                 1.566870e-01 1 1  ON 38
eH1_9                 4.241741e-02 1 1  ON 39
eH2_0                -2.305314e-01 1 1  ON 40
eH2_1                -1.321184e-01 1 1  ON 41
eH2_2                -8.663086e-02 1 1  ON 42
eH2_3                -3.358648e-02 1 1  ON 43
eH2_4                 1.353842e-02 1 1  ON 44
eH2_5                 4.811790e-02 1 1  ON 45
eH2_6                 1.028119e-01 1 1  ON 46
eH2_7                 1.500243e-01 1 1  ON 47
eH2_8                 1.618653e-01 1 1  ON 48
eH2_9                 2.460031e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8744
    reference variance = 0.217826
====================================================
  Execution time = 1.9952e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3558e-01
  Total weights = 2.0000e+06
  Execution time = 1.8887e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335488224141
                                         uncertainty =       0.004777462046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335488224141
                                         uncertainty =       0.004777462046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409591597
  error estimate for blocks of size 2^( 2) =       0.000422332896
  error estimate for blocks of size 2^( 3) =       0.000435713216
  error estimate for blocks of size 2^( 4) =       0.000447080741
  error estimate for blocks of size 2^( 5) =       0.000458463212
  error estimate for blocks of size 2^( 6) =       0.000466374585
  error estimate for blocks of size 2^( 7) =       0.000471399885

      target function =                  N/A
              le_mean =     -16.905947431405
             les_mean =     286.146588938628
             stat err =       0.000460829606
             autocorr =       1.265839569672
              std dev =       0.579249991764
             le_variance =       0.335530552959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335682466180
                                         uncertainty =       0.004776964674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335682466180
                                         uncertainty =       0.004776964674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409710218
  error estimate for blocks of size 2^( 2) =       0.000422441100
  error estimate for blocks of size 2^( 3) =       0.000435810707
  error estimate for blocks of size 2^( 4) =       0.000447168599
  error estimate for blocks of size 2^( 5) =       0.000458546983
  error estimate for blocks of size 2^( 6) =       0.000466451355
  error estimate for blocks of size 2^( 7) =       0.000471476808

      target function =                  N/A
              le_mean =     -16.905947112625
             les_mean =     286.146772532474
             stat err =       0.000460910936
             autocorr =       1.265553284567
              std dev =       0.579417746927
             le_variance =       0.335724925454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335593842419
                                         uncertainty =       0.004777242486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335593842419
                                         uncertainty =       0.004777242486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409656102
  error estimate for blocks of size 2^( 2) =       0.000422391612
  error estimate for blocks of size 2^( 3) =       0.000435766016
  error estimate for blocks of size 2^( 4) =       0.000447128252
  error estimate for blocks of size 2^( 5) =       0.000458508509
  error estimate for blocks of size 2^( 6) =       0.000466415854
  error estimate for blocks of size 2^( 7) =       0.000471441271

      target function =                  N/A
              le_mean =     -16.905947186369
             les_mean =     286.146686344277
             stat err =       0.000460873472
             autocorr =       1.265681885094
              std dev =       0.579341215348
             le_variance =       0.335636243801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335501669790
                                         uncertainty =       0.004777437257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335501669790
                                         uncertainty =       0.004777437257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409599810
  error estimate for blocks of size 2^( 2) =       0.000422340361
  error estimate for blocks of size 2^( 3) =       0.000435719919
  error estimate for blocks of size 2^( 4) =       0.000447086765
  error estimate for blocks of size 2^( 5) =       0.000458468953
  error estimate for blocks of size 2^( 6) =       0.000466379801
  error estimate for blocks of size 2^( 7) =       0.000471405119

      target function =                  N/A
              le_mean =     -16.905947390572
             les_mean =     286.146601012989
             stat err =       0.000460835160
             autocorr =       1.265819322197
              std dev =       0.579261605806
             le_variance =       0.335544007961


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905947431405        initial  <--
     1.5625e+00     1.5625e+01             3.0108e-04       -16.905947112625
     6.2500e+00     6.2500e+01             7.9326e-05       -16.905947186369
     2.5000e+01     2.5000e+02             2.0119e-05       -16.905947390572

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.9849
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.080677e-01 1 1  ON 0
 uu_1                 1.418034e-01 1 1  ON 1
 uu_2                 4.089822e-02 1 1  ON 2
 uu_3                -2.057703e-02 1 1  ON 3
 uu_4                -6.445452e-02 1 1  ON 4
 uu_5                -9.746433e-02 1 1  ON 5
 uu_6                -1.230201e-01 1 1  ON 6
 uu_7                -1.348930e-01 1 1  ON 7
 uu_8                -1.267482e-01 1 1  ON 8
 uu_9                -9.654807e-02 1 1  ON 9
 ud_0                 4.415650e-01 1 1  ON 10
 ud_1                 1.772307e-01 1 1  ON 11
 ud_2                 5.930180e-02 1 1  ON 12
 ud_3                -9.593254e-03 1 1  ON 13
 ud_4                -6.542893e-02 1 1  ON 14
 ud_5                -1.056550e-01 1 1  ON 15
 ud_6                -1.320146e-01 1 1  ON 16
 ud_7                -1.477353e-01 1 1  ON 17
 ud_8                -1.491199e-01 1 1  ON 18
 ud_9                -1.396746e-01 1 1  ON 19
 eO_0                -7.492887e-01 1 1  ON 20
 eO_1                -4.319714e-01 1 1  ON 21
 eO_2                -1.733025e-02 1 1  ON 22
 eO_3                 2.961521e-01 1 1  ON 23
 eO_4                 5.143757e-01 1 1  ON 24
 eO_5                 4.707271e-01 1 1  ON 25
 eO_6                 2.415491e-01 1 1  ON 26
 eO_7                -5.326521e-02 1 1  ON 27
 eO_8                -2.065973e-01 1 1  ON 28
 eO_9                -6.605954e-02 1 1  ON 29
eH1_0                -2.327285e-01 1 1  ON 30
eH1_1                -1.347634e-01 1 1  ON 31
eH1_2                -8.949738e-02 1 1  ON 32
eH1_3                -3.620437e-02 1 1  ON 33
eH1_4                 1.124697e-02 1 1  ON 34
eH1_5                 4.432413e-02 1 1  ON 35
eH1_6                 9.878655e-02 1 1  ON 36
eH1_7                 1.443222e-01 1 1  ON 37
eH1_8                 1.566641e-01 1 1  ON 38
eH1_9                 4.238580e-02 1 1  ON 39
eH2_0                -2.304764e-01 1 1  ON 40
eH2_1                -1.320810e-01 1 1  ON 41
eH2_2                -8.661889e-02 1 1  ON 42
eH2_3                -3.358465e-02 1 1  ON 43
eH2_4                 1.351354e-02 1 1  ON 44
eH2_5                 4.810719e-02 1 1  ON 45
eH2_6                 1.028129e-01 1 1  ON 46
eH2_7                 1.500199e-01 1 1  ON 47
eH2_8                 1.618397e-01 1 1  ON 48
eH2_9                 2.456052e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9189e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9308
    reference variance = 0.230263
====================================================
  Execution time = 2.0742e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3214e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6232e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332253739761
                                         uncertainty =       0.003130588381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332253739761
                                         uncertainty =       0.003130588381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407517987
  error estimate for blocks of size 2^( 2) =       0.000420641880
  error estimate for blocks of size 2^( 3) =       0.000434251316
  error estimate for blocks of size 2^( 4) =       0.000447182752
  error estimate for blocks of size 2^( 5) =       0.000458945187
  error estimate for blocks of size 2^( 6) =       0.000466745046
  error estimate for blocks of size 2^( 7) =       0.000474091663

      target function =                  N/A
              le_mean =     -16.906045363922
             les_mean =     286.146511501105
             stat err =       0.000461741162
             autocorr =       1.283818463599
              std dev =       0.576317464759
             le_variance =       0.332141820186


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690604536392e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906045363922       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906045409580       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906045454015       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906045519397       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906045552510       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906045534215       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906045569803       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906045579748       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906045572548       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 3.387929e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906045363922       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906045375448       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906045386427       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906045402751       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906045411287       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906045406558       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906045415581       residual = 5.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906045418051       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906045416357       residual = 1.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 8.550221e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906045363922       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906045366811       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906045369547       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906045373627       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906045375777       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906045374584       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906045376849       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906045377465       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906045377048       residual = 1.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 2.142580e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.024876 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6372e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.080678e-01 1 1  ON 0
 uu_1                 1.418050e-01 1 1  ON 1
 uu_2                 4.089902e-02 1 1  ON 2
 uu_3                -2.057511e-02 1 1  ON 3
 uu_4                -6.445432e-02 1 1  ON 4
 uu_5                -9.746451e-02 1 1  ON 5
 uu_6                -1.230233e-01 1 1  ON 6
 uu_7                -1.348951e-01 1 1  ON 7
 uu_8                -1.267494e-01 1 1  ON 8
 uu_9                -9.654917e-02 1 1  ON 9
 ud_0                 4.415735e-01 1 1  ON 10
 ud_1                 1.772353e-01 1 1  ON 11
 ud_2                 5.929812e-02 1 1  ON 12
 ud_3                -9.597493e-03 1 1  ON 13
 ud_4                -6.543180e-02 1 1  ON 14
 ud_5                -1.056554e-01 1 1  ON 15
 ud_6                -1.320168e-01 1 1  ON 16
 ud_7                -1.477345e-01 1 1  ON 17
 ud_8                -1.491185e-01 1 1  ON 18
 ud_9                -1.396748e-01 1 1  ON 19
 eO_0                -7.492969e-01 1 1  ON 20
 eO_1                -4.319727e-01 1 1  ON 21
 eO_2                -1.732845e-02 1 1  ON 22
 eO_3                 2.961560e-01 1 1  ON 23
 eO_4                 5.143791e-01 1 1  ON 24
 eO_5                 4.707289e-01 1 1  ON 25
 eO_6                 2.415507e-01 1 1  ON 26
 eO_7                -5.326340e-02 1 1  ON 27
 eO_8                -2.065996e-01 1 1  ON 28
 eO_9                -6.606186e-02 1 1  ON 29
eH1_0                -2.327333e-01 1 1  ON 30
eH1_1                -1.347654e-01 1 1  ON 31
eH1_2                -8.949605e-02 1 1  ON 32
eH1_3                -3.620439e-02 1 1  ON 33
eH1_4                 1.124769e-02 1 1  ON 34
eH1_5                 4.432438e-02 1 1  ON 35
eH1_6                 9.878540e-02 1 1  ON 36
eH1_7                 1.443230e-01 1 1  ON 37
eH1_8                 1.566670e-01 1 1  ON 38
eH1_9                 4.238831e-02 1 1  ON 39
eH2_0                -2.304822e-01 1 1  ON 40
eH2_1                -1.320831e-01 1 1  ON 41
eH2_2                -8.662061e-02 1 1  ON 42
eH2_3                -3.358232e-02 1 1  ON 43
eH2_4                 1.351310e-02 1 1  ON 44
eH2_5                 4.810568e-02 1 1  ON 45
eH2_6                 1.028132e-01 1 1  ON 46
eH2_7                 1.500208e-01 1 1  ON 47
eH2_8                 1.618431e-01 1 1  ON 48
eH2_9                 2.456480e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9102
    reference variance = 0.296646
====================================================
  Execution time = 2.2189e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2687e-01
  Total weights = 2.0000e+06
  Execution time = 1.8866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326874181476
                                         uncertainty =       0.002146764850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326874181476
                                         uncertainty =       0.002146764850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404269265
  error estimate for blocks of size 2^( 2) =       0.000417441972
  error estimate for blocks of size 2^( 3) =       0.000431416336
  error estimate for blocks of size 2^( 4) =       0.000444369096
  error estimate for blocks of size 2^( 5) =       0.000454209820
  error estimate for blocks of size 2^( 6) =       0.000464785343
  error estimate for blocks of size 2^( 7) =       0.000471864643

      target function =                  N/A
              le_mean =     -16.905799345850
             les_mean =     286.132918636667
             stat err =       0.000458807225
             autocorr =       1.288009441734
              std dev =       0.571723078037
             le_variance =       0.326867277961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326904235285
                                         uncertainty =       0.002146974000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326904235285
                                         uncertainty =       0.002146974000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404287852
  error estimate for blocks of size 2^( 2) =       0.000417459110
  error estimate for blocks of size 2^( 3) =       0.000431432068
  error estimate for blocks of size 2^( 4) =       0.000444383893
  error estimate for blocks of size 2^( 5) =       0.000454223578
  error estimate for blocks of size 2^( 6) =       0.000464798644
  error estimate for blocks of size 2^( 7) =       0.000471878218

      target function =                  N/A
              le_mean =     -16.905799327890
             les_mean =     286.132948086721
             stat err =       0.000458821083
             autocorr =       1.287968812036
              std dev =       0.571749364054
             le_variance =       0.326897335297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326889399750
                                         uncertainty =       0.002146870608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326889399750
                                         uncertainty =       0.002146870608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404278677
  error estimate for blocks of size 2^( 2) =       0.000417450649
  error estimate for blocks of size 2^( 3) =       0.000431424300
  error estimate for blocks of size 2^( 4) =       0.000444376588
  error estimate for blocks of size 2^( 5) =       0.000454216784
  error estimate for blocks of size 2^( 6) =       0.000464792074
  error estimate for blocks of size 2^( 7) =       0.000471871515

      target function =                  N/A
              le_mean =     -16.905799335061
             les_mean =     286.132933491887
             stat err =       0.000458814240
             autocorr =       1.287988853274
              std dev =       0.571736388551
             le_variance =       0.326882497993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326876089352
                                         uncertainty =       0.002146778106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326876089352
                                         uncertainty =       0.002146778106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404270445
  error estimate for blocks of size 2^( 2) =       0.000417443060
  error estimate for blocks of size 2^( 3) =       0.000431417334
  error estimate for blocks of size 2^( 4) =       0.000444370035
  error estimate for blocks of size 2^( 5) =       0.000454210693
  error estimate for blocks of size 2^( 6) =       0.000464786186
  error estimate for blocks of size 2^( 7) =       0.000471865504

      target function =                  N/A
              le_mean =     -16.905799344361
             les_mean =     286.132920494402
             stat err =       0.000458808105
             autocorr =       1.288006859175
              std dev =       0.571724746758
             le_variance =       0.326869186056


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905799345850        initial  <--
     1.5625e+01     1.5625e+02             3.3879e-05       -16.905799327890
     6.2500e+01     6.2500e+02             8.5502e-06       -16.905799335061
     2.5000e+02     2.5000e+03             2.1426e-06       -16.905799344361

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.7019
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.080677e-01 1 1  ON 0
 uu_1                 1.418034e-01 1 1  ON 1
 uu_2                 4.089822e-02 1 1  ON 2
 uu_3                -2.057703e-02 1 1  ON 3
 uu_4                -6.445452e-02 1 1  ON 4
 uu_5                -9.746433e-02 1 1  ON 5
 uu_6                -1.230201e-01 1 1  ON 6
 uu_7                -1.348930e-01 1 1  ON 7
 uu_8                -1.267482e-01 1 1  ON 8
 uu_9                -9.654807e-02 1 1  ON 9
 ud_0                 4.415650e-01 1 1  ON 10
 ud_1                 1.772307e-01 1 1  ON 11
 ud_2                 5.930180e-02 1 1  ON 12
 ud_3                -9.593254e-03 1 1  ON 13
 ud_4                -6.542893e-02 1 1  ON 14
 ud_5                -1.056550e-01 1 1  ON 15
 ud_6                -1.320146e-01 1 1  ON 16
 ud_7                -1.477353e-01 1 1  ON 17
 ud_8                -1.491199e-01 1 1  ON 18
 ud_9                -1.396746e-01 1 1  ON 19
 eO_0                -7.492887e-01 1 1  ON 20
 eO_1                -4.319714e-01 1 1  ON 21
 eO_2                -1.733025e-02 1 1  ON 22
 eO_3                 2.961521e-01 1 1  ON 23
 eO_4                 5.143757e-01 1 1  ON 24
 eO_5                 4.707271e-01 1 1  ON 25
 eO_6                 2.415491e-01 1 1  ON 26
 eO_7                -5.326521e-02 1 1  ON 27
 eO_8                -2.065973e-01 1 1  ON 28
 eO_9                -6.605954e-02 1 1  ON 29
eH1_0                -2.327285e-01 1 1  ON 30
eH1_1                -1.347634e-01 1 1  ON 31
eH1_2                -8.949738e-02 1 1  ON 32
eH1_3                -3.620437e-02 1 1  ON 33
eH1_4                 1.124697e-02 1 1  ON 34
eH1_5                 4.432413e-02 1 1  ON 35
eH1_6                 9.878655e-02 1 1  ON 36
eH1_7                 1.443222e-01 1 1  ON 37
eH1_8                 1.566641e-01 1 1  ON 38
eH1_9                 4.238580e-02 1 1  ON 39
eH2_0                -2.304764e-01 1 1  ON 40
eH2_1                -1.320810e-01 1 1  ON 41
eH2_2                -8.661889e-02 1 1  ON 42
eH2_3                -3.358465e-02 1 1  ON 43
eH2_4                 1.351354e-02 1 1  ON 44
eH2_5                 4.810719e-02 1 1  ON 45
eH2_6                 1.028129e-01 1 1  ON 46
eH2_7                 1.500199e-01 1 1  ON 47
eH2_8                 1.618397e-01 1 1  ON 48
eH2_9                 2.456052e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8081e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8431
    reference variance = 0.325707
====================================================
  Execution time = 2.0365e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4291e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6487e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342958330007
                                         uncertainty =       0.005985893732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342958330007
                                         uncertainty =       0.005985893732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414070568
  error estimate for blocks of size 2^( 2) =       0.000426251157
  error estimate for blocks of size 2^( 3) =       0.000439282612
  error estimate for blocks of size 2^( 4) =       0.000452102998
  error estimate for blocks of size 2^( 5) =       0.000463976652
  error estimate for blocks of size 2^( 6) =       0.000472743997
  error estimate for blocks of size 2^( 7) =       0.000476099541

      target function =                  N/A
              le_mean =     -16.906273261229
             les_mean =     286.164984283209
             stat err =       0.000466230797
             autocorr =       1.267807129942
              std dev =       0.585584213686
             le_variance =       0.342908871318


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690627326123e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906273261229       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906273253640       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906273251548       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906273259297       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906273258568       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906273258860       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906273258213       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906273258679       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 3.681634e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906273261229       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906273259330       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906273258804       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906273260740       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906273260558       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906273260631       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906273260471       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906273260586       residual = 6.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 9.210715e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906273261229       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906273260754       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906273260622       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906273261106       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906273261061       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906273261080       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906273261042       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906273261067       residual = 6.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 2.303094e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.027542 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6020e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.080676e-01 1 1  ON 0
 uu_1                 1.418035e-01 1 1  ON 1
 uu_2                 4.089835e-02 1 1  ON 2
 uu_3                -2.057691e-02 1 1  ON 3
 uu_4                -6.445447e-02 1 1  ON 4
 uu_5                -9.746449e-02 1 1  ON 5
 uu_6                -1.230204e-01 1 1  ON 6
 uu_7                -1.348930e-01 1 1  ON 7
 uu_8                -1.267484e-01 1 1  ON 8
 uu_9                -9.654815e-02 1 1  ON 9
 ud_0                 4.415654e-01 1 1  ON 10
 ud_1                 1.772313e-01 1 1  ON 11
 ud_2                 5.930166e-02 1 1  ON 12
 ud_3                -9.593571e-03 1 1  ON 13
 ud_4                -6.542915e-02 1 1  ON 14
 ud_5                -1.056549e-01 1 1  ON 15
 ud_6                -1.320147e-01 1 1  ON 16
 ud_7                -1.477355e-01 1 1  ON 17
 ud_8                -1.491199e-01 1 1  ON 18
 ud_9                -1.396747e-01 1 1  ON 19
 eO_0                -7.492897e-01 1 1  ON 20
 eO_1                -4.319716e-01 1 1  ON 21
 eO_2                -1.733019e-02 1 1  ON 22
 eO_3                 2.961526e-01 1 1  ON 23
 eO_4                 5.143761e-01 1 1  ON 24
 eO_5                 4.707274e-01 1 1  ON 25
 eO_6                 2.415492e-01 1 1  ON 26
 eO_7                -5.326514e-02 1 1  ON 27
 eO_8                -2.065976e-01 1 1  ON 28
 eO_9                -6.605974e-02 1 1  ON 29
eH1_0                -2.327291e-01 1 1  ON 30
eH1_1                -1.347637e-01 1 1  ON 31
eH1_2                -8.949743e-02 1 1  ON 32
eH1_3                -3.620443e-02 1 1  ON 33
eH1_4                 1.124708e-02 1 1  ON 34
eH1_5                 4.432417e-02 1 1  ON 35
eH1_6                 9.878660e-02 1 1  ON 36
eH1_7                 1.443224e-01 1 1  ON 37
eH1_8                 1.566644e-01 1 1  ON 38
eH1_9                 4.238615e-02 1 1  ON 39
eH2_0                -2.304769e-01 1 1  ON 40
eH2_1                -1.320812e-01 1 1  ON 41
eH2_2                -8.661899e-02 1 1  ON 42
eH2_3                -3.358454e-02 1 1  ON 43
eH2_4                 1.351354e-02 1 1  ON 44
eH2_5                 4.810718e-02 1 1  ON 45
eH2_6                 1.028129e-01 1 1  ON 46
eH2_7                 1.500199e-01 1 1  ON 47
eH2_8                 1.618400e-01 1 1  ON 48
eH2_9                 2.456088e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9038
    reference variance = 0.181273
====================================================
  Execution time = 2.0162e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3630e-01
  Total weights = 2.0000e+06
  Execution time = 1.8891e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336284634709
                                         uncertainty =       0.005163455488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336284634709
                                         uncertainty =       0.005163455488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410058471
  error estimate for blocks of size 2^( 2) =       0.000423440374
  error estimate for blocks of size 2^( 3) =       0.000437482486
  error estimate for blocks of size 2^( 4) =       0.000451783699
  error estimate for blocks of size 2^( 5) =       0.000464046567
  error estimate for blocks of size 2^( 6) =       0.000472935321
  error estimate for blocks of size 2^( 7) =       0.000479197512

      target function =                  N/A
              le_mean =     -16.904307933635
             les_mean =     286.091922445914
             stat err =       0.000466990775
             autocorr =       1.296955356142
              std dev =       0.579910250748
             le_variance =       0.336295898923

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336285729506
                                         uncertainty =       0.005163450339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336285729506
                                         uncertainty =       0.005163450339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410059137
  error estimate for blocks of size 2^( 2) =       0.000423440970
  error estimate for blocks of size 2^( 3) =       0.000437483024
  error estimate for blocks of size 2^( 4) =       0.000451784192
  error estimate for blocks of size 2^( 5) =       0.000464047040
  error estimate for blocks of size 2^( 6) =       0.000472935759
  error estimate for blocks of size 2^( 7) =       0.000479197992

      target function =                  N/A
              le_mean =     -16.904307933374
             les_mean =     286.091923529702
             stat err =       0.000466991246
             autocorr =       1.296953758448
              std dev =       0.579911192776
             le_variance =       0.336296991506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336285181818
                                         uncertainty =       0.005163452897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336285181818
                                         uncertainty =       0.005163452897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410058804
  error estimate for blocks of size 2^( 2) =       0.000423440672
  error estimate for blocks of size 2^( 3) =       0.000437482755
  error estimate for blocks of size 2^( 4) =       0.000451783945
  error estimate for blocks of size 2^( 5) =       0.000464046804
  error estimate for blocks of size 2^( 6) =       0.000472935539
  error estimate for blocks of size 2^( 7) =       0.000479197752

      target function =                  N/A
              le_mean =     -16.904307933505
             les_mean =     286.091922987528
             stat err =       0.000466991010
             autocorr =       1.296954557178
              std dev =       0.579910721511
             le_variance =       0.336296444923

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336284703085
                                         uncertainty =       0.005163455163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336284703085
                                         uncertainty =       0.005163455163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410058512
  error estimate for blocks of size 2^( 2) =       0.000423440411
  error estimate for blocks of size 2^( 3) =       0.000437482520
  error estimate for blocks of size 2^( 4) =       0.000451783730
  error estimate for blocks of size 2^( 5) =       0.000464046597
  error estimate for blocks of size 2^( 6) =       0.000472935348
  error estimate for blocks of size 2^( 7) =       0.000479197542

      target function =                  N/A
              le_mean =     -16.904307933618
             les_mean =     286.091922513588
             stat err =       0.000466990804
             autocorr =       1.296955256270
              std dev =       0.579910309583
             le_variance =       0.336295967161


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904307933635        initial  <--
     1.5625e+02     1.5625e+03             3.6816e-06       -16.904307933374
     6.2500e+02     6.2500e+03             9.2107e-07       -16.904307933505
     2.5000e+03     2.5000e+04             2.3031e-07       -16.904307933618

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6612
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.080677e-01 1 1  ON 0
 uu_1                 1.418034e-01 1 1  ON 1
 uu_2                 4.089822e-02 1 1  ON 2
 uu_3                -2.057703e-02 1 1  ON 3
 uu_4                -6.445452e-02 1 1  ON 4
 uu_5                -9.746433e-02 1 1  ON 5
 uu_6                -1.230201e-01 1 1  ON 6
 uu_7                -1.348930e-01 1 1  ON 7
 uu_8                -1.267482e-01 1 1  ON 8
 uu_9                -9.654807e-02 1 1  ON 9
 ud_0                 4.415650e-01 1 1  ON 10
 ud_1                 1.772307e-01 1 1  ON 11
 ud_2                 5.930180e-02 1 1  ON 12
 ud_3                -9.593254e-03 1 1  ON 13
 ud_4                -6.542893e-02 1 1  ON 14
 ud_5                -1.056550e-01 1 1  ON 15
 ud_6                -1.320146e-01 1 1  ON 16
 ud_7                -1.477353e-01 1 1  ON 17
 ud_8                -1.491199e-01 1 1  ON 18
 ud_9                -1.396746e-01 1 1  ON 19
 eO_0                -7.492887e-01 1 1  ON 20
 eO_1                -4.319714e-01 1 1  ON 21
 eO_2                -1.733025e-02 1 1  ON 22
 eO_3                 2.961521e-01 1 1  ON 23
 eO_4                 5.143757e-01 1 1  ON 24
 eO_5                 4.707271e-01 1 1  ON 25
 eO_6                 2.415491e-01 1 1  ON 26
 eO_7                -5.326521e-02 1 1  ON 27
 eO_8                -2.065973e-01 1 1  ON 28
 eO_9                -6.605954e-02 1 1  ON 29
eH1_0                -2.327285e-01 1 1  ON 30
eH1_1                -1.347634e-01 1 1  ON 31
eH1_2                -8.949738e-02 1 1  ON 32
eH1_3                -3.620437e-02 1 1  ON 33
eH1_4                 1.124697e-02 1 1  ON 34
eH1_5                 4.432413e-02 1 1  ON 35
eH1_6                 9.878655e-02 1 1  ON 36
eH1_7                 1.443222e-01 1 1  ON 37
eH1_8                 1.566641e-01 1 1  ON 38
eH1_9                 4.238580e-02 1 1  ON 39
eH2_0                -2.304764e-01 1 1  ON 40
eH2_1                -1.320810e-01 1 1  ON 41
eH2_2                -8.661889e-02 1 1  ON 42
eH2_3                -3.358465e-02 1 1  ON 43
eH2_4                 1.351354e-02 1 1  ON 44
eH2_5                 4.810719e-02 1 1  ON 45
eH2_6                 1.028129e-01 1 1  ON 46
eH2_7                 1.500199e-01 1 1  ON 47
eH2_8                 1.618397e-01 1 1  ON 48
eH2_9                 2.456052e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5750e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8716
    reference variance = 0.311811
====================================================
  Execution time = 2.0390e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3378e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333836392227
                                         uncertainty =       0.003322457153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333836392227
                                         uncertainty =       0.003322457153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408523555
  error estimate for blocks of size 2^( 2) =       0.000421506769
  error estimate for blocks of size 2^( 3) =       0.000434298802
  error estimate for blocks of size 2^( 4) =       0.000446671102
  error estimate for blocks of size 2^( 5) =       0.000458166237
  error estimate for blocks of size 2^( 6) =       0.000466388788
  error estimate for blocks of size 2^( 7) =       0.000470831052

      target function =                  N/A
              le_mean =     -16.905725433937
             les_mean =     286.137335271106
             stat err =       0.000460514295
             autocorr =       1.270726322006
              std dev =       0.577739552335
             le_variance =       0.333782990332


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690572543394e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905725433937       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905725435057       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905725436784       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905725436986       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905725437431       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905725437057       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905725436747       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905725436793       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905725436835       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 3.717205e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905725433937       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905725434217       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905725434649       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905725434698       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905725434807       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905725434720       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905725434641       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905725434642       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905725434663       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 9.293873e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905725433937       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905725434007       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905725434115       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905725434128       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905725434159       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905725434131       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905725434118       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905725434105       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905725434166       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 2.323522e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.030650 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5963e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.080677e-01 1 1  ON 0
 uu_1                 1.418034e-01 1 1  ON 1
 uu_2                 4.089822e-02 1 1  ON 2
 uu_3                -2.057702e-02 1 1  ON 3
 uu_4                -6.445453e-02 1 1  ON 4
 uu_5                -9.746432e-02 1 1  ON 5
 uu_6                -1.230201e-01 1 1  ON 6
 uu_7                -1.348930e-01 1 1  ON 7
 uu_8                -1.267482e-01 1 1  ON 8
 uu_9                -9.654809e-02 1 1  ON 9
 ud_0                 4.415650e-01 1 1  ON 10
 ud_1                 1.772308e-01 1 1  ON 11
 ud_2                 5.930178e-02 1 1  ON 12
 ud_3                -9.593282e-03 1 1  ON 13
 ud_4                -6.542896e-02 1 1  ON 14
 ud_5                -1.056550e-01 1 1  ON 15
 ud_6                -1.320146e-01 1 1  ON 16
 ud_7                -1.477353e-01 1 1  ON 17
 ud_8                -1.491199e-01 1 1  ON 18
 ud_9                -1.396746e-01 1 1  ON 19
 eO_0                -7.492888e-01 1 1  ON 20
 eO_1                -4.319714e-01 1 1  ON 21
 eO_2                -1.733023e-02 1 1  ON 22
 eO_3                 2.961521e-01 1 1  ON 23
 eO_4                 5.143757e-01 1 1  ON 24
 eO_5                 4.707271e-01 1 1  ON 25
 eO_6                 2.415491e-01 1 1  ON 26
 eO_7                -5.326519e-02 1 1  ON 27
 eO_8                -2.065974e-01 1 1  ON 28
 eO_9                -6.605957e-02 1 1  ON 29
eH1_0                -2.327285e-01 1 1  ON 30
eH1_1                -1.347635e-01 1 1  ON 31
eH1_2                -8.949738e-02 1 1  ON 32
eH1_3                -3.620437e-02 1 1  ON 33
eH1_4                 1.124696e-02 1 1  ON 34
eH1_5                 4.432415e-02 1 1  ON 35
eH1_6                 9.878656e-02 1 1  ON 36
eH1_7                 1.443222e-01 1 1  ON 37
eH1_8                 1.566641e-01 1 1  ON 38
eH1_9                 4.238583e-02 1 1  ON 39
eH2_0                -2.304764e-01 1 1  ON 40
eH2_1                -1.320810e-01 1 1  ON 41
eH2_2                -8.661890e-02 1 1  ON 42
eH2_3                -3.358465e-02 1 1  ON 43
eH2_4                 1.351355e-02 1 1  ON 44
eH2_5                 4.810717e-02 1 1  ON 45
eH2_6                 1.028129e-01 1 1  ON 46
eH2_7                 1.500199e-01 1 1  ON 47
eH2_8                 1.618397e-01 1 1  ON 48
eH2_9                 2.456056e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8726
    reference variance = 0.155473
====================================================
  Execution time = 2.0266e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2826e-01
  Total weights = 2.0000e+06
  Execution time = 1.8945e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328256639905
                                         uncertainty =       0.003236914358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328256639905
                                         uncertainty =       0.003236914358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405131979
  error estimate for blocks of size 2^( 2) =       0.000418256171
  error estimate for blocks of size 2^( 3) =       0.000432543423
  error estimate for blocks of size 2^( 4) =       0.000445294893
  error estimate for blocks of size 2^( 5) =       0.000456477051
  error estimate for blocks of size 2^( 6) =       0.000465579232
  error estimate for blocks of size 2^( 7) =       0.000472394603

      target function =                  N/A
              le_mean =     -16.905303144893
             les_mean =     286.117538097233
             stat err =       0.000459936445
             autocorr =       1.288850656054
              std dev =       0.572943139110
             le_variance =       0.328263840653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328256940797
                                         uncertainty =       0.003236917708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328256940797
                                         uncertainty =       0.003236917708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405132165
  error estimate for blocks of size 2^( 2) =       0.000418256344
  error estimate for blocks of size 2^( 3) =       0.000432543584
  error estimate for blocks of size 2^( 4) =       0.000445295043
  error estimate for blocks of size 2^( 5) =       0.000456477193
  error estimate for blocks of size 2^( 6) =       0.000465579368
  error estimate for blocks of size 2^( 7) =       0.000472394734

      target function =                  N/A
              le_mean =     -16.905303145454
             les_mean =     286.117538417005
             stat err =       0.000459936584
             autocorr =       1.288850257544
              std dev =       0.572943401594
             le_variance =       0.328264141431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328256790369
                                         uncertainty =       0.003236916033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328256790369
                                         uncertainty =       0.003236916033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405132072
  error estimate for blocks of size 2^( 2) =       0.000418256258
  error estimate for blocks of size 2^( 3) =       0.000432543504
  error estimate for blocks of size 2^( 4) =       0.000445294968
  error estimate for blocks of size 2^( 5) =       0.000456477122
  error estimate for blocks of size 2^( 6) =       0.000465579300
  error estimate for blocks of size 2^( 7) =       0.000472394668

      target function =                  N/A
              le_mean =     -16.905303145173
             les_mean =     286.117538257134
             stat err =       0.000459936515
             autocorr =       1.288850456770
              std dev =       0.572943270368
             le_variance =       0.328263991060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328256658713
                                         uncertainty =       0.003236914567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328256658713
                                         uncertainty =       0.003236914567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405131991
  error estimate for blocks of size 2^( 2) =       0.000418256182
  error estimate for blocks of size 2^( 3) =       0.000432543433
  error estimate for blocks of size 2^( 4) =       0.000445294903
  error estimate for blocks of size 2^( 5) =       0.000456477059
  error estimate for blocks of size 2^( 6) =       0.000465579241
  error estimate for blocks of size 2^( 7) =       0.000472394611

      target function =                  N/A
              le_mean =     -16.905303144928
             les_mean =     286.117538117221
             stat err =       0.000459936453
             autocorr =       1.288850631142
              std dev =       0.572943155518
             le_variance =       0.328263859454


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905303144893        initial
     1.5625e+03     1.5625e+04             3.7172e-07       -16.905303145454  <--
     6.2500e+03     6.2500e+04             9.2939e-08       -16.905303145173
     2.5000e+04     2.5000e+05             2.3235e-08       -16.905303144928

*****************************************************************************
Applying the update for shift_i =   1.5625e+03     and shift_s =   1.5625e+04
*****************************************************************************

  Execution time = 2.9783e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.080677e-01 1 1  ON 0
 uu_1                 1.418033e-01 1 1  ON 1
 uu_2                 4.089822e-02 1 1  ON 2
 uu_3                -2.057700e-02 1 1  ON 3
 uu_4                -6.445457e-02 1 1  ON 4
 uu_5                -9.746430e-02 1 1  ON 5
 uu_6                -1.230202e-01 1 1  ON 6
 uu_7                -1.348930e-01 1 1  ON 7
 uu_8                -1.267483e-01 1 1  ON 8
 uu_9                -9.654813e-02 1 1  ON 9
 ud_0                 4.415653e-01 1 1  ON 10
 ud_1                 1.772309e-01 1 1  ON 11
 ud_2                 5.930172e-02 1 1  ON 12
 ud_3                -9.593367e-03 1 1  ON 13
 ud_4                -6.542903e-02 1 1  ON 14
 ud_5                -1.056551e-01 1 1  ON 15
 ud_6                -1.320147e-01 1 1  ON 16
 ud_7                -1.477353e-01 1 1  ON 17
 ud_8                -1.491199e-01 1 1  ON 18
 ud_9                -1.396747e-01 1 1  ON 19
 eO_0                -7.492891e-01 1 1  ON 20
 eO_1                -4.319715e-01 1 1  ON 21
 eO_2                -1.733018e-02 1 1  ON 22
 eO_3                 2.961523e-01 1 1  ON 23
 eO_4                 5.143758e-01 1 1  ON 24
 eO_5                 4.707271e-01 1 1  ON 25
 eO_6                 2.415492e-01 1 1  ON 26
 eO_7                -5.326512e-02 1 1  ON 27
 eO_8                -2.065974e-01 1 1  ON 28
 eO_9                -6.605965e-02 1 1  ON 29
eH1_0                -2.327286e-01 1 1  ON 30
eH1_1                -1.347636e-01 1 1  ON 31
eH1_2                -8.949735e-02 1 1  ON 32
eH1_3                -3.620438e-02 1 1  ON 33
eH1_4                 1.124692e-02 1 1  ON 34
eH1_5                 4.432422e-02 1 1  ON 35
eH1_6                 9.878661e-02 1 1  ON 36
eH1_7                 1.443223e-01 1 1  ON 37
eH1_8                 1.566642e-01 1 1  ON 38
eH1_9                 4.238589e-02 1 1  ON 39
eH2_0                -2.304765e-01 1 1  ON 40
eH2_1                -1.320811e-01 1 1  ON 41
eH2_2                -8.661892e-02 1 1  ON 42
eH2_3                -3.358464e-02 1 1  ON 43
eH2_4                 1.351356e-02 1 1  ON 44
eH2_5                 4.810712e-02 1 1  ON 45
eH2_6                 1.028129e-01 1 1  ON 46
eH2_7                 1.500200e-01 1 1  ON 47
eH2_8                 1.618398e-01 1 1  ON 48
eH2_9                 2.456066e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5754e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.947
    reference variance = 0.293824
====================================================
  Execution time = 2.0625e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4031e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5860e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340339561462
                                         uncertainty =       0.003494543614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340339561462
                                         uncertainty =       0.003494543614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412496501
  error estimate for blocks of size 2^( 2) =       0.000425142325
  error estimate for blocks of size 2^( 3) =       0.000438211116
  error estimate for blocks of size 2^( 4) =       0.000450247563
  error estimate for blocks of size 2^( 5) =       0.000460452820
  error estimate for blocks of size 2^( 6) =       0.000468549682
  error estimate for blocks of size 2^( 7) =       0.000474144214

      target function =                  N/A
              le_mean =     -16.906520226812
             les_mean =     286.170732735523
             stat err =       0.000463348570
             autocorr =       1.261755237984
              std dev =       0.583358145638
             le_variance =       0.340306726082


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690652022681e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906520226812       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906520229634       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906520234047       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906520235433       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906520235794       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906520235551       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906520235877       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906520235845       residual = 8.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.207209e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906520226812       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906520227518       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906520228621       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906520228968       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906520229058       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906520228997       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906520229078       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906520229070       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 3.018990e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906520226812       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906520226988       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906520227264       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906520227351       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906520227373       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906520227366       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906520227385       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906520227368       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 7.548078e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.033359 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6227e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.080677e-01 1 1  ON 0
 uu_1                 1.418033e-01 1 1  ON 1
 uu_2                 4.089830e-02 1 1  ON 2
 uu_3                -2.057697e-02 1 1  ON 3
 uu_4                -6.445457e-02 1 1  ON 4
 uu_5                -9.746427e-02 1 1  ON 5
 uu_6                -1.230202e-01 1 1  ON 6
 uu_7                -1.348930e-01 1 1  ON 7
 uu_8                -1.267483e-01 1 1  ON 8
 uu_9                -9.654819e-02 1 1  ON 9
 ud_0                 4.415656e-01 1 1  ON 10
 ud_1                 1.772310e-01 1 1  ON 11
 ud_2                 5.930165e-02 1 1  ON 12
 ud_3                -9.593508e-03 1 1  ON 13
 ud_4                -6.542905e-02 1 1  ON 14
 ud_5                -1.056552e-01 1 1  ON 15
 ud_6                -1.320148e-01 1 1  ON 16
 ud_7                -1.477353e-01 1 1  ON 17
 ud_8                -1.491199e-01 1 1  ON 18
 ud_9                -1.396747e-01 1 1  ON 19
 eO_0                -7.492893e-01 1 1  ON 20
 eO_1                -4.319715e-01 1 1  ON 21
 eO_2                -1.733016e-02 1 1  ON 22
 eO_3                 2.961524e-01 1 1  ON 23
 eO_4                 5.143759e-01 1 1  ON 24
 eO_5                 4.707272e-01 1 1  ON 25
 eO_6                 2.415492e-01 1 1  ON 26
 eO_7                -5.326505e-02 1 1  ON 27
 eO_8                -2.065975e-01 1 1  ON 28
 eO_9                -6.605973e-02 1 1  ON 29
eH1_0                -2.327289e-01 1 1  ON 30
eH1_1                -1.347637e-01 1 1  ON 31
eH1_2                -8.949739e-02 1 1  ON 32
eH1_3                -3.620436e-02 1 1  ON 33
eH1_4                 1.124696e-02 1 1  ON 34
eH1_5                 4.432426e-02 1 1  ON 35
eH1_6                 9.878661e-02 1 1  ON 36
eH1_7                 1.443223e-01 1 1  ON 37
eH1_8                 1.566643e-01 1 1  ON 38
eH1_9                 4.238600e-02 1 1  ON 39
eH2_0                -2.304767e-01 1 1  ON 40
eH2_1                -1.320811e-01 1 1  ON 41
eH2_2                -8.661895e-02 1 1  ON 42
eH2_3                -3.358466e-02 1 1  ON 43
eH2_4                 1.351363e-02 1 1  ON 44
eH2_5                 4.810705e-02 1 1  ON 45
eH2_6                 1.028129e-01 1 1  ON 46
eH2_7                 1.500201e-01 1 1  ON 47
eH2_8                 1.618399e-01 1 1  ON 48
eH2_9                 2.456073e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.833
    reference variance = 0.239631
====================================================
  Execution time = 2.0109e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3328e-01
  Total weights = 2.0000e+06
  Execution time = 1.8964e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333203688767
                                         uncertainty =       0.003038404107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333203688767
                                         uncertainty =       0.003038404107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408214435
  error estimate for blocks of size 2^( 2) =       0.000420571068
  error estimate for blocks of size 2^( 3) =       0.000434195481
  error estimate for blocks of size 2^( 4) =       0.000447250058
  error estimate for blocks of size 2^( 5) =       0.000457924322
  error estimate for blocks of size 2^( 6) =       0.000464438817
  error estimate for blocks of size 2^( 7) =       0.000468806872

      target function =                  N/A
              le_mean =     -16.905866869840
             les_mean =     286.141612504463
             stat err =       0.000459605017
             autocorr =       1.267630865554
              std dev =       0.577302390724
             le_variance =       0.333278050335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333204550712
                                         uncertainty =       0.003038411968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333204550712
                                         uncertainty =       0.003038411968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408214963
  error estimate for blocks of size 2^( 2) =       0.000420571561
  error estimate for blocks of size 2^( 3) =       0.000434195942
  error estimate for blocks of size 2^( 4) =       0.000447250490
  error estimate for blocks of size 2^( 5) =       0.000457924738
  error estimate for blocks of size 2^( 6) =       0.000464439217
  error estimate for blocks of size 2^( 7) =       0.000468807291

      target function =                  N/A
              le_mean =     -16.905866875509
             les_mean =     286.141613558278
             stat err =       0.000459605434
             autocorr =       1.267629885640
              std dev =       0.577303137423
             le_variance =       0.333278912479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333204119874
                                         uncertainty =       0.003038408038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333204119874
                                         uncertainty =       0.003038408038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408214699
  error estimate for blocks of size 2^( 2) =       0.000420571315
  error estimate for blocks of size 2^( 3) =       0.000434195712
  error estimate for blocks of size 2^( 4) =       0.000447250274
  error estimate for blocks of size 2^( 5) =       0.000457924530
  error estimate for blocks of size 2^( 6) =       0.000464439017
  error estimate for blocks of size 2^( 7) =       0.000468807082

      target function =                  N/A
              le_mean =     -16.905866872676
             les_mean =     286.141613031546
             stat err =       0.000459605226
             autocorr =       1.267630375422
              std dev =       0.577302764190
             le_variance =       0.333278481542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333203742659
                                         uncertainty =       0.003038404599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333203742659
                                         uncertainty =       0.003038404599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408214468
  error estimate for blocks of size 2^( 2) =       0.000420571099
  error estimate for blocks of size 2^( 3) =       0.000434195510
  error estimate for blocks of size 2^( 4) =       0.000447250085
  error estimate for blocks of size 2^( 5) =       0.000457924348
  error estimate for blocks of size 2^( 6) =       0.000464438842
  error estimate for blocks of size 2^( 7) =       0.000468806898

      target function =                  N/A
              le_mean =     -16.905866870195
             les_mean =     286.141612570351
             stat err =       0.000459605043
             autocorr =       1.267630804275
              std dev =       0.577302437410
             le_variance =       0.333278104240


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905866869840        initial
     3.9062e+02     3.9062e+03             1.2072e-06       -16.905866875509  <--
     1.5625e+03     1.5625e+04             3.0190e-07       -16.905866872676
     6.2500e+03     6.2500e+04             7.5481e-08       -16.905866870195

*****************************************************************************
Applying the update for shift_i =   3.9062e+02     and shift_s =   3.9062e+03
*****************************************************************************

  Execution time = 2.9655e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.080676e-01 1 1  ON 0
 uu_1                 1.418033e-01 1 1  ON 1
 uu_2                 4.089853e-02 1 1  ON 2
 uu_3                -2.057687e-02 1 1  ON 3
 uu_4                -6.445458e-02 1 1  ON 4
 uu_5                -9.746418e-02 1 1  ON 5
 uu_6                -1.230203e-01 1 1  ON 6
 uu_7                -1.348931e-01 1 1  ON 7
 uu_8                -1.267485e-01 1 1  ON 8
 uu_9                -9.654838e-02 1 1  ON 9
 ud_0                 4.415665e-01 1 1  ON 10
 ud_1                 1.772314e-01 1 1  ON 11
 ud_2                 5.930146e-02 1 1  ON 12
 ud_3                -9.593931e-03 1 1  ON 13
 ud_4                -6.542911e-02 1 1  ON 14
 ud_5                -1.056553e-01 1 1  ON 15
 ud_6                -1.320151e-01 1 1  ON 16
 ud_7                -1.477353e-01 1 1  ON 17
 ud_8                -1.491199e-01 1 1  ON 18
 ud_9                -1.396746e-01 1 1  ON 19
 eO_0                -7.492902e-01 1 1  ON 20
 eO_1                -4.319716e-01 1 1  ON 21
 eO_2                -1.733009e-02 1 1  ON 22
 eO_3                 2.961528e-01 1 1  ON 23
 eO_4                 5.143763e-01 1 1  ON 24
 eO_5                 4.707275e-01 1 1  ON 25
 eO_6                 2.415494e-01 1 1  ON 26
 eO_7                -5.326482e-02 1 1  ON 27
 eO_8                -2.065978e-01 1 1  ON 28
 eO_9                -6.605999e-02 1 1  ON 29
eH1_0                -2.327295e-01 1 1  ON 30
eH1_1                -1.347639e-01 1 1  ON 31
eH1_2                -8.949751e-02 1 1  ON 32
eH1_3                -3.620432e-02 1 1  ON 33
eH1_4                 1.124708e-02 1 1  ON 34
eH1_5                 4.432439e-02 1 1  ON 35
eH1_6                 9.878660e-02 1 1  ON 36
eH1_7                 1.443223e-01 1 1  ON 37
eH1_8                 1.566647e-01 1 1  ON 38
eH1_9                 4.238631e-02 1 1  ON 39
eH2_0                -2.304772e-01 1 1  ON 40
eH2_1                -1.320811e-01 1 1  ON 41
eH2_2                -8.661904e-02 1 1  ON 42
eH2_3                -3.358472e-02 1 1  ON 43
eH2_4                 1.351384e-02 1 1  ON 44
eH2_5                 4.810683e-02 1 1  ON 45
eH2_6                 1.028128e-01 1 1  ON 46
eH2_7                 1.500204e-01 1 1  ON 47
eH2_8                 1.618401e-01 1 1  ON 48
eH2_9                 2.456093e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5889e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8203
    reference variance = 0.307323
====================================================
  Execution time = 2.0838e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3690e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336983982889
                                         uncertainty =       0.005134336932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336983982889
                                         uncertainty =       0.005134336932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410425646
  error estimate for blocks of size 2^( 2) =       0.000423611976
  error estimate for blocks of size 2^( 3) =       0.000436587324
  error estimate for blocks of size 2^( 4) =       0.000449356124
  error estimate for blocks of size 2^( 5) =       0.000458850539
  error estimate for blocks of size 2^( 6) =       0.000466780929
  error estimate for blocks of size 2^( 7) =       0.000472144412

      target function =                  N/A
              le_mean =     -16.905604015480
             les_mean =     286.136345381915
             stat err =       0.000461783001
             autocorr =       1.265921867312
              std dev =       0.580429515223
             le_variance =       0.336898422142


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690560401548e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905604015480       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905604034542       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905604056748       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905604060542       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905604067105       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905604071507       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905604077982       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905604077475       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905604076732       residual = 2.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 5.633115e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905604015480       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905604020253       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905604025818       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905604026760       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905604028392       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905604029488       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905604031115       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905604030991       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905604030809       residual = 1.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.409884e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905604015480       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905604016674       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905604018066       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905604018301       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905604018710       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905604018983       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905604019387       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905604019360       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905604019313       residual = 1.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 3.525717e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.036447 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6506e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.080673e-01 1 1  ON 0
 uu_1                 1.418034e-01 1 1  ON 1
 uu_2                 4.089878e-02 1 1  ON 2
 uu_3                -2.057661e-02 1 1  ON 3
 uu_4                -6.445444e-02 1 1  ON 4
 uu_5                -9.746429e-02 1 1  ON 5
 uu_6                -1.230208e-01 1 1  ON 6
 uu_7                -1.348933e-01 1 1  ON 7
 uu_8                -1.267485e-01 1 1  ON 8
 uu_9                -9.654858e-02 1 1  ON 9
 ud_0                 4.415679e-01 1 1  ON 10
 ud_1                 1.772322e-01 1 1  ON 11
 ud_2                 5.930103e-02 1 1  ON 12
 ud_3                -9.594643e-03 1 1  ON 13
 ud_4                -6.542950e-02 1 1  ON 14
 ud_5                -1.056555e-01 1 1  ON 15
 ud_6                -1.320153e-01 1 1  ON 16
 ud_7                -1.477355e-01 1 1  ON 17
 ud_8                -1.491200e-01 1 1  ON 18
 ud_9                -1.396746e-01 1 1  ON 19
 eO_0                -7.492916e-01 1 1  ON 20
 eO_1                -4.319717e-01 1 1  ON 21
 eO_2                -1.732980e-02 1 1  ON 22
 eO_3                 2.961535e-01 1 1  ON 23
 eO_4                 5.143767e-01 1 1  ON 24
 eO_5                 4.707280e-01 1 1  ON 25
 eO_6                 2.415496e-01 1 1  ON 26
 eO_7                -5.326474e-02 1 1  ON 27
 eO_8                -2.065981e-01 1 1  ON 28
 eO_9                -6.606030e-02 1 1  ON 29
eH1_0                -2.327304e-01 1 1  ON 30
eH1_1                -1.347646e-01 1 1  ON 31
eH1_2                -8.949745e-02 1 1  ON 32
eH1_3                -3.620427e-02 1 1  ON 33
eH1_4                 1.124710e-02 1 1  ON 34
eH1_5                 4.432463e-02 1 1  ON 35
eH1_6                 9.878666e-02 1 1  ON 36
eH1_7                 1.443226e-01 1 1  ON 37
eH1_8                 1.566651e-01 1 1  ON 38
eH1_9                 4.238673e-02 1 1  ON 39
eH2_0                -2.304781e-01 1 1  ON 40
eH2_1                -1.320815e-01 1 1  ON 41
eH2_2                -8.661945e-02 1 1  ON 42
eH2_3                -3.358465e-02 1 1  ON 43
eH2_4                 1.351424e-02 1 1  ON 44
eH2_5                 4.810668e-02 1 1  ON 45
eH2_6                 1.028130e-01 1 1  ON 46
eH2_7                 1.500204e-01 1 1  ON 47
eH2_8                 1.618405e-01 1 1  ON 48
eH2_9                 2.456156e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.946
    reference variance = 0.2676
====================================================
  Execution time = 1.9934e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3230e-01
  Total weights = 2.0000e+06
  Execution time = 1.8881e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332360653385
                                         uncertainty =       0.002973987751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332360653385
                                         uncertainty =       0.002973987751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407613714
  error estimate for blocks of size 2^( 2) =       0.000420077406
  error estimate for blocks of size 2^( 3) =       0.000432961579
  error estimate for blocks of size 2^( 4) =       0.000444457847
  error estimate for blocks of size 2^( 5) =       0.000454993756
  error estimate for blocks of size 2^( 6) =       0.000463365700
  error estimate for blocks of size 2^( 7) =       0.000468449453

      target function =                  N/A
              le_mean =     -16.905370377950
             les_mean =     286.123845328900
             stat err =       0.000457816689
             autocorr =       1.261495385175
              std dev =       0.576452842289
             le_variance =       0.332297879383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332364886333
                                         uncertainty =       0.002974022290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332364886333
                                         uncertainty =       0.002974022290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407616310
  error estimate for blocks of size 2^( 2) =       0.000420079811
  error estimate for blocks of size 2^( 3) =       0.000432963758
  error estimate for blocks of size 2^( 4) =       0.000444459855
  error estimate for blocks of size 2^( 5) =       0.000454995634
  error estimate for blocks of size 2^( 6) =       0.000463367534
  error estimate for blocks of size 2^( 7) =       0.000468451317

      target function =                  N/A
              le_mean =     -16.905370411537
             les_mean =     286.123850698151
             stat err =       0.000457818585
             autocorr =       1.261489761231
              std dev =       0.576456514436
             le_variance =       0.332302113036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332362773472
                                         uncertainty =       0.002974005058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332362773472
                                         uncertainty =       0.002974005058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407615014
  error estimate for blocks of size 2^( 2) =       0.000420078611
  error estimate for blocks of size 2^( 3) =       0.000432962670
  error estimate for blocks of size 2^( 4) =       0.000444458852
  error estimate for blocks of size 2^( 5) =       0.000454994696
  error estimate for blocks of size 2^( 6) =       0.000463366618
  error estimate for blocks of size 2^( 7) =       0.000468450386

      target function =                  N/A
              le_mean =     -16.905370394791
             les_mean =     286.123848018752
             stat err =       0.000457817638
             autocorr =       1.261492567488
              std dev =       0.576454681499
             le_variance =       0.332299999822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332360918499
                                         uncertainty =       0.002973989916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332360918499
                                         uncertainty =       0.002973989916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407613876
  error estimate for blocks of size 2^( 2) =       0.000420077557
  error estimate for blocks of size 2^( 3) =       0.000432961715
  error estimate for blocks of size 2^( 4) =       0.000444457972
  error estimate for blocks of size 2^( 5) =       0.000454993874
  error estimate for blocks of size 2^( 6) =       0.000463365815
  error estimate for blocks of size 2^( 7) =       0.000468449570

      target function =                  N/A
              le_mean =     -16.905370380055
             les_mean =     286.123845665225
             stat err =       0.000457816808
             autocorr =       1.261495032776
              std dev =       0.576453072280
             le_variance =       0.332298144541


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905370377950        initial
     9.7656e+01     9.7656e+02             5.6331e-06       -16.905370411537  <--
     3.9062e+02     3.9062e+03             1.4099e-06       -16.905370394791
     1.5625e+03     1.5625e+04             3.5257e-07       -16.905370380055

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 2.9480e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.080666e-01 1 1  ON 0
 uu_1                 1.418036e-01 1 1  ON 1
 uu_2                 4.089951e-02 1 1  ON 2
 uu_3                -2.057584e-02 1 1  ON 3
 uu_4                -6.445403e-02 1 1  ON 4
 uu_5                -9.746463e-02 1 1  ON 5
 uu_6                -1.230222e-01 1 1  ON 6
 uu_7                -1.348938e-01 1 1  ON 7
 uu_8                -1.267487e-01 1 1  ON 8
 uu_9                -9.654917e-02 1 1  ON 9
 ud_0                 4.415721e-01 1 1  ON 10
 ud_1                 1.772344e-01 1 1  ON 11
 ud_2                 5.929977e-02 1 1  ON 12
 ud_3                -9.596776e-03 1 1  ON 13
 ud_4                -6.543065e-02 1 1  ON 14
 ud_5                -1.056561e-01 1 1  ON 15
 ud_6                -1.320157e-01 1 1  ON 16
 ud_7                -1.477362e-01 1 1  ON 17
 ud_8                -1.491201e-01 1 1  ON 18
 ud_9                -1.396746e-01 1 1  ON 19
 eO_0                -7.492958e-01 1 1  ON 20
 eO_1                -4.319720e-01 1 1  ON 21
 eO_2                -1.732893e-02 1 1  ON 22
 eO_3                 2.961557e-01 1 1  ON 23
 eO_4                 5.143781e-01 1 1  ON 24
 eO_5                 4.707295e-01 1 1  ON 25
 eO_6                 2.415501e-01 1 1  ON 26
 eO_7                -5.326451e-02 1 1  ON 27
 eO_8                -2.065991e-01 1 1  ON 28
 eO_9                -6.606125e-02 1 1  ON 29
eH1_0                -2.327331e-01 1 1  ON 30
eH1_1                -1.347664e-01 1 1  ON 31
eH1_2                -8.949727e-02 1 1  ON 32
eH1_3                -3.620414e-02 1 1  ON 33
eH1_4                 1.124718e-02 1 1  ON 34
eH1_5                 4.432534e-02 1 1  ON 35
eH1_6                 9.878684e-02 1 1  ON 36
eH1_7                 1.443235e-01 1 1  ON 37
eH1_8                 1.566664e-01 1 1  ON 38
eH1_9                 4.238799e-02 1 1  ON 39
eH2_0                -2.304808e-01 1 1  ON 40
eH2_1                -1.320827e-01 1 1  ON 41
eH2_2                -8.662065e-02 1 1  ON 42
eH2_3                -3.358445e-02 1 1  ON 43
eH2_4                 1.351543e-02 1 1  ON 44
eH2_5                 4.810621e-02 1 1  ON 45
eH2_6                 1.028137e-01 1 1  ON 46
eH2_7                 1.500207e-01 1 1  ON 47
eH2_8                 1.618416e-01 1 1  ON 48
eH2_9                 2.456345e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5993e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8833
    reference variance = 0.268004
====================================================
  Execution time = 2.2627e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4311e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6674e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343162180816
                                         uncertainty =       0.006618220064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343162180816
                                         uncertainty =       0.006618220064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414190303
  error estimate for blocks of size 2^( 2) =       0.000427024182
  error estimate for blocks of size 2^( 3) =       0.000439975550
  error estimate for blocks of size 2^( 4) =       0.000452993797
  error estimate for blocks of size 2^( 5) =       0.000465067559
  error estimate for blocks of size 2^( 6) =       0.000472233584
  error estimate for blocks of size 2^( 7) =       0.000478589657

      target function =                  N/A
              le_mean =     -16.905812211979
             les_mean =     286.149593589010
             stat err =       0.000467221149
             autocorr =       1.272462911982
              std dev =       0.585753543621
             le_variance =       0.343107213865


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690581221198e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905812211979       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905812268609       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905812279664       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905812321371       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905812360847       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905812374632       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905812386297       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905812392618       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905812387707       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 2.208292e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905812211979       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905812226237       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905812229010       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905812239481       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905812249413       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905812252901       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905812255732       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905812257318       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905812256134       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 5.545005e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905812211979       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905812215550       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905812216244       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905812218864       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905812221351       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905812222226       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905812222928       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905812223325       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905812223031       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.387750e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.039578 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8301e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.080657e-01 1 1  ON 0
 uu_1                 1.418041e-01 1 1  ON 1
 uu_2                 4.089964e-02 1 1  ON 2
 uu_3                -2.057548e-02 1 1  ON 3
 uu_4                -6.445420e-02 1 1  ON 4
 uu_5                -9.746518e-02 1 1  ON 5
 uu_6                -1.230230e-01 1 1  ON 6
 uu_7                -1.348944e-01 1 1  ON 7
 uu_8                -1.267487e-01 1 1  ON 8
 uu_9                -9.654935e-02 1 1  ON 9
 ud_0                 4.415776e-01 1 1  ON 10
 ud_1                 1.772382e-01 1 1  ON 11
 ud_2                 5.929746e-02 1 1  ON 12
 ud_3                -9.598805e-03 1 1  ON 13
 ud_4                -6.543104e-02 1 1  ON 14
 ud_5                -1.056578e-01 1 1  ON 15
 ud_6                -1.320177e-01 1 1  ON 16
 ud_7                -1.477371e-01 1 1  ON 17
 ud_8                -1.491199e-01 1 1  ON 18
 ud_9                -1.396745e-01 1 1  ON 19
 eO_0                -7.493013e-01 1 1  ON 20
 eO_1                -4.319734e-01 1 1  ON 21
 eO_2                -1.732775e-02 1 1  ON 22
 eO_3                 2.961582e-01 1 1  ON 23
 eO_4                 5.143804e-01 1 1  ON 24
 eO_5                 4.707312e-01 1 1  ON 25
 eO_6                 2.415520e-01 1 1  ON 26
 eO_7                -5.326409e-02 1 1  ON 27
 eO_8                -2.066007e-01 1 1  ON 28
 eO_9                -6.606255e-02 1 1  ON 29
eH1_0                -2.327376e-01 1 1  ON 30
eH1_1                -1.347681e-01 1 1  ON 31
eH1_2                -8.949770e-02 1 1  ON 32
eH1_3                -3.620412e-02 1 1  ON 33
eH1_4                 1.124673e-02 1 1  ON 34
eH1_5                 4.432620e-02 1 1  ON 35
eH1_6                 9.878736e-02 1 1  ON 36
eH1_7                 1.443251e-01 1 1  ON 37
eH1_8                 1.566687e-01 1 1  ON 38
eH1_9                 4.238977e-02 1 1  ON 39
eH2_0                -2.304827e-01 1 1  ON 40
eH2_1                -1.320846e-01 1 1  ON 41
eH2_2                -8.662185e-02 1 1  ON 42
eH2_3                -3.358439e-02 1 1  ON 43
eH2_4                 1.351619e-02 1 1  ON 44
eH2_5                 4.810652e-02 1 1  ON 45
eH2_6                 1.028129e-01 1 1  ON 46
eH2_7                 1.500210e-01 1 1  ON 47
eH2_8                 1.618438e-01 1 1  ON 48
eH2_9                 2.456577e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9932
    reference variance = 0.261927
====================================================
  Execution time = 2.0372e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3237e-01
  Total weights = 2.0000e+06
  Execution time = 1.8844e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332362989842
                                         uncertainty =       0.002848251398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332362989842
                                         uncertainty =       0.002848251398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407654731
  error estimate for blocks of size 2^( 2) =       0.000420785769
  error estimate for blocks of size 2^( 3) =       0.000433866601
  error estimate for blocks of size 2^( 4) =       0.000446557341
  error estimate for blocks of size 2^( 5) =       0.000459421874
  error estimate for blocks of size 2^( 6) =       0.000466797745
  error estimate for blocks of size 2^( 7) =       0.000475130963

      target function =                  N/A
              le_mean =     -16.906269364176
             les_mean =     286.154308407317
             stat err =       0.000461976981
             autocorr =       1.284268110485
              std dev =       0.576510849356
             le_variance =       0.332364759425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332382372073
                                         uncertainty =       0.002848496580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332382372073
                                         uncertainty =       0.002848496580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407666619
  error estimate for blocks of size 2^( 2) =       0.000420796880
  error estimate for blocks of size 2^( 3) =       0.000433876691
  error estimate for blocks of size 2^( 4) =       0.000446566689
  error estimate for blocks of size 2^( 5) =       0.000459430871
  error estimate for blocks of size 2^( 6) =       0.000466806549
  error estimate for blocks of size 2^( 7) =       0.000475139447

      target function =                  N/A
              le_mean =     -16.906269260702
             les_mean =     286.154324292974
             stat err =       0.000461985889
             autocorr =       1.284242739734
              std dev =       0.576527660911
             le_variance =       0.332384143795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332372750279
                                         uncertainty =       0.002848375065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332372750279
                                         uncertainty =       0.002848375065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407660717
  error estimate for blocks of size 2^( 2) =       0.000420791363
  error estimate for blocks of size 2^( 3) =       0.000433871680
  error estimate for blocks of size 2^( 4) =       0.000446562046
  error estimate for blocks of size 2^( 5) =       0.000459426403
  error estimate for blocks of size 2^( 6) =       0.000466802177
  error estimate for blocks of size 2^( 7) =       0.000475135233

      target function =                  N/A
              le_mean =     -16.906269311269
             les_mean =     286.154316379881
             stat err =       0.000461981465
             autocorr =       1.284255323229
              std dev =       0.576519315313
             le_variance =       0.332374520928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332364211851
                                         uncertainty =       0.002848266890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332364211851
                                         uncertainty =       0.002848266890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407655481
  error estimate for blocks of size 2^( 2) =       0.000420786470
  error estimate for blocks of size 2^( 3) =       0.000433867236
  error estimate for blocks of size 2^( 4) =       0.000446557930
  error estimate for blocks of size 2^( 5) =       0.000459422441
  error estimate for blocks of size 2^( 6) =       0.000466798300
  error estimate for blocks of size 2^( 7) =       0.000475131498

      target function =                  N/A
              le_mean =     -16.906269357492
             les_mean =     286.154309403453
             stat err =       0.000461977542
             autocorr =       1.284266508797
              std dev =       0.576511909303
             le_variance =       0.332365981568


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906269364176        initial  <--
     2.4414e+01     2.4414e+02             2.2083e-05       -16.906269260702
     9.7656e+01     9.7656e+02             5.5450e-06       -16.906269311269
     3.9062e+02     3.9062e+03             1.3877e-06       -16.906269357492

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.5422
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.080666e-01 1 1  ON 0
 uu_1                 1.418036e-01 1 1  ON 1
 uu_2                 4.089951e-02 1 1  ON 2
 uu_3                -2.057584e-02 1 1  ON 3
 uu_4                -6.445403e-02 1 1  ON 4
 uu_5                -9.746463e-02 1 1  ON 5
 uu_6                -1.230222e-01 1 1  ON 6
 uu_7                -1.348938e-01 1 1  ON 7
 uu_8                -1.267487e-01 1 1  ON 8
 uu_9                -9.654917e-02 1 1  ON 9
 ud_0                 4.415721e-01 1 1  ON 10
 ud_1                 1.772344e-01 1 1  ON 11
 ud_2                 5.929977e-02 1 1  ON 12
 ud_3                -9.596776e-03 1 1  ON 13
 ud_4                -6.543065e-02 1 1  ON 14
 ud_5                -1.056561e-01 1 1  ON 15
 ud_6                -1.320157e-01 1 1  ON 16
 ud_7                -1.477362e-01 1 1  ON 17
 ud_8                -1.491201e-01 1 1  ON 18
 ud_9                -1.396746e-01 1 1  ON 19
 eO_0                -7.492958e-01 1 1  ON 20
 eO_1                -4.319720e-01 1 1  ON 21
 eO_2                -1.732893e-02 1 1  ON 22
 eO_3                 2.961557e-01 1 1  ON 23
 eO_4                 5.143781e-01 1 1  ON 24
 eO_5                 4.707295e-01 1 1  ON 25
 eO_6                 2.415501e-01 1 1  ON 26
 eO_7                -5.326451e-02 1 1  ON 27
 eO_8                -2.065991e-01 1 1  ON 28
 eO_9                -6.606125e-02 1 1  ON 29
eH1_0                -2.327331e-01 1 1  ON 30
eH1_1                -1.347664e-01 1 1  ON 31
eH1_2                -8.949727e-02 1 1  ON 32
eH1_3                -3.620414e-02 1 1  ON 33
eH1_4                 1.124718e-02 1 1  ON 34
eH1_5                 4.432534e-02 1 1  ON 35
eH1_6                 9.878684e-02 1 1  ON 36
eH1_7                 1.443235e-01 1 1  ON 37
eH1_8                 1.566664e-01 1 1  ON 38
eH1_9                 4.238799e-02 1 1  ON 39
eH2_0                -2.304808e-01 1 1  ON 40
eH2_1                -1.320827e-01 1 1  ON 41
eH2_2                -8.662065e-02 1 1  ON 42
eH2_3                -3.358445e-02 1 1  ON 43
eH2_4                 1.351543e-02 1 1  ON 44
eH2_5                 4.810621e-02 1 1  ON 45
eH2_6                 1.028137e-01 1 1  ON 46
eH2_7                 1.500207e-01 1 1  ON 47
eH2_8                 1.618416e-01 1 1  ON 48
eH2_9                 2.456345e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.1851e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9872
    reference variance = 0.303592
====================================================
  Execution time = 2.0563e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3268e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5645e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332778714572
                                         uncertainty =       0.003056925008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332778714572
                                         uncertainty =       0.003056925008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407851063
  error estimate for blocks of size 2^( 2) =       0.000420959329
  error estimate for blocks of size 2^( 3) =       0.000434480135
  error estimate for blocks of size 2^( 4) =       0.000447520478
  error estimate for blocks of size 2^( 5) =       0.000459340105
  error estimate for blocks of size 2^( 6) =       0.000468168345
  error estimate for blocks of size 2^( 7) =       0.000473870050

      target function =                  N/A
              le_mean =     -16.904924473545
             les_mean =     286.109156268378
             stat err =       0.000462224744
             autocorr =       1.284408543103
              std dev =       0.576788504102
             le_variance =       0.332684978464


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690492447354e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904924473545       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904924478944       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904924481052       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904924480724       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904924479894       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904924480978       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904924483625       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904924482763       residual = 9.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.835614e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904924473545       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904924474895       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904924475423       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904924475341       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904924475132       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904924475404       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904924476065       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904924475849       residual = 9.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 4.590500e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904924473545       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904924473883       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904924474015       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904924473994       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904924473946       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904924474010       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904924474176       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904924474131       residual = 9.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 1.147717e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.042248 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6134e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.080667e-01 1 1  ON 0
 uu_1                 1.418036e-01 1 1  ON 1
 uu_2                 4.089950e-02 1 1  ON 2
 uu_3                -2.057581e-02 1 1  ON 3
 uu_4                -6.445407e-02 1 1  ON 4
 uu_5                -9.746464e-02 1 1  ON 5
 uu_6                -1.230223e-01 1 1  ON 6
 uu_7                -1.348939e-01 1 1  ON 7
 uu_8                -1.267487e-01 1 1  ON 8
 uu_9                -9.654920e-02 1 1  ON 9
 ud_0                 4.415725e-01 1 1  ON 10
 ud_1                 1.772348e-01 1 1  ON 11
 ud_2                 5.929965e-02 1 1  ON 12
 ud_3                -9.596979e-03 1 1  ON 13
 ud_4                -6.543076e-02 1 1  ON 14
 ud_5                -1.056563e-01 1 1  ON 15
 ud_6                -1.320158e-01 1 1  ON 16
 ud_7                -1.477362e-01 1 1  ON 17
 ud_8                -1.491201e-01 1 1  ON 18
 ud_9                -1.396747e-01 1 1  ON 19
 eO_0                -7.492963e-01 1 1  ON 20
 eO_1                -4.319721e-01 1 1  ON 21
 eO_2                -1.732882e-02 1 1  ON 22
 eO_3                 2.961559e-01 1 1  ON 23
 eO_4                 5.143782e-01 1 1  ON 24
 eO_5                 4.707297e-01 1 1  ON 25
 eO_6                 2.415501e-01 1 1  ON 26
 eO_7                -5.326444e-02 1 1  ON 27
 eO_8                -2.065992e-01 1 1  ON 28
 eO_9                -6.606138e-02 1 1  ON 29
eH1_0                -2.327335e-01 1 1  ON 30
eH1_1                -1.347665e-01 1 1  ON 31
eH1_2                -8.949725e-02 1 1  ON 32
eH1_3                -3.620418e-02 1 1  ON 33
eH1_4                 1.124718e-02 1 1  ON 34
eH1_5                 4.432531e-02 1 1  ON 35
eH1_6                 9.878691e-02 1 1  ON 36
eH1_7                 1.443236e-01 1 1  ON 37
eH1_8                 1.566666e-01 1 1  ON 38
eH1_9                 4.238816e-02 1 1  ON 39
eH2_0                -2.304811e-01 1 1  ON 40
eH2_1                -1.320829e-01 1 1  ON 41
eH2_2                -8.662063e-02 1 1  ON 42
eH2_3                -3.358449e-02 1 1  ON 43
eH2_4                 1.351556e-02 1 1  ON 44
eH2_5                 4.810611e-02 1 1  ON 45
eH2_6                 1.028137e-01 1 1  ON 46
eH2_7                 1.500208e-01 1 1  ON 47
eH2_8                 1.618418e-01 1 1  ON 48
eH2_9                 2.456364e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9189
    reference variance = 0.210948
====================================================
  Execution time = 2.0310e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3278e-01
  Total weights = 2.0000e+06
  Execution time = 1.8743e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332841093001
                                         uncertainty =       0.003328839817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332841093001
                                         uncertainty =       0.003328839817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407910889
  error estimate for blocks of size 2^( 2) =       0.000420822052
  error estimate for blocks of size 2^( 3) =       0.000434150457
  error estimate for blocks of size 2^( 4) =       0.000445746619
  error estimate for blocks of size 2^( 5) =       0.000455064573
  error estimate for blocks of size 2^( 6) =       0.000463633245
  error estimate for blocks of size 2^( 7) =       0.000467409294

      target function =                  N/A
              le_mean =     -16.906125517712
             les_mean =     286.149862440693
             stat err =       0.000457963433
             autocorr =       1.260465627506
              std dev =       0.576873111208
             le_variance =       0.332782586435

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332842409394
                                         uncertainty =       0.003328851262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332842409394
                                         uncertainty =       0.003328851262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407911696
  error estimate for blocks of size 2^( 2) =       0.000420822798
  error estimate for blocks of size 2^( 3) =       0.000434151140
  error estimate for blocks of size 2^( 4) =       0.000445747254
  error estimate for blocks of size 2^( 5) =       0.000455065165
  error estimate for blocks of size 2^( 6) =       0.000463633835
  error estimate for blocks of size 2^( 7) =       0.000467409879

      target function =                  N/A
              le_mean =     -16.906125524033
             les_mean =     286.149863970693
             stat err =       0.000457964033
             autocorr =       1.260463945056
              std dev =       0.576874252099
             le_variance =       0.332783902735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332841751380
                                         uncertainty =       0.003328845540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332841751380
                                         uncertainty =       0.003328845540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407911292
  error estimate for blocks of size 2^( 2) =       0.000420822425
  error estimate for blocks of size 2^( 3) =       0.000434150799
  error estimate for blocks of size 2^( 4) =       0.000445746936
  error estimate for blocks of size 2^( 5) =       0.000455064869
  error estimate for blocks of size 2^( 6) =       0.000463633540
  error estimate for blocks of size 2^( 7) =       0.000467409587

      target function =                  N/A
              le_mean =     -16.906125520877
             les_mean =     286.149863206014
             stat err =       0.000457963733
             autocorr =       1.260464785838
              std dev =       0.576873681812
             le_variance =       0.332783244768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332841175303
                                         uncertainty =       0.003328840532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332841175303
                                         uncertainty =       0.003328840532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407910939
  error estimate for blocks of size 2^( 2) =       0.000420822099
  error estimate for blocks of size 2^( 3) =       0.000434150499
  error estimate for blocks of size 2^( 4) =       0.000445746658
  error estimate for blocks of size 2^( 5) =       0.000455064610
  error estimate for blocks of size 2^( 6) =       0.000463633282
  error estimate for blocks of size 2^( 7) =       0.000467409331

      target function =                  N/A
              le_mean =     -16.906125518108
             les_mean =     286.149862536359
             stat err =       0.000457963470
             autocorr =       1.260465522283
              std dev =       0.576873182538
             le_variance =       0.332782668731


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906125517712        initial
     2.4414e+02     2.4414e+03             1.8356e-06       -16.906125524033  <--
     9.7656e+02     9.7656e+03             4.5905e-07       -16.906125520877
     3.9062e+03     3.9062e+04             1.1477e-07       -16.906125518108

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 2.9755e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.080667e-01 1 1  ON 0
 uu_1                 1.418035e-01 1 1  ON 1
 uu_2                 4.089945e-02 1 1  ON 2
 uu_3                -2.057571e-02 1 1  ON 3
 uu_4                -6.445421e-02 1 1  ON 4
 uu_5                -9.746464e-02 1 1  ON 5
 uu_6                -1.230226e-01 1 1  ON 6
 uu_7                -1.348941e-01 1 1  ON 7
 uu_8                -1.267487e-01 1 1  ON 8
 uu_9                -9.654931e-02 1 1  ON 9
 ud_0                 4.415739e-01 1 1  ON 10
 ud_1                 1.772358e-01 1 1  ON 11
 ud_2                 5.929932e-02 1 1  ON 12
 ud_3                -9.597591e-03 1 1  ON 13
 ud_4                -6.543109e-02 1 1  ON 14
 ud_5                -1.056569e-01 1 1  ON 15
 ud_6                -1.320161e-01 1 1  ON 16
 ud_7                -1.477362e-01 1 1  ON 17
 ud_8                -1.491201e-01 1 1  ON 18
 ud_9                -1.396748e-01 1 1  ON 19
 eO_0                -7.492976e-01 1 1  ON 20
 eO_1                -4.319724e-01 1 1  ON 21
 eO_2                -1.732850e-02 1 1  ON 22
 eO_3                 2.961565e-01 1 1  ON 23
 eO_4                 5.143787e-01 1 1  ON 24
 eO_5                 4.707303e-01 1 1  ON 25
 eO_6                 2.415504e-01 1 1  ON 26
 eO_7                -5.326423e-02 1 1  ON 27
 eO_8                -2.065996e-01 1 1  ON 28
 eO_9                -6.606176e-02 1 1  ON 29
eH1_0                -2.327347e-01 1 1  ON 30
eH1_1                -1.347668e-01 1 1  ON 31
eH1_2                -8.949717e-02 1 1  ON 32
eH1_3                -3.620431e-02 1 1  ON 33
eH1_4                 1.124718e-02 1 1  ON 34
eH1_5                 4.432523e-02 1 1  ON 35
eH1_6                 9.878712e-02 1 1  ON 36
eH1_7                 1.443240e-01 1 1  ON 37
eH1_8                 1.566670e-01 1 1  ON 38
eH1_9                 4.238868e-02 1 1  ON 39
eH2_0                -2.304819e-01 1 1  ON 40
eH2_1                -1.320835e-01 1 1  ON 41
eH2_2                -8.662057e-02 1 1  ON 42
eH2_3                -3.358460e-02 1 1  ON 43
eH2_4                 1.351592e-02 1 1  ON 44
eH2_5                 4.810583e-02 1 1  ON 45
eH2_6                 1.028136e-01 1 1  ON 46
eH2_7                 1.500210e-01 1 1  ON 47
eH2_8                 1.618423e-01 1 1  ON 48
eH2_9                 2.456422e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5897e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9097
    reference variance = 0.208484
====================================================
  Execution time = 2.0539e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3501e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5707e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334949021850
                                         uncertainty =       0.003636394175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334949021850
                                         uncertainty =       0.003636394175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409275734
  error estimate for blocks of size 2^( 2) =       0.000422472448
  error estimate for blocks of size 2^( 3) =       0.000435864109
  error estimate for blocks of size 2^( 4) =       0.000448206233
  error estimate for blocks of size 2^( 5) =       0.000459110373
  error estimate for blocks of size 2^( 6) =       0.000467930958
  error estimate for blocks of size 2^( 7) =       0.000470387328

      target function =                  N/A
              le_mean =     -16.906126043671
             les_mean =     286.152110890616
             stat err =       0.000461408723
             autocorr =       1.270982608984
              std dev =       0.578803294427
             le_variance =       0.335013253639


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690612604367e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906126043671       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906126063639       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906126105742       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906126113196       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906126117445       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906126112029       residual = 9.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906126113139       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906126113373       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906126114039       residual = 1.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 8.492766e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906126043671       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906126048675       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906126059250       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906126061121       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906126062197       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906126060885       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906126060881       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906126061158       residual = 9.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 2.125209e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906126043671       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906126044923       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906126047570       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906126048037       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906126048308       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906126047986       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906126047975       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906126048046       residual = 9.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 5.315338e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045072 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6125e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.080665e-01 1 1  ON 0
 uu_1                 1.418032e-01 1 1  ON 1
 uu_2                 4.089995e-02 1 1  ON 2
 uu_3                -2.057524e-02 1 1  ON 3
 uu_4                -6.445437e-02 1 1  ON 4
 uu_5                -9.746445e-02 1 1  ON 5
 uu_6                -1.230231e-01 1 1  ON 6
 uu_7                -1.348942e-01 1 1  ON 7
 uu_8                -1.267490e-01 1 1  ON 8
 uu_9                -9.654961e-02 1 1  ON 9
 ud_0                 4.415758e-01 1 1  ON 10
 ud_1                 1.772371e-01 1 1  ON 11
 ud_2                 5.929884e-02 1 1  ON 12
 ud_3                -9.598403e-03 1 1  ON 13
 ud_4                -6.543132e-02 1 1  ON 14
 ud_5                -1.056577e-01 1 1  ON 15
 ud_6                -1.320160e-01 1 1  ON 16
 ud_7                -1.477361e-01 1 1  ON 17
 ud_8                -1.491206e-01 1 1  ON 18
 ud_9                -1.396748e-01 1 1  ON 19
 eO_0                -7.492998e-01 1 1  ON 20
 eO_1                -4.319725e-01 1 1  ON 21
 eO_2                -1.732846e-02 1 1  ON 22
 eO_3                 2.961577e-01 1 1  ON 23
 eO_4                 5.143796e-01 1 1  ON 24
 eO_5                 4.707311e-01 1 1  ON 25
 eO_6                 2.415511e-01 1 1  ON 26
 eO_7                -5.326412e-02 1 1  ON 27
 eO_8                -2.066003e-01 1 1  ON 28
 eO_9                -6.606228e-02 1 1  ON 29
eH1_0                -2.327356e-01 1 1  ON 30
eH1_1                -1.347679e-01 1 1  ON 31
eH1_2                -8.949662e-02 1 1  ON 32
eH1_3                -3.620459e-02 1 1  ON 33
eH1_4                 1.124741e-02 1 1  ON 34
eH1_5                 4.432530e-02 1 1  ON 35
eH1_6                 9.878677e-02 1 1  ON 36
eH1_7                 1.443243e-01 1 1  ON 37
eH1_8                 1.566678e-01 1 1  ON 38
eH1_9                 4.238935e-02 1 1  ON 39
eH2_0                -2.304833e-01 1 1  ON 40
eH2_1                -1.320843e-01 1 1  ON 41
eH2_2                -8.662082e-02 1 1  ON 42
eH2_3                -3.358436e-02 1 1  ON 43
eH2_4                 1.351584e-02 1 1  ON 44
eH2_5                 4.810600e-02 1 1  ON 45
eH2_6                 1.028138e-01 1 1  ON 46
eH2_7                 1.500213e-01 1 1  ON 47
eH2_8                 1.618431e-01 1 1  ON 48
eH2_9                 2.456513e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8781
    reference variance = 0.333532
====================================================
  Execution time = 2.0039e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4692e-01
  Total weights = 2.0000e+06
  Execution time = 1.8761e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346978887430
                                         uncertainty =       0.013164436296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346978887430
                                         uncertainty =       0.013164436296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416485631
  error estimate for blocks of size 2^( 2) =       0.000428894337
  error estimate for blocks of size 2^( 3) =       0.000442104355
  error estimate for blocks of size 2^( 4) =       0.000454745314
  error estimate for blocks of size 2^( 5) =       0.000466102774
  error estimate for blocks of size 2^( 6) =       0.000474790961
  error estimate for blocks of size 2^( 7) =       0.000479950878

      target function =                  N/A
              le_mean =     -16.906113117937
             les_mean =     286.163581145316
             stat err =       0.000468897482
             autocorr =       1.267522727411
              std dev =       0.588999628445
             le_variance =       0.346920562308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346983371656
                                         uncertainty =       0.013164457687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346983371656
                                         uncertainty =       0.013164457687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416488323
  error estimate for blocks of size 2^( 2) =       0.000428896783
  error estimate for blocks of size 2^( 3) =       0.000442106585
  error estimate for blocks of size 2^( 4) =       0.000454747333
  error estimate for blocks of size 2^( 5) =       0.000466104636
  error estimate for blocks of size 2^( 6) =       0.000474792784
  error estimate for blocks of size 2^( 7) =       0.000479952733

      target function =                  N/A
              le_mean =     -16.906113119881
             les_mean =     286.163585694657
             stat err =       0.000468899371
             autocorr =       1.267516560676
              std dev =       0.589003434539
             le_variance =       0.346925045899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346981136930
                                         uncertainty =       0.013164446197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346981136930
                                         uncertainty =       0.013164446197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416486981
  error estimate for blocks of size 2^( 2) =       0.000428895564
  error estimate for blocks of size 2^( 3) =       0.000442105475
  error estimate for blocks of size 2^( 4) =       0.000454746329
  error estimate for blocks of size 2^( 5) =       0.000466103712
  error estimate for blocks of size 2^( 6) =       0.000474791880
  error estimate for blocks of size 2^( 7) =       0.000479951812

      target function =                  N/A
              le_mean =     -16.906113119020
             les_mean =     286.163583431130
             stat err =       0.000468898433
             autocorr =       1.267519652145
              std dev =       0.589001537762
             le_variance =       0.346922811486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346979168623
                                         uncertainty =       0.013164437533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346979168623
                                         uncertainty =       0.013164437533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416485800
  error estimate for blocks of size 2^( 2) =       0.000428894490
  error estimate for blocks of size 2^( 3) =       0.000442104495
  error estimate for blocks of size 2^( 4) =       0.000454745441
  error estimate for blocks of size 2^( 5) =       0.000466102891
  error estimate for blocks of size 2^( 6) =       0.000474791076
  error estimate for blocks of size 2^( 7) =       0.000479950995

      target function =                  N/A
              le_mean =     -16.906113118067
             les_mean =     286.163581430862
             stat err =       0.000468897601
             autocorr =       1.267522342847
              std dev =       0.588999867114
             le_variance =       0.346920843461


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906113117937        initial
     6.1035e+01     6.1035e+02             8.4928e-06       -16.906113119881  <--
     2.4414e+02     2.4414e+03             2.1252e-06       -16.906113119020
     9.7656e+02     9.7656e+03             5.3153e-07       -16.906113118067

*****************************************************************************
Applying the update for shift_i =   6.1035e+01     and shift_s =   6.1035e+02
*****************************************************************************

  Execution time = 2.9495e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.080658e-01 1 1  ON 0
 uu_1                 1.418023e-01 1 1  ON 1
 uu_2                 4.090143e-02 1 1  ON 2
 uu_3                -2.057388e-02 1 1  ON 3
 uu_4                -6.445472e-02 1 1  ON 4
 uu_5                -9.746390e-02 1 1  ON 5
 uu_6                -1.230248e-01 1 1  ON 6
 uu_7                -1.348947e-01 1 1  ON 7
 uu_8                -1.267497e-01 1 1  ON 8
 uu_9                -9.655055e-02 1 1  ON 9
 ud_0                 4.415814e-01 1 1  ON 10
 ud_1                 1.772412e-01 1 1  ON 11
 ud_2                 5.929744e-02 1 1  ON 12
 ud_3                -9.600732e-03 1 1  ON 13
 ud_4                -6.543210e-02 1 1  ON 14
 ud_5                -1.056601e-01 1 1  ON 15
 ud_6                -1.320159e-01 1 1  ON 16
 ud_7                -1.477360e-01 1 1  ON 17
 ud_8                -1.491219e-01 1 1  ON 18
 ud_9                -1.396748e-01 1 1  ON 19
 eO_0                -7.493061e-01 1 1  ON 20
 eO_1                -4.319728e-01 1 1  ON 21
 eO_2                -1.732843e-02 1 1  ON 22
 eO_3                 2.961611e-01 1 1  ON 23
 eO_4                 5.143824e-01 1 1  ON 24
 eO_5                 4.707335e-01 1 1  ON 25
 eO_6                 2.415531e-01 1 1  ON 26
 eO_7                -5.326373e-02 1 1  ON 27
 eO_8                -2.066027e-01 1 1  ON 28
 eO_9                -6.606391e-02 1 1  ON 29
eH1_0                -2.327381e-01 1 1  ON 30
eH1_1                -1.347712e-01 1 1  ON 31
eH1_2                -8.949514e-02 1 1  ON 32
eH1_3                -3.620526e-02 1 1  ON 33
eH1_4                 1.124778e-02 1 1  ON 34
eH1_5                 4.432538e-02 1 1  ON 35
eH1_6                 9.878580e-02 1 1  ON 36
eH1_7                 1.443255e-01 1 1  ON 37
eH1_8                 1.566701e-01 1 1  ON 38
eH1_9                 4.239146e-02 1 1  ON 39
eH2_0                -2.304874e-01 1 1  ON 40
eH2_1                -1.320868e-01 1 1  ON 41
eH2_2                -8.662173e-02 1 1  ON 42
eH2_3                -3.358357e-02 1 1  ON 43
eH2_4                 1.351555e-02 1 1  ON 44
eH2_5                 4.810640e-02 1 1  ON 45
eH2_6                 1.028143e-01 1 1  ON 46
eH2_7                 1.500223e-01 1 1  ON 47
eH2_8                 1.618454e-01 1 1  ON 48
eH2_9                 2.456800e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5626e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9274
    reference variance = 0.323822
====================================================
  Execution time = 2.0417e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5299e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353057364793
                                         uncertainty =       0.007879323306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353057364793
                                         uncertainty =       0.007879323306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420111128
  error estimate for blocks of size 2^( 2) =       0.000433217170
  error estimate for blocks of size 2^( 3) =       0.000446368683
  error estimate for blocks of size 2^( 4) =       0.000459308202
  error estimate for blocks of size 2^( 5) =       0.000470698602
  error estimate for blocks of size 2^( 6) =       0.000478327072
  error estimate for blocks of size 2^( 7) =       0.000482971117

      target function =                  N/A
              le_mean =     -16.905096001955
             les_mean =     286.135257379316
             stat err =       0.000472826248
             autocorr =       1.266702955235
              std dev =       0.594126855561
             le_variance =       0.352986720499


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690509600195e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905096001955       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905096063608       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905096048606       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905096108741       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905096137936       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905096136276       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905096167617       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905096157511       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905096161525       residual = 1.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 3.618265e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905096001955       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905096017526       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905096013589       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905096028423       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905096035883       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905096035639       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905096043609       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905096041141       residual = 9.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 9.369819e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905096001955       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905096005858       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905096004861       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905096008557       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905096010432       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905096010382       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905096012383       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905096011770       residual = 9.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 2.349116e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.047915 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6098e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.080658e-01 1 1  ON 0
 uu_1                 1.418028e-01 1 1  ON 1
 uu_2                 4.090301e-02 1 1  ON 2
 uu_3                -2.057441e-02 1 1  ON 3
 uu_4                -6.445472e-02 1 1  ON 4
 uu_5                -9.746575e-02 1 1  ON 5
 uu_6                -1.230281e-01 1 1  ON 6
 uu_7                -1.348963e-01 1 1  ON 7
 uu_8                -1.267487e-01 1 1  ON 8
 uu_9                -9.654976e-02 1 1  ON 9
 ud_0                 4.415907e-01 1 1  ON 10
 ud_1                 1.772435e-01 1 1  ON 11
 ud_2                 5.929451e-02 1 1  ON 12
 ud_3                -9.605246e-03 1 1  ON 13
 ud_4                -6.543252e-02 1 1  ON 14
 ud_5                -1.056633e-01 1 1  ON 15
 ud_6                -1.320174e-01 1 1  ON 16
 ud_7                -1.477366e-01 1 1  ON 17
 ud_8                -1.491210e-01 1 1  ON 18
 ud_9                -1.396739e-01 1 1  ON 19
 eO_0                -7.493142e-01 1 1  ON 20
 eO_1                -4.319751e-01 1 1  ON 21
 eO_2                -1.732660e-02 1 1  ON 22
 eO_3                 2.961654e-01 1 1  ON 23
 eO_4                 5.143848e-01 1 1  ON 24
 eO_5                 4.707360e-01 1 1  ON 25
 eO_6                 2.415546e-01 1 1  ON 26
 eO_7                -5.326244e-02 1 1  ON 27
 eO_8                -2.066042e-01 1 1  ON 28
 eO_9                -6.606567e-02 1 1  ON 29
eH1_0                -2.327433e-01 1 1  ON 30
eH1_1                -1.347749e-01 1 1  ON 31
eH1_2                -8.949457e-02 1 1  ON 32
eH1_3                -3.620625e-02 1 1  ON 33
eH1_4                 1.124742e-02 1 1  ON 34
eH1_5                 4.432554e-02 1 1  ON 35
eH1_6                 9.878618e-02 1 1  ON 36
eH1_7                 1.443275e-01 1 1  ON 37
eH1_8                 1.566730e-01 1 1  ON 38
eH1_9                 4.239476e-02 1 1  ON 39
eH2_0                -2.304920e-01 1 1  ON 40
eH2_1                -1.320885e-01 1 1  ON 41
eH2_2                -8.662251e-02 1 1  ON 42
eH2_3                -3.358463e-02 1 1  ON 43
eH2_4                 1.351479e-02 1 1  ON 44
eH2_5                 4.810588e-02 1 1  ON 45
eH2_6                 1.028134e-01 1 1  ON 46
eH2_7                 1.500239e-01 1 1  ON 47
eH2_8                 1.618496e-01 1 1  ON 48
eH2_9                 2.457212e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8858
    reference variance = 0.259532
====================================================
  Execution time = 2.0081e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3163e-01
  Total weights = 2.0000e+06
  Execution time = 1.8758e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331508423353
                                         uncertainty =       0.002889533106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331508423353
                                         uncertainty =       0.002889533106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407198462
  error estimate for blocks of size 2^( 2) =       0.000419898974
  error estimate for blocks of size 2^( 3) =       0.000433354610
  error estimate for blocks of size 2^( 4) =       0.000446089110
  error estimate for blocks of size 2^( 5) =       0.000456489115
  error estimate for blocks of size 2^( 6) =       0.000466492199
  error estimate for blocks of size 2^( 7) =       0.000470674700

      target function =                  N/A
              le_mean =     -16.905376114718
             les_mean =     286.123362588853
             stat err =       0.000459936281
             autocorr =       1.275801419658
              std dev =       0.575865587259
             le_variance =       0.331621174589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331540636344
                                         uncertainty =       0.002889904959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331540636344
                                         uncertainty =       0.002889904959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407218254
  error estimate for blocks of size 2^( 2) =       0.000419917474
  error estimate for blocks of size 2^( 3) =       0.000433372044
  error estimate for blocks of size 2^( 4) =       0.000446105670
  error estimate for blocks of size 2^( 5) =       0.000456504922
  error estimate for blocks of size 2^( 6) =       0.000466507500
  error estimate for blocks of size 2^( 7) =       0.000470690523

      target function =                  N/A
              le_mean =     -16.905376191007
             les_mean =     286.123397406120
             stat err =       0.000459952154
             autocorr =       1.275765457424
              std dev =       0.575893577405
             le_variance =       0.331653412496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331525196913
                                         uncertainty =       0.002889727745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331525196913
                                         uncertainty =       0.002889727745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407208768
  error estimate for blocks of size 2^( 2) =       0.000419908608
  error estimate for blocks of size 2^( 3) =       0.000433363694
  error estimate for blocks of size 2^( 4) =       0.000446097748
  error estimate for blocks of size 2^( 5) =       0.000456497375
  error estimate for blocks of size 2^( 6) =       0.000466500216
  error estimate for blocks of size 2^( 7) =       0.000470682982

      target function =                  N/A
              le_mean =     -16.905376152660
             les_mean =     286.123380658742
             stat err =       0.000459944580
             autocorr =       1.275782879540
              std dev =       0.575880162560
             le_variance =       0.331637961630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331510525652
                                         uncertainty =       0.002889557512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331510525652
                                         uncertainty =       0.002889557512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407199754
  error estimate for blocks of size 2^( 2) =       0.000419900182
  error estimate for blocks of size 2^( 3) =       0.000433355748
  error estimate for blocks of size 2^( 4) =       0.000446090192
  error estimate for blocks of size 2^( 5) =       0.000456490150
  error estimate for blocks of size 2^( 6) =       0.000466493204
  error estimate for blocks of size 2^( 7) =       0.000470675738

      target function =                  N/A
              le_mean =     -16.905376119399
             les_mean =     286.123364851128
             stat err =       0.000459937321
             autocorr =       1.275799095259
              std dev =       0.575867414065
             le_variance =       0.331623278582


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905376114718        initial
     1.5259e+01     1.5259e+02             3.6183e-05       -16.905376191007  <--
     6.1035e+01     6.1035e+02             9.3698e-06       -16.905376152660
     2.4414e+02     2.4414e+03             2.3491e-06       -16.905376119399

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 2.9547e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.080660e-01 1 1  ON 0
 uu_1                 1.418041e-01 1 1  ON 1
 uu_2                 4.090754e-02 1 1  ON 2
 uu_3                -2.057624e-02 1 1  ON 3
 uu_4                -6.445427e-02 1 1  ON 4
 uu_5                -9.747128e-02 1 1  ON 5
 uu_6                -1.230381e-01 1 1  ON 6
 uu_7                -1.349012e-01 1 1  ON 7
 uu_8                -1.267460e-01 1 1  ON 8
 uu_9                -9.654753e-02 1 1  ON 9
 ud_0                 4.416175e-01 1 1  ON 10
 ud_1                 1.772510e-01 1 1  ON 11
 ud_2                 5.928638e-02 1 1  ON 12
 ud_3                -9.618254e-03 1 1  ON 13
 ud_4                -6.543389e-02 1 1  ON 14
 ud_5                -1.056733e-01 1 1  ON 15
 ud_6                -1.320216e-01 1 1  ON 16
 ud_7                -1.477386e-01 1 1  ON 17
 ud_8                -1.491186e-01 1 1  ON 18
 ud_9                -1.396713e-01 1 1  ON 19
 eO_0                -7.493386e-01 1 1  ON 20
 eO_1                -4.319820e-01 1 1  ON 21
 eO_2                -1.732212e-02 1 1  ON 22
 eO_3                 2.961781e-01 1 1  ON 23
 eO_4                 5.143931e-01 1 1  ON 24
 eO_5                 4.707444e-01 1 1  ON 25
 eO_6                 2.415595e-01 1 1  ON 26
 eO_7                -5.325836e-02 1 1  ON 27
 eO_8                -2.066091e-01 1 1  ON 28
 eO_9                -6.607130e-02 1 1  ON 29
eH1_0                -2.327590e-01 1 1  ON 30
eH1_1                -1.347858e-01 1 1  ON 31
eH1_2                -8.949357e-02 1 1  ON 32
eH1_3                -3.620875e-02 1 1  ON 33
eH1_4                 1.124571e-02 1 1  ON 34
eH1_5                 4.432564e-02 1 1  ON 35
eH1_6                 9.878724e-02 1 1  ON 36
eH1_7                 1.443336e-01 1 1  ON 37
eH1_8                 1.566822e-01 1 1  ON 38
eH1_9                 4.240517e-02 1 1  ON 39
eH2_0                -2.305058e-01 1 1  ON 40
eH2_1                -1.320937e-01 1 1  ON 41
eH2_2                -8.662581e-02 1 1  ON 42
eH2_3                -3.358781e-02 1 1  ON 43
eH2_4                 1.351225e-02 1 1  ON 44
eH2_5                 4.810440e-02 1 1  ON 45
eH2_6                 1.028108e-01 1 1  ON 46
eH2_7                 1.500291e-01 1 1  ON 47
eH2_8                 1.618628e-01 1 1  ON 48
eH2_9                 2.458508e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5673e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9107
    reference variance = 0.519476
====================================================
  Execution time = 2.0645e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3540e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7203e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335285804423
                                         uncertainty =       0.003359115014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335285804423
                                         uncertainty =       0.003359115014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409509507
  error estimate for blocks of size 2^( 2) =       0.000422175735
  error estimate for blocks of size 2^( 3) =       0.000435625088
  error estimate for blocks of size 2^( 4) =       0.000448112682
  error estimate for blocks of size 2^( 5) =       0.000458373200
  error estimate for blocks of size 2^( 6) =       0.000465094562
  error estimate for blocks of size 2^( 7) =       0.000466473929

      target function =                  N/A
              le_mean =     -16.905745071932
             les_mean =     286.139612341511
             stat err =       0.000459513593
             autocorr =       1.259124718457
              std dev =       0.579133898196
             le_variance =       0.335396072039


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574507193e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905745071932       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905745196449       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905744794313       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905745106683       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905745260105       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905745405706       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905745518287       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905745496897       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905745466139       residual = 1.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 1.461190e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905745071932       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905745104314       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905744996062       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905745068689       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905745107955       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905745147036       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905745175786       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905745173820       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905745166969       residual = 1.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 3.774688e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905745071932       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905745080110       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905745052523       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905745070298       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905745080143       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905745090080       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905745097297       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905745097006       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905745095388       residual = 1.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 9.512004e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.051043 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6374e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418033e-01 1 1  ON 1
 uu_2                 4.091258e-02 1 1  ON 2
 uu_3                -2.057128e-02 1 1  ON 3
 uu_4                -6.445114e-02 1 1  ON 4
 uu_5                -9.747047e-02 1 1  ON 5
 uu_6                -1.230390e-01 1 1  ON 6
 uu_7                -1.349029e-01 1 1  ON 7
 uu_8                -1.267606e-01 1 1  ON 8
 uu_9                -9.655931e-02 1 1  ON 9
 ud_0                 4.416553e-01 1 1  ON 10
 ud_1                 1.772738e-01 1 1  ON 11
 ud_2                 5.927770e-02 1 1  ON 12
 ud_3                -9.630106e-03 1 1  ON 13
 ud_4                -6.543767e-02 1 1  ON 14
 ud_5                -1.056816e-01 1 1  ON 15
 ud_6                -1.320319e-01 1 1  ON 16
 ud_7                -1.477396e-01 1 1  ON 17
 ud_8                -1.491213e-01 1 1  ON 18
 ud_9                -1.396791e-01 1 1  ON 19
 eO_0                -7.493702e-01 1 1  ON 20
 eO_1                -4.319856e-01 1 1  ON 21
 eO_2                -1.731436e-02 1 1  ON 22
 eO_3                 2.961935e-01 1 1  ON 23
 eO_4                 5.144015e-01 1 1  ON 24
 eO_5                 4.707559e-01 1 1  ON 25
 eO_6                 2.415755e-01 1 1  ON 26
 eO_7                -5.325426e-02 1 1  ON 27
 eO_8                -2.066247e-01 1 1  ON 28
 eO_9                -6.608209e-02 1 1  ON 29
eH1_0                -2.327776e-01 1 1  ON 30
eH1_1                -1.347994e-01 1 1  ON 31
eH1_2                -8.949250e-02 1 1  ON 32
eH1_3                -3.621094e-02 1 1  ON 33
eH1_4                 1.125182e-02 1 1  ON 34
eH1_5                 4.433101e-02 1 1  ON 35
eH1_6                 9.878447e-02 1 1  ON 36
eH1_7                 1.443348e-01 1 1  ON 37
eH1_8                 1.566953e-01 1 1  ON 38
eH1_9                 4.241675e-02 1 1  ON 39
eH2_0                -2.305201e-01 1 1  ON 40
eH2_1                -1.321033e-01 1 1  ON 41
eH2_2                -8.663377e-02 1 1  ON 42
eH2_3                -3.358625e-02 1 1  ON 43
eH2_4                 1.351346e-02 1 1  ON 44
eH2_5                 4.810436e-02 1 1  ON 45
eH2_6                 1.028158e-01 1 1  ON 46
eH2_7                 1.500317e-01 1 1  ON 47
eH2_8                 1.618725e-01 1 1  ON 48
eH2_9                 2.459682e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8965
    reference variance = 0.33781
====================================================
  Execution time = 2.0313e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4124e-01
  Total weights = 2.0000e+06
  Execution time = 1.8591e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340386499725
                                         uncertainty =       0.004128113528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340386499725
                                         uncertainty =       0.004128113528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413044128
  error estimate for blocks of size 2^( 2) =       0.000425623208
  error estimate for blocks of size 2^( 3) =       0.000439075045
  error estimate for blocks of size 2^( 4) =       0.000451724320
  error estimate for blocks of size 2^( 5) =       0.000462806175
  error estimate for blocks of size 2^( 6) =       0.000469674736
  error estimate for blocks of size 2^( 7) =       0.000474945542

      target function =                  N/A
              le_mean =     -16.904905577439
             les_mean =     286.117043314468
             stat err =       0.000464787693
             autocorr =       1.266240897131
              std dev =       0.584132607337
             le_variance =       0.341210902954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340496602245
                                         uncertainty =       0.004129384800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340496602245
                                         uncertainty =       0.004129384800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413110258
  error estimate for blocks of size 2^( 2) =       0.000425684822
  error estimate for blocks of size 2^( 3) =       0.000439131756
  error estimate for blocks of size 2^( 4) =       0.000451776368
  error estimate for blocks of size 2^( 5) =       0.000462855346
  error estimate for blocks of size 2^( 6) =       0.000469720535
  error estimate for blocks of size 2^( 7) =       0.000474993591

      target function =                  N/A
              le_mean =     -16.904905069912
             les_mean =     286.117135423400
             stat err =       0.000464836460
             autocorr =       1.266101172840
              std dev =       0.584226130301
             le_variance =       0.341320171327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340444022451
                                         uncertainty =       0.004128745679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340444022451
                                         uncertainty =       0.004128745679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413078666
  error estimate for blocks of size 2^( 2) =       0.000425655358
  error estimate for blocks of size 2^( 3) =       0.000439104618
  error estimate for blocks of size 2^( 4) =       0.000451751431
  error estimate for blocks of size 2^( 5) =       0.000462831762
  error estimate for blocks of size 2^( 6) =       0.000469698540
  error estimate for blocks of size 2^( 7) =       0.000474970525

      target function =                  N/A
              le_mean =     -16.904905303323
             les_mean =     286.117091112645
             stat err =       0.000464813065
             autocorr =       1.266167380185
              std dev =       0.584181452081
             le_variance =       0.341267968956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340393761745
                                         uncertainty =       0.004128192140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340393761745
                                         uncertainty =       0.004128192140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413048488
  error estimate for blocks of size 2^( 2) =       0.000425627265
  error estimate for blocks of size 2^( 3) =       0.000439078775
  error estimate for blocks of size 2^( 4) =       0.000451727738
  error estimate for blocks of size 2^( 5) =       0.000462809399
  error estimate for blocks of size 2^( 6) =       0.000469677734
  error estimate for blocks of size 2^( 7) =       0.000474948689

      target function =                  N/A
              le_mean =     -16.904905541384
             les_mean =     286.117049299000
             stat err =       0.000464790890
             autocorr =       1.266231582412
              std dev =       0.584138773322
             le_variance =       0.341218106498


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904905577439        initial  <--
     3.8147e+00     3.8147e+01             1.4612e-04       -16.904905069912
     1.5259e+01     1.5259e+02             3.7747e-05       -16.904905303323
     6.1035e+01     6.1035e+02             9.5120e-06       -16.904905541384

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7187
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.080660e-01 1 1  ON 0
 uu_1                 1.418041e-01 1 1  ON 1
 uu_2                 4.090754e-02 1 1  ON 2
 uu_3                -2.057624e-02 1 1  ON 3
 uu_4                -6.445427e-02 1 1  ON 4
 uu_5                -9.747128e-02 1 1  ON 5
 uu_6                -1.230381e-01 1 1  ON 6
 uu_7                -1.349012e-01 1 1  ON 7
 uu_8                -1.267460e-01 1 1  ON 8
 uu_9                -9.654753e-02 1 1  ON 9
 ud_0                 4.416175e-01 1 1  ON 10
 ud_1                 1.772510e-01 1 1  ON 11
 ud_2                 5.928638e-02 1 1  ON 12
 ud_3                -9.618254e-03 1 1  ON 13
 ud_4                -6.543389e-02 1 1  ON 14
 ud_5                -1.056733e-01 1 1  ON 15
 ud_6                -1.320216e-01 1 1  ON 16
 ud_7                -1.477386e-01 1 1  ON 17
 ud_8                -1.491186e-01 1 1  ON 18
 ud_9                -1.396713e-01 1 1  ON 19
 eO_0                -7.493386e-01 1 1  ON 20
 eO_1                -4.319820e-01 1 1  ON 21
 eO_2                -1.732212e-02 1 1  ON 22
 eO_3                 2.961781e-01 1 1  ON 23
 eO_4                 5.143931e-01 1 1  ON 24
 eO_5                 4.707444e-01 1 1  ON 25
 eO_6                 2.415595e-01 1 1  ON 26
 eO_7                -5.325836e-02 1 1  ON 27
 eO_8                -2.066091e-01 1 1  ON 28
 eO_9                -6.607130e-02 1 1  ON 29
eH1_0                -2.327590e-01 1 1  ON 30
eH1_1                -1.347858e-01 1 1  ON 31
eH1_2                -8.949357e-02 1 1  ON 32
eH1_3                -3.620875e-02 1 1  ON 33
eH1_4                 1.124571e-02 1 1  ON 34
eH1_5                 4.432564e-02 1 1  ON 35
eH1_6                 9.878724e-02 1 1  ON 36
eH1_7                 1.443336e-01 1 1  ON 37
eH1_8                 1.566822e-01 1 1  ON 38
eH1_9                 4.240517e-02 1 1  ON 39
eH2_0                -2.305058e-01 1 1  ON 40
eH2_1                -1.320937e-01 1 1  ON 41
eH2_2                -8.662581e-02 1 1  ON 42
eH2_3                -3.358781e-02 1 1  ON 43
eH2_4                 1.351225e-02 1 1  ON 44
eH2_5                 4.810440e-02 1 1  ON 45
eH2_6                 1.028108e-01 1 1  ON 46
eH2_7                 1.500291e-01 1 1  ON 47
eH2_8                 1.618628e-01 1 1  ON 48
eH2_9                 2.458508e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6100e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8929
    reference variance = 0.254099
====================================================
  Execution time = 2.0628e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3984e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6185e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339452868896
                                         uncertainty =       0.005204489693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339452868896
                                         uncertainty =       0.005204489693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412216462
  error estimate for blocks of size 2^( 2) =       0.000424650603
  error estimate for blocks of size 2^( 3) =       0.000437081051
  error estimate for blocks of size 2^( 4) =       0.000449417648
  error estimate for blocks of size 2^( 5) =       0.000460102518
  error estimate for blocks of size 2^( 6) =       0.000469273504
  error estimate for blocks of size 2^( 7) =       0.000472178074

      target function =                  N/A
              le_mean =     -16.906215572682
             les_mean =     286.159969642889
             stat err =       0.000462742936
             autocorr =       1.260169409510
              std dev =       0.582962110953
             le_variance =       0.339844822807


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690621557268e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906215572682       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906215593775       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906215627210       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906215616887       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906215598818       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906215620114       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906215622114       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906215625537       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906215625452       residual = 1.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 1.212008e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906215572682       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906215577978       residual = 8.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906215586403       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906215583828       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906215579250       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906215584564       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906215585072       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906215585933       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906215585921       residual = 1.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 3.037972e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906215572682       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906215574008       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906215576118       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906215575475       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906215574326       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906215575654       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906215575781       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906215575996       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906215575994       residual = 1.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 7.599866e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054154 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6254e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.080660e-01 1 1  ON 0
 uu_1                 1.418046e-01 1 1  ON 1
 uu_2                 4.090768e-02 1 1  ON 2
 uu_3                -2.057588e-02 1 1  ON 3
 uu_4                -6.445426e-02 1 1  ON 4
 uu_5                -9.747140e-02 1 1  ON 5
 uu_6                -1.230389e-01 1 1  ON 6
 uu_7                -1.349008e-01 1 1  ON 7
 uu_8                -1.267467e-01 1 1  ON 8
 uu_9                -9.654836e-02 1 1  ON 9
 ud_0                 4.416206e-01 1 1  ON 10
 ud_1                 1.772531e-01 1 1  ON 11
 ud_2                 5.928557e-02 1 1  ON 12
 ud_3                -9.619027e-03 1 1  ON 13
 ud_4                -6.543414e-02 1 1  ON 14
 ud_5                -1.056732e-01 1 1  ON 15
 ud_6                -1.320221e-01 1 1  ON 16
 ud_7                -1.477388e-01 1 1  ON 17
 ud_8                -1.491193e-01 1 1  ON 18
 ud_9                -1.396722e-01 1 1  ON 19
 eO_0                -7.493415e-01 1 1  ON 20
 eO_1                -4.319826e-01 1 1  ON 21
 eO_2                -1.732148e-02 1 1  ON 22
 eO_3                 2.961792e-01 1 1  ON 23
 eO_4                 5.143945e-01 1 1  ON 24
 eO_5                 4.707450e-01 1 1  ON 25
 eO_6                 2.415610e-01 1 1  ON 26
 eO_7                -5.325775e-02 1 1  ON 27
 eO_8                -2.066103e-01 1 1  ON 28
 eO_9                -6.607225e-02 1 1  ON 29
eH1_0                -2.327614e-01 1 1  ON 30
eH1_1                -1.347868e-01 1 1  ON 31
eH1_2                -8.949287e-02 1 1  ON 32
eH1_3                -3.620854e-02 1 1  ON 33
eH1_4                 1.124575e-02 1 1  ON 34
eH1_5                 4.432579e-02 1 1  ON 35
eH1_6                 9.878749e-02 1 1  ON 36
eH1_7                 1.443346e-01 1 1  ON 37
eH1_8                 1.566830e-01 1 1  ON 38
eH1_9                 4.240568e-02 1 1  ON 39
eH2_0                -2.305076e-01 1 1  ON 40
eH2_1                -1.320944e-01 1 1  ON 41
eH2_2                -8.662642e-02 1 1  ON 42
eH2_3                -3.358762e-02 1 1  ON 43
eH2_4                 1.351277e-02 1 1  ON 44
eH2_5                 4.810387e-02 1 1  ON 45
eH2_6                 1.028104e-01 1 1  ON 46
eH2_7                 1.500294e-01 1 1  ON 47
eH2_8                 1.618644e-01 1 1  ON 48
eH2_9                 2.458660e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8528
    reference variance = 0.243984
====================================================
  Execution time = 2.2687e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3885e-01
  Total weights = 2.0000e+06
  Execution time = 1.8530e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338833845881
                                         uncertainty =       0.004141043439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338833845881
                                         uncertainty =       0.004141043439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411613099
  error estimate for blocks of size 2^( 2) =       0.000424547449
  error estimate for blocks of size 2^( 3) =       0.000438402170
  error estimate for blocks of size 2^( 4) =       0.000451076273
  error estimate for blocks of size 2^( 5) =       0.000462770953
  error estimate for blocks of size 2^( 6) =       0.000470471368
  error estimate for blocks of size 2^( 7) =       0.000473451631

      target function =                  N/A
              le_mean =     -16.905732163253
             les_mean =     286.142630492410
             stat err =       0.000464442556
             autocorr =       1.273167779591
              std dev =       0.582108826766
             le_variance =       0.338850686199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338843356746
                                         uncertainty =       0.004141153042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338843356746
                                         uncertainty =       0.004141153042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411618877
  error estimate for blocks of size 2^( 2) =       0.000424552791
  error estimate for blocks of size 2^( 3) =       0.000438407085
  error estimate for blocks of size 2^( 4) =       0.000451080896
  error estimate for blocks of size 2^( 5) =       0.000462775435
  error estimate for blocks of size 2^( 6) =       0.000470475699
  error estimate for blocks of size 2^( 7) =       0.000473455929

      target function =                  N/A
              le_mean =     -16.905732172459
             les_mean =     286.142640317286
             stat err =       0.000464446990
             autocorr =       1.273156341257
              std dev =       0.582116998376
             le_variance =       0.338860199798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338838623296
                                         uncertainty =       0.004141098421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338838623296
                                         uncertainty =       0.004141098421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411616001
  error estimate for blocks of size 2^( 2) =       0.000424550132
  error estimate for blocks of size 2^( 3) =       0.000438404639
  error estimate for blocks of size 2^( 4) =       0.000451078594
  error estimate for blocks of size 2^( 5) =       0.000462773204
  error estimate for blocks of size 2^( 6) =       0.000470473543
  error estimate for blocks of size 2^( 7) =       0.000473453790

      target function =                  N/A
              le_mean =     -16.905732167731
             les_mean =     286.142635422614
             stat err =       0.000464444783
             autocorr =       1.273162031820
              std dev =       0.582112931477
             le_variance =       0.338855464993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338834443695
                                         uncertainty =       0.004141050317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338834443695
                                         uncertainty =       0.004141050317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411613462
  error estimate for blocks of size 2^( 2) =       0.000424547785
  error estimate for blocks of size 2^( 3) =       0.000438402479
  error estimate for blocks of size 2^( 4) =       0.000451076563
  error estimate for blocks of size 2^( 5) =       0.000462771234
  error estimate for blocks of size 2^( 6) =       0.000470471640
  error estimate for blocks of size 2^( 7) =       0.000473451901

      target function =                  N/A
              le_mean =     -16.905732163800
             les_mean =     286.142631108902
             stat err =       0.000464442835
             autocorr =       1.273167060209
              std dev =       0.582109340404
             le_variance =       0.338851284186


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905732163253        initial
     3.8147e+01     3.8147e+02             1.2120e-05       -16.905732172459  <--
     1.5259e+02     1.5259e+03             3.0380e-06       -16.905732167731
     6.1035e+02     6.1035e+03             7.5999e-07       -16.905732163800

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 3.2051e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.080662e-01 1 1  ON 0
 uu_1                 1.418060e-01 1 1  ON 1
 uu_2                 4.090809e-02 1 1  ON 2
 uu_3                -2.057484e-02 1 1  ON 3
 uu_4                -6.445422e-02 1 1  ON 4
 uu_5                -9.747175e-02 1 1  ON 5
 uu_6                -1.230413e-01 1 1  ON 6
 uu_7                -1.348996e-01 1 1  ON 7
 uu_8                -1.267488e-01 1 1  ON 8
 uu_9                -9.655085e-02 1 1  ON 9
 ud_0                 4.416297e-01 1 1  ON 10
 ud_1                 1.772594e-01 1 1  ON 11
 ud_2                 5.928320e-02 1 1  ON 12
 ud_3                -9.621341e-03 1 1  ON 13
 ud_4                -6.543489e-02 1 1  ON 14
 ud_5                -1.056729e-01 1 1  ON 15
 ud_6                -1.320237e-01 1 1  ON 16
 ud_7                -1.477393e-01 1 1  ON 17
 ud_8                -1.491213e-01 1 1  ON 18
 ud_9                -1.396752e-01 1 1  ON 19
 eO_0                -7.493502e-01 1 1  ON 20
 eO_1                -4.319846e-01 1 1  ON 21
 eO_2                -1.731959e-02 1 1  ON 22
 eO_3                 2.961828e-01 1 1  ON 23
 eO_4                 5.143987e-01 1 1  ON 24
 eO_5                 4.707471e-01 1 1  ON 25
 eO_6                 2.415652e-01 1 1  ON 26
 eO_7                -5.325593e-02 1 1  ON 27
 eO_8                -2.066142e-01 1 1  ON 28
 eO_9                -6.607510e-02 1 1  ON 29
eH1_0                -2.327687e-01 1 1  ON 30
eH1_1                -1.347897e-01 1 1  ON 31
eH1_2                -8.949081e-02 1 1  ON 32
eH1_3                -3.620789e-02 1 1  ON 33
eH1_4                 1.124587e-02 1 1  ON 34
eH1_5                 4.432625e-02 1 1  ON 35
eH1_6                 9.878825e-02 1 1  ON 36
eH1_7                 1.443374e-01 1 1  ON 37
eH1_8                 1.566854e-01 1 1  ON 38
eH1_9                 4.240721e-02 1 1  ON 39
eH2_0                -2.305129e-01 1 1  ON 40
eH2_1                -1.320967e-01 1 1  ON 41
eH2_2                -8.662823e-02 1 1  ON 42
eH2_3                -3.358706e-02 1 1  ON 43
eH2_4                 1.351431e-02 1 1  ON 44
eH2_5                 4.810228e-02 1 1  ON 45
eH2_6                 1.028092e-01 1 1  ON 46
eH2_7                 1.500302e-01 1 1  ON 47
eH2_8                 1.618692e-01 1 1  ON 48
eH2_9                 2.459114e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8312e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.923
    reference variance = 0.231785
====================================================
  Execution time = 2.3190e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3259e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6822e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332641446002
                                         uncertainty =       0.002671948363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332641446002
                                         uncertainty =       0.002671948363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407793501
  error estimate for blocks of size 2^( 2) =       0.000420911866
  error estimate for blocks of size 2^( 3) =       0.000434087610
  error estimate for blocks of size 2^( 4) =       0.000447008012
  error estimate for blocks of size 2^( 5) =       0.000458505222
  error estimate for blocks of size 2^( 6) =       0.000466405934
  error estimate for blocks of size 2^( 7) =       0.000474950407

      target function =                  N/A
              le_mean =     -16.905778299292
             les_mean =     286.137930816711
             stat err =       0.000461717394
             autocorr =       1.281952316069
              std dev =       0.576707099143
             le_variance =       0.332591078202


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690577829929e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905778299292       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905778326327       residual = 9.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905778486825       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905778474149       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905778551668       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905778612749       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905778611267       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905778600615       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905778593142       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 4.752060e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905778299292       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905778306158       residual = 9.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905778347288       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905778343537       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905778362030       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905778378325       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905778378189       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905778375701       residual = 9.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 1.208863e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905778299292       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905778301015       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905778311362       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905778310389       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905778314955       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905778319092       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905778319073       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905778318463       residual = 9.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 3.031442e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057002 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8893e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.080682e-01 1 1  ON 0
 uu_1                 1.418055e-01 1 1  ON 1
 uu_2                 4.090918e-02 1 1  ON 2
 uu_3                -2.057374e-02 1 1  ON 3
 uu_4                -6.445488e-02 1 1  ON 4
 uu_5                -9.747109e-02 1 1  ON 5
 uu_6                -1.230450e-01 1 1  ON 6
 uu_7                -1.349058e-01 1 1  ON 7
 uu_8                -1.267509e-01 1 1  ON 8
 uu_9                -9.655011e-02 1 1  ON 9
 ud_0                 4.416418e-01 1 1  ON 10
 ud_1                 1.772657e-01 1 1  ON 11
 ud_2                 5.928078e-02 1 1  ON 12
 ud_3                -9.627327e-03 1 1  ON 13
 ud_4                -6.543950e-02 1 1  ON 14
 ud_5                -1.056746e-01 1 1  ON 15
 ud_6                -1.320288e-01 1 1  ON 16
 ud_7                -1.477397e-01 1 1  ON 17
 ud_8                -1.491219e-01 1 1  ON 18
 ud_9                -1.396741e-01 1 1  ON 19
 eO_0                -7.493620e-01 1 1  ON 20
 eO_1                -4.319894e-01 1 1  ON 21
 eO_2                -1.731815e-02 1 1  ON 22
 eO_3                 2.961903e-01 1 1  ON 23
 eO_4                 5.144045e-01 1 1  ON 24
 eO_5                 4.707512e-01 1 1  ON 25
 eO_6                 2.415672e-01 1 1  ON 26
 eO_7                -5.325423e-02 1 1  ON 27
 eO_8                -2.066172e-01 1 1  ON 28
 eO_9                -6.607770e-02 1 1  ON 29
eH1_0                -2.327789e-01 1 1  ON 30
eH1_1                -1.347941e-01 1 1  ON 31
eH1_2                -8.948797e-02 1 1  ON 32
eH1_3                -3.620716e-02 1 1  ON 33
eH1_4                 1.124400e-02 1 1  ON 34
eH1_5                 4.433035e-02 1 1  ON 35
eH1_6                 9.878824e-02 1 1  ON 36
eH1_7                 1.443385e-01 1 1  ON 37
eH1_8                 1.566890e-01 1 1  ON 38
eH1_9                 4.241078e-02 1 1  ON 39
eH2_0                -2.305182e-01 1 1  ON 40
eH2_1                -1.321007e-01 1 1  ON 41
eH2_2                -8.663159e-02 1 1  ON 42
eH2_3                -3.358746e-02 1 1  ON 43
eH2_4                 1.351608e-02 1 1  ON 44
eH2_5                 4.810226e-02 1 1  ON 45
eH2_6                 1.028088e-01 1 1  ON 46
eH2_7                 1.500311e-01 1 1  ON 47
eH2_8                 1.618733e-01 1 1  ON 48
eH2_9                 2.459703e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8471
    reference variance = 0.443716
====================================================
  Execution time = 2.0428e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3065e-01
  Total weights = 2.0000e+06
  Execution time = 1.8661e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330675976734
                                         uncertainty =       0.002755913167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330675976734
                                         uncertainty =       0.002755913167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406593843
  error estimate for blocks of size 2^( 2) =       0.000419363494
  error estimate for blocks of size 2^( 3) =       0.000432914490
  error estimate for blocks of size 2^( 4) =       0.000445285164
  error estimate for blocks of size 2^( 5) =       0.000456375670
  error estimate for blocks of size 2^( 6) =       0.000465244305
  error estimate for blocks of size 2^( 7) =       0.000471366754

      target function =                  N/A
              le_mean =     -16.905195216020
             les_mean =     286.116262232438
             stat err =       0.000459567973
             autocorr =       1.277550027668
              std dev =       0.575010526881
             le_variance =       0.330637106024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330712567702
                                         uncertainty =       0.002756301035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330712567702
                                         uncertainty =       0.002756301035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406616335
  error estimate for blocks of size 2^( 2) =       0.000419384348
  error estimate for blocks of size 2^( 3) =       0.000432933590
  error estimate for blocks of size 2^( 4) =       0.000445302715
  error estimate for blocks of size 2^( 5) =       0.000456392146
  error estimate for blocks of size 2^( 6) =       0.000465260719
  error estimate for blocks of size 2^( 7) =       0.000471382588

      target function =                  N/A
              le_mean =     -16.905195144304
             les_mean =     286.116296389485
             stat err =       0.000459584542
             autocorr =       1.277500803953
              std dev =       0.575042335664
             le_variance =       0.330673687806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330694918952
                                         uncertainty =       0.002756112902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330694918952
                                         uncertainty =       0.002756112902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406605487
  error estimate for blocks of size 2^( 2) =       0.000419374294
  error estimate for blocks of size 2^( 3) =       0.000432924396
  error estimate for blocks of size 2^( 4) =       0.000445294286
  error estimate for blocks of size 2^( 5) =       0.000456384235
  error estimate for blocks of size 2^( 6) =       0.000465252844
  error estimate for blocks of size 2^( 7) =       0.000471375006

      target function =                  N/A
              le_mean =     -16.905195177345
             les_mean =     286.116279862161
             stat err =       0.000459576593
             autocorr =       1.277524780947
              std dev =       0.575026993607
             le_variance =       0.330656043377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330678352496
                                         uncertainty =       0.002755938216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330678352496
                                         uncertainty =       0.002755938216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406595303
  error estimate for blocks of size 2^( 2) =       0.000419364848
  error estimate for blocks of size 2^( 3) =       0.000432915732
  error estimate for blocks of size 2^( 4) =       0.000445286308
  error estimate for blocks of size 2^( 5) =       0.000456376743
  error estimate for blocks of size 2^( 6) =       0.000465245375
  error estimate for blocks of size 2^( 7) =       0.000471367789

      target function =                  N/A
              le_mean =     -16.905195211005
             les_mean =     286.116264438048
             stat err =       0.000459569054
             autocorr =       1.277546857867
              std dev =       0.575012592189
             le_variance =       0.330639481176


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905195216020        initial  <--
     9.5367e+00     9.5367e+01             4.7521e-05       -16.905195144304
     3.8147e+01     3.8147e+02             1.2089e-05       -16.905195177345
     1.5259e+02     1.5259e+03             3.0314e-06       -16.905195211005

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8745
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.080662e-01 1 1  ON 0
 uu_1                 1.418060e-01 1 1  ON 1
 uu_2                 4.090809e-02 1 1  ON 2
 uu_3                -2.057484e-02 1 1  ON 3
 uu_4                -6.445422e-02 1 1  ON 4
 uu_5                -9.747175e-02 1 1  ON 5
 uu_6                -1.230413e-01 1 1  ON 6
 uu_7                -1.348996e-01 1 1  ON 7
 uu_8                -1.267488e-01 1 1  ON 8
 uu_9                -9.655085e-02 1 1  ON 9
 ud_0                 4.416297e-01 1 1  ON 10
 ud_1                 1.772594e-01 1 1  ON 11
 ud_2                 5.928320e-02 1 1  ON 12
 ud_3                -9.621341e-03 1 1  ON 13
 ud_4                -6.543489e-02 1 1  ON 14
 ud_5                -1.056729e-01 1 1  ON 15
 ud_6                -1.320237e-01 1 1  ON 16
 ud_7                -1.477393e-01 1 1  ON 17
 ud_8                -1.491213e-01 1 1  ON 18
 ud_9                -1.396752e-01 1 1  ON 19
 eO_0                -7.493502e-01 1 1  ON 20
 eO_1                -4.319846e-01 1 1  ON 21
 eO_2                -1.731959e-02 1 1  ON 22
 eO_3                 2.961828e-01 1 1  ON 23
 eO_4                 5.143987e-01 1 1  ON 24
 eO_5                 4.707471e-01 1 1  ON 25
 eO_6                 2.415652e-01 1 1  ON 26
 eO_7                -5.325593e-02 1 1  ON 27
 eO_8                -2.066142e-01 1 1  ON 28
 eO_9                -6.607510e-02 1 1  ON 29
eH1_0                -2.327687e-01 1 1  ON 30
eH1_1                -1.347897e-01 1 1  ON 31
eH1_2                -8.949081e-02 1 1  ON 32
eH1_3                -3.620789e-02 1 1  ON 33
eH1_4                 1.124587e-02 1 1  ON 34
eH1_5                 4.432625e-02 1 1  ON 35
eH1_6                 9.878825e-02 1 1  ON 36
eH1_7                 1.443374e-01 1 1  ON 37
eH1_8                 1.566854e-01 1 1  ON 38
eH1_9                 4.240721e-02 1 1  ON 39
eH2_0                -2.305129e-01 1 1  ON 40
eH2_1                -1.320967e-01 1 1  ON 41
eH2_2                -8.662823e-02 1 1  ON 42
eH2_3                -3.358706e-02 1 1  ON 43
eH2_4                 1.351431e-02 1 1  ON 44
eH2_5                 4.810228e-02 1 1  ON 45
eH2_6                 1.028092e-01 1 1  ON 46
eH2_7                 1.500302e-01 1 1  ON 47
eH2_8                 1.618692e-01 1 1  ON 48
eH2_9                 2.459114e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8802e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.868
    reference variance = 0.316739
====================================================
  Execution time = 2.0958e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3052e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6094e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330554035675
                                         uncertainty =       0.002813380079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330554035675
                                         uncertainty =       0.002813380079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406519229
  error estimate for blocks of size 2^( 2) =       0.000419656049
  error estimate for blocks of size 2^( 3) =       0.000433201410
  error estimate for blocks of size 2^( 4) =       0.000445796066
  error estimate for blocks of size 2^( 5) =       0.000456487837
  error estimate for blocks of size 2^( 6) =       0.000463817118
  error estimate for blocks of size 2^( 7) =       0.000466049800

      target function =                  N/A
              le_mean =     -16.905346846207
             les_mean =     286.121267591955
             stat err =       0.000458037705
             autocorr =       1.269522126927
              std dev =       0.574905006645
             le_variance =       0.330515766666


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690534684621e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905346846207       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905346858651       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905346870062       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905346865980       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905346867997       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905346877383       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905346879465       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905346879085       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905346879196       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 5.265575e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905346846207       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905346849323       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905346852187       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905346851164       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905346851660       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905346854012       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905346854534       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905346854439       residual = 9.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 1.341184e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905346846207       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905346846986       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905346847703       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905346847447       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905346847572       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905346848160       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905346848289       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905346848267       residual = 9.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 3.353906e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.059833 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6575e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.080663e-01 1 1  ON 0
 uu_1                 1.418063e-01 1 1  ON 1
 uu_2                 4.090844e-02 1 1  ON 2
 uu_3                -2.057472e-02 1 1  ON 3
 uu_4                -6.445405e-02 1 1  ON 4
 uu_5                -9.747189e-02 1 1  ON 5
 uu_6                -1.230416e-01 1 1  ON 6
 uu_7                -1.349001e-01 1 1  ON 7
 uu_8                -1.267493e-01 1 1  ON 8
 uu_9                -9.655106e-02 1 1  ON 9
 ud_0                 4.416310e-01 1 1  ON 10
 ud_1                 1.772601e-01 1 1  ON 11
 ud_2                 5.928292e-02 1 1  ON 12
 ud_3                -9.622125e-03 1 1  ON 13
 ud_4                -6.543500e-02 1 1  ON 14
 ud_5                -1.056731e-01 1 1  ON 15
 ud_6                -1.320240e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491213e-01 1 1  ON 18
 ud_9                -1.396754e-01 1 1  ON 19
 eO_0                -7.493515e-01 1 1  ON 20
 eO_1                -4.319850e-01 1 1  ON 21
 eO_2                -1.731932e-02 1 1  ON 22
 eO_3                 2.961835e-01 1 1  ON 23
 eO_4                 5.143994e-01 1 1  ON 24
 eO_5                 4.707474e-01 1 1  ON 25
 eO_6                 2.415656e-01 1 1  ON 26
 eO_7                -5.325579e-02 1 1  ON 27
 eO_8                -2.066146e-01 1 1  ON 28
 eO_9                -6.607545e-02 1 1  ON 29
eH1_0                -2.327695e-01 1 1  ON 30
eH1_1                -1.347899e-01 1 1  ON 31
eH1_2                -8.949057e-02 1 1  ON 32
eH1_3                -3.620821e-02 1 1  ON 33
eH1_4                 1.124585e-02 1 1  ON 34
eH1_5                 4.432633e-02 1 1  ON 35
eH1_6                 9.878812e-02 1 1  ON 36
eH1_7                 1.443374e-01 1 1  ON 37
eH1_8                 1.566858e-01 1 1  ON 38
eH1_9                 4.240776e-02 1 1  ON 39
eH2_0                -2.305135e-01 1 1  ON 40
eH2_1                -1.320970e-01 1 1  ON 41
eH2_2                -8.662870e-02 1 1  ON 42
eH2_3                -3.358722e-02 1 1  ON 43
eH2_4                 1.351468e-02 1 1  ON 44
eH2_5                 4.810240e-02 1 1  ON 45
eH2_6                 1.028094e-01 1 1  ON 46
eH2_7                 1.500303e-01 1 1  ON 47
eH2_8                 1.618695e-01 1 1  ON 48
eH2_9                 2.459161e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9969
    reference variance = 0.315414
====================================================
  Execution time = 2.0522e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3428e-01
  Total weights = 2.0000e+06
  Execution time = 1.8613e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334233860227
                                         uncertainty =       0.004957676132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334233860227
                                         uncertainty =       0.004957676132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408826147
  error estimate for blocks of size 2^( 2) =       0.000421366835
  error estimate for blocks of size 2^( 3) =       0.000434069692
  error estimate for blocks of size 2^( 4) =       0.000446428395
  error estimate for blocks of size 2^( 5) =       0.000457054907
  error estimate for blocks of size 2^( 6) =       0.000466337933
  error estimate for blocks of size 2^( 7) =       0.000472748257

      target function =                  N/A
              le_mean =     -16.906470174446
             les_mean =     286.163011229113
             stat err =       0.000460642373
             autocorr =       1.269551848324
              std dev =       0.578167481645
             le_variance =       0.334277636832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334237775118
                                         uncertainty =       0.004957639860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334237775118
                                         uncertainty =       0.004957639860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408828541
  error estimate for blocks of size 2^( 2) =       0.000421369049
  error estimate for blocks of size 2^( 3) =       0.000434071717
  error estimate for blocks of size 2^( 4) =       0.000446430289
  error estimate for blocks of size 2^( 5) =       0.000457056647
  error estimate for blocks of size 2^( 6) =       0.000466339581
  error estimate for blocks of size 2^( 7) =       0.000472749760

      target function =                  N/A
              le_mean =     -16.906470190953
             les_mean =     286.163015702799
             stat err =       0.000460644069
             autocorr =       1.269546328155
              std dev =       0.578170867791
             le_variance =       0.334281552362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334235872161
                                         uncertainty =       0.004957659444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334235872161
                                         uncertainty =       0.004957659444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408827377
  error estimate for blocks of size 2^( 2) =       0.000421367973
  error estimate for blocks of size 2^( 3) =       0.000434070735
  error estimate for blocks of size 2^( 4) =       0.000446429373
  error estimate for blocks of size 2^( 5) =       0.000457055807
  error estimate for blocks of size 2^( 6) =       0.000466338786
  error estimate for blocks of size 2^( 7) =       0.000472749038

      target function =                  N/A
              le_mean =     -16.906470183014
             les_mean =     286.163013531110
             stat err =       0.000460643251
             autocorr =       1.269549044649
              std dev =       0.578169221861
             le_variance =       0.334279649107

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334234111775
                                         uncertainty =       0.004957674042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334234111775
                                         uncertainty =       0.004957674042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408826301
  error estimate for blocks of size 2^( 2) =       0.000421366977
  error estimate for blocks of size 2^( 3) =       0.000434069822
  error estimate for blocks of size 2^( 4) =       0.000446428517
  error estimate for blocks of size 2^( 5) =       0.000457055020
  error estimate for blocks of size 2^( 6) =       0.000466338039
  error estimate for blocks of size 2^( 7) =       0.000472748355

      target function =                  N/A
              le_mean =     -16.906470175515
             les_mean =     286.163011516868
             stat err =       0.000460642483
             autocorr =       1.269551497715
              std dev =       0.578167699221
             le_variance =       0.334277888422


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906470174446        initial
     9.5367e+01     9.5367e+02             5.2656e-06       -16.906470190953  <--
     3.8147e+02     3.8147e+03             1.3412e-06       -16.906470183014
     1.5259e+03     1.5259e+04             3.3539e-07       -16.906470175515

*****************************************************************************
Applying the update for shift_i =   9.5367e+01     and shift_s =   9.5367e+02
*****************************************************************************

  Execution time = 2.9943e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655170e-02 1 1  ON 9
 ud_0                 4.416349e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928217e-02 1 1  ON 12
 ud_3                -9.624435e-03 1 1  ON 13
 ud_4                -6.543533e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493553e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731859e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066158e-01 1 1  ON 28
 eO_9                -6.607656e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432650e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443375e-01 1 1  ON 37
eH1_8                 1.566872e-01 1 1  ON 38
eH1_9                 4.240947e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663020e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351575e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6530e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9096
    reference variance = 0.255879
====================================================
  Execution time = 2.0737e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3213e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5953e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332137225361
                                         uncertainty =       0.003169737693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332137225361
                                         uncertainty =       0.003169737693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407512466
  error estimate for blocks of size 2^( 2) =       0.000420755513
  error estimate for blocks of size 2^( 3) =       0.000433943424
  error estimate for blocks of size 2^( 4) =       0.000446224957
  error estimate for blocks of size 2^( 5) =       0.000456733297
  error estimate for blocks of size 2^( 6) =       0.000464907007
  error estimate for blocks of size 2^( 7) =       0.000469103931

      target function =                  N/A
              le_mean =     -16.906092840397
             les_mean =     286.148107781335
             stat err =       0.000459242298
             autocorr =       1.269994869901
              std dev =       0.576309655731
             le_variance =       0.332132819289


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690609284040e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906092840397       residual = 5.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906092964960       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906093067283       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906093077118       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906093100644       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906093098545       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906093101271       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906093098994       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906093099657       residual = 1.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 1.967660e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906092840397       residual = 5.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906092871721       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906092897539       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906092900094       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906092906031       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906092905497       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906092906135       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906092905555       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906092905669       residual = 1.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 4.939110e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906092840397       residual = 5.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906092848239       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906092854709       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906092855354       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906092856841       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906092856708       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906092856864       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906092856719       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906092856744       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 1.236009e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.062933 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6340e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.080667e-01 1 1  ON 0
 uu_1                 1.418069e-01 1 1  ON 1
 uu_2                 4.090985e-02 1 1  ON 2
 uu_3                -2.057380e-02 1 1  ON 3
 uu_4                -6.445334e-02 1 1  ON 4
 uu_5                -9.747274e-02 1 1  ON 5
 uu_6                -1.230448e-01 1 1  ON 6
 uu_7                -1.349026e-01 1 1  ON 7
 uu_8                -1.267511e-01 1 1  ON 8
 uu_9                -9.655124e-02 1 1  ON 9
 ud_0                 4.416399e-01 1 1  ON 10
 ud_1                 1.772656e-01 1 1  ON 11
 ud_2                 5.928119e-02 1 1  ON 12
 ud_3                -9.627306e-03 1 1  ON 13
 ud_4                -6.543626e-02 1 1  ON 14
 ud_5                -1.056754e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477402e-01 1 1  ON 17
 ud_8                -1.491223e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493600e-01 1 1  ON 20
 eO_1                -4.319865e-01 1 1  ON 21
 eO_2                -1.731749e-02 1 1  ON 22
 eO_3                 2.961877e-01 1 1  ON 23
 eO_4                 5.144029e-01 1 1  ON 24
 eO_5                 4.707498e-01 1 1  ON 25
 eO_6                 2.415678e-01 1 1  ON 26
 eO_7                -5.325462e-02 1 1  ON 27
 eO_8                -2.066173e-01 1 1  ON 28
 eO_9                -6.607770e-02 1 1  ON 29
eH1_0                -2.327752e-01 1 1  ON 30
eH1_1                -1.347921e-01 1 1  ON 31
eH1_2                -8.949004e-02 1 1  ON 32
eH1_3                -3.620957e-02 1 1  ON 33
eH1_4                 1.124648e-02 1 1  ON 34
eH1_5                 4.432670e-02 1 1  ON 35
eH1_6                 9.878776e-02 1 1  ON 36
eH1_7                 1.443379e-01 1 1  ON 37
eH1_8                 1.566891e-01 1 1  ON 38
eH1_9                 4.241152e-02 1 1  ON 39
eH2_0                -2.305182e-01 1 1  ON 40
eH2_1                -1.320998e-01 1 1  ON 41
eH2_2                -8.663104e-02 1 1  ON 42
eH2_3                -3.358736e-02 1 1  ON 43
eH2_4                 1.351760e-02 1 1  ON 44
eH2_5                 4.810218e-02 1 1  ON 45
eH2_6                 1.028093e-01 1 1  ON 46
eH2_7                 1.500305e-01 1 1  ON 47
eH2_8                 1.618723e-01 1 1  ON 48
eH2_9                 2.459561e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9362
    reference variance = 0.201153
====================================================
  Execution time = 2.0113e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2915e-01
  Total weights = 2.0000e+06
  Execution time = 1.8633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329147983949
                                         uncertainty =       0.002454820887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329147983949
                                         uncertainty =       0.002454820887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405676073
  error estimate for blocks of size 2^( 2) =       0.000418736634
  error estimate for blocks of size 2^( 3) =       0.000432276983
  error estimate for blocks of size 2^( 4) =       0.000445146932
  error estimate for blocks of size 2^( 5) =       0.000457617716
  error estimate for blocks of size 2^( 6) =       0.000465723197
  error estimate for blocks of size 2^( 7) =       0.000471305475

      target function =                  N/A
              le_mean =     -16.905076597115
             les_mean =     286.110760742143
             stat err =       0.000459948330
             autocorr =       1.285462184540
              std dev =       0.573712604365
             le_variance =       0.329146152407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329162246629
                                         uncertainty =       0.002454891916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329162246629
                                         uncertainty =       0.002454891916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405684859
  error estimate for blocks of size 2^( 2) =       0.000418744660
  error estimate for blocks of size 2^( 3) =       0.000432284219
  error estimate for blocks of size 2^( 4) =       0.000445153522
  error estimate for blocks of size 2^( 5) =       0.000457623914
  error estimate for blocks of size 2^( 6) =       0.000465729135
  error estimate for blocks of size 2^( 7) =       0.000471311189

      target function =                  N/A
              le_mean =     -16.905076589092
             les_mean =     286.110774728357
             stat err =       0.000459954440
             autocorr =       1.285440658337
              std dev =       0.573725029833
             le_variance =       0.329160409857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329155148352
                                         uncertainty =       0.002454856507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329155148352
                                         uncertainty =       0.002454856507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405680486
  error estimate for blocks of size 2^( 2) =       0.000418740664
  error estimate for blocks of size 2^( 3) =       0.000432280615
  error estimate for blocks of size 2^( 4) =       0.000445150239
  error estimate for blocks of size 2^( 5) =       0.000457620826
  error estimate for blocks of size 2^( 6) =       0.000465726175
  error estimate for blocks of size 2^( 7) =       0.000471308340

      target function =                  N/A
              le_mean =     -16.905076592966
             les_mean =     286.110767763643
             stat err =       0.000459951395
             autocorr =       1.285451348510
              std dev =       0.573718845930
             le_variance =       0.329153314175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329148880392
                                         uncertainty =       0.002454825343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329148880392
                                         uncertainty =       0.002454825343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405676625
  error estimate for blocks of size 2^( 2) =       0.000418737138
  error estimate for blocks of size 2^( 3) =       0.000432277437
  error estimate for blocks of size 2^( 4) =       0.000445147346
  error estimate for blocks of size 2^( 5) =       0.000457618105
  error estimate for blocks of size 2^( 6) =       0.000465723569
  error estimate for blocks of size 2^( 7) =       0.000471305833

      target function =                  N/A
              le_mean =     -16.905076596566
             les_mean =     286.110761619721
             stat err =       0.000459948713
             autocorr =       1.285460827641
              std dev =       0.573713385341
             le_variance =       0.329147048520


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905076597115        initial  <--
     2.3842e+01     2.3842e+02             1.9677e-05       -16.905076589092
     9.5367e+01     9.5367e+02             4.9391e-06       -16.905076592966
     3.8147e+02     3.8147e+03             1.2360e-06       -16.905076596566

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5615
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655170e-02 1 1  ON 9
 ud_0                 4.416349e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928217e-02 1 1  ON 12
 ud_3                -9.624435e-03 1 1  ON 13
 ud_4                -6.543533e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493553e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731859e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066158e-01 1 1  ON 28
 eO_9                -6.607656e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432650e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443375e-01 1 1  ON 37
eH1_8                 1.566872e-01 1 1  ON 38
eH1_9                 4.240947e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663020e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351575e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5908e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9303
    reference variance = 0.24433
====================================================
  Execution time = 2.0658e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4133e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341449308541
                                         uncertainty =       0.004407708390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341449308541
                                         uncertainty =       0.004407708390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413115441
  error estimate for blocks of size 2^( 2) =       0.000426077312
  error estimate for blocks of size 2^( 3) =       0.000439725741
  error estimate for blocks of size 2^( 4) =       0.000452200562
  error estimate for blocks of size 2^( 5) =       0.000463671614
  error estimate for blocks of size 2^( 6) =       0.000472148541
  error estimate for blocks of size 2^( 7) =       0.000479595099

      target function =                  N/A
              le_mean =     -16.905091387957
             les_mean =     286.123443399637
             stat err =       0.000466903954
             autocorr =       1.277356868754
              std dev =       0.584233459434
             le_variance =       0.341328735122


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690509138796e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905091387957       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905091391416       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905091402571       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905091404254       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905091405794       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905091406714       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905091404923       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905091404691       residual = 8.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.961754e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905091387957       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905091388822       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905091391613       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905091392034       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905091392425       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905091392648       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905091392202       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905091392143       residual = 8.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 4.905980e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905091387957       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905091388173       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905091388871       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905091388977       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905091389074       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905091389130       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905091389017       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905091389006       residual = 8.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 1.226595e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.065617 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6219e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.080663e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057432e-02 1 1  ON 3
 uu_4                -6.445348e-02 1 1  ON 4
 uu_5                -9.747231e-02 1 1  ON 5
 uu_6                -1.230424e-01 1 1  ON 6
 uu_7                -1.349015e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655169e-02 1 1  ON 9
 ud_0                 4.416354e-01 1 1  ON 10
 ud_1                 1.772625e-01 1 1  ON 11
 ud_2                 5.928204e-02 1 1  ON 12
 ud_3                -9.624690e-03 1 1  ON 13
 ud_4                -6.543554e-02 1 1  ON 14
 ud_5                -1.056737e-01 1 1  ON 15
 ud_6                -1.320251e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491214e-01 1 1  ON 18
 ud_9                -1.396758e-01 1 1  ON 19
 eO_0                -7.493558e-01 1 1  ON 20
 eO_1                -4.319863e-01 1 1  ON 21
 eO_2                -1.731847e-02 1 1  ON 22
 eO_3                 2.961857e-01 1 1  ON 23
 eO_4                 5.144018e-01 1 1  ON 24
 eO_5                 4.707485e-01 1 1  ON 25
 eO_6                 2.415669e-01 1 1  ON 26
 eO_7                -5.325528e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607668e-02 1 1  ON 29
eH1_0                -2.327721e-01 1 1  ON 30
eH1_1                -1.347907e-01 1 1  ON 31
eH1_2                -8.948985e-02 1 1  ON 32
eH1_3                -3.620921e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432653e-02 1 1  ON 35
eH1_6                 9.878787e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566874e-01 1 1  ON 38
eH1_9                 4.240965e-02 1 1  ON 39
eH2_0                -2.305155e-01 1 1  ON 40
eH2_1                -1.320980e-01 1 1  ON 41
eH2_2                -8.663026e-02 1 1  ON 42
eH2_3                -3.358782e-02 1 1  ON 43
eH2_4                 1.351572e-02 1 1  ON 44
eH2_5                 4.810261e-02 1 1  ON 45
eH2_6                 1.028101e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618708e-01 1 1  ON 48
eH2_9                 2.459342e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9396
    reference variance = 0.214972
====================================================
  Execution time = 2.0088e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3979e-01
  Total weights = 2.0000e+06
  Execution time = 1.8674e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339844920676
                                         uncertainty =       0.004731767081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339844920676
                                         uncertainty =       0.004731767081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412182366
  error estimate for blocks of size 2^( 2) =       0.000425257596
  error estimate for blocks of size 2^( 3) =       0.000439078637
  error estimate for blocks of size 2^( 4) =       0.000451978101
  error estimate for blocks of size 2^( 5) =       0.000463380464
  error estimate for blocks of size 2^( 6) =       0.000469817580
  error estimate for blocks of size 2^( 7) =       0.000476289746

      target function =                  N/A
              le_mean =     -16.904868793928
             les_mean =     286.114377375687
             stat err =       0.000465366473
             autocorr =       1.274709924927
              std dev =       0.582913892138
             le_variance =       0.339788605647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339846456418
                                         uncertainty =       0.004731769024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339846456418
                                         uncertainty =       0.004731769024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412183298
  error estimate for blocks of size 2^( 2) =       0.000425258461
  error estimate for blocks of size 2^( 3) =       0.000439079442
  error estimate for blocks of size 2^( 4) =       0.000451978852
  error estimate for blocks of size 2^( 5) =       0.000463381172
  error estimate for blocks of size 2^( 6) =       0.000469818265
  error estimate for blocks of size 2^( 7) =       0.000476290404

      target function =                  N/A
              le_mean =     -16.904868786072
             les_mean =     286.114378645938
             stat err =       0.000465367173
             autocorr =       1.274708000461
              std dev =       0.582915209534
             le_variance =       0.339790141506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339845689032
                                         uncertainty =       0.004731768052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339845689032
                                         uncertainty =       0.004731768052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412182832
  error estimate for blocks of size 2^( 2) =       0.000425258029
  error estimate for blocks of size 2^( 3) =       0.000439079040
  error estimate for blocks of size 2^( 4) =       0.000451978477
  error estimate for blocks of size 2^( 5) =       0.000463380819
  error estimate for blocks of size 2^( 6) =       0.000469817923
  error estimate for blocks of size 2^( 7) =       0.000476290075

      target function =                  N/A
              le_mean =     -16.904868789996
             les_mean =     286.114378011132
             stat err =       0.000465366823
             autocorr =       1.274708962016
              std dev =       0.582914551252
             le_variance =       0.339789374061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339845016735
                                         uncertainty =       0.004731767202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339845016735
                                         uncertainty =       0.004731767202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412182424
  error estimate for blocks of size 2^( 2) =       0.000425257650
  error estimate for blocks of size 2^( 3) =       0.000439078687
  error estimate for blocks of size 2^( 4) =       0.000451978148
  error estimate for blocks of size 2^( 5) =       0.000463380509
  error estimate for blocks of size 2^( 6) =       0.000469817622
  error estimate for blocks of size 2^( 7) =       0.000476289787

      target function =                  N/A
              le_mean =     -16.904868793436
             les_mean =     286.114377455121
             stat err =       0.000465366517
             autocorr =       1.274709804545
              std dev =       0.582913974539
             le_variance =       0.339788701713


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904868793928        initial  <--
     2.3842e+02     2.3842e+03             1.9618e-06       -16.904868786072
     9.5367e+02     9.5367e+03             4.9060e-07       -16.904868789996
     3.8147e+03     3.8147e+04             1.2266e-07       -16.904868793436

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5432
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655170e-02 1 1  ON 9
 ud_0                 4.416349e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928217e-02 1 1  ON 12
 ud_3                -9.624435e-03 1 1  ON 13
 ud_4                -6.543533e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493553e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731859e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066158e-01 1 1  ON 28
 eO_9                -6.607656e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432650e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443375e-01 1 1  ON 37
eH1_8                 1.566872e-01 1 1  ON 38
eH1_9                 4.240947e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663020e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351575e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5769e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8876
    reference variance = 0.141713
====================================================
  Execution time = 2.0615e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3891e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5661e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338791506921
                                         uncertainty =       0.006776665273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338791506921
                                         uncertainty =       0.006776665273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411646600
  error estimate for blocks of size 2^( 2) =       0.000424330806
  error estimate for blocks of size 2^( 3) =       0.000437553239
  error estimate for blocks of size 2^( 4) =       0.000449701493
  error estimate for blocks of size 2^( 5) =       0.000460029013
  error estimate for blocks of size 2^( 6) =       0.000469319317
  error estimate for blocks of size 2^( 7) =       0.000474250715

      target function =                  N/A
              le_mean =     -16.906162936791
             les_mean =     286.157250921893
             stat err =       0.000463325134
             autocorr =       1.266842592315
              std dev =       0.582156204134
             le_variance =       0.338905846011


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690616293679e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906162936791       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906162937742       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906162938001       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906162938270       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906162938511       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906162938679       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906162938643       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906162938654       residual = 7.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 2.141765e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906162936791       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906162937029       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906162937094       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906162937160       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906162937221       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906162937261       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906162937255       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906162937254       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 5.354675e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906162936791       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906162936851       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906162936867       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906162936884       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906162936905       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906162936932       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906162936913       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906162936886       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 1.338685e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068150 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6192e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747226e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655171e-02 1 1  ON 9
 ud_0                 4.416350e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928216e-02 1 1  ON 12
 ud_3                -9.624458e-03 1 1  ON 13
 ud_4                -6.543534e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493554e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731857e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607658e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620914e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432651e-02 1 1  ON 35
eH1_6                 9.878777e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240949e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663021e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351575e-02 1 1  ON 44
eH2_5                 4.810274e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459312e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9074
    reference variance = 0.278636
====================================================
  Execution time = 2.2698e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3176e-01
  Total weights = 2.0000e+06
  Execution time = 1.8621e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331763325037
                                         uncertainty =       0.004554903618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331763325037
                                         uncertainty =       0.004554903618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407284695
  error estimate for blocks of size 2^( 2) =       0.000420690797
  error estimate for blocks of size 2^( 3) =       0.000434514137
  error estimate for blocks of size 2^( 4) =       0.000447313741
  error estimate for blocks of size 2^( 5) =       0.000459598348
  error estimate for blocks of size 2^( 6) =       0.000468606212
  error estimate for blocks of size 2^( 7) =       0.000473504310

      target function =                  N/A
              le_mean =     -16.905853751102
             les_mean =     286.139652534138
             stat err =       0.000462255653
             autocorr =       1.288155461728
              std dev =       0.575987540113
             le_variance =       0.331761646366

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331763444765
                                         uncertainty =       0.004554905357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331763444765
                                         uncertainty =       0.004554905357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407284769
  error estimate for blocks of size 2^( 2) =       0.000420690865
  error estimate for blocks of size 2^( 3) =       0.000434514198
  error estimate for blocks of size 2^( 4) =       0.000447313799
  error estimate for blocks of size 2^( 5) =       0.000459598404
  error estimate for blocks of size 2^( 6) =       0.000468606266
  error estimate for blocks of size 2^( 7) =       0.000473504363

      target function =                  N/A
              le_mean =     -16.905853750616
             les_mean =     286.139652637453
             stat err =       0.000462255708
             autocorr =       1.288155305353
              std dev =       0.575987644064
             le_variance =       0.331761766114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331763384902
                                         uncertainty =       0.004554904488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331763384902
                                         uncertainty =       0.004554904488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407284732
  error estimate for blocks of size 2^( 2) =       0.000420690831
  error estimate for blocks of size 2^( 3) =       0.000434514168
  error estimate for blocks of size 2^( 4) =       0.000447313770
  error estimate for blocks of size 2^( 5) =       0.000459598376
  error estimate for blocks of size 2^( 6) =       0.000468606239
  error estimate for blocks of size 2^( 7) =       0.000473504336

      target function =                  N/A
              le_mean =     -16.905853750859
             les_mean =     286.139652585796
             stat err =       0.000462255680
             autocorr =       1.288155383535
              std dev =       0.575987592090
             le_variance =       0.331761706241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331763332520
                                         uncertainty =       0.004554903727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331763332520
                                         uncertainty =       0.004554903727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407284700
  error estimate for blocks of size 2^( 2) =       0.000420690801
  error estimate for blocks of size 2^( 3) =       0.000434514141
  error estimate for blocks of size 2^( 4) =       0.000447313745
  error estimate for blocks of size 2^( 5) =       0.000459598351
  error estimate for blocks of size 2^( 6) =       0.000468606215
  error estimate for blocks of size 2^( 7) =       0.000473504313

      target function =                  N/A
              le_mean =     -16.905853751072
             les_mean =     286.139652540596
             stat err =       0.000462255656
             autocorr =       1.288155451948
              std dev =       0.575987546611
             le_variance =       0.331761653850


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905853751102        initial  <--
     2.3842e+03     2.3842e+04             2.1418e-07       -16.905853750616
     9.5367e+03     9.5367e+04             5.3547e-08       -16.905853750859
     3.8147e+04     3.8147e+05             1.3387e-08       -16.905853751072

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.1175
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655170e-02 1 1  ON 9
 ud_0                 4.416349e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928217e-02 1 1  ON 12
 ud_3                -9.624435e-03 1 1  ON 13
 ud_4                -6.543533e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493553e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731859e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066158e-01 1 1  ON 28
 eO_9                -6.607656e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432650e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443375e-01 1 1  ON 37
eH1_8                 1.566872e-01 1 1  ON 38
eH1_9                 4.240947e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663020e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351575e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8323e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9145
    reference variance = 0.232462
====================================================
  Execution time = 2.0589e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3909e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7603e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339148831436
                                         uncertainty =       0.003955036455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339148831436
                                         uncertainty =       0.003955036455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411758965
  error estimate for blocks of size 2^( 2) =       0.000424802934
  error estimate for blocks of size 2^( 3) =       0.000438632494
  error estimate for blocks of size 2^( 4) =       0.000451117939
  error estimate for blocks of size 2^( 5) =       0.000461558208
  error estimate for blocks of size 2^( 6) =       0.000470095876
  error estimate for blocks of size 2^( 7) =       0.000474386881

      target function =                  N/A
              le_mean =     -16.906119540083
             les_mean =     286.155968624186
             stat err =       0.000464289726
             autocorr =       1.271428727591
              std dev =       0.582315112431
             le_variance =       0.339090890166


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611954008e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906119540083       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906119540122       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906119540152       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906119540161       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906119540161       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906119540126       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906119540170       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906119540165       residual = 9.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 2.415065e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906119540083       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906119540092       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906119540100       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906119540103       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906119540059       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906119540006       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906119540108       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906119540045       residual = 9.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 6.037691e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906119540083       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906119540085       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906119540087       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906119540088       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906119540058       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906119540243       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906119540051       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906119540092       residual = 9.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 1.509424e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.070774 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8188e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655170e-02 1 1  ON 9
 ud_0                 4.416349e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928217e-02 1 1  ON 12
 ud_3                -9.624438e-03 1 1  ON 13
 ud_4                -6.543533e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493553e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731859e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607656e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432650e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443375e-01 1 1  ON 37
eH1_8                 1.566872e-01 1 1  ON 38
eH1_9                 4.240947e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663020e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351575e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8727
    reference variance = 0.228365
====================================================
  Execution time = 2.0346e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3104e-01
  Total weights = 2.0000e+06
  Execution time = 1.8717e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331053028309
                                         uncertainty =       0.002713338309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331053028309
                                         uncertainty =       0.002713338309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406842465
  error estimate for blocks of size 2^( 2) =       0.000420157284
  error estimate for blocks of size 2^( 3) =       0.000433457317
  error estimate for blocks of size 2^( 4) =       0.000445545664
  error estimate for blocks of size 2^( 5) =       0.000456104868
  error estimate for blocks of size 2^( 6) =       0.000463722098
  error estimate for blocks of size 2^( 7) =       0.000469873788

      target function =                  N/A
              le_mean =     -16.905723088011
             les_mean =     286.134514546417
             stat err =       0.000458811605
             autocorr =       1.271792421280
              std dev =       0.575362132425
             le_variance =       0.331041583428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331053042283
                                         uncertainty =       0.002713338380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331053042283
                                         uncertainty =       0.002713338380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406842474
  error estimate for blocks of size 2^( 2) =       0.000420157292
  error estimate for blocks of size 2^( 3) =       0.000433457325
  error estimate for blocks of size 2^( 4) =       0.000445545671
  error estimate for blocks of size 2^( 5) =       0.000456104875
  error estimate for blocks of size 2^( 6) =       0.000463722105
  error estimate for blocks of size 2^( 7) =       0.000469873794

      target function =                  N/A
              le_mean =     -16.905723087935
             les_mean =     286.134514557825
             stat err =       0.000458811611
             autocorr =       1.271792404891
              std dev =       0.575362144564
             le_variance =       0.331041597397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331053035296
                                         uncertainty =       0.002713338345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331053035296
                                         uncertainty =       0.002713338345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406842470
  error estimate for blocks of size 2^( 2) =       0.000420157288
  error estimate for blocks of size 2^( 3) =       0.000433457321
  error estimate for blocks of size 2^( 4) =       0.000445545667
  error estimate for blocks of size 2^( 5) =       0.000456104872
  error estimate for blocks of size 2^( 6) =       0.000463722101
  error estimate for blocks of size 2^( 7) =       0.000469873791

      target function =                  N/A
              le_mean =     -16.905723087973
             les_mean =     286.134514552121
             stat err =       0.000458811608
             autocorr =       1.271792413081
              std dev =       0.575362138494
             le_variance =       0.331041590413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331053029183
                                         uncertainty =       0.002713338314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331053029183
                                         uncertainty =       0.002713338314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406842466
  error estimate for blocks of size 2^( 2) =       0.000420157285
  error estimate for blocks of size 2^( 3) =       0.000433457318
  error estimate for blocks of size 2^( 4) =       0.000445545664
  error estimate for blocks of size 2^( 5) =       0.000456104869
  error estimate for blocks of size 2^( 6) =       0.000463722099
  error estimate for blocks of size 2^( 7) =       0.000469873788

      target function =                  N/A
              le_mean =     -16.905723088006
             les_mean =     286.134514547130
             stat err =       0.000458811605
             autocorr =       1.271792420259
              std dev =       0.575362133183
             le_variance =       0.331041584301


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905723088011        initial  <--
     2.3842e+04     2.3842e+05             2.4151e-08       -16.905723087935
     9.5367e+04     9.5367e+05             6.0377e-09       -16.905723087973
     3.8147e+05     3.8147e+06             1.5094e-09       -16.905723088006

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8050
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655170e-02 1 1  ON 9
 ud_0                 4.416349e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928217e-02 1 1  ON 12
 ud_3                -9.624435e-03 1 1  ON 13
 ud_4                -6.543533e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493553e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731859e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066158e-01 1 1  ON 28
 eO_9                -6.607656e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432650e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443375e-01 1 1  ON 37
eH1_8                 1.566872e-01 1 1  ON 38
eH1_9                 4.240947e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663020e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351575e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8000e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8769
    reference variance = 0.130659
====================================================
  Execution time = 2.0537e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4478e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5553e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344877348791
                                         uncertainty =       0.004438887899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344877348791
                                         uncertainty =       0.004438887899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415200293
  error estimate for blocks of size 2^( 2) =       0.000427550624
  error estimate for blocks of size 2^( 3) =       0.000440292906
  error estimate for blocks of size 2^( 4) =       0.000453009822
  error estimate for blocks of size 2^( 5) =       0.000464895963
  error estimate for blocks of size 2^( 6) =       0.000472852957
  error estimate for blocks of size 2^( 7) =       0.000478456144

      target function =                  N/A
              le_mean =     -16.906511011472
             les_mean =     286.174896975162
             stat err =       0.000467303721
             autocorr =       1.266727434718
              std dev =       0.587181885376
             le_variance =       0.344782566514


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690651101147e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906511011472       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906511011478       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906511011473       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906511011470       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906511011472       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906511011564       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906511011415       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906511012239       residual = 8.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 2.496772e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906511011472       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906511011474       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906511011473       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906511011421       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906511011163       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906511011630       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906511011432       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906511010413       residual = 8.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 6.241934e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906511011472       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906511011473       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906511011472       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906511011472       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906511010684       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906511013057       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906511012136       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906511012221       residual = 8.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 1.560482e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.073398 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6100e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655170e-02 1 1  ON 9
 ud_0                 4.416349e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928217e-02 1 1  ON 12
 ud_3                -9.624436e-03 1 1  ON 13
 ud_4                -6.543533e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493553e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731859e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066158e-01 1 1  ON 28
 eO_9                -6.607656e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432650e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443375e-01 1 1  ON 37
eH1_8                 1.566872e-01 1 1  ON 38
eH1_9                 4.240947e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663020e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351575e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8687
    reference variance = 0.22571
====================================================
  Execution time = 2.0428e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3555e-01
  Total weights = 2.0000e+06
  Execution time = 1.8752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335596079024
                                         uncertainty =       0.002820089740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335596079024
                                         uncertainty =       0.002820089740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409600570
  error estimate for blocks of size 2^( 2) =       0.000422714894
  error estimate for blocks of size 2^( 3) =       0.000436834984
  error estimate for blocks of size 2^( 4) =       0.000449870025
  error estimate for blocks of size 2^( 5) =       0.000461128447
  error estimate for blocks of size 2^( 6) =       0.000470107325
  error estimate for blocks of size 2^( 7) =       0.000476976994

      target function =                  N/A
              le_mean =     -16.905822712952
             les_mean =     286.142386687269
             stat err =       0.000464520698
             autocorr =       1.286142340191
              std dev =       0.579262680722
             le_variance =       0.335545253277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335596080346
                                         uncertainty =       0.002820089756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335596080346
                                         uncertainty =       0.002820089756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409600570
  error estimate for blocks of size 2^( 2) =       0.000422714894
  error estimate for blocks of size 2^( 3) =       0.000436834985
  error estimate for blocks of size 2^( 4) =       0.000449870026
  error estimate for blocks of size 2^( 5) =       0.000461128448
  error estimate for blocks of size 2^( 6) =       0.000470107325
  error estimate for blocks of size 2^( 7) =       0.000476976995

      target function =                  N/A
              le_mean =     -16.905822712950
             les_mean =     286.142386688516
             stat err =       0.000464520698
             autocorr =       1.286142338512
              std dev =       0.579262681863
             le_variance =       0.335545254599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335596079685
                                         uncertainty =       0.002820089748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335596079685
                                         uncertainty =       0.002820089748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409600570
  error estimate for blocks of size 2^( 2) =       0.000422714894
  error estimate for blocks of size 2^( 3) =       0.000436834985
  error estimate for blocks of size 2^( 4) =       0.000449870025
  error estimate for blocks of size 2^( 5) =       0.000461128448
  error estimate for blocks of size 2^( 6) =       0.000470107325
  error estimate for blocks of size 2^( 7) =       0.000476976994

      target function =                  N/A
              le_mean =     -16.905822712951
             les_mean =     286.142386687892
             stat err =       0.000464520698
             autocorr =       1.286142339357
              std dev =       0.579262681292
             le_variance =       0.335545253938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335596079107
                                         uncertainty =       0.002820089741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335596079107
                                         uncertainty =       0.002820089741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409600570
  error estimate for blocks of size 2^( 2) =       0.000422714894
  error estimate for blocks of size 2^( 3) =       0.000436834984
  error estimate for blocks of size 2^( 4) =       0.000449870025
  error estimate for blocks of size 2^( 5) =       0.000461128447
  error estimate for blocks of size 2^( 6) =       0.000470107325
  error estimate for blocks of size 2^( 7) =       0.000476976994

      target function =                  N/A
              le_mean =     -16.905822712952
             les_mean =     286.142386687347
             stat err =       0.000464520698
             autocorr =       1.286142340090
              std dev =       0.579262680793
             le_variance =       0.335545253359


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905822712952        initial  <--
     2.3842e+05     2.3842e+06             2.4968e-09       -16.905822712950
     9.5367e+05     9.5367e+06             6.2419e-10       -16.905822712951
     3.8147e+06     3.8147e+07             1.5605e-10       -16.905822712952

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9160
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655170e-02 1 1  ON 9
 ud_0                 4.416349e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928217e-02 1 1  ON 12
 ud_3                -9.624435e-03 1 1  ON 13
 ud_4                -6.543533e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493553e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731859e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066158e-01 1 1  ON 28
 eO_9                -6.607656e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432650e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443375e-01 1 1  ON 37
eH1_8                 1.566872e-01 1 1  ON 38
eH1_9                 4.240947e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663020e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351575e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6058e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8674
    reference variance = 0.287402
====================================================
  Execution time = 2.0556e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3641e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5462e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336389344144
                                         uncertainty =       0.008630801926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336389344144
                                         uncertainty =       0.008630801926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410126360
  error estimate for blocks of size 2^( 2) =       0.000422965843
  error estimate for blocks of size 2^( 3) =       0.000436616049
  error estimate for blocks of size 2^( 4) =       0.000449548742
  error estimate for blocks of size 2^( 5) =       0.000461539108
  error estimate for blocks of size 2^( 6) =       0.000470241456
  error estimate for blocks of size 2^( 7) =       0.000476422284

      target function =                  N/A
              le_mean =     -16.904877110485
             les_mean =     286.111277215474
             stat err =       0.000464437898
             autocorr =       1.282389439175
              std dev =       0.580006261228
             le_variance =       0.336407263064


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690487711049e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904877110485       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904877110485       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904877110485       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904877110278       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904877110486       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904877110323       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904877108549       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904877112113       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904877110470       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 2.073668e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904877110485       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904877110485       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904877110485       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904877112160       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904877113989       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904877107370       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904877111916       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904877103184       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904877108674       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 5.184176e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904877110485       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904877110485       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904877110485       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904877108259       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904877107937       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904877072683       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904877107517       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904877143936       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904877068772       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 1.296041e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076463 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6110e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655170e-02 1 1  ON 9
 ud_0                 4.416349e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928217e-02 1 1  ON 12
 ud_3                -9.624435e-03 1 1  ON 13
 ud_4                -6.543533e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493553e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731859e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066158e-01 1 1  ON 28
 eO_9                -6.607656e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432650e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443375e-01 1 1  ON 37
eH1_8                 1.566872e-01 1 1  ON 38
eH1_9                 4.240947e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663020e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351575e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8892
    reference variance = 0.287995
====================================================
  Execution time = 2.0340e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3823e-01
  Total weights = 2.0000e+06
  Execution time = 1.8670e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338212164926
                                         uncertainty =       0.003585573947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338212164926
                                         uncertainty =       0.003585573947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411234999
  error estimate for blocks of size 2^( 2) =       0.000423880197
  error estimate for blocks of size 2^( 3) =       0.000436594390
  error estimate for blocks of size 2^( 4) =       0.000448591832
  error estimate for blocks of size 2^( 5) =       0.000458724224
  error estimate for blocks of size 2^( 6) =       0.000466911801
  error estimate for blocks of size 2^( 7) =       0.000472748153

      target function =                  N/A
              le_mean =     -16.906436495021
             les_mean =     286.165823240352
             stat err =       0.000461744002
             autocorr =       1.260730871521
              std dev =       0.581574113319
             le_variance =       0.338228449283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338212165111
                                         uncertainty =       0.003585573949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338212165111
                                         uncertainty =       0.003585573949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411234999
  error estimate for blocks of size 2^( 2) =       0.000423880197
  error estimate for blocks of size 2^( 3) =       0.000436594390
  error estimate for blocks of size 2^( 4) =       0.000448591832
  error estimate for blocks of size 2^( 5) =       0.000458724224
  error estimate for blocks of size 2^( 6) =       0.000466911801
  error estimate for blocks of size 2^( 7) =       0.000472748153

      target function =                  N/A
              le_mean =     -16.906436495021
             les_mean =     286.165823240529
             stat err =       0.000461744003
             autocorr =       1.260730871285
              std dev =       0.581574113479
             le_variance =       0.338228449468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338212165018
                                         uncertainty =       0.003585573948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338212165018
                                         uncertainty =       0.003585573948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411234999
  error estimate for blocks of size 2^( 2) =       0.000423880197
  error estimate for blocks of size 2^( 3) =       0.000436594390
  error estimate for blocks of size 2^( 4) =       0.000448591832
  error estimate for blocks of size 2^( 5) =       0.000458724224
  error estimate for blocks of size 2^( 6) =       0.000466911801
  error estimate for blocks of size 2^( 7) =       0.000472748153

      target function =                  N/A
              le_mean =     -16.906436495021
             les_mean =     286.165823240440
             stat err =       0.000461744003
             autocorr =       1.260730871401
              std dev =       0.581574113399
             le_variance =       0.338228449376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338212164937
                                         uncertainty =       0.003585573947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338212164937
                                         uncertainty =       0.003585573947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411234999
  error estimate for blocks of size 2^( 2) =       0.000423880197
  error estimate for blocks of size 2^( 3) =       0.000436594390
  error estimate for blocks of size 2^( 4) =       0.000448591832
  error estimate for blocks of size 2^( 5) =       0.000458724224
  error estimate for blocks of size 2^( 6) =       0.000466911801
  error estimate for blocks of size 2^( 7) =       0.000472748153

      target function =                  N/A
              le_mean =     -16.906436495021
             les_mean =     286.165823240363
             stat err =       0.000461744002
             autocorr =       1.260730871494
              std dev =       0.581574113329
             le_variance =       0.338228449295


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906436495021        initial  <--
     2.3842e+06     2.3842e+07             2.0737e-10       -16.906436495021
     9.5367e+06     9.5367e+07             5.1842e-11       -16.906436495021
     3.8147e+07     3.8147e+08             1.2960e-11       -16.906436495021

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7803
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655170e-02 1 1  ON 9
 ud_0                 4.416349e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928217e-02 1 1  ON 12
 ud_3                -9.624435e-03 1 1  ON 13
 ud_4                -6.543533e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493553e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731859e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066158e-01 1 1  ON 28
 eO_9                -6.607656e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432650e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443375e-01 1 1  ON 37
eH1_8                 1.566872e-01 1 1  ON 38
eH1_9                 4.240947e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663020e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351575e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5897e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8971
    reference variance = 0.23915
====================================================
  Execution time = 2.0649e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3971e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5171e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339746319642
                                         uncertainty =       0.003900163269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339746319642
                                         uncertainty =       0.003900163269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412136435
  error estimate for blocks of size 2^( 2) =       0.000424679656
  error estimate for blocks of size 2^( 3) =       0.000437392318
  error estimate for blocks of size 2^( 4) =       0.000449470330
  error estimate for blocks of size 2^( 5) =       0.000459041912
  error estimate for blocks of size 2^( 6) =       0.000465410409
  error estimate for blocks of size 2^( 7) =       0.000468329431

      target function =                  N/A
              le_mean =     -16.905797136457
             les_mean =     286.145689531511
             stat err =       0.000460563021
             autocorr =       1.248809257255
              std dev =       0.582848936123
             le_variance =       0.339712882340


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690579713646e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905797136457       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905797136457       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905797136457       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905797152655       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905797133544       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905797151104       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905797139556       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905797133405       residual = 7.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 2.286448e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905797136457       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905797136457       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905797136457       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905797136457       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905797139962       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905797084847       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905797193618       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905796813038       residual = 7.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 5.716214e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905797136457       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905797136457       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905797136457       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905797154107       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905796941252       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905797083372       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905797516617       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905797558590       residual = 7.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 1.428815e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.079068 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6174e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655170e-02 1 1  ON 9
 ud_0                 4.416349e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928217e-02 1 1  ON 12
 ud_3                -9.624435e-03 1 1  ON 13
 ud_4                -6.543533e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493553e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731859e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066158e-01 1 1  ON 28
 eO_9                -6.607656e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432650e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443375e-01 1 1  ON 37
eH1_8                 1.566872e-01 1 1  ON 38
eH1_9                 4.240947e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663020e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351575e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9077
    reference variance = 0.17694
====================================================
  Execution time = 2.0361e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3539e-01
  Total weights = 2.0000e+06
  Execution time = 1.8643e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335442190465
                                         uncertainty =       0.002833963238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335442190465
                                         uncertainty =       0.002833963238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409507038
  error estimate for blocks of size 2^( 2) =       0.000422432284
  error estimate for blocks of size 2^( 3) =       0.000436350169
  error estimate for blocks of size 2^( 4) =       0.000449743271
  error estimate for blocks of size 2^( 5) =       0.000464475638
  error estimate for blocks of size 2^( 6) =       0.000473568411
  error estimate for blocks of size 2^( 7) =       0.000478790058

      target function =                  N/A
              le_mean =     -16.905586001180
             les_mean =     286.134229904571
             stat err =       0.000466644344
             autocorr =       1.298521880925
              std dev =       0.579130407580
             le_variance =       0.335392028984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335442190481
                                         uncertainty =       0.002833963238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335442190481
                                         uncertainty =       0.002833963238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409507038
  error estimate for blocks of size 2^( 2) =       0.000422432284
  error estimate for blocks of size 2^( 3) =       0.000436350169
  error estimate for blocks of size 2^( 4) =       0.000449743271
  error estimate for blocks of size 2^( 5) =       0.000464475638
  error estimate for blocks of size 2^( 6) =       0.000473568411
  error estimate for blocks of size 2^( 7) =       0.000478790058

      target function =                  N/A
              le_mean =     -16.905586001180
             les_mean =     286.134229904590
             stat err =       0.000466644344
             autocorr =       1.298521880911
              std dev =       0.579130407594
             le_variance =       0.335392029000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335442190473
                                         uncertainty =       0.002833963238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335442190473
                                         uncertainty =       0.002833963238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409507038
  error estimate for blocks of size 2^( 2) =       0.000422432284
  error estimate for blocks of size 2^( 3) =       0.000436350169
  error estimate for blocks of size 2^( 4) =       0.000449743271
  error estimate for blocks of size 2^( 5) =       0.000464475638
  error estimate for blocks of size 2^( 6) =       0.000473568411
  error estimate for blocks of size 2^( 7) =       0.000478790058

      target function =                  N/A
              le_mean =     -16.905586001180
             les_mean =     286.134229904580
             stat err =       0.000466644344
             autocorr =       1.298521880916
              std dev =       0.579130407587
             le_variance =       0.335392028992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335442190466
                                         uncertainty =       0.002833963238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335442190466
                                         uncertainty =       0.002833963238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409507038
  error estimate for blocks of size 2^( 2) =       0.000422432284
  error estimate for blocks of size 2^( 3) =       0.000436350169
  error estimate for blocks of size 2^( 4) =       0.000449743271
  error estimate for blocks of size 2^( 5) =       0.000464475638
  error estimate for blocks of size 2^( 6) =       0.000473568411
  error estimate for blocks of size 2^( 7) =       0.000478790058

      target function =                  N/A
              le_mean =     -16.905586001180
             les_mean =     286.134229904572
             stat err =       0.000466644344
             autocorr =       1.298521880931
              std dev =       0.579130407581
             le_variance =       0.335392028984


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905586001180        initial
     2.3842e+07     2.3842e+08             2.2864e-11       -16.905586001180  <--
     9.5367e+07     9.5367e+08             5.7162e-12       -16.905586001180
     3.8147e+08     3.8147e+09             1.4288e-12       -16.905586001180

*****************************************************************************
Applying the update for shift_i =   2.3842e+07     and shift_s =   2.3842e+08
*****************************************************************************

  Execution time = 2.9794e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655170e-02 1 1  ON 9
 ud_0                 4.416349e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928217e-02 1 1  ON 12
 ud_3                -9.624435e-03 1 1  ON 13
 ud_4                -6.543533e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493553e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731859e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066158e-01 1 1  ON 28
 eO_9                -6.607656e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432650e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443375e-01 1 1  ON 37
eH1_8                 1.566872e-01 1 1  ON 38
eH1_9                 4.240947e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663020e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351575e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6004e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.947
    reference variance = 0.26608
====================================================
  Execution time = 2.1024e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3270e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5192e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332584237351
                                         uncertainty =       0.003778169870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332584237351
                                         uncertainty =       0.003778169870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407860307
  error estimate for blocks of size 2^( 2) =       0.000421184361
  error estimate for blocks of size 2^( 3) =       0.000434872360
  error estimate for blocks of size 2^( 4) =       0.000448442181
  error estimate for blocks of size 2^( 5) =       0.000460148785
  error estimate for blocks of size 2^( 6) =       0.000470448331
  error estimate for blocks of size 2^( 7) =       0.000477579282

      target function =                  N/A
              le_mean =     -16.904886054859
             les_mean =     286.107872420878
             stat err =       0.000464154645
             autocorr =       1.295097659900
              std dev =       0.576801577192
             le_variance =       0.332700059451


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690488605486e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904886054859       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904886054859       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904886054860       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904886054860       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904886054888       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904886054772       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904886052812       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904886060906       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904886059298       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 1.122600e-10

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904886054859       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904886054859       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904886054859       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904886050529       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904886061527       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904886068028       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904886053053       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904886059370       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904886051822       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 2.806519e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904886054859       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904886054859       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904886054859       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904886054859       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904886056463       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904886038648       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904886031345       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904886120906       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904886085950       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 7.016509e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.082049 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6551e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655170e-02 1 1  ON 9
 ud_0                 4.416349e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928217e-02 1 1  ON 12
 ud_3                -9.624435e-03 1 1  ON 13
 ud_4                -6.543533e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493553e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731859e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066158e-01 1 1  ON 28
 eO_9                -6.607656e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432650e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443375e-01 1 1  ON 37
eH1_8                 1.566872e-01 1 1  ON 38
eH1_9                 4.240947e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663020e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351575e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9381
    reference variance = 0.320501
====================================================
  Execution time = 2.0398e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3389e-01
  Total weights = 2.0000e+06
  Execution time = 1.8701e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333825078383
                                         uncertainty =       0.003278784489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333825078383
                                         uncertainty =       0.003278784489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408590854
  error estimate for blocks of size 2^( 2) =       0.000421469676
  error estimate for blocks of size 2^( 3) =       0.000435006423
  error estimate for blocks of size 2^( 4) =       0.000448436860
  error estimate for blocks of size 2^( 5) =       0.000460602694
  error estimate for blocks of size 2^( 6) =       0.000470344294
  error estimate for blocks of size 2^( 7) =       0.000477658874

      target function =                  N/A
              le_mean =     -16.904892294778
             les_mean =     286.109276302536
             stat err =       0.000464260681
             autocorr =       1.291060297770
              std dev =       0.577834726761
             le_variance =       0.333892971450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333825078493
                                         uncertainty =       0.003278784491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333825078493
                                         uncertainty =       0.003278784491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408590854
  error estimate for blocks of size 2^( 2) =       0.000421469676
  error estimate for blocks of size 2^( 3) =       0.000435006423
  error estimate for blocks of size 2^( 4) =       0.000448436860
  error estimate for blocks of size 2^( 5) =       0.000460602694
  error estimate for blocks of size 2^( 6) =       0.000470344294
  error estimate for blocks of size 2^( 7) =       0.000477658875

      target function =                  N/A
              le_mean =     -16.904892294778
             les_mean =     286.109276302647
             stat err =       0.000464260681
             autocorr =       1.291060297634
              std dev =       0.577834726856
             le_variance =       0.333892971560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333825078438
                                         uncertainty =       0.003278784490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333825078438
                                         uncertainty =       0.003278784490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408590854
  error estimate for blocks of size 2^( 2) =       0.000421469676
  error estimate for blocks of size 2^( 3) =       0.000435006423
  error estimate for blocks of size 2^( 4) =       0.000448436860
  error estimate for blocks of size 2^( 5) =       0.000460602694
  error estimate for blocks of size 2^( 6) =       0.000470344294
  error estimate for blocks of size 2^( 7) =       0.000477658875

      target function =                  N/A
              le_mean =     -16.904892294778
             les_mean =     286.109276302591
             stat err =       0.000464260681
             autocorr =       1.291060297699
              std dev =       0.577834726808
             le_variance =       0.333892971505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333825078390
                                         uncertainty =       0.003278784489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333825078390
                                         uncertainty =       0.003278784489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408590854
  error estimate for blocks of size 2^( 2) =       0.000421469676
  error estimate for blocks of size 2^( 3) =       0.000435006423
  error estimate for blocks of size 2^( 4) =       0.000448436860
  error estimate for blocks of size 2^( 5) =       0.000460602694
  error estimate for blocks of size 2^( 6) =       0.000470344294
  error estimate for blocks of size 2^( 7) =       0.000477658874

      target function =                  N/A
              le_mean =     -16.904892294778
             les_mean =     286.109276302543
             stat err =       0.000464260681
             autocorr =       1.291060297756
              std dev =       0.577834726767
             le_variance =       0.333892971457


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904892294778        initial
     5.9605e+06     5.9605e+07             1.1226e-10       -16.904892294778  <--
     2.3842e+07     2.3842e+08             2.8065e-11       -16.904892294778
     9.5367e+07     9.5367e+08             7.0165e-12       -16.904892294778

*****************************************************************************
Applying the update for shift_i =   5.9605e+06     and shift_s =   5.9605e+07
*****************************************************************************

  Execution time = 2.9869e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655170e-02 1 1  ON 9
 ud_0                 4.416349e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928217e-02 1 1  ON 12
 ud_3                -9.624435e-03 1 1  ON 13
 ud_4                -6.543533e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493553e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731859e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066158e-01 1 1  ON 28
 eO_9                -6.607656e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432650e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443375e-01 1 1  ON 37
eH1_8                 1.566872e-01 1 1  ON 38
eH1_9                 4.240947e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663020e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351575e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6428e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8014
    reference variance = 0.534895
====================================================
  Execution time = 2.2585e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3626e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5146e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336293537131
                                         uncertainty =       0.003045080076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336293537131
                                         uncertainty =       0.003045080076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410038229
  error estimate for blocks of size 2^( 2) =       0.000422775847
  error estimate for blocks of size 2^( 3) =       0.000435995921
  error estimate for blocks of size 2^( 4) =       0.000448220829
  error estimate for blocks of size 2^( 5) =       0.000458966192
  error estimate for blocks of size 2^( 6) =       0.000467079113
  error estimate for blocks of size 2^( 7) =       0.000473211509

      target function =                  N/A
              le_mean =     -16.906191131891
             les_mean =     286.155561117840
             stat err =       0.000461869410
             autocorr =       1.268789869370
              std dev =       0.579881624073
             le_variance =       0.336262697938


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690619113189e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906191131891       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906191131893       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906191131895       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906191131896       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906191132406       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906191131183       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906191130863       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906191132826       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906191132209       residual = 1.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 3.021459e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906191131891       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906191131891       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906191131892       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906191131892       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906191133050       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906191132443       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906191136942       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906191132103       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906191135346       residual = 1.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 7.553666e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906191131891       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906191131891       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906191131891       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906191131891       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906191131227       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906191131628       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906191120034       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906191129623       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906191127691       residual = 1.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.888402e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.085017 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8108e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655170e-02 1 1  ON 9
 ud_0                 4.416349e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928217e-02 1 1  ON 12
 ud_3                -9.624435e-03 1 1  ON 13
 ud_4                -6.543533e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493553e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731859e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066158e-01 1 1  ON 28
 eO_9                -6.607656e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432650e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443375e-01 1 1  ON 37
eH1_8                 1.566872e-01 1 1  ON 38
eH1_9                 4.240947e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663020e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351575e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9261
    reference variance = 0.187695
====================================================
  Execution time = 2.2260e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3236e-01
  Total weights = 2.0000e+06
  Execution time = 1.8626e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332353288487
                                         uncertainty =       0.002895119581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332353288487
                                         uncertainty =       0.002895119581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407652554
  error estimate for blocks of size 2^( 2) =       0.000420469631
  error estimate for blocks of size 2^( 3) =       0.000434074556
  error estimate for blocks of size 2^( 4) =       0.000446691338
  error estimate for blocks of size 2^( 5) =       0.000457939658
  error estimate for blocks of size 2^( 6) =       0.000463718863
  error estimate for blocks of size 2^( 7) =       0.000467367802

      target function =                  N/A
              le_mean =     -16.906345664759
             les_mean =     286.156884779141
             stat err =       0.000458929415
             autocorr =       1.267393440457
              std dev =       0.576507770116
             le_variance =       0.332361209005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332353288644
                                         uncertainty =       0.002895119583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332353288644
                                         uncertainty =       0.002895119583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407652554
  error estimate for blocks of size 2^( 2) =       0.000420469631
  error estimate for blocks of size 2^( 3) =       0.000434074556
  error estimate for blocks of size 2^( 4) =       0.000446691338
  error estimate for blocks of size 2^( 5) =       0.000457939658
  error estimate for blocks of size 2^( 6) =       0.000463718863
  error estimate for blocks of size 2^( 7) =       0.000467367802

      target function =                  N/A
              le_mean =     -16.906345664760
             les_mean =     286.156884779322
             stat err =       0.000458929415
             autocorr =       1.267393440221
              std dev =       0.576507770253
             le_variance =       0.332361209162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332353288566
                                         uncertainty =       0.002895119582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332353288566
                                         uncertainty =       0.002895119582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407652554
  error estimate for blocks of size 2^( 2) =       0.000420469631
  error estimate for blocks of size 2^( 3) =       0.000434074556
  error estimate for blocks of size 2^( 4) =       0.000446691338
  error estimate for blocks of size 2^( 5) =       0.000457939658
  error estimate for blocks of size 2^( 6) =       0.000463718863
  error estimate for blocks of size 2^( 7) =       0.000467367802

      target function =                  N/A
              le_mean =     -16.906345664759
             les_mean =     286.156884779232
             stat err =       0.000458929415
             autocorr =       1.267393440331
              std dev =       0.576507770185
             le_variance =       0.332361209083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332353288497
                                         uncertainty =       0.002895119581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332353288497
                                         uncertainty =       0.002895119581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407652554
  error estimate for blocks of size 2^( 2) =       0.000420469631
  error estimate for blocks of size 2^( 3) =       0.000434074556
  error estimate for blocks of size 2^( 4) =       0.000446691338
  error estimate for blocks of size 2^( 5) =       0.000457939658
  error estimate for blocks of size 2^( 6) =       0.000463718863
  error estimate for blocks of size 2^( 7) =       0.000467367802

      target function =                  N/A
              le_mean =     -16.906345664759
             les_mean =     286.156884779152
             stat err =       0.000458929415
             autocorr =       1.267393440431
              std dev =       0.576507770125
             le_variance =       0.332361209015


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906345664759        initial
     1.4901e+06     1.4901e+07             3.0215e-10       -16.906345664760  <--
     5.9605e+06     5.9605e+07             7.5537e-11       -16.906345664759
     2.3842e+07     2.3842e+08             1.8884e-11       -16.906345664759

*****************************************************************************
Applying the update for shift_i =   1.4901e+06     and shift_s =   1.4901e+07
*****************************************************************************

  Execution time = 3.1682e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655170e-02 1 1  ON 9
 ud_0                 4.416349e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928217e-02 1 1  ON 12
 ud_3                -9.624436e-03 1 1  ON 13
 ud_4                -6.543533e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493553e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731859e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066158e-01 1 1  ON 28
 eO_9                -6.607656e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432650e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443375e-01 1 1  ON 37
eH1_8                 1.566872e-01 1 1  ON 38
eH1_9                 4.240947e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663020e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351575e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9798e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8692
    reference variance = 0.243258
====================================================
  Execution time = 2.0622e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.8305e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6200e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.383155711992
                                         uncertainty =       0.048015972835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.383155711992
                                         uncertainty =       0.048015972835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000437633806
  error estimate for blocks of size 2^( 2) =       0.000449600293
  error estimate for blocks of size 2^( 3) =       0.000461817323
  error estimate for blocks of size 2^( 4) =       0.000473196656
  error estimate for blocks of size 2^( 5) =       0.000481967965
  error estimate for blocks of size 2^( 6) =       0.000489287713
  error estimate for blocks of size 2^( 7) =       0.000495393460

      target function =                  N/A
              le_mean =     -16.905839218967
             les_mean =     286.190446201555
             stat err =       0.000484961448
             autocorr =       1.227983998552
              std dev =       0.618907663170
             le_variance =       0.383046695530


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690583921897e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905839218967       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905839218970       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905839218977       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905839218926       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905839218965       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905839219072       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905839218684       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905839219166       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905839218926       residual = 1.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 1.442624e-09

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905839218967       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905839218967       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905839218969       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905839218337       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905839218971       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905839218560       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905839219594       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905839219121       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905839219826       residual = 1.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 3.606563e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905839218967       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905839218967       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905839218967       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905839218967       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905839217981       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905839218967       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905839209439       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905839213177       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905839218945       residual = 1.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 9.016327e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.088032 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6249e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655170e-02 1 1  ON 9
 ud_0                 4.416349e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928217e-02 1 1  ON 12
 ud_3                -9.624436e-03 1 1  ON 13
 ud_4                -6.543533e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493553e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731859e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066158e-01 1 1  ON 28
 eO_9                -6.607656e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432650e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443375e-01 1 1  ON 37
eH1_8                 1.566872e-01 1 1  ON 38
eH1_9                 4.240947e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663020e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351575e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9071
    reference variance = 0.182726
====================================================
  Execution time = 2.0263e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3019e-01
  Total weights = 2.0000e+06
  Execution time = 1.8802e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330280437833
                                         uncertainty =       0.002250050460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330280437833
                                         uncertainty =       0.002250050460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406317571
  error estimate for blocks of size 2^( 2) =       0.000419794065
  error estimate for blocks of size 2^( 3) =       0.000433627978
  error estimate for blocks of size 2^( 4) =       0.000446707014
  error estimate for blocks of size 2^( 5) =       0.000457406641
  error estimate for blocks of size 2^( 6) =       0.000465554009
  error estimate for blocks of size 2^( 7) =       0.000470058624

      target function =                  N/A
              le_mean =     -16.906226588075
             les_mean =     286.150685219597
             stat err =       0.000459931572
             autocorr =       1.281313015665
              std dev =       0.574619819834
             le_variance =       0.330187937346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330280439204
                                         uncertainty =       0.002250050474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330280439204
                                         uncertainty =       0.002250050474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406317572
  error estimate for blocks of size 2^( 2) =       0.000419794066
  error estimate for blocks of size 2^( 3) =       0.000433627979
  error estimate for blocks of size 2^( 4) =       0.000446707015
  error estimate for blocks of size 2^( 5) =       0.000457406642
  error estimate for blocks of size 2^( 6) =       0.000465554010
  error estimate for blocks of size 2^( 7) =       0.000470058624

      target function =                  N/A
              le_mean =     -16.906226588078
             les_mean =     286.150685221058
             stat err =       0.000459931573
             autocorr =       1.281313014109
              std dev =       0.574619821025
             le_variance =       0.330187938715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330280438518
                                         uncertainty =       0.002250050467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330280438518
                                         uncertainty =       0.002250050467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406317572
  error estimate for blocks of size 2^( 2) =       0.000419794065
  error estimate for blocks of size 2^( 3) =       0.000433627979
  error estimate for blocks of size 2^( 4) =       0.000446707014
  error estimate for blocks of size 2^( 5) =       0.000457406641
  error estimate for blocks of size 2^( 6) =       0.000465554010
  error estimate for blocks of size 2^( 7) =       0.000470058624

      target function =                  N/A
              le_mean =     -16.906226588077
             les_mean =     286.150685220328
             stat err =       0.000459931572
             autocorr =       1.281313014894
              std dev =       0.574619820430
             le_variance =       0.330187938031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330280437919
                                         uncertainty =       0.002250050461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330280437919
                                         uncertainty =       0.002250050461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406317571
  error estimate for blocks of size 2^( 2) =       0.000419794065
  error estimate for blocks of size 2^( 3) =       0.000433627978
  error estimate for blocks of size 2^( 4) =       0.000446707014
  error estimate for blocks of size 2^( 5) =       0.000457406641
  error estimate for blocks of size 2^( 6) =       0.000465554009
  error estimate for blocks of size 2^( 7) =       0.000470058624

      target function =                  N/A
              le_mean =     -16.906226588076
             les_mean =     286.150685219688
             stat err =       0.000459931572
             autocorr =       1.281313015565
              std dev =       0.574619819908
             le_variance =       0.330187937431


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906226588075        initial
     3.7253e+05     3.7253e+06             1.4426e-09       -16.906226588078  <--
     1.4901e+06     1.4901e+07             3.6066e-10       -16.906226588077
     5.9605e+06     5.9605e+07             9.0163e-11       -16.906226588076

*****************************************************************************
Applying the update for shift_i =   3.7253e+05     and shift_s =   3.7253e+06
*****************************************************************************

  Execution time = 2.9746e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655170e-02 1 1  ON 9
 ud_0                 4.416349e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928217e-02 1 1  ON 12
 ud_3                -9.624436e-03 1 1  ON 13
 ud_4                -6.543533e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493553e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731859e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066158e-01 1 1  ON 28
 eO_9                -6.607656e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432650e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443375e-01 1 1  ON 37
eH1_8                 1.566872e-01 1 1  ON 38
eH1_9                 4.240947e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663020e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351575e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6002e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8724
    reference variance = 0.210421
====================================================
  Execution time = 2.0792e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4595e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6319e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345984687308
                                         uncertainty =       0.006628392454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345984687308
                                         uncertainty =       0.006628392454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415902364
  error estimate for blocks of size 2^( 2) =       0.000428543210
  error estimate for blocks of size 2^( 3) =       0.000440993899
  error estimate for blocks of size 2^( 4) =       0.000452594754
  error estimate for blocks of size 2^( 5) =       0.000463276052
  error estimate for blocks of size 2^( 6) =       0.000470127793
  error estimate for blocks of size 2^( 7) =       0.000474890615

      target function =                  N/A
              le_mean =     -16.906279048444
             les_mean =     286.168220644249
             stat err =       0.000465222304
             autocorr =       1.251233249043
              std dev =       0.588174764319
             le_variance =       0.345949553382


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690627904844e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906279048444       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906279048463       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906279048493       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906279048482       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906279048490       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906279048491       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906279048473       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906279048459       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906279048436       residual = 1.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 6.029824e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906279048444       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906279048448       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906279048456       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906279048455       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906279048361       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906279048554       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906279048333       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906279048447       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906279048455       residual = 1.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 1.507458e-09

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906279048444       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906279048445       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906279048447       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906279048400       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906279048837       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906279048238       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906279048098       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906279048037       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906279048369       residual = 1.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 3.768648e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.091046 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6444e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655170e-02 1 1  ON 9
 ud_0                 4.416349e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928217e-02 1 1  ON 12
 ud_3                -9.624437e-03 1 1  ON 13
 ud_4                -6.543533e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493553e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731859e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607656e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432650e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443375e-01 1 1  ON 37
eH1_8                 1.566872e-01 1 1  ON 38
eH1_9                 4.240947e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663020e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351575e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9488
    reference variance = 0.207372
====================================================
  Execution time = 2.0827e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3714e-01
  Total weights = 2.0000e+06
  Execution time = 1.8633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337257349306
                                         uncertainty =       0.004506052608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337257349306
                                         uncertainty =       0.004506052608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410571654
  error estimate for blocks of size 2^( 2) =       0.000423033537
  error estimate for blocks of size 2^( 3) =       0.000435957482
  error estimate for blocks of size 2^( 4) =       0.000448413520
  error estimate for blocks of size 2^( 5) =       0.000458860017
  error estimate for blocks of size 2^( 6) =       0.000466820150
  error estimate for blocks of size 2^( 7) =       0.000472149582

      target function =                  N/A
              le_mean =     -16.905713240703
             les_mean =     286.140278174276
             stat err =       0.000461560817
             autocorr =       1.263804633337
              std dev =       0.580636001255
             le_variance =       0.337138165953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337257353050
                                         uncertainty =       0.004506052643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337257353050
                                         uncertainty =       0.004506052643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410571656
  error estimate for blocks of size 2^( 2) =       0.000423033539
  error estimate for blocks of size 2^( 3) =       0.000435957484
  error estimate for blocks of size 2^( 4) =       0.000448413521
  error estimate for blocks of size 2^( 5) =       0.000458860019
  error estimate for blocks of size 2^( 6) =       0.000466820152
  error estimate for blocks of size 2^( 7) =       0.000472149584

      target function =                  N/A
              le_mean =     -16.905713240722
             les_mean =     286.140278178656
             stat err =       0.000461560819
             autocorr =       1.263804628761
              std dev =       0.580636004476
             le_variance =       0.337138169694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337257351178
                                         uncertainty =       0.004506052626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337257351178
                                         uncertainty =       0.004506052626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410571655
  error estimate for blocks of size 2^( 2) =       0.000423033538
  error estimate for blocks of size 2^( 3) =       0.000435957483
  error estimate for blocks of size 2^( 4) =       0.000448413521
  error estimate for blocks of size 2^( 5) =       0.000458860018
  error estimate for blocks of size 2^( 6) =       0.000466820151
  error estimate for blocks of size 2^( 7) =       0.000472149583

      target function =                  N/A
              le_mean =     -16.905713240713
             les_mean =     286.140278176466
             stat err =       0.000461560818
             autocorr =       1.263804631047
              std dev =       0.580636002865
             le_variance =       0.337138167824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337257349540
                                         uncertainty =       0.004506052610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337257349540
                                         uncertainty =       0.004506052610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410571654
  error estimate for blocks of size 2^( 2) =       0.000423033537
  error estimate for blocks of size 2^( 3) =       0.000435957482
  error estimate for blocks of size 2^( 4) =       0.000448413520
  error estimate for blocks of size 2^( 5) =       0.000458860017
  error estimate for blocks of size 2^( 6) =       0.000466820150
  error estimate for blocks of size 2^( 7) =       0.000472149582

      target function =                  N/A
              le_mean =     -16.905713240705
             les_mean =     286.140278174550
             stat err =       0.000461560817
             autocorr =       1.263804633054
              std dev =       0.580636001456
             le_variance =       0.337138166187


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905713240703        initial
     9.3132e+04     9.3132e+05             6.0298e-09       -16.905713240722  <--
     3.7253e+05     3.7253e+06             1.5075e-09       -16.905713240713
     1.4901e+06     1.4901e+07             3.7686e-10       -16.905713240705

*****************************************************************************
Applying the update for shift_i =   9.3132e+04     and shift_s =   9.3132e+05
*****************************************************************************

  Execution time = 3.0260e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655170e-02 1 1  ON 9
 ud_0                 4.416349e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928217e-02 1 1  ON 12
 ud_3                -9.624439e-03 1 1  ON 13
 ud_4                -6.543533e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493554e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731859e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607656e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432650e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443375e-01 1 1  ON 37
eH1_8                 1.566872e-01 1 1  ON 38
eH1_9                 4.240947e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663020e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351575e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6711e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.998
    reference variance = 0.658392
====================================================
  Execution time = 2.0584e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3138e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5385e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331393663148
                                         uncertainty =       0.002803307654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331393663148
                                         uncertainty =       0.002803307654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407047604
  error estimate for blocks of size 2^( 2) =       0.000419547107
  error estimate for blocks of size 2^( 3) =       0.000432620955
  error estimate for blocks of size 2^( 4) =       0.000443899395
  error estimate for blocks of size 2^( 5) =       0.000454218358
  error estimate for blocks of size 2^( 6) =       0.000461910652
  error estimate for blocks of size 2^( 7) =       0.000467326025

      target function =                  N/A
              le_mean =     -16.906338191089
             les_mean =     286.155646369962
             stat err =       0.000456838607
             autocorr =       1.259607367780
              std dev =       0.575652242409
             le_variance =       0.331375504190


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690633819109e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906338191089       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906338191107       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906338191139       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906338191120       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906338191162       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906338191139       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906338191200       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906338191178       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906338191174       residual = 1.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 2.303818e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906338191089       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906338191093       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906338191101       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906338191095       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906338191021       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906338191149       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906338191113       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906338191057       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906338191129       residual = 1.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 5.759575e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906338191089       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906338191090       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906338191092       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906338190674       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906338190763       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906338190963       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906338190975       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906338191210       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906338190628       residual = 1.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 1.439896e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.094057 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6130e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090950e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655171e-02 1 1  ON 9
 ud_0                 4.416349e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928217e-02 1 1  ON 12
 ud_3                -9.624441e-03 1 1  ON 13
 ud_4                -6.543533e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493554e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731858e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607657e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432650e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443375e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240948e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663020e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351575e-02 1 1  ON 44
eH2_5                 4.810274e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9628
    reference variance = 0.212868
====================================================
  Execution time = 2.0088e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3463e-01
  Total weights = 2.0000e+06
  Execution time = 1.8680e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334657032409
                                         uncertainty =       0.003541720342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334657032409
                                         uncertainty =       0.003541720342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409042557
  error estimate for blocks of size 2^( 2) =       0.000422065143
  error estimate for blocks of size 2^( 3) =       0.000435891644
  error estimate for blocks of size 2^( 4) =       0.000447932256
  error estimate for blocks of size 2^( 5) =       0.000457838684
  error estimate for blocks of size 2^( 6) =       0.000465310212
  error estimate for blocks of size 2^( 7) =       0.000471649680

      target function =                  N/A
              le_mean =     -16.905310684124
             les_mean =     286.124160786858
             stat err =       0.000460682708
             autocorr =       1.268430955118
              std dev =       0.578473532174
             le_variance =       0.334631627426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334657037522
                                         uncertainty =       0.003541720327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334657037522
                                         uncertainty =       0.003541720327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409042560
  error estimate for blocks of size 2^( 2) =       0.000422065145
  error estimate for blocks of size 2^( 3) =       0.000435891646
  error estimate for blocks of size 2^( 4) =       0.000447932258
  error estimate for blocks of size 2^( 5) =       0.000457838686
  error estimate for blocks of size 2^( 6) =       0.000465310213
  error estimate for blocks of size 2^( 7) =       0.000471649681

      target function =                  N/A
              le_mean =     -16.905310684239
             les_mean =     286.124160795859
             stat err =       0.000460682710
             autocorr =       1.268430944973
              std dev =       0.578473536598
             le_variance =       0.334631632544

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334657034966
                                         uncertainty =       0.003541720335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334657034966
                                         uncertainty =       0.003541720335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409042559
  error estimate for blocks of size 2^( 2) =       0.000422065144
  error estimate for blocks of size 2^( 3) =       0.000435891645
  error estimate for blocks of size 2^( 4) =       0.000447932257
  error estimate for blocks of size 2^( 5) =       0.000457838685
  error estimate for blocks of size 2^( 6) =       0.000465310212
  error estimate for blocks of size 2^( 7) =       0.000471649681

      target function =                  N/A
              le_mean =     -16.905310684181
             les_mean =     286.124160791358
             stat err =       0.000460682709
             autocorr =       1.268430950052
              std dev =       0.578473534386
             le_variance =       0.334631629985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334657032729
                                         uncertainty =       0.003541720341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334657032729
                                         uncertainty =       0.003541720341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409042558
  error estimate for blocks of size 2^( 2) =       0.000422065143
  error estimate for blocks of size 2^( 3) =       0.000435891644
  error estimate for blocks of size 2^( 4) =       0.000447932256
  error estimate for blocks of size 2^( 5) =       0.000457838685
  error estimate for blocks of size 2^( 6) =       0.000465310212
  error estimate for blocks of size 2^( 7) =       0.000471649680

      target function =                  N/A
              le_mean =     -16.905310684131
             les_mean =     286.124160787420
             stat err =       0.000460682708
             autocorr =       1.268430954489
              std dev =       0.578473532451
             le_variance =       0.334631627746


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905310684124        initial
     2.3283e+04     2.3283e+05             2.3038e-08       -16.905310684239  <--
     9.3132e+04     9.3132e+05             5.7596e-09       -16.905310684181
     3.7253e+05     3.7253e+06             1.4399e-09       -16.905310684131

*****************************************************************************
Applying the update for shift_i =   2.3283e+04     and shift_s =   2.3283e+05
*****************************************************************************

  Execution time = 2.9554e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090951e-02 1 1  ON 2
 uu_3                -2.057439e-02 1 1  ON 3
 uu_4                -6.445349e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655171e-02 1 1  ON 9
 ud_0                 4.416350e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928216e-02 1 1  ON 12
 ud_3                -9.624448e-03 1 1  ON 13
 ud_4                -6.543534e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493554e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731858e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607657e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432650e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240948e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663020e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351576e-02 1 1  ON 44
eH2_5                 4.810274e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459311e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5719e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8592
    reference variance = 0.332061
====================================================
  Execution time = 2.0802e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4312e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6416e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343159861525
                                         uncertainty =       0.004649996199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343159861525
                                         uncertainty =       0.004649996199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414195108
  error estimate for blocks of size 2^( 2) =       0.000426665341
  error estimate for blocks of size 2^( 3) =       0.000440121984
  error estimate for blocks of size 2^( 4) =       0.000452368362
  error estimate for blocks of size 2^( 5) =       0.000462467315
  error estimate for blocks of size 2^( 6) =       0.000470131149
  error estimate for blocks of size 2^( 7) =       0.000475087640

      target function =                  N/A
              le_mean =     -16.906304242959
             les_mean =     286.166238158407
             stat err =       0.000465013617
             autocorr =       1.260437775969
              std dev =       0.585760338759
             le_variance =       0.343115174463


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690630424296e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906304242959       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906304243241       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906304243274       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906304243203       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906304243202       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906304243209       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906304243256       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906304243233       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906304243230       residual = 1.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 8.987777e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906304242959       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906304243030       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906304243038       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906304243020       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906304243001       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906304243023       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906304243034       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906304243015       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906304243056       residual = 1.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 2.246986e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906304242959       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906304242977       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906304242979       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906304242950       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906304242974       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906304242974       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906304242987       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906304242955       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906304242928       residual = 1.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 5.617491e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.097126 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6452e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090951e-02 1 1  ON 2
 uu_3                -2.057438e-02 1 1  ON 3
 uu_4                -6.445348e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655171e-02 1 1  ON 9
 ud_0                 4.416350e-01 1 1  ON 10
 ud_1                 1.772623e-01 1 1  ON 11
 ud_2                 5.928216e-02 1 1  ON 12
 ud_3                -9.624458e-03 1 1  ON 13
 ud_4                -6.543534e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493554e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731858e-02 1 1  ON 22
 eO_3                 2.961855e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325538e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607658e-02 1 1  ON 29
eH1_0                -2.327717e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948990e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432651e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240949e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663021e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351576e-02 1 1  ON 44
eH2_5                 4.810274e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459311e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9489
    reference variance = 0.280369
====================================================
  Execution time = 2.0344e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3670e-01
  Total weights = 2.0000e+06
  Execution time = 1.8612e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336790565312
                                         uncertainty =       0.003750781112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336790565312
                                         uncertainty =       0.003750781112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410306720
  error estimate for blocks of size 2^( 2) =       0.000422588723
  error estimate for blocks of size 2^( 3) =       0.000435387331
  error estimate for blocks of size 2^( 4) =       0.000447738153
  error estimate for blocks of size 2^( 5) =       0.000456920382
  error estimate for blocks of size 2^( 6) =       0.000463541823
  error estimate for blocks of size 2^( 7) =       0.000469229880

      target function =                  N/A
              le_mean =     -16.906212406512
             les_mean =     286.156720974208
             stat err =       0.000459357560
             autocorr =       1.253384953043
              std dev =       0.580261327724
             le_variance =       0.336703208452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336790626982
                                         uncertainty =       0.003750782160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336790626982
                                         uncertainty =       0.003750782160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410306757
  error estimate for blocks of size 2^( 2) =       0.000422588758
  error estimate for blocks of size 2^( 3) =       0.000435387363
  error estimate for blocks of size 2^( 4) =       0.000447738184
  error estimate for blocks of size 2^( 5) =       0.000456920411
  error estimate for blocks of size 2^( 6) =       0.000463541851
  error estimate for blocks of size 2^( 7) =       0.000469229907

      target function =                  N/A
              le_mean =     -16.906212406516
             les_mean =     286.156721035999
             stat err =       0.000459357588
             autocorr =       1.253384878090
              std dev =       0.580261380859
             le_variance =       0.336703270117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336790596147
                                         uncertainty =       0.003750781636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336790596147
                                         uncertainty =       0.003750781636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410306738
  error estimate for blocks of size 2^( 2) =       0.000422588741
  error estimate for blocks of size 2^( 3) =       0.000435387347
  error estimate for blocks of size 2^( 4) =       0.000447738168
  error estimate for blocks of size 2^( 5) =       0.000456920396
  error estimate for blocks of size 2^( 6) =       0.000463541837
  error estimate for blocks of size 2^( 7) =       0.000469229893

      target function =                  N/A
              le_mean =     -16.906212406514
             les_mean =     286.156721005104
             stat err =       0.000459357574
             autocorr =       1.253384915571
              std dev =       0.580261354292
             le_variance =       0.336703239285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336790569166
                                         uncertainty =       0.003750781178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336790569166
                                         uncertainty =       0.003750781178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410306722
  error estimate for blocks of size 2^( 2) =       0.000422588726
  error estimate for blocks of size 2^( 3) =       0.000435387333
  error estimate for blocks of size 2^( 4) =       0.000447738155
  error estimate for blocks of size 2^( 5) =       0.000456920384
  error estimate for blocks of size 2^( 6) =       0.000463541825
  error estimate for blocks of size 2^( 7) =       0.000469229882

      target function =                  N/A
              le_mean =     -16.906212406512
             les_mean =     286.156720978070
             stat err =       0.000459357561
             autocorr =       1.253384948357
              std dev =       0.580261331045
             le_variance =       0.336703212306


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906212406512        initial
     5.8208e+03     5.8208e+04             8.9878e-08       -16.906212406516  <--
     2.3283e+04     2.3283e+05             2.2470e-08       -16.906212406514
     9.3132e+04     9.3132e+05             5.6175e-09       -16.906212406512

*****************************************************************************
Applying the update for shift_i =   5.8208e+03     and shift_s =   5.8208e+04
*****************************************************************************

  Execution time = 2.9767e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090951e-02 1 1  ON 2
 uu_3                -2.057438e-02 1 1  ON 3
 uu_4                -6.445347e-02 1 1  ON 4
 uu_5                -9.747226e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655172e-02 1 1  ON 9
 ud_0                 4.416350e-01 1 1  ON 10
 ud_1                 1.772624e-01 1 1  ON 11
 ud_2                 5.928216e-02 1 1  ON 12
 ud_3                -9.624489e-03 1 1  ON 13
 ud_4                -6.543535e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493555e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731857e-02 1 1  ON 22
 eO_3                 2.961856e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325537e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607660e-02 1 1  ON 29
eH1_0                -2.327718e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948991e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432652e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240952e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663022e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351577e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459313e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6225e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8949
    reference variance = 0.185325
====================================================
  Execution time = 2.2671e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4724e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5288e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347308935744
                                         uncertainty =       0.007053241947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347308935744
                                         uncertainty =       0.007053241947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416678338
  error estimate for blocks of size 2^( 2) =       0.000429223588
  error estimate for blocks of size 2^( 3) =       0.000441949485
  error estimate for blocks of size 2^( 4) =       0.000454641827
  error estimate for blocks of size 2^( 5) =       0.000465929158
  error estimate for blocks of size 2^( 6) =       0.000473287775
  error estimate for blocks of size 2^( 7) =       0.000479574459

      target function =                  N/A
              le_mean =     -16.906368871665
             les_mean =     286.172549926018
             stat err =       0.000468358305
             autocorr =       1.263439947923
              std dev =       0.589272156843
             le_variance =       0.347241674830


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690636887167e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906368871665       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906368873070       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906368873843       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906368874190       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906368874364       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906368874458       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906368874608       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906368874499       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906368874513       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 3.211026e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906368871665       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906368872016       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906368872210       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906368872297       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906368872342       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906368872364       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906368872396       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906368872378       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906368872374       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 8.027982e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906368871665       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906368871753       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906368871801       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906368871824       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906368871829       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906368871843       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906368871849       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906368871843       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906368871838       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 2.007022e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.100169 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8208e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090953e-02 1 1  ON 2
 uu_3                -2.057438e-02 1 1  ON 3
 uu_4                -6.445346e-02 1 1  ON 4
 uu_5                -9.747225e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655174e-02 1 1  ON 9
 ud_0                 4.416351e-01 1 1  ON 10
 ud_1                 1.772625e-01 1 1  ON 11
 ud_2                 5.928215e-02 1 1  ON 12
 ud_3                -9.624516e-03 1 1  ON 13
 ud_4                -6.543537e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493555e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731856e-02 1 1  ON 22
 eO_3                 2.961856e-01 1 1  ON 23
 eO_4                 5.144018e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325537e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607662e-02 1 1  ON 29
eH1_0                -2.327719e-01 1 1  ON 30
eH1_1                -1.347907e-01 1 1  ON 31
eH1_2                -8.948989e-02 1 1  ON 32
eH1_3                -3.620912e-02 1 1  ON 33
eH1_4                 1.124570e-02 1 1  ON 34
eH1_5                 4.432653e-02 1 1  ON 35
eH1_6                 9.878777e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240954e-02 1 1  ON 39
eH2_0                -2.305155e-01 1 1  ON 40
eH2_1                -1.320980e-01 1 1  ON 41
eH2_2                -8.663021e-02 1 1  ON 42
eH2_3                -3.358774e-02 1 1  ON 43
eH2_4                 1.351582e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618706e-01 1 1  ON 48
eH2_9                 2.459316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9191
    reference variance = 0.358369
====================================================
  Execution time = 2.0089e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3037e-01
  Total weights = 2.0000e+06
  Execution time = 1.8679e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330430807986
                                         uncertainty =       0.003821528944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330430807986
                                         uncertainty =       0.003821528944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406428244
  error estimate for blocks of size 2^( 2) =       0.000419474752
  error estimate for blocks of size 2^( 3) =       0.000433040867
  error estimate for blocks of size 2^( 4) =       0.000445814178
  error estimate for blocks of size 2^( 5) =       0.000456511690
  error estimate for blocks of size 2^( 6) =       0.000465723144
  error estimate for blocks of size 2^( 7) =       0.000471597702

      target function =                  N/A
              le_mean =     -16.905940189219
             les_mean =     286.141181351619
             stat err =       0.000459911678
             autocorr =       1.280504512382
              std dev =       0.574776335080
             le_variance =       0.330367835368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330430948575
                                         uncertainty =       0.003821532168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330430948575
                                         uncertainty =       0.003821532168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406428331
  error estimate for blocks of size 2^( 2) =       0.000419474829
  error estimate for blocks of size 2^( 3) =       0.000433040934
  error estimate for blocks of size 2^( 4) =       0.000445814239
  error estimate for blocks of size 2^( 5) =       0.000456511750
  error estimate for blocks of size 2^( 6) =       0.000465723200
  error estimate for blocks of size 2^( 7) =       0.000471597755

      target function =                  N/A
              le_mean =     -16.905940188615
             les_mean =     286.141181471748
             stat err =       0.000459911736
             autocorr =       1.280504287041
              std dev =       0.574776457335
             le_variance =       0.330367975906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330430878281
                                         uncertainty =       0.003821530556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330430878281
                                         uncertainty =       0.003821530556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406428287
  error estimate for blocks of size 2^( 2) =       0.000419474791
  error estimate for blocks of size 2^( 3) =       0.000433040901
  error estimate for blocks of size 2^( 4) =       0.000445814208
  error estimate for blocks of size 2^( 5) =       0.000456511720
  error estimate for blocks of size 2^( 6) =       0.000465723172
  error estimate for blocks of size 2^( 7) =       0.000471597728

      target function =                  N/A
              le_mean =     -16.905940188917
             les_mean =     286.141181411681
             stat err =       0.000459911707
             autocorr =       1.280504399702
              std dev =       0.574776396207
             le_variance =       0.330367905637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330430816773
                                         uncertainty =       0.003821529145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330430816773
                                         uncertainty =       0.003821529145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406428250
  error estimate for blocks of size 2^( 2) =       0.000419474757
  error estimate for blocks of size 2^( 3) =       0.000433040872
  error estimate for blocks of size 2^( 4) =       0.000445814182
  error estimate for blocks of size 2^( 5) =       0.000456511694
  error estimate for blocks of size 2^( 6) =       0.000465723147
  error estimate for blocks of size 2^( 7) =       0.000471597705

      target function =                  N/A
              le_mean =     -16.905940189181
             les_mean =     286.141181359127
             stat err =       0.000459911682
             autocorr =       1.280504498300
              std dev =       0.574776342721
             le_variance =       0.330367844152


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905940189219        initial  <--
     1.4552e+03     1.4552e+04             3.2110e-07       -16.905940188615
     5.8208e+03     5.8208e+04             8.0280e-08       -16.905940188917
     2.3283e+04     2.3283e+05             2.0070e-08       -16.905940189181

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.6036
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090951e-02 1 1  ON 2
 uu_3                -2.057438e-02 1 1  ON 3
 uu_4                -6.445347e-02 1 1  ON 4
 uu_5                -9.747226e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655172e-02 1 1  ON 9
 ud_0                 4.416350e-01 1 1  ON 10
 ud_1                 1.772624e-01 1 1  ON 11
 ud_2                 5.928216e-02 1 1  ON 12
 ud_3                -9.624489e-03 1 1  ON 13
 ud_4                -6.543535e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493555e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731857e-02 1 1  ON 22
 eO_3                 2.961856e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325537e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607660e-02 1 1  ON 29
eH1_0                -2.327718e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948991e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432652e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240952e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663022e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351577e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459313e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0833e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9042
    reference variance = 0.158214
====================================================
  Execution time = 2.0419e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3263e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5281e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332651688188
                                         uncertainty =       0.002863645183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332651688188
                                         uncertainty =       0.002863645183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407815255
  error estimate for blocks of size 2^( 2) =       0.000421150745
  error estimate for blocks of size 2^( 3) =       0.000434550020
  error estimate for blocks of size 2^( 4) =       0.000446713817
  error estimate for blocks of size 2^( 5) =       0.000457920836
  error estimate for blocks of size 2^( 6) =       0.000466084041
  error estimate for blocks of size 2^( 7) =       0.000471923727

      target function =                  N/A
              le_mean =     -16.906047266541
             les_mean =     286.147060577239
             stat err =       0.000460660605
             autocorr =       1.275954571626
              std dev =       0.576737865096
             le_variance =       0.332626565035


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690604726654e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906047266541       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906047266777       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906047266881       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906047266895       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906047266908       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906047266911       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906047266929       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906047266920       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 3.515560e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906047266541       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906047266600       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906047266626       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906047266654       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906047266645       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906047266625       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906047266642       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906047266647       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 8.788948e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906047266541       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906047266556       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906047266562       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906047266563       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906047266515       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906047266645       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906047266589       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906047266615       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 2.197240e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102766 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5955e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090951e-02 1 1  ON 2
 uu_3                -2.057438e-02 1 1  ON 3
 uu_4                -6.445347e-02 1 1  ON 4
 uu_5                -9.747226e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655172e-02 1 1  ON 9
 ud_0                 4.416351e-01 1 1  ON 10
 ud_1                 1.772624e-01 1 1  ON 11
 ud_2                 5.928216e-02 1 1  ON 12
 ud_3                -9.624493e-03 1 1  ON 13
 ud_4                -6.543535e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493555e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731856e-02 1 1  ON 22
 eO_3                 2.961856e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325537e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607660e-02 1 1  ON 29
eH1_0                -2.327718e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948991e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432652e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240952e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320980e-01 1 1  ON 41
eH2_2                -8.663022e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351577e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9731
    reference variance = 0.15006
====================================================
  Execution time = 2.0221e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3769e-01
  Total weights = 2.0000e+06
  Execution time = 1.8706e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337727180655
                                         uncertainty =       0.003787518375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337727180655
                                         uncertainty =       0.003787518375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410907448
  error estimate for blocks of size 2^( 2) =       0.000424070390
  error estimate for blocks of size 2^( 3) =       0.000437498141
  error estimate for blocks of size 2^( 4) =       0.000451410636
  error estimate for blocks of size 2^( 5) =       0.000462812333
  error estimate for blocks of size 2^( 6) =       0.000471775623
  error estimate for blocks of size 2^( 7) =       0.000477448577

      target function =                  N/A
              le_mean =     -16.905757731349
             les_mean =     286.142334163608
             stat err =       0.000465861792
             autocorr =       1.285364082129
              std dev =       0.581110885615
             le_variance =       0.337689861380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337727208557
                                         uncertainty =       0.003787518572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337727208557
                                         uncertainty =       0.003787518572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410907465
  error estimate for blocks of size 2^( 2) =       0.000424070406
  error estimate for blocks of size 2^( 3) =       0.000437498155
  error estimate for blocks of size 2^( 4) =       0.000451410649
  error estimate for blocks of size 2^( 5) =       0.000462812346
  error estimate for blocks of size 2^( 6) =       0.000471775635
  error estimate for blocks of size 2^( 7) =       0.000477448590

      target function =                  N/A
              le_mean =     -16.905757731295
             les_mean =     286.142334189707
             stat err =       0.000465861805
             autocorr =       1.285364046979
              std dev =       0.581110909643
             le_variance =       0.337689889306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337727194606
                                         uncertainty =       0.003787518473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337727194606
                                         uncertainty =       0.003787518473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410907456
  error estimate for blocks of size 2^( 2) =       0.000424070398
  error estimate for blocks of size 2^( 3) =       0.000437498148
  error estimate for blocks of size 2^( 4) =       0.000451410642
  error estimate for blocks of size 2^( 5) =       0.000462812340
  error estimate for blocks of size 2^( 6) =       0.000471775629
  error estimate for blocks of size 2^( 7) =       0.000477448583

      target function =                  N/A
              le_mean =     -16.905757731322
             les_mean =     286.142334176658
             stat err =       0.000465861799
             autocorr =       1.285364064550
              std dev =       0.581110897629
             le_variance =       0.337689875343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337727182399
                                         uncertainty =       0.003787518387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337727182399
                                         uncertainty =       0.003787518387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410907449
  error estimate for blocks of size 2^( 2) =       0.000424070391
  error estimate for blocks of size 2^( 3) =       0.000437498142
  error estimate for blocks of size 2^( 4) =       0.000451410636
  error estimate for blocks of size 2^( 5) =       0.000462812334
  error estimate for blocks of size 2^( 6) =       0.000471775624
  error estimate for blocks of size 2^( 7) =       0.000477448578

      target function =                  N/A
              le_mean =     -16.905757731346
             les_mean =     286.142334165239
             stat err =       0.000465861793
             autocorr =       1.285364079939
              std dev =       0.581110887117
             le_variance =       0.337689863125


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905757731349        initial  <--
     1.4552e+04     1.4552e+05             3.5156e-08       -16.905757731295
     5.8208e+04     5.8208e+05             8.7889e-09       -16.905757731322
     2.3283e+05     2.3283e+06             2.1972e-09       -16.905757731346

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6758
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090951e-02 1 1  ON 2
 uu_3                -2.057438e-02 1 1  ON 3
 uu_4                -6.445347e-02 1 1  ON 4
 uu_5                -9.747226e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655172e-02 1 1  ON 9
 ud_0                 4.416350e-01 1 1  ON 10
 ud_1                 1.772624e-01 1 1  ON 11
 ud_2                 5.928216e-02 1 1  ON 12
 ud_3                -9.624489e-03 1 1  ON 13
 ud_4                -6.543535e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493555e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731857e-02 1 1  ON 22
 eO_3                 2.961856e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325537e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607660e-02 1 1  ON 29
eH1_0                -2.327718e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948991e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432652e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240952e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663022e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351577e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459313e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5637e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9095
    reference variance = 0.622633
====================================================
  Execution time = 2.0405e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6065e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5996e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360704002063
                                         uncertainty =       0.018450466950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360704002063
                                         uncertainty =       0.018450466950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424646640
  error estimate for blocks of size 2^( 2) =       0.000437075778
  error estimate for blocks of size 2^( 3) =       0.000449564759
  error estimate for blocks of size 2^( 4) =       0.000461599806
  error estimate for blocks of size 2^( 5) =       0.000471850789
  error estimate for blocks of size 2^( 6) =       0.000479657421
  error estimate for blocks of size 2^( 7) =       0.000486532320

      target function =                  N/A
              le_mean =     -16.906140692103
             les_mean =     286.178242457996
             stat err =       0.000474910084
             autocorr =       1.250741035897
              std dev =       0.600541037018
             le_variance =       0.360649537143


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690614069210e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906140692103       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906140692111       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906140692136       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906140692110       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906140692147       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906140692142       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906140692176       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906140692048       residual = 9.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 3.743316e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906140692103       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906140692105       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906140692111       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906140692032       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906140692153       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906140692178       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906140692316       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906140692594       residual = 9.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 9.358295e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906140692103       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906140692103       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906140692105       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906140692445       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906140692104       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906140692859       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906140689956       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906140690429       residual = 9.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 2.339574e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.105395 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6012e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090951e-02 1 1  ON 2
 uu_3                -2.057438e-02 1 1  ON 3
 uu_4                -6.445347e-02 1 1  ON 4
 uu_5                -9.747226e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655172e-02 1 1  ON 9
 ud_0                 4.416350e-01 1 1  ON 10
 ud_1                 1.772624e-01 1 1  ON 11
 ud_2                 5.928216e-02 1 1  ON 12
 ud_3                -9.624489e-03 1 1  ON 13
 ud_4                -6.543535e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493555e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731857e-02 1 1  ON 22
 eO_3                 2.961856e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325537e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607660e-02 1 1  ON 29
eH1_0                -2.327718e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948991e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432652e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240952e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663022e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351577e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459313e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9262
    reference variance = 0.389497
====================================================
  Execution time = 2.0446e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3591e-01
  Total weights = 2.0000e+06
  Execution time = 1.8708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335974469359
                                         uncertainty =       0.005339446825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335974469359
                                         uncertainty =       0.005339446825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409820543
  error estimate for blocks of size 2^( 2) =       0.000422806129
  error estimate for blocks of size 2^( 3) =       0.000436037039
  error estimate for blocks of size 2^( 4) =       0.000449082237
  error estimate for blocks of size 2^( 5) =       0.000460660856
  error estimate for blocks of size 2^( 6) =       0.000468511081
  error estimate for blocks of size 2^( 7) =       0.000474262537

      target function =                  N/A
              le_mean =     -16.906420075778
             les_mean =     286.162945366212
             stat err =       0.000463129178
             autocorr =       1.277076273610
              std dev =       0.579573770536
             le_variance =       0.335905755493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335974471997
                                         uncertainty =       0.005339446849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335974471997
                                         uncertainty =       0.005339446849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409820545
  error estimate for blocks of size 2^( 2) =       0.000422806131
  error estimate for blocks of size 2^( 3) =       0.000436037040
  error estimate for blocks of size 2^( 4) =       0.000449082239
  error estimate for blocks of size 2^( 5) =       0.000460660857
  error estimate for blocks of size 2^( 6) =       0.000468511082
  error estimate for blocks of size 2^( 7) =       0.000474262538

      target function =                  N/A
              le_mean =     -16.906420075773
             les_mean =     286.162945368671
             stat err =       0.000463129179
             autocorr =       1.277076270093
              std dev =       0.579573772811
             le_variance =       0.335905758130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335974470678
                                         uncertainty =       0.005339446837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335974470678
                                         uncertainty =       0.005339446837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409820544
  error estimate for blocks of size 2^( 2) =       0.000422806130
  error estimate for blocks of size 2^( 3) =       0.000436037040
  error estimate for blocks of size 2^( 4) =       0.000449082238
  error estimate for blocks of size 2^( 5) =       0.000460660857
  error estimate for blocks of size 2^( 6) =       0.000468511082
  error estimate for blocks of size 2^( 7) =       0.000474262537

      target function =                  N/A
              le_mean =     -16.906420075775
             les_mean =     286.162945367442
             stat err =       0.000463129178
             autocorr =       1.277076271856
              std dev =       0.579573771674
             le_variance =       0.335905756812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335974469524
                                         uncertainty =       0.005339446827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335974469524
                                         uncertainty =       0.005339446827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409820543
  error estimate for blocks of size 2^( 2) =       0.000422806130
  error estimate for blocks of size 2^( 3) =       0.000436037039
  error estimate for blocks of size 2^( 4) =       0.000449082237
  error estimate for blocks of size 2^( 5) =       0.000460660856
  error estimate for blocks of size 2^( 6) =       0.000468511081
  error estimate for blocks of size 2^( 7) =       0.000474262537

      target function =                  N/A
              le_mean =     -16.906420075778
             les_mean =     286.162945366366
             stat err =       0.000463129178
             autocorr =       1.277076273396
              std dev =       0.579573770678
             le_variance =       0.335905755658


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906420075778        initial  <--
     1.4552e+05     1.4552e+06             3.7433e-09       -16.906420075773
     5.8208e+05     5.8208e+06             9.3583e-10       -16.906420075775
     2.3283e+06     2.3283e+07             2.3396e-10       -16.906420075778

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9115
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090951e-02 1 1  ON 2
 uu_3                -2.057438e-02 1 1  ON 3
 uu_4                -6.445347e-02 1 1  ON 4
 uu_5                -9.747226e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655172e-02 1 1  ON 9
 ud_0                 4.416350e-01 1 1  ON 10
 ud_1                 1.772624e-01 1 1  ON 11
 ud_2                 5.928216e-02 1 1  ON 12
 ud_3                -9.624489e-03 1 1  ON 13
 ud_4                -6.543535e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493555e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731857e-02 1 1  ON 22
 eO_3                 2.961856e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325537e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607660e-02 1 1  ON 29
eH1_0                -2.327718e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948991e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432652e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240952e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663022e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351577e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459313e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5930e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9285
    reference variance = 0.250847
====================================================
  Execution time = 2.0479e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4140e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5768e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341192470911
                                         uncertainty =       0.008249744504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341192470911
                                         uncertainty =       0.008249744504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413159816
  error estimate for blocks of size 2^( 2) =       0.000425595007
  error estimate for blocks of size 2^( 3) =       0.000438812144
  error estimate for blocks of size 2^( 4) =       0.000450520833
  error estimate for blocks of size 2^( 5) =       0.000461446366
  error estimate for blocks of size 2^( 6) =       0.000469741378
  error estimate for blocks of size 2^( 7) =       0.000475054326

      target function =                  N/A
              le_mean =     -16.905304491004
             les_mean =     286.130721830702
             stat err =       0.000464190726
             autocorr =       1.262283097065
              std dev =       0.584296215848
             le_variance =       0.341402067854


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690530449100e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905304491004       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905304491006       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905304491007       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905304491008       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905304491007       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905304491638       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905304491782       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905304491194       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905304491165       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 4.037197e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905304491004       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905304491004       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905304491005       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905304491005       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905304489055       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905304491570       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905304490823       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905304493576       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905304485433       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 1.009298e-10

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905304491004       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905304491004       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905304491004       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905304491004       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905304491004       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905304498052       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905304492496       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905304490523       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905304471099       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 2.523245e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108443 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6063e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090951e-02 1 1  ON 2
 uu_3                -2.057438e-02 1 1  ON 3
 uu_4                -6.445347e-02 1 1  ON 4
 uu_5                -9.747226e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655172e-02 1 1  ON 9
 ud_0                 4.416350e-01 1 1  ON 10
 ud_1                 1.772624e-01 1 1  ON 11
 ud_2                 5.928216e-02 1 1  ON 12
 ud_3                -9.624489e-03 1 1  ON 13
 ud_4                -6.543535e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493555e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731857e-02 1 1  ON 22
 eO_3                 2.961856e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325537e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607660e-02 1 1  ON 29
eH1_0                -2.327718e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948991e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432652e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240952e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663022e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351577e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459313e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9079
    reference variance = 0.245387
====================================================
  Execution time = 2.0583e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4705e-01
  Total weights = 2.0000e+06
  Execution time = 1.8760e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347134528956
                                         uncertainty =       0.007885701641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347134528956
                                         uncertainty =       0.007885701641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416564290
  error estimate for blocks of size 2^( 2) =       0.000429201609
  error estimate for blocks of size 2^( 3) =       0.000442618193
  error estimate for blocks of size 2^( 4) =       0.000454696647
  error estimate for blocks of size 2^( 5) =       0.000466754876
  error estimate for blocks of size 2^( 6) =       0.000475150988
  error estimate for blocks of size 2^( 7) =       0.000480019434

      target function =                  N/A
              le_mean =     -16.906121929680
             les_mean =     286.164010143671
             stat err =       0.000469155486
             autocorr =       1.268438815772
              std dev =       0.589110869013
             le_variance =       0.347051615989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347134529271
                                         uncertainty =       0.007885701645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347134529271
                                         uncertainty =       0.007885701645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416564291
  error estimate for blocks of size 2^( 2) =       0.000429201609
  error estimate for blocks of size 2^( 3) =       0.000442618193
  error estimate for blocks of size 2^( 4) =       0.000454696648
  error estimate for blocks of size 2^( 5) =       0.000466754876
  error estimate for blocks of size 2^( 6) =       0.000475150988
  error estimate for blocks of size 2^( 7) =       0.000480019434

      target function =                  N/A
              le_mean =     -16.906121929681
             les_mean =     286.164010144021
             stat err =       0.000469155487
             autocorr =       1.268438815435
              std dev =       0.589110869280
             le_variance =       0.347051616304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347134529113
                                         uncertainty =       0.007885701643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347134529113
                                         uncertainty =       0.007885701643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416564290
  error estimate for blocks of size 2^( 2) =       0.000429201609
  error estimate for blocks of size 2^( 3) =       0.000442618193
  error estimate for blocks of size 2^( 4) =       0.000454696648
  error estimate for blocks of size 2^( 5) =       0.000466754876
  error estimate for blocks of size 2^( 6) =       0.000475150988
  error estimate for blocks of size 2^( 7) =       0.000480019434

      target function =                  N/A
              le_mean =     -16.906121929681
             les_mean =     286.164010143846
             stat err =       0.000469155486
             autocorr =       1.268438815605
              std dev =       0.589110869147
             le_variance =       0.347051616147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347134528975
                                         uncertainty =       0.007885701641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347134528975
                                         uncertainty =       0.007885701641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416564290
  error estimate for blocks of size 2^( 2) =       0.000429201609
  error estimate for blocks of size 2^( 3) =       0.000442618193
  error estimate for blocks of size 2^( 4) =       0.000454696647
  error estimate for blocks of size 2^( 5) =       0.000466754876
  error estimate for blocks of size 2^( 6) =       0.000475150988
  error estimate for blocks of size 2^( 7) =       0.000480019434

      target function =                  N/A
              le_mean =     -16.906121929680
             les_mean =     286.164010143693
             stat err =       0.000469155486
             autocorr =       1.268438815754
              std dev =       0.589110869030
             le_variance =       0.347051616009


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906121929680        initial
     1.4552e+06     1.4552e+07             4.0372e-10       -16.906121929681  <--
     5.8208e+06     5.8208e+07             1.0093e-10       -16.906121929681
     2.3283e+07     2.3283e+08             2.5232e-11       -16.906121929680

*****************************************************************************
Applying the update for shift_i =   1.4552e+06     and shift_s =   1.4552e+07
*****************************************************************************

  Execution time = 3.0083e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090951e-02 1 1  ON 2
 uu_3                -2.057438e-02 1 1  ON 3
 uu_4                -6.445347e-02 1 1  ON 4
 uu_5                -9.747226e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655172e-02 1 1  ON 9
 ud_0                 4.416350e-01 1 1  ON 10
 ud_1                 1.772624e-01 1 1  ON 11
 ud_2                 5.928216e-02 1 1  ON 12
 ud_3                -9.624489e-03 1 1  ON 13
 ud_4                -6.543535e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493555e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731857e-02 1 1  ON 22
 eO_3                 2.961856e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325537e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607660e-02 1 1  ON 29
eH1_0                -2.327718e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948991e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432652e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240952e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663022e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351577e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459313e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6250e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9061
    reference variance = 0.269644
====================================================
  Execution time = 2.0552e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6240e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6655e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362459878213
                                         uncertainty =       0.017738633259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362459878213
                                         uncertainty =       0.017738633259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425677179
  error estimate for blocks of size 2^( 2) =       0.000437909016
  error estimate for blocks of size 2^( 3) =       0.000450267892
  error estimate for blocks of size 2^( 4) =       0.000462772645
  error estimate for blocks of size 2^( 5) =       0.000474023450
  error estimate for blocks of size 2^( 6) =       0.000483091153
  error estimate for blocks of size 2^( 7) =       0.000489379522

      target function =                  N/A
              le_mean =     -16.905571643525
             les_mean =     286.160754533890
             stat err =       0.000477316692
             autocorr =       1.257339357927
              std dev =       0.601998439149
             le_variance =       0.362402120738


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690557164352e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905571643525       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905571643528       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905571643530       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905571643627       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905571643741       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905571643262       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905571643886       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905571643093       residual = 9.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 1.302663e-09

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905571643525       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905571643526       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905571643526       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905571643509       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905571644247       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905571643115       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905571643392       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905571644307       residual = 9.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 3.256659e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905571643525       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905571643525       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905571643525       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905571647778       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905571643581       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905571639178       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905571642776       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905571642101       residual = 9.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 8.141634e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111010 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6225e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090951e-02 1 1  ON 2
 uu_3                -2.057438e-02 1 1  ON 3
 uu_4                -6.445347e-02 1 1  ON 4
 uu_5                -9.747226e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655172e-02 1 1  ON 9
 ud_0                 4.416350e-01 1 1  ON 10
 ud_1                 1.772624e-01 1 1  ON 11
 ud_2                 5.928216e-02 1 1  ON 12
 ud_3                -9.624489e-03 1 1  ON 13
 ud_4                -6.543535e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493555e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731857e-02 1 1  ON 22
 eO_3                 2.961856e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325537e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607660e-02 1 1  ON 29
eH1_0                -2.327718e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948991e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432652e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240952e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663022e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351577e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459313e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9105
    reference variance = 0.2743
====================================================
  Execution time = 2.0567e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4944e-01
  Total weights = 2.0000e+06
  Execution time = 1.8780e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349474772017
                                         uncertainty =       0.009557789284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349474772017
                                         uncertainty =       0.009557789284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417993249
  error estimate for blocks of size 2^( 2) =       0.000430250229
  error estimate for blocks of size 2^( 3) =       0.000442436237
  error estimate for blocks of size 2^( 4) =       0.000454524527
  error estimate for blocks of size 2^( 5) =       0.000464456270
  error estimate for blocks of size 2^( 6) =       0.000470675502
  error estimate for blocks of size 2^( 7) =       0.000474457114

      target function =                  N/A
              le_mean =     -16.906417291838
             les_mean =     286.176382183377
             stat err =       0.000466028353
             autocorr =       1.243042980034
              std dev =       0.591131721652
             le_variance =       0.349436712343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349474773160
                                         uncertainty =       0.009557789329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349474773160
                                         uncertainty =       0.009557789329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417993250
  error estimate for blocks of size 2^( 2) =       0.000430250229
  error estimate for blocks of size 2^( 3) =       0.000442436238
  error estimate for blocks of size 2^( 4) =       0.000454524528
  error estimate for blocks of size 2^( 5) =       0.000464456270
  error estimate for blocks of size 2^( 6) =       0.000470675503
  error estimate for blocks of size 2^( 7) =       0.000474457114

      target function =                  N/A
              le_mean =     -16.906417291843
             les_mean =     286.176382184689
             stat err =       0.000466028354
             autocorr =       1.243042978796
              std dev =       0.591131722619
             le_variance =       0.349436713486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349474772589
                                         uncertainty =       0.009557789306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349474772589
                                         uncertainty =       0.009557789306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417993249
  error estimate for blocks of size 2^( 2) =       0.000430250229
  error estimate for blocks of size 2^( 3) =       0.000442436237
  error estimate for blocks of size 2^( 4) =       0.000454524528
  error estimate for blocks of size 2^( 5) =       0.000464456270
  error estimate for blocks of size 2^( 6) =       0.000470675503
  error estimate for blocks of size 2^( 7) =       0.000474457114

      target function =                  N/A
              le_mean =     -16.906417291840
             les_mean =     286.176382184033
             stat err =       0.000466028354
             autocorr =       1.243042979415
              std dev =       0.591131722135
             le_variance =       0.349436712915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349474772089
                                         uncertainty =       0.009557789286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349474772089
                                         uncertainty =       0.009557789286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417993249
  error estimate for blocks of size 2^( 2) =       0.000430250229
  error estimate for blocks of size 2^( 3) =       0.000442436237
  error estimate for blocks of size 2^( 4) =       0.000454524527
  error estimate for blocks of size 2^( 5) =       0.000464456270
  error estimate for blocks of size 2^( 6) =       0.000470675502
  error estimate for blocks of size 2^( 7) =       0.000474457114

      target function =                  N/A
              le_mean =     -16.906417291838
             les_mean =     286.176382183459
             stat err =       0.000466028353
             autocorr =       1.243042979954
              std dev =       0.591131721712
             le_variance =       0.349436712415


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906417291838        initial
     3.6380e+05     3.6380e+06             1.3027e-09       -16.906417291843  <--
     1.4552e+06     1.4552e+07             3.2567e-10       -16.906417291840
     5.8208e+06     5.8208e+07             8.1416e-11       -16.906417291838

*****************************************************************************
Applying the update for shift_i =   3.6380e+05     and shift_s =   3.6380e+06
*****************************************************************************

  Execution time = 3.0077e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090951e-02 1 1  ON 2
 uu_3                -2.057438e-02 1 1  ON 3
 uu_4                -6.445347e-02 1 1  ON 4
 uu_5                -9.747226e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655172e-02 1 1  ON 9
 ud_0                 4.416350e-01 1 1  ON 10
 ud_1                 1.772624e-01 1 1  ON 11
 ud_2                 5.928216e-02 1 1  ON 12
 ud_3                -9.624490e-03 1 1  ON 13
 ud_4                -6.543535e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493555e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731857e-02 1 1  ON 22
 eO_3                 2.961856e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325537e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607660e-02 1 1  ON 29
eH1_0                -2.327718e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948991e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432652e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240952e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663022e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351577e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459313e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6337e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8598
    reference variance = 0.210695
====================================================
  Execution time = 2.0663e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3264e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5783e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332703412700
                                         uncertainty =       0.002673808404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332703412700
                                         uncertainty =       0.002673808404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407825225
  error estimate for blocks of size 2^( 2) =       0.000421449033
  error estimate for blocks of size 2^( 3) =       0.000434848870
  error estimate for blocks of size 2^( 4) =       0.000447344423
  error estimate for blocks of size 2^( 5) =       0.000459827808
  error estimate for blocks of size 2^( 6) =       0.000469896458
  error estimate for blocks of size 2^( 7) =       0.000476008421

      target function =                  N/A
              le_mean =     -16.905943947814
             les_mean =     286.143583428657
             stat err =       0.000463269277
             autocorr =       1.290383589248
              std dev =       0.576751964311
             le_variance =       0.332642828337


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690594394781e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905943947814       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905943947812       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905943947819       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905943947833       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905943947847       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905943948036       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905943947899       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905943947856       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905943947735       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 6.697975e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905943947814       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905943947814       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905943947815       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905943947897       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905943947821       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905943947614       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905943947765       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905943947752       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905943947638       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 1.674496e-09

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905943947814       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905943947814       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905943947815       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905943947816       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905943947398       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905943948306       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905943947967       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905943948109       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905943947210       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 4.186237e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.113973 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6249e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090951e-02 1 1  ON 2
 uu_3                -2.057438e-02 1 1  ON 3
 uu_4                -6.445347e-02 1 1  ON 4
 uu_5                -9.747226e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655172e-02 1 1  ON 9
 ud_0                 4.416350e-01 1 1  ON 10
 ud_1                 1.772624e-01 1 1  ON 11
 ud_2                 5.928216e-02 1 1  ON 12
 ud_3                -9.624490e-03 1 1  ON 13
 ud_4                -6.543535e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493555e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731856e-02 1 1  ON 22
 eO_3                 2.961856e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325537e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607660e-02 1 1  ON 29
eH1_0                -2.327718e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948991e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432652e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240952e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663022e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351577e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459313e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9359
    reference variance = 0.251388
====================================================
  Execution time = 2.2313e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3106e-01
  Total weights = 2.0000e+06
  Execution time = 1.8645e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330900548054
                                         uncertainty =       0.002916741728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330900548054
                                         uncertainty =       0.002916741728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406854530
  error estimate for blocks of size 2^( 2) =       0.000419307901
  error estimate for blocks of size 2^( 3) =       0.000432960316
  error estimate for blocks of size 2^( 4) =       0.000444762710
  error estimate for blocks of size 2^( 5) =       0.000455632121
  error estimate for blocks of size 2^( 6) =       0.000463132953
  error estimate for blocks of size 2^( 7) =       0.000465143854

      target function =                  N/A
              le_mean =     -16.905490769019
             les_mean =     286.126679192565
             stat err =       0.000457167910
             autocorr =       1.262621455453
              std dev =       0.575379193858
             le_variance =       0.331061216725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330900552435
                                         uncertainty =       0.002916741771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330900552435
                                         uncertainty =       0.002916741771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406854532
  error estimate for blocks of size 2^( 2) =       0.000419307904
  error estimate for blocks of size 2^( 3) =       0.000432960318
  error estimate for blocks of size 2^( 4) =       0.000444762712
  error estimate for blocks of size 2^( 5) =       0.000455632123
  error estimate for blocks of size 2^( 6) =       0.000463132955
  error estimate for blocks of size 2^( 7) =       0.000465143856

      target function =                  N/A
              le_mean =     -16.905490768991
             les_mean =     286.126679196007
             stat err =       0.000457167912
             autocorr =       1.262621449937
              std dev =       0.575379197666
             le_variance =       0.331061221107

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330900550244
                                         uncertainty =       0.002916741750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330900550244
                                         uncertainty =       0.002916741750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406854531
  error estimate for blocks of size 2^( 2) =       0.000419307903
  error estimate for blocks of size 2^( 3) =       0.000432960317
  error estimate for blocks of size 2^( 4) =       0.000444762711
  error estimate for blocks of size 2^( 5) =       0.000455632122
  error estimate for blocks of size 2^( 6) =       0.000463132954
  error estimate for blocks of size 2^( 7) =       0.000465143855

      target function =                  N/A
              le_mean =     -16.905490769005
             les_mean =     286.126679194286
             stat err =       0.000457167911
             autocorr =       1.262621452684
              std dev =       0.575379195762
             le_variance =       0.331061218916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330900548328
                                         uncertainty =       0.002916741731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330900548328
                                         uncertainty =       0.002916741731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406854530
  error estimate for blocks of size 2^( 2) =       0.000419307902
  error estimate for blocks of size 2^( 3) =       0.000432960316
  error estimate for blocks of size 2^( 4) =       0.000444762710
  error estimate for blocks of size 2^( 5) =       0.000455632122
  error estimate for blocks of size 2^( 6) =       0.000463132953
  error estimate for blocks of size 2^( 7) =       0.000465143854

      target function =                  N/A
              le_mean =     -16.905490769017
             les_mean =     286.126679192780
             stat err =       0.000457167910
             autocorr =       1.262621455104
              std dev =       0.575379194097
             le_variance =       0.331061216999


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905490769019        initial  <--
     9.0949e+04     9.0949e+05             6.6980e-09       -16.905490768991
     3.6380e+05     3.6380e+06             1.6745e-09       -16.905490769005
     1.4552e+06     1.4552e+07             4.1862e-10       -16.905490769017

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.7594
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090951e-02 1 1  ON 2
 uu_3                -2.057438e-02 1 1  ON 3
 uu_4                -6.445347e-02 1 1  ON 4
 uu_5                -9.747226e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655172e-02 1 1  ON 9
 ud_0                 4.416350e-01 1 1  ON 10
 ud_1                 1.772624e-01 1 1  ON 11
 ud_2                 5.928216e-02 1 1  ON 12
 ud_3                -9.624490e-03 1 1  ON 13
 ud_4                -6.543535e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493555e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731857e-02 1 1  ON 22
 eO_3                 2.961856e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325537e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607660e-02 1 1  ON 29
eH1_0                -2.327718e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948991e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432652e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240952e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663022e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351577e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459313e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8016e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9351
    reference variance = 0.284061
====================================================
  Execution time = 2.2470e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3452e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5616e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334453760130
                                         uncertainty =       0.002744903878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334453760130
                                         uncertainty =       0.002744903878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408972153
  error estimate for blocks of size 2^( 2) =       0.000422538242
  error estimate for blocks of size 2^( 3) =       0.000436174218
  error estimate for blocks of size 2^( 4) =       0.000448606361
  error estimate for blocks of size 2^( 5) =       0.000459114921
  error estimate for blocks of size 2^( 6) =       0.000467391591
  error estimate for blocks of size 2^( 7) =       0.000469817690

      target function =                  N/A
              le_mean =     -16.905974476674
             les_mean =     286.146489282798
             stat err =       0.000461232641
             autocorr =       1.271898901055
              std dev =       0.578373965607
             le_variance =       0.334516444092


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690597447667e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905974476674       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905974476676       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905974476678       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905974476641       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905974476888       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905974476680       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905974477047       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905974476473       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905974476779       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+05 is 6.804571e-10

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905974476674       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905974476675       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905974476675       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905974476675       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905974476676       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905974474236       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905974477099       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905974476613       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905974472145       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 1.701143e-10

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905974476674       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905974476674       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905974476675       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905974476724       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905974480418       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905974491784       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905974472740       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905974479581       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905974475240       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 4.252850e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116953 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8039e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090951e-02 1 1  ON 2
 uu_3                -2.057438e-02 1 1  ON 3
 uu_4                -6.445347e-02 1 1  ON 4
 uu_5                -9.747226e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655172e-02 1 1  ON 9
 ud_0                 4.416350e-01 1 1  ON 10
 ud_1                 1.772624e-01 1 1  ON 11
 ud_2                 5.928216e-02 1 1  ON 12
 ud_3                -9.624490e-03 1 1  ON 13
 ud_4                -6.543535e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493555e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731857e-02 1 1  ON 22
 eO_3                 2.961856e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325537e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607660e-02 1 1  ON 29
eH1_0                -2.327718e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948991e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432652e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240952e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663022e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351577e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459313e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8045
    reference variance = 0.198933
====================================================
  Execution time = 2.0462e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4383e-01
  Total weights = 2.0000e+06
  Execution time = 1.8641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343703357935
                                         uncertainty =       0.005708686800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343703357935
                                         uncertainty =       0.005708686800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414628048
  error estimate for blocks of size 2^( 2) =       0.000427286050
  error estimate for blocks of size 2^( 3) =       0.000440578211
  error estimate for blocks of size 2^( 4) =       0.000452813596
  error estimate for blocks of size 2^( 5) =       0.000463675447
  error estimate for blocks of size 2^( 6) =       0.000472258347
  error estimate for blocks of size 2^( 7) =       0.000477656492

      target function =                  N/A
              le_mean =     -16.906233271448
             les_mean =     286.164556093028
             stat err =       0.000466600970
             autocorr =       1.266408804682
              std dev =       0.586372608791
             le_variance =       0.343832836340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343703358309
                                         uncertainty =       0.005708686812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343703358309
                                         uncertainty =       0.005708686812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414628048
  error estimate for blocks of size 2^( 2) =       0.000427286050
  error estimate for blocks of size 2^( 3) =       0.000440578211
  error estimate for blocks of size 2^( 4) =       0.000452813596
  error estimate for blocks of size 2^( 5) =       0.000463675447
  error estimate for blocks of size 2^( 6) =       0.000472258347
  error estimate for blocks of size 2^( 7) =       0.000477656493

      target function =                  N/A
              le_mean =     -16.906233271446
             les_mean =     286.164556093362
             stat err =       0.000466600971
             autocorr =       1.266408804211
              std dev =       0.586372609110
             le_variance =       0.343832836715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343703358122
                                         uncertainty =       0.005708686806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343703358122
                                         uncertainty =       0.005708686806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414628048
  error estimate for blocks of size 2^( 2) =       0.000427286050
  error estimate for blocks of size 2^( 3) =       0.000440578211
  error estimate for blocks of size 2^( 4) =       0.000452813596
  error estimate for blocks of size 2^( 5) =       0.000463675447
  error estimate for blocks of size 2^( 6) =       0.000472258347
  error estimate for blocks of size 2^( 7) =       0.000477656492

      target function =                  N/A
              le_mean =     -16.906233271447
             les_mean =     286.164556093195
             stat err =       0.000466600971
             autocorr =       1.266408804441
              std dev =       0.586372608951
             le_variance =       0.343832836528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343703357958
                                         uncertainty =       0.005708686801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343703357958
                                         uncertainty =       0.005708686801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414628048
  error estimate for blocks of size 2^( 2) =       0.000427286050
  error estimate for blocks of size 2^( 3) =       0.000440578211
  error estimate for blocks of size 2^( 4) =       0.000452813596
  error estimate for blocks of size 2^( 5) =       0.000463675447
  error estimate for blocks of size 2^( 6) =       0.000472258347
  error estimate for blocks of size 2^( 7) =       0.000477656492

      target function =                  N/A
              le_mean =     -16.906233271448
             les_mean =     286.164556093049
             stat err =       0.000466600970
             autocorr =       1.266408804638
              std dev =       0.586372608811
             le_variance =       0.343832836364


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906233271448        initial  <--
     9.0949e+05     9.0949e+06             6.8046e-10       -16.906233271446
     3.6380e+06     3.6380e+07             1.7011e-10       -16.906233271447
     1.4552e+07     1.4552e+08             4.2528e-11       -16.906233271448

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8794
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090951e-02 1 1  ON 2
 uu_3                -2.057438e-02 1 1  ON 3
 uu_4                -6.445347e-02 1 1  ON 4
 uu_5                -9.747226e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655172e-02 1 1  ON 9
 ud_0                 4.416350e-01 1 1  ON 10
 ud_1                 1.772624e-01 1 1  ON 11
 ud_2                 5.928216e-02 1 1  ON 12
 ud_3                -9.624490e-03 1 1  ON 13
 ud_4                -6.543535e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493555e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731857e-02 1 1  ON 22
 eO_3                 2.961856e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325537e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607660e-02 1 1  ON 29
eH1_0                -2.327718e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948991e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432652e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240952e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663022e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351577e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459313e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8005e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9875
    reference variance = 0.363101
====================================================
  Execution time = 2.0581e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4104e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5399e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341147364248
                                         uncertainty =       0.004101715577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341147364248
                                         uncertainty =       0.004101715577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412940161
  error estimate for blocks of size 2^( 2) =       0.000425177148
  error estimate for blocks of size 2^( 3) =       0.000438163708
  error estimate for blocks of size 2^( 4) =       0.000450172343
  error estimate for blocks of size 2^( 5) =       0.000461002915
  error estimate for blocks of size 2^( 6) =       0.000469637698
  error estimate for blocks of size 2^( 7) =       0.000475783273

      target function =                  N/A
              le_mean =     -16.906272427672
             les_mean =     286.163086381027
             stat err =       0.000464149057
             autocorr =       1.263399498356
              std dev =       0.583985575931
             le_variance =       0.341039152896


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690627242767e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+06, overlap shift 9.0949e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906272427672       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906272427671       residual = 9.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906272427671       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906272427997       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906272423441       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906272426896       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906272434523       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906272420978       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+06 is 5.608216e-11

solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906272427672       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906272427672       residual = 9.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906272427672       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906272452243       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906272431092       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906272427261       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906272442495       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906272452321       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+07 is 1.402046e-11

solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906272427672       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906272427672       residual = 9.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906272427672       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906272423308       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906272444360       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906272440795       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906271438941       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906272660517       residual = 7.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+08 is 3.505622e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.119402 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6127e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090951e-02 1 1  ON 2
 uu_3                -2.057438e-02 1 1  ON 3
 uu_4                -6.445347e-02 1 1  ON 4
 uu_5                -9.747226e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655172e-02 1 1  ON 9
 ud_0                 4.416350e-01 1 1  ON 10
 ud_1                 1.772624e-01 1 1  ON 11
 ud_2                 5.928216e-02 1 1  ON 12
 ud_3                -9.624490e-03 1 1  ON 13
 ud_4                -6.543535e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493555e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731857e-02 1 1  ON 22
 eO_3                 2.961856e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325537e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607660e-02 1 1  ON 29
eH1_0                -2.327718e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948991e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432652e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240952e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663022e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351577e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459313e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9525
    reference variance = 0.373574
====================================================
  Execution time = 2.0384e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4061e-01
  Total weights = 2.0000e+06
  Execution time = 1.8667e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340632120885
                                         uncertainty =       0.004829438733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340632120885
                                         uncertainty =       0.004829438733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412678796
  error estimate for blocks of size 2^( 2) =       0.000425293881
  error estimate for blocks of size 2^( 3) =       0.000438953128
  error estimate for blocks of size 2^( 4) =       0.000450309492
  error estimate for blocks of size 2^( 5) =       0.000461591794
  error estimate for blocks of size 2^( 6) =       0.000468787471
  error estimate for blocks of size 2^( 7) =       0.000474920636

      target function =                  N/A
              le_mean =     -16.905423185673
             les_mean =     286.133940493217
             stat err =       0.000463902348
             autocorr =       1.263655911172
              std dev =       0.583615949783
             le_variance =       0.340607576841

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340632120936
                                         uncertainty =       0.004829438733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340632120936
                                         uncertainty =       0.004829438733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412678796
  error estimate for blocks of size 2^( 2) =       0.000425293882
  error estimate for blocks of size 2^( 3) =       0.000438953128
  error estimate for blocks of size 2^( 4) =       0.000450309492
  error estimate for blocks of size 2^( 5) =       0.000461591794
  error estimate for blocks of size 2^( 6) =       0.000468787471
  error estimate for blocks of size 2^( 7) =       0.000474920636

      target function =                  N/A
              le_mean =     -16.905423185673
             les_mean =     286.133940493273
             stat err =       0.000463902349
             autocorr =       1.263655911123
              std dev =       0.583615949827
             le_variance =       0.340607576892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340632120911
                                         uncertainty =       0.004829438733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340632120911
                                         uncertainty =       0.004829438733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412678796
  error estimate for blocks of size 2^( 2) =       0.000425293881
  error estimate for blocks of size 2^( 3) =       0.000438953128
  error estimate for blocks of size 2^( 4) =       0.000450309492
  error estimate for blocks of size 2^( 5) =       0.000461591794
  error estimate for blocks of size 2^( 6) =       0.000468787471
  error estimate for blocks of size 2^( 7) =       0.000474920636

      target function =                  N/A
              le_mean =     -16.905423185673
             les_mean =     286.133940493245
             stat err =       0.000463902349
             autocorr =       1.263655911148
              std dev =       0.583615949805
             le_variance =       0.340607576867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340632120888
                                         uncertainty =       0.004829438733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340632120888
                                         uncertainty =       0.004829438733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412678796
  error estimate for blocks of size 2^( 2) =       0.000425293881
  error estimate for blocks of size 2^( 3) =       0.000438953128
  error estimate for blocks of size 2^( 4) =       0.000450309492
  error estimate for blocks of size 2^( 5) =       0.000461591794
  error estimate for blocks of size 2^( 6) =       0.000468787471
  error estimate for blocks of size 2^( 7) =       0.000474920636

      target function =                  N/A
              le_mean =     -16.905423185673
             les_mean =     286.133940493221
             stat err =       0.000463902348
             autocorr =       1.263655911171
              std dev =       0.583615949786
             le_variance =       0.340607576844


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905423185673        initial
     9.0949e+06     9.0949e+07             5.6082e-11       -16.905423185673  <--
     3.6380e+07     3.6380e+08             1.4020e-11       -16.905423185673
     1.4552e+08     1.4552e+09             3.5056e-12       -16.905423185673

*****************************************************************************
Applying the update for shift_i =   9.0949e+06     and shift_s =   9.0949e+07
*****************************************************************************

  Execution time = 2.9830e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090951e-02 1 1  ON 2
 uu_3                -2.057438e-02 1 1  ON 3
 uu_4                -6.445347e-02 1 1  ON 4
 uu_5                -9.747226e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655172e-02 1 1  ON 9
 ud_0                 4.416350e-01 1 1  ON 10
 ud_1                 1.772624e-01 1 1  ON 11
 ud_2                 5.928216e-02 1 1  ON 12
 ud_3                -9.624490e-03 1 1  ON 13
 ud_4                -6.543535e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493555e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731857e-02 1 1  ON 22
 eO_3                 2.961856e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325537e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607660e-02 1 1  ON 29
eH1_0                -2.327718e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948991e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432652e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240952e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663022e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351577e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459313e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6007e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9029
    reference variance = 0.187258
====================================================
  Execution time = 2.0588e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3851e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5679e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338497030377
                                         uncertainty =       0.004389706631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338497030377
                                         uncertainty =       0.004389706631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411407361
  error estimate for blocks of size 2^( 2) =       0.000424573978
  error estimate for blocks of size 2^( 3) =       0.000437355842
  error estimate for blocks of size 2^( 4) =       0.000450081012
  error estimate for blocks of size 2^( 5) =       0.000460752151
  error estimate for blocks of size 2^( 6) =       0.000469298322
  error estimate for blocks of size 2^( 7) =       0.000471277523

      target function =                  N/A
              le_mean =     -16.905073864257
             les_mean =     286.120034220103
             stat err =       0.000462852252
             autocorr =       1.265728755240
              std dev =       0.581817869579
             le_variance =       0.338512033361


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690507386426e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+06, overlap shift 2.2737e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905073864257       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905073864259       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905073864260       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905073864261       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905073863762       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905073863343       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905073862780       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905073864916       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905073862845       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+06 is 2.558475e-10

solving harmonic davidson linear method for identity shift 9.0949e+06, overlap shift 9.0949e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905073864257       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905073864258       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905073864258       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905073864258       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905073865898       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905073862876       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905073859460       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905073852938       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905073862856       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+06 is 6.396127e-11

solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905073864257       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905073864257       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905073864258       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905073862996       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905073880688       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905073850750       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905073843441       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905073877207       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905073890095       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+07 is 1.599037e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.122306 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6163e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090951e-02 1 1  ON 2
 uu_3                -2.057438e-02 1 1  ON 3
 uu_4                -6.445347e-02 1 1  ON 4
 uu_5                -9.747226e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655172e-02 1 1  ON 9
 ud_0                 4.416350e-01 1 1  ON 10
 ud_1                 1.772624e-01 1 1  ON 11
 ud_2                 5.928216e-02 1 1  ON 12
 ud_3                -9.624490e-03 1 1  ON 13
 ud_4                -6.543535e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493555e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731857e-02 1 1  ON 22
 eO_3                 2.961856e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325537e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607660e-02 1 1  ON 29
eH1_0                -2.327718e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948991e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432652e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240952e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663022e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351577e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459313e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9793
    reference variance = 0.232884
====================================================
  Execution time = 2.0184e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3539e-01
  Total weights = 2.0000e+06
  Execution time = 1.8752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335424475004
                                         uncertainty =       0.004310862558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335424475004
                                         uncertainty =       0.004310862558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409505740
  error estimate for blocks of size 2^( 2) =       0.000422297881
  error estimate for blocks of size 2^( 3) =       0.000435833692
  error estimate for blocks of size 2^( 4) =       0.000448055855
  error estimate for blocks of size 2^( 5) =       0.000457132122
  error estimate for blocks of size 2^( 6) =       0.000463607979
  error estimate for blocks of size 2^( 7) =       0.000466944743

      target function =                  N/A
              le_mean =     -16.905891788918
             les_mean =     286.144566912797
             stat err =       0.000458935175
             autocorr =       1.255979941244
              std dev =       0.579128571105
             le_variance =       0.335389901870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335424475266
                                         uncertainty =       0.004310862562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335424475266
                                         uncertainty =       0.004310862562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409505740
  error estimate for blocks of size 2^( 2) =       0.000422297882
  error estimate for blocks of size 2^( 3) =       0.000435833692
  error estimate for blocks of size 2^( 4) =       0.000448055855
  error estimate for blocks of size 2^( 5) =       0.000457132122
  error estimate for blocks of size 2^( 6) =       0.000463607979
  error estimate for blocks of size 2^( 7) =       0.000466944743

      target function =                  N/A
              le_mean =     -16.905891788919
             les_mean =     286.144566913070
             stat err =       0.000458935175
             autocorr =       1.255979940974
              std dev =       0.579128571331
             le_variance =       0.335389902132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335424475135
                                         uncertainty =       0.004310862560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335424475135
                                         uncertainty =       0.004310862560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409505740
  error estimate for blocks of size 2^( 2) =       0.000422297881
  error estimate for blocks of size 2^( 3) =       0.000435833692
  error estimate for blocks of size 2^( 4) =       0.000448055855
  error estimate for blocks of size 2^( 5) =       0.000457132122
  error estimate for blocks of size 2^( 6) =       0.000463607979
  error estimate for blocks of size 2^( 7) =       0.000466944743

      target function =                  N/A
              le_mean =     -16.905891788919
             les_mean =     286.144566912933
             stat err =       0.000458935175
             autocorr =       1.255979941114
              std dev =       0.579128571218
             le_variance =       0.335389902001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335424475020
                                         uncertainty =       0.004310862558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335424475020
                                         uncertainty =       0.004310862558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409505740
  error estimate for blocks of size 2^( 2) =       0.000422297881
  error estimate for blocks of size 2^( 3) =       0.000435833692
  error estimate for blocks of size 2^( 4) =       0.000448055855
  error estimate for blocks of size 2^( 5) =       0.000457132122
  error estimate for blocks of size 2^( 6) =       0.000463607979
  error estimate for blocks of size 2^( 7) =       0.000466944743

      target function =                  N/A
              le_mean =     -16.905891788919
             les_mean =     286.144566912814
             stat err =       0.000458935175
             autocorr =       1.255979941226
              std dev =       0.579128571119
             le_variance =       0.335389901886


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905891788918        initial
     2.2737e+06     2.2737e+07             2.5585e-10       -16.905891788919  <--
     9.0949e+06     9.0949e+07             6.3961e-11       -16.905891788919
     3.6380e+07     3.6380e+08             1.5990e-11       -16.905891788919

*****************************************************************************
Applying the update for shift_i =   2.2737e+06     and shift_s =   2.2737e+07
*****************************************************************************

  Execution time = 2.9606e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.080664e-01 1 1  ON 0
 uu_1                 1.418071e-01 1 1  ON 1
 uu_2                 4.090951e-02 1 1  ON 2
 uu_3                -2.057438e-02 1 1  ON 3
 uu_4                -6.445347e-02 1 1  ON 4
 uu_5                -9.747226e-02 1 1  ON 5
 uu_6                -1.230425e-01 1 1  ON 6
 uu_7                -1.349013e-01 1 1  ON 7
 uu_8                -1.267506e-01 1 1  ON 8
 uu_9                -9.655172e-02 1 1  ON 9
 ud_0                 4.416350e-01 1 1  ON 10
 ud_1                 1.772624e-01 1 1  ON 11
 ud_2                 5.928216e-02 1 1  ON 12
 ud_3                -9.624490e-03 1 1  ON 13
 ud_4                -6.543535e-02 1 1  ON 14
 ud_5                -1.056736e-01 1 1  ON 15
 ud_6                -1.320250e-01 1 1  ON 16
 ud_7                -1.477392e-01 1 1  ON 17
 ud_8                -1.491215e-01 1 1  ON 18
 ud_9                -1.396760e-01 1 1  ON 19
 eO_0                -7.493555e-01 1 1  ON 20
 eO_1                -4.319862e-01 1 1  ON 21
 eO_2                -1.731857e-02 1 1  ON 22
 eO_3                 2.961856e-01 1 1  ON 23
 eO_4                 5.144017e-01 1 1  ON 24
 eO_5                 4.707484e-01 1 1  ON 25
 eO_6                 2.415668e-01 1 1  ON 26
 eO_7                -5.325537e-02 1 1  ON 27
 eO_8                -2.066159e-01 1 1  ON 28
 eO_9                -6.607660e-02 1 1  ON 29
eH1_0                -2.327718e-01 1 1  ON 30
eH1_1                -1.347906e-01 1 1  ON 31
eH1_2                -8.948991e-02 1 1  ON 32
eH1_3                -3.620913e-02 1 1  ON 33
eH1_4                 1.124569e-02 1 1  ON 34
eH1_5                 4.432652e-02 1 1  ON 35
eH1_6                 9.878778e-02 1 1  ON 36
eH1_7                 1.443376e-01 1 1  ON 37
eH1_8                 1.566873e-01 1 1  ON 38
eH1_9                 4.240952e-02 1 1  ON 39
eH2_0                -2.305154e-01 1 1  ON 40
eH2_1                -1.320979e-01 1 1  ON 41
eH2_2                -8.663022e-02 1 1  ON 42
eH2_3                -3.358775e-02 1 1  ON 43
eH2_4                 1.351577e-02 1 1  ON 44
eH2_5                 4.810275e-02 1 1  ON 45
eH2_6                 1.028102e-01 1 1  ON 46
eH2_7                 1.500306e-01 1 1  ON 47
eH2_8                 1.618705e-01 1 1  ON 48
eH2_9                 2.459313e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5774e+01 secs
  Total Execution time = 2.2762e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
