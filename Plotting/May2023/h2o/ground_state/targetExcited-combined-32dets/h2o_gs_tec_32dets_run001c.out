Rank =    0  Free Memory = 60717 MB
Rank =    1  Free Memory = 60717 MB
Rank =    2  Free Memory = 60717 MB
Rank =    3  Free Memory = 60717 MB
Rank =    4  Free Memory = 60716 MB
Rank =    5  Free Memory = 60716 MB
Rank =    6  Free Memory = 60716 MB
Rank =    7  Free Memory = 60716 MB
Rank =    8  Free Memory = 60716 MB
Rank =    9  Free Memory = 60716 MB
Rank =   10  Free Memory = 60715 MB
Rank =   11  Free Memory = 60715 MB
Rank =   12  Free Memory = 60715 MB
Rank =   13  Free Memory = 60715 MB
Rank =   14  Free Memory = 60715 MB
Rank =   15  Free Memory = 60700 MB
Rank =   16  Free Memory = 60700 MB
Rank =   17  Free Memory = 60700 MB
Rank =   18  Free Memory = 60700 MB
Rank =   19  Free Memory = 60700 MB
Rank =   20  Free Memory = 60700 MB
Rank =   21  Free Memory = 60700 MB
Rank =   22  Free Memory = 60700 MB
Rank =   23  Free Memory = 60700 MB
Rank =   24  Free Memory = 60700 MB
Rank =   25  Free Memory = 60700 MB
Rank =   26  Free Memory = 60700 MB
Rank =   27  Free Memory = 60700 MB
Rank =   28  Free Memory = 60700 MB
Rank =   29  Free Memory = 60700 MB
Rank =   30  Free Memory = 60700 MB
Rank =   31  Free Memory = 60700 MB
Rank =   32  Free Memory = 65694 MB
Rank =   33  Free Memory = 65694 MB
Rank =   34  Free Memory = 65693 MB
Rank =   35  Free Memory = 65693 MB
Rank =   36  Free Memory = 65693 MB
Rank =   37  Free Memory = 65693 MB
Rank =   38  Free Memory = 65693 MB
Rank =   39  Free Memory = 65693 MB
Rank =   40  Free Memory = 65693 MB
Rank =   41  Free Memory = 65693 MB
Rank =   42  Free Memory = 65693 MB
Rank =   43  Free Memory = 65693 MB
Rank =   44  Free Memory = 65693 MB
Rank =   45  Free Memory = 65693 MB
Rank =   46  Free Memory = 65693 MB
Rank =   47  Free Memory = 65693 MB
Rank =   48  Free Memory = 65693 MB
Rank =   49  Free Memory = 65693 MB
Rank =   50  Free Memory = 65693 MB
Rank =   51  Free Memory = 65693 MB
Rank =   52  Free Memory = 65693 MB
Rank =   53  Free Memory = 65694 MB
Rank =   54  Free Memory = 65694 MB
Rank =   55  Free Memory = 65694 MB
Rank =   56  Free Memory = 65694 MB
Rank =   57  Free Memory = 65694 MB
Rank =   58  Free Memory = 65694 MB
Rank =   59  Free Memory = 65694 MB
Rank =   60  Free Memory = 65694 MB
Rank =   61  Free Memory = 65694 MB
Rank =   62  Free Memory = 65694 MB
Rank =   63  Free Memory = 65694 MB
Rank =   64  Free Memory = 58627 MB
Rank =   65  Free Memory = 58627 MB
Rank =   66  Free Memory = 58627 MB
Rank =   67  Free Memory = 58627 MB
Rank =   68  Free Memory = 58627 MB
Rank =   69  Free Memory = 58627 MB
Rank =   70  Free Memory = 58627 MB
Rank =   71  Free Memory = 58627 MB
Rank =   72  Free Memory = 58627 MB
Rank =   73  Free Memory = 58627 MB
Rank =   74  Free Memory = 58627 MB
Rank =   75  Free Memory = 58627 MB
Rank =   76  Free Memory = 58627 MB
Rank =   77  Free Memory = 58627 MB
Rank =   78  Free Memory = 58627 MB
Rank =   79  Free Memory = 58627 MB
Rank =   80  Free Memory = 58627 MB
Rank =   81  Free Memory = 58627 MB
Rank =   82  Free Memory = 58627 MB
Rank =   83  Free Memory = 58627 MB
Rank =   84  Free Memory = 58627 MB
Rank =   85  Free Memory = 58627 MB
Rank =   86  Free Memory = 58627 MB
Rank =   87  Free Memory = 58627 MB
Rank =   88  Free Memory = 58627 MB
Rank =   89  Free Memory = 58627 MB
Rank =   90  Free Memory = 58627 MB
Rank =   91  Free Memory = 58627 MB
Rank =   92  Free Memory = 58627 MB
Rank =   93  Free Memory = 58627 MB
Rank =   94  Free Memory = 58627 MB
Rank =   95  Free Memory = 58627 MB
Rank =   96  Free Memory = 57936 MB
Rank =   97  Free Memory = 57936 MB
Rank =   98  Free Memory = 57936 MB
Rank =   99  Free Memory = 57936 MB
Rank =  100  Free Memory = 57936 MB
Rank =  101  Free Memory = 57936 MB
Rank =  102  Free Memory = 57936 MB
Rank =  103  Free Memory = 57936 MB
Rank =  104  Free Memory = 57936 MB
Rank =  105  Free Memory = 57936 MB
Rank =  106  Free Memory = 57936 MB
Rank =  107  Free Memory = 57936 MB
Rank =  108  Free Memory = 57936 MB
Rank =  109  Free Memory = 57936 MB
Rank =  110  Free Memory = 57936 MB
Rank =  111  Free Memory = 57936 MB
Rank =  112  Free Memory = 57936 MB
Rank =  113  Free Memory = 57936 MB
Rank =  114  Free Memory = 57936 MB
Rank =  115  Free Memory = 57936 MB
Rank =  116  Free Memory = 57936 MB
Rank =  117  Free Memory = 57936 MB
Rank =  118  Free Memory = 57936 MB
Rank =  119  Free Memory = 57936 MB
Rank =  120  Free Memory = 57936 MB
Rank =  121  Free Memory = 57936 MB
Rank =  122  Free Memory = 57936 MB
Rank =  123  Free Memory = 57936 MB
Rank =  124  Free Memory = 57936 MB
Rank =  125  Free Memory = 57936 MB
Rank =  126  Free Memory = 57936 MB
Rank =  127  Free Memory = 57936 MB
  Input file(s): opt_h2o_gs_tec_32dets_run001c.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_tec_32dets_run001c.xml

  Project = H2O
  date    = 2023-05-08 08:55:47 PDT
  host    = n0110.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 899

  Range of prime numbers to use as seeds over processors and threads = 7001-8209


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.087048e-01    1         1  ON     0
     uu_1                 5.166659e-02    1         1  ON     1
     uu_2                -3.940109e-02    1         1  ON     2
     uu_3                -9.291199e-02    1         1  ON     3
     uu_4                -1.239443e-01    1         1  ON     4
     uu_5                -1.319981e-01    1         1  ON     5
     uu_6                -1.137854e-01    1         1  ON     6
     uu_7                -5.393157e-02    1         1  ON     7
     uu_8                 7.179273e-02    1         1  ON     8
     uu_9                 1.240341e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.081000e-01    1         1  ON     0
     ud_1                 7.810462e-02    1         1  ON     1
     ud_2                -2.402946e-02    1         1  ON     2
     ud_3                -7.733644e-02    1         1  ON     3
     ud_4                -1.141469e-01    1         1  ON     4
     ud_5                -1.343876e-01    1         1  ON     5
     ud_6                -1.304657e-01    1         1  ON     6
     ud_7                -8.981631e-02    1         1  ON     7
     ud_8                -4.429621e-03    1         1  ON     8
     ud_9                 8.809320e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.053827e-01    1         1  ON     0
     eO_1                -4.211844e-01    1         1  ON     1
     eO_2                -4.127810e-02    1         1  ON     2
     eO_3                 1.870602e-01    1         1  ON     3
     eO_4                 2.613791e-01    1         1  ON     4
     eO_5                 2.856679e-01    1         1  ON     5
     eO_6                 2.498752e-01    1         1  ON     6
     eO_7                 1.252774e-01    1         1  ON     7
     eO_8                 2.849736e-02    1         1  ON     8
     eO_9                 1.896086e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.018813e-01    1         1  ON     0
     eH1_1                -9.762575e-02    1         1  ON     1
     eH1_2                -4.695821e-02    1         1  ON     2
     eH1_3                -1.559994e-02    1         1  ON     3
     eH1_4                 1.884980e-02    1         1  ON     4
     eH1_5                 2.620746e-02    1         1  ON     5
     eH1_6                 7.491231e-02    1         1  ON     6
     eH1_7                 1.041056e-01    1         1  ON     7
     eH1_8                 9.703784e-02    1         1  ON     8
     eH1_9                 2.520340e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.031282e-01    1         1  ON     0
     eH2_1                -9.994439e-02    1         1  ON     1
     eH2_2                -4.927126e-02    1         1  ON     2
     eH2_3                -1.790885e-02    1         1  ON     3
     eH2_4                 1.638122e-02    1         1  ON     4
     eH2_5                 2.331249e-02    1         1  ON     5
     eH2_6                 7.776965e-02    1         1  ON     6
     eH2_7                 1.127068e-01    1         1  ON     7
     eH2_8                 9.971219e-02    1         1  ON     8
     eH2_9                 2.792592e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 32 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.679191e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 11 unique up determinants.
Found 11 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.9640e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 81
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2124
    reference variance = 0.234038
====================================================
  Execution time = 1.9506e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5417e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9800e-01
  Total weights = 1.973686635e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5793e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290825650364
                                         uncertainty =       0.002403689086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290825650364
                                         uncertainty =       0.002403689086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381314159
  error estimate for blocks of size 2^( 2) =       0.000396368992
  error estimate for blocks of size 2^( 3) =       0.000410055180
  error estimate for blocks of size 2^( 4) =       0.000419217993
  error estimate for blocks of size 2^( 5) =       0.000424935719
  error estimate for blocks of size 2^( 6) =       0.000426172870
  error estimate for blocks of size 2^( 7) =       0.000428916873

      target function =      -0.915857634890
              le_mean =     -17.207050731872
             les_mean =     296.380592208379
             stat err =       0.000424810864
             autocorr =       1.241153123864
   target nu stat err =       0.000424810864
   target dn stat err =       0.002909099947
      target stat err =       0.004575827046
              std dev =       0.539259655458
             le_variance =       0.290800976004


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.720705073187e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915879618945       residual = 6.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915958203360       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915985168794       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915989560084       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915991689259       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915992624050       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915993304412       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915995274222       residual = 6.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915996650532       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915997011785       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915997587708       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915997893333       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915998420103       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915999311571       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915999689180       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916000117261       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916000392491       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916000768021       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916000654451       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916000818790       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916001332973       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916001427149       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916001349355       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916001640017       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916001731222       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916001869599       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916001814508       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916001898272       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916001842211       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916001818442       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916001773871       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916001846278       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916001852661       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916001766115       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916001873447       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916001907314       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916001915544       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916001931736       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916001929442       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.916001927979       residual = 6.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.5000e-01 is 2.068140e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915879618945       residual = 6.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915903322296       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915911382005       residual = 4.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915912650843       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915913242552       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915913461320       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915913674774       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915914227922       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915914633806       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915914719729       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915914877893       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915914977522       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915915117726       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915915343799       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915915433826       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915915549135       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915915621104       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915915706958       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915915668473       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915915720295       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915915844721       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915915850648       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915915827432       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915915896755       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915915912748       residual = 9.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915915942699       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915915932402       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915915945422       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915915926688       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915915922575       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915915918581       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915915935868       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915915925848       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915915912050       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915915943569       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915915944775       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.0000e+00 is 5.300120e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915879618945       residual = 6.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915885867354       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915887985704       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915888316220       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915888468794       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915888520824       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915888577919       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915888720547       residual = 6.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915888826485       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915888847386       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915888888110       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915888915083       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915888950126       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915889006750       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915889028616       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915889058235       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915889076485       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915889097003       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915889086773       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915889100476       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915889130905       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915889130889       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915889125018       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915889142191       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915889145798       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915889153082       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915889150601       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915889153082       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915889148269       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915889147545       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915889147147       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915889151107       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915889147825       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915889145358       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915889153170       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915889152959       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 4.0000e+00 is 1.337410e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163064 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5256e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0   2.087072e-01                 1 1 ON  0
uu_1   5.168226e-02                 1 1 ON  1
uu_2   -3.934527e-02                1 1 ON  2
uu_3   -9.287576e-02                1 1 ON  3
uu_4   -1.239178e-01                1 1 ON  4
uu_5   -1.318470e-01                1 1 ON  5
uu_6   -1.136937e-01                1 1 ON  6
uu_7   -5.395276e-02                1 1 ON  7
uu_8   7.126272e-02                 1 1 ON  8
uu_9   1.240849e-01                 1 1 ON  9
ud_0   3.080091e-01                 1 1 ON  10
ud_1   7.802541e-02                 1 1 ON  11
ud_2   -2.409189e-02                1 1 ON  12
ud_3   -7.740750e-02                1 1 ON  13
ud_4   -1.141486e-01                1 1 ON  14
ud_5   -1.343213e-01                1 1 ON  15
ud_6   -1.302779e-01                1 1 ON  16
ud_7   -8.979131e-02                1 1 ON  17
ud_8   -4.515904e-03                1 1 ON  18
ud_9   8.807770e-02                 1 1 ON  19
eO_0   -7.052528e-01                1 1 ON  20
eO_1   -4.211093e-01                1 1 ON  21
eO_2   -4.124768e-02                1 1 ON  22
eO_3   1.870971e-01                 1 1 ON  23
eO_4   2.611031e-01                 1 1 ON  24
eO_5   2.852668e-01                 1 1 ON  25
eO_6   2.499938e-01                 1 1 ON  26
eO_7   1.255143e-01                 1 1 ON  27
eO_8   2.852445e-02                 1 1 ON  28
eO_9   1.898071e-02                 1 1 ON  29
eH1_0  -2.018883e-01                1 1 ON  30
eH1_1  -9.756254e-02                1 1 ON  31
eH1_2  -4.688793e-02                1 1 ON  32
eH1_3  -1.550243e-02                1 1 ON  33
eH1_4  1.875721e-02                 1 1 ON  34
eH1_5  2.604535e-02                 1 1 ON  35
eH1_6  7.480565e-02                 1 1 ON  36
eH1_7  1.040871e-01                 1 1 ON  37
eH1_8  9.715915e-02                 1 1 ON  38
eH1_9  2.522408e-02                 1 1 ON  39
eH2_0  -2.030977e-01                1 1 ON  40
eH2_1  -9.976520e-02                1 1 ON  41
eH2_2  -4.910363e-02                1 1 ON  42
eH2_3  -1.785393e-02                1 1 ON  43
eH2_4  1.627387e-02                 1 1 ON  44
eH2_5  2.305265e-02                 1 1 ON  45
eH2_6  7.762893e-02                 1 1 ON  46
eH2_7  1.126233e-01                 1 1 ON  47
eH2_8  9.983328e-02                 1 1 ON  48
eH2_9  2.796416e-02                 1 1 ON  49
ci_001 -4.252986e-02                3 1 ON  50
ci_002 -3.163549e-02                3 1 ON  51
ci_003 -1.234730e-02                3 1 ON  52
ci_004 2.574786e-02                 3 1 ON  53
ci_005 2.606783e-02                 3 1 ON  54
ci_006 -2.084646e-02                3 1 ON  55
ci_007 -2.060804e-02                3 1 ON  56
ci_008 -5.015367e-03                3 1 ON  57
ci_009 -1.567887e-02                3 1 ON  58
ci_010 -1.047253e-02                3 1 ON  59
ci_011 -1.026898e-02                3 1 ON  60
ci_012 -1.044293e-02                3 1 ON  61
ci_013 -2.153102e-02                3 1 ON  62
ci_014 1.373268e-02                 3 1 ON  63
ci_015 1.354021e-02                 3 1 ON  64
ci_016 1.677990e-02                 3 1 ON  65
ci_017 1.610098e-02                 3 1 ON  66
ci_018 1.114906e-02                 3 1 ON  67
ci_019 1.081330e-02                 3 1 ON  68
ci_020 1.819634e-02                 3 1 ON  69
ci_021 1.785700e-02                 3 1 ON  70
ci_022 1.046518e-02                 3 1 ON  71
ci_023 1.084740e-02                 3 1 ON  72
ci_024 7.186494e-03                 3 1 ON  73
ci_025 7.106847e-03                 3 1 ON  74
ci_026 1.193517e-02                 3 1 ON  75
ci_027 1.202292e-02                 3 1 ON  76
ci_028 -1.001509e-02                3 1 ON  77
ci_029 -9.935404e-03                3 1 ON  78
ci_030 -4.870642e-03                3 1 ON  79
ci_031 -5.130083e-03                3 1 ON  80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1088
    reference variance = 0.24686
====================================================
  Execution time = 1.9398e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9992e-01
  Total weights = 1.9738e+06
  Execution time = 1.6179e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290898250816
                                         uncertainty =       0.002151624849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290898250816
                                         uncertainty =       0.002151624849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381414773
  error estimate for blocks of size 2^( 2) =       0.000395880259
  error estimate for blocks of size 2^( 3) =       0.000409116953
  error estimate for blocks of size 2^( 4) =       0.000419155500
  error estimate for blocks of size 2^( 5) =       0.000425742817
  error estimate for blocks of size 2^( 6) =       0.000426929414
  error estimate for blocks of size 2^( 7) =       0.000430356351

      target function =      -0.910582852332
              le_mean =     -17.206861139619
             les_mean =     296.377484273185
             stat err =       0.000425546021
             autocorr =       1.244795603924
   target nu stat err =       0.000425546021
   target dn stat err =       0.003136681662
      target stat err =       0.004867765634
              std dev =       0.539401945522
             le_variance =       0.290954458833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290766399085
                                         uncertainty =       0.002147418354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290766399085
                                         uncertainty =       0.002147418354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381329236
  error estimate for blocks of size 2^( 2) =       0.000395853735
  error estimate for blocks of size 2^( 3) =       0.000409151464
  error estimate for blocks of size 2^( 4) =       0.000419234227
  error estimate for blocks of size 2^( 5) =       0.000425838073
  error estimate for blocks of size 2^( 6) =       0.000427044835
  error estimate for blocks of size 2^( 7) =       0.000430504587

      target function =      -0.913552822107
              le_mean =     -17.206865078280
             les_mean =     296.375694923659
             stat err =       0.000425655430
             autocorr =       1.245994571649
   target nu stat err =       0.000425655430
   target dn stat err =       0.002745602008
      target stat err =       0.004302523928
              std dev =       0.539280977112
             le_variance =       0.290823972275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290812550434
                                         uncertainty =       0.002148834883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290812550434
                                         uncertainty =       0.002148834883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381359127
  error estimate for blocks of size 2^( 2) =       0.000395859362
  error estimate for blocks of size 2^( 3) =       0.000409131797
  error estimate for blocks of size 2^( 4) =       0.000419196305
  error estimate for blocks of size 2^( 5) =       0.000425793570
  error estimate for blocks of size 2^( 6) =       0.000426992627
  error estimate for blocks of size 2^( 7) =       0.000430439095

      target function =      -0.912722003373
              le_mean =     -17.206862481530
             les_mean =     296.376142988112
             stat err =       0.000425605399
             autocorr =       1.245506410438
   target nu stat err =       0.000425605399
   target dn stat err =       0.002839077153
      target stat err =       0.004436966595
              std dev =       0.539323250121
             le_variance =       0.290869568121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290885675647
                                         uncertainty =       0.002151238443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290885675647
                                         uncertainty =       0.002151238443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381406600
  error estimate for blocks of size 2^( 2) =       0.000395876574
  error estimate for blocks of size 2^( 3) =       0.000409117823
  error estimate for blocks of size 2^( 4) =       0.000419159860
  error estimate for blocks of size 2^( 5) =       0.000425748945
  error estimate for blocks of size 2^( 6) =       0.000426938068
  error estimate for blocks of size 2^( 7) =       0.000430367330

      target function =      -0.912383540634
              le_mean =     -17.206860904070
             les_mean =     296.376307143300
             stat err =       0.000425553551
             autocorr =       1.244893007961
   target nu stat err =       0.000425553551
   target dn stat err =       0.002956620760
      target stat err =       0.004612534705
              std dev =       0.539390387194
             le_variance =       0.290941989797


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910582852332        initial
     2.5000e-01     2.5000e+00             2.0681e-03        -0.913552822107  <--
     1.0000e+00     1.0000e+01             5.3001e-04        -0.912722003373
     4.0000e+00     4.0000e+01             1.3374e-04        -0.912383540634

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.7532e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
  uu_0                 2.087310e-01 1 1  ON 0
  uu_1                 5.173703e-02 1 1  ON 1
  uu_2                -3.919965e-02 1 1  ON 2
  uu_3                -9.277134e-02 1 1  ON 3
  uu_4                -1.238265e-01 1 1  ON 4
  uu_5                -1.314573e-01 1 1  ON 5
  uu_6                -1.134097e-01 1 1  ON 6
  uu_7                -5.401749e-02 1 1  ON 7
  uu_8                 6.972459e-02 1 1  ON 8
  uu_9                 1.242259e-01 1 1  ON 9
  ud_0                 3.077678e-01 1 1  ON 10
  ud_1                 7.781126e-02 1 1  ON 11
  ud_2                -2.426431e-02 1 1  ON 12
  ud_3                -7.758957e-02 1 1  ON 13
  ud_4                -1.141579e-01 1 1  ON 14
  ud_5                -1.341519e-01 1 1  ON 15
  ud_6                -1.298156e-01 1 1  ON 16
  ud_7                -8.970875e-02 1 1  ON 17
  ud_8                -4.751024e-03 1 1  ON 18
  ud_9                 8.802865e-02 1 1  ON 19
  eO_0                -7.049273e-01 1 1  ON 20
  eO_1                -4.209116e-01 1 1  ON 21
  eO_2                -4.116798e-02 1 1  ON 22
  eO_3                 1.871545e-01 1 1  ON 23
  eO_4                 2.603624e-01 1 1  ON 24
  eO_5                 2.841503e-01 1 1  ON 25
  eO_6                 2.503179e-01 1 1  ON 26
  eO_7                 1.262349e-01 1 1  ON 27
  eO_8                 2.860966e-02 1 1  ON 28
  eO_9                 1.904066e-02 1 1  ON 29
 eH1_0                -2.018987e-01 1 1  ON 30
 eH1_1                -9.740211e-02 1 1  ON 31
 eH1_2                -4.670956e-02 1 1  ON 32
 eH1_3                -1.527014e-02 1 1  ON 33
 eH1_4                 1.852293e-02 1 1  ON 34
 eH1_5                 2.560200e-02 1 1  ON 35
 eH1_6                 7.451000e-02 1 1  ON 36
 eH1_7                 1.040286e-01 1 1  ON 37
 eH1_8                 9.752412e-02 1 1  ON 38
 eH1_9                 2.528768e-02 1 1  ON 39
 eH2_0                -2.029870e-01 1 1  ON 40
 eH2_1                -9.931092e-02 1 1  ON 41
 eH2_2                -4.867942e-02 1 1  ON 42
 eH2_3                -1.770362e-02 1 1  ON 43
 eH2_4                 1.600097e-02 1 1  ON 44
 eH2_5                 2.236134e-02 1 1  ON 45
 eH2_6                 7.722653e-02 1 1  ON 46
 eH2_7                 1.123686e-01 1 1  ON 47
 eH2_8                 1.001981e-01 1 1  ON 48
 eH2_9                 2.808146e-02 1 1  ON 49
ci_001                -4.232275e-02 3 1  ON 50
ci_002                -3.138475e-02 3 1  ON 51
ci_003                -1.219754e-02 3 1  ON 52
ci_004                 2.566434e-02 3 1  ON 53
ci_005                 2.613495e-02 3 1  ON 54
ci_006                -2.079272e-02 3 1  ON 55
ci_007                -2.044750e-02 3 1  ON 56
ci_008                -4.908902e-03 3 1  ON 57
ci_009                -1.579011e-02 3 1  ON 58
ci_010                -1.041868e-02 3 1  ON 59
ci_011                -9.943563e-03 3 1  ON 60
ci_012                -1.029852e-02 3 1  ON 61
ci_013                -2.159235e-02 3 1  ON 62
ci_014                 1.370643e-02 3 1  ON 63
ci_015                 1.346061e-02 3 1  ON 64
ci_016                 1.660664e-02 3 1  ON 65
ci_017                 1.619070e-02 3 1  ON 66
ci_018                 1.111547e-02 3 1  ON 67
ci_019                 1.077483e-02 3 1  ON 68
ci_020                 1.829125e-02 3 1  ON 69
ci_021                 1.773187e-02 3 1  ON 70
ci_022                 1.059063e-02 3 1  ON 71
ci_023                 1.066801e-02 3 1  ON 72
ci_024                 7.330073e-03 3 1  ON 73
ci_025                 6.851466e-03 3 1  ON 74
ci_026                 1.186212e-02 3 1  ON 75
ci_027                 1.174924e-02 3 1  ON 76
ci_028                -9.809391e-03 3 1  ON 77
ci_029                -1.014742e-02 3 1  ON 78
ci_030                -4.999996e-03 3 1  ON 79
ci_031                -5.158233e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2795e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7161e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2517
    reference variance = 0.216024
====================================================
  Execution time = 1.9373e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5426e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9857e-01
  Total weights = 1.973722071e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7743e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290440113569
                                         uncertainty =       0.001951797594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290440113569
                                         uncertainty =       0.001951797594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381979719
  error estimate for blocks of size 2^( 2) =       0.000397070310
  error estimate for blocks of size 2^( 3) =       0.000410394793
  error estimate for blocks of size 2^( 4) =       0.000420518424
  error estimate for blocks of size 2^( 5) =       0.000425851296
  error estimate for blocks of size 2^( 6) =       0.000429252311
  error estimate for blocks of size 2^( 7) =       0.000430819727

      target function =      -0.914988949023
              le_mean =     -17.206323272249
             les_mean =     296.356129480892
             stat err =       0.000426610440
             autocorr =       1.247332812382
   target nu stat err =       0.000426610440
   target dn stat err =       0.002608963111
      target stat err =       0.004103391818
              std dev =       0.540200899752
             le_variance =       0.291817012092


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720632327225e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915006242919       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915138517349       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915175771697       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915195312958       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915202091202       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915209967235       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915213525614       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915218867919       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915224473916       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915228018232       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915232071004       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915232756064       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915235411376       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915238376346       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915238883612       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915238782293       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915240197037       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915240133304       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915242078058       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915243475150       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915243762071       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915243691305       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915243705163       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915244428865       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915245639159       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915246676814       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915246551338       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915245808928       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915245614762       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915245890521       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915245833754       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915246335120       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915246130685       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915245954180       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915246424734       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915246232800       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915246156663       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915246281024       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915246200932       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915246236155       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.915246182942       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.915246374266       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.915246503932       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.915246536758       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.915246530871       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e-02 is 8.544535e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915006242919       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915061988935       residual = 9.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915076200879       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915083585085       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915086424271       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915089468159       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915091296483       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915093016933       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915095044087       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915096381678       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915097177139       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915097268279       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915098325310       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915099297309       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915099312711       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915099142429       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915099397501       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915099541825       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915100295700       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915100413990       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915100314096       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915100307173       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915100228017       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915100537654       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915100971027       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915100889215       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915100730626       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915100583226       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915100639699       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915100657455       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915100622873       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915100721218       residual = 9.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915100671644       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915100700592       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915100685519       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915100689621       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915100701480       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915100706078       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915100684471       residual = 6.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.5000e-01 is 2.317970e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915006242919       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915023062697       residual = 9.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915027133546       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915029236256       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915030102658       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915030927078       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915031429631       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915031817238       residual = 8.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915032308501       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915032725698       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915033104872       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915033126200       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915033440252       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915033687120       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915033672349       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915033608014       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915033657646       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915033724877       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915033920125       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915033919372       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915033887282       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915033875277       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915033868770       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915033954282       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915034042975       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915033989644       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915033960508       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915033941545       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915033961333       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915033944119       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915033950507       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915033963481       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915033956666       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915033967130       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915033955609       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915033960846       residual = 8.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.0000e+00 is 5.927505e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.239954 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5230e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
  uu_0                 2.086320e-01 1 1  ON 0
  uu_1                 5.170972e-02 1 1  ON 1
  uu_2                -3.905445e-02 1 1  ON 2
  uu_3                -9.244838e-02 1 1  ON 3
  uu_4                -1.232820e-01 1 1  ON 4
  uu_5                -1.309832e-01 1 1  ON 5
  uu_6                -1.127785e-01 1 1  ON 6
  uu_7                -5.438593e-02 1 1  ON 7
  uu_8                 6.740662e-02 1 1  ON 8
  uu_9                 1.242124e-01 1 1  ON 9
  ud_0                 3.069615e-01 1 1  ON 10
  ud_1                 7.713217e-02 1 1  ON 11
  ud_2                -2.478183e-02 1 1  ON 12
  ud_3                -7.796668e-02 1 1  ON 13
  ud_4                -1.144043e-01 1 1  ON 14
  ud_5                -1.342349e-01 1 1  ON 15
  ud_6                -1.291673e-01 1 1  ON 16
  ud_7                -8.855410e-02 1 1  ON 17
  ud_8                -4.342918e-03 1 1  ON 18
  ud_9                 8.773357e-02 1 1  ON 19
  eO_0                -7.040565e-01 1 1  ON 20
  eO_1                -4.207646e-01 1 1  ON 21
  eO_2                -4.182687e-02 1 1  ON 22
  eO_3                 1.857176e-01 1 1  ON 23
  eO_4                 2.602388e-01 1 1  ON 24
  eO_5                 2.842238e-01 1 1  ON 25
  eO_6                 2.505895e-01 1 1  ON 26
  eO_7                 1.269474e-01 1 1  ON 27
  eO_8                 2.865876e-02 1 1  ON 28
  eO_9                 1.904724e-02 1 1  ON 29
 eH1_0                -2.023199e-01 1 1  ON 30
 eH1_1                -9.755676e-02 1 1  ON 31
 eH1_2                -4.650052e-02 1 1  ON 32
 eH1_3                -1.508232e-02 1 1  ON 33
 eH1_4                 1.853749e-02 1 1  ON 34
 eH1_5                 2.547286e-02 1 1  ON 35
 eH1_6                 7.435779e-02 1 1  ON 36
 eH1_7                 1.039717e-01 1 1  ON 37
 eH1_8                 9.787288e-02 1 1  ON 38
 eH1_9                 2.541471e-02 1 1  ON 39
 eH2_0                -2.030423e-01 1 1  ON 40
 eH2_1                -9.892920e-02 1 1  ON 41
 eH2_2                -4.823893e-02 1 1  ON 42
 eH2_3                -1.725774e-02 1 1  ON 43
 eH2_4                 1.618841e-02 1 1  ON 44
 eH2_5                 2.149505e-02 1 1  ON 45
 eH2_6                 7.626421e-02 1 1  ON 46
 eH2_7                 1.121495e-01 1 1  ON 47
 eH2_8                 1.006157e-01 1 1  ON 48
 eH2_9                 2.827407e-02 1 1  ON 49
ci_001                -4.244824e-02 3 1  ON 50
ci_002                -3.117395e-02 3 1  ON 51
ci_003                -1.193198e-02 3 1  ON 52
ci_004                 2.577115e-02 3 1  ON 53
ci_005                 2.619651e-02 3 1  ON 54
ci_006                -2.103647e-02 3 1  ON 55
ci_007                -2.037688e-02 3 1  ON 56
ci_008                -4.826282e-03 3 1  ON 57
ci_009                -1.576431e-02 3 1  ON 58
ci_010                -1.020160e-02 3 1  ON 59
ci_011                -1.000190e-02 3 1  ON 60
ci_012                -9.987120e-03 3 1  ON 61
ci_013                -2.157837e-02 3 1  ON 62
ci_014                 1.341866e-02 3 1  ON 63
ci_015                 1.345693e-02 3 1  ON 64
ci_016                 1.672724e-02 3 1  ON 65
ci_017                 1.639341e-02 3 1  ON 66
ci_018                 1.102960e-02 3 1  ON 67
ci_019                 1.086511e-02 3 1  ON 68
ci_020                 1.844657e-02 3 1  ON 69
ci_021                 1.783953e-02 3 1  ON 70
ci_022                 1.045822e-02 3 1  ON 71
ci_023                 1.057219e-02 3 1  ON 72
ci_024                 6.969048e-03 3 1  ON 73
ci_025                 6.775677e-03 3 1  ON 74
ci_026                 1.182471e-02 3 1  ON 75
ci_027                 1.183016e-02 3 1  ON 76
ci_028                -9.429818e-03 3 1  ON 77
ci_029                -1.025663e-02 3 1  ON 78
ci_030                -4.843899e-03 3 1  ON 79
ci_031                -5.048988e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1824
    reference variance = 0.232975
====================================================
  Execution time = 1.9098e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0131e-01
  Total weights = 1.9737e+06
  Execution time = 1.6120e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293894832284
                                         uncertainty =       0.002264408378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293894832284
                                         uncertainty =       0.002264408378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383329585
  error estimate for blocks of size 2^( 2) =       0.000398179055
  error estimate for blocks of size 2^( 3) =       0.000411609445
  error estimate for blocks of size 2^( 4) =       0.000421273546
  error estimate for blocks of size 2^( 5) =       0.000426055397
  error estimate for blocks of size 2^( 6) =       0.000429046329
  error estimate for blocks of size 2^( 7) =       0.000434032536

      target function =      -0.852258578038
              le_mean =     -17.206673835681
             les_mean =     296.410801406462
             stat err =       0.000427601952
             autocorr =       1.244327447380
   target nu stat err =       0.000427601952
   target dn stat err =       0.023481933430
      target stat err =       0.031612748731
              std dev =       0.542109897371
             le_variance =       0.293883140828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293581613720
                                         uncertainty =       0.002244520755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293581613720
                                         uncertainty =       0.002244520755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383123539
  error estimate for blocks of size 2^( 2) =       0.000398188394
  error estimate for blocks of size 2^( 3) =       0.000411857521
  error estimate for blocks of size 2^( 4) =       0.000421687500
  error estimate for blocks of size 2^( 5) =       0.000426550168
  error estimate for blocks of size 2^( 6) =       0.000429570888
  error estimate for blocks of size 2^( 7) =       0.000434609151

      target function =      -0.901194727946
              le_mean =     -17.206657268531
             les_mean =     296.376626603290
             stat err =       0.000428104427
             autocorr =       1.248595502976
   target nu stat err =       0.000428104427
   target dn stat err =       0.005169182760
      target stat err =       0.007801790428
              std dev =       0.541818504376
             le_variance =       0.293567291685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293618952544
                                         uncertainty =       0.002247979203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293618952544
                                         uncertainty =       0.002247979203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383148186
  error estimate for blocks of size 2^( 2) =       0.000398166183
  error estimate for blocks of size 2^( 3) =       0.000411773112
  error estimate for blocks of size 2^( 4) =       0.000421567630
  error estimate for blocks of size 2^( 5) =       0.000426409150
  error estimate for blocks of size 2^( 6) =       0.000429420455
  error estimate for blocks of size 2^( 7) =       0.000434446594

      target function =      -0.910281740449
              le_mean =     -17.206658389304
             les_mean =     296.370711961451
             stat err =       0.000427960957
             autocorr =       1.247598237365
   target nu stat err =       0.000427960957
   target dn stat err =       0.002611362722
      target stat err =       0.004068475126
              std dev =       0.541853361468
             le_variance =       0.293605065335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293825881779
                                         uncertainty =       0.002263127483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293825881779
                                         uncertainty =       0.002263127483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383284426
  error estimate for blocks of size 2^( 2) =       0.000398160311
  error estimate for blocks of size 2^( 3) =       0.000411617434
  error estimate for blocks of size 2^( 4) =       0.000421298288
  error estimate for blocks of size 2^( 5) =       0.000426089850
  error estimate for blocks of size 2^( 6) =       0.000429088389
  error estimate for blocks of size 2^( 7) =       0.000434077906

      target function =      -0.909251037936
              le_mean =     -17.206668136647
             les_mean =     296.371719424980
             stat err =       0.000427638608
             autocorr =       1.244834079687
   target nu stat err =       0.000427638608
   target dn stat err =       0.002696585330
      target stat err =       0.004187774620
              std dev =       0.542046033103
             le_variance =       0.293813902003


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.852258578038        initial
     6.2500e-02     6.2500e-01             8.5445e-03        -0.901194727946
     2.5000e-01     2.5000e+00             2.3180e-03        -0.910281740449  <--
     1.0000e+00     1.0000e+01             5.9275e-04        -0.909251037936

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.7192e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
  uu_0                 2.086320e-01 1 1  ON 0
  uu_1                 5.170972e-02 1 1  ON 1
  uu_2                -3.905445e-02 1 1  ON 2
  uu_3                -9.244838e-02 1 1  ON 3
  uu_4                -1.232820e-01 1 1  ON 4
  uu_5                -1.309832e-01 1 1  ON 5
  uu_6                -1.127785e-01 1 1  ON 6
  uu_7                -5.438593e-02 1 1  ON 7
  uu_8                 6.740662e-02 1 1  ON 8
  uu_9                 1.242124e-01 1 1  ON 9
  ud_0                 3.069615e-01 1 1  ON 10
  ud_1                 7.713217e-02 1 1  ON 11
  ud_2                -2.478183e-02 1 1  ON 12
  ud_3                -7.796668e-02 1 1  ON 13
  ud_4                -1.144043e-01 1 1  ON 14
  ud_5                -1.342349e-01 1 1  ON 15
  ud_6                -1.291673e-01 1 1  ON 16
  ud_7                -8.855410e-02 1 1  ON 17
  ud_8                -4.342918e-03 1 1  ON 18
  ud_9                 8.773357e-02 1 1  ON 19
  eO_0                -7.040565e-01 1 1  ON 20
  eO_1                -4.207646e-01 1 1  ON 21
  eO_2                -4.182687e-02 1 1  ON 22
  eO_3                 1.857176e-01 1 1  ON 23
  eO_4                 2.602388e-01 1 1  ON 24
  eO_5                 2.842238e-01 1 1  ON 25
  eO_6                 2.505895e-01 1 1  ON 26
  eO_7                 1.269474e-01 1 1  ON 27
  eO_8                 2.865876e-02 1 1  ON 28
  eO_9                 1.904724e-02 1 1  ON 29
 eH1_0                -2.023199e-01 1 1  ON 30
 eH1_1                -9.755676e-02 1 1  ON 31
 eH1_2                -4.650052e-02 1 1  ON 32
 eH1_3                -1.508232e-02 1 1  ON 33
 eH1_4                 1.853749e-02 1 1  ON 34
 eH1_5                 2.547286e-02 1 1  ON 35
 eH1_6                 7.435779e-02 1 1  ON 36
 eH1_7                 1.039717e-01 1 1  ON 37
 eH1_8                 9.787288e-02 1 1  ON 38
 eH1_9                 2.541471e-02 1 1  ON 39
 eH2_0                -2.030423e-01 1 1  ON 40
 eH2_1                -9.892920e-02 1 1  ON 41
 eH2_2                -4.823893e-02 1 1  ON 42
 eH2_3                -1.725774e-02 1 1  ON 43
 eH2_4                 1.618841e-02 1 1  ON 44
 eH2_5                 2.149505e-02 1 1  ON 45
 eH2_6                 7.626421e-02 1 1  ON 46
 eH2_7                 1.121495e-01 1 1  ON 47
 eH2_8                 1.006157e-01 1 1  ON 48
 eH2_9                 2.827407e-02 1 1  ON 49
ci_001                -4.244824e-02 3 1  ON 50
ci_002                -3.117395e-02 3 1  ON 51
ci_003                -1.193198e-02 3 1  ON 52
ci_004                 2.577115e-02 3 1  ON 53
ci_005                 2.619651e-02 3 1  ON 54
ci_006                -2.103647e-02 3 1  ON 55
ci_007                -2.037688e-02 3 1  ON 56
ci_008                -4.826282e-03 3 1  ON 57
ci_009                -1.576431e-02 3 1  ON 58
ci_010                -1.020160e-02 3 1  ON 59
ci_011                -1.000190e-02 3 1  ON 60
ci_012                -9.987120e-03 3 1  ON 61
ci_013                -2.157837e-02 3 1  ON 62
ci_014                 1.341866e-02 3 1  ON 63
ci_015                 1.345693e-02 3 1  ON 64
ci_016                 1.672724e-02 3 1  ON 65
ci_017                 1.639341e-02 3 1  ON 66
ci_018                 1.102960e-02 3 1  ON 67
ci_019                 1.086511e-02 3 1  ON 68
ci_020                 1.844657e-02 3 1  ON 69
ci_021                 1.783953e-02 3 1  ON 70
ci_022                 1.045822e-02 3 1  ON 71
ci_023                 1.057219e-02 3 1  ON 72
ci_024                 6.969048e-03 3 1  ON 73
ci_025                 6.775677e-03 3 1  ON 74
ci_026                 1.182471e-02 3 1  ON 75
ci_027                 1.183016e-02 3 1  ON 76
ci_028                -9.429818e-03 3 1  ON 77
ci_029                -1.025663e-02 3 1  ON 78
ci_030                -4.843899e-03 3 1  ON 79
ci_031                -5.048988e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2429e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7189e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1589
    reference variance = 0.26171
====================================================
  Execution time = 1.9817e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5404e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9817e-01
  Total weights = 1.973536340e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6020e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290484776995
                                         uncertainty =       0.001645977612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290484776995
                                         uncertainty =       0.001645977612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381271873
  error estimate for blocks of size 2^( 2) =       0.000396008107
  error estimate for blocks of size 2^( 3) =       0.000409716665
  error estimate for blocks of size 2^( 4) =       0.000419331660
  error estimate for blocks of size 2^( 5) =       0.000424239702
  error estimate for blocks of size 2^( 6) =       0.000427935812
  error estimate for blocks of size 2^( 7) =       0.000430835357

      target function =      -0.915603281652
              le_mean =     -17.206947040611
             les_mean =     296.377194898711
             stat err =       0.000425585633
             autocorr =       1.245960803018
   target nu stat err =       0.000425585633
   target dn stat err =       0.002208969034
      target stat err =       0.003503708359
              std dev =       0.539199854146
             le_variance =       0.290736482711


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720694704061e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915615820127       residual = 3.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915757486173       residual = 9.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915783271658       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915788048471       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915791374250       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915794673892       residual = 7.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915797320406       residual = 6.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915800692980       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915803503732       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915802445673       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915801642610       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915804093448       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915805177329       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915808010783       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915809010117       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915809111197       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915810133568       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915813161112       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915813756484       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915814252946       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915814744793       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915814496523       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915815724294       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915815751992       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915815446375       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915815131027       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915815188966       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915815835321       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915816109094       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915816149950       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915816341030       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915816333594       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915816122586       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915816264126       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915816118646       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915816387465       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915816591485       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915816638814       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915816404331       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915816666812       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.915816733112       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.915816757258       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.915816636949       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.915816650787       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.915816678674       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e-02 is 4.377436e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915615820127       residual = 3.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915676101737       residual = 8.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915686034627       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915687764818       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915688944032       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915690235808       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915691251002       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915692317438       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915693299932       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915692958277       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915692690563       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915693909134       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915694263868       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915694996702       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915695116974       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915695114616       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915695674402       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915696639860       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915696646552       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915696626284       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915696717195       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915696574021       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915696870445       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915696855674       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915696716948       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915696734350       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915696775470       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915696889529       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915696891597       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915696920130       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915696950577       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915696893715       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915696848189       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915696887571       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915696878776       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915696965347       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915696971341       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915696956795       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915696942370       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915696955889       residual = 3.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.5000e-01 is 1.141113e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915615820127       residual = 3.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915634098304       residual = 8.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915636953680       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915637438924       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915637762763       residual = 5.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915638152404       residual = 6.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915638434184       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915638711158       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915638978552       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915638886267       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915638831642       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915639213925       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915639297503       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915639458929       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915639468257       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915639470423       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915639657432       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915639888469       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915639874043       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915639854864       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915639870856       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915639831851       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915639904099       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915639896294       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915639862619       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915639882554       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915639884067       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915639903527       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915639906775       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915639911080       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915639916654       residual = 7.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915639901519       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915639894519       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915639901279       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915639902036       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915639922483       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915639918983       residual = 9.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.0000e+00 is 2.863933e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.319347 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5503e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
  uu_0                 2.089947e-01 1 1  ON 0
  uu_1                 5.210146e-02 1 1  ON 1
  uu_2                -3.871802e-02 1 1  ON 2
  uu_3                -9.212299e-02 1 1  ON 3
  uu_4                -1.231615e-01 1 1  ON 4
  uu_5                -1.312095e-01 1 1  ON 5
  uu_6                -1.132179e-01 1 1  ON 6
  uu_7                -5.531031e-02 1 1  ON 7
  uu_8                 6.626551e-02 1 1  ON 8
  uu_9                 1.245655e-01 1 1  ON 9
  ud_0                 3.062047e-01 1 1  ON 10
  ud_1                 7.649574e-02 1 1  ON 11
  ud_2                -2.531743e-02 1 1  ON 12
  ud_3                -7.824947e-02 1 1  ON 13
  ud_4                -1.144274e-01 1 1  ON 14
  ud_5                -1.337801e-01 1 1  ON 15
  ud_6                -1.284686e-01 1 1  ON 16
  ud_7                -8.778547e-02 1 1  ON 17
  ud_8                -4.296937e-03 1 1  ON 18
  ud_9                 8.727098e-02 1 1  ON 19
  eO_0                -7.040234e-01 1 1  ON 20
  eO_1                -4.207897e-01 1 1  ON 21
  eO_2                -4.220218e-02 1 1  ON 22
  eO_3                 1.853733e-01 1 1  ON 23
  eO_4                 2.601723e-01 1 1  ON 24
  eO_5                 2.840812e-01 1 1  ON 25
  eO_6                 2.501931e-01 1 1  ON 26
  eO_7                 1.280088e-01 1 1  ON 27
  eO_8                 2.879077e-02 1 1  ON 28
  eO_9                 1.912525e-02 1 1  ON 29
 eH1_0                -2.024615e-01 1 1  ON 30
 eH1_1                -9.727757e-02 1 1  ON 31
 eH1_2                -4.618017e-02 1 1  ON 32
 eH1_3                -1.499408e-02 1 1  ON 33
 eH1_4                 1.856319e-02 1 1  ON 34
 eH1_5                 2.466831e-02 1 1  ON 35
 eH1_6                 7.384757e-02 1 1  ON 36
 eH1_7                 1.039268e-01 1 1  ON 37
 eH1_8                 9.852241e-02 1 1  ON 38
 eH1_9                 2.555439e-02 1 1  ON 39
 eH2_0                -2.027021e-01 1 1  ON 40
 eH2_1                -9.872672e-02 1 1  ON 41
 eH2_2                -4.792611e-02 1 1  ON 42
 eH2_3                -1.716934e-02 1 1  ON 43
 eH2_4                 1.589420e-02 1 1  ON 44
 eH2_5                 2.069717e-02 1 1  ON 45
 eH2_6                 7.567400e-02 1 1  ON 46
 eH2_7                 1.123225e-01 1 1  ON 47
 eH2_8                 1.010013e-01 1 1  ON 48
 eH2_9                 2.836724e-02 1 1  ON 49
ci_001                -4.249255e-02 3 1  ON 50
ci_002                -3.109786e-02 3 1  ON 51
ci_003                -1.165790e-02 3 1  ON 52
ci_004                 2.579041e-02 3 1  ON 53
ci_005                 2.595456e-02 3 1  ON 54
ci_006                -2.103002e-02 3 1  ON 55
ci_007                -2.057492e-02 3 1  ON 56
ci_008                -4.670049e-03 3 1  ON 57
ci_009                -1.554276e-02 3 1  ON 58
ci_010                -9.721459e-03 3 1  ON 59
ci_011                -1.006909e-02 3 1  ON 60
ci_012                -1.010213e-02 3 1  ON 61
ci_013                -2.169895e-02 3 1  ON 62
ci_014                 1.337180e-02 3 1  ON 63
ci_015                 1.312876e-02 3 1  ON 64
ci_016                 1.660135e-02 3 1  ON 65
ci_017                 1.612258e-02 3 1  ON 66
ci_018                 1.078299e-02 3 1  ON 67
ci_019                 1.079628e-02 3 1  ON 68
ci_020                 1.835387e-02 3 1  ON 69
ci_021                 1.787615e-02 3 1  ON 70
ci_022                 1.043273e-02 3 1  ON 71
ci_023                 1.040010e-02 3 1  ON 72
ci_024                 6.835654e-03 3 1  ON 73
ci_025                 6.855027e-03 3 1  ON 74
ci_026                 1.186605e-02 3 1  ON 75
ci_027                 1.192436e-02 3 1  ON 76
ci_028                -9.490591e-03 3 1  ON 77
ci_029                -1.009633e-02 3 1  ON 78
ci_030                -4.845666e-03 3 1  ON 79
ci_031                -4.988610e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2296
    reference variance = 0.191258
====================================================
  Execution time = 1.9572e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0133e-01
  Total weights = 1.9738e+06
  Execution time = 1.6135e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294255199160
                                         uncertainty =       0.003851877043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294255199160
                                         uncertainty =       0.003851877043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383595972
  error estimate for blocks of size 2^( 2) =       0.000398436348
  error estimate for blocks of size 2^( 3) =       0.000412561005
  error estimate for blocks of size 2^( 4) =       0.000422381010
  error estimate for blocks of size 2^( 5) =       0.000428050422
  error estimate for blocks of size 2^( 6) =       0.000431721730
  error estimate for blocks of size 2^( 7) =       0.000435101950

      target function =      -0.910491780169
              le_mean =     -17.206911343547
             les_mean =     296.379265158401
             stat err =       0.000429313778
             autocorr =       1.252568763806
   target nu stat err =       0.000429313778
   target dn stat err =       0.003620411758
      target stat err =       0.005603500437
              std dev =       0.542486625625
             le_variance =       0.294291738982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294332591542
                                         uncertainty =       0.003844936101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294332591542
                                         uncertainty =       0.003844936101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383646435
  error estimate for blocks of size 2^( 2) =       0.000398674204
  error estimate for blocks of size 2^( 3) =       0.000412992400
  error estimate for blocks of size 2^( 4) =       0.000422960917
  error estimate for blocks of size 2^( 5) =       0.000428713718
  error estimate for blocks of size 2^( 6) =       0.000432424428
  error estimate for blocks of size 2^( 7) =       0.000435785437

      target function =      -0.909794481578
              le_mean =     -17.206899677964
             les_mean =     296.379318224544
             stat err =       0.000429971125
             autocorr =       1.256076956431
   target nu stat err =       0.000429971125
   target dn stat err =       0.003653679558
      target stat err =       0.005645573108
              std dev =       0.542557991684
             le_variance =       0.294369174340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294301422072
                                         uncertainty =       0.003846083572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294301422072
                                         uncertainty =       0.003846083572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383626155
  error estimate for blocks of size 2^( 2) =       0.000398616339
  error estimate for blocks of size 2^( 3) =       0.000412895132
  error estimate for blocks of size 2^( 4) =       0.000422831941
  error estimate for blocks of size 2^( 5) =       0.000428567096
  error estimate for blocks of size 2^( 6) =       0.000432268920
  error estimate for blocks of size 2^( 7) =       0.000435636328

      target function =      -0.910426859683
              le_mean =     -17.206899339653
             les_mean =     296.378894449717
             stat err =       0.000429826072
             autocorr =       1.255362326140
   target nu stat err =       0.000429826072
   target dn stat err =       0.003631006289
      target stat err =       0.005618817926
              std dev =       0.542529311254
             le_variance =       0.294338053570

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294253331513
                                         uncertainty =       0.003850911369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294253331513
                                         uncertainty =       0.003850911369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383594769
  error estimate for blocks of size 2^( 2) =       0.000398457010
  error estimate for blocks of size 2^( 3) =       0.000412603842
  error estimate for blocks of size 2^( 4) =       0.000422440789
  error estimate for blocks of size 2^( 5) =       0.000428119554
  error estimate for blocks of size 2^( 6) =       0.000431795546
  error estimate for blocks of size 2^( 7) =       0.000435174731

      target function =      -0.910454404511
              le_mean =     -17.206908439237
             les_mean =     296.379189580408
             stat err =       0.000429382655
             autocorr =       1.252978569672
   target nu stat err =       0.000429382655
   target dn stat err =       0.003623386203
      target stat err =       0.005607555974
              std dev =       0.542484924122
             le_variance =       0.294289892899


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910491780169        initial  <--
     6.2500e-02     6.2500e-01             4.3774e-03        -0.909794481578
     2.5000e-01     2.5000e+00             1.1411e-03        -0.910426859683
     1.0000e+00     1.0000e+01             2.8639e-04        -0.910454404511

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.6776
  </log>
  <optVariables href="H2O.s002.opt.xml">
  uu_0                 2.086320e-01 1 1  ON 0
  uu_1                 5.170972e-02 1 1  ON 1
  uu_2                -3.905445e-02 1 1  ON 2
  uu_3                -9.244838e-02 1 1  ON 3
  uu_4                -1.232820e-01 1 1  ON 4
  uu_5                -1.309832e-01 1 1  ON 5
  uu_6                -1.127785e-01 1 1  ON 6
  uu_7                -5.438593e-02 1 1  ON 7
  uu_8                 6.740662e-02 1 1  ON 8
  uu_9                 1.242124e-01 1 1  ON 9
  ud_0                 3.069615e-01 1 1  ON 10
  ud_1                 7.713217e-02 1 1  ON 11
  ud_2                -2.478183e-02 1 1  ON 12
  ud_3                -7.796668e-02 1 1  ON 13
  ud_4                -1.144043e-01 1 1  ON 14
  ud_5                -1.342349e-01 1 1  ON 15
  ud_6                -1.291673e-01 1 1  ON 16
  ud_7                -8.855410e-02 1 1  ON 17
  ud_8                -4.342918e-03 1 1  ON 18
  ud_9                 8.773357e-02 1 1  ON 19
  eO_0                -7.040565e-01 1 1  ON 20
  eO_1                -4.207646e-01 1 1  ON 21
  eO_2                -4.182687e-02 1 1  ON 22
  eO_3                 1.857176e-01 1 1  ON 23
  eO_4                 2.602388e-01 1 1  ON 24
  eO_5                 2.842238e-01 1 1  ON 25
  eO_6                 2.505895e-01 1 1  ON 26
  eO_7                 1.269474e-01 1 1  ON 27
  eO_8                 2.865876e-02 1 1  ON 28
  eO_9                 1.904724e-02 1 1  ON 29
 eH1_0                -2.023199e-01 1 1  ON 30
 eH1_1                -9.755676e-02 1 1  ON 31
 eH1_2                -4.650052e-02 1 1  ON 32
 eH1_3                -1.508232e-02 1 1  ON 33
 eH1_4                 1.853749e-02 1 1  ON 34
 eH1_5                 2.547286e-02 1 1  ON 35
 eH1_6                 7.435779e-02 1 1  ON 36
 eH1_7                 1.039717e-01 1 1  ON 37
 eH1_8                 9.787288e-02 1 1  ON 38
 eH1_9                 2.541471e-02 1 1  ON 39
 eH2_0                -2.030423e-01 1 1  ON 40
 eH2_1                -9.892920e-02 1 1  ON 41
 eH2_2                -4.823893e-02 1 1  ON 42
 eH2_3                -1.725774e-02 1 1  ON 43
 eH2_4                 1.618841e-02 1 1  ON 44
 eH2_5                 2.149505e-02 1 1  ON 45
 eH2_6                 7.626421e-02 1 1  ON 46
 eH2_7                 1.121495e-01 1 1  ON 47
 eH2_8                 1.006157e-01 1 1  ON 48
 eH2_9                 2.827407e-02 1 1  ON 49
ci_001                -4.244824e-02 3 1  ON 50
ci_002                -3.117395e-02 3 1  ON 51
ci_003                -1.193198e-02 3 1  ON 52
ci_004                 2.577115e-02 3 1  ON 53
ci_005                 2.619651e-02 3 1  ON 54
ci_006                -2.103647e-02 3 1  ON 55
ci_007                -2.037688e-02 3 1  ON 56
ci_008                -4.826282e-03 3 1  ON 57
ci_009                -1.576431e-02 3 1  ON 58
ci_010                -1.020160e-02 3 1  ON 59
ci_011                -1.000190e-02 3 1  ON 60
ci_012                -9.987120e-03 3 1  ON 61
ci_013                -2.157837e-02 3 1  ON 62
ci_014                 1.341866e-02 3 1  ON 63
ci_015                 1.345693e-02 3 1  ON 64
ci_016                 1.672724e-02 3 1  ON 65
ci_017                 1.639341e-02 3 1  ON 66
ci_018                 1.102960e-02 3 1  ON 67
ci_019                 1.086511e-02 3 1  ON 68
ci_020                 1.844657e-02 3 1  ON 69
ci_021                 1.783953e-02 3 1  ON 70
ci_022                 1.045822e-02 3 1  ON 71
ci_023                 1.057219e-02 3 1  ON 72
ci_024                 6.969048e-03 3 1  ON 73
ci_025                 6.775677e-03 3 1  ON 74
ci_026                 1.182471e-02 3 1  ON 75
ci_027                 1.183016e-02 3 1  ON 76
ci_028                -9.429818e-03 3 1  ON 77
ci_029                -1.025663e-02 3 1  ON 78
ci_030                -4.843899e-03 3 1  ON 79
ci_031                -5.048988e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.3188e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7191e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1825
    reference variance = 0.238896
====================================================
  Execution time = 2.0265e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5435e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0080e-01
  Total weights = 1.973817065e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7122e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292758788641
                                         uncertainty =       0.002633051581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292758788641
                                         uncertainty =       0.002633051581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382599340
  error estimate for blocks of size 2^( 2) =       0.000397902884
  error estimate for blocks of size 2^( 3) =       0.000411673462
  error estimate for blocks of size 2^( 4) =       0.000422246717
  error estimate for blocks of size 2^( 5) =       0.000428093085
  error estimate for blocks of size 2^( 6) =       0.000429937670
  error estimate for blocks of size 2^( 7) =       0.000432404512

      target function =      -0.911510560849
              le_mean =     -17.206979613228
             les_mean =     296.380950793569
             stat err =       0.000428170496
             autocorr =       1.252405721951
   target nu stat err =       0.000428170496
   target dn stat err =       0.003580133468
      target stat err =       0.005554956020
              std dev =       0.541077175403
             le_variance =       0.292764509742


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720697961323e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911543308632       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911684136276       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911702093146       residual = 7.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911708750388       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911709691831       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911710853009       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911711332469       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911712365348       residual = 8.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911713711987       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911714234307       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911714846860       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911715185523       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911715635967       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911715718301       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911715642209       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911715791523       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911715855690       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911715973869       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911716072320       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911716220962       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911716237184       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911716309384       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911716295055       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911716155577       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911716259648       residual = 9.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911716278785       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911716289519       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911716306661       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911716266847       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911716267683       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911716365443       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911716381771       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911716376020       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911716379430       residual = 9.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911716381563       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911716381720       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911716392870       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911716395782       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.911716402386       residual = 7.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e-01 is 7.804365e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911543308632       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911581685206       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911586608320       residual = 6.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911588383406       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911588631211       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911588939709       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911589067248       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911589344056       residual = 8.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911589699819       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911589834107       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911589993510       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911590081629       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911590192587       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911590205715       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911590185207       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911590223297       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911590237134       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911590271193       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911590296853       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911590331544       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911590337623       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911590351477       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911590340344       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911590309719       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911590338598       residual = 8.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911590341920       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911590344099       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911590347538       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911590337159       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911590339370       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911590364148       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911590364709       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911590364693       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911590365182       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911590365224       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911590365687       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.5000e+00 is 2.029731e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911543308632       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911553123650       residual = 3.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911554385013       residual = 6.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911554836249       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911554899061       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911554977419       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911555009848       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911555080368       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911555170487       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911555204303       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911555244574       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911555266813       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911555294354       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911555297130       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911555291918       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911555301479       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911555304801       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911555313656       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911555320101       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911555328602       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911555330260       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911555333383       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911555330118       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911555322861       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911555330223       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911555330911       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911555331416       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911555332227       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911555329633       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911555330328       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911555336470       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911555336425       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911555336560       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911555336621       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911555336590       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911555336746       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.0000e+01 is 5.127469e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.375841 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6038e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
  uu_0                 2.086182e-01 1 1  ON 0
  uu_1                 5.167460e-02 1 1  ON 1
  uu_2                -3.909828e-02 1 1  ON 2
  uu_3                -9.248073e-02 1 1  ON 3
  uu_4                -1.232743e-01 1 1  ON 4
  uu_5                -1.309456e-01 1 1  ON 5
  uu_6                -1.127101e-01 1 1  ON 6
  uu_7                -5.430094e-02 1 1  ON 7
  uu_8                 6.723384e-02 1 1  ON 8
  uu_9                 1.242443e-01 1 1  ON 9
  ud_0                 3.069305e-01 1 1  ON 10
  ud_1                 7.715408e-02 1 1  ON 11
  ud_2                -2.479216e-02 1 1  ON 12
  ud_3                -7.800270e-02 1 1  ON 13
  ud_4                -1.144271e-01 1 1  ON 14
  ud_5                -1.342187e-01 1 1  ON 15
  ud_6                -1.291802e-01 1 1  ON 16
  ud_7                -8.851863e-02 1 1  ON 17
  ud_8                -4.322278e-03 1 1  ON 18
  ud_9                 8.770740e-02 1 1  ON 19
  eO_0                -7.040817e-01 1 1  ON 20
  eO_1                -4.207723e-01 1 1  ON 21
  eO_2                -4.179962e-02 1 1  ON 22
  eO_3                 1.857302e-01 1 1  ON 23
  eO_4                 2.601199e-01 1 1  ON 24
  eO_5                 2.841749e-01 1 1  ON 25
  eO_6                 2.506411e-01 1 1  ON 26
  eO_7                 1.270405e-01 1 1  ON 27
  eO_8                 2.867010e-02 1 1  ON 28
  eO_9                 1.905057e-02 1 1  ON 29
 eH1_0                -2.022664e-01 1 1  ON 30
 eH1_1                -9.745692e-02 1 1  ON 31
 eH1_2                -4.641028e-02 1 1  ON 32
 eH1_3                -1.504914e-02 1 1  ON 33
 eH1_4                 1.847800e-02 1 1  ON 34
 eH1_5                 2.526989e-02 1 1  ON 35
 eH1_6                 7.431253e-02 1 1  ON 36
 eH1_7                 1.039664e-01 1 1  ON 37
 eH1_8                 9.790363e-02 1 1  ON 38
 eH1_9                 2.541158e-02 1 1  ON 39
 eH2_0                -2.030692e-01 1 1  ON 40
 eH2_1                -9.889429e-02 1 1  ON 41
 eH2_2                -4.819185e-02 1 1  ON 42
 eH2_3                -1.723817e-02 1 1  ON 43
 eH2_4                 1.617830e-02 1 1  ON 44
 eH2_5                 2.145171e-02 1 1  ON 45
 eH2_6                 7.620235e-02 1 1  ON 46
 eH2_7                 1.121174e-01 1 1  ON 47
 eH2_8                 1.006639e-01 1 1  ON 48
 eH2_9                 2.829938e-02 1 1  ON 49
ci_001                -4.244011e-02 3 1  ON 50
ci_002                -3.114954e-02 3 1  ON 51
ci_003                -1.193445e-02 3 1  ON 52
ci_004                 2.580234e-02 3 1  ON 53
ci_005                 2.620780e-02 3 1  ON 54
ci_006                -2.101649e-02 3 1  ON 55
ci_007                -2.034782e-02 3 1  ON 56
ci_008                -4.814727e-03 3 1  ON 57
ci_009                -1.577859e-02 3 1  ON 58
ci_010                -1.022284e-02 3 1  ON 59
ci_011                -1.000844e-02 3 1  ON 60
ci_012                -9.942061e-03 3 1  ON 61
ci_013                -2.153401e-02 3 1  ON 62
ci_014                 1.340704e-02 3 1  ON 63
ci_015                 1.346746e-02 3 1  ON 64
ci_016                 1.667816e-02 3 1  ON 65
ci_017                 1.638760e-02 3 1  ON 66
ci_018                 1.095770e-02 3 1  ON 67
ci_019                 1.085325e-02 3 1  ON 68
ci_020                 1.839128e-02 3 1  ON 69
ci_021                 1.789732e-02 3 1  ON 70
ci_022                 1.041769e-02 3 1  ON 71
ci_023                 1.056421e-02 3 1  ON 72
ci_024                 6.974445e-03 3 1  ON 73
ci_025                 6.754416e-03 3 1  ON 74
ci_026                 1.183768e-02 3 1  ON 75
ci_027                 1.182972e-02 3 1  ON 76
ci_028                -9.448230e-03 3 1  ON 77
ci_029                -1.032694e-02 3 1  ON 78
ci_030                -4.797131e-03 3 1  ON 79
ci_031                -4.933812e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2318
    reference variance = 0.190747
====================================================
  Execution time = 1.9210e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9807e-01
  Total weights = 1.9739e+06
  Execution time = 1.6267e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289666477444
                                         uncertainty =       0.001808607494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289666477444
                                         uncertainty =       0.001808607494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380558224
  error estimate for blocks of size 2^( 2) =       0.000395797334
  error estimate for blocks of size 2^( 3) =       0.000409795197
  error estimate for blocks of size 2^( 4) =       0.000420518749
  error estimate for blocks of size 2^( 5) =       0.000426559062
  error estimate for blocks of size 2^( 6) =       0.000429798244
  error estimate for blocks of size 2^( 7) =       0.000431032579

      target function =      -0.915742594064
              le_mean =     -17.205712502898
             les_mean =     296.334632568202
             stat err =       0.000426977159
             autocorr =       1.258829938280
   target nu stat err =       0.000426977159
   target dn stat err =       0.002463243294
      target stat err =       0.003883506015
              std dev =       0.538190601173
             le_variance =       0.289649123190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289694668587
                                         uncertainty =       0.001802070855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289694668587
                                         uncertainty =       0.001802070855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380577073
  error estimate for blocks of size 2^( 2) =       0.000395840450
  error estimate for blocks of size 2^( 3) =       0.000409862250
  error estimate for blocks of size 2^( 4) =       0.000420605564
  error estimate for blocks of size 2^( 5) =       0.000426656482
  error estimate for blocks of size 2^( 6) =       0.000429901801
  error estimate for blocks of size 2^( 7) =       0.000431128200

      target function =      -0.915634270494
              le_mean =     -17.205715867804
             les_mean =     296.334818470503
             stat err =       0.000427073012
             autocorr =       1.259270447000
   target nu stat err =       0.000427073012
   target dn stat err =       0.002438589562
      target stat err =       0.003845147650
              std dev =       0.538217258772
             le_variance =       0.289677817640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289678200998
                                         uncertainty =       0.001804898487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289678200998
                                         uncertainty =       0.001804898487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380566106
  error estimate for blocks of size 2^( 2) =       0.000395818351
  error estimate for blocks of size 2^( 3) =       0.000409829103
  error estimate for blocks of size 2^( 4) =       0.000420563312
  error estimate for blocks of size 2^( 5) =       0.000426609302
  error estimate for blocks of size 2^( 6) =       0.000429851863
  error estimate for blocks of size 2^( 7) =       0.000431081859

      target function =      -0.915761086017
              le_mean =     -17.205713947333
             les_mean =     296.334670464282
             stat err =       0.000427026584
             autocorr =       1.259069232785
   target nu stat err =       0.000427026584
   target dn stat err =       0.002446096519
      target stat err =       0.003857589060
              std dev =       0.538201748363
             le_variance =       0.289661121941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289667492286
                                         uncertainty =       0.001808115629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289667492286
                                         uncertainty =       0.001808115629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380558914
  error estimate for blocks of size 2^( 2) =       0.000395799700
  error estimate for blocks of size 2^( 3) =       0.000409799205
  error estimate for blocks of size 2^( 4) =       0.000420524114
  error estimate for blocks of size 2^( 5) =       0.000426565146
  error estimate for blocks of size 2^( 6) =       0.000429804753
  error estimate for blocks of size 2^( 7) =       0.000431038534

      target function =      -0.915751824851
              le_mean =     -17.205712636666
             les_mean =     296.334631232327
             stat err =       0.000426983137
             autocorr =       1.258860622465
   target nu stat err =       0.000426983137
   target dn stat err =       0.002460684984
      target stat err =       0.003879691777
              std dev =       0.538191576968
             le_variance =       0.289650173519


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915742594064        initial
     6.2500e-01     6.2500e+00             7.8044e-04        -0.915634270494
     2.5000e+00     2.5000e+01             2.0297e-04        -0.915761086017  <--
     1.0000e+01     1.0000e+02             5.1275e-05        -0.915751824851

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.7364e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
  uu_0                 2.086182e-01 1 1  ON 0
  uu_1                 5.167460e-02 1 1  ON 1
  uu_2                -3.909828e-02 1 1  ON 2
  uu_3                -9.248073e-02 1 1  ON 3
  uu_4                -1.232743e-01 1 1  ON 4
  uu_5                -1.309456e-01 1 1  ON 5
  uu_6                -1.127101e-01 1 1  ON 6
  uu_7                -5.430094e-02 1 1  ON 7
  uu_8                 6.723384e-02 1 1  ON 8
  uu_9                 1.242443e-01 1 1  ON 9
  ud_0                 3.069305e-01 1 1  ON 10
  ud_1                 7.715408e-02 1 1  ON 11
  ud_2                -2.479216e-02 1 1  ON 12
  ud_3                -7.800270e-02 1 1  ON 13
  ud_4                -1.144271e-01 1 1  ON 14
  ud_5                -1.342187e-01 1 1  ON 15
  ud_6                -1.291802e-01 1 1  ON 16
  ud_7                -8.851863e-02 1 1  ON 17
  ud_8                -4.322278e-03 1 1  ON 18
  ud_9                 8.770740e-02 1 1  ON 19
  eO_0                -7.040817e-01 1 1  ON 20
  eO_1                -4.207723e-01 1 1  ON 21
  eO_2                -4.179962e-02 1 1  ON 22
  eO_3                 1.857302e-01 1 1  ON 23
  eO_4                 2.601199e-01 1 1  ON 24
  eO_5                 2.841749e-01 1 1  ON 25
  eO_6                 2.506411e-01 1 1  ON 26
  eO_7                 1.270405e-01 1 1  ON 27
  eO_8                 2.867010e-02 1 1  ON 28
  eO_9                 1.905057e-02 1 1  ON 29
 eH1_0                -2.022664e-01 1 1  ON 30
 eH1_1                -9.745692e-02 1 1  ON 31
 eH1_2                -4.641028e-02 1 1  ON 32
 eH1_3                -1.504914e-02 1 1  ON 33
 eH1_4                 1.847800e-02 1 1  ON 34
 eH1_5                 2.526989e-02 1 1  ON 35
 eH1_6                 7.431253e-02 1 1  ON 36
 eH1_7                 1.039664e-01 1 1  ON 37
 eH1_8                 9.790363e-02 1 1  ON 38
 eH1_9                 2.541158e-02 1 1  ON 39
 eH2_0                -2.030692e-01 1 1  ON 40
 eH2_1                -9.889429e-02 1 1  ON 41
 eH2_2                -4.819185e-02 1 1  ON 42
 eH2_3                -1.723817e-02 1 1  ON 43
 eH2_4                 1.617830e-02 1 1  ON 44
 eH2_5                 2.145171e-02 1 1  ON 45
 eH2_6                 7.620235e-02 1 1  ON 46
 eH2_7                 1.121174e-01 1 1  ON 47
 eH2_8                 1.006639e-01 1 1  ON 48
 eH2_9                 2.829938e-02 1 1  ON 49
ci_001                -4.244011e-02 3 1  ON 50
ci_002                -3.114954e-02 3 1  ON 51
ci_003                -1.193445e-02 3 1  ON 52
ci_004                 2.580234e-02 3 1  ON 53
ci_005                 2.620780e-02 3 1  ON 54
ci_006                -2.101649e-02 3 1  ON 55
ci_007                -2.034782e-02 3 1  ON 56
ci_008                -4.814727e-03 3 1  ON 57
ci_009                -1.577859e-02 3 1  ON 58
ci_010                -1.022284e-02 3 1  ON 59
ci_011                -1.000844e-02 3 1  ON 60
ci_012                -9.942061e-03 3 1  ON 61
ci_013                -2.153401e-02 3 1  ON 62
ci_014                 1.340704e-02 3 1  ON 63
ci_015                 1.346746e-02 3 1  ON 64
ci_016                 1.667816e-02 3 1  ON 65
ci_017                 1.638760e-02 3 1  ON 66
ci_018                 1.095770e-02 3 1  ON 67
ci_019                 1.085325e-02 3 1  ON 68
ci_020                 1.839128e-02 3 1  ON 69
ci_021                 1.789732e-02 3 1  ON 70
ci_022                 1.041769e-02 3 1  ON 71
ci_023                 1.056421e-02 3 1  ON 72
ci_024                 6.974445e-03 3 1  ON 73
ci_025                 6.754416e-03 3 1  ON 74
ci_026                 1.183768e-02 3 1  ON 75
ci_027                 1.182972e-02 3 1  ON 76
ci_028                -9.448230e-03 3 1  ON 77
ci_029                -1.032694e-02 3 1  ON 78
ci_030                -4.797131e-03 3 1  ON 79
ci_031                -4.933812e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.3409e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7195e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.217
    reference variance = 0.149785
====================================================
  Execution time = 2.0077e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5422e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9852e-01
  Total weights = 1.973868034e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5699e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287112113702
                                         uncertainty =       0.001763132144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287112113702
                                         uncertainty =       0.001763132144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378911388
  error estimate for blocks of size 2^( 2) =       0.000393850914
  error estimate for blocks of size 2^( 3) =       0.000408168361
  error estimate for blocks of size 2^( 4) =       0.000418388351
  error estimate for blocks of size 2^( 5) =       0.000424031009
  error estimate for blocks of size 2^( 6) =       0.000428386005
  error estimate for blocks of size 2^( 7) =       0.000428132706

      target function =      -0.915032235587
              le_mean =     -17.207187623519
             les_mean =     296.385826584452
             stat err =       0.000424734518
             autocorr =       1.256492201358
   target nu stat err =       0.000424734518
   target dn stat err =       0.003536123231
      target stat err =       0.005531317754
              std dev =       0.535861624362
             le_variance =       0.287147680464


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720718762352e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915064639341       residual = 6.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915103823906       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915112377429       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915116533734       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915117361224       residual = 9.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915118608788       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915118989485       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915120449342       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915121115012       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915121673242       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915122247775       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915122476663       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915122834009       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915123161323       residual = 8.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915123159337       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915123419185       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915123727566       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915123865230       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915123807830       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915123784330       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915123871636       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915123941073       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915124041916       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915124068607       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915124033035       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915124107192       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915124119042       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915124100718       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915124169064       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915124152085       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915124150073       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915124173403       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915124197713       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915124208237       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915124179272       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915124196353       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915124206138       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915124194609       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915124198256       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e-01 is 5.130731e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915064639341       residual = 6.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915075297246       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915077614659       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915078721080       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915078944384       residual = 9.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915079272406       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915079369734       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915079758134       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915079935100       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915080081315       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915080234532       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915080292755       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915080381039       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915080462060       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915080463355       residual = 7.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915080534657       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915080610835       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915080638045       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915080619169       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915080615090       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915080639995       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915080657510       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915080681445       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915080684889       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915080677220       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915080694954       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915080696104       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915080692407       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915080708498       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915080703350       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915080703128       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915080708527       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915080714246       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915080716386       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915080709962       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915080713900       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.5000e+00 is 1.310178e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915064639341       residual = 6.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915067363730       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915067955469       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915068236591       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915068293672       residual = 9.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915068376697       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915068401114       residual = 7.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915068499799       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915068544753       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915068581795       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915068620694       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915068635286       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915068657243       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915068677446       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915068677908       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915068696160       residual = 9.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915068715089       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915068721371       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915068716356       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915068715498       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915068721940       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915068726300       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915068732192       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915068732818       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915068731010       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915068735378       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915068735556       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915068734695       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915068738640       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915068737305       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915068737269       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915068738585       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915068739994       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915068740508       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915068738955       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915068739912       residual = 9.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.0000e+01 is 3.305025e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.432204 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9758e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
  uu_0                 2.086185e-01 1 1  ON 0
  uu_1                 5.169407e-02 1 1  ON 1
  uu_2                -3.907813e-02 1 1  ON 2
  uu_3                -9.245531e-02 1 1  ON 3
  uu_4                -1.232625e-01 1 1  ON 4
  uu_5                -1.309587e-01 1 1  ON 5
  uu_6                -1.127433e-01 1 1  ON 6
  uu_7                -5.430741e-02 1 1  ON 7
  uu_8                 6.710548e-02 1 1  ON 8
  uu_9                 1.242698e-01 1 1  ON 9
  ud_0                 3.068398e-01 1 1  ON 10
  ud_1                 7.709371e-02 1 1  ON 11
  ud_2                -2.484885e-02 1 1  ON 12
  ud_3                -7.803879e-02 1 1  ON 13
  ud_4                -1.144138e-01 1 1  ON 14
  ud_5                -1.341557e-01 1 1  ON 15
  ud_6                -1.291213e-01 1 1  ON 16
  ud_7                -8.838761e-02 1 1  ON 17
  ud_8                -4.369279e-03 1 1  ON 18
  ud_9                 8.765649e-02 1 1  ON 19
  eO_0                -7.039884e-01 1 1  ON 20
  eO_1                -4.207120e-01 1 1  ON 21
  eO_2                -4.181808e-02 1 1  ON 22
  eO_3                 1.856267e-01 1 1  ON 23
  eO_4                 2.600099e-01 1 1  ON 24
  eO_5                 2.840891e-01 1 1  ON 25
  eO_6                 2.506603e-01 1 1  ON 26
  eO_7                 1.271587e-01 1 1  ON 27
  eO_8                 2.868695e-02 1 1  ON 28
  eO_9                 1.905842e-02 1 1  ON 29
 eH1_0                -2.022966e-01 1 1  ON 30
 eH1_1                -9.748275e-02 1 1  ON 31
 eH1_2                -4.636514e-02 1 1  ON 32
 eH1_3                -1.502481e-02 1 1  ON 33
 eH1_4                 1.853118e-02 1 1  ON 34
 eH1_5                 2.520841e-02 1 1  ON 35
 eH1_6                 7.423448e-02 1 1  ON 36
 eH1_7                 1.039603e-01 1 1  ON 37
 eH1_8                 9.796812e-02 1 1  ON 38
 eH1_9                 2.542749e-02 1 1  ON 39
 eH2_0                -2.031136e-01 1 1  ON 40
 eH2_1                -9.886397e-02 1 1  ON 41
 eH2_2                -4.815801e-02 1 1  ON 42
 eH2_3                -1.720036e-02 1 1  ON 43
 eH2_4                 1.616772e-02 1 1  ON 44
 eH2_5                 2.135231e-02 1 1  ON 45
 eH2_6                 7.620966e-02 1 1  ON 46
 eH2_7                 1.120890e-01 1 1  ON 47
 eH2_8                 1.007281e-01 1 1  ON 48
 eH2_9                 2.830106e-02 1 1  ON 49
ci_001                -4.243956e-02 3 1  ON 50
ci_002                -3.113683e-02 3 1  ON 51
ci_003                -1.190166e-02 3 1  ON 52
ci_004                 2.578493e-02 3 1  ON 53
ci_005                 2.622156e-02 3 1  ON 54
ci_006                -2.101475e-02 3 1  ON 55
ci_007                -2.035235e-02 3 1  ON 56
ci_008                -4.823857e-03 3 1  ON 57
ci_009                -1.579673e-02 3 1  ON 58
ci_010                -1.018082e-02 3 1  ON 59
ci_011                -9.993890e-03 3 1  ON 60
ci_012                -9.937184e-03 3 1  ON 61
ci_013                -2.151343e-02 3 1  ON 62
ci_014                 1.342955e-02 3 1  ON 63
ci_015                 1.346263e-02 3 1  ON 64
ci_016                 1.669256e-02 3 1  ON 65
ci_017                 1.635624e-02 3 1  ON 66
ci_018                 1.095763e-02 3 1  ON 67
ci_019                 1.084461e-02 3 1  ON 68
ci_020                 1.840594e-02 3 1  ON 69
ci_021                 1.792775e-02 3 1  ON 70
ci_022                 1.043961e-02 3 1  ON 71
ci_023                 1.059208e-02 3 1  ON 72
ci_024                 6.959037e-03 3 1  ON 73
ci_025                 6.726096e-03 3 1  ON 74
ci_026                 1.184592e-02 3 1  ON 75
ci_027                 1.180615e-02 3 1  ON 76
ci_028                -9.466650e-03 3 1  ON 77
ci_029                -1.037419e-02 3 1  ON 78
ci_030                -4.731564e-03 3 1  ON 79
ci_031                -4.906853e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1449
    reference variance = 0.212104
====================================================
  Execution time = 1.9797e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0268e-01
  Total weights = 1.9735e+06
  Execution time = 1.6273e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290873704603
                                         uncertainty =       0.003192583211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290873704603
                                         uncertainty =       0.003192583211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381346007
  error estimate for blocks of size 2^( 2) =       0.000396598269
  error estimate for blocks of size 2^( 3) =       0.000410177974
  error estimate for blocks of size 2^( 4) =       0.000420659990
  error estimate for blocks of size 2^( 5) =       0.000427990490
  error estimate for blocks of size 2^( 6) =       0.000430501956
  error estimate for blocks of size 2^( 7) =       0.000432297490

      target function =      -0.908514882678
              le_mean =     -17.206329538399
             les_mean =     296.360483990845
             stat err =       0.000427862482
             autocorr =       1.258838462178
   target nu stat err =       0.000427862482
   target dn stat err =       0.007043671070
      target stat err =       0.010777206918
              std dev =       0.539304695743
             le_variance =       0.290849554851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290790563599
                                         uncertainty =       0.003125019322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290790563599
                                         uncertainty =       0.003125019322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381291709
  error estimate for blocks of size 2^( 2) =       0.000396572722
  error estimate for blocks of size 2^( 3) =       0.000410182442
  error estimate for blocks of size 2^( 4) =       0.000420688286
  error estimate for blocks of size 2^( 5) =       0.000428035295
  error estimate for blocks of size 2^( 6) =       0.000430554547
  error estimate for blocks of size 2^( 7) =       0.000432363327

      target function =      -0.908500678594
              le_mean =     -17.206328308894
             les_mean =     296.360455199024
             stat err =       0.000427910364
             autocorr =       1.259478872717
   target nu stat err =       0.000427910364
   target dn stat err =       0.006865228092
      target stat err =       0.010504990029
              std dev =       0.539227905604
             le_variance =       0.290766734182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290826943643
                                         uncertainty =       0.003155697372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290826943643
                                         uncertainty =       0.003155697372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381315466
  error estimate for blocks of size 2^( 2) =       0.000396583148
  error estimate for blocks of size 2^( 3) =       0.000410178907
  error estimate for blocks of size 2^( 4) =       0.000420673627
  error estimate for blocks of size 2^( 5) =       0.000428012911
  error estimate for blocks of size 2^( 6) =       0.000430528485
  error estimate for blocks of size 2^( 7) =       0.000432330963

      target function =      -0.908558087056
              le_mean =     -17.206328673950
             les_mean =     296.360428266301
             stat err =       0.000427886496
             autocorr =       1.259181461219
   target nu stat err =       0.000427886496
   target dn stat err =       0.006945676795
      target stat err =       0.010628895315
              std dev =       0.539261503176
             le_variance =       0.290802968808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290867506980
                                         uncertainty =       0.003187826802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290867506980
                                         uncertainty =       0.003187826802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381341959
  error estimate for blocks of size 2^( 2) =       0.000396596183
  error estimate for blocks of size 2^( 3) =       0.000410177928
  error estimate for blocks of size 2^( 4) =       0.000420661557
  error estimate for blocks of size 2^( 5) =       0.000427993170
  error estimate for blocks of size 2^( 6) =       0.000430505155
  error estimate for blocks of size 2^( 7) =       0.000432301570

      target function =      -0.908526355016
              le_mean =     -17.206329401568
             les_mean =     296.360472068846
             stat err =       0.000427865363
             autocorr =       1.258882143194
   target nu stat err =       0.000427865363
   target dn stat err =       0.007031006787
      target stat err =       0.010758179467
              std dev =       0.539298970658
             le_variance =       0.290843379753


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908514882678        initial
     6.2500e-01     6.2500e+00             5.1307e-04        -0.908500678594
     2.5000e+00     2.5000e+01             1.3102e-04        -0.908558087056  <--
     1.0000e+01     1.0000e+02             3.3050e-05        -0.908526355016

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.7950e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
  uu_0                 2.086185e-01 1 1  ON 0
  uu_1                 5.169407e-02 1 1  ON 1
  uu_2                -3.907813e-02 1 1  ON 2
  uu_3                -9.245531e-02 1 1  ON 3
  uu_4                -1.232625e-01 1 1  ON 4
  uu_5                -1.309587e-01 1 1  ON 5
  uu_6                -1.127433e-01 1 1  ON 6
  uu_7                -5.430741e-02 1 1  ON 7
  uu_8                 6.710548e-02 1 1  ON 8
  uu_9                 1.242698e-01 1 1  ON 9
  ud_0                 3.068398e-01 1 1  ON 10
  ud_1                 7.709371e-02 1 1  ON 11
  ud_2                -2.484885e-02 1 1  ON 12
  ud_3                -7.803879e-02 1 1  ON 13
  ud_4                -1.144138e-01 1 1  ON 14
  ud_5                -1.341557e-01 1 1  ON 15
  ud_6                -1.291213e-01 1 1  ON 16
  ud_7                -8.838761e-02 1 1  ON 17
  ud_8                -4.369279e-03 1 1  ON 18
  ud_9                 8.765649e-02 1 1  ON 19
  eO_0                -7.039884e-01 1 1  ON 20
  eO_1                -4.207120e-01 1 1  ON 21
  eO_2                -4.181808e-02 1 1  ON 22
  eO_3                 1.856267e-01 1 1  ON 23
  eO_4                 2.600099e-01 1 1  ON 24
  eO_5                 2.840891e-01 1 1  ON 25
  eO_6                 2.506603e-01 1 1  ON 26
  eO_7                 1.271587e-01 1 1  ON 27
  eO_8                 2.868695e-02 1 1  ON 28
  eO_9                 1.905842e-02 1 1  ON 29
 eH1_0                -2.022966e-01 1 1  ON 30
 eH1_1                -9.748275e-02 1 1  ON 31
 eH1_2                -4.636514e-02 1 1  ON 32
 eH1_3                -1.502481e-02 1 1  ON 33
 eH1_4                 1.853118e-02 1 1  ON 34
 eH1_5                 2.520841e-02 1 1  ON 35
 eH1_6                 7.423448e-02 1 1  ON 36
 eH1_7                 1.039603e-01 1 1  ON 37
 eH1_8                 9.796812e-02 1 1  ON 38
 eH1_9                 2.542749e-02 1 1  ON 39
 eH2_0                -2.031136e-01 1 1  ON 40
 eH2_1                -9.886397e-02 1 1  ON 41
 eH2_2                -4.815801e-02 1 1  ON 42
 eH2_3                -1.720036e-02 1 1  ON 43
 eH2_4                 1.616772e-02 1 1  ON 44
 eH2_5                 2.135231e-02 1 1  ON 45
 eH2_6                 7.620966e-02 1 1  ON 46
 eH2_7                 1.120890e-01 1 1  ON 47
 eH2_8                 1.007281e-01 1 1  ON 48
 eH2_9                 2.830106e-02 1 1  ON 49
ci_001                -4.243956e-02 3 1  ON 50
ci_002                -3.113683e-02 3 1  ON 51
ci_003                -1.190166e-02 3 1  ON 52
ci_004                 2.578493e-02 3 1  ON 53
ci_005                 2.622156e-02 3 1  ON 54
ci_006                -2.101475e-02 3 1  ON 55
ci_007                -2.035235e-02 3 1  ON 56
ci_008                -4.823857e-03 3 1  ON 57
ci_009                -1.579673e-02 3 1  ON 58
ci_010                -1.018082e-02 3 1  ON 59
ci_011                -9.993890e-03 3 1  ON 60
ci_012                -9.937184e-03 3 1  ON 61
ci_013                -2.151343e-02 3 1  ON 62
ci_014                 1.342955e-02 3 1  ON 63
ci_015                 1.346263e-02 3 1  ON 64
ci_016                 1.669256e-02 3 1  ON 65
ci_017                 1.635624e-02 3 1  ON 66
ci_018                 1.095763e-02 3 1  ON 67
ci_019                 1.084461e-02 3 1  ON 68
ci_020                 1.840594e-02 3 1  ON 69
ci_021                 1.792775e-02 3 1  ON 70
ci_022                 1.043961e-02 3 1  ON 71
ci_023                 1.059208e-02 3 1  ON 72
ci_024                 6.959037e-03 3 1  ON 73
ci_025                 6.726096e-03 3 1  ON 74
ci_026                 1.184592e-02 3 1  ON 75
ci_027                 1.180615e-02 3 1  ON 76
ci_028                -9.466650e-03 3 1  ON 77
ci_029                -1.037419e-02 3 1  ON 78
ci_030                -4.731564e-03 3 1  ON 79
ci_031                -4.906853e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7714e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7192e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1901
    reference variance = 0.215749
====================================================
  Execution time = 1.9310e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5402e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0497e-01
  Total weights = 1.973756328e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292395851099
                                         uncertainty =       0.002052050478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292395851099
                                         uncertainty =       0.002052050478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382431480
  error estimate for blocks of size 2^( 2) =       0.000397547488
  error estimate for blocks of size 2^( 3) =       0.000411150493
  error estimate for blocks of size 2^( 4) =       0.000421560874
  error estimate for blocks of size 2^( 5) =       0.000426682703
  error estimate for blocks of size 2^( 6) =       0.000429844075
  error estimate for blocks of size 2^( 7) =       0.000433559354

      target function =      -0.905164266688
              le_mean =     -17.206261377717
             les_mean =     296.360397819932
             stat err =       0.000427911752
             autocorr =       1.251990863921
   target nu stat err =       0.000427911752
   target dn stat err =       0.004174738155
      target stat err =       0.006365472632
              std dev =       0.540839785247
             le_variance =       0.292507673307


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720626137772e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905208005051       residual = 6.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905266030668       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905278771238       residual = 6.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905282061583       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905282970165       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905284063173       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905284337962       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905284881492       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905285408167       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905286344862       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905286817824       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.905287410230       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.905287737450       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.905288115360       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.905288642423       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.905288935769       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.905288832224       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.905288806330       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.905288763186       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.905288950660       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.905289021262       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.905288867060       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.905288895022       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.905288884993       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.905288957520       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.905289096488       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.905289089922       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.905289038937       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.905289076789       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.905289137326       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.905289132755       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.905289161196       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.905289144776       residual = 9.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.905289131061       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.905289129745       residual = 7.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.905289151043       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.905289149326       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.905289145753       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.905289151690       residual = 5.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e-01 is 5.375492e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905208005051       residual = 6.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905223759000       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905227159379       residual = 6.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905228023414       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905228264719       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905228550393       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905228623847       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905228770790       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905228945890       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905229201992       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905229372991       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.905229481283       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.905229527636       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.905229619253       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.905229747000       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.905229814991       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.905229779348       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.905229775227       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.905229770278       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.905229818979       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.905229832920       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.905229788230       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.905229795824       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.905229796681       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.905229816658       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.905229845991       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.905229841303       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.905229830375       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.905229842757       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.905229856038       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.905229853917       residual = 9.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.905229859375       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.905229854735       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.905229852596       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.905229852705       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.905229856894       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.905229856384       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.905229856032       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.905229857430       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.5000e+00 is 1.352782e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905208005051       residual = 6.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905212030070       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905212894718       residual = 6.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905213113454       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905213174735       residual = 7.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905213246966       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905213265646       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905213302157       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905213346350       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905213406269       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905213436800       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.905213469358       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.905213491253       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.905213517978       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.905213549453       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.905213566089       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.905213556536       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.905213555708       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.905213554891       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.905213567151       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.905213570328       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.905213558790       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.905213560769       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.905213561207       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.905213566291       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.905213573233       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.905213571887       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.905213569318       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.905213572590       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.905213575754       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.905213575164       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.905213576433       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.905213575254       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.905213574794       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.905213574853       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.905213575822       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.905213575694       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.905213575634       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.905213575981       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.0000e+01 is 3.387484e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.497107 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5158e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
  uu_0                 2.086178e-01 1 1  ON 0
  uu_1                 5.170763e-02 1 1  ON 1
  uu_2                -3.903999e-02 1 1  ON 2
  uu_3                -9.240864e-02 1 1  ON 3
  uu_4                -1.232219e-01 1 1  ON 4
  uu_5                -1.309090e-01 1 1  ON 5
  uu_6                -1.127551e-01 1 1  ON 6
  uu_7                -5.440518e-02 1 1  ON 7
  uu_8                 6.697020e-02 1 1  ON 8
  uu_9                 1.242832e-01 1 1  ON 9
  ud_0                 3.067824e-01 1 1  ON 10
  ud_1                 7.702866e-02 1 1  ON 11
  ud_2                -2.491314e-02 1 1  ON 12
  ud_3                -7.809154e-02 1 1  ON 13
  ud_4                -1.144343e-01 1 1  ON 14
  ud_5                -1.341054e-01 1 1  ON 15
  ud_6                -1.290040e-01 1 1  ON 16
  ud_7                -8.828720e-02 1 1  ON 17
  ud_8                -4.413565e-03 1 1  ON 18
  ud_9                 8.761947e-02 1 1  ON 19
  eO_0                -7.039518e-01 1 1  ON 20
  eO_1                -4.206825e-01 1 1  ON 21
  eO_2                -4.183799e-02 1 1  ON 22
  eO_3                 1.855371e-01 1 1  ON 23
  eO_4                 2.599134e-01 1 1  ON 24
  eO_5                 2.840748e-01 1 1  ON 25
  eO_6                 2.507151e-01 1 1  ON 26
  eO_7                 1.272400e-01 1 1  ON 27
  eO_8                 2.869657e-02 1 1  ON 28
  eO_9                 1.906289e-02 1 1  ON 29
 eH1_0                -2.022648e-01 1 1  ON 30
 eH1_1                -9.743084e-02 1 1  ON 31
 eH1_2                -4.634191e-02 1 1  ON 32
 eH1_3                -1.504248e-02 1 1  ON 33
 eH1_4                 1.853837e-02 1 1  ON 34
 eH1_5                 2.508415e-02 1 1  ON 35
 eH1_6                 7.419771e-02 1 1  ON 36
 eH1_7                 1.039570e-01 1 1  ON 37
 eH1_8                 9.801794e-02 1 1  ON 38
 eH1_9                 2.544341e-02 1 1  ON 39
 eH2_0                -2.031294e-01 1 1  ON 40
 eH2_1                -9.887609e-02 1 1  ON 41
 eH2_2                -4.809253e-02 1 1  ON 42
 eH2_3                -1.715697e-02 1 1  ON 43
 eH2_4                 1.622324e-02 1 1  ON 44
 eH2_5                 2.137245e-02 1 1  ON 45
 eH2_6                 7.609717e-02 1 1  ON 46
 eH2_7                 1.119967e-01 1 1  ON 47
 eH2_8                 1.007629e-01 1 1  ON 48
 eH2_9                 2.830913e-02 1 1  ON 49
ci_001                -4.241620e-02 3 1  ON 50
ci_002                -3.110825e-02 3 1  ON 51
ci_003                -1.188038e-02 3 1  ON 52
ci_004                 2.577729e-02 3 1  ON 53
ci_005                 2.618116e-02 3 1  ON 54
ci_006                -2.101210e-02 3 1  ON 55
ci_007                -2.031291e-02 3 1  ON 56
ci_008                -4.822511e-03 3 1  ON 57
ci_009                -1.578912e-02 3 1  ON 58
ci_010                -1.014516e-02 3 1  ON 59
ci_011                -9.963267e-03 3 1  ON 60
ci_012                -9.941303e-03 3 1  ON 61
ci_013                -2.148609e-02 3 1  ON 62
ci_014                 1.339913e-02 3 1  ON 63
ci_015                 1.342738e-02 3 1  ON 64
ci_016                 1.668280e-02 3 1  ON 65
ci_017                 1.636004e-02 3 1  ON 66
ci_018                 1.093780e-02 3 1  ON 67
ci_019                 1.082993e-02 3 1  ON 68
ci_020                 1.838905e-02 3 1  ON 69
ci_021                 1.793634e-02 3 1  ON 70
ci_022                 1.041773e-02 3 1  ON 71
ci_023                 1.059516e-02 3 1  ON 72
ci_024                 6.932736e-03 3 1  ON 73
ci_025                 6.757878e-03 3 1  ON 74
ci_026                 1.182331e-02 3 1  ON 75
ci_027                 1.179008e-02 3 1  ON 76
ci_028                -9.433347e-03 3 1  ON 77
ci_029                -1.028193e-02 3 1  ON 78
ci_030                -4.789753e-03 3 1  ON 79
ci_031                -4.922121e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1427
    reference variance = 0.413298
====================================================
  Execution time = 1.9288e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0224e-01
  Total weights = 1.9741e+06
  Execution time = 1.6155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291298052903
                                         uncertainty =       0.001832846206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291298052903
                                         uncertainty =       0.001832846206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381636502
  error estimate for blocks of size 2^( 2) =       0.000396405229
  error estimate for blocks of size 2^( 3) =       0.000410219876
  error estimate for blocks of size 2^( 4) =       0.000420865268
  error estimate for blocks of size 2^( 5) =       0.000427135027
  error estimate for blocks of size 2^( 6) =       0.000430274048
  error estimate for blocks of size 2^( 7) =       0.000433470466

      target function =      -0.908704184592
              le_mean =     -17.206675856061
             les_mean =     296.372339273010
             stat err =       0.000427936202
             autocorr =       1.257355958836
   target nu stat err =       0.000427936202
   target dn stat err =       0.003048038324
      target stat err =       0.004712931638
              std dev =       0.539715516414
             le_variance =       0.291292838658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291296429669
                                         uncertainty =       0.001835118510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291296429669
                                         uncertainty =       0.001835118510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381635380
  error estimate for blocks of size 2^( 2) =       0.000396433817
  error estimate for blocks of size 2^( 3) =       0.000410277427
  error estimate for blocks of size 2^( 4) =       0.000420948437
  error estimate for blocks of size 2^( 5) =       0.000427229395
  error estimate for blocks of size 2^( 6) =       0.000430384291
  error estimate for blocks of size 2^( 7) =       0.000433577203

      target function =      -0.909435266448
              le_mean =     -17.206674908182
             les_mean =     296.371828887548
             stat err =       0.000428034831
             autocorr =       1.257943003099
   target nu stat err =       0.000428034831
   target dn stat err =       0.003019893120
      target stat err =       0.004677876356
              std dev =       0.539713929789
             le_variance =       0.291291126009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291294384907
                                         uncertainty =       0.001833863019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291294384907
                                         uncertainty =       0.001833863019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381634068
  error estimate for blocks of size 2^( 2) =       0.000396418721
  error estimate for blocks of size 2^( 3) =       0.000410248753
  error estimate for blocks of size 2^( 4) =       0.000420907758
  error estimate for blocks of size 2^( 5) =       0.000427183463
  error estimate for blocks of size 2^( 6) =       0.000430330727
  error estimate for blocks of size 2^( 7) =       0.000433525249

      target function =      -0.909504480516
              le_mean =     -17.206675104423
             les_mean =     296.371790530832
             stat err =       0.000427986799
             autocorr =       1.257669339910
   target nu stat err =       0.000427986799
   target dn stat err =       0.003008874133
      target stat err =       0.004661902588
              std dev =       0.539712075051
             le_variance =       0.291289123955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291297195748
                                         uncertainty =       0.001832948041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291297195748
                                         uncertainty =       0.001832948041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381635936
  error estimate for blocks of size 2^( 2) =       0.000396406695
  error estimate for blocks of size 2^( 3) =       0.000410223301
  error estimate for blocks of size 2^( 4) =       0.000420870413
  error estimate for blocks of size 2^( 5) =       0.000427140943
  error estimate for blocks of size 2^( 6) =       0.000430280923
  error estimate for blocks of size 2^( 7) =       0.000433477123

      target function =      -0.908975499765
              le_mean =     -17.206675729711
             les_mean =     296.372157577450
             stat err =       0.000427942351
             autocorr =       1.257395813939
   target nu stat err =       0.000427942351
   target dn stat err =       0.003032635224
      target stat err =       0.004692438917
              std dev =       0.539714717157
             le_variance =       0.291291975916


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908704184592        initial
     6.2500e-01     6.2500e+00             5.3755e-04        -0.909435266448
     2.5000e+00     2.5000e+01             1.3528e-04        -0.909504480516  <--
     1.0000e+01     1.0000e+02             3.3875e-05        -0.908975499765

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.7432e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
  uu_0                 2.086178e-01 1 1  ON 0
  uu_1                 5.170763e-02 1 1  ON 1
  uu_2                -3.903999e-02 1 1  ON 2
  uu_3                -9.240864e-02 1 1  ON 3
  uu_4                -1.232219e-01 1 1  ON 4
  uu_5                -1.309090e-01 1 1  ON 5
  uu_6                -1.127551e-01 1 1  ON 6
  uu_7                -5.440518e-02 1 1  ON 7
  uu_8                 6.697020e-02 1 1  ON 8
  uu_9                 1.242832e-01 1 1  ON 9
  ud_0                 3.067824e-01 1 1  ON 10
  ud_1                 7.702866e-02 1 1  ON 11
  ud_2                -2.491314e-02 1 1  ON 12
  ud_3                -7.809154e-02 1 1  ON 13
  ud_4                -1.144343e-01 1 1  ON 14
  ud_5                -1.341054e-01 1 1  ON 15
  ud_6                -1.290040e-01 1 1  ON 16
  ud_7                -8.828720e-02 1 1  ON 17
  ud_8                -4.413565e-03 1 1  ON 18
  ud_9                 8.761947e-02 1 1  ON 19
  eO_0                -7.039518e-01 1 1  ON 20
  eO_1                -4.206825e-01 1 1  ON 21
  eO_2                -4.183799e-02 1 1  ON 22
  eO_3                 1.855371e-01 1 1  ON 23
  eO_4                 2.599134e-01 1 1  ON 24
  eO_5                 2.840748e-01 1 1  ON 25
  eO_6                 2.507151e-01 1 1  ON 26
  eO_7                 1.272400e-01 1 1  ON 27
  eO_8                 2.869657e-02 1 1  ON 28
  eO_9                 1.906289e-02 1 1  ON 29
 eH1_0                -2.022648e-01 1 1  ON 30
 eH1_1                -9.743084e-02 1 1  ON 31
 eH1_2                -4.634191e-02 1 1  ON 32
 eH1_3                -1.504248e-02 1 1  ON 33
 eH1_4                 1.853837e-02 1 1  ON 34
 eH1_5                 2.508415e-02 1 1  ON 35
 eH1_6                 7.419771e-02 1 1  ON 36
 eH1_7                 1.039570e-01 1 1  ON 37
 eH1_8                 9.801794e-02 1 1  ON 38
 eH1_9                 2.544341e-02 1 1  ON 39
 eH2_0                -2.031294e-01 1 1  ON 40
 eH2_1                -9.887609e-02 1 1  ON 41
 eH2_2                -4.809253e-02 1 1  ON 42
 eH2_3                -1.715697e-02 1 1  ON 43
 eH2_4                 1.622324e-02 1 1  ON 44
 eH2_5                 2.137245e-02 1 1  ON 45
 eH2_6                 7.609717e-02 1 1  ON 46
 eH2_7                 1.119967e-01 1 1  ON 47
 eH2_8                 1.007629e-01 1 1  ON 48
 eH2_9                 2.830913e-02 1 1  ON 49
ci_001                -4.241620e-02 3 1  ON 50
ci_002                -3.110825e-02 3 1  ON 51
ci_003                -1.188038e-02 3 1  ON 52
ci_004                 2.577729e-02 3 1  ON 53
ci_005                 2.618116e-02 3 1  ON 54
ci_006                -2.101210e-02 3 1  ON 55
ci_007                -2.031291e-02 3 1  ON 56
ci_008                -4.822511e-03 3 1  ON 57
ci_009                -1.578912e-02 3 1  ON 58
ci_010                -1.014516e-02 3 1  ON 59
ci_011                -9.963267e-03 3 1  ON 60
ci_012                -9.941303e-03 3 1  ON 61
ci_013                -2.148609e-02 3 1  ON 62
ci_014                 1.339913e-02 3 1  ON 63
ci_015                 1.342738e-02 3 1  ON 64
ci_016                 1.668280e-02 3 1  ON 65
ci_017                 1.636004e-02 3 1  ON 66
ci_018                 1.093780e-02 3 1  ON 67
ci_019                 1.082993e-02 3 1  ON 68
ci_020                 1.838905e-02 3 1  ON 69
ci_021                 1.793634e-02 3 1  ON 70
ci_022                 1.041773e-02 3 1  ON 71
ci_023                 1.059516e-02 3 1  ON 72
ci_024                 6.932736e-03 3 1  ON 73
ci_025                 6.757878e-03 3 1  ON 74
ci_026                 1.182331e-02 3 1  ON 75
ci_027                 1.179008e-02 3 1  ON 76
ci_028                -9.433347e-03 3 1  ON 77
ci_029                -1.028193e-02 3 1  ON 78
ci_030                -4.789753e-03 3 1  ON 79
ci_031                -4.922121e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2596e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7188e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1452
    reference variance = 0.19984
====================================================
  Execution time = 1.9361e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5438e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9932e-01
  Total weights = 1.973774397e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6380e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289966568052
                                         uncertainty =       0.001629474914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289966568052
                                         uncertainty =       0.001629474914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380730086
  error estimate for blocks of size 2^( 2) =       0.000395775032
  error estimate for blocks of size 2^( 3) =       0.000409303968
  error estimate for blocks of size 2^( 4) =       0.000418923232
  error estimate for blocks of size 2^( 5) =       0.000424637887
  error estimate for blocks of size 2^( 6) =       0.000426644503
  error estimate for blocks of size 2^( 7) =       0.000429832423

      target function =      -0.913809249876
              le_mean =     -17.206398809155
             les_mean =     296.359483717677
             stat err =       0.000425009511
             autocorr =       1.246128714820
   target nu stat err =       0.000425009511
   target dn stat err =       0.003319407772
      target stat err =       0.005176975282
              std dev =       0.538433651595
             le_variance =       0.289910797170


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720639880915e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913837558389       residual = 4.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913863027916       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913870666503       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913872576118       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913873838486       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913874295879       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913874593675       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913875742300       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913876176715       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913876413184       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913876716762       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913876731806       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913877580976       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913877976519       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913878194320       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913878347393       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913878505501       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913878325267       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913878471620       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913878629490       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913878681281       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913878794346       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913878751017       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913878799605       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913878819931       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913878768712       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913878794621       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913878831496       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913878873131       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913878860284       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913878838413       residual = 9.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913878815276       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913878806599       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913878814798       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913878813673       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913878811771       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913878818121       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913878818513       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e-01 is 7.372224e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913837558389       residual = 4.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913844476788       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913846526912       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913847038012       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913847373809       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913847486915       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913847569633       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913847880393       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913847987239       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913848049460       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913848128405       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913848131079       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913848347314       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913848451540       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913848508813       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913848549646       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913848586782       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913848535786       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913848576639       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913848614852       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913848625017       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913848648108       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913848636128       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913848650961       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913848653793       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913848640059       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913848649231       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913848655297       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913848666891       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913848661179       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913848655862       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913848651340       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913848650380       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913848652165       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913848651036       residual = 9.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.5000e+00 is 1.844095e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913837558389       residual = 4.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913839326233       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913839848344       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913839978413       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913840063827       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913840091890       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913840113171       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913840192441       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913840218996       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913840234813       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913840254671       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913840255289       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913840309576       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913840336004       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913840350494       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913840360847       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913840369949       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913840356849       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913840367328       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913840376761       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913840379122       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913840384541       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913840381515       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913840385381       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913840385916       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913840382482       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913840384929       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913840386239       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913840389179       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913840387581       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913840386288       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913840385265       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913840385095       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913840385503       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913840385181       residual = 8.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.0000e+01 is 4.620715e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.549176 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5056e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
  uu_0                 2.087058e-01 1 1  ON 0
  uu_1                 5.178548e-02 1 1  ON 1
  uu_2                -3.897199e-02 1 1  ON 2
  uu_3                -9.236578e-02 1 1  ON 3
  uu_4                -1.232104e-01 1 1  ON 4
  uu_5                -1.309385e-01 1 1  ON 5
  uu_6                -1.128067e-01 1 1  ON 6
  uu_7                -5.447630e-02 1 1  ON 7
  uu_8                 6.678579e-02 1 1  ON 8
  uu_9                 1.242746e-01 1 1  ON 9
  ud_0                 3.067121e-01 1 1  ON 10
  ud_1                 7.697209e-02 1 1  ON 11
  ud_2                -2.495410e-02 1 1  ON 12
  ud_3                -7.812679e-02 1 1  ON 13
  ud_4                -1.144362e-01 1 1  ON 14
  ud_5                -1.340718e-01 1 1  ON 15
  ud_6                -1.289549e-01 1 1  ON 16
  ud_7                -8.820640e-02 1 1  ON 17
  ud_8                -4.392203e-03 1 1  ON 18
  ud_9                 8.759601e-02 1 1  ON 19
  eO_0                -7.039347e-01 1 1  ON 20
  eO_1                -4.206700e-01 1 1  ON 21
  eO_2                -4.184678e-02 1 1  ON 22
  eO_3                 1.854788e-01 1 1  ON 23
  eO_4                 2.598291e-01 1 1  ON 24
  eO_5                 2.840152e-01 1 1  ON 25
  eO_6                 2.507770e-01 1 1  ON 26
  eO_7                 1.273425e-01 1 1  ON 27
  eO_8                 2.870666e-02 1 1  ON 28
  eO_9                 1.906759e-02 1 1  ON 29
 eH1_0                -2.022774e-01 1 1  ON 30
 eH1_1                -9.743092e-02 1 1  ON 31
 eH1_2                -4.633989e-02 1 1  ON 32
 eH1_3                -1.506658e-02 1 1  ON 33
 eH1_4                 1.853817e-02 1 1  ON 34
 eH1_5                 2.511125e-02 1 1  ON 35
 eH1_6                 7.416682e-02 1 1  ON 36
 eH1_7                 1.039433e-01 1 1  ON 37
 eH1_8                 9.806697e-02 1 1  ON 38
 eH1_9                 2.544208e-02 1 1  ON 39
 eH2_0                -2.031452e-01 1 1  ON 40
 eH2_1                -9.888068e-02 1 1  ON 41
 eH2_2                -4.811857e-02 1 1  ON 42
 eH2_3                -1.717313e-02 1 1  ON 43
 eH2_4                 1.625789e-02 1 1  ON 44
 eH2_5                 2.144930e-02 1 1  ON 45
 eH2_6                 7.601806e-02 1 1  ON 46
 eH2_7                 1.119681e-01 1 1  ON 47
 eH2_8                 1.008151e-01 1 1  ON 48
 eH2_9                 2.831232e-02 1 1  ON 49
ci_001                -4.240783e-02 3 1  ON 50
ci_002                -3.112652e-02 3 1  ON 51
ci_003                -1.186530e-02 3 1  ON 52
ci_004                 2.575119e-02 3 1  ON 53
ci_005                 2.618593e-02 3 1  ON 54
ci_006                -2.098635e-02 3 1  ON 55
ci_007                -2.026002e-02 3 1  ON 56
ci_008                -4.803708e-03 3 1  ON 57
ci_009                -1.580732e-02 3 1  ON 58
ci_010                -1.013727e-02 3 1  ON 59
ci_011                -9.944804e-03 3 1  ON 60
ci_012                -9.936817e-03 3 1  ON 61
ci_013                -2.149063e-02 3 1  ON 62
ci_014                 1.343037e-02 3 1  ON 63
ci_015                 1.345732e-02 3 1  ON 64
ci_016                 1.667584e-02 3 1  ON 65
ci_017                 1.634609e-02 3 1  ON 66
ci_018                 1.093159e-02 3 1  ON 67
ci_019                 1.084774e-02 3 1  ON 68
ci_020                 1.836182e-02 3 1  ON 69
ci_021                 1.793456e-02 3 1  ON 70
ci_022                 1.035225e-02 3 1  ON 71
ci_023                 1.057728e-02 3 1  ON 72
ci_024                 6.915126e-03 3 1  ON 73
ci_025                 6.762055e-03 3 1  ON 74
ci_026                 1.181481e-02 3 1  ON 75
ci_027                 1.177550e-02 3 1  ON 76
ci_028                -9.429321e-03 3 1  ON 77
ci_029                -1.029176e-02 3 1  ON 78
ci_030                -4.774845e-03 3 1  ON 79
ci_031                -4.899401e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1887
    reference variance = 0.230416
====================================================
  Execution time = 1.9376e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9840e-01
  Total weights = 1.9739e+06
  Execution time = 1.6129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289033638851
                                         uncertainty =       0.001695998337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289033638851
                                         uncertainty =       0.001695998337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380120710
  error estimate for blocks of size 2^( 2) =       0.000395091477
  error estimate for blocks of size 2^( 3) =       0.000408434027
  error estimate for blocks of size 2^( 4) =       0.000418224513
  error estimate for blocks of size 2^( 5) =       0.000424040273
  error estimate for blocks of size 2^( 6) =       0.000426566466
  error estimate for blocks of size 2^( 7) =       0.000427189630

      target function =      -0.915346721489
              le_mean =     -17.206487486338
             les_mean =     296.361547508004
             stat err =       0.000424005220
             autocorr =       1.244226206568
   target nu stat err =       0.000424005220
   target dn stat err =       0.002627251974
      target stat err =       0.004134940744
              std dev =       0.537571863082
             le_variance =       0.288983507977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289064613702
                                         uncertainty =       0.001696188779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289064613702
                                         uncertainty =       0.001696188779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380141109
  error estimate for blocks of size 2^( 2) =       0.000395127071
  error estimate for blocks of size 2^( 3) =       0.000408485625
  error estimate for blocks of size 2^( 4) =       0.000418289729
  error estimate for blocks of size 2^( 5) =       0.000424110403
  error estimate for blocks of size 2^( 6) =       0.000426637930
  error estimate for blocks of size 2^( 7) =       0.000427261244

      target function =      -0.914785943618
              le_mean =     -17.206490274323
             les_mean =     296.362004333989
             stat err =       0.000424074826
             autocorr =       1.244501178951
   target nu stat err =       0.000424074826
   target dn stat err =       0.002750025799
      target stat err =       0.004317299167
              std dev =       0.537600711277
             le_variance =       0.289014524766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289048729589
                                         uncertainty =       0.001696010717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289048729589
                                         uncertainty =       0.001696010717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380130651
  error estimate for blocks of size 2^( 2) =       0.000395109643
  error estimate for blocks of size 2^( 3) =       0.000408460901
  error estimate for blocks of size 2^( 4) =       0.000418258651
  error estimate for blocks of size 2^( 5) =       0.000424076748
  error estimate for blocks of size 2^( 6) =       0.000426603397
  error estimate for blocks of size 2^( 7) =       0.000427226848

      target function =      -0.914635214139
              le_mean =     -17.206488672041
             les_mean =     296.362046948812
             stat err =       0.000424041411
             autocorr =       1.244373527699
   target nu stat err =       0.000424041411
   target dn stat err =       0.002712377574
      target stat err =       0.004258430474
              std dev =       0.537585921983
             le_variance =       0.288998623514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289035368408
                                         uncertainty =       0.001695989538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289035368408
                                         uncertainty =       0.001695989538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380121850
  error estimate for blocks of size 2^( 2) =       0.000395093664
  error estimate for blocks of size 2^( 3) =       0.000408437322
  error estimate for blocks of size 2^( 4) =       0.000418228730
  error estimate for blocks of size 2^( 5) =       0.000424044815
  error estimate for blocks of size 2^( 6) =       0.000426571058
  error estimate for blocks of size 2^( 7) =       0.000427194239

      target function =      -0.915338410402
              le_mean =     -17.206487627388
             les_mean =     296.361557669988
             stat err =       0.000424009711
             autocorr =       1.244245097078
   target nu stat err =       0.000424009711
   target dn stat err =       0.002633146204
      target stat err =       0.004143866732
              std dev =       0.537573474946
             le_variance =       0.288985240966


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915346721489        initial  <--
     6.2500e-01     6.2500e+00             7.3722e-04        -0.914785943618
     2.5000e+00     2.5000e+01             1.8441e-04        -0.914635214139
     1.0000e+01     1.0000e+02             4.6207e-05        -0.915338410402

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.4914
  </log>
  <optVariables href="H2O.s006.opt.xml">
  uu_0                 2.086178e-01 1 1  ON 0
  uu_1                 5.170763e-02 1 1  ON 1
  uu_2                -3.903999e-02 1 1  ON 2
  uu_3                -9.240864e-02 1 1  ON 3
  uu_4                -1.232219e-01 1 1  ON 4
  uu_5                -1.309090e-01 1 1  ON 5
  uu_6                -1.127551e-01 1 1  ON 6
  uu_7                -5.440518e-02 1 1  ON 7
  uu_8                 6.697020e-02 1 1  ON 8
  uu_9                 1.242832e-01 1 1  ON 9
  ud_0                 3.067824e-01 1 1  ON 10
  ud_1                 7.702866e-02 1 1  ON 11
  ud_2                -2.491314e-02 1 1  ON 12
  ud_3                -7.809154e-02 1 1  ON 13
  ud_4                -1.144343e-01 1 1  ON 14
  ud_5                -1.341054e-01 1 1  ON 15
  ud_6                -1.290040e-01 1 1  ON 16
  ud_7                -8.828720e-02 1 1  ON 17
  ud_8                -4.413565e-03 1 1  ON 18
  ud_9                 8.761947e-02 1 1  ON 19
  eO_0                -7.039518e-01 1 1  ON 20
  eO_1                -4.206825e-01 1 1  ON 21
  eO_2                -4.183799e-02 1 1  ON 22
  eO_3                 1.855371e-01 1 1  ON 23
  eO_4                 2.599134e-01 1 1  ON 24
  eO_5                 2.840748e-01 1 1  ON 25
  eO_6                 2.507151e-01 1 1  ON 26
  eO_7                 1.272400e-01 1 1  ON 27
  eO_8                 2.869657e-02 1 1  ON 28
  eO_9                 1.906289e-02 1 1  ON 29
 eH1_0                -2.022648e-01 1 1  ON 30
 eH1_1                -9.743084e-02 1 1  ON 31
 eH1_2                -4.634191e-02 1 1  ON 32
 eH1_3                -1.504248e-02 1 1  ON 33
 eH1_4                 1.853837e-02 1 1  ON 34
 eH1_5                 2.508415e-02 1 1  ON 35
 eH1_6                 7.419771e-02 1 1  ON 36
 eH1_7                 1.039570e-01 1 1  ON 37
 eH1_8                 9.801794e-02 1 1  ON 38
 eH1_9                 2.544341e-02 1 1  ON 39
 eH2_0                -2.031294e-01 1 1  ON 40
 eH2_1                -9.887609e-02 1 1  ON 41
 eH2_2                -4.809253e-02 1 1  ON 42
 eH2_3                -1.715697e-02 1 1  ON 43
 eH2_4                 1.622324e-02 1 1  ON 44
 eH2_5                 2.137245e-02 1 1  ON 45
 eH2_6                 7.609717e-02 1 1  ON 46
 eH2_7                 1.119967e-01 1 1  ON 47
 eH2_8                 1.007629e-01 1 1  ON 48
 eH2_9                 2.830913e-02 1 1  ON 49
ci_001                -4.241620e-02 3 1  ON 50
ci_002                -3.110825e-02 3 1  ON 51
ci_003                -1.188038e-02 3 1  ON 52
ci_004                 2.577729e-02 3 1  ON 53
ci_005                 2.618116e-02 3 1  ON 54
ci_006                -2.101210e-02 3 1  ON 55
ci_007                -2.031291e-02 3 1  ON 56
ci_008                -4.822511e-03 3 1  ON 57
ci_009                -1.578912e-02 3 1  ON 58
ci_010                -1.014516e-02 3 1  ON 59
ci_011                -9.963267e-03 3 1  ON 60
ci_012                -9.941303e-03 3 1  ON 61
ci_013                -2.148609e-02 3 1  ON 62
ci_014                 1.339913e-02 3 1  ON 63
ci_015                 1.342738e-02 3 1  ON 64
ci_016                 1.668280e-02 3 1  ON 65
ci_017                 1.636004e-02 3 1  ON 66
ci_018                 1.093780e-02 3 1  ON 67
ci_019                 1.082993e-02 3 1  ON 68
ci_020                 1.838905e-02 3 1  ON 69
ci_021                 1.793634e-02 3 1  ON 70
ci_022                 1.041773e-02 3 1  ON 71
ci_023                 1.059516e-02 3 1  ON 72
ci_024                 6.932736e-03 3 1  ON 73
ci_025                 6.757878e-03 3 1  ON 74
ci_026                 1.182331e-02 3 1  ON 75
ci_027                 1.179008e-02 3 1  ON 76
ci_028                -9.433347e-03 3 1  ON 77
ci_029                -1.028193e-02 3 1  ON 78
ci_030                -4.789753e-03 3 1  ON 79
ci_031                -4.922121e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2555e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7185e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1913
    reference variance = 0.203976
====================================================
  Execution time = 1.9616e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5401e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9746e-01
  Total weights = 1.973645170e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6110e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290592516502
                                         uncertainty =       0.002323349107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290592516502
                                         uncertainty =       0.002323349107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381163403
  error estimate for blocks of size 2^( 2) =       0.000395751264
  error estimate for blocks of size 2^( 3) =       0.000409509615
  error estimate for blocks of size 2^( 4) =       0.000419075627
  error estimate for blocks of size 2^( 5) =       0.000425380009
  error estimate for blocks of size 2^( 6) =       0.000429812427
  error estimate for blocks of size 2^( 7) =       0.000434036545

      target function =      -0.916717181047
              le_mean =     -17.205762385293
             les_mean =     296.335717293686
             stat err =       0.000427076152
             autocorr =       1.255417710073
   target nu stat err =       0.000427076152
   target dn stat err =       0.002798126489
      target stat err =       0.004403960337
              std dev =       0.539046453976
             le_variance =       0.290571079544


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720576238529e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916737142892       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916739154906       residual = 8.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916740059281       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916740133524       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916740160607       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916740247009       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916740268971       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916740345574       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916740356236       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916740374948       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916740386319       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916740426147       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916740437311       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916740457145       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916740463225       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916740444340       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916740459851       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916740457218       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916740465977       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916740483397       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916740490297       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916740504263       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916740501787       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916740504965       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916740505582       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916740507586       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916740503607       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916740507452       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916740506796       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916740505007       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916740506059       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916740506578       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916740507567       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916740506934       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916740507512       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916740507398       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e+00 is 5.340678e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916737142892       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916737650713       residual = 8.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916737878422       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916737897012       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916737903878       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916737925515       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916737931311       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916737950770       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916737952994       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916737957751       residual = 8.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916737960647       residual = 9.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916737970692       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916737973429       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916737978386       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916737979858       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916737975113       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916737979017       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916737978354       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916737980562       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916737984915       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916737986645       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916737990108       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916737989479       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916737990280       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916737990417       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916737990901       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916737989924       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916737990888       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916737990712       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916737990266       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916737990529       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916737990660       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916737990900       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916737990743       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916737990886       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916737990855       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.5000e+01 is 1.336601e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916737142892       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916737270152       residual = 8.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916737327181       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916737331830       residual = 8.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916737333553       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916737338964       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916737340433       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916737345318       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916737345845       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916737347040       residual = 8.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916737347767       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916737350283       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916737350964       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916737352203       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916737352569       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916737351380       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916737352358       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916737352192       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916737352746       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916737353833       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916737354266       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916737355130       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916737354972       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916737355173       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916737355206       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916737355326       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916737355083       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916737355324       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916737355280       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916737355168       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916737355234       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916737355266       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916737355326       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916737355287       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916737355323       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916737355315       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.0000e+02 is 3.342399e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.600361 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5284e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
  uu_0                 2.086220e-01 1 1  ON 0
  uu_1                 5.171107e-02 1 1  ON 1
  uu_2                -3.903741e-02 1 1  ON 2
  uu_3                -9.240806e-02 1 1  ON 3
  uu_4                -1.232214e-01 1 1  ON 4
  uu_5                -1.309096e-01 1 1  ON 5
  uu_6                -1.127544e-01 1 1  ON 6
  uu_7                -5.440757e-02 1 1  ON 7
  uu_8                 6.695683e-02 1 1  ON 8
  uu_9                 1.242823e-01 1 1  ON 9
  ud_0                 3.067787e-01 1 1  ON 10
  ud_1                 7.702476e-02 1 1  ON 11
  ud_2                -2.491681e-02 1 1  ON 12
  ud_3                -7.809326e-02 1 1  ON 13
  ud_4                -1.144353e-01 1 1  ON 14
  ud_5                -1.341026e-01 1 1  ON 15
  ud_6                -1.289989e-01 1 1  ON 16
  ud_7                -8.828078e-02 1 1  ON 17
  ud_8                -4.417361e-03 1 1  ON 18
  ud_9                 8.761795e-02 1 1  ON 19
  eO_0                -7.039546e-01 1 1  ON 20
  eO_1                -4.206844e-01 1 1  ON 21
  eO_2                -4.183615e-02 1 1  ON 22
  eO_3                 1.855420e-01 1 1  ON 23
  eO_4                 2.599086e-01 1 1  ON 24
  eO_5                 2.840655e-01 1 1  ON 25
  eO_6                 2.507164e-01 1 1  ON 26
  eO_7                 1.272499e-01 1 1  ON 27
  eO_8                 2.869683e-02 1 1  ON 28
  eO_9                 1.906331e-02 1 1  ON 29
 eH1_0                -2.022651e-01 1 1  ON 30
 eH1_1                -9.743101e-02 1 1  ON 31
 eH1_2                -4.633942e-02 1 1  ON 32
 eH1_3                -1.503946e-02 1 1  ON 33
 eH1_4                 1.853974e-02 1 1  ON 34
 eH1_5                 2.507867e-02 1 1  ON 35
 eH1_6                 7.419415e-02 1 1  ON 36
 eH1_7                 1.039551e-01 1 1  ON 37
 eH1_8                 9.802100e-02 1 1  ON 38
 eH1_9                 2.544472e-02 1 1  ON 39
 eH2_0                -2.031309e-01 1 1  ON 40
 eH2_1                -9.887623e-02 1 1  ON 41
 eH2_2                -4.808987e-02 1 1  ON 42
 eH2_3                -1.715607e-02 1 1  ON 43
 eH2_4                 1.621581e-02 1 1  ON 44
 eH2_5                 2.136690e-02 1 1  ON 45
 eH2_6                 7.610150e-02 1 1  ON 46
 eH2_7                 1.119952e-01 1 1  ON 47
 eH2_8                 1.007702e-01 1 1  ON 48
 eH2_9                 2.831004e-02 1 1  ON 49
ci_001                -4.241450e-02 3 1  ON 50
ci_002                -3.110631e-02 3 1  ON 51
ci_003                -1.188033e-02 3 1  ON 52
ci_004                 2.577898e-02 3 1  ON 53
ci_005                 2.617656e-02 3 1  ON 54
ci_006                -2.101190e-02 3 1  ON 55
ci_007                -2.031303e-02 3 1  ON 56
ci_008                -4.821865e-03 3 1  ON 57
ci_009                -1.578835e-02 3 1  ON 58
ci_010                -1.014353e-02 3 1  ON 59
ci_011                -9.966776e-03 3 1  ON 60
ci_012                -9.940489e-03 3 1  ON 61
ci_013                -2.148459e-02 3 1  ON 62
ci_014                 1.340080e-02 3 1  ON 63
ci_015                 1.342830e-02 3 1  ON 64
ci_016                 1.668471e-02 3 1  ON 65
ci_017                 1.635878e-02 3 1  ON 66
ci_018                 1.093664e-02 3 1  ON 67
ci_019                 1.082962e-02 3 1  ON 68
ci_020                 1.838903e-02 3 1  ON 69
ci_021                 1.793714e-02 3 1  ON 70
ci_022                 1.041898e-02 3 1  ON 71
ci_023                 1.059302e-02 3 1  ON 72
ci_024                 6.931937e-03 3 1  ON 73
ci_025                 6.758252e-03 3 1  ON 74
ci_026                 1.182321e-02 3 1  ON 75
ci_027                 1.179173e-02 3 1  ON 76
ci_028                -9.430049e-03 3 1  ON 77
ci_029                -1.027694e-02 3 1  ON 78
ci_030                -4.790502e-03 3 1  ON 79
ci_031                -4.920684e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1486
    reference variance = 0.515287
====================================================
  Execution time = 1.9096e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9900e-01
  Total weights = 1.9739e+06
  Execution time = 1.6108e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290487497332
                                         uncertainty =       0.001826986495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290487497332
                                         uncertainty =       0.001826986495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381148270
  error estimate for blocks of size 2^( 2) =       0.000396425366
  error estimate for blocks of size 2^( 3) =       0.000409902765
  error estimate for blocks of size 2^( 4) =       0.000420527821
  error estimate for blocks of size 2^( 5) =       0.000427049426
  error estimate for blocks of size 2^( 6) =       0.000431430305
  error estimate for blocks of size 2^( 7) =       0.000431198244

      target function =      -0.914320907916
              le_mean =     -17.206458139507
             les_mean =     296.361199922748
             stat err =       0.000427551449
             autocorr =       1.258313508089
   target nu stat err =       0.000427551449
   target dn stat err =       0.002697761499
      target stat err =       0.004234036929
              std dev =       0.539025053070
             le_variance =       0.290548007837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290490791654
                                         uncertainty =       0.001827401514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290490791654
                                         uncertainty =       0.001827401514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381150438
  error estimate for blocks of size 2^( 2) =       0.000396428635
  error estimate for blocks of size 2^( 3) =       0.000409907277
  error estimate for blocks of size 2^( 4) =       0.000420533460
  error estimate for blocks of size 2^( 5) =       0.000427055920
  error estimate for blocks of size 2^( 6) =       0.000431437660
  error estimate for blocks of size 2^( 7) =       0.000431205415

      target function =      -0.914304829469
              le_mean =     -17.206458134345
             les_mean =     296.361210098386
             stat err =       0.000427558114
             autocorr =       1.258338425350
   target nu stat err =       0.000427558114
   target dn stat err =       0.002702703783
      target stat err =       0.004241422799
              std dev =       0.539028118729
             le_variance =       0.290551312780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290489151210
                                         uncertainty =       0.001827195418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290489151210
                                         uncertainty =       0.001827195418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381149359
  error estimate for blocks of size 2^( 2) =       0.000396427009
  error estimate for blocks of size 2^( 3) =       0.000409905034
  error estimate for blocks of size 2^( 4) =       0.000420530658
  error estimate for blocks of size 2^( 5) =       0.000427052692
  error estimate for blocks of size 2^( 6) =       0.000431434006
  error estimate for blocks of size 2^( 7) =       0.000431201856

      target function =      -0.914314889157
              le_mean =     -17.206458136142
             les_mean =     296.361203676951
             stat err =       0.000427554803
             autocorr =       1.258326064290
   target nu stat err =       0.000427554803
   target dn stat err =       0.002700225086
      target stat err =       0.004237736826
              std dev =       0.539026592171
             le_variance =       0.290549667067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290487703571
                                         uncertainty =       0.001827012626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290487703571
                                         uncertainty =       0.001827012626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381148406
  error estimate for blocks of size 2^( 2) =       0.000396425571
  error estimate for blocks of size 2^( 3) =       0.000409903049
  error estimate for blocks of size 2^( 4) =       0.000420528176
  error estimate for blocks of size 2^( 5) =       0.000427049834
  error estimate for blocks of size 2^( 6) =       0.000431430768
  error estimate for blocks of size 2^( 7) =       0.000431198696

      target function =      -0.914320234900
              le_mean =     -17.206458138964
             les_mean =     296.361200336525
             stat err =       0.000427551868
             autocorr =       1.258315080975
   target nu stat err =       0.000427551868
   target dn stat err =       0.002698067570
      target stat err =       0.004234497278
              std dev =       0.539025245000
             le_variance =       0.290548214747


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914320907916        initial  <--
     6.2500e+00     6.2500e+01             5.3407e-05        -0.914304829469
     2.5000e+01     2.5000e+02             1.3366e-05        -0.914314889157
     1.0000e+02     1.0000e+03             3.3424e-06        -0.914320234900

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.1954
  </log>
  <optVariables href="H2O.s007.opt.xml">
  uu_0                 2.086178e-01 1 1  ON 0
  uu_1                 5.170763e-02 1 1  ON 1
  uu_2                -3.903999e-02 1 1  ON 2
  uu_3                -9.240864e-02 1 1  ON 3
  uu_4                -1.232219e-01 1 1  ON 4
  uu_5                -1.309090e-01 1 1  ON 5
  uu_6                -1.127551e-01 1 1  ON 6
  uu_7                -5.440518e-02 1 1  ON 7
  uu_8                 6.697020e-02 1 1  ON 8
  uu_9                 1.242832e-01 1 1  ON 9
  ud_0                 3.067824e-01 1 1  ON 10
  ud_1                 7.702866e-02 1 1  ON 11
  ud_2                -2.491314e-02 1 1  ON 12
  ud_3                -7.809154e-02 1 1  ON 13
  ud_4                -1.144343e-01 1 1  ON 14
  ud_5                -1.341054e-01 1 1  ON 15
  ud_6                -1.290040e-01 1 1  ON 16
  ud_7                -8.828720e-02 1 1  ON 17
  ud_8                -4.413565e-03 1 1  ON 18
  ud_9                 8.761947e-02 1 1  ON 19
  eO_0                -7.039518e-01 1 1  ON 20
  eO_1                -4.206825e-01 1 1  ON 21
  eO_2                -4.183799e-02 1 1  ON 22
  eO_3                 1.855371e-01 1 1  ON 23
  eO_4                 2.599134e-01 1 1  ON 24
  eO_5                 2.840748e-01 1 1  ON 25
  eO_6                 2.507151e-01 1 1  ON 26
  eO_7                 1.272400e-01 1 1  ON 27
  eO_8                 2.869657e-02 1 1  ON 28
  eO_9                 1.906289e-02 1 1  ON 29
 eH1_0                -2.022648e-01 1 1  ON 30
 eH1_1                -9.743084e-02 1 1  ON 31
 eH1_2                -4.634191e-02 1 1  ON 32
 eH1_3                -1.504248e-02 1 1  ON 33
 eH1_4                 1.853837e-02 1 1  ON 34
 eH1_5                 2.508415e-02 1 1  ON 35
 eH1_6                 7.419771e-02 1 1  ON 36
 eH1_7                 1.039570e-01 1 1  ON 37
 eH1_8                 9.801794e-02 1 1  ON 38
 eH1_9                 2.544341e-02 1 1  ON 39
 eH2_0                -2.031294e-01 1 1  ON 40
 eH2_1                -9.887609e-02 1 1  ON 41
 eH2_2                -4.809253e-02 1 1  ON 42
 eH2_3                -1.715697e-02 1 1  ON 43
 eH2_4                 1.622324e-02 1 1  ON 44
 eH2_5                 2.137245e-02 1 1  ON 45
 eH2_6                 7.609717e-02 1 1  ON 46
 eH2_7                 1.119967e-01 1 1  ON 47
 eH2_8                 1.007629e-01 1 1  ON 48
 eH2_9                 2.830913e-02 1 1  ON 49
ci_001                -4.241620e-02 3 1  ON 50
ci_002                -3.110825e-02 3 1  ON 51
ci_003                -1.188038e-02 3 1  ON 52
ci_004                 2.577729e-02 3 1  ON 53
ci_005                 2.618116e-02 3 1  ON 54
ci_006                -2.101210e-02 3 1  ON 55
ci_007                -2.031291e-02 3 1  ON 56
ci_008                -4.822511e-03 3 1  ON 57
ci_009                -1.578912e-02 3 1  ON 58
ci_010                -1.014516e-02 3 1  ON 59
ci_011                -9.963267e-03 3 1  ON 60
ci_012                -9.941303e-03 3 1  ON 61
ci_013                -2.148609e-02 3 1  ON 62
ci_014                 1.339913e-02 3 1  ON 63
ci_015                 1.342738e-02 3 1  ON 64
ci_016                 1.668280e-02 3 1  ON 65
ci_017                 1.636004e-02 3 1  ON 66
ci_018                 1.093780e-02 3 1  ON 67
ci_019                 1.082993e-02 3 1  ON 68
ci_020                 1.838905e-02 3 1  ON 69
ci_021                 1.793634e-02 3 1  ON 70
ci_022                 1.041773e-02 3 1  ON 71
ci_023                 1.059516e-02 3 1  ON 72
ci_024                 6.932736e-03 3 1  ON 73
ci_025                 6.757878e-03 3 1  ON 74
ci_026                 1.182331e-02 3 1  ON 75
ci_027                 1.179008e-02 3 1  ON 76
ci_028                -9.433347e-03 3 1  ON 77
ci_029                -1.028193e-02 3 1  ON 78
ci_030                -4.789753e-03 3 1  ON 79
ci_031                -4.922121e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2486e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7183e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2132
    reference variance = 0.262134
====================================================
  Execution time = 1.9428e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5401e+04
  VMC Eavg = -1.7208e+01
  VMC Evar = 2.9914e-01
  Total weights = 1.973553594e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5439e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292354683568
                                         uncertainty =       0.001883016204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292354683568
                                         uncertainty =       0.001883016204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382324537
  error estimate for blocks of size 2^( 2) =       0.000397427110
  error estimate for blocks of size 2^( 3) =       0.000411364776
  error estimate for blocks of size 2^( 4) =       0.000421071666
  error estimate for blocks of size 2^( 5) =       0.000425526029
  error estimate for blocks of size 2^( 6) =       0.000428836959
  error estimate for blocks of size 2^( 7) =       0.000431595238

      target function =      -0.914077085964
              le_mean =     -17.207515730142
             les_mean =     296.397741479918
             stat err =       0.000426757473
             autocorr =       1.245942291884
   target nu stat err =       0.000426757473
   target dn stat err =       0.002379063166
      target stat err =       0.003754493938
              std dev =       0.540688545444
             le_variance =       0.292344103174


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720751573014e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914091695026       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914092645920       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914092754430       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914092783485       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914092790205       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914092790334       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914092793587       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914092794321       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914092797668       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914092795616       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914092801845       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914092801474       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914092803264       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914092807299       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914092809647       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914092810724       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914092813146       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914092813267       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914092813130       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914092812698       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914092813186       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914092812833       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914092813391       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914092814091       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914092813763       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914092813829       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914092813192       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914092813837       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914092814084       residual = 9.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914092814310       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914092814081       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914092815052       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914092814710       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914092814707       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914092814471       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914092814451       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e+01 is 5.669094e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914091695026       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914091932975       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914091960121       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914091967389       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914091969070       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914091969102       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914091969916       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914091970099       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914091970936       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914091970423       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914091971981       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914091971888       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914091972336       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914091973346       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914091973932       residual = 8.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914091974201       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914091974807       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914091974837       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914091974802       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914091974695       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914091974816       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914091974729       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914091974867       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914091975043       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914091974961       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914091974977       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914091974817       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914091974979       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914091975040       residual = 9.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914091975097       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914091975040       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914091975282       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914091975197       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914091975195       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914091975137       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914091975132       residual = 4.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.5000e+02 is 1.417421e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914091695026       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914091754527       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914091761315       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914091763132       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914091763553       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914091763561       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914091763764       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914091763810       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914091764019       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914091763891       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914091764280       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914091764257       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914091764371       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914091764618       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914091764768       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914091764835       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914091764987       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914091764994       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914091764984       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914091764958       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914091764989       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914091764966       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914091765004       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914091765042       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914091765022       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914091765030       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914091764989       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914091765031       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914091765040       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914091765061       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914091765048       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914091765103       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914091765092       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914091765084       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914091765069       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914091765069       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.0000e+03 is 3.543644e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.651958 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5029e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
  uu_0                 2.086180e-01 1 1  ON 0
  uu_1                 5.170786e-02 1 1  ON 1
  uu_2                -3.903989e-02 1 1  ON 2
  uu_3                -9.240862e-02 1 1  ON 3
  uu_4                -1.232219e-01 1 1  ON 4
  uu_5                -1.309087e-01 1 1  ON 5
  uu_6                -1.127546e-01 1 1  ON 6
  uu_7                -5.440558e-02 1 1  ON 7
  uu_8                 6.696878e-02 1 1  ON 8
  uu_9                 1.242832e-01 1 1  ON 9
  ud_0                 3.067816e-01 1 1  ON 10
  ud_1                 7.702817e-02 1 1  ON 11
  ud_2                -2.491356e-02 1 1  ON 12
  ud_3                -7.809178e-02 1 1  ON 13
  ud_4                -1.144345e-01 1 1  ON 14
  ud_5                -1.341052e-01 1 1  ON 15
  ud_6                -1.290037e-01 1 1  ON 16
  ud_7                -8.828599e-02 1 1  ON 17
  ud_8                -4.413489e-03 1 1  ON 18
  ud_9                 8.761937e-02 1 1  ON 19
  eO_0                -7.039524e-01 1 1  ON 20
  eO_1                -4.206828e-01 1 1  ON 21
  eO_2                -4.183838e-02 1 1  ON 22
  eO_3                 1.855369e-01 1 1  ON 23
  eO_4                 2.599139e-01 1 1  ON 24
  eO_5                 2.840748e-01 1 1  ON 25
  eO_6                 2.507151e-01 1 1  ON 26
  eO_7                 1.272409e-01 1 1  ON 27
  eO_8                 2.869661e-02 1 1  ON 28
  eO_9                 1.906291e-02 1 1  ON 29
 eH1_0                -2.022644e-01 1 1  ON 30
 eH1_1                -9.743049e-02 1 1  ON 31
 eH1_2                -4.634131e-02 1 1  ON 32
 eH1_3                -1.504215e-02 1 1  ON 33
 eH1_4                 1.853815e-02 1 1  ON 34
 eH1_5                 2.508321e-02 1 1  ON 35
 eH1_6                 7.419718e-02 1 1  ON 36
 eH1_7                 1.039567e-01 1 1  ON 37
 eH1_8                 9.801814e-02 1 1  ON 38
 eH1_9                 2.544350e-02 1 1  ON 39
 eH2_0                -2.031294e-01 1 1  ON 40
 eH2_1                -9.887615e-02 1 1  ON 41
 eH2_2                -4.809233e-02 1 1  ON 42
 eH2_3                -1.715708e-02 1 1  ON 43
 eH2_4                 1.622290e-02 1 1  ON 44
 eH2_5                 2.137182e-02 1 1  ON 45
 eH2_6                 7.609737e-02 1 1  ON 46
 eH2_7                 1.119971e-01 1 1  ON 47
 eH2_8                 1.007632e-01 1 1  ON 48
 eH2_9                 2.830917e-02 1 1  ON 49
ci_001                -4.241653e-02 3 1  ON 50
ci_002                -3.110810e-02 3 1  ON 51
ci_003                -1.187984e-02 3 1  ON 52
ci_004                 2.577773e-02 3 1  ON 53
ci_005                 2.618117e-02 3 1  ON 54
ci_006                -2.101181e-02 3 1  ON 55
ci_007                -2.031277e-02 3 1  ON 56
ci_008                -4.822640e-03 3 1  ON 57
ci_009                -1.578900e-02 3 1  ON 58
ci_010                -1.014515e-02 3 1  ON 59
ci_011                -9.962841e-03 3 1  ON 60
ci_012                -9.940829e-03 3 1  ON 61
ci_013                -2.148598e-02 3 1  ON 62
ci_014                 1.339900e-02 3 1  ON 63
ci_015                 1.342680e-02 3 1  ON 64
ci_016                 1.668249e-02 3 1  ON 65
ci_017                 1.635994e-02 3 1  ON 66
ci_018                 1.093762e-02 3 1  ON 67
ci_019                 1.082987e-02 3 1  ON 68
ci_020                 1.838917e-02 3 1  ON 69
ci_021                 1.793650e-02 3 1  ON 70
ci_022                 1.041764e-02 3 1  ON 71
ci_023                 1.059497e-02 3 1  ON 72
ci_024                 6.933285e-03 3 1  ON 73
ci_025                 6.757872e-03 3 1  ON 74
ci_026                 1.182282e-02 3 1  ON 75
ci_027                 1.179006e-02 3 1  ON 76
ci_028                -9.433605e-03 3 1  ON 77
ci_029                -1.028158e-02 3 1  ON 78
ci_030                -4.788822e-03 3 1  ON 79
ci_031                -4.921993e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1728
    reference variance = 0.550709
====================================================
  Execution time = 1.9455e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9485e-01
  Total weights = 1.9739e+06
  Execution time = 1.6140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288495714157
                                         uncertainty =       0.001792177133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288495714157
                                         uncertainty =       0.001792177133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379803607
  error estimate for blocks of size 2^( 2) =       0.000394826017
  error estimate for blocks of size 2^( 3) =       0.000408470632
  error estimate for blocks of size 2^( 4) =       0.000418099784
  error estimate for blocks of size 2^( 5) =       0.000423720974
  error estimate for blocks of size 2^( 6) =       0.000425902828
  error estimate for blocks of size 2^( 7) =       0.000428206317

      target function =      -0.920794663230
              le_mean =     -17.206511293280
             les_mean =     296.358877779253
             stat err =       0.000423982476
             autocorr =       1.246171010457
   target nu stat err =       0.000423982476
   target dn stat err =       0.001941294885
      target stat err =       0.003129437446
              std dev =       0.537123411564
             le_variance =       0.288501559250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288495336804
                                         uncertainty =       0.001792120031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288495336804
                                         uncertainty =       0.001792120031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379803359
  error estimate for blocks of size 2^( 2) =       0.000394826104
  error estimate for blocks of size 2^( 3) =       0.000408471045
  error estimate for blocks of size 2^( 4) =       0.000418100394
  error estimate for blocks of size 2^( 5) =       0.000423721612
  error estimate for blocks of size 2^( 6) =       0.000425903508
  error estimate for blocks of size 2^( 7) =       0.000428206995

      target function =      -0.920795460321
              le_mean =     -17.206511285669
             les_mean =     296.358877009711
             stat err =       0.000423983127
             autocorr =       1.246176465387
   target nu stat err =       0.000423983127
   target dn stat err =       0.001941213514
      target stat err =       0.003129318742
              std dev =       0.537123061510
             le_variance =       0.288501183206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288495525048
                                         uncertainty =       0.001792148549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288495525048
                                         uncertainty =       0.001792148549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379803483
  error estimate for blocks of size 2^( 2) =       0.000394826060
  error estimate for blocks of size 2^( 3) =       0.000408470838
  error estimate for blocks of size 2^( 4) =       0.000418100089
  error estimate for blocks of size 2^( 5) =       0.000423721293
  error estimate for blocks of size 2^( 6) =       0.000425903168
  error estimate for blocks of size 2^( 7) =       0.000428206656

      target function =      -0.920795065351
              le_mean =     -17.206511289444
             les_mean =     296.358877391146
             stat err =       0.000423982802
             autocorr =       1.246173740192
   target nu stat err =       0.000423982802
   target dn stat err =       0.001941254054
      target stat err =       0.003129377896
              std dev =       0.537123236134
             le_variance =       0.288501370795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288495690484
                                         uncertainty =       0.001792173559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288495690484
                                         uncertainty =       0.001792173559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379803591
  error estimate for blocks of size 2^( 2) =       0.000394826022
  error estimate for blocks of size 2^( 3) =       0.000408470658
  error estimate for blocks of size 2^( 4) =       0.000418099822
  error estimate for blocks of size 2^( 5) =       0.000423721014
  error estimate for blocks of size 2^( 6) =       0.000425902871
  error estimate for blocks of size 2^( 7) =       0.000428206359

      target function =      -0.920794713862
              le_mean =     -17.206511292797
             les_mean =     296.358877730395
             stat err =       0.000423982517
             autocorr =       1.246171351752
   target nu stat err =       0.000423982517
   target dn stat err =       0.001941289768
      target stat err =       0.003129429985
              std dev =       0.537123389604
             le_variance =       0.288501535659


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920794663230        initial
     6.2500e+01     6.2500e+02             5.6691e-06        -0.920795460321  <--
     2.5000e+02     2.5000e+03             1.4174e-06        -0.920795065351
     1.0000e+03     1.0000e+04             3.5436e-07        -0.920794713862

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 2.7572e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
  uu_0                 2.086184e-01 1 1  ON 0
  uu_1                 5.170855e-02 1 1  ON 1
  uu_2                -3.903961e-02 1 1  ON 2
  uu_3                -9.240856e-02 1 1  ON 3
  uu_4                -1.232218e-01 1 1  ON 4
  uu_5                -1.309077e-01 1 1  ON 5
  uu_6                -1.127533e-01 1 1  ON 6
  uu_7                -5.440677e-02 1 1  ON 7
  uu_8                 6.696453e-02 1 1  ON 8
  uu_9                 1.242833e-01 1 1  ON 9
  ud_0                 3.067793e-01 1 1  ON 10
  ud_1                 7.702671e-02 1 1  ON 11
  ud_2                -2.491484e-02 1 1  ON 12
  ud_3                -7.809253e-02 1 1  ON 13
  ud_4                -1.144351e-01 1 1  ON 14
  ud_5                -1.341045e-01 1 1  ON 15
  ud_6                -1.290026e-01 1 1  ON 16
  ud_7                -8.828235e-02 1 1  ON 17
  ud_8                -4.413258e-03 1 1  ON 18
  ud_9                 8.761908e-02 1 1  ON 19
  eO_0                -7.039540e-01 1 1  ON 20
  eO_1                -4.206837e-01 1 1  ON 21
  eO_2                -4.183955e-02 1 1  ON 22
  eO_3                 1.855363e-01 1 1  ON 23
  eO_4                 2.599153e-01 1 1  ON 24
  eO_5                 2.840749e-01 1 1  ON 25
  eO_6                 2.507151e-01 1 1  ON 26
  eO_7                 1.272436e-01 1 1  ON 27
  eO_8                 2.869673e-02 1 1  ON 28
  eO_9                 1.906299e-02 1 1  ON 29
 eH1_0                -2.022631e-01 1 1  ON 30
 eH1_1                -9.742944e-02 1 1  ON 31
 eH1_2                -4.633952e-02 1 1  ON 32
 eH1_3                -1.504116e-02 1 1  ON 33
 eH1_4                 1.853749e-02 1 1  ON 34
 eH1_5                 2.508038e-02 1 1  ON 35
 eH1_6                 7.419558e-02 1 1  ON 36
 eH1_7                 1.039557e-01 1 1  ON 37
 eH1_8                 9.801877e-02 1 1  ON 38
 eH1_9                 2.544376e-02 1 1  ON 39
 eH2_0                -2.031295e-01 1 1  ON 40
 eH2_1                -9.887633e-02 1 1  ON 41
 eH2_2                -4.809172e-02 1 1  ON 42
 eH2_3                -1.715741e-02 1 1  ON 43
 eH2_4                 1.622188e-02 1 1  ON 44
 eH2_5                 2.136992e-02 1 1  ON 45
 eH2_6                 7.609796e-02 1 1  ON 46
 eH2_7                 1.119983e-01 1 1  ON 47
 eH2_8                 1.007641e-01 1 1  ON 48
 eH2_9                 2.830930e-02 1 1  ON 49
ci_001                -4.241752e-02 3 1  ON 50
ci_002                -3.110765e-02 3 1  ON 51
ci_003                -1.187823e-02 3 1  ON 52
ci_004                 2.577905e-02 3 1  ON 53
ci_005                 2.618119e-02 3 1  ON 54
ci_006                -2.101094e-02 3 1  ON 55
ci_007                -2.031234e-02 3 1  ON 56
ci_008                -4.823027e-03 3 1  ON 57
ci_009                -1.578862e-02 3 1  ON 58
ci_010                -1.014514e-02 3 1  ON 59
ci_011                -9.961565e-03 3 1  ON 60
ci_012                -9.939408e-03 3 1  ON 61
ci_013                -2.148564e-02 3 1  ON 62
ci_014                 1.339862e-02 3 1  ON 63
ci_015                 1.342509e-02 3 1  ON 64
ci_016                 1.668157e-02 3 1  ON 65
ci_017                 1.635963e-02 3 1  ON 66
ci_018                 1.093707e-02 3 1  ON 67
ci_019                 1.082971e-02 3 1  ON 68
ci_020                 1.838952e-02 3 1  ON 69
ci_021                 1.793696e-02 3 1  ON 70
ci_022                 1.041737e-02 3 1  ON 71
ci_023                 1.059443e-02 3 1  ON 72
ci_024                 6.934931e-03 3 1  ON 73
ci_025                 6.757855e-03 3 1  ON 74
ci_026                 1.182138e-02 3 1  ON 75
ci_027                 1.178998e-02 3 1  ON 76
ci_028                -9.434377e-03 3 1  ON 77
ci_029                -1.028052e-02 3 1  ON 78
ci_030                -4.786034e-03 3 1  ON 79
ci_031                -4.921608e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2608e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7184e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1818
    reference variance = 0.198272
====================================================
  Execution time = 1.9659e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5403e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9971e-01
  Total weights = 1.973831041e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6029e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289826131565
                                         uncertainty =       0.002158738507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289826131565
                                         uncertainty =       0.002158738507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380733592
  error estimate for blocks of size 2^( 2) =       0.000395975006
  error estimate for blocks of size 2^( 3) =       0.000409928746
  error estimate for blocks of size 2^( 4) =       0.000420001630
  error estimate for blocks of size 2^( 5) =       0.000425650951
  error estimate for blocks of size 2^( 6) =       0.000429999715
  error estimate for blocks of size 2^( 7) =       0.000433848539

      target function =      -0.913220996430
              le_mean =     -17.206495952375
             les_mean =     296.363209359206
             stat err =       0.000427375209
             autocorr =       1.260016579770
   target nu stat err =       0.000427375209
   target dn stat err =       0.003042898280
      target stat err =       0.004749788020
              std dev =       0.538438609250
             le_variance =       0.289916135931


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720649595238e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913244830243       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913246060718       residual = 9.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913246361108       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913246464142       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913246496300       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913246500419       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913246513510       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913246530450       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913246532125       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913246543520       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913246544391       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913246548856       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913246547446       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913246562475       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913246569192       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913246571433       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913246566944       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913246576624       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913246583495       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913246588878       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913246589328       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913246587504       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913246585867       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913246585467       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913246587987       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913246586445       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913246586411       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913246586270       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913246588416       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913246589599       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913246589051       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913246589268       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913246589276       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913246589220       residual = 8.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+01 is 2.034699e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913244830243       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913245138999       residual = 9.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913245214295       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913245240094       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913245248178       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913245249184       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913245252625       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913245256665       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913245257234       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913245260174       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913245260195       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913245261351       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913245260991       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913245264759       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913245266430       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913245266981       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913245265863       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913245268294       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913245270010       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913245271348       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913245271457       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913245271000       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913245270593       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913245270499       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913245271122       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913245270734       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913245270726       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913245270694       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913245271229       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913245271521       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913245271385       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913245271440       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913245271441       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913245271427       residual = 7.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e+01 is 5.088511e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913244830243       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913244907503       residual = 9.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913244926340       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913244932792       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913244934816       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913244935066       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913244935937       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913244936932       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913244937090       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913244937830       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913244937819       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913244938111       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913244938021       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913244938963       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913244939381       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913244939518       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913244939239       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913244939847       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913244940276       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913244940611       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913244940636       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913244940522       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913244940421       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913244940398       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913244940553       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913244940456       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913244940454       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913244940446       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913244940580       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913244940654       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913244940618       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913244940633       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913244940632       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913244940629       residual = 7.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.5000e+02 is 1.272238e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.695925 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5311e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
  uu_0                 2.086196e-01 1 1  ON 0
  uu_1                 5.170884e-02 1 1  ON 1
  uu_2                -3.903992e-02 1 1  ON 2
  uu_3                -9.240932e-02 1 1  ON 3
  uu_4                -1.232228e-01 1 1  ON 4
  uu_5                -1.309082e-01 1 1  ON 5
  uu_6                -1.127524e-01 1 1  ON 6
  uu_7                -5.440783e-02 1 1  ON 7
  uu_8                 6.695944e-02 1 1  ON 8
  uu_9                 1.242849e-01 1 1  ON 9
  ud_0                 3.067778e-01 1 1  ON 10
  ud_1                 7.702554e-02 1 1  ON 11
  ud_2                -2.491586e-02 1 1  ON 12
  ud_3                -7.809304e-02 1 1  ON 13
  ud_4                -1.144358e-01 1 1  ON 14
  ud_5                -1.341048e-01 1 1  ON 15
  ud_6                -1.290012e-01 1 1  ON 16
  ud_7                -8.828159e-02 1 1  ON 17
  ud_8                -4.415483e-03 1 1  ON 18
  ud_9                 8.761798e-02 1 1  ON 19
  eO_0                -7.039568e-01 1 1  ON 20
  eO_1                -4.206855e-01 1 1  ON 21
  eO_2                -4.184059e-02 1 1  ON 22
  eO_3                 1.855375e-01 1 1  ON 23
  eO_4                 2.599166e-01 1 1  ON 24
  eO_5                 2.840708e-01 1 1  ON 25
  eO_6                 2.507154e-01 1 1  ON 26
  eO_7                 1.272485e-01 1 1  ON 27
  eO_8                 2.869708e-02 1 1  ON 28
  eO_9                 1.906335e-02 1 1  ON 29
 eH1_0                -2.022647e-01 1 1  ON 30
 eH1_1                -9.742983e-02 1 1  ON 31
 eH1_2                -4.633860e-02 1 1  ON 32
 eH1_3                -1.504150e-02 1 1  ON 33
 eH1_4                 1.853682e-02 1 1  ON 34
 eH1_5                 2.507756e-02 1 1  ON 35
 eH1_6                 7.419648e-02 1 1  ON 36
 eH1_7                 1.039568e-01 1 1  ON 37
 eH1_8                 9.802069e-02 1 1  ON 38
 eH1_9                 2.544434e-02 1 1  ON 39
 eH2_0                -2.031305e-01 1 1  ON 40
 eH2_1                -9.887644e-02 1 1  ON 41
 eH2_2                -4.809064e-02 1 1  ON 42
 eH2_3                -1.715535e-02 1 1  ON 43
 eH2_4                 1.622177e-02 1 1  ON 44
 eH2_5                 2.136629e-02 1 1  ON 45
 eH2_6                 7.609633e-02 1 1  ON 46
 eH2_7                 1.119975e-01 1 1  ON 47
 eH2_8                 1.007663e-01 1 1  ON 48
 eH2_9                 2.830995e-02 1 1  ON 49
ci_001                -4.241713e-02 3 1  ON 50
ci_002                -3.110787e-02 3 1  ON 51
ci_003                -1.187794e-02 3 1  ON 52
ci_004                 2.577975e-02 3 1  ON 53
ci_005                 2.618009e-02 3 1  ON 54
ci_006                -2.100964e-02 3 1  ON 55
ci_007                -2.031304e-02 3 1  ON 56
ci_008                -4.823999e-03 3 1  ON 57
ci_009                -1.578754e-02 3 1  ON 58
ci_010                -1.014434e-02 3 1  ON 59
ci_011                -9.960048e-03 3 1  ON 60
ci_012                -9.939118e-03 3 1  ON 61
ci_013                -2.148479e-02 3 1  ON 62
ci_014                 1.339822e-02 3 1  ON 63
ci_015                 1.342479e-02 3 1  ON 64
ci_016                 1.668049e-02 3 1  ON 65
ci_017                 1.635884e-02 3 1  ON 66
ci_018                 1.093697e-02 3 1  ON 67
ci_019                 1.082983e-02 3 1  ON 68
ci_020                 1.838986e-02 3 1  ON 69
ci_021                 1.793813e-02 3 1  ON 70
ci_022                 1.041744e-02 3 1  ON 71
ci_023                 1.059336e-02 3 1  ON 72
ci_024                 6.934519e-03 3 1  ON 73
ci_025                 6.757701e-03 3 1  ON 74
ci_026                 1.182015e-02 3 1  ON 75
ci_027                 1.178994e-02 3 1  ON 76
ci_028                -9.433426e-03 3 1  ON 77
ci_029                -1.027831e-02 3 1  ON 78
ci_030                -4.784806e-03 3 1  ON 79
ci_031                -4.921123e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.233
    reference variance = 0.23831
====================================================
  Execution time = 1.9281e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0203e-01
  Total weights = 1.9738e+06
  Execution time = 1.6141e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292931336066
                                         uncertainty =       0.002434982715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292931336066
                                         uncertainty =       0.002434982715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382684002
  error estimate for blocks of size 2^( 2) =       0.000397656160
  error estimate for blocks of size 2^( 3) =       0.000411418587
  error estimate for blocks of size 2^( 4) =       0.000421847974
  error estimate for blocks of size 2^( 5) =       0.000428017728
  error estimate for blocks of size 2^( 6) =       0.000431327622
  error estimate for blocks of size 2^( 7) =       0.000432174797

      target function =      -0.909649160899
              le_mean =     -17.206269725561
             les_mean =     296.357747410842
             stat err =       0.000428342030
             autocorr =       1.252854878674
   target nu stat err =       0.000428342030
   target dn stat err =       0.003528315055
      target stat err =       0.005446650296
              std dev =       0.541196905406
             le_variance =       0.292894090421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292933052924
                                         uncertainty =       0.002435332913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292933052924
                                         uncertainty =       0.002435332913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382685124
  error estimate for blocks of size 2^( 2) =       0.000397658047
  error estimate for blocks of size 2^( 3) =       0.000411421299
  error estimate for blocks of size 2^( 4) =       0.000421851266
  error estimate for blocks of size 2^( 5) =       0.000428021265
  error estimate for blocks of size 2^( 6) =       0.000431331535
  error estimate for blocks of size 2^( 7) =       0.000432179042

      target function =      -0.909658018417
              le_mean =     -17.206269631729
             les_mean =     296.357738391421
             stat err =       0.000428345777
             autocorr =       1.252869444064
   target nu stat err =       0.000428345777
   target dn stat err =       0.003528562919
      target stat err =       0.005447131297
              std dev =       0.541198492954
             le_variance =       0.292895808775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292932195161
                                         uncertainty =       0.002435158201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292932195161
                                         uncertainty =       0.002435158201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382684563
  error estimate for blocks of size 2^( 2) =       0.000397657105
  error estimate for blocks of size 2^( 3) =       0.000411419946
  error estimate for blocks of size 2^( 4) =       0.000421849624
  error estimate for blocks of size 2^( 5) =       0.000428019501
  error estimate for blocks of size 2^( 6) =       0.000431329583
  error estimate for blocks of size 2^( 7) =       0.000432176925

      target function =      -0.909655505539
              le_mean =     -17.206269678293
             les_mean =     296.357741636892
             stat err =       0.000428343908
             autocorr =       1.252862185387
   target nu stat err =       0.000428343908
   target dn stat err =       0.003528433935
      target stat err =       0.005446905873
              std dev =       0.541197699801
             le_variance =       0.292894950270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292931443292
                                         uncertainty =       0.002435004649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292931443292
                                         uncertainty =       0.002435004649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382684072
  error estimate for blocks of size 2^( 2) =       0.000397656278
  error estimate for blocks of size 2^( 3) =       0.000411418757
  error estimate for blocks of size 2^( 4) =       0.000421848181
  error estimate for blocks of size 2^( 5) =       0.000428017950
  error estimate for blocks of size 2^( 6) =       0.000431327868
  error estimate for blocks of size 2^( 7) =       0.000432175063

      target function =      -0.909650311441
              le_mean =     -17.206269719627
             les_mean =     296.357746454575
             stat err =       0.000428342265
             autocorr =       1.252855792924
   target nu stat err =       0.000428342265
   target dn stat err =       0.003528328805
      target stat err =       0.005446684802
              std dev =       0.541197004558
             le_variance =       0.292894197742


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909649160899        initial
     1.5625e+01     1.5625e+02             2.0347e-05        -0.909658018417  <--
     6.2500e+01     6.2500e+02             5.0885e-06        -0.909655505539
     2.5000e+02     2.5000e+03             1.2722e-06        -0.909650311441

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 2.7395e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
  uu_0                 2.086233e-01 1 1  ON 0
  uu_1                 5.170969e-02 1 1  ON 1
  uu_2                -3.904085e-02 1 1  ON 2
  uu_3                -9.241159e-02 1 1  ON 3
  uu_4                -1.232255e-01 1 1  ON 4
  uu_5                -1.309096e-01 1 1  ON 5
  uu_6                -1.127496e-01 1 1  ON 6
  uu_7                -5.441100e-02 1 1  ON 7
  uu_8                 6.694418e-02 1 1  ON 8
  uu_9                 1.242894e-01 1 1  ON 9
  ud_0                 3.067732e-01 1 1  ON 10
  ud_1                 7.702203e-02 1 1  ON 11
  ud_2                -2.491893e-02 1 1  ON 12
  ud_3                -7.809458e-02 1 1  ON 13
  ud_4                -1.144379e-01 1 1  ON 14
  ud_5                -1.341055e-01 1 1  ON 15
  ud_6                -1.289969e-01 1 1  ON 16
  ud_7                -8.827934e-02 1 1  ON 17
  ud_8                -4.422152e-03 1 1  ON 18
  ud_9                 8.761469e-02 1 1  ON 19
  eO_0                -7.039654e-01 1 1  ON 20
  eO_1                -4.206909e-01 1 1  ON 21
  eO_2                -4.184373e-02 1 1  ON 22
  eO_3                 1.855411e-01 1 1  ON 23
  eO_4                 2.599206e-01 1 1  ON 24
  eO_5                 2.840588e-01 1 1  ON 25
  eO_6                 2.507164e-01 1 1  ON 26
  eO_7                 1.272635e-01 1 1  ON 27
  eO_8                 2.869815e-02 1 1  ON 28
  eO_9                 1.906443e-02 1 1  ON 29
 eH1_0                -2.022692e-01 1 1  ON 30
 eH1_1                -9.743100e-02 1 1  ON 31
 eH1_2                -4.633584e-02 1 1  ON 32
 eH1_3                -1.504251e-02 1 1  ON 33
 eH1_4                 1.853479e-02 1 1  ON 34
 eH1_5                 2.506913e-02 1 1  ON 35
 eH1_6                 7.419916e-02 1 1  ON 36
 eH1_7                 1.039602e-01 1 1  ON 37
 eH1_8                 9.802645e-02 1 1  ON 38
 eH1_9                 2.544610e-02 1 1  ON 39
 eH2_0                -2.031332e-01 1 1  ON 40
 eH2_1                -9.887675e-02 1 1  ON 41
 eH2_2                -4.808741e-02 1 1  ON 42
 eH2_3                -1.714917e-02 1 1  ON 43
 eH2_4                 1.622143e-02 1 1  ON 44
 eH2_5                 2.135540e-02 1 1  ON 45
 eH2_6                 7.609143e-02 1 1  ON 46
 eH2_7                 1.119954e-01 1 1  ON 47
 eH2_8                 1.007728e-01 1 1  ON 48
 eH2_9                 2.831190e-02 1 1  ON 49
ci_001                -4.241596e-02 3 1  ON 50
ci_002                -3.110852e-02 3 1  ON 51
ci_003                -1.187707e-02 3 1  ON 52
ci_004                 2.578185e-02 3 1  ON 53
ci_005                 2.617679e-02 3 1  ON 54
ci_006                -2.100577e-02 3 1  ON 55
ci_007                -2.031514e-02 3 1  ON 56
ci_008                -4.826901e-03 3 1  ON 57
ci_009                -1.578429e-02 3 1  ON 58
ci_010                -1.014194e-02 3 1  ON 59
ci_011                -9.955516e-03 3 1  ON 60
ci_012                -9.938253e-03 3 1  ON 61
ci_013                -2.148227e-02 3 1  ON 62
ci_014                 1.339701e-02 3 1  ON 63
ci_015                 1.342389e-02 3 1  ON 64
ci_016                 1.667729e-02 3 1  ON 65
ci_017                 1.635648e-02 3 1  ON 66
ci_018                 1.093665e-02 3 1  ON 67
ci_019                 1.083021e-02 3 1  ON 68
ci_020                 1.839087e-02 3 1  ON 69
ci_021                 1.794163e-02 3 1  ON 70
ci_022                 1.041768e-02 3 1  ON 71
ci_023                 1.059016e-02 3 1  ON 72
ci_024                 6.933291e-03 3 1  ON 73
ci_025                 6.757243e-03 3 1  ON 74
ci_026                 1.181647e-02 3 1  ON 75
ci_027                 1.178980e-02 3 1  ON 76
ci_028                -9.430587e-03 3 1  ON 77
ci_029                -1.027170e-02 3 1  ON 78
ci_030                -4.781142e-03 3 1  ON 79
ci_031                -4.919674e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2713e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7186e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1774
    reference variance = 0.235166
====================================================
  Execution time = 2.1728e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5392e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0076e-01
  Total weights = 1.973848590e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5943e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291109677833
                                         uncertainty =       0.001968082794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291109677833
                                         uncertainty =       0.001968082794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381506887
  error estimate for blocks of size 2^( 2) =       0.000396379349
  error estimate for blocks of size 2^( 3) =       0.000410046982
  error estimate for blocks of size 2^( 4) =       0.000419824908
  error estimate for blocks of size 2^( 5) =       0.000426428290
  error estimate for blocks of size 2^( 6) =       0.000430235702
  error estimate for blocks of size 2^( 7) =       0.000432930985

      target function =      -0.911583678649
              le_mean =     -17.207015074091
             les_mean =     296.382126815806
             stat err =       0.000427354971
             autocorr =       1.254794931950
   target nu stat err =       0.000427354971
   target dn stat err =       0.003255252569
      target stat err =       0.005060724819
              std dev =       0.539532213528
             le_variance =       0.291095009434


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720701507409e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911610591842       residual = 5.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911617325908       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911618351686       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911618990127       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911619046093       residual = 9.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911619258515       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911619403060       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911619550315       residual = 5.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911619641670       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911619728206       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911619790882       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911619792516       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911619813362       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911619860798       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911619934548       residual = 9.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911619960200       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911620036222       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911620058015       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911620104775       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911620098750       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911620109876       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911620098025       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911620109357       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911620111459       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911620132608       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911620127404       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911620132627       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911620144758       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911620147807       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911620152744       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911620150125       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911620147896       residual = 9.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911620151482       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911620152672       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911620153814       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911620150555       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911620153666       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911620154813       residual = 7.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+00 is 1.134337e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911610591842       residual = 5.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911612299237       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911612558801       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911612720142       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911612734274       residual = 9.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911612787920       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911612824162       residual = 7.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911612861373       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911612884265       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911612906041       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911612921870       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911612922168       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911612927384       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911612939235       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911612957637       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911612964091       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911612983289       residual = 8.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911612988709       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911613000292       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911612998684       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911613001395       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911612998395       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911613001336       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911613001929       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911613007084       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911613005646       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911613006959       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911613010015       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911613010706       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911613012011       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911613011148       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911613010751       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911613011659       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911613011937       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911613012174       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911613011389       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911613012140       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911613012437       residual = 7.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+01 is 2.836579e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911610591842       residual = 5.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911611020209       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911611085299       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911611125744       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911611129286       residual = 9.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911611142731       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911611151798       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911611161126       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911611166852       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911611172305       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911611176272       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911611176340       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911611177644       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911611180606       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911611185204       residual = 9.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911611186820       residual = 8.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911611191632       residual = 8.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911611192985       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911611195874       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911611195465       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911611196139       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911611195387       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911611196129       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911611196281       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911611197561       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911611197193       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911611197522       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911611198288       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911611198456       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911611198786       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911611198556       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911611198469       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911611198696       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911611198765       residual = 9.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911611198820       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911611198626       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911611198812       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911611198888       residual = 6.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e+01 is 7.091895e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.754731 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7386e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
  uu_0                 2.086269e-01 1 1  ON 0
  uu_1                 5.171482e-02 1 1  ON 1
  uu_2                -3.903634e-02 1 1  ON 2
  uu_3                -9.240754e-02 1 1  ON 3
  uu_4                -1.232233e-01 1 1  ON 4
  uu_5                -1.309080e-01 1 1  ON 5
  uu_6                -1.127532e-01 1 1  ON 6
  uu_7                -5.441471e-02 1 1  ON 7
  uu_8                 6.691721e-02 1 1  ON 8
  uu_9                 1.242926e-01 1 1  ON 9
  ud_0                 3.067622e-01 1 1  ON 10
  ud_1                 7.701345e-02 1 1  ON 11
  ud_2                -2.492660e-02 1 1  ON 12
  ud_3                -7.809984e-02 1 1  ON 13
  ud_4                -1.144395e-01 1 1  ON 14
  ud_5                -1.341007e-01 1 1  ON 15
  ud_6                -1.289867e-01 1 1  ON 16
  ud_7                -8.826656e-02 1 1  ON 17
  ud_8                -4.421490e-03 1 1  ON 18
  ud_9                 8.761048e-02 1 1  ON 19
  eO_0                -7.039609e-01 1 1  ON 20
  eO_1                -4.206892e-01 1 1  ON 21
  eO_2                -4.184762e-02 1 1  ON 22
  eO_3                 1.855309e-01 1 1  ON 23
  eO_4                 2.599175e-01 1 1  ON 24
  eO_5                 2.840424e-01 1 1  ON 25
  eO_6                 2.507201e-01 1 1  ON 26
  eO_7                 1.272837e-01 1 1  ON 27
  eO_8                 2.870013e-02 1 1  ON 28
  eO_9                 1.906474e-02 1 1  ON 29
 eH1_0                -2.022772e-01 1 1  ON 30
 eH1_1                -9.743692e-02 1 1  ON 31
 eH1_2                -4.633728e-02 1 1  ON 32
 eH1_3                -1.505118e-02 1 1  ON 33
 eH1_4                 1.851943e-02 1 1  ON 34
 eH1_5                 2.504535e-02 1 1  ON 35
 eH1_6                 7.421907e-02 1 1  ON 36
 eH1_7                 1.039885e-01 1 1  ON 37
 eH1_8                 9.803898e-02 1 1  ON 38
 eH1_9                 2.544760e-02 1 1  ON 39
 eH2_0                -2.031438e-01 1 1  ON 40
 eH2_1                -9.887714e-02 1 1  ON 41
 eH2_2                -4.807917e-02 1 1  ON 42
 eH2_3                -1.714102e-02 1 1  ON 43
 eH2_4                 1.623002e-02 1 1  ON 44
 eH2_5                 2.135536e-02 1 1  ON 45
 eH2_6                 7.607163e-02 1 1  ON 46
 eH2_7                 1.119894e-01 1 1  ON 47
 eH2_8                 1.007806e-01 1 1  ON 48
 eH2_9                 2.831578e-02 1 1  ON 49
ci_001                -4.241458e-02 3 1  ON 50
ci_002                -3.110674e-02 3 1  ON 51
ci_003                -1.187193e-02 3 1  ON 52
ci_004                 2.578344e-02 3 1  ON 53
ci_005                 2.617890e-02 3 1  ON 54
ci_006                -2.100098e-02 3 1  ON 55
ci_007                -2.031286e-02 3 1  ON 56
ci_008                -4.826242e-03 3 1  ON 57
ci_009                -1.577923e-02 3 1  ON 58
ci_010                -1.013530e-02 3 1  ON 59
ci_011                -9.956692e-03 3 1  ON 60
ci_012                -9.937285e-03 3 1  ON 61
ci_013                -2.148140e-02 3 1  ON 62
ci_014                 1.339599e-02 3 1  ON 63
ci_015                 1.341565e-02 3 1  ON 64
ci_016                 1.667687e-02 3 1  ON 65
ci_017                 1.635992e-02 3 1  ON 66
ci_018                 1.093953e-02 3 1  ON 67
ci_019                 1.083683e-02 3 1  ON 68
ci_020                 1.838453e-02 3 1  ON 69
ci_021                 1.794283e-02 3 1  ON 70
ci_022                 1.041668e-02 3 1  ON 71
ci_023                 1.058878e-02 3 1  ON 72
ci_024                 6.930331e-03 3 1  ON 73
ci_025                 6.762079e-03 3 1  ON 74
ci_026                 1.182028e-02 3 1  ON 75
ci_027                 1.179026e-02 3 1  ON 76
ci_028                -9.438881e-03 3 1  ON 77
ci_029                -1.026613e-02 3 1  ON 78
ci_030                -4.776160e-03 3 1  ON 79
ci_031                -4.918491e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.0975
    reference variance = 0.208955
====================================================
  Execution time = 1.9626e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0067e-01
  Total weights = 1.9737e+06
  Execution time = 1.6099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292079541300
                                         uncertainty =       0.002508566868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292079541300
                                         uncertainty =       0.002508566868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382165434
  error estimate for blocks of size 2^( 2) =       0.000397369416
  error estimate for blocks of size 2^( 3) =       0.000410569500
  error estimate for blocks of size 2^( 4) =       0.000420523119
  error estimate for blocks of size 2^( 5) =       0.000427132968
  error estimate for blocks of size 2^( 6) =       0.000432305628
  error estimate for blocks of size 2^( 7) =       0.000434227530

      target function =      -0.911734224546
              le_mean =     -17.206231745796
             les_mean =     296.355086033493
             stat err =       0.000428547311
             autocorr =       1.257461630959
   target nu stat err =       0.000428547311
   target dn stat err =       0.003126140713
      target stat err =       0.004858992269
              std dev =       0.540463539706
             le_variance =       0.292100837751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292081516158
                                         uncertainty =       0.002508473170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292081516158
                                         uncertainty =       0.002508473170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382166698
  error estimate for blocks of size 2^( 2) =       0.000397374749
  error estimate for blocks of size 2^( 3) =       0.000410579214
  error estimate for blocks of size 2^( 4) =       0.000420535871
  error estimate for blocks of size 2^( 5) =       0.000427148921
  error estimate for blocks of size 2^( 6) =       0.000432324694
  error estimate for blocks of size 2^( 7) =       0.000434246141

      target function =      -0.911688587794
              le_mean =     -17.206231954385
             les_mean =     296.355122908644
             stat err =       0.000428563907
             autocorr =       1.257550707184
   target nu stat err =       0.000428563907
   target dn stat err =       0.003125559444
      target stat err =       0.004857633791
              std dev =       0.540465327040
             le_variance =       0.292102769733

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292080495008
                                         uncertainty =       0.002508518140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292080495008
                                         uncertainty =       0.002508518140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382166044
  error estimate for blocks of size 2^( 2) =       0.000397372084
  error estimate for blocks of size 2^( 3) =       0.000410574381
  error estimate for blocks of size 2^( 4) =       0.000420529537
  error estimate for blocks of size 2^( 5) =       0.000427141005
  error estimate for blocks of size 2^( 6) =       0.000432315243
  error estimate for blocks of size 2^( 7) =       0.000434236912

      target function =      -0.911731932879
              le_mean =     -17.206231845119
             les_mean =     296.355090947115
             stat err =       0.000428555674
             autocorr =       1.257506698065
   target nu stat err =       0.000428555674
   target dn stat err =       0.003125546879
      target stat err =       0.004858068459
              std dev =       0.540464401944
             le_variance =       0.292101769769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292079655849
                                         uncertainty =       0.002508560658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292079655849
                                         uncertainty =       0.002508560658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382165507
  error estimate for blocks of size 2^( 2) =       0.000397369748
  error estimate for blocks of size 2^( 3) =       0.000410570108
  error estimate for blocks of size 2^( 4) =       0.000420523920
  error estimate for blocks of size 2^( 5) =       0.000427133972
  error estimate for blocks of size 2^( 6) =       0.000432306831
  error estimate for blocks of size 2^( 7) =       0.000434228702

      target function =      -0.911736494344
              le_mean =     -17.206231757508
             les_mean =     296.355084960529
             stat err =       0.000428548356
             autocorr =       1.257467283282
   target nu stat err =       0.000428548356
   target dn stat err =       0.003126044397
      target stat err =       0.004858870157
              std dev =       0.540463643166
             le_variance =       0.292100949584


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911734224546        initial
     3.9062e+00     3.9062e+01             1.1343e-04        -0.911688587794
     1.5625e+01     1.5625e+02             2.8366e-05        -0.911731932879
     6.2500e+01     6.2500e+02             7.0919e-06        -0.911736494344  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 2.7708e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
  uu_0                 2.086242e-01 1 1  ON 0
  uu_1                 5.171097e-02 1 1  ON 1
  uu_2                -3.903972e-02 1 1  ON 2
  uu_3                -9.241058e-02 1 1  ON 3
  uu_4                -1.232250e-01 1 1  ON 4
  uu_5                -1.309092e-01 1 1  ON 5
  uu_6                -1.127505e-01 1 1  ON 6
  uu_7                -5.441193e-02 1 1  ON 7
  uu_8                 6.693744e-02 1 1  ON 8
  uu_9                 1.242902e-01 1 1  ON 9
  ud_0                 3.067705e-01 1 1  ON 10
  ud_1                 7.701989e-02 1 1  ON 11
  ud_2                -2.492085e-02 1 1  ON 12
  ud_3                -7.809590e-02 1 1  ON 13
  ud_4                -1.144383e-01 1 1  ON 14
  ud_5                -1.341043e-01 1 1  ON 15
  ud_6                -1.289944e-01 1 1  ON 16
  ud_7                -8.827614e-02 1 1  ON 17
  ud_8                -4.421988e-03 1 1  ON 18
  ud_9                 8.761364e-02 1 1  ON 19
  eO_0                -7.039643e-01 1 1  ON 20
  eO_1                -4.206905e-01 1 1  ON 21
  eO_2                -4.184470e-02 1 1  ON 22
  eO_3                 1.855386e-01 1 1  ON 23
  eO_4                 2.599198e-01 1 1  ON 24
  eO_5                 2.840547e-01 1 1  ON 25
  eO_6                 2.507173e-01 1 1  ON 26
  eO_7                 1.272685e-01 1 1  ON 27
  eO_8                 2.869864e-02 1 1  ON 28
  eO_9                 1.906450e-02 1 1  ON 29
 eH1_0                -2.022712e-01 1 1  ON 30
 eH1_1                -9.743248e-02 1 1  ON 31
 eH1_2                -4.633620e-02 1 1  ON 32
 eH1_3                -1.504468e-02 1 1  ON 33
 eH1_4                 1.853094e-02 1 1  ON 34
 eH1_5                 2.506317e-02 1 1  ON 35
 eH1_6                 7.420415e-02 1 1  ON 36
 eH1_7                 1.039673e-01 1 1  ON 37
 eH1_8                 9.802958e-02 1 1  ON 38
 eH1_9                 2.544648e-02 1 1  ON 39
 eH2_0                -2.031358e-01 1 1  ON 40
 eH2_1                -9.887685e-02 1 1  ON 41
 eH2_2                -4.808535e-02 1 1  ON 42
 eH2_3                -1.714713e-02 1 1  ON 43
 eH2_4                 1.622358e-02 1 1  ON 44
 eH2_5                 2.135539e-02 1 1  ON 45
 eH2_6                 7.608648e-02 1 1  ON 46
 eH2_7                 1.119939e-01 1 1  ON 47
 eH2_8                 1.007748e-01 1 1  ON 48
 eH2_9                 2.831287e-02 1 1  ON 49
ci_001                -4.241562e-02 3 1  ON 50
ci_002                -3.110808e-02 3 1  ON 51
ci_003                -1.187578e-02 3 1  ON 52
ci_004                 2.578225e-02 3 1  ON 53
ci_005                 2.617732e-02 3 1  ON 54
ci_006                -2.100457e-02 3 1  ON 55
ci_007                -2.031457e-02 3 1  ON 56
ci_008                -4.826735e-03 3 1  ON 57
ci_009                -1.578302e-02 3 1  ON 58
ci_010                -1.014028e-02 3 1  ON 59
ci_011                -9.955811e-03 3 1  ON 60
ci_012                -9.938010e-03 3 1  ON 61
ci_013                -2.148205e-02 3 1  ON 62
ci_014                 1.339675e-02 3 1  ON 63
ci_015                 1.342183e-02 3 1  ON 64
ci_016                 1.667718e-02 3 1  ON 65
ci_017                 1.635734e-02 3 1  ON 66
ci_018                 1.093737e-02 3 1  ON 67
ci_019                 1.083187e-02 3 1  ON 68
ci_020                 1.838928e-02 3 1  ON 69
ci_021                 1.794193e-02 3 1  ON 70
ci_022                 1.041743e-02 3 1  ON 71
ci_023                 1.058982e-02 3 1  ON 72
ci_024                 6.932549e-03 3 1  ON 73
ci_025                 6.758456e-03 3 1  ON 74
ci_026                 1.181742e-02 3 1  ON 75
ci_027                 1.178992e-02 3 1  ON 76
ci_028                -9.432667e-03 3 1  ON 77
ci_029                -1.027030e-02 3 1  ON 78
ci_030                -4.779892e-03 3 1  ON 79
ci_031                -4.919377e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5102e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7182e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2071
    reference variance = 0.261687
====================================================
  Execution time = 1.9831e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5416e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9641e-01
  Total weights = 1.973880668e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5034e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288590331121
                                         uncertainty =       0.001542269954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288590331121
                                         uncertainty =       0.001542269954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379868524
  error estimate for blocks of size 2^( 2) =       0.000394867331
  error estimate for blocks of size 2^( 3) =       0.000408395255
  error estimate for blocks of size 2^( 4) =       0.000418601009
  error estimate for blocks of size 2^( 5) =       0.000425128486
  error estimate for blocks of size 2^( 6) =       0.000428223925
  error estimate for blocks of size 2^( 7) =       0.000430121134

      target function =      -0.918344320725
              le_mean =     -17.206660769937
             les_mean =     296.365584429192
             stat err =       0.000425518638
             autocorr =       1.254788577858
   target nu stat err =       0.000425518638
   target dn stat err =       0.002291996069
      target stat err =       0.003649296226
              std dev =       0.537215218490
             le_variance =       0.288600190977


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720666076994e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918357765090       residual = 6.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918359535679       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918359894882       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918359953572       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918359970107       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918359980627       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918359997069       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918360001267       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918360020660       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918360027703       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918360034508       residual = 9.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918360042692       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918360038895       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918360045834       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918360049162       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918360047597       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918360053465       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918360055519       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918360061847       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918360068474       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918360067807       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918360067909       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918360065341       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918360068150       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918360068968       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918360068460       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918360070041       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918360071174       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918360070968       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918360072712       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918360073419       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918360073337       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918360073476       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918360072312       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918360072635       residual = 9.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+01 is 2.359238e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918357765090       residual = 6.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918358209378       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918358299433       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918358314147       residual = 9.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918358318283       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918358320916       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918358325038       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918358326091       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918358330943       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918358332712       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918358334417       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918358336463       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918358335511       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918358337240       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918358338077       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918358337682       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918358339154       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918358339674       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918358341253       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918358342903       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918358342734       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918358342754       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918358342114       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918358342817       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918358343020       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918358342894       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918358343290       residual = 8.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918358343571       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918358343519       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918358343954       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918358344130       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918358344109       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918358344141       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918358343852       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918358343935       residual = 9.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e+01 is 5.900484e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918357765090       residual = 6.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918357876265       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918357898795       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918357902476       residual = 9.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918357903510       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918357904168       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918357905200       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918357905463       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918357906677       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918357907118       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918357907545       residual = 9.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918357908057       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918357907819       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918357908251       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918357908460       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918357908362       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918357908730       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918357908860       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918357909254       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918357909667       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918357909623       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918357909628       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918357909469       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918357909645       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918357909695       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918357909664       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918357909764       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918357909832       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918357909820       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918357909929       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918357909972       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918357909967       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918357909975       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918357909903       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918357909925       residual = 9.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.5000e+02 is 1.475270e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.802374 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5389e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
  uu_0                 2.086253e-01 1 1  ON 0
  uu_1                 5.171232e-02 1 1  ON 1
  uu_2                -3.903857e-02 1 1  ON 2
  uu_3                -9.240956e-02 1 1  ON 3
  uu_4                -1.232242e-01 1 1  ON 4
  uu_5                -1.309095e-01 1 1  ON 5
  uu_6                -1.127502e-01 1 1  ON 6
  uu_7                -5.441373e-02 1 1  ON 7
  uu_8                 6.693153e-02 1 1  ON 8
  uu_9                 1.242908e-01 1 1  ON 9
  ud_0                 3.067693e-01 1 1  ON 10
  ud_1                 7.701914e-02 1 1  ON 11
  ud_2                -2.492131e-02 1 1  ON 12
  ud_3                -7.809650e-02 1 1  ON 13
  ud_4                -1.144380e-01 1 1  ON 14
  ud_5                -1.341040e-01 1 1  ON 15
  ud_6                -1.289936e-01 1 1  ON 16
  ud_7                -8.827625e-02 1 1  ON 17
  ud_8                -4.422907e-03 1 1  ON 18
  ud_9                 8.761365e-02 1 1  ON 19
  eO_0                -7.039639e-01 1 1  ON 20
  eO_1                -4.206900e-01 1 1  ON 21
  eO_2                -4.184470e-02 1 1  ON 22
  eO_3                 1.855382e-01 1 1  ON 23
  eO_4                 2.599193e-01 1 1  ON 24
  eO_5                 2.840496e-01 1 1  ON 25
  eO_6                 2.507167e-01 1 1  ON 26
  eO_7                 1.272732e-01 1 1  ON 27
  eO_8                 2.869954e-02 1 1  ON 28
  eO_9                 1.906470e-02 1 1  ON 29
 eH1_0                -2.022711e-01 1 1  ON 30
 eH1_1                -9.743080e-02 1 1  ON 31
 eH1_2                -4.633481e-02 1 1  ON 32
 eH1_3                -1.504314e-02 1 1  ON 33
 eH1_4                 1.853084e-02 1 1  ON 34
 eH1_5                 2.505842e-02 1 1  ON 35
 eH1_6                 7.420215e-02 1 1  ON 36
 eH1_7                 1.039660e-01 1 1  ON 37
 eH1_8                 9.803230e-02 1 1  ON 38
 eH1_9                 2.544716e-02 1 1  ON 39
 eH2_0                -2.031378e-01 1 1  ON 40
 eH2_1                -9.887788e-02 1 1  ON 41
 eH2_2                -4.808680e-02 1 1  ON 42
 eH2_3                -1.714853e-02 1 1  ON 43
 eH2_4                 1.622173e-02 1 1  ON 44
 eH2_5                 2.135672e-02 1 1  ON 45
 eH2_6                 7.609079e-02 1 1  ON 46
 eH2_7                 1.119936e-01 1 1  ON 47
 eH2_8                 1.007763e-01 1 1  ON 48
 eH2_9                 2.831363e-02 1 1  ON 49
ci_001                -4.241443e-02 3 1  ON 50
ci_002                -3.110760e-02 3 1  ON 51
ci_003                -1.187431e-02 3 1  ON 52
ci_004                 2.578295e-02 3 1  ON 53
ci_005                 2.617597e-02 3 1  ON 54
ci_006                -2.100330e-02 3 1  ON 55
ci_007                -2.031403e-02 3 1  ON 56
ci_008                -4.827983e-03 3 1  ON 57
ci_009                -1.578180e-02 3 1  ON 58
ci_010                -1.014097e-02 3 1  ON 59
ci_011                -9.954235e-03 3 1  ON 60
ci_012                -9.937252e-03 3 1  ON 61
ci_013                -2.148161e-02 3 1  ON 62
ci_014                 1.339724e-02 3 1  ON 63
ci_015                 1.342060e-02 3 1  ON 64
ci_016                 1.667644e-02 3 1  ON 65
ci_017                 1.635729e-02 3 1  ON 66
ci_018                 1.093751e-02 3 1  ON 67
ci_019                 1.083023e-02 3 1  ON 68
ci_020                 1.839020e-02 3 1  ON 69
ci_021                 1.794206e-02 3 1  ON 70
ci_022                 1.041835e-02 3 1  ON 71
ci_023                 1.058776e-02 3 1  ON 72
ci_024                 6.931420e-03 3 1  ON 73
ci_025                 6.756757e-03 3 1  ON 74
ci_026                 1.181744e-02 3 1  ON 75
ci_027                 1.179057e-02 3 1  ON 76
ci_028                -9.432598e-03 3 1  ON 77
ci_029                -1.026927e-02 3 1  ON 78
ci_030                -4.780412e-03 3 1  ON 79
ci_031                -4.918348e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.237
    reference variance = 0.203461
====================================================
  Execution time = 1.9472e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9480e-01
  Total weights = 1.9737e+06
  Execution time = 1.6133e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287226757518
                                         uncertainty =       0.001423030310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287226757518
                                         uncertainty =       0.001423030310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378968930
  error estimate for blocks of size 2^( 2) =       0.000393867073
  error estimate for blocks of size 2^( 3) =       0.000407946143
  error estimate for blocks of size 2^( 4) =       0.000418429209
  error estimate for blocks of size 2^( 5) =       0.000423837980
  error estimate for blocks of size 2^( 6) =       0.000429956773
  error estimate for blocks of size 2^( 7) =       0.000430272461

      target function =      -0.920861035594
              le_mean =     -17.206863624017
             les_mean =     296.370956980247
             stat err =       0.000425624106
             autocorr =       1.261377917923
   target nu stat err =       0.000425624106
   target dn stat err =       0.002160540825
      target stat err =       0.003468296762
              std dev =       0.535942999843
             le_variance =       0.287234899080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287226102161
                                         uncertainty =       0.001423003105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287226102161
                                         uncertainty =       0.001423003105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378968499
  error estimate for blocks of size 2^( 2) =       0.000393867343
  error estimate for blocks of size 2^( 3) =       0.000407947166
  error estimate for blocks of size 2^( 4) =       0.000418430751
  error estimate for blocks of size 2^( 5) =       0.000423839878
  error estimate for blocks of size 2^( 6) =       0.000429958557
  error estimate for blocks of size 2^( 7) =       0.000430274387

      target function =      -0.920873496818
              le_mean =     -17.206863520666
             les_mean =     296.370945481780
             stat err =       0.000425625893
             autocorr =       1.261391376991
   target nu stat err =       0.000425625893
   target dn stat err =       0.002161087598
      target stat err =       0.003469227921
              std dev =       0.535942390997
             le_variance =       0.287234246468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287226426267
                                         uncertainty =       0.001423016618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287226426267
                                         uncertainty =       0.001423016618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378968712
  error estimate for blocks of size 2^( 2) =       0.000393867207
  error estimate for blocks of size 2^( 3) =       0.000407946654
  error estimate for blocks of size 2^( 4) =       0.000418429981
  error estimate for blocks of size 2^( 5) =       0.000423838930
  error estimate for blocks of size 2^( 6) =       0.000429957666
  error estimate for blocks of size 2^( 7) =       0.000430273426

      target function =      -0.920868274221
              le_mean =     -17.206863571963
             les_mean =     296.370950575900
             stat err =       0.000425625001
             autocorr =       1.261384671057
   target nu stat err =       0.000425625001
   target dn stat err =       0.002160807367
      target stat err =       0.003468759253
              std dev =       0.535942692091
             le_variance =       0.287234569206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287226715796
                                         uncertainty =       0.001423028591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287226715796
                                         uncertainty =       0.001423028591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378968902
  error estimate for blocks of size 2^( 2) =       0.000393867090
  error estimate for blocks of size 2^( 3) =       0.000407946207
  error estimate for blocks of size 2^( 4) =       0.000418429306
  error estimate for blocks of size 2^( 5) =       0.000423838098
  error estimate for blocks of size 2^( 6) =       0.000429956885
  error estimate for blocks of size 2^( 7) =       0.000430272582

      target function =      -0.920862073629
              le_mean =     -17.206863617482
             les_mean =     296.370956093885
             stat err =       0.000425624218
             autocorr =       1.261378763042
   target nu stat err =       0.000425624218
   target dn stat err =       0.002160573037
      target stat err =       0.003468353857
              std dev =       0.535942961079
             le_variance =       0.287234857530


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920861035594        initial
     1.5625e+01     1.5625e+02             2.3592e-05        -0.920873496818  <--
     6.2500e+01     6.2500e+02             5.9005e-06        -0.920868274221
     2.5000e+02     2.5000e+03             1.4753e-06        -0.920862073629

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 2.7577e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
  uu_0                 2.086287e-01 1 1  ON 0
  uu_1                 5.171634e-02 1 1  ON 1
  uu_2                -3.903512e-02 1 1  ON 2
  uu_3                -9.240650e-02 1 1  ON 3
  uu_4                -1.232221e-01 1 1  ON 4
  uu_5                -1.309104e-01 1 1  ON 5
  uu_6                -1.127495e-01 1 1  ON 6
  uu_7                -5.441912e-02 1 1  ON 7
  uu_8                 6.691384e-02 1 1  ON 8
  uu_9                 1.242924e-01 1 1  ON 9
  ud_0                 3.067660e-01 1 1  ON 10
  ud_1                 7.701690e-02 1 1  ON 11
  ud_2                -2.492270e-02 1 1  ON 12
  ud_3                -7.809832e-02 1 1  ON 13
  ud_4                -1.144369e-01 1 1  ON 14
  ud_5                -1.341031e-01 1 1  ON 15
  ud_6                -1.289913e-01 1 1  ON 16
  ud_7                -8.827659e-02 1 1  ON 17
  ud_8                -4.425661e-03 1 1  ON 18
  ud_9                 8.761368e-02 1 1  ON 19
  eO_0                -7.039628e-01 1 1  ON 20
  eO_1                -4.206887e-01 1 1  ON 21
  eO_2                -4.184471e-02 1 1  ON 22
  eO_3                 1.855371e-01 1 1  ON 23
  eO_4                 2.599177e-01 1 1  ON 24
  eO_5                 2.840345e-01 1 1  ON 25
  eO_6                 2.507147e-01 1 1  ON 26
  eO_7                 1.272874e-01 1 1  ON 27
  eO_8                 2.870221e-02 1 1  ON 28
  eO_9                 1.906531e-02 1 1  ON 29
 eH1_0                -2.022710e-01 1 1  ON 30
 eH1_1                -9.742577e-02 1 1  ON 31
 eH1_2                -4.633066e-02 1 1  ON 32
 eH1_3                -1.503855e-02 1 1  ON 33
 eH1_4                 1.853051e-02 1 1  ON 34
 eH1_5                 2.504419e-02 1 1  ON 35
 eH1_6                 7.419616e-02 1 1  ON 36
 eH1_7                 1.039623e-01 1 1  ON 37
 eH1_8                 9.804046e-02 1 1  ON 38
 eH1_9                 2.544920e-02 1 1  ON 39
 eH2_0                -2.031438e-01 1 1  ON 40
 eH2_1                -9.888098e-02 1 1  ON 41
 eH2_2                -4.809113e-02 1 1  ON 42
 eH2_3                -1.715273e-02 1 1  ON 43
 eH2_4                 1.621621e-02 1 1  ON 44
 eH2_5                 2.136070e-02 1 1  ON 45
 eH2_6                 7.610371e-02 1 1  ON 46
 eH2_7                 1.119926e-01 1 1  ON 47
 eH2_8                 1.007808e-01 1 1  ON 48
 eH2_9                 2.831591e-02 1 1  ON 49
ci_001                -4.241089e-02 3 1  ON 50
ci_002                -3.110617e-02 3 1  ON 51
ci_003                -1.186990e-02 3 1  ON 52
ci_004                 2.578506e-02 3 1  ON 53
ci_005                 2.617191e-02 3 1  ON 54
ci_006                -2.099952e-02 3 1  ON 55
ci_007                -2.031243e-02 3 1  ON 56
ci_008                -4.831706e-03 3 1  ON 57
ci_009                -1.577815e-02 3 1  ON 58
ci_010                -1.014304e-02 3 1  ON 59
ci_011                -9.949531e-03 3 1  ON 60
ci_012                -9.934987e-03 3 1  ON 61
ci_013                -2.148030e-02 3 1  ON 62
ci_014                 1.339871e-02 3 1  ON 63
ci_015                 1.341695e-02 3 1  ON 64
ci_016                 1.667422e-02 3 1  ON 65
ci_017                 1.635714e-02 3 1  ON 66
ci_018                 1.093794e-02 3 1  ON 67
ci_019                 1.082536e-02 3 1  ON 68
ci_020                 1.839294e-02 3 1  ON 69
ci_021                 1.794245e-02 3 1  ON 70
ci_022                 1.042109e-02 3 1  ON 71
ci_023                 1.058162e-02 3 1  ON 72
ci_024                 6.928045e-03 3 1  ON 73
ci_025                 6.751682e-03 3 1  ON 74
ci_026                 1.181750e-02 3 1  ON 75
ci_027                 1.179251e-02 3 1  ON 76
ci_028                -9.432393e-03 3 1  ON 77
ci_029                -1.026618e-02 3 1  ON 78
ci_030                -4.781966e-03 3 1  ON 79
ci_031                -4.915276e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2972e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7185e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2128
    reference variance = 0.185173
====================================================
  Execution time = 1.9403e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5413e+04
  VMC Eavg = -1.7208e+01
  VMC Evar = 2.9799e-01
  Total weights = 1.973813967e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5288e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289617933720
                                         uncertainty =       0.001678098935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289617933720
                                         uncertainty =       0.001678098935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380543927
  error estimate for blocks of size 2^( 2) =       0.000395697319
  error estimate for blocks of size 2^( 3) =       0.000409645439
  error estimate for blocks of size 2^( 4) =       0.000419348073
  error estimate for blocks of size 2^( 5) =       0.000425497219
  error estimate for blocks of size 2^( 6) =       0.000428861517
  error estimate for blocks of size 2^( 7) =       0.000430369977

      target function =      -0.915858582435
              le_mean =     -17.207728745609
             les_mean =     296.403919962473
             stat err =       0.000426019197
             autocorr =       1.253281838625
   target nu stat err =       0.000426019197
   target dn stat err =       0.002570184569
      target stat err =       0.004062249861
              std dev =       0.538170382995
             le_variance =       0.289627361133


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720772874561e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915875681483       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915882363862       residual = 9.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915883337174       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915883731783       residual = 9.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915883779603       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915883925676       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915884003320       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915884020101       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915884057001       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915884057248       residual = 8.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915884096450       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915884114360       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915884136737       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915884169817       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915884122695       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915884130310       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915884166084       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915884193023       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915884194625       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915884216737       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915884220387       residual = 9.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915884216756       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915884220233       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915884227087       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915884232817       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915884228333       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915884225783       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915884219627       residual = 9.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915884219650       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915884222192       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915884222958       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915884227593       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915884228066       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915884226774       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915884228883       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915884227228       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+00 is 7.085448e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915875681483       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915877376401       residual = 9.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915877622162       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915877721830       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915877733776       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915877770731       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915877790350       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915877794525       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915877803765       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915877803876       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915877813868       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915877818492       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915877824068       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915877832214       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915877820262       residual = 7.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915877822297       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915877831461       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915877838106       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915877838450       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915877843992       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915877844763       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915877843877       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915877844816       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915877846528       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915877847873       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915877846745       residual = 7.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915877846078       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915877844587       residual = 8.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915877844582       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915877845213       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915877845416       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915877846559       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915877846658       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915877846355       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915877846863       residual = 9.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+01 is 1.766221e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915875681483       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915876106761       residual = 9.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915876168355       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915876193336       residual = 9.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915876196322       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915876205588       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915876210506       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915876211549       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915876213860       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915876213891       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915876216401       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915876217566       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915876218959       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915876220987       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915876217989       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915876218506       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915876220811       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915876222466       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915876222548       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915876223935       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915876224119       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915876223899       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915876224138       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915876224566       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915876224896       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915876224614       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915876224445       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915876224076       residual = 8.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915876224074       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915876224231       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915876224282       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915876224567       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915876224591       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915876224516       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915876224642       residual = 9.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e+01 is 4.416696e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.850940 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4986e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
  uu_0                 2.086324e-01 1 1  ON 0
  uu_1                 5.171857e-02 1 1  ON 1
  uu_2                -3.903434e-02 1 1  ON 2
  uu_3                -9.240747e-02 1 1  ON 3
  uu_4                -1.232226e-01 1 1  ON 4
  uu_5                -1.309091e-01 1 1  ON 5
  uu_6                -1.127490e-01 1 1  ON 6
  uu_7                -5.442186e-02 1 1  ON 7
  uu_8                 6.689897e-02 1 1  ON 8
  uu_9                 1.242975e-01 1 1  ON 9
  ud_0                 3.067564e-01 1 1  ON 10
  ud_1                 7.701138e-02 1 1  ON 11
  ud_2                -2.492877e-02 1 1  ON 12
  ud_3                -7.810286e-02 1 1  ON 13
  ud_4                -1.144404e-01 1 1  ON 14
  ud_5                -1.340987e-01 1 1  ON 15
  ud_6                -1.289823e-01 1 1  ON 16
  ud_7                -8.826842e-02 1 1  ON 17
  ud_8                -4.421836e-03 1 1  ON 18
  ud_9                 8.761123e-02 1 1  ON 19
  eO_0                -7.039625e-01 1 1  ON 20
  eO_1                -4.206844e-01 1 1  ON 21
  eO_2                -4.184218e-02 1 1  ON 22
  eO_3                 1.855320e-01 1 1  ON 23
  eO_4                 2.599092e-01 1 1  ON 24
  eO_5                 2.840177e-01 1 1  ON 25
  eO_6                 2.507194e-01 1 1  ON 26
  eO_7                 1.273050e-01 1 1  ON 27
  eO_8                 2.870282e-02 1 1  ON 28
  eO_9                 1.906545e-02 1 1  ON 29
 eH1_0                -2.022790e-01 1 1  ON 30
 eH1_1                -9.742391e-02 1 1  ON 31
 eH1_2                -4.632709e-02 1 1  ON 32
 eH1_3                -1.503657e-02 1 1  ON 33
 eH1_4                 1.853390e-02 1 1  ON 34
 eH1_5                 2.503455e-02 1 1  ON 35
 eH1_6                 7.418630e-02 1 1  ON 36
 eH1_7                 1.039697e-01 1 1  ON 37
 eH1_8                 9.804942e-02 1 1  ON 38
 eH1_9                 2.544869e-02 1 1  ON 39
 eH2_0                -2.031495e-01 1 1  ON 40
 eH2_1                -9.888199e-02 1 1  ON 41
 eH2_2                -4.808750e-02 1 1  ON 42
 eH2_3                -1.715083e-02 1 1  ON 43
 eH2_4                 1.621691e-02 1 1  ON 44
 eH2_5                 2.136290e-02 1 1  ON 45
 eH2_6                 7.609571e-02 1 1  ON 46
 eH2_7                 1.119927e-01 1 1  ON 47
 eH2_8                 1.007870e-01 1 1  ON 48
 eH2_9                 2.831622e-02 1 1  ON 49
ci_001                -4.240553e-02 3 1  ON 50
ci_002                -3.110465e-02 3 1  ON 51
ci_003                -1.186735e-02 3 1  ON 52
ci_004                 2.578636e-02 3 1  ON 53
ci_005                 2.616573e-02 3 1  ON 54
ci_006                -2.099819e-02 3 1  ON 55
ci_007                -2.031734e-02 3 1  ON 56
ci_008                -4.834763e-03 3 1  ON 57
ci_009                -1.577748e-02 3 1  ON 58
ci_010                -1.013505e-02 3 1  ON 59
ci_011                -9.944973e-03 3 1  ON 60
ci_012                -9.934444e-03 3 1  ON 61
ci_013                -2.148227e-02 3 1  ON 62
ci_014                 1.339756e-02 3 1  ON 63
ci_015                 1.342100e-02 3 1  ON 64
ci_016                 1.666507e-02 3 1  ON 65
ci_017                 1.635759e-02 3 1  ON 66
ci_018                 1.093800e-02 3 1  ON 67
ci_019                 1.082437e-02 3 1  ON 68
ci_020                 1.838773e-02 3 1  ON 69
ci_021                 1.794115e-02 3 1  ON 70
ci_022                 1.042207e-02 3 1  ON 71
ci_023                 1.057856e-02 3 1  ON 72
ci_024                 6.924202e-03 3 1  ON 73
ci_025                 6.746491e-03 3 1  ON 74
ci_026                 1.181198e-02 3 1  ON 75
ci_027                 1.178863e-02 3 1  ON 76
ci_028                -9.432302e-03 3 1  ON 77
ci_029                -1.026481e-02 3 1  ON 78
ci_030                -4.775085e-03 3 1  ON 79
ci_031                -4.909111e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.087
    reference variance = 0.225087
====================================================
  Execution time = 1.9394e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9687e-01
  Total weights = 1.9742e+06
  Execution time = 1.6228e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288751995777
                                         uncertainty =       0.001679711773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288751995777
                                         uncertainty =       0.001679711773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379932230
  error estimate for blocks of size 2^( 2) =       0.000394665697
  error estimate for blocks of size 2^( 3) =       0.000408277279
  error estimate for blocks of size 2^( 4) =       0.000418269444
  error estimate for blocks of size 2^( 5) =       0.000423929841
  error estimate for blocks of size 2^( 6) =       0.000426810067
  error estimate for blocks of size 2^( 7) =       0.000428781680

      target function =      -0.917617783486
              le_mean =     -17.206485262420
             les_mean =     296.360011652287
             stat err =       0.000424447758
             autocorr =       1.248062157024
   target nu stat err =       0.000424447758
   target dn stat err =       0.002350957839
      target stat err =       0.003732168310
              std dev =       0.537305312198
             le_variance =       0.288696998516

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288754024472
                                         uncertainty =       0.001680027028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288754024472
                                         uncertainty =       0.001680027028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379933573
  error estimate for blocks of size 2^( 2) =       0.000394671145
  error estimate for blocks of size 2^( 3) =       0.000408286887
  error estimate for blocks of size 2^( 4) =       0.000418282748
  error estimate for blocks of size 2^( 5) =       0.000423945483
  error estimate for blocks of size 2^( 6) =       0.000426825957
  error estimate for blocks of size 2^( 7) =       0.000428797177

      target function =      -0.917641517423
              le_mean =     -17.206485422329
             les_mean =     296.360001963319
             stat err =       0.000424462841
             autocorr =       1.248142033924
   target nu stat err =       0.000424462841
   target dn stat err =       0.002345145005
      target stat err =       0.003723479465
              std dev =       0.537307211897
             le_variance =       0.288699039956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288752988175
                                         uncertainty =       0.001679870883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288752988175
                                         uncertainty =       0.001679870883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379932887
  error estimate for blocks of size 2^( 2) =       0.000394668435
  error estimate for blocks of size 2^( 3) =       0.000408282123
  error estimate for blocks of size 2^( 4) =       0.000418276157
  error estimate for blocks of size 2^( 5) =       0.000423937738
  error estimate for blocks of size 2^( 6) =       0.000426818088
  error estimate for blocks of size 2^( 7) =       0.000428789500

      target function =      -0.917632691717
              le_mean =     -17.206485337881
             les_mean =     296.360004702156
             stat err =       0.000424455371
             autocorr =       1.248102607871
   target nu stat err =       0.000424455371
   target dn stat err =       0.002347865351
      target stat err =       0.003727563754
              std dev =       0.537306241739
             le_variance =       0.288697997412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288752115827
                                         uncertainty =       0.001679731593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288752115827
                                         uncertainty =       0.001679731593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379932309
  error estimate for blocks of size 2^( 2) =       0.000394666037
  error estimate for blocks of size 2^( 3) =       0.000408277883
  error estimate for blocks of size 2^( 4) =       0.000418270282
  error estimate for blocks of size 2^( 5) =       0.000423930828
  error estimate for blocks of size 2^( 6) =       0.000426811069
  error estimate for blocks of size 2^( 7) =       0.000428782657

      target function =      -0.917619946361
              le_mean =     -17.206485271327
             les_mean =     296.360010573421
             stat err =       0.000424448709
             autocorr =       1.248067228550
   target nu stat err =       0.000424448709
   target dn stat err =       0.002350550935
      target stat err =       0.003731564037
              std dev =       0.537305424676
             le_variance =       0.288697119386


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917617783486        initial
     3.9062e+00     3.9062e+01             7.0854e-05        -0.917641517423  <--
     1.5625e+01     1.5625e+02             1.7662e-05        -0.917632691717
     6.2500e+01     6.2500e+02             4.4167e-06        -0.917619946361

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 2.7653e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
  uu_0                 2.086433e-01 1 1  ON 0
  uu_1                 5.172522e-02 1 1  ON 1
  uu_2                -3.903201e-02 1 1  ON 2
  uu_3                -9.241028e-02 1 1  ON 3
  uu_4                -1.232240e-01 1 1  ON 4
  uu_5                -1.309050e-01 1 1  ON 5
  uu_6                -1.127477e-01 1 1  ON 6
  uu_7                -5.443007e-02 1 1  ON 7
  uu_8                 6.685432e-02 1 1  ON 8
  uu_9                 1.243127e-01 1 1  ON 9
  ud_0                 3.067279e-01 1 1  ON 10
  ud_1                 7.699489e-02 1 1  ON 11
  ud_2                -2.494687e-02 1 1  ON 12
  ud_3                -7.811647e-02 1 1  ON 13
  ud_4                -1.144509e-01 1 1  ON 14
  ud_5                -1.340857e-01 1 1  ON 15
  ud_6                -1.289557e-01 1 1  ON 16
  ud_7                -8.824410e-02 1 1  ON 17
  ud_8                -4.410301e-03 1 1  ON 18
  ud_9                 8.760385e-02 1 1  ON 19
  eO_0                -7.039615e-01 1 1  ON 20
  eO_1                -4.206719e-01 1 1  ON 21
  eO_2                -4.183481e-02 1 1  ON 22
  eO_3                 1.855167e-01 1 1  ON 23
  eO_4                 2.598837e-01 1 1  ON 24
  eO_5                 2.839677e-01 1 1  ON 25
  eO_6                 2.507335e-01 1 1  ON 26
  eO_7                 1.273582e-01 1 1  ON 27
  eO_8                 2.870465e-02 1 1  ON 28
  eO_9                 1.906586e-02 1 1  ON 29
 eH1_0                -2.023024e-01 1 1  ON 30
 eH1_1                -9.741858e-02 1 1  ON 31
 eH1_2                -4.631667e-02 1 1  ON 32
 eH1_3                -1.503081e-02 1 1  ON 33
 eH1_4                 1.854395e-02 1 1  ON 34
 eH1_5                 2.500571e-02 1 1  ON 35
 eH1_6                 7.415692e-02 1 1  ON 36
 eH1_7                 1.039918e-01 1 1  ON 37
 eH1_8                 9.807640e-02 1 1  ON 38
 eH1_9                 2.544718e-02 1 1  ON 39
 eH2_0                -2.031668e-01 1 1  ON 40
 eH2_1                -9.888493e-02 1 1  ON 41
 eH2_2                -4.807681e-02 1 1  ON 42
 eH2_3                -1.714520e-02 1 1  ON 43
 eH2_4                 1.621886e-02 1 1  ON 44
 eH2_5                 2.136943e-02 1 1  ON 45
 eH2_6                 7.607193e-02 1 1  ON 46
 eH2_7                 1.119929e-01 1 1  ON 47
 eH2_8                 1.008057e-01 1 1  ON 48
 eH2_9                 2.831717e-02 1 1  ON 49
ci_001                -4.238967e-02 3 1  ON 50
ci_002                -3.110013e-02 3 1  ON 51
ci_003                -1.185981e-02 3 1  ON 52
ci_004                 2.579018e-02 3 1  ON 53
ci_005                 2.614747e-02 3 1  ON 54
ci_006                -2.099428e-02 3 1  ON 55
ci_007                -2.033187e-02 3 1  ON 56
ci_008                -4.843748e-03 3 1  ON 57
ci_009                -1.577551e-02 3 1  ON 58
ci_010                -1.011149e-02 3 1  ON 59
ci_011                -9.931524e-03 3 1  ON 60
ci_012                -9.932940e-03 3 1  ON 61
ci_013                -2.148815e-02 3 1  ON 62
ci_014                 1.339417e-02 3 1  ON 63
ci_015                 1.343293e-02 3 1  ON 64
ci_016                 1.663803e-02 3 1  ON 65
ci_017                 1.635890e-02 3 1  ON 66
ci_018                 1.093815e-02 3 1  ON 67
ci_019                 1.082142e-02 3 1  ON 68
ci_020                 1.837237e-02 3 1  ON 69
ci_021                 1.793728e-02 3 1  ON 70
ci_022                 1.042493e-02 3 1  ON 71
ci_023                 1.056952e-02 3 1  ON 72
ci_024                 6.912859e-03 3 1  ON 73
ci_025                 6.731176e-03 3 1  ON 74
ci_026                 1.179574e-02 3 1  ON 75
ci_027                 1.177718e-02 3 1  ON 76
ci_028                -9.432145e-03 3 1  ON 77
ci_029                -1.026075e-02 3 1  ON 78
ci_030                -4.754846e-03 3 1  ON 79
ci_031                -4.890980e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2645e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7183e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.0977
    reference variance = 1.01481
====================================================
  Execution time = 1.9696e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5409e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9893e-01
  Total weights = 1.973862300e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5588e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291752619286
                                         uncertainty =       0.001854665696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291752619286
                                         uncertainty =       0.001854665696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381930785
  error estimate for blocks of size 2^( 2) =       0.000397072632
  error estimate for blocks of size 2^( 3) =       0.000411138553
  error estimate for blocks of size 2^( 4) =       0.000421280922
  error estimate for blocks of size 2^( 5) =       0.000426815907
  error estimate for blocks of size 2^( 6) =       0.000429979511
  error estimate for blocks of size 2^( 7) =       0.000431625671

      target function =      -0.914427695322
              le_mean =     -17.206754297705
             les_mean =     296.371321766322
             stat err =       0.000427425503
             autocorr =       1.252424433943
   target nu stat err =       0.000427425503
   target dn stat err =       0.002357076689
      target stat err =       0.003718859841
              std dev =       0.540131695978
             le_variance =       0.291742249000


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720675429771e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914441824512       residual = 4.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914462583745       residual = 8.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914465254344       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914467009329       residual = 7.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914467141662       residual = 7.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914467605323       residual = 8.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914467997148       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914468270744       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914468769962       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914468909242       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914469064142       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914469242212       residual = 9.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914469362501       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914469660490       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914469851817       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914469869698       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914470036734       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914469945966       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914470001299       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914470139272       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914470188627       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914470172626       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914470211131       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914470257451       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914470268685       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914470307664       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914470332059       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914470333088       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914470335799       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914470344251       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914470331002       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914470319413       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914470320498       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914470329660       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914470338427       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914470340529       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914470336854       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.914470328098       residual = 7.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e-01 is 4.539894e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914441824512       residual = 4.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914447313520       residual = 8.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914448013485       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914448471414       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914448505422       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914448628740       residual = 8.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914448729057       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914448800495       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914448927340       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914448964227       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914449004968       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914449050445       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914449080726       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914449157209       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914449204943       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914449207453       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914449249629       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914449226217       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914449241871       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914449276527       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914449286174       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914449282290       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914449291272       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914449302306       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914449305863       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914449313950       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914449319847       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914449319388       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914449322245       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914449322205       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914449318754       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914449316525       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914449316873       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914449319322       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914449321090       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914449321327       residual = 8.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+00 is 1.138096e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914441824512       residual = 4.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914443216831       residual = 8.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914443393965       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914443509705       residual = 6.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914443518290       residual = 7.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914443549645       residual = 8.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914443574827       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914443592894       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914443624726       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914443634084       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914443644403       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914443655830       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914443663413       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914443682659       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914443694576       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914443695075       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914443705643       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914443699748       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914443703789       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914443712448       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914443714672       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914443713725       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914443715924       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914443718656       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914443719588       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914443721496       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914443722966       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914443722794       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914443723681       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914443723313       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914443722318       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914443722199       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914443722208       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914443722844       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914443723251       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914443723296       residual = 7.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+01 is 2.849873e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.905355 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5315e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
  uu_0                 2.086649e-01 1 1  ON 0
  uu_1                 5.175024e-02 1 1  ON 1
  uu_2                -3.901193e-02 1 1  ON 2
  uu_3                -9.240218e-02 1 1  ON 3
  uu_4                -1.232110e-01 1 1  ON 4
  uu_5                -1.308919e-01 1 1  ON 5
  uu_6                -1.127640e-01 1 1  ON 6
  uu_7                -5.445312e-02 1 1  ON 7
  uu_8                 6.674051e-02 1 1  ON 8
  uu_9                 1.243257e-01 1 1  ON 9
  ud_0                 3.067001e-01 1 1  ON 10
  ud_1                 7.696525e-02 1 1  ON 11
  ud_2                -2.497437e-02 1 1  ON 12
  ud_3                -7.814417e-02 1 1  ON 13
  ud_4                -1.144650e-01 1 1  ON 14
  ud_5                -1.340674e-01 1 1  ON 15
  ud_6                -1.288976e-01 1 1  ON 16
  ud_7                -8.820689e-02 1 1  ON 17
  ud_8                -4.422500e-03 1 1  ON 18
  ud_9                 8.760578e-02 1 1  ON 19
  eO_0                -7.039791e-01 1 1  ON 20
  eO_1                -4.206847e-01 1 1  ON 21
  eO_2                -4.184292e-02 1 1  ON 22
  eO_3                 1.854989e-01 1 1  ON 23
  eO_4                 2.598625e-01 1 1  ON 24
  eO_5                 2.839564e-01 1 1  ON 25
  eO_6                 2.507473e-01 1 1  ON 26
  eO_7                 1.274260e-01 1 1  ON 27
  eO_8                 2.871007e-02 1 1  ON 28
  eO_9                 1.906635e-02 1 1  ON 29
 eH1_0                -2.022870e-01 1 1  ON 30
 eH1_1                -9.740534e-02 1 1  ON 31
 eH1_2                -4.630685e-02 1 1  ON 32
 eH1_3                -1.502643e-02 1 1  ON 33
 eH1_4                 1.851707e-02 1 1  ON 34
 eH1_5                 2.491717e-02 1 1  ON 35
 eH1_6                 7.413513e-02 1 1  ON 36
 eH1_7                 1.040398e-01 1 1  ON 37
 eH1_8                 9.811469e-02 1 1  ON 38
 eH1_9                 2.545546e-02 1 1  ON 39
 eH2_0                -2.032215e-01 1 1  ON 40
 eH2_1                -9.888410e-02 1 1  ON 41
 eH2_2                -4.805566e-02 1 1  ON 42
 eH2_3                -1.712366e-02 1 1  ON 43
 eH2_4                 1.623846e-02 1 1  ON 44
 eH2_5                 2.133909e-02 1 1  ON 45
 eH2_6                 7.603076e-02 1 1  ON 46
 eH2_7                 1.120185e-01 1 1  ON 47
 eH2_8                 1.008361e-01 1 1  ON 48
 eH2_9                 2.832371e-02 1 1  ON 49
ci_001                -4.239481e-02 3 1  ON 50
ci_002                -3.109401e-02 3 1  ON 51
ci_003                -1.183207e-02 3 1  ON 52
ci_004                 2.579504e-02 3 1  ON 53
ci_005                 2.615019e-02 3 1  ON 54
ci_006                -2.098711e-02 3 1  ON 55
ci_007                -2.033324e-02 3 1  ON 56
ci_008                -4.842652e-03 3 1  ON 57
ci_009                -1.577313e-02 3 1  ON 58
ci_010                -1.011289e-02 3 1  ON 59
ci_011                -9.926060e-03 3 1  ON 60
ci_012                -9.917049e-03 3 1  ON 61
ci_013                -2.147052e-02 3 1  ON 62
ci_014                 1.339098e-02 3 1  ON 63
ci_015                 1.346630e-02 3 1  ON 64
ci_016                 1.662432e-02 3 1  ON 65
ci_017                 1.634266e-02 3 1  ON 66
ci_018                 1.090826e-02 3 1  ON 67
ci_019                 1.083657e-02 3 1  ON 68
ci_020                 1.835868e-02 3 1  ON 69
ci_021                 1.793192e-02 3 1  ON 70
ci_022                 1.041752e-02 3 1  ON 71
ci_023                 1.056866e-02 3 1  ON 72
ci_024                 6.920802e-03 3 1  ON 73
ci_025                 6.733075e-03 3 1  ON 74
ci_026                 1.178451e-02 3 1  ON 75
ci_027                 1.176569e-02 3 1  ON 76
ci_028                -9.432958e-03 3 1  ON 77
ci_029                -1.024409e-02 3 1  ON 78
ci_030                -4.734813e-03 3 1  ON 79
ci_031                -4.877884e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2026
    reference variance = 0.347778
====================================================
  Execution time = 1.9251e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.1080e-01
  Total weights = 1.9737e+06
  Execution time = 1.6169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297268458038
                                         uncertainty =       0.002972020156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297268458038
                                         uncertainty =       0.002972020156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385524900
  error estimate for blocks of size 2^( 2) =       0.000400495933
  error estimate for blocks of size 2^( 3) =       0.000414003619
  error estimate for blocks of size 2^( 4) =       0.000423636379
  error estimate for blocks of size 2^( 5) =       0.000428422546
  error estimate for blocks of size 2^( 6) =       0.000431559558
  error estimate for blocks of size 2^( 7) =       0.000432895798

      target function =      -0.896299456291
              le_mean =     -17.206878913406
             les_mean =     296.387495760595
             stat err =       0.000429128570
             autocorr =       1.238996250206
   target nu stat err =       0.000429128570
   target dn stat err =       0.006522772974
      target stat err =       0.009727714251
              std dev =       0.545214542826
             le_variance =       0.297258897709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297329282229
                                         uncertainty =       0.002996048762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297329282229
                                         uncertainty =       0.002996048762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385564343
  error estimate for blocks of size 2^( 2) =       0.000400546106
  error estimate for blocks of size 2^( 3) =       0.000414066172
  error estimate for blocks of size 2^( 4) =       0.000423707857
  error estimate for blocks of size 2^( 5) =       0.000428496183
  error estimate for blocks of size 2^( 6) =       0.000431635565
  error estimate for blocks of size 2^( 7) =       0.000432972209

      target function =      -0.891658742277
              le_mean =     -17.206878109204
             les_mean =     296.390587331045
             stat err =       0.000429202954
             autocorr =       1.239172243665
   target nu stat err =       0.000429202954
   target dn stat err =       0.007306857947
      target stat err =       0.010779173984
              std dev =       0.545270322831
             le_variance =       0.297319724960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297299707786
                                         uncertainty =       0.002984516512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297299707786
                                         uncertainty =       0.002984516512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385545166
  error estimate for blocks of size 2^( 2) =       0.000400521696
  error estimate for blocks of size 2^( 3) =       0.000414035837
  error estimate for blocks of size 2^( 4) =       0.000423673207
  error estimate for blocks of size 2^( 5) =       0.000428460480
  error estimate for blocks of size 2^( 6) =       0.000431598761
  error estimate for blocks of size 2^( 7) =       0.000432935231

      target function =      -0.896293698726
              le_mean =     -17.206878386216
             les_mean =     296.387480745503
             stat err =       0.000429166920
             autocorr =       1.239087439130
   target nu stat err =       0.000429166920
   target dn stat err =       0.006558150690
      target stat err =       0.009780074845
              std dev =       0.545243202252
             le_variance =       0.297290149602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297272325660
                                         uncertainty =       0.002973585476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297272325660
                                         uncertainty =       0.002973585476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385527409
  error estimate for blocks of size 2^( 2) =       0.000400499136
  error estimate for blocks of size 2^( 3) =       0.000414007639
  error estimate for blocks of size 2^( 4) =       0.000423640982
  error estimate for blocks of size 2^( 5) =       0.000428427288
  error estimate for blocks of size 2^( 6) =       0.000431564462
  error estimate for blocks of size 2^( 7) =       0.000432900736

      target function =      -0.896305123695
              le_mean =     -17.206878839847
             les_mean =     296.387489327071
             stat err =       0.000429133367
             autocorr =       1.239007826485
   target nu stat err =       0.000429133367
   target dn stat err =       0.006527114181
      target stat err =       0.009734277363
              std dev =       0.545218089986
             le_variance =       0.297262765648


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.896299456291        initial
     9.7656e-01     9.7656e+00             4.5399e-04        -0.891658742277
     3.9062e+00     3.9062e+01             1.1381e-04        -0.896293698726
     1.5625e+01     1.5625e+02             2.8499e-05        -0.896305123695  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 2.7397e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
  uu_0                 2.086487e-01 1 1  ON 0
  uu_1                 5.173151e-02 1 1  ON 1
  uu_2                -3.902697e-02 1 1  ON 2
  uu_3                -9.240827e-02 1 1  ON 3
  uu_4                -1.232207e-01 1 1  ON 4
  uu_5                -1.309017e-01 1 1  ON 5
  uu_6                -1.127518e-01 1 1  ON 6
  uu_7                -5.443583e-02 1 1  ON 7
  uu_8                 6.682582e-02 1 1  ON 8
  uu_9                 1.243159e-01 1 1  ON 9
  ud_0                 3.067209e-01 1 1  ON 10
  ud_1                 7.698743e-02 1 1  ON 11
  ud_2                -2.495379e-02 1 1  ON 12
  ud_3                -7.812344e-02 1 1  ON 13
  ud_4                -1.144545e-01 1 1  ON 14
  ud_5                -1.340811e-01 1 1  ON 15
  ud_6                -1.289411e-01 1 1  ON 16
  ud_7                -8.823478e-02 1 1  ON 17
  ud_8                -4.413381e-03 1 1  ON 18
  ud_9                 8.760433e-02 1 1  ON 19
  eO_0                -7.039659e-01 1 1  ON 20
  eO_1                -4.206751e-01 1 1  ON 21
  eO_2                -4.183680e-02 1 1  ON 22
  eO_3                 1.855123e-01 1 1  ON 23
  eO_4                 2.598783e-01 1 1  ON 24
  eO_5                 2.839649e-01 1 1  ON 25
  eO_6                 2.507370e-01 1 1  ON 26
  eO_7                 1.273752e-01 1 1  ON 27
  eO_8                 2.870601e-02 1 1  ON 28
  eO_9                 1.906599e-02 1 1  ON 29
 eH1_0                -2.022985e-01 1 1  ON 30
 eH1_1                -9.741523e-02 1 1  ON 31
 eH1_2                -4.631419e-02 1 1  ON 32
 eH1_3                -1.502969e-02 1 1  ON 33
 eH1_4                 1.853720e-02 1 1  ON 34
 eH1_5                 2.498344e-02 1 1  ON 35
 eH1_6                 7.415151e-02 1 1  ON 36
 eH1_7                 1.040038e-01 1 1  ON 37
 eH1_8                 9.808597e-02 1 1  ON 38
 eH1_9                 2.544925e-02 1 1  ON 39
 eH2_0                -2.031806e-01 1 1  ON 40
 eH2_1                -9.888472e-02 1 1  ON 41
 eH2_2                -4.807146e-02 1 1  ON 42
 eH2_3                -1.713975e-02 1 1  ON 43
 eH2_4                 1.622382e-02 1 1  ON 44
 eH2_5                 2.136180e-02 1 1  ON 45
 eH2_6                 7.606163e-02 1 1  ON 46
 eH2_7                 1.119993e-01 1 1  ON 47
 eH2_8                 1.008133e-01 1 1  ON 48
 eH2_9                 2.831880e-02 1 1  ON 49
ci_001                -4.239096e-02 3 1  ON 50
ci_002                -3.109858e-02 3 1  ON 51
ci_003                -1.185278e-02 3 1  ON 52
ci_004                 2.579141e-02 3 1  ON 53
ci_005                 2.614817e-02 3 1  ON 54
ci_006                -2.099247e-02 3 1  ON 55
ci_007                -2.033221e-02 3 1  ON 56
ci_008                -4.843469e-03 3 1  ON 57
ci_009                -1.577491e-02 3 1  ON 58
ci_010                -1.011184e-02 3 1  ON 59
ci_011                -9.930139e-03 3 1  ON 60
ci_012                -9.928912e-03 3 1  ON 61
ci_013                -2.148369e-02 3 1  ON 62
ci_014                 1.339336e-02 3 1  ON 63
ci_015                 1.344138e-02 3 1  ON 64
ci_016                 1.663456e-02 3 1  ON 65
ci_017                 1.635479e-02 3 1  ON 66
ci_018                 1.093057e-02 3 1  ON 67
ci_019                 1.082527e-02 3 1  ON 68
ci_020                 1.836890e-02 3 1  ON 69
ci_021                 1.793593e-02 3 1  ON 70
ci_022                 1.042305e-02 3 1  ON 71
ci_023                 1.056930e-02 3 1  ON 72
ci_024                 6.914868e-03 3 1  ON 73
ci_025                 6.731657e-03 3 1  ON 74
ci_026                 1.179289e-02 3 1  ON 75
ci_027                 1.177427e-02 3 1  ON 76
ci_028                -9.432348e-03 3 1  ON 77
ci_029                -1.025654e-02 3 1  ON 78
ci_030                -4.749763e-03 3 1  ON 79
ci_031                -4.887657e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2719e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7180e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2039
    reference variance = 0.312338
====================================================
  Execution time = 1.9684e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5411e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0468e-01
  Total weights = 1.973988342e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5339e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294056742934
                                         uncertainty =       0.004359867939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294056742934
                                         uncertainty =       0.004359867939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383487424
  error estimate for blocks of size 2^( 2) =       0.000398692946
  error estimate for blocks of size 2^( 3) =       0.000412678630
  error estimate for blocks of size 2^( 4) =       0.000423486385
  error estimate for blocks of size 2^( 5) =       0.000430219763
  error estimate for blocks of size 2^( 6) =       0.000434152187
  error estimate for blocks of size 2^( 7) =       0.000438057386

      target function =      -0.905512258940
              le_mean =     -17.206399976291
             les_mean =     296.364878581819
             stat err =       0.000431478930
             autocorr =       1.265951107498
   target nu stat err =       0.000431478930
   target dn stat err =       0.007152786728
      target stat err =       0.010873199519
              std dev =       0.542333116543
             le_variance =       0.294125209300


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720639997629e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905640993856       residual = 2.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905663186140       residual = 8.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905672945811       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905675178424       residual = 5.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905675643063       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905675897338       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905676011568       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905676374427       residual = 8.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905676396935       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905676575076       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905676784941       residual = 9.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.905677280804       residual = 6.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.905677381600       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.905677585945       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.905677906877       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.905678024426       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.905678177058       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.905678193368       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.905678186989       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.905678196688       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.905678184901       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.905678176146       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.905678201727       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.905678224920       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.905678223924       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.905678227706       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.905678230681       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.905678225558       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.905678229373       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.905678224432       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.905678227665       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.905678229888       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.905678229079       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.905678233599       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.905678232908       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.905678237188       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.905678236856       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.905678238297       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.905678236115       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+00 is 3.752305e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905640993856       residual = 2.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905646619066       residual = 8.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905649093271       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905649657629       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905649773466       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905649837481       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905649866116       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905649957877       residual = 7.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905649963616       residual = 5.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905650008606       residual = 7.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905650061944       residual = 9.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.905650187077       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.905650212045       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.905650263248       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.905650343270       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.905650372157       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.905650410079       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.905650413737       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.905650412069       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.905650414390       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.905650411318       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.905650409214       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.905650415644       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.905650421165       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.905650420998       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.905650421912       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.905650422581       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.905650421359       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.905650422216       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.905650420986       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.905650421939       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.905650422357       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.905650422182       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.905650423310       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.905650423108       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.905650424168       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.905650424080       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.905650424447       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.905650423882       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+01 is 9.409036e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905640993856       residual = 2.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905642405064       residual = 8.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905643025795       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905643167279       residual = 5.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905643196216       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905643212247       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905643219411       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905643242418       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905643243860       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905643255136       residual = 7.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905643268526       residual = 9.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.905643299882       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.905643306110       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.905643318917       residual = 6.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.905643338908       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.905643346099       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.905643355564       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.905643356452       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.905643356031       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.905643356604       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.905643355828       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.905643355308       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.905643356918       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.905643358280       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.905643358244       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.905643358470       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.905643358633       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.905643358331       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.905643358539       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.905643358233       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.905643358479       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.905643358575       residual = 9.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.905643358534       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.905643358815       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.905643358763       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.905643359027       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.905643359005       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.905643359097       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.905643358955       residual = 7.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e+01 is 2.354034e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.969582 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5288e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
  uu_0                 2.086672e-01 1 1  ON 0
  uu_1                 5.174503e-02 1 1  ON 1
  uu_2                -3.902148e-02 1 1  ON 2
  uu_3                -9.240328e-02 1 1  ON 3
  uu_4                -1.232149e-01 1 1  ON 4
  uu_5                -1.309038e-01 1 1  ON 5
  uu_6                -1.127623e-01 1 1  ON 6
  uu_7                -5.445692e-02 1 1  ON 7
  uu_8                 6.680062e-02 1 1  ON 8
  uu_9                 1.243229e-01 1 1  ON 9
  ud_0                 3.067227e-01 1 1  ON 10
  ud_1                 7.699038e-02 1 1  ON 11
  ud_2                -2.496257e-02 1 1  ON 12
  ud_3                -7.813182e-02 1 1  ON 13
  ud_4                -1.144550e-01 1 1  ON 14
  ud_5                -1.340688e-01 1 1  ON 15
  ud_6                -1.289325e-01 1 1  ON 16
  ud_7                -8.822476e-02 1 1  ON 17
  ud_8                -4.429990e-03 1 1  ON 18
  ud_9                 8.759580e-02 1 1  ON 19
  eO_0                -7.039761e-01 1 1  ON 20
  eO_1                -4.206721e-01 1 1  ON 21
  eO_2                -4.183136e-02 1 1  ON 22
  eO_3                 1.855005e-01 1 1  ON 23
  eO_4                 2.598678e-01 1 1  ON 24
  eO_5                 2.839705e-01 1 1  ON 25
  eO_6                 2.507439e-01 1 1  ON 26
  eO_7                 1.273853e-01 1 1  ON 27
  eO_8                 2.870704e-02 1 1  ON 28
  eO_9                 1.906578e-02 1 1  ON 29
 eH1_0                -2.023079e-01 1 1  ON 30
 eH1_1                -9.742414e-02 1 1  ON 31
 eH1_2                -4.631207e-02 1 1  ON 32
 eH1_3                -1.502722e-02 1 1  ON 33
 eH1_4                 1.854443e-02 1 1  ON 34
 eH1_5                 2.499099e-02 1 1  ON 35
 eH1_6                 7.414481e-02 1 1  ON 36
 eH1_7                 1.040017e-01 1 1  ON 37
 eH1_8                 9.809136e-02 1 1  ON 38
 eH1_9                 2.545201e-02 1 1  ON 39
 eH2_0                -2.032062e-01 1 1  ON 40
 eH2_1                -9.890071e-02 1 1  ON 41
 eH2_2                -4.808838e-02 1 1  ON 42
 eH2_3                -1.716649e-02 1 1  ON 43
 eH2_4                 1.619310e-02 1 1  ON 44
 eH2_5                 2.137196e-02 1 1  ON 45
 eH2_6                 7.615572e-02 1 1  ON 46
 eH2_7                 1.120034e-01 1 1  ON 47
 eH2_8                 1.008203e-01 1 1  ON 48
 eH2_9                 2.831940e-02 1 1  ON 49
ci_001                -4.238874e-02 3 1  ON 50
ci_002                -3.110241e-02 3 1  ON 51
ci_003                -1.185811e-02 3 1  ON 52
ci_004                 2.578757e-02 3 1  ON 53
ci_005                 2.614755e-02 3 1  ON 54
ci_006                -2.099128e-02 3 1  ON 55
ci_007                -2.033491e-02 3 1  ON 56
ci_008                -4.846204e-03 3 1  ON 57
ci_009                -1.577101e-02 3 1  ON 58
ci_010                -1.009705e-02 3 1  ON 59
ci_011                -9.919539e-03 3 1  ON 60
ci_012                -9.922044e-03 3 1  ON 61
ci_013                -2.149061e-02 3 1  ON 62
ci_014                 1.339439e-02 3 1  ON 63
ci_015                 1.344603e-02 3 1  ON 64
ci_016                 1.662745e-02 3 1  ON 65
ci_017                 1.635641e-02 3 1  ON 66
ci_018                 1.091874e-02 3 1  ON 67
ci_019                 1.082001e-02 3 1  ON 68
ci_020                 1.837154e-02 3 1  ON 69
ci_021                 1.794728e-02 3 1  ON 70
ci_022                 1.041393e-02 3 1  ON 71
ci_023                 1.057039e-02 3 1  ON 72
ci_024                 6.919897e-03 3 1  ON 73
ci_025                 6.733106e-03 3 1  ON 74
ci_026                 1.178663e-02 3 1  ON 75
ci_027                 1.176529e-02 3 1  ON 76
ci_028                -9.433531e-03 3 1  ON 77
ci_029                -1.023437e-02 3 1  ON 78
ci_030                -4.749986e-03 3 1  ON 79
ci_031                -4.883189e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1058
    reference variance = 0.237455
====================================================
  Execution time = 1.9454e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9675e-01
  Total weights = 1.9737e+06
  Execution time = 1.6140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289463137275
                                         uncertainty =       0.002076722666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289463137275
                                         uncertainty =       0.002076722666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380413813
  error estimate for blocks of size 2^( 2) =       0.000395285410
  error estimate for blocks of size 2^( 3) =       0.000409482059
  error estimate for blocks of size 2^( 4) =       0.000419512309
  error estimate for blocks of size 2^( 5) =       0.000425247763
  error estimate for blocks of size 2^( 6) =       0.000426640009
  error estimate for blocks of size 2^( 7) =       0.000427829305

      target function =      -0.917798831243
              le_mean =     -17.206546646849
             les_mean =     296.362006952197
             stat err =       0.000424807346
             autocorr =       1.247014433174
   target nu stat err =       0.000424807346
   target dn stat err =       0.002387793876
      target stat err =       0.003790499845
              std dev =       0.537986374173
             le_variance =       0.289429338796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289489447885
                                         uncertainty =       0.002076795862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289489447885
                                         uncertainty =       0.002076795862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380431113
  error estimate for blocks of size 2^( 2) =       0.000395306287
  error estimate for blocks of size 2^( 3) =       0.000409507054
  error estimate for blocks of size 2^( 4) =       0.000419540751
  error estimate for blocks of size 2^( 5) =       0.000425279807
  error estimate for blocks of size 2^( 6) =       0.000426670886
  error estimate for blocks of size 2^( 7) =       0.000427861661

      target function =      -0.917052543945
              le_mean =     -17.206546309855
             les_mean =     296.362474277976
             stat err =       0.000424838276
             autocorr =       1.247082604027
   target nu stat err =       0.000424838276
   target dn stat err =       0.002430913639
      target stat err =       0.003850342790
              std dev =       0.538010838925
             le_variance =       0.289455662800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289476286693
                                         uncertainty =       0.002076751602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289476286693
                                         uncertainty =       0.002076751602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380422459
  error estimate for blocks of size 2^( 2) =       0.000395295865
  error estimate for blocks of size 2^( 3) =       0.000409494609
  error estimate for blocks of size 2^( 4) =       0.000419526619
  error estimate for blocks of size 2^( 5) =       0.000425263883
  error estimate for blocks of size 2^( 6) =       0.000426655535
  error estimate for blocks of size 2^( 7) =       0.000427845544

      target function =      -0.917808410534
              le_mean =     -17.206546479990
             les_mean =     296.361995073321
             stat err =       0.000424822895
             autocorr =       1.247049036344
   target nu stat err =       0.000424822895
   target dn stat err =       0.002386743436
      target stat err =       0.003788974187
              std dev =       0.537998601394
             le_variance =       0.289442495102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289464767311
                                         uncertainty =       0.002076725403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289464767311
                                         uncertainty =       0.002076725403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380414885
  error estimate for blocks of size 2^( 2) =       0.000395286709
  error estimate for blocks of size 2^( 3) =       0.000409483621
  error estimate for blocks of size 2^( 4) =       0.000419514090
  error estimate for blocks of size 2^( 5) =       0.000425249771
  error estimate for blocks of size 2^( 6) =       0.000426641943
  error estimate for blocks of size 2^( 7) =       0.000427831329

      target function =      -0.917806259800
              le_mean =     -17.206546623527
             les_mean =     296.362001384656
             stat err =       0.000424809283
             autocorr =       1.247018779396
   target nu stat err =       0.000424809283
   target dn stat err =       0.002387598903
      target stat err =       0.003790262241
              std dev =       0.537987889930
             le_variance =       0.289430969711


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917798831243        initial
     3.9062e+00     3.9062e+01             3.7523e-04        -0.917052543945
     1.5625e+01     1.5625e+02             9.4090e-05        -0.917808410534  <--
     6.2500e+01     6.2500e+02             2.3540e-05        -0.917806259800

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 2.7570e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
  uu_0                 2.086672e-01 1 1  ON 0
  uu_1                 5.174503e-02 1 1  ON 1
  uu_2                -3.902148e-02 1 1  ON 2
  uu_3                -9.240328e-02 1 1  ON 3
  uu_4                -1.232149e-01 1 1  ON 4
  uu_5                -1.309038e-01 1 1  ON 5
  uu_6                -1.127623e-01 1 1  ON 6
  uu_7                -5.445692e-02 1 1  ON 7
  uu_8                 6.680062e-02 1 1  ON 8
  uu_9                 1.243229e-01 1 1  ON 9
  ud_0                 3.067227e-01 1 1  ON 10
  ud_1                 7.699038e-02 1 1  ON 11
  ud_2                -2.496257e-02 1 1  ON 12
  ud_3                -7.813182e-02 1 1  ON 13
  ud_4                -1.144550e-01 1 1  ON 14
  ud_5                -1.340688e-01 1 1  ON 15
  ud_6                -1.289325e-01 1 1  ON 16
  ud_7                -8.822476e-02 1 1  ON 17
  ud_8                -4.429990e-03 1 1  ON 18
  ud_9                 8.759580e-02 1 1  ON 19
  eO_0                -7.039761e-01 1 1  ON 20
  eO_1                -4.206721e-01 1 1  ON 21
  eO_2                -4.183136e-02 1 1  ON 22
  eO_3                 1.855005e-01 1 1  ON 23
  eO_4                 2.598678e-01 1 1  ON 24
  eO_5                 2.839705e-01 1 1  ON 25
  eO_6                 2.507439e-01 1 1  ON 26
  eO_7                 1.273853e-01 1 1  ON 27
  eO_8                 2.870704e-02 1 1  ON 28
  eO_9                 1.906578e-02 1 1  ON 29
 eH1_0                -2.023079e-01 1 1  ON 30
 eH1_1                -9.742414e-02 1 1  ON 31
 eH1_2                -4.631207e-02 1 1  ON 32
 eH1_3                -1.502722e-02 1 1  ON 33
 eH1_4                 1.854443e-02 1 1  ON 34
 eH1_5                 2.499099e-02 1 1  ON 35
 eH1_6                 7.414481e-02 1 1  ON 36
 eH1_7                 1.040017e-01 1 1  ON 37
 eH1_8                 9.809136e-02 1 1  ON 38
 eH1_9                 2.545201e-02 1 1  ON 39
 eH2_0                -2.032062e-01 1 1  ON 40
 eH2_1                -9.890071e-02 1 1  ON 41
 eH2_2                -4.808838e-02 1 1  ON 42
 eH2_3                -1.716649e-02 1 1  ON 43
 eH2_4                 1.619310e-02 1 1  ON 44
 eH2_5                 2.137196e-02 1 1  ON 45
 eH2_6                 7.615572e-02 1 1  ON 46
 eH2_7                 1.120034e-01 1 1  ON 47
 eH2_8                 1.008203e-01 1 1  ON 48
 eH2_9                 2.831940e-02 1 1  ON 49
ci_001                -4.238874e-02 3 1  ON 50
ci_002                -3.110241e-02 3 1  ON 51
ci_003                -1.185811e-02 3 1  ON 52
ci_004                 2.578757e-02 3 1  ON 53
ci_005                 2.614755e-02 3 1  ON 54
ci_006                -2.099128e-02 3 1  ON 55
ci_007                -2.033491e-02 3 1  ON 56
ci_008                -4.846204e-03 3 1  ON 57
ci_009                -1.577101e-02 3 1  ON 58
ci_010                -1.009705e-02 3 1  ON 59
ci_011                -9.919539e-03 3 1  ON 60
ci_012                -9.922044e-03 3 1  ON 61
ci_013                -2.149061e-02 3 1  ON 62
ci_014                 1.339439e-02 3 1  ON 63
ci_015                 1.344603e-02 3 1  ON 64
ci_016                 1.662745e-02 3 1  ON 65
ci_017                 1.635641e-02 3 1  ON 66
ci_018                 1.091874e-02 3 1  ON 67
ci_019                 1.082001e-02 3 1  ON 68
ci_020                 1.837154e-02 3 1  ON 69
ci_021                 1.794728e-02 3 1  ON 70
ci_022                 1.041393e-02 3 1  ON 71
ci_023                 1.057039e-02 3 1  ON 72
ci_024                 6.919897e-03 3 1  ON 73
ci_025                 6.733106e-03 3 1  ON 74
ci_026                 1.178663e-02 3 1  ON 75
ci_027                 1.176529e-02 3 1  ON 76
ci_028                -9.433531e-03 3 1  ON 77
ci_029                -1.023437e-02 3 1  ON 78
ci_030                -4.749986e-03 3 1  ON 79
ci_031                -4.883189e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2864e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7179e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2022
    reference variance = 0.187485
====================================================
  Execution time = 1.9459e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5426e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9943e-01
  Total weights = 1.973678719e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5700e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290440680055
                                         uncertainty =       0.002151277028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290440680055
                                         uncertainty =       0.002151277028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381200463
  error estimate for blocks of size 2^( 2) =       0.000396264243
  error estimate for blocks of size 2^( 3) =       0.000410430258
  error estimate for blocks of size 2^( 4) =       0.000420572118
  error estimate for blocks of size 2^( 5) =       0.000426405929
  error estimate for blocks of size 2^( 6) =       0.000430554365
  error estimate for blocks of size 2^( 7) =       0.000431743466

      target function =      -0.913649865284
              le_mean =     -17.207055220864
             les_mean =     296.382175692613
             stat err =       0.000427318969
             autocorr =       1.256601300904
   target nu stat err =       0.000427318969
   target dn stat err =       0.002445980970
      target stat err =       0.003849590270
              std dev =       0.539098865282
             le_variance =       0.290627586548


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720705522086e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913665143037       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913669276223       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913670717643       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913671243847       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913671304092       residual = 8.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913671455992       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913671445841       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913671542073       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913671532981       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913671557489       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913671620575       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913671708498       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913671725189       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913671762354       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913671800600       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913671790637       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913671800464       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913671787359       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913671794547       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913671799605       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913671814132       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913671818939       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913671824120       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913671842700       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913671846485       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913671860748       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913671853938       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913671868293       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913671873001       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913671870706       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913671872639       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913671876158       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913671874641       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913671871730       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913671872555       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913671870040       residual = 6.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+00 is 1.083100e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913665143037       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913666191357       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913666556391       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913666689006       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913666704415       residual = 8.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913666742331       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913666740151       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913666764338       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913666761460       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913666768344       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913666783898       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913666805989       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913666810100       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913666819434       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913666829014       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913666826437       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913666828886       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913666825593       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913666827454       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913666828716       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913666832272       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913666833506       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913666834853       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913666839443       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913666840373       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913666843860       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913666842158       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913666845760       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913666846889       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913666846294       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913666846814       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913666847653       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913666847265       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913666846556       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913666846736       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913666846132       residual = 6.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+01 is 2.724793e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913665143037       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913665406073       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913665497629       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913665530849       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913665534724       residual = 8.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913665544197       residual = 7.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913665543679       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913665549730       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913665548971       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913665550747       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913665554616       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913665560147       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913665561171       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913665563507       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913665565903       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913665565253       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913665565865       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913665565040       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913665565510       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913665565825       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913665566709       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913665567020       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913665567360       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913665568504       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913665568735       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913665569602       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913665569177       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913665570078       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913665570357       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913665570207       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913665570339       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913665570546       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913665570449       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913665570273       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913665570316       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913665570167       residual = 6.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.2500e+01 is 6.822719e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.020748 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5089e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
  uu_0                 2.086692e-01 1 1  ON 0
  uu_1                 5.174793e-02 1 1  ON 1
  uu_2                -3.901585e-02 1 1  ON 2
  uu_3                -9.239859e-02 1 1  ON 3
  uu_4                -1.232136e-01 1 1  ON 4
  uu_5                -1.309066e-01 1 1  ON 5
  uu_6                -1.127568e-01 1 1  ON 6
  uu_7                -5.445790e-02 1 1  ON 7
  uu_8                 6.677533e-02 1 1  ON 8
  uu_9                 1.243243e-01 1 1  ON 9
  ud_0                 3.067091e-01 1 1  ON 10
  ud_1                 7.697957e-02 1 1  ON 11
  ud_2                -2.496914e-02 1 1  ON 12
  ud_3                -7.813576e-02 1 1  ON 13
  ud_4                -1.144529e-01 1 1  ON 14
  ud_5                -1.340595e-01 1 1  ON 15
  ud_6                -1.289165e-01 1 1  ON 16
  ud_7                -8.821300e-02 1 1  ON 17
  ud_8                -4.433732e-03 1 1  ON 18
  ud_9                 8.759085e-02 1 1  ON 19
  eO_0                -7.039698e-01 1 1  ON 20
  eO_1                -4.206722e-01 1 1  ON 21
  eO_2                -4.183787e-02 1 1  ON 22
  eO_3                 1.854973e-01 1 1  ON 23
  eO_4                 2.598602e-01 1 1  ON 24
  eO_5                 2.839613e-01 1 1  ON 25
  eO_6                 2.507493e-01 1 1  ON 26
  eO_7                 1.273995e-01 1 1  ON 27
  eO_8                 2.870781e-02 1 1  ON 28
  eO_9                 1.906571e-02 1 1  ON 29
 eH1_0                -2.023033e-01 1 1  ON 30
 eH1_1                -9.741488e-02 1 1  ON 31
 eH1_2                -4.630237e-02 1 1  ON 32
 eH1_3                -1.502038e-02 1 1  ON 33
 eH1_4                 1.853649e-02 1 1  ON 34
 eH1_5                 2.496374e-02 1 1  ON 35
 eH1_6                 7.414092e-02 1 1  ON 36
 eH1_7                 1.040013e-01 1 1  ON 37
 eH1_8                 9.809933e-02 1 1  ON 38
 eH1_9                 2.545316e-02 1 1  ON 39
 eH2_0                -2.032028e-01 1 1  ON 40
 eH2_1                -9.890156e-02 1 1  ON 41
 eH2_2                -4.808862e-02 1 1  ON 42
 eH2_3                -1.716459e-02 1 1  ON 43
 eH2_4                 1.619390e-02 1 1  ON 44
 eH2_5                 2.136637e-02 1 1  ON 45
 eH2_6                 7.614761e-02 1 1  ON 46
 eH2_7                 1.120037e-01 1 1  ON 47
 eH2_8                 1.008286e-01 1 1  ON 48
 eH2_9                 2.831952e-02 1 1  ON 49
ci_001                -4.238853e-02 3 1  ON 50
ci_002                -3.110170e-02 3 1  ON 51
ci_003                -1.185321e-02 3 1  ON 52
ci_004                 2.578728e-02 3 1  ON 53
ci_005                 2.614177e-02 3 1  ON 54
ci_006                -2.098812e-02 3 1  ON 55
ci_007                -2.033391e-02 3 1  ON 56
ci_008                -4.844667e-03 3 1  ON 57
ci_009                -1.576883e-02 3 1  ON 58
ci_010                -1.009012e-02 3 1  ON 59
ci_011                -9.918699e-03 3 1  ON 60
ci_012                -9.914471e-03 3 1  ON 61
ci_013                -2.149456e-02 3 1  ON 62
ci_014                 1.339373e-02 3 1  ON 63
ci_015                 1.344558e-02 3 1  ON 64
ci_016                 1.662417e-02 3 1  ON 65
ci_017                 1.635726e-02 3 1  ON 66
ci_018                 1.091757e-02 3 1  ON 67
ci_019                 1.081606e-02 3 1  ON 68
ci_020                 1.836809e-02 3 1  ON 69
ci_021                 1.795296e-02 3 1  ON 70
ci_022                 1.041338e-02 3 1  ON 71
ci_023                 1.057137e-02 3 1  ON 72
ci_024                 6.917909e-03 3 1  ON 73
ci_025                 6.728966e-03 3 1  ON 74
ci_026                 1.179070e-02 3 1  ON 75
ci_027                 1.176651e-02 3 1  ON 76
ci_028                -9.435989e-03 3 1  ON 77
ci_029                -1.023557e-02 3 1  ON 78
ci_030                -4.751370e-03 3 1  ON 79
ci_031                -4.877629e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1923
    reference variance = 0.274189
====================================================
  Execution time = 2.1595e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0364e-01
  Total weights = 1.9738e+06
  Execution time = 1.6131e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293161696466
                                         uncertainty =       0.002539046150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293161696466
                                         uncertainty =       0.002539046150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382817462
  error estimate for blocks of size 2^( 2) =       0.000398003161
  error estimate for blocks of size 2^( 3) =       0.000411616965
  error estimate for blocks of size 2^( 4) =       0.000421848436
  error estimate for blocks of size 2^( 5) =       0.000428160639
  error estimate for blocks of size 2^( 6) =       0.000432148553
  error estimate for blocks of size 2^( 7) =       0.000432023248

      target function =      -0.907130241123
              le_mean =     -17.206441507800
             les_mean =     296.365305396948
             stat err =       0.000428545219
             autocorr =       1.253169536248
   target nu stat err =       0.000428545219
   target dn stat err =       0.003615295556
      target stat err =       0.005549818043
              std dev =       0.541385646973
             le_variance =       0.293098418749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293142118902
                                         uncertainty =       0.002533597046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293142118902
                                         uncertainty =       0.002533597046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382804678
  error estimate for blocks of size 2^( 2) =       0.000397995876
  error estimate for blocks of size 2^( 3) =       0.000411614644
  error estimate for blocks of size 2^( 4) =       0.000421850052
  error estimate for blocks of size 2^( 5) =       0.000428164713
  error estimate for blocks of size 2^( 6) =       0.000432154688
  error estimate for blocks of size 2^( 7) =       0.000432030445

      target function =      -0.907326380264
              le_mean =     -17.206441871361
             les_mean =     296.365189777629
             stat err =       0.000428549975
             autocorr =       1.253281053112
   target nu stat err =       0.000428549975
   target dn stat err =       0.003555994720
      target stat err =       0.005462665815
              std dev =       0.541367567601
             le_variance =       0.293078843251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293151750197
                                         uncertainty =       0.002536282047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293151750197
                                         uncertainty =       0.002536282047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382810967
  error estimate for blocks of size 2^( 2) =       0.000397999449
  error estimate for blocks of size 2^( 3) =       0.000411615764
  error estimate for blocks of size 2^( 4) =       0.000421849227
  error estimate for blocks of size 2^( 5) =       0.000428162673
  error estimate for blocks of size 2^( 6) =       0.000432151632
  error estimate for blocks of size 2^( 7) =       0.000432026864

      target function =      -0.907235950304
              le_mean =     -17.206441688126
             les_mean =     296.365242532132
             stat err =       0.000428547599
             autocorr =       1.253225978796
   target nu stat err =       0.000428547599
   target dn stat err =       0.003584101994
      target stat err =       0.005504010885
              std dev =       0.541376461943
             le_variance =       0.293088473546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293160445365
                                         uncertainty =       0.002538699032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293160445365
                                         uncertainty =       0.002538699032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382816645
  error estimate for blocks of size 2^( 2) =       0.000398002693
  error estimate for blocks of size 2^( 3) =       0.000411616812
  error estimate for blocks of size 2^( 4) =       0.000421848533
  error estimate for blocks of size 2^( 5) =       0.000428160891
  error estimate for blocks of size 2^( 6) =       0.000432148936
  error estimate for blocks of size 2^( 7) =       0.000432023699

      target function =      -0.907143977496
              le_mean =     -17.206441529926
             les_mean =     296.365297182260
             stat err =       0.000428545515
             autocorr =       1.253176613358
   target nu stat err =       0.000428545515
   target dn stat err =       0.003611246530
      target stat err =       0.005543873139
              std dev =       0.541384491636
             le_variance =       0.293097167784


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.907130241123        initial
     3.9062e+00     3.9062e+01             1.0831e-04        -0.907326380264  <--
     1.5625e+01     1.5625e+02             2.7248e-05        -0.907235950304
     6.2500e+01     6.2500e+02             6.8227e-06        -0.907143977496

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 2.9732e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
  uu_0                 2.086754e-01 1 1  ON 0
  uu_1                 5.175659e-02 1 1  ON 1
  uu_2                -3.899912e-02 1 1  ON 2
  uu_3                -9.238466e-02 1 1  ON 3
  uu_4                -1.232098e-01 1 1  ON 4
  uu_5                -1.309144e-01 1 1  ON 5
  uu_6                -1.127404e-01 1 1  ON 6
  uu_7                -5.446084e-02 1 1  ON 7
  uu_8                 6.669967e-02 1 1  ON 8
  uu_9                 1.243285e-01 1 1  ON 9
  ud_0                 3.066687e-01 1 1  ON 10
  ud_1                 7.694744e-02 1 1  ON 11
  ud_2                -2.498872e-02 1 1  ON 12
  ud_3                -7.814755e-02 1 1  ON 13
  ud_4                -1.144466e-01 1 1  ON 14
  ud_5                -1.340318e-01 1 1  ON 15
  ud_6                -1.288689e-01 1 1  ON 16
  ud_7                -8.817782e-02 1 1  ON 17
  ud_8                -4.444816e-03 1 1  ON 18
  ud_9                 8.757602e-02 1 1  ON 19
  eO_0                -7.039514e-01 1 1  ON 20
  eO_1                -4.206726e-01 1 1  ON 21
  eO_2                -4.185718e-02 1 1  ON 22
  eO_3                 1.854879e-01 1 1  ON 23
  eO_4                 2.598377e-01 1 1  ON 24
  eO_5                 2.839339e-01 1 1  ON 25
  eO_6                 2.507656e-01 1 1  ON 26
  eO_7                 1.274423e-01 1 1  ON 27
  eO_8                 2.871013e-02 1 1  ON 28
  eO_9                 1.906548e-02 1 1  ON 29
 eH1_0                -2.022892e-01 1 1  ON 30
 eH1_1                -9.738734e-02 1 1  ON 31
 eH1_2                -4.627356e-02 1 1  ON 32
 eH1_3                -1.500009e-02 1 1  ON 33
 eH1_4                 1.851296e-02 1 1  ON 34
 eH1_5                 2.488268e-02 1 1  ON 35
 eH1_6                 7.412899e-02 1 1  ON 36
 eH1_7                 1.040004e-01 1 1  ON 37
 eH1_8                 9.812321e-02 1 1  ON 38
 eH1_9                 2.545661e-02 1 1  ON 39
 eH2_0                -2.031929e-01 1 1  ON 40
 eH2_1                -9.890403e-02 1 1  ON 41
 eH2_2                -4.808931e-02 1 1  ON 42
 eH2_3                -1.715897e-02 1 1  ON 43
 eH2_4                 1.619624e-02 1 1  ON 44
 eH2_5                 2.134977e-02 1 1  ON 45
 eH2_6                 7.612334e-02 1 1  ON 46
 eH2_7                 1.120045e-01 1 1  ON 47
 eH2_8                 1.008532e-01 1 1  ON 48
 eH2_9                 2.831988e-02 1 1  ON 49
ci_001                -4.238792e-02 3 1  ON 50
ci_002                -3.109959e-02 3 1  ON 51
ci_003                -1.183878e-02 3 1  ON 52
ci_004                 2.578644e-02 3 1  ON 53
ci_005                 2.612471e-02 3 1  ON 54
ci_006                -2.097878e-02 3 1  ON 55
ci_007                -2.033098e-02 3 1  ON 56
ci_008                -4.840151e-03 3 1  ON 57
ci_009                -1.576243e-02 3 1  ON 58
ci_010                -1.006971e-02 3 1  ON 59
ci_011                -9.916220e-03 3 1  ON 60
ci_012                -9.892156e-03 3 1  ON 61
ci_013                -2.150624e-02 3 1  ON 62
ci_014                 1.339175e-02 3 1  ON 63
ci_015                 1.344424e-02 3 1  ON 64
ci_016                 1.661450e-02 3 1  ON 65
ci_017                 1.635977e-02 3 1  ON 66
ci_018                 1.091417e-02 3 1  ON 67
ci_019                 1.080442e-02 3 1  ON 68
ci_020                 1.835790e-02 3 1  ON 69
ci_021                 1.796975e-02 3 1  ON 70
ci_022                 1.041174e-02 3 1  ON 71
ci_023                 1.057428e-02 3 1  ON 72
ci_024                 6.912038e-03 3 1  ON 73
ci_025                 6.716745e-03 3 1  ON 74
ci_026                 1.180269e-02 3 1  ON 75
ci_027                 1.177007e-02 3 1  ON 76
ci_028                -9.443249e-03 3 1  ON 77
ci_029                -1.023910e-02 3 1  ON 78
ci_030                -4.755443e-03 3 1  ON 79
ci_031                -4.861275e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4827e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7180e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2233
    reference variance = 0.210316
====================================================
  Execution time = 1.9367e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5425e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0108e-01
  Total weights = 1.973978311e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5956e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291433770987
                                         uncertainty =       0.002490598960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291433770987
                                         uncertainty =       0.002490598960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381743482
  error estimate for blocks of size 2^( 2) =       0.000396726633
  error estimate for blocks of size 2^( 3) =       0.000409799742
  error estimate for blocks of size 2^( 4) =       0.000420037074
  error estimate for blocks of size 2^( 5) =       0.000427191929
  error estimate for blocks of size 2^( 6) =       0.000431478929
  error estimate for blocks of size 2^( 7) =       0.000432748640

      target function =      -0.911090905278
              le_mean =     -17.206439293174
             les_mean =     296.362636445843
             stat err =       0.000427864143
             autocorr =       1.256228153965
   target nu stat err =       0.000427864143
   target dn stat err =       0.003741811401
      target stat err =       0.005790524700
              std dev =       0.539866810103
             le_variance =       0.291456172651


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720643929317e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911126847109       residual = 3.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911146290537       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911151355064       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911153535480       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911154254359       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911154644647       residual = 8.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911154984844       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911155094204       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911155478144       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911155794959       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911156080520       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911156028256       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911156089051       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911156116344       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911156282486       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911156289040       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911156515101       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911156818387       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911156880639       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911156776677       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911156866062       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911157004172       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911157103406       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911157093804       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911157050565       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911157055865       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911157059490       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911157090992       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911157090273       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911157097020       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911157084091       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911157104366       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911157093663       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911157087233       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911157091076       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911157088329       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911157088816       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911157093117       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.911157090840       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e-01 is 4.932751e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911126847109       residual = 3.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911131978979       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911133301285       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911133871877       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911134057237       residual = 8.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911134160146       residual = 8.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911134245650       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911134273044       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911134371404       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911134455685       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911134530003       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911134514263       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911134527539       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911134534945       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911134576662       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911134579378       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911134639979       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911134714906       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911134726669       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911134700979       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911134725685       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911134758824       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911134781576       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911134777435       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911134768076       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911134769353       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911134770095       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911134777224       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911134776508       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911134778293       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911134775762       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911134780199       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911134777274       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911134775863       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911134776818       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911134776209       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911134776117       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911134777105       residual = 9.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+00 is 1.237992e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911126847109       residual = 3.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911128148212       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911128482486       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911128626817       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911128673525       residual = 8.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911128699671       residual = 8.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911128721019       residual = 5.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911128727860       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911128752611       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911128774018       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911128792782       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911128788659       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911128791849       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911128793743       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911128804179       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911128804942       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911128820358       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911128839013       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911128841697       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911128835311       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911128841646       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911128849825       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911128855368       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911128854239       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911128851987       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911128852300       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911128852478       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911128854203       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911128853995       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911128854457       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911128853867       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911128854921       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911128854191       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911128853845       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911128854085       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911128853939       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911128853895       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911128854147       residual = 9.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+01 is 3.099518e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.082044 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5029e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
  uu_0                 2.087240e-01 1 1  ON 0
  uu_1                 5.179984e-02 1 1  ON 1
  uu_2                -3.897019e-02 1 1  ON 2
  uu_3                -9.236069e-02 1 1  ON 3
  uu_4                -1.231919e-01 1 1  ON 4
  uu_5                -1.308990e-01 1 1  ON 5
  uu_6                -1.127715e-01 1 1  ON 6
  uu_7                -5.452082e-02 1 1  ON 7
  uu_8                 6.657587e-02 1 1  ON 8
  uu_9                 1.243425e-01 1 1  ON 9
  ud_0                 3.066144e-01 1 1  ON 10
  ud_1                 7.692245e-02 1 1  ON 11
  ud_2                -2.499924e-02 1 1  ON 12
  ud_3                -7.814846e-02 1 1  ON 13
  ud_4                -1.144416e-01 1 1  ON 14
  ud_5                -1.340065e-01 1 1  ON 15
  ud_6                -1.288388e-01 1 1  ON 16
  ud_7                -8.813753e-02 1 1  ON 17
  ud_8                -4.459082e-03 1 1  ON 18
  ud_9                 8.755027e-02 1 1  ON 19
  eO_0                -7.039687e-01 1 1  ON 20
  eO_1                -4.206831e-01 1 1  ON 21
  eO_2                -4.186455e-02 1 1  ON 22
  eO_3                 1.855065e-01 1 1  ON 23
  eO_4                 2.598208e-01 1 1  ON 24
  eO_5                 2.838907e-01 1 1  ON 25
  eO_6                 2.507713e-01 1 1  ON 26
  eO_7                 1.275082e-01 1 1  ON 27
  eO_8                 2.870988e-02 1 1  ON 28
  eO_9                 1.906859e-02 1 1  ON 29
 eH1_0                -2.022747e-01 1 1  ON 30
 eH1_1                -9.737655e-02 1 1  ON 31
 eH1_2                -4.624605e-02 1 1  ON 32
 eH1_3                -1.499500e-02 1 1  ON 33
 eH1_4                 1.847045e-02 1 1  ON 34
 eH1_5                 2.481510e-02 1 1  ON 35
 eH1_6                 7.413203e-02 1 1  ON 36
 eH1_7                 1.040242e-01 1 1  ON 37
 eH1_8                 9.814627e-02 1 1  ON 38
 eH1_9                 2.546062e-02 1 1  ON 39
 eH2_0                -2.031977e-01 1 1  ON 40
 eH2_1                -9.886434e-02 1 1  ON 41
 eH2_2                -4.803054e-02 1 1  ON 42
 eH2_3                -1.712385e-02 1 1  ON 43
 eH2_4                 1.619700e-02 1 1  ON 44
 eH2_5                 2.126586e-02 1 1  ON 45
 eH2_6                 7.606379e-02 1 1  ON 46
 eH2_7                 1.119962e-01 1 1  ON 47
 eH2_8                 1.008700e-01 1 1  ON 48
 eH2_9                 2.831895e-02 1 1  ON 49
ci_001                -4.239805e-02 3 1  ON 50
ci_002                -3.109431e-02 3 1  ON 51
ci_003                -1.182640e-02 3 1  ON 52
ci_004                 2.579487e-02 3 1  ON 53
ci_005                 2.612546e-02 3 1  ON 54
ci_006                -2.097507e-02 3 1  ON 55
ci_007                -2.033418e-02 3 1  ON 56
ci_008                -4.847547e-03 3 1  ON 57
ci_009                -1.574398e-02 3 1  ON 58
ci_010                -1.006257e-02 3 1  ON 59
ci_011                -9.914925e-03 3 1  ON 60
ci_012                -9.898409e-03 3 1  ON 61
ci_013                -2.152681e-02 3 1  ON 62
ci_014                 1.340720e-02 3 1  ON 63
ci_015                 1.342755e-02 3 1  ON 64
ci_016                 1.659402e-02 3 1  ON 65
ci_017                 1.632585e-02 3 1  ON 66
ci_018                 1.092570e-02 3 1  ON 67
ci_019                 1.080516e-02 3 1  ON 68
ci_020                 1.835287e-02 3 1  ON 69
ci_021                 1.797272e-02 3 1  ON 70
ci_022                 1.041758e-02 3 1  ON 71
ci_023                 1.054451e-02 3 1  ON 72
ci_024                 6.924521e-03 3 1  ON 73
ci_025                 6.718170e-03 3 1  ON 74
ci_026                 1.180883e-02 3 1  ON 75
ci_027                 1.177954e-02 3 1  ON 76
ci_028                -9.464366e-03 3 1  ON 77
ci_029                -1.022357e-02 3 1  ON 78
ci_030                -4.734856e-03 3 1  ON 79
ci_031                -4.858080e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.183
    reference variance = 0.274925
====================================================
  Execution time = 1.9190e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9916e-01
  Total weights = 1.9740e+06
  Execution time = 1.6035e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292072288706
                                         uncertainty =       0.003930648070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292072288706
                                         uncertainty =       0.003930648070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382126394
  error estimate for blocks of size 2^( 2) =       0.000397035425
  error estimate for blocks of size 2^( 3) =       0.000410902296
  error estimate for blocks of size 2^( 4) =       0.000421216458
  error estimate for blocks of size 2^( 5) =       0.000426895988
  error estimate for blocks of size 2^( 6) =       0.000429366169
  error estimate for blocks of size 2^( 7) =       0.000433266896

      target function =      -0.914006423278
              le_mean =     -17.206894080156
             les_mean =     296.376374258576
             stat err =       0.000427686378
             autocorr =       1.252670251126
   target nu stat err =       0.000427686378
   target dn stat err =       0.004706907686
      target stat err =       0.007315843816
              std dev =       0.540408329022
             le_variance =       0.292041162077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292042401704
                                         uncertainty =       0.003897443539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292042401704
                                         uncertainty =       0.003897443539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382106982
  error estimate for blocks of size 2^( 2) =       0.000397031008
  error estimate for blocks of size 2^( 3) =       0.000410911155
  error estimate for blocks of size 2^( 4) =       0.000421236092
  error estimate for blocks of size 2^( 5) =       0.000426921663
  error estimate for blocks of size 2^( 6) =       0.000429396952
  error estimate for blocks of size 2^( 7) =       0.000433298744

      target function =      -0.913826728835
              le_mean =     -17.206892605862
             les_mean =     296.376440368156
             stat err =       0.000427713363
             autocorr =       1.252955626771
   target nu stat err =       0.000427713363
   target dn stat err =       0.004668914052
      target stat err =       0.007254509369
              std dev =       0.540380876146
             le_variance =       0.292011491305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292055971163
                                         uncertainty =       0.003913069779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292055971163
                                         uncertainty =       0.003913069779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382115793
  error estimate for blocks of size 2^( 2) =       0.000397032708
  error estimate for blocks of size 2^( 3) =       0.000410906541
  error estimate for blocks of size 2^( 4) =       0.000421226327
  error estimate for blocks of size 2^( 5) =       0.000426908968
  error estimate for blocks of size 2^( 6) =       0.000429381831
  error estimate for blocks of size 2^( 7) =       0.000433283050

      target function =      -0.914045144915
              le_mean =     -17.206893223900
             les_mean =     296.376320115338
             stat err =       0.000427700044
             autocorr =       1.252819818332
   target nu stat err =       0.000427700044
   target dn stat err =       0.004684980373
      target stat err =       0.007282697421
              std dev =       0.540393336822
             le_variance =       0.292024958481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292070155547
                                         uncertainty =       0.003928411606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292070155547
                                         uncertainty =       0.003928411606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382125008
  error estimate for blocks of size 2^( 2) =       0.000397035037
  error estimate for blocks of size 2^( 3) =       0.000410902788
  error estimate for blocks of size 2^( 4) =       0.000421217662
  error estimate for blocks of size 2^( 5) =       0.000426897583
  error estimate for blocks of size 2^( 6) =       0.000429368105
  error estimate for blocks of size 2^( 7) =       0.000433268892

      target function =      -0.914013491503
              le_mean =     -17.206893963347
             les_mean =     296.376365714617
             stat err =       0.000427688060
             autocorr =       1.252689194718
   target nu stat err =       0.000427688060
   target dn stat err =       0.004704102457
      target stat err =       0.007311637074
              std dev =       0.540406368755
             le_variance =       0.292039043391


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914006423278        initial
     9.7656e-01     9.7656e+00             4.9328e-04        -0.913826728835
     3.9062e+00     3.9062e+01             1.2380e-04        -0.914045144915  <--
     1.5625e+01     1.5625e+02             3.0995e-05        -0.914013491503

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 2.7261e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
  uu_0                 2.087240e-01 1 1  ON 0
  uu_1                 5.179984e-02 1 1  ON 1
  uu_2                -3.897019e-02 1 1  ON 2
  uu_3                -9.236069e-02 1 1  ON 3
  uu_4                -1.231919e-01 1 1  ON 4
  uu_5                -1.308990e-01 1 1  ON 5
  uu_6                -1.127715e-01 1 1  ON 6
  uu_7                -5.452082e-02 1 1  ON 7
  uu_8                 6.657587e-02 1 1  ON 8
  uu_9                 1.243425e-01 1 1  ON 9
  ud_0                 3.066144e-01 1 1  ON 10
  ud_1                 7.692245e-02 1 1  ON 11
  ud_2                -2.499924e-02 1 1  ON 12
  ud_3                -7.814846e-02 1 1  ON 13
  ud_4                -1.144416e-01 1 1  ON 14
  ud_5                -1.340065e-01 1 1  ON 15
  ud_6                -1.288388e-01 1 1  ON 16
  ud_7                -8.813753e-02 1 1  ON 17
  ud_8                -4.459082e-03 1 1  ON 18
  ud_9                 8.755027e-02 1 1  ON 19
  eO_0                -7.039687e-01 1 1  ON 20
  eO_1                -4.206831e-01 1 1  ON 21
  eO_2                -4.186455e-02 1 1  ON 22
  eO_3                 1.855065e-01 1 1  ON 23
  eO_4                 2.598208e-01 1 1  ON 24
  eO_5                 2.838907e-01 1 1  ON 25
  eO_6                 2.507713e-01 1 1  ON 26
  eO_7                 1.275082e-01 1 1  ON 27
  eO_8                 2.870988e-02 1 1  ON 28
  eO_9                 1.906859e-02 1 1  ON 29
 eH1_0                -2.022747e-01 1 1  ON 30
 eH1_1                -9.737655e-02 1 1  ON 31
 eH1_2                -4.624605e-02 1 1  ON 32
 eH1_3                -1.499500e-02 1 1  ON 33
 eH1_4                 1.847045e-02 1 1  ON 34
 eH1_5                 2.481510e-02 1 1  ON 35
 eH1_6                 7.413203e-02 1 1  ON 36
 eH1_7                 1.040242e-01 1 1  ON 37
 eH1_8                 9.814627e-02 1 1  ON 38
 eH1_9                 2.546062e-02 1 1  ON 39
 eH2_0                -2.031977e-01 1 1  ON 40
 eH2_1                -9.886434e-02 1 1  ON 41
 eH2_2                -4.803054e-02 1 1  ON 42
 eH2_3                -1.712385e-02 1 1  ON 43
 eH2_4                 1.619700e-02 1 1  ON 44
 eH2_5                 2.126586e-02 1 1  ON 45
 eH2_6                 7.606379e-02 1 1  ON 46
 eH2_7                 1.119962e-01 1 1  ON 47
 eH2_8                 1.008700e-01 1 1  ON 48
 eH2_9                 2.831895e-02 1 1  ON 49
ci_001                -4.239805e-02 3 1  ON 50
ci_002                -3.109431e-02 3 1  ON 51
ci_003                -1.182640e-02 3 1  ON 52
ci_004                 2.579487e-02 3 1  ON 53
ci_005                 2.612546e-02 3 1  ON 54
ci_006                -2.097507e-02 3 1  ON 55
ci_007                -2.033418e-02 3 1  ON 56
ci_008                -4.847547e-03 3 1  ON 57
ci_009                -1.574398e-02 3 1  ON 58
ci_010                -1.006257e-02 3 1  ON 59
ci_011                -9.914925e-03 3 1  ON 60
ci_012                -9.898409e-03 3 1  ON 61
ci_013                -2.152681e-02 3 1  ON 62
ci_014                 1.340720e-02 3 1  ON 63
ci_015                 1.342755e-02 3 1  ON 64
ci_016                 1.659402e-02 3 1  ON 65
ci_017                 1.632585e-02 3 1  ON 66
ci_018                 1.092570e-02 3 1  ON 67
ci_019                 1.080516e-02 3 1  ON 68
ci_020                 1.835287e-02 3 1  ON 69
ci_021                 1.797272e-02 3 1  ON 70
ci_022                 1.041758e-02 3 1  ON 71
ci_023                 1.054451e-02 3 1  ON 72
ci_024                 6.924521e-03 3 1  ON 73
ci_025                 6.718170e-03 3 1  ON 74
ci_026                 1.180883e-02 3 1  ON 75
ci_027                 1.177954e-02 3 1  ON 76
ci_028                -9.464366e-03 3 1  ON 77
ci_029                -1.022357e-02 3 1  ON 78
ci_030                -4.734856e-03 3 1  ON 79
ci_031                -4.858080e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2296e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7181e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1349
    reference variance = 0.240652
====================================================
  Execution time = 1.9529e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5445e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9731e-01
  Total weights = 1.973646676e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290721171662
                                         uncertainty =       0.002035958419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290721171662
                                         uncertainty =       0.002035958419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381246488
  error estimate for blocks of size 2^( 2) =       0.000396461733
  error estimate for blocks of size 2^( 3) =       0.000410622437
  error estimate for blocks of size 2^( 4) =       0.000420567757
  error estimate for blocks of size 2^( 5) =       0.000426317840
  error estimate for blocks of size 2^( 6) =       0.000429603305
  error estimate for blocks of size 2^( 7) =       0.000431859278

      target function =      -0.916941486122
              le_mean =     -17.206099891363
             les_mean =     296.347187018182
             stat err =       0.000427087045
             autocorr =       1.254934597829
   target nu stat err =       0.000427087045
   target dn stat err =       0.002487013896
      target stat err =       0.003932637216
              std dev =       0.539163953706
             le_variance =       0.290697768976


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720609989136e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916957176705       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916969925714       residual = 7.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916973994544       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916974841250       residual = 9.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916975749928       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916976389225       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916976683401       residual = 6.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916977076139       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916977390460       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916977619865       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916977674336       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916977909857       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916978129457       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916978348506       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916978414458       residual = 8.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916978594586       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916978650821       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916978615919       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916978611840       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916978604997       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916978617176       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916978619142       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916978659892       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916978709002       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916978730642       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916978718304       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916978751610       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916978760235       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916978748727       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916978723107       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916978736813       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916978737948       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916978738417       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916978741538       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916978752357       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916978751531       residual = 8.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e-01 is 3.454125e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916957176705       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916960550852       residual = 7.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916961614241       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916961831963       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916962067656       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916962232821       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916962308937       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916962410129       residual = 4.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916962487028       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916962547425       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916962560499       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916962621886       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916962677535       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916962730505       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916962746658       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916962792395       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916962804677       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916962794397       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916962793301       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916962791810       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916962795129       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916962795897       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916962805764       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916962817867       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916962822277       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916962819421       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916962827371       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916962829089       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916962825777       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916962819555       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916962823351       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916962823662       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916962823691       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916962824611       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916962827018       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916962826774       residual = 7.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+00 is 8.748977e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916957176705       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916958032792       residual = 7.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916958301683       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916958356498       residual = 9.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916958415979       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916958457613       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916958476812       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916958502309       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916958521434       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916958536707       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916958539940       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916958555452       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916958569400       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916958582517       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916958586541       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916958598015       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916958600963       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916958598295       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916958598019       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916958597663       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916958598515       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916958598724       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916958601161       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916958604178       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916958605216       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916958604520       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916958606480       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916958606878       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916958606024       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916958604488       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916958605457       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916958605539       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916958605538       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916958605779       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916958606360       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916958606297       residual = 6.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+01 is 2.194477e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.133747 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5161e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
  uu_0                 2.086973e-01 1 1  ON 0
  uu_1                 5.177567e-02 1 1  ON 1
  uu_2                -3.898738e-02 1 1  ON 2
  uu_3                -9.237978e-02 1 1  ON 3
  uu_4                -1.232063e-01 1 1  ON 4
  uu_5                -1.309011e-01 1 1  ON 5
  uu_6                -1.127605e-01 1 1  ON 6
  uu_7                -5.447017e-02 1 1  ON 7
  uu_8                 6.658253e-02 1 1  ON 8
  uu_9                 1.243499e-01 1 1  ON 9
  ud_0                 3.065746e-01 1 1  ON 10
  ud_1                 7.688819e-02 1 1  ON 11
  ud_2                -2.502459e-02 1 1  ON 12
  ud_3                -7.816545e-02 1 1  ON 13
  ud_4                -1.144484e-01 1 1  ON 14
  ud_5                -1.339982e-01 1 1  ON 15
  ud_6                -1.287648e-01 1 1  ON 16
  ud_7                -8.808676e-02 1 1  ON 17
  ud_8                -4.480591e-03 1 1  ON 18
  ud_9                 8.752781e-02 1 1  ON 19
  eO_0                -7.039269e-01 1 1  ON 20
  eO_1                -4.206669e-01 1 1  ON 21
  eO_2                -4.186467e-02 1 1  ON 22
  eO_3                 1.854578e-01 1 1  ON 23
  eO_4                 2.597333e-01 1 1  ON 24
  eO_5                 2.838053e-01 1 1  ON 25
  eO_6                 2.508568e-01 1 1  ON 26
  eO_7                 1.275842e-01 1 1  ON 27
  eO_8                 2.870894e-02 1 1  ON 28
  eO_9                 1.906886e-02 1 1  ON 29
 eH1_0                -2.022924e-01 1 1  ON 30
 eH1_1                -9.739039e-02 1 1  ON 31
 eH1_2                -4.626982e-02 1 1  ON 32
 eH1_3                -1.502081e-02 1 1  ON 33
 eH1_4                 1.845126e-02 1 1  ON 34
 eH1_5                 2.480643e-02 1 1  ON 35
 eH1_6                 7.415589e-02 1 1  ON 36
 eH1_7                 1.040788e-01 1 1  ON 37
 eH1_8                 9.817236e-02 1 1  ON 38
 eH1_9                 2.545894e-02 1 1  ON 39
 eH2_0                -2.032198e-01 1 1  ON 40
 eH2_1                -9.885728e-02 1 1  ON 41
 eH2_2                -4.802945e-02 1 1  ON 42
 eH2_3                -1.713769e-02 1 1  ON 43
 eH2_4                 1.618420e-02 1 1  ON 44
 eH2_5                 2.124515e-02 1 1  ON 45
 eH2_6                 7.604308e-02 1 1  ON 46
 eH2_7                 1.120465e-01 1 1  ON 47
 eH2_8                 1.009003e-01 1 1  ON 48
 eH2_9                 2.832110e-02 1 1  ON 49
ci_001                -4.237654e-02 3 1  ON 50
ci_002                -3.108396e-02 3 1  ON 51
ci_003                -1.179632e-02 3 1  ON 52
ci_004                 2.578951e-02 3 1  ON 53
ci_005                 2.611174e-02 3 1  ON 54
ci_006                -2.096794e-02 3 1  ON 55
ci_007                -2.034730e-02 3 1  ON 56
ci_008                -4.860802e-03 3 1  ON 57
ci_009                -1.573681e-02 3 1  ON 58
ci_010                -1.005275e-02 3 1  ON 59
ci_011                -9.893608e-03 3 1  ON 60
ci_012                -9.884793e-03 3 1  ON 61
ci_013                -2.155052e-02 3 1  ON 62
ci_014                 1.340361e-02 3 1  ON 63
ci_015                 1.343271e-02 3 1  ON 64
ci_016                 1.658951e-02 3 1  ON 65
ci_017                 1.631796e-02 3 1  ON 66
ci_018                 1.090916e-02 3 1  ON 67
ci_019                 1.079491e-02 3 1  ON 68
ci_020                 1.836335e-02 3 1  ON 69
ci_021                 1.797364e-02 3 1  ON 70
ci_022                 1.041039e-02 3 1  ON 71
ci_023                 1.053878e-02 3 1  ON 72
ci_024                 6.916107e-03 3 1  ON 73
ci_025                 6.732913e-03 3 1  ON 74
ci_026                 1.181011e-02 3 1  ON 75
ci_027                 1.178661e-02 3 1  ON 76
ci_028                -9.481398e-03 3 1  ON 77
ci_029                -1.022280e-02 3 1  ON 78
ci_030                -4.733393e-03 3 1  ON 79
ci_031                -4.858750e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2412
    reference variance = 0.2563
====================================================
  Execution time = 1.9747e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9358e-01
  Total weights = 1.9738e+06
  Execution time = 1.6129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286485107478
                                         uncertainty =       0.001739505461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286485107478
                                         uncertainty =       0.001739505461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378437592
  error estimate for blocks of size 2^( 2) =       0.000393314498
  error estimate for blocks of size 2^( 3) =       0.000406914391
  error estimate for blocks of size 2^( 4) =       0.000416200825
  error estimate for blocks of size 2^( 5) =       0.000421742460
  error estimate for blocks of size 2^( 6) =       0.000423337962
  error estimate for blocks of size 2^( 7) =       0.000425057320

      target function =      -0.922758190367
              le_mean =     -17.206684416979
             les_mean =     296.363582648535
             stat err =       0.000421584642
             autocorr =       1.241026400160
   target nu stat err =       0.000421584642
   target dn stat err =       0.002371551578
      target stat err =       0.003805634427
              std dev =       0.535191575823
             le_variance =       0.286430022832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286462817075
                                         uncertainty =       0.001739978590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286462817075
                                         uncertainty =       0.001739978590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378422877
  error estimate for blocks of size 2^( 2) =       0.000393311781
  error estimate for blocks of size 2^( 3) =       0.000406924953
  error estimate for blocks of size 2^( 4) =       0.000416219924
  error estimate for blocks of size 2^( 5) =       0.000421771290
  error estimate for blocks of size 2^( 6) =       0.000423368277
  error estimate for blocks of size 2^( 7) =       0.000425087686

      target function =      -0.922864627352
              le_mean =     -17.206685112702
             les_mean =     296.363539081362
             stat err =       0.000421611794
             autocorr =       1.241282798483
   target nu stat err =       0.000421611794
   target dn stat err =       0.002367348071
      target stat err =       0.003800004854
              std dev =       0.535170764723
             le_variance =       0.286407747414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286473108008
                                         uncertainty =       0.001739750280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286473108008
                                         uncertainty =       0.001739750280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378429671
  error estimate for blocks of size 2^( 2) =       0.000393312828
  error estimate for blocks of size 2^( 3) =       0.000406919633
  error estimate for blocks of size 2^( 4) =       0.000416210494
  error estimate for blocks of size 2^( 5) =       0.000421757194
  error estimate for blocks of size 2^( 6) =       0.000423353460
  error estimate for blocks of size 2^( 7) =       0.000425072836

      target function =      -0.922816299087
              le_mean =     -17.206684733925
             les_mean =     296.363556697430
             stat err =       0.000421598496
             autocorr =       1.241159928827
   target nu stat err =       0.000421598496
   target dn stat err =       0.002369275958
      target stat err =       0.003802590357
              std dev =       0.535180373091
             le_variance =       0.286418031742

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286483548603
                                         uncertainty =       0.001739535871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286483548603
                                         uncertainty =       0.001739535871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378436563
  error estimate for blocks of size 2^( 2) =       0.000393314258
  error estimate for blocks of size 2^( 3) =       0.000406915025
  error estimate for blocks of size 2^( 4) =       0.000416202017
  error estimate for blocks of size 2^( 5) =       0.000421744291
  error estimate for blocks of size 2^( 6) =       0.000423339888
  error estimate for blocks of size 2^( 7) =       0.000425059248

      target function =      -0.922765849250
              le_mean =     -17.206684451229
             les_mean =     296.363578968928
             stat err =       0.000421586361
             autocorr =       1.241043271574
   target nu stat err =       0.000421586361
   target dn stat err =       0.002371253295
      target stat err =       0.003805235717
              std dev =       0.535190120489
             le_variance =       0.286428465069


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922758190367        initial
     9.7656e-01     9.7656e+00             3.4541e-04        -0.922864627352  <--
     3.9062e+00     3.9062e+01             8.7490e-05        -0.922816299087
     1.5625e+01     1.5625e+02             2.1945e-05        -0.922765849250

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.7860e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
  uu_0                 2.086193e-01 1 1  ON 0
  uu_1                 5.170457e-02 1 1  ON 1
  uu_2                -3.903889e-02 1 1  ON 2
  uu_3                -9.243609e-02 1 1  ON 3
  uu_4                -1.232486e-01 1 1  ON 4
  uu_5                -1.309077e-01 1 1  ON 5
  uu_6                -1.127288e-01 1 1  ON 6
  uu_7                -5.432268e-02 1 1  ON 7
  uu_8                 6.660362e-02 1 1  ON 8
  uu_9                 1.243720e-01 1 1  ON 9
  ud_0                 3.064595e-01 1 1  ON 10
  ud_1                 7.678866e-02 1 1  ON 11
  ud_2                -2.509878e-02 1 1  ON 12
  ud_3                -7.821532e-02 1 1  ON 13
  ud_4                -1.144683e-01 1 1  ON 14
  ud_5                -1.339734e-01 1 1  ON 15
  ud_6                -1.285534e-01 1 1  ON 16
  ud_7                -8.793758e-02 1 1  ON 17
  ud_8                -4.542283e-03 1 1  ON 18
  ud_9                 8.746091e-02 1 1  ON 19
  eO_0                -7.038073e-01 1 1  ON 20
  eO_1                -4.206196e-01 1 1  ON 21
  eO_2                -4.186582e-02 1 1  ON 22
  eO_3                 1.853155e-01 1 1  ON 23
  eO_4                 2.594754e-01 1 1  ON 24
  eO_5                 2.835506e-01 1 1  ON 25
  eO_6                 2.511117e-01 1 1  ON 26
  eO_7                 1.278117e-01 1 1  ON 27
  eO_8                 2.870624e-02 1 1  ON 28
  eO_9                 1.906965e-02 1 1  ON 29
 eH1_0                -2.023456e-01 1 1  ON 30
 eH1_1                -9.743317e-02 1 1  ON 31
 eH1_2                -4.634054e-02 1 1  ON 32
 eH1_3                -1.509739e-02 1 1  ON 33
 eH1_4                 1.839380e-02 1 1  ON 34
 eH1_5                 2.478136e-02 1 1  ON 35
 eH1_6                 7.422730e-02 1 1  ON 36
 eH1_7                 1.042417e-01 1 1  ON 37
 eH1_8                 9.825043e-02 1 1  ON 38
 eH1_9                 2.545397e-02 1 1  ON 39
 eH2_0                -2.032829e-01 1 1  ON 40
 eH2_1                -9.883908e-02 1 1  ON 41
 eH2_2                -4.802818e-02 1 1  ON 42
 eH2_3                -1.717854e-02 1 1  ON 43
 eH2_4                 1.614579e-02 1 1  ON 44
 eH2_5                 2.118450e-02 1 1  ON 45
 eH2_6                 7.598176e-02 1 1  ON 46
 eH2_7                 1.121964e-01 1 1  ON 47
 eH2_8                 1.009913e-01 1 1  ON 48
 eH2_9                 2.832758e-02 1 1  ON 49
ci_001                -4.231549e-02 3 1  ON 50
ci_002                -3.105457e-02 3 1  ON 51
ci_003                -1.171189e-02 3 1  ON 52
ci_004                 2.577436e-02 3 1  ON 53
ci_005                 2.607302e-02 3 1  ON 54
ci_006                -2.094776e-02 3 1  ON 55
ci_007                -2.038459e-02 3 1  ON 56
ci_008                -4.897583e-03 3 1  ON 57
ci_009                -1.571667e-02 3 1  ON 58
ci_010                -1.002515e-02 3 1  ON 59
ci_011                -9.833780e-03 3 1  ON 60
ci_012                -9.846687e-03 3 1  ON 61
ci_013                -2.161822e-02 3 1  ON 62
ci_014                 1.339356e-02 3 1  ON 63
ci_015                 1.344721e-02 3 1  ON 64
ci_016                 1.657676e-02 3 1  ON 65
ci_017                 1.629563e-02 3 1  ON 66
ci_018                 1.086310e-02 3 1  ON 67
ci_019                 1.076645e-02 3 1  ON 68
ci_020                 1.839274e-02 3 1  ON 69
ci_021                 1.797585e-02 3 1  ON 70
ci_022                 1.039024e-02 3 1  ON 71
ci_023                 1.052269e-02 3 1  ON 72
ci_024                 6.892356e-03 3 1  ON 73
ci_025                 6.774554e-03 3 1  ON 74
ci_026                 1.181361e-02 3 1  ON 75
ci_027                 1.180608e-02 3 1  ON 76
ci_028                -9.529480e-03 3 1  ON 77
ci_029                -1.022052e-02 3 1  ON 78
ci_030                -4.729358e-03 3 1  ON 79
ci_031                -4.860610e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.3028e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7181e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2035
    reference variance = 0.306341
====================================================
  Execution time = 1.9573e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5421e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0842e-01
  Total weights = 1.973942356e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297062946607
                                         uncertainty =       0.004062884401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297062946607
                                         uncertainty =       0.004062884401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385394251
  error estimate for blocks of size 2^( 2) =       0.000400284860
  error estimate for blocks of size 2^( 3) =       0.000414080955
  error estimate for blocks of size 2^( 4) =       0.000423702770
  error estimate for blocks of size 2^( 5) =       0.000429701962
  error estimate for blocks of size 2^( 6) =       0.000434204353
  error estimate for blocks of size 2^( 7) =       0.000435446462

      target function =      -0.899915374770
              le_mean =     -17.206373009694
             les_mean =     296.367688868208
             stat err =       0.000430763887
             autocorr =       1.249303941301
   target nu stat err =       0.000430763887
   target dn stat err =       0.006062024199
      target stat err =       0.009108842465
              std dev =       0.545029776525
             le_variance =       0.297057457299


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720637300969e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900006550370       residual = 3.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900387900408       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900440552896       residual = 9.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900461003268       residual = 5.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900464172578       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900469276864       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900472885682       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900476000914       residual = 7.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900478006360       residual = 6.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900479282137       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.900481076466       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.900482291759       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.900482742509       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.900484402689       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.900484311921       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.900484725747       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.900486135114       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.900486041238       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.900486554917       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.900486840710       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.900487286192       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.900487024846       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.900487350443       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.900487746748       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.900487953594       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.900487960519       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.900488109599       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.900488117739       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.900488137682       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.900488033980       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.900488058079       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.900488314301       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.900488239817       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.900488270975       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.900488280821       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.900488310034       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.900488310667       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.900488328929       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.900488274754       residual = 7.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.4414e-01 is 1.110731e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900006550370       residual = 3.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900121840586       residual = 5.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900138007450       residual = 9.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900143882263       residual = 4.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900144796250       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900146209728       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900147246458       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900148122230       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900148681198       residual = 6.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900149069785       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.900149579293       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.900149902290       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.900150023161       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.900150485360       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.900150441997       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.900150568541       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.900150942996       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.900150885520       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.900151010180       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.900151072495       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.900151172525       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.900151104436       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.900151182180       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.900151252842       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.900151303540       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.900151312618       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.900151336555       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.900151329984       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.900151334319       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.900151318128       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.900151333929       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.900151380556       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.900151363013       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.900151369244       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.900151361909       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.900151364637       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e-01 is 3.207253e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900006550370       residual = 3.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900036963468       residual = 5.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900041253276       residual = 8.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900042778154       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900043016459       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900043380307       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900043649413       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900043874878       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900044018671       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900044122048       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.900044253456       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.900044335329       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.900044366120       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.900044484421       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.900044472101       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.900044505929       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.900044600190       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.900044583176       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.900044613996       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.900044629020       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.900044652767       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.900044635870       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.900044655064       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.900044670150       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.900044683311       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.900044686080       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.900044690965       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.900044688608       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.900044689930       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.900044686815       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.900044690901       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.900044701300       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.900044697204       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.900044698587       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.900044696318       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.900044696706       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+00 is 8.346695e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.189675 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5162e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
  uu_0                 2.089400e-01 1 1  ON 0
  uu_1                 5.190951e-02 1 1  ON 1
  uu_2                -3.891448e-02 1 1  ON 2
  uu_3                -9.236725e-02 1 1  ON 3
  uu_4                -1.232541e-01 1 1  ON 4
  uu_5                -1.310390e-01 1 1  ON 5
  uu_6                -1.129181e-01 1 1  ON 6
  uu_7                -5.459735e-02 1 1  ON 7
  uu_8                 6.634323e-02 1 1  ON 8
  uu_9                 1.244009e-01 1 1  ON 9
  ud_0                 3.063381e-01 1 1  ON 10
  ud_1                 7.672197e-02 1 1  ON 11
  ud_2                -2.521464e-02 1 1  ON 12
  ud_3                -7.833638e-02 1 1  ON 13
  ud_4                -1.145229e-01 1 1  ON 14
  ud_5                -1.339228e-01 1 1  ON 15
  ud_6                -1.284434e-01 1 1  ON 16
  ud_7                -8.766183e-02 1 1  ON 17
  ud_8                -4.565363e-03 1 1  ON 18
  ud_9                 8.743390e-02 1 1  ON 19
  eO_0                -7.037461e-01 1 1  ON 20
  eO_1                -4.204696e-01 1 1  ON 21
  eO_2                -4.172450e-02 1 1  ON 22
  eO_3                 1.852276e-01 1 1  ON 23
  eO_4                 2.591956e-01 1 1  ON 24
  eO_5                 2.833799e-01 1 1  ON 25
  eO_6                 2.509883e-01 1 1  ON 26
  eO_7                 1.280687e-01 1 1  ON 27
  eO_8                 2.873927e-02 1 1  ON 28
  eO_9                 1.907375e-02 1 1  ON 29
 eH1_0                -2.025621e-01 1 1  ON 30
 eH1_1                -9.745495e-02 1 1  ON 31
 eH1_2                -4.623026e-02 1 1  ON 32
 eH1_3                -1.495466e-02 1 1  ON 33
 eH1_4                 1.848331e-02 1 1  ON 34
 eH1_5                 2.473717e-02 1 1  ON 35
 eH1_6                 7.401893e-02 1 1  ON 36
 eH1_7                 1.042156e-01 1 1  ON 37
 eH1_8                 9.838622e-02 1 1  ON 38
 eH1_9                 2.549047e-02 1 1  ON 39
 eH2_0                -2.034175e-01 1 1  ON 40
 eH2_1                -9.875363e-02 1 1  ON 41
 eH2_2                -4.783822e-02 1 1  ON 42
 eH2_3                -1.700993e-02 1 1  ON 43
 eH2_4                 1.615924e-02 1 1  ON 44
 eH2_5                 2.109113e-02 1 1  ON 45
 eH2_6                 7.570836e-02 1 1  ON 46
 eH2_7                 1.121091e-01 1 1  ON 47
 eH2_8                 1.010716e-01 1 1  ON 48
 eH2_9                 2.836090e-02 1 1  ON 49
ci_001                -4.233542e-02 3 1  ON 50
ci_002                -3.096692e-02 3 1  ON 51
ci_003                -1.159255e-02 3 1  ON 52
ci_004                 2.584130e-02 3 1  ON 53
ci_005                 2.598181e-02 3 1  ON 54
ci_006                -2.097724e-02 3 1  ON 55
ci_007                -2.030280e-02 3 1  ON 56
ci_008                -4.828812e-03 3 1  ON 57
ci_009                -1.562484e-02 3 1  ON 58
ci_010                -9.963355e-03 3 1  ON 59
ci_011                -9.795851e-03 3 1  ON 60
ci_012                -9.702042e-03 3 1  ON 61
ci_013                -2.168790e-02 3 1  ON 62
ci_014                 1.335118e-02 3 1  ON 63
ci_015                 1.332573e-02 3 1  ON 64
ci_016                 1.656006e-02 3 1  ON 65
ci_017                 1.631433e-02 3 1  ON 66
ci_018                 1.083510e-02 3 1  ON 67
ci_019                 1.075482e-02 3 1  ON 68
ci_020                 1.831885e-02 3 1  ON 69
ci_021                 1.804901e-02 3 1  ON 70
ci_022                 1.036588e-02 3 1  ON 71
ci_023                 1.048809e-02 3 1  ON 72
ci_024                 7.012619e-03 3 1  ON 73
ci_025                 6.786715e-03 3 1  ON 74
ci_026                 1.174005e-02 3 1  ON 75
ci_027                 1.202760e-02 3 1  ON 76
ci_028                -9.299688e-03 3 1  ON 77
ci_029                -1.018801e-02 3 1  ON 78
ci_030                -5.041250e-03 3 1  ON 79
ci_031                -4.870764e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1929
    reference variance = 0.513192
====================================================
  Execution time = 1.9316e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9674e-01
  Total weights = 1.9738e+06
  Execution time = 1.6100e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290190777487
                                         uncertainty =       0.001813808647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290190777487
                                         uncertainty =       0.001813808647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380870544
  error estimate for blocks of size 2^( 2) =       0.000395905156
  error estimate for blocks of size 2^( 3) =       0.000409739584
  error estimate for blocks of size 2^( 4) =       0.000420445745
  error estimate for blocks of size 2^( 5) =       0.000425886081
  error estimate for blocks of size 2^( 6) =       0.000428714877
  error estimate for blocks of size 2^( 7) =       0.000431376864

      target function =      -0.913996517962
              le_mean =     -17.206312278552
             les_mean =     296.356388297246
             stat err =       0.000426605892
             autocorr =       1.254581634497
   target nu stat err =       0.000426605892
   target dn stat err =       0.003093305788
      target stat err =       0.004832944207
              std dev =       0.538632288799
             le_variance =       0.290124742537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290553337536
                                         uncertainty =       0.001821717312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290553337536
                                         uncertainty =       0.001821717312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381109312
  error estimate for blocks of size 2^( 2) =       0.000396208188
  error estimate for blocks of size 2^( 3) =       0.000410109289
  error estimate for blocks of size 2^( 4) =       0.000420861753
  error estimate for blocks of size 2^( 5) =       0.000426322932
  error estimate for blocks of size 2^( 6) =       0.000429188436
  error estimate for blocks of size 2^( 7) =       0.000431880618

      target function =      -0.917187345627
              le_mean =     -17.206311576273
             les_mean =     296.354313835016
             stat err =       0.000427063435
             autocorr =       1.255699315621
   target nu stat err =       0.000427063435
   target dn stat err =       0.002196778896
      target stat err =       0.003493414769
              std dev =       0.538969957442
             le_variance =       0.290488615025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290388723788
                                         uncertainty =       0.001818195034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290388723788
                                         uncertainty =       0.001818195034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381000976
  error estimate for blocks of size 2^( 2) =       0.000396073268
  error estimate for blocks of size 2^( 3) =       0.000409947501
  error estimate for blocks of size 2^( 4) =       0.000420680195
  error estimate for blocks of size 2^( 5) =       0.000426132560
  error estimate for blocks of size 2^( 6) =       0.000428981705
  error estimate for blocks of size 2^( 7) =       0.000431658161

      target function =      -0.906820667895
              le_mean =     -17.206308532210
             les_mean =     296.360868173576
             stat err =       0.000426863155
             autocorr =       1.255235355828
   target nu stat err =       0.000426863155
   target dn stat err =       0.007298550553
      target stat err =       0.011123520407
              std dev =       0.538816747862
             le_variance =       0.290323487776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290214173996
                                         uncertainty =       0.001814516297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290214173996
                                         uncertainty =       0.001814516297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380885970
  error estimate for blocks of size 2^( 2) =       0.000395925341
  error estimate for blocks of size 2^( 3) =       0.000409764042
  error estimate for blocks of size 2^( 4) =       0.000420472913
  error estimate for blocks of size 2^( 5) =       0.000425913855
  error estimate for blocks of size 2^( 6) =       0.000428739777
  error estimate for blocks of size 2^( 7) =       0.000431406017

      target function =      -0.911252485575
              le_mean =     -17.206310998052
             les_mean =     296.358104656571
             stat err =       0.000426633140
             autocorr =       1.254640274331
   target nu stat err =       0.000426633140
   target dn stat err =       0.004705136462
      target stat err =       0.007261308576
              std dev =       0.538654104708
             le_variance =       0.290148244518


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913996517962        initial
     2.4414e-01     2.4414e+00             1.1107e-03        -0.917187345627  <--
     9.7656e-01     9.7656e+00             3.2073e-04        -0.906820667895
     3.9062e+00     3.9062e+01             8.3467e-05        -0.911252485575

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 2.7409e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
  uu_0                 2.097300e-01 1 1  ON 0
  uu_1                 5.243889e-02 1 1  ON 1
  uu_2                -3.857525e-02 1 1  ON 2
  uu_3                -9.216532e-02 1 1  ON 3
  uu_4                -1.232363e-01 1 1  ON 4
  uu_5                -1.313354e-01 1 1  ON 5
  uu_6                -1.133905e-01 1 1  ON 6
  uu_7                -5.534945e-02 1 1  ON 7
  uu_8                 6.556573e-02 1 1  ON 8
  uu_9                 1.244816e-01 1 1  ON 9
  ud_0                 3.060254e-01 1 1  ON 10
  ud_1                 7.652742e-02 1 1  ON 11
  ud_2                -2.551828e-02 1 1  ON 12
  ud_3                -7.864751e-02 1 1  ON 13
  ud_4                -1.146717e-01 1 1  ON 14
  ud_5                -1.338101e-01 1 1  ON 15
  ud_6                -1.281621e-01 1 1  ON 16
  ud_7                -8.694108e-02 1 1  ON 17
  ud_8                -4.608359e-03 1 1  ON 18
  ud_9                 8.735371e-02 1 1  ON 19
  eO_0                -7.035384e-01 1 1  ON 20
  eO_1                -4.200498e-01 1 1  ON 21
  eO_2                -4.135496e-02 1 1  ON 22
  eO_3                 1.849910e-01 1 1  ON 23
  eO_4                 2.584119e-01 1 1  ON 24
  eO_5                 2.828559e-01 1 1  ON 25
  eO_6                 2.506129e-01 1 1  ON 26
  eO_7                 1.288342e-01 1 1  ON 27
  eO_8                 2.883886e-02 1 1  ON 28
  eO_9                 1.908591e-02 1 1  ON 29
 eH1_0                -2.030836e-01 1 1  ON 30
 eH1_1                -9.750108e-02 1 1  ON 31
 eH1_2                -4.596151e-02 1 1  ON 32
 eH1_3                -1.460622e-02 1 1  ON 33
 eH1_4                 1.871423e-02 1 1  ON 34
 eH1_5                 2.462489e-02 1 1  ON 35
 eH1_6                 7.342237e-02 1 1  ON 36
 eH1_7                 1.041241e-01 1 1  ON 37
 eH1_8                 9.879013e-02 1 1  ON 38
 eH1_9                 2.559992e-02 1 1  ON 39
 eH2_0                -2.037079e-01 1 1  ON 40
 eH2_1                -9.851476e-02 1 1  ON 41
 eH2_2                -4.735066e-02 1 1  ON 42
 eH2_3                -1.657432e-02 1 1  ON 43
 eH2_4                 1.621866e-02 1 1  ON 44
 eH2_5                 2.082543e-02 1 1  ON 45
 eH2_6                 7.492581e-02 1 1  ON 46
 eH2_7                 1.118351e-01 1 1  ON 47
 eH2_8                 1.013099e-01 1 1  ON 48
 eH2_9                 2.846074e-02 1 1  ON 49
ci_001                -4.238381e-02 3 1  ON 50
ci_002                -3.076029e-02 3 1  ON 51
ci_003                -1.132069e-02 3 1  ON 52
ci_004                 2.599583e-02 3 1  ON 53
ci_005                 2.578173e-02 3 1  ON 54
ci_006                -2.104868e-02 3 1  ON 55
ci_007                -2.010696e-02 3 1  ON 56
ci_008                -4.676595e-03 3 1  ON 57
ci_009                -1.541578e-02 3 1  ON 58
ci_010                -9.819797e-03 3 1  ON 59
ci_011                -9.710338e-03 3 1  ON 60
ci_012                -9.370201e-03 3 1  ON 61
ci_013                -2.185797e-02 3 1  ON 62
ci_014                 1.325281e-02 3 1  ON 63
ci_015                 1.304394e-02 3 1  ON 64
ci_016                 1.652296e-02 3 1  ON 65
ci_017                 1.636165e-02 3 1  ON 66
ci_018                 1.077628e-02 3 1  ON 67
ci_019                 1.072450e-02 3 1  ON 68
ci_020                 1.814458e-02 3 1  ON 69
ci_021                 1.822323e-02 3 1  ON 70
ci_022                 1.031011e-02 3 1  ON 71
ci_023                 1.040955e-02 3 1  ON 72
ci_024                 7.296668e-03 3 1  ON 73
ci_025                 6.815853e-03 3 1  ON 74
ci_026                 1.157617e-02 3 1  ON 75
ci_027                 1.252517e-02 3 1  ON 76
ci_028                -8.762720e-03 3 1  ON 77
ci_029                -1.011255e-02 3 1  ON 78
ci_030                -5.742837e-03 3 1  ON 79
ci_031                -4.894737e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2577e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7182e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2299
    reference variance = 0.357523
====================================================
  Execution time = 1.9659e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5433e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.1001e-01
  Total weights = 1.973596357e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5132e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296807624209
                                         uncertainty =       0.004891943973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296807624209
                                         uncertainty =       0.004891943973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385228078
  error estimate for blocks of size 2^( 2) =       0.000400163732
  error estimate for blocks of size 2^( 3) =       0.000413908142
  error estimate for blocks of size 2^( 4) =       0.000423882630
  error estimate for blocks of size 2^( 5) =       0.000429878088
  error estimate for blocks of size 2^( 6) =       0.000433698740
  error estimate for blocks of size 2^( 7) =       0.000436530029

      target function =      -0.897429488974
              le_mean =     -17.205792127827
             les_mean =     296.349287788973
             stat err =       0.000430997372
             autocorr =       1.251737824356
   target nu stat err =       0.000430997372
   target dn stat err =       0.009724370664
      target stat err =       0.014490566925
              std dev =       0.544794772515
             le_variance =       0.296801344159


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720579212783e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897661093867       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898114500518       residual = 3.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898243952049       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898300873556       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898308441114       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898323576525       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898328454297       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898337421241       residual = 9.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898344916477       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898347697197       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.898350207890       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.898351355323       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.898353118149       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.898356831715       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.898358518810       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.898360441753       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.898362504660       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.898362114828       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.898363901404       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.898364479778       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.898365870972       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.898367677401       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.898369610966       residual = 7.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.898369898468       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.898370010560       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.898370684377       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.898371205866       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.898370204380       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.898370703217       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.898370451208       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.898370357927       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.898369800372       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.898370464654       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.898370976867       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.898370740180       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.898370888280       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.898370890925       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.898371244640       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.898371421507       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.898371498096       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.898371508370       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.898371768194       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.898371798855       residual = 7.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.1035e-02 is 6.160178e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897661093867       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897851149853       residual = 3.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897902608767       residual = 9.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897924304631       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897927399399       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897932768568       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897935303959       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897938664143       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897940980952       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897941926618       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.897942631436       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.897943116574       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.897943713909       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.897945315514       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.897945752824       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.897946062461       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.897946661134       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.897946738113       residual = 8.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.897947041690       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.897946872450       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.897947781557       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.897948349362       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.897948119696       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.897948275896       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.897948406643       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.897948212955       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.897948302117       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.897948285539       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.897948220460       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.897948226252       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.897948094319       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.897948097748       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.897948229476       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.897948202940       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.897948195284       residual = 9.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.897948272525       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.897948272488       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.897948329856       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.897948338579       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.4414e-01 is 1.628241e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897661093867       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897718277684       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897733404641       residual = 9.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897739665024       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897740601988       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897742088887       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897742943584       residual = 9.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897743890820       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897744491820       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897744741722       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.897744898025       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.897745071379       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.897745243270       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.897745729554       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.897745808723       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.897745858478       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.897746035092       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.897746061711       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.897746093047       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.897746048831       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.897746322700       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.897746425678       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.897746361462       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.897746382010       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.897746387994       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.897746357009       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.897746375858       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.897746364289       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.897746364954       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.897746339415       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.897746322391       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.897746335532       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.897746355381       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.897746339784       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.897746351962       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.897746363882       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.897746364380       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.897746375253       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e-01 is 4.130703e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.262727 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5251e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
  uu_0                 2.110258e-01 1 1  ON 0
  uu_1                 5.360243e-02 1 1  ON 1
  uu_2                -3.781575e-02 1 1  ON 2
  uu_3                -9.186568e-02 1 1  ON 3
  uu_4                -1.232345e-01 1 1  ON 4
  uu_5                -1.317603e-01 1 1  ON 5
  uu_6                -1.142276e-01 1 1  ON 6
  uu_7                -5.660137e-02 1 1  ON 7
  uu_8                 6.393749e-02 1 1  ON 8
  uu_9                 1.246908e-01 1 1  ON 9
  ud_0                 3.055246e-01 1 1  ON 10
  ud_1                 7.634157e-02 1 1  ON 11
  ud_2                -2.569781e-02 1 1  ON 12
  ud_3                -7.881076e-02 1 1  ON 13
  ud_4                -1.147612e-01 1 1  ON 14
  ud_5                -1.337055e-01 1 1  ON 15
  ud_6                -1.278557e-01 1 1  ON 16
  ud_7                -8.640693e-02 1 1  ON 17
  ud_8                -4.315384e-03 1 1  ON 18
  ud_9                 8.693248e-02 1 1  ON 19
  eO_0                -7.036178e-01 1 1  ON 20
  eO_1                -4.201005e-01 1 1  ON 21
  eO_2                -4.101206e-02 1 1  ON 22
  eO_3                 1.850742e-01 1 1  ON 23
  eO_4                 2.584135e-01 1 1  ON 24
  eO_5                 2.820848e-01 1 1  ON 25
  eO_6                 2.500252e-01 1 1  ON 26
  eO_7                 1.298234e-01 1 1  ON 27
  eO_8                 2.887868e-02 1 1  ON 28
  eO_9                 1.908900e-02 1 1  ON 29
 eH1_0                -2.031486e-01 1 1  ON 30
 eH1_1                -9.760058e-02 1 1  ON 31
 eH1_2                -4.571717e-02 1 1  ON 32
 eH1_3                -1.419452e-02 1 1  ON 33
 eH1_4                 1.943240e-02 1 1  ON 34
 eH1_5                 2.432468e-02 1 1  ON 35
 eH1_6                 7.308060e-02 1 1  ON 36
 eH1_7                 1.031105e-01 1 1  ON 37
 eH1_8                 9.914523e-02 1 1  ON 38
 eH1_9                 2.571056e-02 1 1  ON 39
 eH2_0                -2.046505e-01 1 1  ON 40
 eH2_1                -9.850237e-02 1 1  ON 41
 eH2_2                -4.751520e-02 1 1  ON 42
 eH2_3                -1.631641e-02 1 1  ON 43
 eH2_4                 1.666981e-02 1 1  ON 44
 eH2_5                 2.034651e-02 1 1  ON 45
 eH2_6                 7.543140e-02 1 1  ON 46
 eH2_7                 1.116913e-01 1 1  ON 47
 eH2_8                 1.017198e-01 1 1  ON 48
 eH2_9                 2.850566e-02 1 1  ON 49
ci_001                -4.277279e-02 3 1  ON 50
ci_002                -3.107669e-02 3 1  ON 51
ci_003                -1.086235e-02 3 1  ON 52
ci_004                 2.619015e-02 3 1  ON 53
ci_005                 2.607154e-02 3 1  ON 54
ci_006                -2.044702e-02 3 1  ON 55
ci_007                -2.020499e-02 3 1  ON 56
ci_008                -4.907712e-03 3 1  ON 57
ci_009                -1.526400e-02 3 1  ON 58
ci_010                -1.014932e-02 3 1  ON 59
ci_011                -9.394150e-03 3 1  ON 60
ci_012                -9.312016e-03 3 1  ON 61
ci_013                -2.154055e-02 3 1  ON 62
ci_014                 1.360761e-02 3 1  ON 63
ci_015                 1.259156e-02 3 1  ON 64
ci_016                 1.612585e-02 3 1  ON 65
ci_017                 1.595869e-02 3 1  ON 66
ci_018                 1.071603e-02 3 1  ON 67
ci_019                 1.062654e-02 3 1  ON 68
ci_020                 1.819701e-02 3 1  ON 69
ci_021                 1.816527e-02 3 1  ON 70
ci_022                 9.865669e-03 3 1  ON 71
ci_023                 1.018618e-02 3 1  ON 72
ci_024                 7.130443e-03 3 1  ON 73
ci_025                 6.989214e-03 3 1  ON 74
ci_026                 1.161533e-02 3 1  ON 75
ci_027                 1.244305e-02 3 1  ON 76
ci_028                -9.050679e-03 3 1  ON 77
ci_029                -9.894502e-03 3 1  ON 78
ci_030                -5.096632e-03 3 1  ON 79
ci_031                -5.157693e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2759
    reference variance = 0.607253
====================================================
  Execution time = 1.9257e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9709e-01
  Total weights = 1.9739e+06
  Execution time = 1.6202e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289137378165
                                         uncertainty =       0.001654763812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289137378165
                                         uncertainty =       0.001654763812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380212332
  error estimate for blocks of size 2^( 2) =       0.000395384043
  error estimate for blocks of size 2^( 3) =       0.000408862801
  error estimate for blocks of size 2^( 4) =       0.000418791523
  error estimate for blocks of size 2^( 5) =       0.000424430695
  error estimate for blocks of size 2^( 6) =       0.000427494587
  error estimate for blocks of size 2^( 7) =       0.000428120204

      target function =      -0.915458432780
              le_mean =     -17.206150552543
             les_mean =     296.349886593218
             stat err =       0.000424709252
             autocorr =       1.247759964170
   target nu stat err =       0.000424709252
   target dn stat err =       0.002357348440
      target stat err =       0.003722452125
              std dev =       0.537701436232
             le_variance =       0.289122834525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289703251108
                                         uncertainty =       0.001642449429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289703251108
                                         uncertainty =       0.001642449429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380583715
  error estimate for blocks of size 2^( 2) =       0.000395808440
  error estimate for blocks of size 2^( 3) =       0.000409350443
  error estimate for blocks of size 2^( 4) =       0.000419343617
  error estimate for blocks of size 2^( 5) =       0.000425046203
  error estimate for blocks of size 2^( 6) =       0.000428111952
  error estimate for blocks of size 2^( 7) =       0.000428585116

      target function =      -0.892963195399
              le_mean =     -17.206166616689
             les_mean =     296.365100256034
             stat err =       0.000425271722
             autocorr =       1.248626678844
   target nu stat err =       0.000425271722
   target dn stat err =       0.011877791400
      target stat err =       0.017530777059
              std dev =       0.538226651064
             le_variance =       0.289687927916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289499326891
                                         uncertainty =       0.001637158744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289499326891
                                         uncertainty =       0.001637158744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380449875
  error estimate for blocks of size 2^( 2) =       0.000395667641
  error estimate for blocks of size 2^( 3) =       0.000409202302
  error estimate for blocks of size 2^( 4) =       0.000419186176
  error estimate for blocks of size 2^( 5) =       0.000424879513
  error estimate for blocks of size 2^( 6) =       0.000427932208
  error estimate for blocks of size 2^( 7) =       0.000428475018

      target function =      -0.914642100700
              le_mean =     -17.206150667639
             les_mean =     296.350417111600
             stat err =       0.000425118229
             autocorr =       1.248603541877
   target nu stat err =       0.000425118229
   target dn stat err =       0.002457500355
      target stat err =       0.003868165328
              std dev =       0.538037373665
             le_variance =       0.289484215460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289158241556
                                         uncertainty =       0.001651343046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289158241556
                                         uncertainty =       0.001651343046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380226008
  error estimate for blocks of size 2^( 2) =       0.000395404873
  error estimate for blocks of size 2^( 3) =       0.000408891776
  error estimate for blocks of size 2^( 4) =       0.000418828169
  error estimate for blocks of size 2^( 5) =       0.000424475028
  error estimate for blocks of size 2^( 6) =       0.000427535669
  error estimate for blocks of size 2^( 7) =       0.000428150083

      target function =      -0.917125151131
              le_mean =     -17.206146884790
             les_mean =     296.348688196556
             stat err =       0.000424747237
             autocorr =       1.247893393801
   target nu stat err =       0.000424747237
   target dn stat err =       0.002146992985
      target stat err =       0.003415358706
              std dev =       0.537720777107
             le_variance =       0.289143634133


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915458432780        initial
     6.1035e-02     6.1035e-01             6.1602e-03        -0.892963195399
     2.4414e-01     2.4414e+00             1.6282e-03        -0.914642100700
     9.7656e-01     9.7656e+00             4.1307e-04        -0.917125151131  <--

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.7397e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
  uu_0                 2.100962e-01 1 1  ON 0
  uu_1                 5.276586e-02 1 1  ON 1
  uu_2                -3.836943e-02 1 1  ON 2
  uu_3                -9.209561e-02 1 1  ON 3
  uu_4                -1.232501e-01 1 1  ON 4
  uu_5                -1.314684e-01 1 1  ON 5
  uu_6                -1.136284e-01 1 1  ON 6
  uu_7                -5.567972e-02 1 1  ON 7
  uu_8                 6.515266e-02 1 1  ON 8
  uu_9                 1.245363e-01 1 1  ON 9
  ud_0                 3.058771e-01 1 1  ON 10
  ud_1                 7.647718e-02 1 1  ON 11
  ud_2                -2.556693e-02 1 1  ON 12
  ud_3                -7.869146e-02 1 1  ON 13
  ud_4                -1.146939e-01 1 1  ON 14
  ud_5                -1.337759e-01 1 1  ON 15
  ud_6                -1.280737e-01 1 1  ON 16
  ud_7                -8.679528e-02 1 1  ON 17
  ud_8                -4.532962e-03 1 1  ON 18
  ud_9                 8.724651e-02 1 1  ON 19
  eO_0                -7.035699e-01 1 1  ON 20
  eO_1                -4.200768e-01 1 1  ON 21
  eO_2                -4.126009e-02 1 1  ON 22
  eO_3                 1.850145e-01 1 1  ON 23
  eO_4                 2.584271e-01 1 1  ON 24
  eO_5                 2.826581e-01 1 1  ON 25
  eO_6                 2.504655e-01 1 1  ON 26
  eO_7                 1.290862e-01 1 1  ON 27
  eO_8                 2.884894e-02 1 1  ON 28
  eO_9                 1.908672e-02 1 1  ON 29
 eH1_0                -2.031066e-01 1 1  ON 30
 eH1_1                -9.754034e-02 1 1  ON 31
 eH1_2                -4.589742e-02 1 1  ON 32
 eH1_3                -1.449443e-02 1 1  ON 33
 eH1_4                 1.891811e-02 1 1  ON 34
 eH1_5                 2.453418e-02 1 1  ON 35
 eH1_6                 7.333874e-02 1 1  ON 36
 eH1_7                 1.038669e-01 1 1  ON 37
 eH1_8                 9.888103e-02 1 1  ON 38
 eH1_9                 2.562804e-02 1 1  ON 39
 eH2_0                -2.039809e-01 1 1  ON 40
 eH2_1                -9.850290e-02 1 1  ON 41
 eH2_2                -4.739627e-02 1 1  ON 42
 eH2_3                -1.649378e-02 1 1  ON 43
 eH2_4                 1.635349e-02 1 1  ON 44
 eH2_5                 2.068660e-02 1 1  ON 45
 eH2_6                 7.506509e-02 1 1  ON 46
 eH2_7                 1.117979e-01 1 1  ON 47
 eH2_8                 1.014144e-01 1 1  ON 48
 eH2_9                 2.847215e-02 1 1  ON 49
ci_001                -4.249705e-02 3 1  ON 50
ci_002                -3.085301e-02 3 1  ON 51
ci_003                -1.118252e-02 3 1  ON 52
ci_004                 2.605281e-02 3 1  ON 53
ci_005                 2.586743e-02 3 1  ON 54
ci_006                -2.087205e-02 3 1  ON 55
ci_007                -2.013543e-02 3 1  ON 56
ci_008                -4.747756e-03 3 1  ON 57
ci_009                -1.536982e-02 3 1  ON 58
ci_010                -9.919112e-03 3 1  ON 59
ci_011                -9.614995e-03 3 1  ON 60
ci_012                -9.352196e-03 3 1  ON 61
ci_013                -2.176552e-02 3 1  ON 62
ci_014                 1.335809e-02 3 1  ON 63
ci_015                 1.290822e-02 3 1  ON 64
ci_016                 1.640552e-02 3 1  ON 65
ci_017                 1.624242e-02 3 1  ON 66
ci_018                 1.075808e-02 3 1  ON 67
ci_019                 1.069424e-02 3 1  ON 68
ci_020                 1.816084e-02 3 1  ON 69
ci_021                 1.820628e-02 3 1  ON 70
ci_022                 1.017666e-02 3 1  ON 71
ci_023                 1.034211e-02 3 1  ON 72
ci_024                 7.248025e-03 3 1  ON 73
ci_025                 6.867201e-03 3 1  ON 74
ci_026                 1.158696e-02 3 1  ON 75
ci_027                 1.249848e-02 3 1  ON 76
ci_028                -8.847527e-03 3 1  ON 77
ci_029                -1.004741e-02 3 1  ON 78
ci_030                -5.544469e-03 3 1  ON 79
ci_031                -4.974769e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2654e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7186e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1653
    reference variance = 0.138975
====================================================
  Execution time = 1.9492e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5434e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0006e-01
  Total weights = 1.973666082e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291971528111
                                         uncertainty =       0.002373289105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291971528111
                                         uncertainty =       0.002373289105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382110263
  error estimate for blocks of size 2^( 2) =       0.000397105582
  error estimate for blocks of size 2^( 3) =       0.000410931640
  error estimate for blocks of size 2^( 4) =       0.000420784749
  error estimate for blocks of size 2^( 5) =       0.000427270904
  error estimate for blocks of size 2^( 6) =       0.000431406708
  error estimate for blocks of size 2^( 7) =       0.000432766499

      target function =      -0.912689357161
              le_mean =     -17.206036565402
             les_mean =     296.347754464024
             stat err =       0.000428057215
             autocorr =       1.254949466023
   target nu stat err =       0.000428057215
   target dn stat err =       0.002807099158
      target stat err =       0.004381977990
              std dev =       0.540385516598
             le_variance =       0.292016506549


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720603656540e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912709277733       residual = 4.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912768632082       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912785453968       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912794954945       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912798314251       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912799541333       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912800073916       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912800427620       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912800306741       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912800352958       residual = 9.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912800704652       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912800914200       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912801547791       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912802232085       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912802034349       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912801997649       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912801970703       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912802351007       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912802543491       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912802644119       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912802857978       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912802876989       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912802820000       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912803027096       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912803083879       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912803079320       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912803200118       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912803218011       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912803199491       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912803254071       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912803243869       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912803322032       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912803247268       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912803264573       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912803277433       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912803294515       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912803299431       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.4414e-01 is 1.362154e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912709277733       residual = 4.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912727363894       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912732323651       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912735104160       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912736061555       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912736393159       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912736543449       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912736635427       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912736600882       residual = 9.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912736609492       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912736720666       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912736785741       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912736967026       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912737126606       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912737058736       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912737057209       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912737060440       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912737152268       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912737201403       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912737232156       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912737279213       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912737279010       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912737262009       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912737301737       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912737321238       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912737322401       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912737347821       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912737346879       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912737344103       residual = 9.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912737357968       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912737355479       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912737367942       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912737350405       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912737358749       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912737361567       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912737363465       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e-01 is 3.502699e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912709277733       residual = 4.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912714060971       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912715358717       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912716084678       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912716333014       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912716417687       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912716456253       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912716479125       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912716470237       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912716472186       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912716501951       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912716519257       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912716566055       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912716604536       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912716586249       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912716586881       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912716588459       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912716610694       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912716623237       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912716631291       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912716642434       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912716641930       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912716637469       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912716646836       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912716651954       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912716652377       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912716658395       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912716657789       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912716657406       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912716660730       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912716660071       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912716662658       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912716658557       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912716660835       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912716661441       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912716661788       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+00 is 8.822861e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.315558 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5168e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
  uu_0                 2.101755e-01 1 1  ON 0
  uu_1                 5.277996e-02 1 1  ON 1
  uu_2                -3.840594e-02 1 1  ON 2
  uu_3                -9.210831e-02 1 1  ON 3
  uu_4                -1.232269e-01 1 1  ON 4
  uu_5                -1.313594e-01 1 1  ON 5
  uu_6                -1.135701e-01 1 1  ON 6
  uu_7                -5.570977e-02 1 1  ON 7
  uu_8                 6.480239e-02 1 1  ON 8
  uu_9                 1.245379e-01 1 1  ON 9
  ud_0                 3.058072e-01 1 1  ON 10
  ud_1                 7.644892e-02 1 1  ON 11
  ud_2                -2.564203e-02 1 1  ON 12
  ud_3                -7.876403e-02 1 1  ON 13
  ud_4                -1.147244e-01 1 1  ON 14
  ud_5                -1.337390e-01 1 1  ON 15
  ud_6                -1.279811e-01 1 1  ON 16
  ud_7                -8.659429e-02 1 1  ON 17
  ud_8                -4.694007e-03 1 1  ON 18
  ud_9                 8.720201e-02 1 1  ON 19
  eO_0                -7.036026e-01 1 1  ON 20
  eO_1                -4.200201e-01 1 1  ON 21
  eO_2                -4.119868e-02 1 1  ON 22
  eO_3                 1.849683e-01 1 1  ON 23
  eO_4                 2.582767e-01 1 1  ON 24
  eO_5                 2.823934e-01 1 1  ON 25
  eO_6                 2.505872e-01 1 1  ON 26
  eO_7                 1.292959e-01 1 1  ON 27
  eO_8                 2.887168e-02 1 1  ON 28
  eO_9                 1.909081e-02 1 1  ON 29
 eH1_0                -2.031114e-01 1 1  ON 30
 eH1_1                -9.741662e-02 1 1  ON 31
 eH1_2                -4.584245e-02 1 1  ON 32
 eH1_3                -1.451904e-02 1 1  ON 33
 eH1_4                 1.886217e-02 1 1  ON 34
 eH1_5                 2.437718e-02 1 1  ON 35
 eH1_6                 7.334592e-02 1 1  ON 36
 eH1_7                 1.037792e-01 1 1  ON 37
 eH1_8                 9.899272e-02 1 1  ON 38
 eH1_9                 2.564415e-02 1 1  ON 39
 eH2_0                -2.039856e-01 1 1  ON 40
 eH2_1                -9.854337e-02 1 1  ON 41
 eH2_2                -4.741282e-02 1 1  ON 42
 eH2_3                -1.645035e-02 1 1  ON 43
 eH2_4                 1.641763e-02 1 1  ON 44
 eH2_5                 2.074143e-02 1 1  ON 45
 eH2_6                 7.497616e-02 1 1  ON 46
 eH2_7                 1.116352e-01 1 1  ON 47
 eH2_8                 1.015332e-01 1 1  ON 48
 eH2_9                 2.850422e-02 1 1  ON 49
ci_001                -4.246056e-02 3 1  ON 50
ci_002                -3.087253e-02 3 1  ON 51
ci_003                -1.121679e-02 3 1  ON 52
ci_004                 2.610506e-02 3 1  ON 53
ci_005                 2.590255e-02 3 1  ON 54
ci_006                -2.082248e-02 3 1  ON 55
ci_007                -2.009491e-02 3 1  ON 56
ci_008                -4.712985e-03 3 1  ON 57
ci_009                -1.533399e-02 3 1  ON 58
ci_010                -9.966572e-03 3 1  ON 59
ci_011                -9.615354e-03 3 1  ON 60
ci_012                -9.432008e-03 3 1  ON 61
ci_013                -2.170990e-02 3 1  ON 62
ci_014                 1.330286e-02 3 1  ON 63
ci_015                 1.290920e-02 3 1  ON 64
ci_016                 1.632853e-02 3 1  ON 65
ci_017                 1.617281e-02 3 1  ON 66
ci_018                 1.080693e-02 3 1  ON 67
ci_019                 1.072559e-02 3 1  ON 68
ci_020                 1.814945e-02 3 1  ON 69
ci_021                 1.818974e-02 3 1  ON 70
ci_022                 1.028022e-02 3 1  ON 71
ci_023                 1.030261e-02 3 1  ON 72
ci_024                 7.115088e-03 3 1  ON 73
ci_025                 6.885193e-03 3 1  ON 74
ci_026                 1.162008e-02 3 1  ON 75
ci_027                 1.240193e-02 3 1  ON 76
ci_028                -8.873467e-03 3 1  ON 77
ci_029                -1.002083e-02 3 1  ON 78
ci_030                -5.476779e-03 3 1  ON 79
ci_031                -4.946040e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1872
    reference variance = 0.232794
====================================================
  Execution time = 1.9294e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0168e-01
  Total weights = 1.9737e+06
  Execution time = 1.6155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291994235943
                                         uncertainty =       0.002251617619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291994235943
                                         uncertainty =       0.002251617619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382165445
  error estimate for blocks of size 2^( 2) =       0.000397098431
  error estimate for blocks of size 2^( 3) =       0.000410532233
  error estimate for blocks of size 2^( 4) =       0.000420577234
  error estimate for blocks of size 2^( 5) =       0.000426613392
  error estimate for blocks of size 2^( 6) =       0.000431116671
  error estimate for blocks of size 2^( 7) =       0.000433459401

      target function =      -0.909757688055
              le_mean =     -17.206479797885
             les_mean =     296.364895895068
             stat err =       0.000427941674
             autocorr =       1.253909898696
   target nu stat err =       0.000427941674
   target dn stat err =       0.003996503024
      target stat err =       0.006161308689
              std dev =       0.540463555553
             le_variance =       0.292100854881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291990811860
                                         uncertainty =       0.002245228506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291990811860
                                         uncertainty =       0.002245228506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382163501
  error estimate for blocks of size 2^( 2) =       0.000397103509
  error estimate for blocks of size 2^( 3) =       0.000410544633
  error estimate for blocks of size 2^( 4) =       0.000420602523
  error estimate for blocks of size 2^( 5) =       0.000426648090
  error estimate for blocks of size 2^( 6) =       0.000431172214
  error estimate for blocks of size 2^( 7) =       0.000433506403

      target function =      -0.910750553741
              le_mean =     -17.206473466068
             les_mean =     296.364036154429
             stat err =       0.000427982308
             autocorr =       1.254160790824
   target nu stat err =       0.000427982308
   target dn stat err =       0.003535268622
      target stat err =       0.005472288384
              std dev =       0.540460805703
             le_variance =       0.292097882501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291987988330
                                         uncertainty =       0.002247623321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291987988330
                                         uncertainty =       0.002247623321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382161543
  error estimate for blocks of size 2^( 2) =       0.000397098352
  error estimate for blocks of size 2^( 3) =       0.000410536009
  error estimate for blocks of size 2^( 4) =       0.000420588415
  error estimate for blocks of size 2^( 5) =       0.000426630080
  error estimate for blocks of size 2^( 6) =       0.000431145173
  error estimate for blocks of size 2^( 7) =       0.000433483007

      target function =      -0.910493211075
              le_mean =     -17.206475424637
             les_mean =     296.364269289488
             stat err =       0.000427961668
             autocorr =       1.254052680730
   target nu stat err =       0.000427961668
   target dn stat err =       0.003699488833
      target stat err =       0.005718997832
              std dev =       0.540458036867
             le_variance =       0.292094889614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291992377648
                                         uncertainty =       0.002251062628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291992377648
                                         uncertainty =       0.002251062628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382164255
  error estimate for blocks of size 2^( 2) =       0.000397097735
  error estimate for blocks of size 2^( 3) =       0.000410532026
  error estimate for blocks of size 2^( 4) =       0.000420578001
  error estimate for blocks of size 2^( 5) =       0.000426614881
  error estimate for blocks of size 2^( 6) =       0.000431119694
  error estimate for blocks of size 2^( 7) =       0.000433461812

      target function =      -0.909935137256
              le_mean =     -17.206479123632
             les_mean =     296.364757408065
             stat err =       0.000427943597
             autocorr =       1.253928978105
   target nu stat err =       0.000427943597
   target dn stat err =       0.003952693133
      target stat err =       0.006097044041
              std dev =       0.540461872289
             le_variance =       0.292099035398


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909757688055        initial
     2.4414e-01     2.4414e+00             1.3622e-03        -0.910750553741  <--
     9.7656e-01     9.7656e+00             3.5027e-04        -0.910493211075
     3.9062e+00     3.9062e+01             8.8229e-05        -0.909935137256

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 2.7400e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
  uu_0                 2.103624e-01 1 1  ON 0
  uu_1                 5.282047e-02 1 1  ON 1
  uu_2                -3.847832e-02 1 1  ON 2
  uu_3                -9.212327e-02 1 1  ON 3
  uu_4                -1.231505e-01 1 1  ON 4
  uu_5                -1.310764e-01 1 1  ON 5
  uu_6                -1.133998e-01 1 1  ON 6
  uu_7                -5.579436e-02 1 1  ON 7
  uu_8                 6.379050e-02 1 1  ON 8
  uu_9                 1.245388e-01 1 1  ON 9
  ud_0                 3.056209e-01 1 1  ON 10
  ud_1                 7.635523e-02 1 1  ON 11
  ud_2                -2.583938e-02 1 1  ON 12
  ud_3                -7.895295e-02 1 1  ON 13
  ud_4                -1.148082e-01 1 1  ON 14
  ud_5                -1.336467e-01 1 1  ON 15
  ud_6                -1.277330e-01 1 1  ON 16
  ud_7                -8.606379e-02 1 1  ON 17
  ud_8                -5.128656e-03 1 1  ON 18
  ud_9                 8.706939e-02 1 1  ON 19
  eO_0                -7.036619e-01 1 1  ON 20
  eO_1                -4.198828e-01 1 1  ON 21
  eO_2                -4.106830e-02 1 1  ON 22
  eO_3                 1.848194e-01 1 1  ON 23
  eO_4                 2.578505e-01 1 1  ON 24
  eO_5                 2.816540e-01 1 1  ON 25
  eO_6                 2.509397e-01 1 1  ON 26
  eO_7                 1.299175e-01 1 1  ON 27
  eO_8                 2.894010e-02 1 1  ON 28
  eO_9                 1.910281e-02 1 1  ON 29
 eH1_0                -2.031022e-01 1 1  ON 30
 eH1_1                -9.711961e-02 1 1  ON 31
 eH1_2                -4.570741e-02 1 1  ON 32
 eH1_3                -1.457737e-02 1 1  ON 33
 eH1_4                 1.870963e-02 1 1  ON 34
 eH1_5                 2.396555e-02 1 1  ON 35
 eH1_6                 7.335344e-02 1 1  ON 36
 eH1_7                 1.035266e-01 1 1  ON 37
 eH1_8                 9.932239e-02 1 1  ON 38
 eH1_9                 2.569228e-02 1 1  ON 39
 eH2_0                -2.040066e-01 1 1  ON 40
 eH2_1                -9.863754e-02 1 1  ON 41
 eH2_2                -4.744972e-02 1 1  ON 42
 eH2_3                -1.634620e-02 1 1  ON 43
 eH2_4                 1.658443e-02 1 1  ON 44
 eH2_5                 2.089247e-02 1 1  ON 45
 eH2_6                 7.473852e-02 1 1  ON 46
 eH2_7                 1.111576e-01 1 1  ON 47
 eH2_8                 1.018827e-01 1 1  ON 48
 eH2_9                 2.859955e-02 1 1  ON 49
ci_001                -4.237358e-02 3 1  ON 50
ci_002                -3.092055e-02 3 1  ON 51
ci_003                -1.129665e-02 3 1  ON 52
ci_004                 2.623380e-02 3 1  ON 53
ci_005                 2.598280e-02 3 1  ON 54
ci_006                -2.070396e-02 3 1  ON 55
ci_007                -1.999867e-02 3 1  ON 56
ci_008                -4.634680e-03 3 1  ON 57
ci_009                -1.525107e-02 3 1  ON 58
ci_010                -1.007725e-02 3 1  ON 59
ci_011                -9.616448e-03 3 1  ON 60
ci_012                -9.618216e-03 3 1  ON 61
ci_013                -2.157299e-02 3 1  ON 62
ci_014                 1.317348e-02 3 1  ON 63
ci_015                 1.291231e-02 3 1  ON 64
ci_016                 1.614371e-02 3 1  ON 65
ci_017                 1.600471e-02 3 1  ON 66
ci_018                 1.091854e-02 3 1  ON 67
ci_019                 1.079795e-02 3 1  ON 68
ci_020                 1.812459e-02 3 1  ON 69
ci_021                 1.815418e-02 3 1  ON 70
ci_022                 1.052290e-02 3 1  ON 71
ci_023                 1.020965e-02 3 1  ON 72
ci_024                 6.797666e-03 3 1  ON 73
ci_025                 6.927625e-03 3 1  ON 74
ci_026                 1.170011e-02 3 1  ON 75
ci_027                 1.218272e-02 3 1  ON 76
ci_028                -8.935168e-03 3 1  ON 77
ci_029                -9.958779e-03 3 1  ON 78
ci_030                -5.323092e-03 3 1  ON 79
ci_031                -4.880617e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2580e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7185e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1964
    reference variance = 0.304798
====================================================
  Execution time = 1.9561e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5433e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0344e-01
  Total weights = 1.973668648e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0661e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293334389781
                                         uncertainty =       0.002710217925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293334389781
                                         uncertainty =       0.002710217925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382905983
  error estimate for blocks of size 2^( 2) =       0.000397948460
  error estimate for blocks of size 2^( 3) =       0.000412371739
  error estimate for blocks of size 2^( 4) =       0.000422585095
  error estimate for blocks of size 2^( 5) =       0.000428378698
  error estimate for blocks of size 2^( 6) =       0.000431813060
  error estimate for blocks of size 2^( 7) =       0.000432813537

      target function =      -0.907418491537
              le_mean =     -17.206286536600
             les_mean =     296.359739657248
             stat err =       0.000428897597
             autocorr =       1.254650958660
   target nu stat err =       0.000428897597
   target dn stat err =       0.006402982997
      target stat err =       0.009777014713
              std dev =       0.541510833674
             le_variance =       0.293233982987


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720628653660e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907522138049       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907905198101       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907972496651       residual = 8.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907999302782       residual = 4.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908009855022       residual = 7.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908012154390       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908014862794       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908014726791       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908020783678       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908025588126       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908026583500       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908028682912       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.908031155751       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.908036477051       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.908039557676       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.908039991330       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.908040286898       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.908041540313       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.908041986574       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908042705220       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.908044649372       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.908045387671       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908045647134       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.908045882648       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.908045893795       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908048177250       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.908048242353       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.908048796517       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.908048012867       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908048152485       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.908048503837       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.908048270992       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.908048525881       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908048612459       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.908048861060       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.908049162833       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.908049171757       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.908049161107       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.908049130637       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.908048906526       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.908049002958       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.908049061370       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.908049021526       residual = 9.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.908049041166       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.908049023686       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.1035e-02 is 4.686693e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907522138049       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907688306828       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907715588409       residual = 7.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907725621558       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907729270963       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907730095035       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907730852800       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907731062591       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907733357150       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907734625620       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.907735092001       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.907735905122       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.907736970507       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.907738601378       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.907739317587       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.907739172045       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.907739415379       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.907739634303       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.907739848993       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.907740043078       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.907740475018       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.907740581138       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.907740547762       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.907740723566       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.907740854740       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.907741214567       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.907741063249       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.907741076560       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.907741001393       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.907740991601       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.907741078866       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.907740986364       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.907741042111       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.907741063114       residual = 9.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.907741092371       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.907741127579       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.907741155093       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.907741115125       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.907741120044       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.4414e-01 is 1.274722e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907522138049       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907573031078       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907581090002       residual = 6.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907583937807       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907584927079       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907585168690       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907585275497       residual = 4.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907585605491       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907585939623       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907586470891       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.907586486751       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.907586778653       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.907587082401       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.907587492265       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.907587649993       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.907587593462       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.907587660415       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.907587722743       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.907587769573       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.907587823453       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.907587908384       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.907587932262       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.907587918191       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.907587986415       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.907588020175       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.907588077374       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.907588026422       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.907588027378       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.907588014546       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.907588014842       residual = 9.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.907588029595       residual = 8.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.907588008536       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.907588023632       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.907588025789       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.907588033003       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.907588039992       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.907588042933       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.907588034300       residual = 7.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e-01 is 3.272251e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.393314 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5716e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
  uu_0                 2.101721e-01 1 1  ON 0
  uu_1                 5.269015e-02 1 1  ON 1
  uu_2                -3.851409e-02 1 1  ON 2
  uu_3                -9.197192e-02 1 1  ON 3
  uu_4                -1.227562e-01 1 1  ON 4
  uu_5                -1.305642e-01 1 1  ON 5
  uu_6                -1.132900e-01 1 1  ON 6
  uu_7                -5.617830e-02 1 1  ON 7
  uu_8                 6.251578e-02 1 1  ON 8
  uu_9                 1.247294e-01 1 1  ON 9
  ud_0                 3.055398e-01 1 1  ON 10
  ud_1                 7.643019e-02 1 1  ON 11
  ud_2                -2.594238e-02 1 1  ON 12
  ud_3                -7.887675e-02 1 1  ON 13
  ud_4                -1.147499e-01 1 1  ON 14
  ud_5                -1.335864e-01 1 1  ON 15
  ud_6                -1.276452e-01 1 1  ON 16
  ud_7                -8.603262e-02 1 1  ON 17
  ud_8                -5.580647e-03 1 1  ON 18
  ud_9                 8.676044e-02 1 1  ON 19
  eO_0                -7.036882e-01 1 1  ON 20
  eO_1                -4.200323e-01 1 1  ON 21
  eO_2                -4.123268e-02 1 1  ON 22
  eO_3                 1.852043e-01 1 1  ON 23
  eO_4                 2.577080e-01 1 1  ON 24
  eO_5                 2.809244e-01 1 1  ON 25
  eO_6                 2.506815e-01 1 1  ON 26
  eO_7                 1.307394e-01 1 1  ON 27
  eO_8                 2.909255e-02 1 1  ON 28
  eO_9                 1.916629e-02 1 1  ON 29
 eH1_0                -2.021740e-01 1 1  ON 30
 eH1_1                -9.611991e-02 1 1  ON 31
 eH1_2                -4.509402e-02 1 1  ON 32
 eH1_3                -1.469621e-02 1 1  ON 33
 eH1_4                 1.831998e-02 1 1  ON 34
 eH1_5                 2.285665e-02 1 1  ON 35
 eH1_6                 7.227204e-02 1 1  ON 36
 eH1_7                 1.030339e-01 1 1  ON 37
 eH1_8                 9.984356e-02 1 1  ON 38
 eH1_9                 2.577681e-02 1 1  ON 39
 eH2_0                -2.034405e-01 1 1  ON 40
 eH2_1                -9.822189e-02 1 1  ON 41
 eH2_2                -4.698961e-02 1 1  ON 42
 eH2_3                -1.596621e-02 1 1  ON 43
 eH2_4                 1.631024e-02 1 1  ON 44
 eH2_5                 2.029179e-02 1 1  ON 45
 eH2_6                 7.348885e-02 1 1  ON 46
 eH2_7                 1.108117e-01 1 1  ON 47
 eH2_8                 1.023312e-01 1 1  ON 48
 eH2_9                 2.870748e-02 1 1  ON 49
ci_001                -4.204017e-02 3 1  ON 50
ci_002                -3.055288e-02 3 1  ON 51
ci_003                -1.147966e-02 3 1  ON 52
ci_004                 2.605699e-02 3 1  ON 53
ci_005                 2.584967e-02 3 1  ON 54
ci_006                -2.062515e-02 3 1  ON 55
ci_007                -1.979933e-02 3 1  ON 56
ci_008                -4.317269e-03 3 1  ON 57
ci_009                -1.500709e-02 3 1  ON 58
ci_010                -9.877631e-03 3 1  ON 59
ci_011                -9.627289e-03 3 1  ON 60
ci_012                -9.709377e-03 3 1  ON 61
ci_013                -2.171565e-02 3 1  ON 62
ci_014                 1.313086e-02 3 1  ON 63
ci_015                 1.259846e-02 3 1  ON 64
ci_016                 1.646466e-02 3 1  ON 65
ci_017                 1.592494e-02 3 1  ON 66
ci_018                 1.105423e-02 3 1  ON 67
ci_019                 1.052826e-02 3 1  ON 68
ci_020                 1.828091e-02 3 1  ON 69
ci_021                 1.813803e-02 3 1  ON 70
ci_022                 1.052823e-02 3 1  ON 71
ci_023                 1.006727e-02 3 1  ON 72
ci_024                 6.674930e-03 3 1  ON 73
ci_025                 6.731407e-03 3 1  ON 74
ci_026                 1.164520e-02 3 1  ON 75
ci_027                 1.151368e-02 3 1  ON 76
ci_028                -9.003384e-03 3 1  ON 77
ci_029                -9.707345e-03 3 1  ON 78
ci_030                -5.800827e-03 3 1  ON 79
ci_031                -4.559928e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1664
    reference variance = 0.20504
====================================================
  Execution time = 1.9021e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9997e-01
  Total weights = 1.9738e+06
  Execution time = 1.5564e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00660817
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292716883304
                                         uncertainty =       0.002261031724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292716883304
                                         uncertainty =       0.002261031724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382522097
  error estimate for blocks of size 2^( 2) =       0.000397711738
  error estimate for blocks of size 2^( 3) =       0.000411922936
  error estimate for blocks of size 2^( 4) =       0.000422670790
  error estimate for blocks of size 2^( 5) =       0.000429624140
  error estimate for blocks of size 2^( 6) =       0.000433798453
  error estimate for blocks of size 2^( 7) =       0.000434967885

      target function =      -0.794748448100
              le_mean =     -17.206772998974
             les_mean =     296.452065610151
             stat err =       0.000430265317
             autocorr =       1.265201283551
   target nu stat err =       0.000430265317
   target dn stat err =       0.077244694088
      target stat err =       0.091500041106
              std dev =       0.540967937240
             le_variance =       0.292646309122

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00238396
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293982280980
                                         uncertainty =       0.002653186401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293982280980
                                         uncertainty =       0.002653186401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383345611
  error estimate for blocks of size 2^( 2) =       0.000398612155
  error estimate for blocks of size 2^( 3) =       0.000412889069
  error estimate for blocks of size 2^( 4) =       0.000423669710
  error estimate for blocks of size 2^( 5) =       0.000430659038
  error estimate for blocks of size 2^( 6) =       0.000434886335
  error estimate for blocks of size 2^( 7) =       0.000436196555

      target function =      -0.605492482554
              le_mean =     -17.206767820922
             les_mean =     296.616971205414
             stat err =       0.000431352909
             autocorr =       1.266147999193
   target nu stat err =       0.000431352909
   target dn stat err =       0.217056576817
      target stat err =       0.157202408787
              std dev =       0.542132561872
             le_variance =       0.293907714642

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00643956
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292556025559
                                         uncertainty =       0.002274796575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292556025559
                                         uncertainty =       0.002274796575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382416871
  error estimate for blocks of size 2^( 2) =       0.000397710689
  error estimate for blocks of size 2^( 3) =       0.000412026279
  error estimate for blocks of size 2^( 4) =       0.000422829840
  error estimate for blocks of size 2^( 5) =       0.000429827150
  error estimate for blocks of size 2^( 6) =       0.000434023165
  error estimate for blocks of size 2^( 7) =       0.000435201532

      target function =      -0.908249625826
              le_mean =     -17.206779708756
             les_mean =     296.376202861415
             stat err =       0.000430470422
             autocorr =       1.267104822127
   target nu stat err =       0.000430470422
   target dn stat err =       0.003575967445
      target stat err =       0.005507775163
              std dev =       0.540819125855
             le_variance =       0.292485326891

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0254654
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295272354161
                                         uncertainty =       0.003560933542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295272354161
                                         uncertainty =       0.003560933542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384185335
  error estimate for blocks of size 2^( 2) =       0.000399348370
  error estimate for blocks of size 2^( 3) =       0.000413467831
  error estimate for blocks of size 2^( 4) =       0.000424185184
  error estimate for blocks of size 2^( 5) =       0.000431103347
  error estimate for blocks of size 2^( 6) =       0.000435251759
  error estimate for blocks of size 2^( 7) =       0.000436701180

      target function =      -0.014056497372
              le_mean =     -17.206738748045
             les_mean =     315.583551005205
             stat err =       0.000431810367
             autocorr =       1.263294377435
   target nu stat err =       0.000431810367
   target dn stat err =      19.220297608514
      target stat err =       0.013642444525
              std dev =       0.543320111711
             le_variance =       0.295196743789


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.794748448100        initial
     6.1035e-02     6.1035e-01             4.6867e-03        -0.605492482554
     2.4414e-01     2.4414e+00             1.2747e-03        -0.908249625826  <--
     9.7656e-01     9.7656e+00             3.2723e-04        -0.014056497372

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 2.6922e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
  uu_0                 2.101721e-01 1 1  ON 0
  uu_1                 5.269015e-02 1 1  ON 1
  uu_2                -3.851409e-02 1 1  ON 2
  uu_3                -9.197192e-02 1 1  ON 3
  uu_4                -1.227562e-01 1 1  ON 4
  uu_5                -1.305642e-01 1 1  ON 5
  uu_6                -1.132900e-01 1 1  ON 6
  uu_7                -5.617830e-02 1 1  ON 7
  uu_8                 6.251578e-02 1 1  ON 8
  uu_9                 1.247294e-01 1 1  ON 9
  ud_0                 3.055398e-01 1 1  ON 10
  ud_1                 7.643019e-02 1 1  ON 11
  ud_2                -2.594238e-02 1 1  ON 12
  ud_3                -7.887675e-02 1 1  ON 13
  ud_4                -1.147499e-01 1 1  ON 14
  ud_5                -1.335864e-01 1 1  ON 15
  ud_6                -1.276452e-01 1 1  ON 16
  ud_7                -8.603262e-02 1 1  ON 17
  ud_8                -5.580647e-03 1 1  ON 18
  ud_9                 8.676044e-02 1 1  ON 19
  eO_0                -7.036882e-01 1 1  ON 20
  eO_1                -4.200323e-01 1 1  ON 21
  eO_2                -4.123268e-02 1 1  ON 22
  eO_3                 1.852043e-01 1 1  ON 23
  eO_4                 2.577080e-01 1 1  ON 24
  eO_5                 2.809244e-01 1 1  ON 25
  eO_6                 2.506815e-01 1 1  ON 26
  eO_7                 1.307394e-01 1 1  ON 27
  eO_8                 2.909255e-02 1 1  ON 28
  eO_9                 1.916629e-02 1 1  ON 29
 eH1_0                -2.021740e-01 1 1  ON 30
 eH1_1                -9.611991e-02 1 1  ON 31
 eH1_2                -4.509402e-02 1 1  ON 32
 eH1_3                -1.469621e-02 1 1  ON 33
 eH1_4                 1.831998e-02 1 1  ON 34
 eH1_5                 2.285665e-02 1 1  ON 35
 eH1_6                 7.227204e-02 1 1  ON 36
 eH1_7                 1.030339e-01 1 1  ON 37
 eH1_8                 9.984356e-02 1 1  ON 38
 eH1_9                 2.577681e-02 1 1  ON 39
 eH2_0                -2.034405e-01 1 1  ON 40
 eH2_1                -9.822189e-02 1 1  ON 41
 eH2_2                -4.698961e-02 1 1  ON 42
 eH2_3                -1.596621e-02 1 1  ON 43
 eH2_4                 1.631024e-02 1 1  ON 44
 eH2_5                 2.029179e-02 1 1  ON 45
 eH2_6                 7.348885e-02 1 1  ON 46
 eH2_7                 1.108117e-01 1 1  ON 47
 eH2_8                 1.023312e-01 1 1  ON 48
 eH2_9                 2.870748e-02 1 1  ON 49
ci_001                -4.204017e-02 3 1  ON 50
ci_002                -3.055288e-02 3 1  ON 51
ci_003                -1.147966e-02 3 1  ON 52
ci_004                 2.605699e-02 3 1  ON 53
ci_005                 2.584967e-02 3 1  ON 54
ci_006                -2.062515e-02 3 1  ON 55
ci_007                -1.979933e-02 3 1  ON 56
ci_008                -4.317269e-03 3 1  ON 57
ci_009                -1.500709e-02 3 1  ON 58
ci_010                -9.877631e-03 3 1  ON 59
ci_011                -9.627289e-03 3 1  ON 60
ci_012                -9.709377e-03 3 1  ON 61
ci_013                -2.171565e-02 3 1  ON 62
ci_014                 1.313086e-02 3 1  ON 63
ci_015                 1.259846e-02 3 1  ON 64
ci_016                 1.646466e-02 3 1  ON 65
ci_017                 1.592494e-02 3 1  ON 66
ci_018                 1.105423e-02 3 1  ON 67
ci_019                 1.052826e-02 3 1  ON 68
ci_020                 1.828091e-02 3 1  ON 69
ci_021                 1.813803e-02 3 1  ON 70
ci_022                 1.052823e-02 3 1  ON 71
ci_023                 1.006727e-02 3 1  ON 72
ci_024                 6.674930e-03 3 1  ON 73
ci_025                 6.731407e-03 3 1  ON 74
ci_026                 1.164520e-02 3 1  ON 75
ci_027                 1.151368e-02 3 1  ON 76
ci_028                -9.003384e-03 3 1  ON 77
ci_029                -9.707345e-03 3 1  ON 78
ci_030                -5.800827e-03 3 1  ON 79
ci_031                -4.559928e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2650e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7185e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2141
    reference variance = 0.25184
====================================================
  Execution time = 1.9088e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5426e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9659e-01
  Total weights = 1.973889902e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5334e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289488734182
                                         uncertainty =       0.001885636706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289488734182
                                         uncertainty =       0.001885636706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380433362
  error estimate for blocks of size 2^( 2) =       0.000395858754
  error estimate for blocks of size 2^( 3) =       0.000409916077
  error estimate for blocks of size 2^( 4) =       0.000419692319
  error estimate for blocks of size 2^( 5) =       0.000426648409
  error estimate for blocks of size 2^( 6) =       0.000430556077
  error estimate for blocks of size 2^( 7) =       0.000432065894

      target function =      -0.918064170747
              le_mean =     -17.205970995166
             les_mean =     296.342031110502
             stat err =       0.000427240675
             autocorr =       1.261211710602
   target nu stat err =       0.000427240675
   target dn stat err =       0.002476313690
      target stat err =       0.003924835493
              std dev =       0.538014019655
             le_variance =       0.289459085345


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720597099517e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918079563011       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918197200708       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918242701343       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918253070620       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918255641092       residual = 8.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918261884456       residual = 8.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918263185223       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918265366495       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918271438446       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918269277830       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918271911930       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918273600256       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918274602845       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918275581952       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918275044828       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918277573996       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918276965599       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918279299570       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918278878712       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918279380569       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918279663996       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918280645645       residual = 8.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918283895537       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918285997996       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918287398597       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918288346744       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918287805284       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918287889327       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918287948903       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918288409320       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918287787837       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918288206886       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918287654720       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918287859550       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918287841641       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918287985039       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.918288094474       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.918288257543       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.918288372236       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.918288236121       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.918288248936       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.918288405247       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.918288304304       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.918288252580       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.918288315459       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         44 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.1035e-02 is 5.188428e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918079563011       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918129924872       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918147983991       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918152021308       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918152673540       residual = 7.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918154549136       residual = 7.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918155301527       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918155333991       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918157670200       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918157033370       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918157668577       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918158313443       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918158581791       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918158836572       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918158617880       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918159509114       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918159354231       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918159877435       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918159713551       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918159969106       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918160219439       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918160656821       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918161415584       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918161763587       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918161878826       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918161813198       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918161652685       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918161705682       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918161688921       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918161714190       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918161596607       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918161648788       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918161585977       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918161593270       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918161576731       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918161625956       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.918161656058       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.918161653557       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.918161670707       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.4414e-01 is 1.311270e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918079563011       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918094881588       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918100158930       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918101351439       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918101482477       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918101984249       residual = 7.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918102205637       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918102129859       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918102797559       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918102644675       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918102795420       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918102978822       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918103041439       residual = 9.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918103099824       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918103044533       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918103299476       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918103255283       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918103367519       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918103324532       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918103415688       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918103506683       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918103611183       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918103775561       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918103827608       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918103830975       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918103796211       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918103769180       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918103784300       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918103774058       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918103771717       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918103758876       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918103760650       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918103750969       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918103752581       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918103749368       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918103763336       residual = 6.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e-01 is 3.547452e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.525466 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4759e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
  uu_0                 2.098767e-01 1 1  ON 0
  uu_1                 5.253919e-02 1 1  ON 1
  uu_2                -3.848575e-02 1 1  ON 2
  uu_3                -9.190877e-02 1 1  ON 3
  uu_4                -1.225831e-01 1 1  ON 4
  uu_5                -1.304254e-01 1 1  ON 5
  uu_6                -1.132005e-01 1 1  ON 6
  uu_7                -5.624806e-02 1 1  ON 7
  uu_8                 6.174136e-02 1 1  ON 8
  uu_9                 1.250224e-01 1 1  ON 9
  ud_0                 3.050382e-01 1 1  ON 10
  ud_1                 7.583600e-02 1 1  ON 11
  ud_2                -2.646697e-02 1 1  ON 12
  ud_3                -7.933714e-02 1 1  ON 13
  ud_4                -1.148563e-01 1 1  ON 14
  ud_5                -1.332968e-01 1 1  ON 15
  ud_6                -1.269581e-01 1 1  ON 16
  ud_7                -8.550980e-02 1 1  ON 17
  ud_8                -5.111259e-03 1 1  ON 18
  ud_9                 8.665027e-02 1 1  ON 19
  eO_0                -7.038411e-01 1 1  ON 20
  eO_1                -4.202385e-01 1 1  ON 21
  eO_2                -4.177680e-02 1 1  ON 22
  eO_3                 1.841800e-01 1 1  ON 23
  eO_4                 2.571035e-01 1 1  ON 24
  eO_5                 2.815870e-01 1 1  ON 25
  eO_6                 2.509870e-01 1 1  ON 26
  eO_7                 1.320120e-01 1 1  ON 27
  eO_8                 2.938230e-02 1 1  ON 28
  eO_9                 1.917965e-02 1 1  ON 29
 eH1_0                -2.021005e-01 1 1  ON 30
 eH1_1                -9.627055e-02 1 1  ON 31
 eH1_2                -4.522710e-02 1 1  ON 32
 eH1_3                -1.461362e-02 1 1  ON 33
 eH1_4                 1.851392e-02 1 1  ON 34
 eH1_5                 2.314417e-02 1 1  ON 35
 eH1_6                 7.131760e-02 1 1  ON 36
 eH1_7                 1.029843e-01 1 1  ON 37
 eH1_8                 1.002685e-01 1 1  ON 38
 eH1_9                 2.598979e-02 1 1  ON 39
 eH2_0                -2.036573e-01 1 1  ON 40
 eH2_1                -9.826277e-02 1 1  ON 41
 eH2_2                -4.692035e-02 1 1  ON 42
 eH2_3                -1.614138e-02 1 1  ON 43
 eH2_4                 1.588152e-02 1 1  ON 44
 eH2_5                 1.898052e-02 1 1  ON 45
 eH2_6                 7.344700e-02 1 1  ON 46
 eH2_7                 1.118767e-01 1 1  ON 47
 eH2_8                 1.033322e-01 1 1  ON 48
 eH2_9                 2.876713e-02 1 1  ON 49
ci_001                -4.207805e-02 3 1  ON 50
ci_002                -3.066428e-02 3 1  ON 51
ci_003                -1.159189e-02 3 1  ON 52
ci_004                 2.600955e-02 3 1  ON 53
ci_005                 2.582459e-02 3 1  ON 54
ci_006                -2.059022e-02 3 1  ON 55
ci_007                -1.974303e-02 3 1  ON 56
ci_008                -4.173239e-03 3 1  ON 57
ci_009                -1.514385e-02 3 1  ON 58
ci_010                -9.853977e-03 3 1  ON 59
ci_011                -9.360674e-03 3 1  ON 60
ci_012                -9.758444e-03 3 1  ON 61
ci_013                -2.180569e-02 3 1  ON 62
ci_014                 1.331762e-02 3 1  ON 63
ci_015                 1.276070e-02 3 1  ON 64
ci_016                 1.633462e-02 3 1  ON 65
ci_017                 1.596215e-02 3 1  ON 66
ci_018                 1.095403e-02 3 1  ON 67
ci_019                 1.044614e-02 3 1  ON 68
ci_020                 1.850673e-02 3 1  ON 69
ci_021                 1.822590e-02 3 1  ON 70
ci_022                 1.080215e-02 3 1  ON 71
ci_023                 1.027869e-02 3 1  ON 72
ci_024                 6.836621e-03 3 1  ON 73
ci_025                 6.858817e-03 3 1  ON 74
ci_026                 1.137557e-02 3 1  ON 75
ci_027                 1.144131e-02 3 1  ON 76
ci_028                -9.222923e-03 3 1  ON 77
ci_029                -9.511394e-03 3 1  ON 78
ci_030                -5.845436e-03 3 1  ON 79
ci_031                -4.733764e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1667
    reference variance = 0.232336
====================================================
  Execution time = 1.9310e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9864e-01
  Total weights = 1.9736e+06
  Execution time = 1.5551e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289830288154
                                         uncertainty =       0.001618424310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289830288154
                                         uncertainty =       0.001618424310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380620835
  error estimate for blocks of size 2^( 2) =       0.000396005249
  error estimate for blocks of size 2^( 3) =       0.000410163900
  error estimate for blocks of size 2^( 4) =       0.000420528844
  error estimate for blocks of size 2^( 5) =       0.000427724352
  error estimate for blocks of size 2^( 6) =       0.000431432776
  error estimate for blocks of size 2^( 7) =       0.000435110113

      target function =      -0.907661568186
              le_mean =     -17.207226361273
             les_mean =     296.391928585941
             stat err =       0.000428699021
             autocorr =       1.268585869218
   target nu stat err =       0.000428699021
   target dn stat err =       0.005036702612
      target stat err =       0.007720771867
              std dev =       0.538279146519
             le_variance =       0.289744439577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290031265456
                                         uncertainty =       0.001683021860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290031265456
                                         uncertainty =       0.001683021860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380751921
  error estimate for blocks of size 2^( 2) =       0.000396146642
  error estimate for blocks of size 2^( 3) =       0.000410343602
  error estimate for blocks of size 2^( 4) =       0.000420737122
  error estimate for blocks of size 2^( 5) =       0.000427953205
  error estimate for blocks of size 2^( 6) =       0.000431679246
  error estimate for blocks of size 2^( 7) =       0.000435397756

      target function =      -0.910149839420
              le_mean =     -17.207212587661
             les_mean =     296.389847384897
             stat err =       0.000428941832
             autocorr =       1.269148963702
   target nu stat err =       0.000428941832
   target dn stat err =       0.003784636747
      target stat err =       0.005852375645
              std dev =       0.538464530072
             le_variance =       0.289944050145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289834907578
                                         uncertainty =       0.001642327631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289834907578
                                         uncertainty =       0.001642327631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380623394
  error estimate for blocks of size 2^( 2) =       0.000396016685
  error estimate for blocks of size 2^( 3) =       0.000410200825
  error estimate for blocks of size 2^( 4) =       0.000420584836
  error estimate for blocks of size 2^( 5) =       0.000427798460
  error estimate for blocks of size 2^( 6) =       0.000431519708
  error estimate for blocks of size 2^( 7) =       0.000435219870

      target function =      -0.913424409236
              le_mean =     -17.207215768163
             les_mean =     296.387842900389
             stat err =       0.000428780718
             autocorr =       1.269052358189
   target nu stat err =       0.000428780719
   target dn stat err =       0.002617046173
      target stat err =       0.004109294274
              std dev =       0.538282765863
             le_variance =       0.289748336025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289807190410
                                         uncertainty =       0.001620221665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289807190410
                                         uncertainty =       0.001620221665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380605618
  error estimate for blocks of size 2^( 2) =       0.000395991165
  error estimate for blocks of size 2^( 3) =       0.000410153435
  error estimate for blocks of size 2^( 4) =       0.000420521322
  error estimate for blocks of size 2^( 5) =       0.000427719654
  error estimate for blocks of size 2^( 6) =       0.000431430779
  error estimate for blocks of size 2^( 7) =       0.000435107253

      target function =      -0.914602093226
              le_mean =     -17.207224379227
             les_mean =     296.387380782929
             stat err =       0.000428694752
             autocorr =       1.268662038879
   target nu stat err =       0.000428694752
   target dn stat err =       0.002290884206
      target stat err =       0.003623363621
              std dev =       0.538257627079
             le_variance =       0.289721273108


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.907661568186        initial
     6.1035e-02     6.1035e-01             5.1884e-03        -0.910149839420
     2.4414e-01     2.4414e+00             1.3113e-03        -0.913424409236
     9.7656e-01     9.7656e+00             3.5475e-04        -0.914602093226  <--

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.7172e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
  uu_0                 2.100850e-01 1 1  ON 0
  uu_1                 5.264705e-02 1 1  ON 1
  uu_2                -3.850345e-02 1 1  ON 2
  uu_3                -9.195221e-02 1 1  ON 3
  uu_4                -1.227045e-01 1 1  ON 4
  uu_5                -1.305236e-01 1 1  ON 5
  uu_6                -1.132684e-01 1 1  ON 6
  uu_7                -5.619368e-02 1 1  ON 7
  uu_8                 6.231812e-02 1 1  ON 8
  uu_9                 1.248033e-01 1 1  ON 9
  ud_0                 3.054066e-01 1 1  ON 10
  ud_1                 7.626793e-02 1 1  ON 11
  ud_2                -2.608457e-02 1 1  ON 12
  ud_3                -7.900216e-02 1 1  ON 13
  ud_4                -1.147729e-01 1 1  ON 14
  ud_5                -1.334990e-01 1 1  ON 15
  ud_6                -1.274500e-01 1 1  ON 16
  ud_7                -8.589741e-02 1 1  ON 17
  ud_8                -5.465178e-03 1 1  ON 18
  ud_9                 8.673164e-02 1 1  ON 19
  eO_0                -7.037092e-01 1 1  ON 20
  eO_1                -4.200667e-01 1 1  ON 21
  eO_2                -4.136503e-02 1 1  ON 22
  eO_3                 1.849296e-01 1 1  ON 23
  eO_4                 2.575432e-01 1 1  ON 24
  eO_5                 2.810927e-01 1 1  ON 25
  eO_6                 2.507525e-01 1 1  ON 26
  eO_7                 1.310552e-01 1 1  ON 27
  eO_8                 2.916427e-02 1 1  ON 28
  eO_9                 1.916960e-02 1 1  ON 29
 eH1_0                -2.021478e-01 1 1  ON 30
 eH1_1                -9.616342e-02 1 1  ON 31
 eH1_2                -4.513258e-02 1 1  ON 32
 eH1_3                -1.467054e-02 1 1  ON 33
 eH1_4                 1.837466e-02 1 1  ON 34
 eH1_5                 2.293840e-02 1 1  ON 35
 eH1_6                 7.201536e-02 1 1  ON 36
 eH1_7                 1.030232e-01 1 1  ON 37
 eH1_8                 9.994881e-02 1 1  ON 38
 eH1_9                 2.582968e-02 1 1  ON 39
 eH2_0                -2.034990e-01 1 1  ON 40
 eH2_1                -9.822559e-02 1 1  ON 41
 eH2_2                -4.695864e-02 1 1  ON 42
 eH2_3                -1.600677e-02 1 1  ON 43
 eH2_4                 1.620339e-02 1 1  ON 44
 eH2_5                 1.993704e-02 1 1  ON 45
 eH2_6                 7.348977e-02 1 1  ON 46
 eH2_7                 1.110771e-01 1 1  ON 47
 eH2_8                 1.025787e-01 1 1  ON 48
 eH2_9                 2.872211e-02 1 1  ON 49
ci_001                -4.205072e-02 3 1  ON 50
ci_002                -3.058562e-02 3 1  ON 51
ci_003                -1.151336e-02 3 1  ON 52
ci_004                 2.604537e-02 3 1  ON 53
ci_005                 2.584325e-02 3 1  ON 54
ci_006                -2.061497e-02 3 1  ON 55
ci_007                -1.978270e-02 3 1  ON 56
ci_008                -4.273273e-03 3 1  ON 57
ci_009                -1.504820e-02 3 1  ON 58
ci_010                -9.870841e-03 3 1  ON 59
ci_011                -9.547700e-03 3 1  ON 60
ci_012                -9.723828e-03 3 1  ON 61
ci_013                -2.174220e-02 3 1  ON 62
ci_014                 1.318606e-02 3 1  ON 63
ci_015                 1.264656e-02 3 1  ON 64
ci_016                 1.642752e-02 3 1  ON 65
ci_017                 1.593636e-02 3 1  ON 66
ci_018                 1.102370e-02 3 1  ON 67
ci_019                 1.050250e-02 3 1  ON 68
ci_020                 1.834734e-02 3 1  ON 69
ci_021                 1.816437e-02 3 1  ON 70
ci_022                 1.060960e-02 3 1  ON 71
ci_023                 1.013011e-02 3 1  ON 72
ci_024                 6.722554e-03 3 1  ON 73
ci_025                 6.768731e-03 3 1  ON 74
ci_026                 1.156409e-02 3 1  ON 75
ci_027                 1.149218e-02 3 1  ON 76
ci_028                -9.068507e-03 3 1  ON 77
ci_029                -9.649753e-03 3 1  ON 78
ci_030                -5.814438e-03 3 1  ON 79
ci_031                -4.612636e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1939e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7185e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2994
    reference variance = 0.655363
====================================================
  Execution time = 1.9012e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5425e+04
  VMC Eavg = -1.7208e+01
  VMC Evar = 3.0434e-01
  Total weights = 1.973720348e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5372e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294704142525
                                         uncertainty =       0.002241826841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294704142525
                                         uncertainty =       0.002241826841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383922157
  error estimate for blocks of size 2^( 2) =       0.000399378400
  error estimate for blocks of size 2^( 3) =       0.000413163823
  error estimate for blocks of size 2^( 4) =       0.000423468605
  error estimate for blocks of size 2^( 5) =       0.000429924734
  error estimate for blocks of size 2^( 6) =       0.000435138007
  error estimate for blocks of size 2^( 7) =       0.000437314123

      target function =      -0.906094116426
              le_mean =     -17.207558888830
             les_mean =     296.404421243582
             stat err =       0.000431461367
             autocorr =       1.262982920513
   target nu stat err =       0.000431461367
   target dn stat err =       0.002975575781
      target stat err =       0.004585863207
              std dev =       0.542947921106
             le_variance =       0.294792445033


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720755888883e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906115978131       residual = 6.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906194848159       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906221330080       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906224116477       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906225242444       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906226329541       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906226693412       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906226966483       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906226237067       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906225893810       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906226673430       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906227499001       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.906227190275       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.906227350123       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.906227672336       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.906228090088       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.906228408619       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.906228809824       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.906228630483       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.906229105153       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.906229191643       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.906229122961       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.906229108590       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.906229282382       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.906229450965       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.906229552262       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.906229409891       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.906229487238       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.906229454752       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.906229433177       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.906229428752       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.906229406166       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.906229457300       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.906229537541       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.906229513816       residual = 5.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.906229558883       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.906229577706       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.906229597460       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.906229580817       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.4414e-01 is 1.598172e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906115978131       residual = 6.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906140022180       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906147833203       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906148590222       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906148916263       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906149203352       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906149297533       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906149350523       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906149174410       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906149057132       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906149293863       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906149520926       residual = 9.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.906149408387       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.906149453553       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.906149567912       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.906149671604       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.906149749164       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.906149842265       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.906149792596       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.906149909186       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.906149926693       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.906149904971       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.906149892412       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.906149944065       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.906149976687       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.906149995784       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.906149963608       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.906149978098       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.906149980819       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.906149966663       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.906149967298       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.906149970309       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.906149979850       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.906149987038       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.906149989652       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.906149997790       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e-01 is 4.098172e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906115978131       residual = 6.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906122337993       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906124381728       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906124575531       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906124660347       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906124733951       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906124756279       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906124768029       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906124725051       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906124693344       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906124755679       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906124813570       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.906124782484       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.906124794590       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.906124825873       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.906124851466       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.906124870603       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.906124892926       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.906124880395       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.906124909674       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.906124913041       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.906124907240       residual = 9.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.906124904108       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.906124917300       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.906124924675       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.906124929055       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.906124921329       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.906124924984       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.906124925942       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.906124922040       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.906124922354       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.906124923717       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.906124925588       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.906124926724       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.906124928113       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.906124929492       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+00 is 1.032666e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.581324 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4611e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
  uu_0                 2.101013e-01 1 1  ON 0
  uu_1                 5.266560e-02 1 1  ON 1
  uu_2                -3.847931e-02 1 1  ON 2
  uu_3                -9.192645e-02 1 1  ON 3
  uu_4                -1.226435e-01 1 1  ON 4
  uu_5                -1.304482e-01 1 1  ON 5
  uu_6                -1.130998e-01 1 1  ON 6
  uu_7                -5.624670e-02 1 1  ON 7
  uu_8                 6.190831e-02 1 1  ON 8
  uu_9                 1.247838e-01 1 1  ON 9
  ud_0                 3.053244e-01 1 1  ON 10
  ud_1                 7.621610e-02 1 1  ON 11
  ud_2                -2.611387e-02 1 1  ON 12
  ud_3                -7.904460e-02 1 1  ON 13
  ud_4                -1.148146e-01 1 1  ON 14
  ud_5                -1.334989e-01 1 1  ON 15
  ud_6                -1.272582e-01 1 1  ON 16
  ud_7                -8.569674e-02 1 1  ON 17
  ud_8                -5.571722e-03 1 1  ON 18
  ud_9                 8.661830e-02 1 1  ON 19
  eO_0                -7.036047e-01 1 1  ON 20
  eO_1                -4.200428e-01 1 1  ON 21
  eO_2                -4.142373e-02 1 1  ON 22
  eO_3                 1.848388e-01 1 1  ON 23
  eO_4                 2.574477e-01 1 1  ON 24
  eO_5                 2.809473e-01 1 1  ON 25
  eO_6                 2.507585e-01 1 1  ON 26
  eO_7                 1.313138e-01 1 1  ON 27
  eO_8                 2.917480e-02 1 1  ON 28
  eO_9                 1.915657e-02 1 1  ON 29
 eH1_0                -2.020940e-01 1 1  ON 30
 eH1_1                -9.615164e-02 1 1  ON 31
 eH1_2                -4.501873e-02 1 1  ON 32
 eH1_3                -1.452786e-02 1 1  ON 33
 eH1_4                 1.844859e-02 1 1  ON 34
 eH1_5                 2.270725e-02 1 1  ON 35
 eH1_6                 7.173287e-02 1 1  ON 36
 eH1_7                 1.030027e-01 1 1  ON 37
 eH1_8                 1.000761e-01 1 1  ON 38
 eH1_9                 2.584231e-02 1 1  ON 39
 eH2_0                -2.034483e-01 1 1  ON 40
 eH2_1                -9.818037e-02 1 1  ON 41
 eH2_2                -4.687694e-02 1 1  ON 42
 eH2_3                -1.594041e-02 1 1  ON 43
 eH2_4                 1.622108e-02 1 1  ON 44
 eH2_5                 1.989125e-02 1 1  ON 45
 eH2_6                 7.327183e-02 1 1  ON 46
 eH2_7                 1.109629e-01 1 1  ON 47
 eH2_8                 1.026811e-01 1 1  ON 48
 eH2_9                 2.874475e-02 1 1  ON 49
ci_001                -4.206531e-02 3 1  ON 50
ci_002                -3.062664e-02 3 1  ON 51
ci_003                -1.145183e-02 3 1  ON 52
ci_004                 2.596327e-02 3 1  ON 53
ci_005                 2.586113e-02 3 1  ON 54
ci_006                -2.051968e-02 3 1  ON 55
ci_007                -1.971343e-02 3 1  ON 56
ci_008                -4.191909e-03 3 1  ON 57
ci_009                -1.503380e-02 3 1  ON 58
ci_010                -9.735625e-03 3 1  ON 59
ci_011                -9.591945e-03 3 1  ON 60
ci_012                -9.702893e-03 3 1  ON 61
ci_013                -2.173471e-02 3 1  ON 62
ci_014                 1.319167e-02 3 1  ON 63
ci_015                 1.270727e-02 3 1  ON 64
ci_016                 1.641355e-02 3 1  ON 65
ci_017                 1.601443e-02 3 1  ON 66
ci_018                 1.106160e-02 3 1  ON 67
ci_019                 1.054334e-02 3 1  ON 68
ci_020                 1.835580e-02 3 1  ON 69
ci_021                 1.811777e-02 3 1  ON 70
ci_022                 1.054753e-02 3 1  ON 71
ci_023                 1.007905e-02 3 1  ON 72
ci_024                 6.665226e-03 3 1  ON 73
ci_025                 6.726110e-03 3 1  ON 74
ci_026                 1.160561e-02 3 1  ON 75
ci_027                 1.150888e-02 3 1  ON 76
ci_028                -8.953924e-03 3 1  ON 77
ci_029                -9.709625e-03 3 1  ON 78
ci_030                -5.701993e-03 3 1  ON 79
ci_031                -4.569632e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1547
    reference variance = 0.212646
====================================================
  Execution time = 1.9404e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0013e-01
  Total weights = 1.9735e+06
  Execution time = 1.5661e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292036747279
                                         uncertainty =       0.001745802615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292036747279
                                         uncertainty =       0.001745802615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382142887
  error estimate for blocks of size 2^( 2) =       0.000397004225
  error estimate for blocks of size 2^( 3) =       0.000411043268
  error estimate for blocks of size 2^( 4) =       0.000421161753
  error estimate for blocks of size 2^( 5) =       0.000427457888
  error estimate for blocks of size 2^( 6) =       0.000431131758
  error estimate for blocks of size 2^( 7) =       0.000433357932

      target function =      -0.910039637962
              le_mean =     -17.206254771984
             les_mean =     296.356976004377
             stat err =       0.000428277333
             autocorr =       1.256025965765
   target nu stat err =       0.000428277333
   target dn stat err =       0.003688631200
      target stat err =       0.005694586199
              std dev =       0.540431653647
             le_variance =       0.292066372263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292017540988
                                         uncertainty =       0.001740513473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292017540988
                                         uncertainty =       0.001740513473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382130371
  error estimate for blocks of size 2^( 2) =       0.000397050085
  error estimate for blocks of size 2^( 3) =       0.000411149346
  error estimate for blocks of size 2^( 4) =       0.000421312096
  error estimate for blocks of size 2^( 5) =       0.000427632586
  error estimate for blocks of size 2^( 6) =       0.000431321667
  error estimate for blocks of size 2^( 7) =       0.000433573568

      target function =      -0.914086077515
              le_mean =     -17.206260308771
             les_mean =     296.354550846945
             stat err =       0.000428459979
             autocorr =       1.257179852218
   target nu stat err =       0.000428459979
   target dn stat err =       0.002150721072
      target stat err =       0.003400936152
              std dev =       0.540413953585
             le_variance =       0.292047241230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292018354893
                                         uncertainty =       0.001742514315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292018354893
                                         uncertainty =       0.001742514315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382130896
  error estimate for blocks of size 2^( 2) =       0.000397027217
  error estimate for blocks of size 2^( 3) =       0.000411102121
  error estimate for blocks of size 2^( 4) =       0.000421246820
  error estimate for blocks of size 2^( 5) =       0.000427557119
  error estimate for blocks of size 2^( 6) =       0.000431239988
  error estimate for blocks of size 2^( 7) =       0.000433481469

      target function =      -0.913414303288
              le_mean =     -17.206257416996
             les_mean =     296.354885592904
             stat err =       0.000428381349
             autocorr =       1.256715012835
   target nu stat err =       0.000428381349
   target dn stat err =       0.002271737836
      target stat err =       0.003578645096
              std dev =       0.540414695235
             le_variance =       0.292048042826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292032693426
                                         uncertainty =       0.001745332568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292032693426
                                         uncertainty =       0.001745332568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382140242
  error estimate for blocks of size 2^( 2) =       0.000397006227
  error estimate for blocks of size 2^( 3) =       0.000411050003
  error estimate for blocks of size 2^( 4) =       0.000421171954
  error estimate for blocks of size 2^( 5) =       0.000427469922
  error estimate for blocks of size 2^( 6) =       0.000431144897
  error estimate for blocks of size 2^( 7) =       0.000433373041

      target function =      -0.911003186277
              le_mean =     -17.206255062438
             les_mean =     296.356362894711
             stat err =       0.000428289954
             autocorr =       1.256117382078
   target nu stat err =       0.000428289954
   target dn stat err =       0.003218040548
      target stat err =       0.004990952351
              std dev =       0.540427913200
             le_variance =       0.292062329366


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910039637962        initial
     2.4414e-01     2.4414e+00             1.5982e-03        -0.914086077515  <--
     9.7656e-01     9.7656e+00             4.0982e-04        -0.913414303288
     3.9062e+00     3.9062e+01             1.0327e-04        -0.911003186277

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 2.7300e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
  uu_0                 2.101573e-01 1 1  ON 0
  uu_1                 5.272815e-02 1 1  ON 1
  uu_2                -3.840223e-02 1 1  ON 2
  uu_3                -9.184176e-02 1 1  ON 3
  uu_4                -1.224728e-01 1 1  ON 4
  uu_5                -1.302302e-01 1 1  ON 5
  uu_6                -1.126621e-01 1 1  ON 6
  uu_7                -5.637758e-02 1 1  ON 7
  uu_8                 6.071995e-02 1 1  ON 8
  uu_9                 1.247179e-01 1 1  ON 9
  ud_0                 3.051110e-01 1 1  ON 10
  ud_1                 7.607092e-02 1 1  ON 11
  ud_2                -2.620607e-02 1 1  ON 12
  ud_3                -7.916107e-02 1 1  ON 13
  ud_4                -1.149190e-01 1 1  ON 14
  ud_5                -1.334842e-01 1 1  ON 15
  ud_6                -1.267588e-01 1 1  ON 16
  ud_7                -8.514978e-02 1 1  ON 17
  ud_8                -5.846649e-03 1 1  ON 18
  ud_9                 8.627982e-02 1 1  ON 19
  eO_0                -7.033608e-01 1 1  ON 20
  eO_1                -4.199863e-01 1 1  ON 21
  eO_2                -4.157748e-02 1 1  ON 22
  eO_3                 1.845876e-01 1 1  ON 23
  eO_4                 2.571653e-01 1 1  ON 24
  eO_5                 2.805518e-01 1 1  ON 25
  eO_6                 2.507702e-01 1 1  ON 26
  eO_7                 1.320911e-01 1 1  ON 27
  eO_8                 2.920835e-02 1 1  ON 28
  eO_9                 1.911721e-02 1 1  ON 29
 eH1_0                -2.019336e-01 1 1  ON 30
 eH1_1                -9.608215e-02 1 1  ON 31
 eH1_2                -4.471536e-02 1 1  ON 32
 eH1_3                -1.416044e-02 1 1  ON 33
 eH1_4                 1.863113e-02 1 1  ON 34
 eH1_5                 2.210084e-02 1 1  ON 35
 eH1_6                 7.091446e-02 1 1  ON 36
 eH1_7                 1.029290e-01 1 1  ON 37
 eH1_8                 1.004574e-01 1 1  ON 38
 eH1_9                 2.588123e-02 1 1  ON 39
 eH2_0                -2.033021e-01 1 1  ON 40
 eH2_1                -9.804098e-02 1 1  ON 41
 eH2_2                -4.665416e-02 1 1  ON 42
 eH2_3                -1.575706e-02 1 1  ON 43
 eH2_4                 1.627457e-02 1 1  ON 44
 eH2_5                 1.975440e-02 1 1  ON 45
 eH2_6                 7.265894e-02 1 1  ON 46
 eH2_7                 1.106183e-01 1 1  ON 47
 eH2_8                 1.029879e-01 1 1  ON 48
 eH2_9                 2.881322e-02 1 1  ON 49
ci_001                -4.210197e-02 3 1  ON 50
ci_002                -3.072482e-02 3 1  ON 51
ci_003                -1.130857e-02 3 1  ON 52
ci_004                 2.576888e-02 3 1  ON 53
ci_005                 2.590616e-02 3 1  ON 54
ci_006                -2.028816e-02 3 1  ON 55
ci_007                -1.954409e-02 3 1  ON 56
ci_008                -4.009605e-03 3 1  ON 57
ci_009                -1.500060e-02 3 1  ON 58
ci_010                -9.421443e-03 3 1  ON 59
ci_011                -9.695110e-03 3 1  ON 60
ci_012                -9.654592e-03 3 1  ON 61
ci_013                -2.171659e-02 3 1  ON 62
ci_014                 1.320502e-02 3 1  ON 63
ci_015                 1.285004e-02 3 1  ON 64
ci_016                 1.638150e-02 3 1  ON 65
ci_017                 1.620562e-02 3 1  ON 66
ci_018                 1.114574e-02 3 1  ON 67
ci_019                 1.063749e-02 3 1  ON 68
ci_020                 1.837881e-02 3 1  ON 69
ci_021                 1.800842e-02 3 1  ON 70
ci_022                 1.040135e-02 3 1  ON 71
ci_023                 9.959485e-03 3 1  ON 72
ci_024                 6.528725e-03 3 1  ON 73
ci_025                 6.625702e-03 3 1  ON 74
ci_026                 1.169578e-02 3 1  ON 75
ci_027                 1.154872e-02 3 1  ON 76
ci_028                -8.683909e-03 3 1  ON 77
ci_029                -9.852446e-03 3 1  ON 78
ci_030                -5.446686e-03 3 1  ON 79
ci_031                -4.472380e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1919e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7187e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1517
    reference variance = 0.307959
====================================================
  Execution time = 1.8997e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5420e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9862e-01
  Total weights = 1.973869275e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5095e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291114181128
                                         uncertainty =       0.002071834599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291114181128
                                         uncertainty =       0.002071834599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381545267
  error estimate for blocks of size 2^( 2) =       0.000396949900
  error estimate for blocks of size 2^( 3) =       0.000410849996
  error estimate for blocks of size 2^( 4) =       0.000421121339
  error estimate for blocks of size 2^( 5) =       0.000427090464
  error estimate for blocks of size 2^( 6) =       0.000429066706
  error estimate for blocks of size 2^( 7) =       0.000430259589

      target function =      -0.914928357735
              le_mean =     -17.205715336070
             les_mean =     296.335255975756
             stat err =       0.000426884525
             autocorr =       1.251781941026
   target nu stat err =       0.000426884525
   target dn stat err =       0.002468326759
      target stat err =       0.003884438175
              std dev =       0.539586490575
             le_variance =       0.291153580812


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720571533607e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914943987945       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915070124034       residual = 9.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915103039985       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915109692481       residual = 8.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915111725461       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915113608874       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915113814099       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915113399517       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915113664371       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915112664438       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915114762665       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915115999510       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915117591546       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915120278620       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915121718440       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915122077032       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915121333808       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915123065872       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915123289855       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915121730386       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915121533062       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915122178805       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915123108890       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915123263671       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915123451385       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915123884366       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915124079303       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915124213457       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915124902985       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915125044493       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915125132341       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915125462606       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915125909627       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915125984985       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915125829528       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915125807368       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915125703319       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915125697208       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915125626602       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915125618935       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.915125478313       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.915125716332       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.915125787254       residual = 9.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         42 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.1035e-02 is 6.265102e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914943987945       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914997786463       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915011298006       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915013956317       residual = 7.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915014657419       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915015172052       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915015338211       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915014953279       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915015152190       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915014790447       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915015648036       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915016144460       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915016822123       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915017639939       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915017884957       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915017981639       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915017921144       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915018314284       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915018064735       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915017639636       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915017827461       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915017971325       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915018107655       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915018104561       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915018027897       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915018304307       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915018297423       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915018407856       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915018443421       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915018479613       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915018485555       residual = 9.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915018579956       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915018640056       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915018629174       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915018591512       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915018559207       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915018572213       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915018546238       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.4414e-01 is 1.722250e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914943987945       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914960320064       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914964348912       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914965134154       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914965320258       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914965439316       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914965497719       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914965357440       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914965428674       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914965332508       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914965588005       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914965730452       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914965924088       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914966128689       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914966172415       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914966199418       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914966215471       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914966285468       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914966172998       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914966094509       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914966174484       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914966184263       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914966206808       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914966209999       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914966199294       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914966263202       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914966257759       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914966277041       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914966287336       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914966297111       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914966302117       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914966320591       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914966329123       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914966324770       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914966314752       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914966310184       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e-01 is 4.414165e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.649958 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4581e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
  uu_0                 2.100789e-01 1 1  ON 0
  uu_1                 5.284352e-02 1 1  ON 1
  uu_2                -3.815892e-02 1 1  ON 2
  uu_3                -9.151652e-02 1 1  ON 3
  uu_4                -1.220917e-01 1 1  ON 4
  uu_5                -1.297772e-01 1 1  ON 5
  uu_6                -1.125632e-01 1 1  ON 6
  uu_7                -5.665307e-02 1 1  ON 7
  uu_8                 5.899770e-02 1 1  ON 8
  uu_9                 1.247769e-01 1 1  ON 9
  ud_0                 3.053159e-01 1 1  ON 10
  ud_1                 7.603758e-02 1 1  ON 11
  ud_2                -2.625308e-02 1 1  ON 12
  ud_3                -7.919357e-02 1 1  ON 13
  ud_4                -1.149596e-01 1 1  ON 14
  ud_5                -1.334357e-01 1 1  ON 15
  ud_6                -1.264841e-01 1 1  ON 16
  ud_7                -8.530645e-02 1 1  ON 17
  ud_8                -6.151381e-03 1 1  ON 18
  ud_9                 8.590960e-02 1 1  ON 19
  eO_0                -7.036940e-01 1 1  ON 20
  eO_1                -4.202003e-01 1 1  ON 21
  eO_2                -4.159820e-02 1 1  ON 22
  eO_3                 1.845712e-01 1 1  ON 23
  eO_4                 2.568271e-01 1 1  ON 24
  eO_5                 2.798757e-01 1 1  ON 25
  eO_6                 2.515768e-01 1 1  ON 26
  eO_7                 1.327455e-01 1 1  ON 27
  eO_8                 2.926796e-02 1 1  ON 28
  eO_9                 1.918646e-02 1 1  ON 29
 eH1_0                -2.014960e-01 1 1  ON 30
 eH1_1                -9.578663e-02 1 1  ON 31
 eH1_2                -4.455332e-02 1 1  ON 32
 eH1_3                -1.421732e-02 1 1  ON 33
 eH1_4                 1.840124e-02 1 1  ON 34
 eH1_5                 2.156153e-02 1 1  ON 35
 eH1_6                 7.064073e-02 1 1  ON 36
 eH1_7                 1.027294e-01 1 1  ON 37
 eH1_8                 1.007651e-01 1 1  ON 38
 eH1_9                 2.596652e-02 1 1  ON 39
 eH2_0                -2.031844e-01 1 1  ON 40
 eH2_1                -9.777554e-02 1 1  ON 41
 eH2_2                -4.645019e-02 1 1  ON 42
 eH2_3                -1.566379e-02 1 1  ON 43
 eH2_4                 1.629670e-02 1 1  ON 44
 eH2_5                 2.011548e-02 1 1  ON 45
 eH2_6                 7.198331e-02 1 1  ON 46
 eH2_7                 1.098852e-01 1 1  ON 47
 eH2_8                 1.031829e-01 1 1  ON 48
 eH2_9                 2.892680e-02 1 1  ON 49
ci_001                -4.203231e-02 3 1  ON 50
ci_002                -3.086547e-02 3 1  ON 51
ci_003                -1.120554e-02 3 1  ON 52
ci_004                 2.564470e-02 3 1  ON 53
ci_005                 2.578820e-02 3 1  ON 54
ci_006                -2.019325e-02 3 1  ON 55
ci_007                -1.962653e-02 3 1  ON 56
ci_008                -4.050734e-03 3 1  ON 57
ci_009                -1.518996e-02 3 1  ON 58
ci_010                -9.354510e-03 3 1  ON 59
ci_011                -9.833678e-03 3 1  ON 60
ci_012                -9.894036e-03 3 1  ON 61
ci_013                -2.149334e-02 3 1  ON 62
ci_014                 1.329497e-02 3 1  ON 63
ci_015                 1.300554e-02 3 1  ON 64
ci_016                 1.624401e-02 3 1  ON 65
ci_017                 1.623045e-02 3 1  ON 66
ci_018                 1.079562e-02 3 1  ON 67
ci_019                 1.077712e-02 3 1  ON 68
ci_020                 1.832804e-02 3 1  ON 69
ci_021                 1.816695e-02 3 1  ON 70
ci_022                 1.038393e-02 3 1  ON 71
ci_023                 1.031671e-02 3 1  ON 72
ci_024                 6.757791e-03 3 1  ON 73
ci_025                 6.524766e-03 3 1  ON 74
ci_026                 1.151118e-02 3 1  ON 75
ci_027                 1.152756e-02 3 1  ON 76
ci_028                -8.894438e-03 3 1  ON 77
ci_029                -9.740969e-03 3 1  ON 78
ci_030                -5.370171e-03 3 1  ON 79
ci_031                -4.707852e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1911
    reference variance = 0.16184
====================================================
  Execution time = 1.9068e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9658e-01
  Total weights = 1.9737e+06
  Execution time = 1.5541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289198390396
                                         uncertainty =       0.001570430009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289198390396
                                         uncertainty =       0.001570430009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380360897
  error estimate for blocks of size 2^( 2) =       0.000395263105
  error estimate for blocks of size 2^( 3) =       0.000409419881
  error estimate for blocks of size 2^( 4) =       0.000418669141
  error estimate for blocks of size 2^( 5) =       0.000425048082
  error estimate for blocks of size 2^( 6) =       0.000426963754
  error estimate for blocks of size 2^( 7) =       0.000429461586

      target function =      -0.917694209118
              le_mean =     -17.206883329256
             les_mean =     296.373659803395
             stat err =       0.000425035641
             autocorr =       1.248702470310
   target nu stat err =       0.000425035641
   target dn stat err =       0.002100818577
      target stat err =       0.003353932119
              std dev =       0.537911539645
             le_variance =       0.289348824483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289023712422
                                         uncertainty =       0.001576221302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289023712422
                                         uncertainty =       0.001576221302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380246060
  error estimate for blocks of size 2^( 2) =       0.000395093532
  error estimate for blocks of size 2^( 3) =       0.000409204332
  error estimate for blocks of size 2^( 4) =       0.000418434013
  error estimate for blocks of size 2^( 5) =       0.000424789592
  error estimate for blocks of size 2^( 6) =       0.000426693783
  error estimate for blocks of size 2^( 7) =       0.000429192804

      target function =      -0.915981491340
              le_mean =     -17.206886441339
             les_mean =     296.374866590219
             stat err =       0.000424777548
             autocorr =       1.247939877946
   target nu stat err =       0.000424777548
   target dn stat err =       0.002226074984
      target stat err =       0.003531874031
              std dev =       0.537749134604
             le_variance =       0.289174131768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289052038350
                                         uncertainty =       0.001574268039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289052038350
                                         uncertainty =       0.001574268039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380264751
  error estimate for blocks of size 2^( 2) =       0.000395121532
  error estimate for blocks of size 2^( 3) =       0.000409238740
  error estimate for blocks of size 2^( 4) =       0.000418468489
  error estimate for blocks of size 2^( 5) =       0.000424831479
  error estimate for blocks of size 2^( 6) =       0.000426739151
  error estimate for blocks of size 2^( 7) =       0.000429230700

      target function =      -0.893727113999
              le_mean =     -17.206882340705
             les_mean =     296.389012896832
             stat err =       0.000424817455
             autocorr =       1.248051668510
   target nu stat err =       0.000424817455
   target dn stat err =       0.015664104580
      target stat err =       0.023188062401
              std dev =       0.537775568021
             le_variance =       0.289202561560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289166498966
                                         uncertainty =       0.001570866543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289166498966
                                         uncertainty =       0.001570866543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380339950
  error estimate for blocks of size 2^( 2) =       0.000395235211
  error estimate for blocks of size 2^( 3) =       0.000409386146
  error estimate for blocks of size 2^( 4) =       0.000418632487
  error estimate for blocks of size 2^( 5) =       0.000425008510
  error estimate for blocks of size 2^( 6) =       0.000426923142
  error estimate for blocks of size 2^( 7) =       0.000429420643

      target function =      -0.917950069236
              le_mean =     -17.206882245827
             les_mean =     296.373458497689
             stat err =       0.000424996195
             autocorr =       1.248608235121
   target nu stat err =       0.000424996195
   target dn stat err =       0.002095208538
      target stat err =       0.003347192287
              std dev =       0.537881915179
             le_variance =       0.289316954677


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917694209118        initial
     6.1035e-02     6.1035e-01             6.2651e-03        -0.915981491340
     2.4414e-01     2.4414e+00             1.7223e-03        -0.893727113999
     9.7656e-01     9.7656e+00             4.4142e-04        -0.917950069236  <--

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.6952e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
  uu_0                 2.101230e-01 1 1  ON 0
  uu_1                 5.275374e-02 1 1  ON 1
  uu_2                -3.833817e-02 1 1  ON 2
  uu_3                -9.175366e-02 1 1  ON 3
  uu_4                -1.223689e-01 1 1  ON 4
  uu_5                -1.301052e-01 1 1  ON 5
  uu_6                -1.126388e-01 1 1  ON 6
  uu_7                -5.644940e-02 1 1  ON 7
  uu_8                 6.027854e-02 1 1  ON 8
  uu_9                 1.247348e-01 1 1  ON 9
  ud_0                 3.051745e-01 1 1  ON 10
  ud_1                 7.606051e-02 1 1  ON 11
  ud_2                -2.622032e-02 1 1  ON 12
  ud_3                -7.917093e-02 1 1  ON 13
  ud_4                -1.149322e-01 1 1  ON 14
  ud_5                -1.334729e-01 1 1  ON 15
  ud_6                -1.266806e-01 1 1  ON 16
  ud_7                -8.519858e-02 1 1  ON 17
  ud_8                -5.925251e-03 1 1  ON 18
  ud_9                 8.618686e-02 1 1  ON 19
  eO_0                -7.034489e-01 1 1  ON 20
  eO_1                -4.200378e-01 1 1  ON 21
  eO_2                -4.157351e-02 1 1  ON 22
  eO_3                 1.845901e-01 1 1  ON 23
  eO_4                 2.570744e-01 1 1  ON 24
  eO_5                 2.803691e-01 1 1  ON 25
  eO_6                 2.509782e-01 1 1  ON 26
  eO_7                 1.322553e-01 1 1  ON 27
  eO_8                 2.922315e-02 1 1  ON 28
  eO_9                 1.913469e-02 1 1  ON 29
 eH1_0                -2.018120e-01 1 1  ON 30
 eH1_1                -9.599867e-02 1 1  ON 31
 eH1_2                -4.467071e-02 1 1  ON 32
 eH1_3                -1.417993e-02 1 1  ON 33
 eH1_4                 1.856659e-02 1 1  ON 34
 eH1_5                 2.195241e-02 1 1  ON 35
 eH1_6                 7.084539e-02 1 1  ON 36
 eH1_7                 1.028789e-01 1 1  ON 37
 eH1_8                 1.005351e-01 1 1  ON 38
 eH1_9                 2.590257e-02 1 1  ON 39
 eH2_0                -2.032755e-01 1 1  ON 40
 eH2_1                -9.796722e-02 1 1  ON 41
 eH2_2                -4.659925e-02 1 1  ON 42
 eH2_3                -1.573472e-02 1 1  ON 43
 eH2_4                 1.627440e-02 1 1  ON 44
 eH2_5                 1.985699e-02 1 1  ON 45
 eH2_6                 7.247548e-02 1 1  ON 46
 eH2_7                 1.104343e-01 1 1  ON 47
 eH2_8                 1.030377e-01 1 1  ON 48
 eH2_9                 2.884169e-02 1 1  ON 49
ci_001                -4.208131e-02 3 1  ON 50
ci_002                -3.076618e-02 3 1  ON 51
ci_003                -1.127739e-02 3 1  ON 52
ci_004                 2.573346e-02 3 1  ON 53
ci_005                 2.587177e-02 3 1  ON 54
ci_006                -2.026000e-02 3 1  ON 55
ci_007                -1.956791e-02 3 1  ON 56
ci_008                -4.022212e-03 3 1  ON 57
ci_009                -1.505778e-02 3 1  ON 58
ci_010                -9.401147e-03 3 1  ON 59
ci_011                -9.737045e-03 3 1  ON 60
ci_012                -9.726844e-03 3 1  ON 61
ci_013                -2.165202e-02 3 1  ON 62
ci_014                 1.323195e-02 3 1  ON 63
ci_015                 1.289642e-02 3 1  ON 64
ci_016                 1.634171e-02 3 1  ON 65
ci_017                 1.621338e-02 3 1  ON 66
ci_018                 1.103826e-02 3 1  ON 67
ci_019                 1.068023e-02 3 1  ON 68
ci_020                 1.836296e-02 3 1  ON 69
ci_021                 1.805712e-02 3 1  ON 70
ci_022                 1.039608e-02 3 1  ON 71
ci_023                 1.006662e-02 3 1  ON 72
ci_024                 6.596503e-03 3 1  ON 73
ci_025                 6.595587e-03 3 1  ON 74
ci_026                 1.164026e-02 3 1  ON 75
ci_027                 1.154284e-02 3 1  ON 76
ci_028                -8.746727e-03 3 1  ON 77
ci_029                -9.819322e-03 3 1  ON 78
ci_030                -5.423345e-03 3 1  ON 79
ci_031                -4.544347e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1539e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7187e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2762
    reference variance = 0.235088
====================================================
  Execution time = 1.9160e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5429e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9773e-01
  Total weights = 1.973598844e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5630e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289088692091
                                         uncertainty =       0.001848782534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289088692091
                                         uncertainty =       0.001848782534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380135459
  error estimate for blocks of size 2^( 2) =       0.000395403070
  error estimate for blocks of size 2^( 3) =       0.000409227443
  error estimate for blocks of size 2^( 4) =       0.000418979271
  error estimate for blocks of size 2^( 5) =       0.000425389268
  error estimate for blocks of size 2^( 6) =       0.000428907842
  error estimate for blocks of size 2^( 7) =       0.000432254373

      target function =      -0.916291883873
              le_mean =     -17.205626380287
             les_mean =     296.331311940897
             stat err =       0.000426382689
             autocorr =       1.258120859911
   target nu stat err =       0.000426382689
   target dn stat err =       0.002842533820
      target stat err =       0.004466579255
              std dev =       0.537592721576
             le_variance =       0.289005934291


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720562638029e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916312557025       residual = 9.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916428353743       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916449927749       residual = 5.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916456262674       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916457713169       residual = 8.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916459172149       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916459841068       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916459279662       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916459093702       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916458960582       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916459182967       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916459642395       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916459824183       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916459929774       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916460739199       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916461197482       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916461113547       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916461172709       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916461454048       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916461592071       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916461598034       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916461563831       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916461726982       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916461755267       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916461810456       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916461632996       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916461720660       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916461780859       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916461988445       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916461983394       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916461995868       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916462006016       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916461948932       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916462015918       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916462009857       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916462005833       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916462021845       residual = 6.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.4414e-01 is 1.364454e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916312557025       residual = 9.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916347646768       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916354087633       residual = 4.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916355954690       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916356355961       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916356734688       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916356931958       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916356752671       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916356699765       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916356674269       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916356746778       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916356880768       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916356923374       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916356958717       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916357181574       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916357282709       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916357261669       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916357280297       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916357352564       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916357372956       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916357373502       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916357368024       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916357408107       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916357414888       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916357418174       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916357374145       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916357405853       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916357423138       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916357458443       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916357453875       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916357454253       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916357456670       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916357443111       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916357461530       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916357455660       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e-01 is 3.504861e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916312557025       residual = 9.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916321820634       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916323514033       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916324002458       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916324105390       residual = 7.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916324200564       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916324252172       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916324204120       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916324190501       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916324184946       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916324204451       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916324239334       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916324249541       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916324259164       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916324316063       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916324340254       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916324335056       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916324340006       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916324357998       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916324361919       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916324362116       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916324361114       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916324371111       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916324372448       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916324372563       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916324361997       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916324370605       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916324374782       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916324382359       residual = 7.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916324381027       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916324381194       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916324381681       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916324378288       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916324382868       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916324381329       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+00 is 8.828439e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.700253 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4779e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
  uu_0                 2.101331e-01 1 1  ON 0
  uu_1                 5.281374e-02 1 1  ON 1
  uu_2                -3.830094e-02 1 1  ON 2
  uu_3                -9.171585e-02 1 1  ON 3
  uu_4                -1.223584e-01 1 1  ON 4
  uu_5                -1.300526e-01 1 1  ON 5
  uu_6                -1.126025e-01 1 1  ON 6
  uu_7                -5.640698e-02 1 1  ON 7
  uu_8                 5.992805e-02 1 1  ON 8
  uu_9                 1.246533e-01 1 1  ON 9
  ud_0                 3.051567e-01 1 1  ON 10
  ud_1                 7.597711e-02 1 1  ON 11
  ud_2                -2.628822e-02 1 1  ON 12
  ud_3                -7.920899e-02 1 1  ON 13
  ud_4                -1.149254e-01 1 1  ON 14
  ud_5                -1.334285e-01 1 1  ON 15
  ud_6                -1.266221e-01 1 1  ON 16
  ud_7                -8.504025e-02 1 1  ON 17
  ud_8                -6.011638e-03 1 1  ON 18
  ud_9                 8.604426e-02 1 1  ON 19
  eO_0                -7.036121e-01 1 1  ON 20
  eO_1                -4.201993e-01 1 1  ON 21
  eO_2                -4.160693e-02 1 1  ON 22
  eO_3                 1.846603e-01 1 1  ON 23
  eO_4                 2.570526e-01 1 1  ON 24
  eO_5                 2.803937e-01 1 1  ON 25
  eO_6                 2.510515e-01 1 1  ON 26
  eO_7                 1.324721e-01 1 1  ON 27
  eO_8                 2.921044e-02 1 1  ON 28
  eO_9                 1.913334e-02 1 1  ON 29
 eH1_0                -2.017069e-01 1 1  ON 30
 eH1_1                -9.604653e-02 1 1  ON 31
 eH1_2                -4.471592e-02 1 1  ON 32
 eH1_3                -1.417587e-02 1 1  ON 33
 eH1_4                 1.837864e-02 1 1  ON 34
 eH1_5                 2.187294e-02 1 1  ON 35
 eH1_6                 7.092672e-02 1 1  ON 36
 eH1_7                 1.029165e-01 1 1  ON 37
 eH1_8                 1.006375e-01 1 1  ON 38
 eH1_9                 2.592743e-02 1 1  ON 39
 eH2_0                -2.033298e-01 1 1  ON 40
 eH2_1                -9.792533e-02 1 1  ON 41
 eH2_2                -4.651114e-02 1 1  ON 42
 eH2_3                -1.567232e-02 1 1  ON 43
 eH2_4                 1.628057e-02 1 1  ON 44
 eH2_5                 1.969641e-02 1 1  ON 45
 eH2_6                 7.232711e-02 1 1  ON 46
 eH2_7                 1.104852e-01 1 1  ON 47
 eH2_8                 1.031265e-01 1 1  ON 48
 eH2_9                 2.886132e-02 1 1  ON 49
ci_001                -4.202919e-02 3 1  ON 50
ci_002                -3.075989e-02 3 1  ON 51
ci_003                -1.125102e-02 3 1  ON 52
ci_004                 2.568277e-02 3 1  ON 53
ci_005                 2.577777e-02 3 1  ON 54
ci_006                -2.024291e-02 3 1  ON 55
ci_007                -1.956685e-02 3 1  ON 56
ci_008                -4.013774e-03 3 1  ON 57
ci_009                -1.505501e-02 3 1  ON 58
ci_010                -9.337714e-03 3 1  ON 59
ci_011                -9.756010e-03 3 1  ON 60
ci_012                -9.537430e-03 3 1  ON 61
ci_013                -2.158102e-02 3 1  ON 62
ci_014                 1.331189e-02 3 1  ON 63
ci_015                 1.287236e-02 3 1  ON 64
ci_016                 1.638356e-02 3 1  ON 65
ci_017                 1.622189e-02 3 1  ON 66
ci_018                 1.089683e-02 3 1  ON 67
ci_019                 1.080570e-02 3 1  ON 68
ci_020                 1.832645e-02 3 1  ON 69
ci_021                 1.803609e-02 3 1  ON 70
ci_022                 1.046354e-02 3 1  ON 71
ci_023                 1.000460e-02 3 1  ON 72
ci_024                 6.669813e-03 3 1  ON 73
ci_025                 6.557890e-03 3 1  ON 74
ci_026                 1.160266e-02 3 1  ON 75
ci_027                 1.152034e-02 3 1  ON 76
ci_028                -8.907052e-03 3 1  ON 77
ci_029                -9.861295e-03 3 1  ON 78
ci_030                -5.357287e-03 3 1  ON 79
ci_031                -4.527360e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1859
    reference variance = 0.309522
====================================================
  Execution time = 1.8831e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0351e-01
  Total weights = 1.9735e+06
  Execution time = 1.5513e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293397042088
                                         uncertainty =       0.001769392794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293397042088
                                         uncertainty =       0.001769392794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382994245
  error estimate for blocks of size 2^( 2) =       0.000398558050
  error estimate for blocks of size 2^( 3) =       0.000413074722
  error estimate for blocks of size 2^( 4) =       0.000422699511
  error estimate for blocks of size 2^( 5) =       0.000429231486
  error estimate for blocks of size 2^( 6) =       0.000433041002
  error estimate for blocks of size 2^( 7) =       0.000433761691

      target function =      -0.906622354711
              le_mean =     -17.207142907794
             les_mean =     296.389763139547
             stat err =       0.000429683422
             autocorr =       1.258672375692
   target nu stat err =       0.000429683422
   target dn stat err =       0.003427514023
      target stat err =       0.005267763246
              std dev =       0.541635655529
             le_variance =       0.293369183340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293326705150
                                         uncertainty =       0.001776858373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293326705150
                                         uncertainty =       0.001776858373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382948228
  error estimate for blocks of size 2^( 2) =       0.000398520094
  error estimate for blocks of size 2^( 3) =       0.000413050999
  error estimate for blocks of size 2^( 4) =       0.000422686469
  error estimate for blocks of size 2^( 5) =       0.000429232251
  error estimate for blocks of size 2^( 6) =       0.000433049986
  error estimate for blocks of size 2^( 7) =       0.000433778331

      target function =      -0.905378225365
              le_mean =     -17.207149386595
             les_mean =     296.390807098365
             stat err =       0.000429686759
             autocorr =       1.258994444226
   target nu stat err =       0.000429686759
   target dn stat err =       0.003174732206
      target stat err =       0.004873614084
              std dev =       0.541570577733
             le_variance =       0.293298690666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293346144748
                                         uncertainty =       0.001773681017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293346144748
                                         uncertainty =       0.001773681017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382960965
  error estimate for blocks of size 2^( 2) =       0.000398529705
  error estimate for blocks of size 2^( 3) =       0.000413055258
  error estimate for blocks of size 2^( 4) =       0.000422686658
  error estimate for blocks of size 2^( 5) =       0.000429227417
  error estimate for blocks of size 2^( 6) =       0.000433043024
  error estimate for blocks of size 2^( 7) =       0.000433768328

      target function =      -0.904897676962
              le_mean =     -17.207145935295
             les_mean =     296.391000485857
             stat err =       0.000429681357
             autocorr =       1.258879044833
   target nu stat err =       0.000429681357
   target dn stat err =       0.003583099438
      target stat err =       0.005481804137
              std dev =       0.541588589957
             le_variance =       0.293318200772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293388742620
                                         uncertainty =       0.001769926267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293388742620
                                         uncertainty =       0.001769926267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382988821
  error estimate for blocks of size 2^( 2) =       0.000398553266
  error estimate for blocks of size 2^( 3) =       0.000413071109
  error estimate for blocks of size 2^( 4) =       0.000422696693
  error estimate for blocks of size 2^( 5) =       0.000429229749
  error estimate for blocks of size 2^( 6) =       0.000433039928
  error estimate for blocks of size 2^( 7) =       0.000433761129

      target function =      -0.906854098664
              le_mean =     -17.207143056212
             les_mean =     296.389616819429
             stat err =       0.000429681875
             autocorr =       1.258698958348
   target nu stat err =       0.000429681875
   target dn stat err =       0.003360033085
      target stat err =       0.005168626438
              std dev =       0.541627984935
             le_variance =       0.293360874065


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.906622354711        initial
     2.4414e-01     2.4414e+00             1.3645e-03        -0.905378225365
     9.7656e-01     9.7656e+00             3.5049e-04        -0.904897676962
     3.9062e+00     3.9062e+01             8.8284e-05        -0.906854098664  <--

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 2.6652e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
  uu_0                 2.101252e-01 1 1  ON 0
  uu_1                 5.276910e-02 1 1  ON 1
  uu_2                -3.832883e-02 1 1  ON 2
  uu_3                -9.174410e-02 1 1  ON 3
  uu_4                -1.223666e-01 1 1  ON 4
  uu_5                -1.300918e-01 1 1  ON 5
  uu_6                -1.126297e-01 1 1  ON 6
  uu_7                -5.643838e-02 1 1  ON 7
  uu_8                 6.019025e-02 1 1  ON 8
  uu_9                 1.247144e-01 1 1  ON 9
  ud_0                 3.051703e-01 1 1  ON 10
  ud_1                 7.603888e-02 1 1  ON 11
  ud_2                -2.623788e-02 1 1  ON 12
  ud_3                -7.918071e-02 1 1  ON 13
  ud_4                -1.149303e-01 1 1  ON 14
  ud_5                -1.334614e-01 1 1  ON 15
  ud_6                -1.266657e-01 1 1  ON 16
  ud_7                -8.515801e-02 1 1  ON 17
  ud_8                -5.947327e-03 1 1  ON 18
  ud_9                 8.615109e-02 1 1  ON 19
  eO_0                -7.034902e-01 1 1  ON 20
  eO_1                -4.200787e-01 1 1  ON 21
  eO_2                -4.158111e-02 1 1  ON 22
  eO_3                 1.846087e-01 1 1  ON 23
  eO_4                 2.570682e-01 1 1  ON 24
  eO_5                 2.803751e-01 1 1  ON 25
  eO_6                 2.509965e-01 1 1  ON 26
  eO_7                 1.323097e-01 1 1  ON 27
  eO_8                 2.921995e-02 1 1  ON 28
  eO_9                 1.913435e-02 1 1  ON 29
 eH1_0                -2.017843e-01 1 1  ON 30
 eH1_1                -9.601102e-02 1 1  ON 31
 eH1_2                -4.468230e-02 1 1  ON 32
 eH1_3                -1.417836e-02 1 1  ON 33
 eH1_4                 1.851804e-02 1 1  ON 34
 eH1_5                 2.193253e-02 1 1  ON 35
 eH1_6                 7.086600e-02 1 1  ON 36
 eH1_7                 1.028882e-01 1 1  ON 37
 eH1_8                 1.005608e-01 1 1  ON 38
 eH1_9                 2.590880e-02 1 1  ON 39
 eH2_0                -2.032902e-01 1 1  ON 40
 eH2_1                -9.795656e-02 1 1  ON 41
 eH2_2                -4.657637e-02 1 1  ON 42
 eH2_3                -1.571855e-02 1 1  ON 43
 eH2_4                 1.627621e-02 1 1  ON 44
 eH2_5                 1.981589e-02 1 1  ON 45
 eH2_6                 7.243844e-02 1 1  ON 46
 eH2_7                 1.104471e-01 1 1  ON 47
 eH2_8                 1.030599e-01 1 1  ON 48
 eH2_9                 2.884661e-02 1 1  ON 49
ci_001                -4.206772e-02 3 1  ON 50
ci_002                -3.076455e-02 3 1  ON 51
ci_003                -1.127045e-02 3 1  ON 52
ci_004                 2.572029e-02 3 1  ON 53
ci_005                 2.584729e-02 3 1  ON 54
ci_006                -2.025554e-02 3 1  ON 55
ci_007                -1.956766e-02 3 1  ON 56
ci_008                -4.019958e-03 3 1  ON 57
ci_009                -1.505705e-02 3 1  ON 58
ci_010                -9.384461e-03 3 1  ON 59
ci_011                -9.742018e-03 3 1  ON 60
ci_012                -9.676944e-03 3 1  ON 61
ci_013                -2.163356e-02 3 1  ON 62
ci_014                 1.325296e-02 3 1  ON 63
ci_015                 1.289009e-02 3 1  ON 64
ci_016                 1.635261e-02 3 1  ON 65
ci_017                 1.621559e-02 3 1  ON 66
ci_018                 1.100093e-02 3 1  ON 67
ci_019                 1.071344e-02 3 1  ON 68
ci_020                 1.835323e-02 3 1  ON 69
ci_021                 1.805184e-02 3 1  ON 70
ci_022                 1.041384e-02 3 1  ON 71
ci_023                 1.005032e-02 3 1  ON 72
ci_024                 6.615712e-03 3 1  ON 73
ci_025                 6.585728e-03 3 1  ON 74
ci_026                 1.163039e-02 3 1  ON 75
ci_027                 1.153706e-02 3 1  ON 76
ci_028                -8.788778e-03 3 1  ON 77
ci_029                -9.830289e-03 3 1  ON 78
ci_030                -5.405893e-03 3 1  ON 79
ci_031                -4.539832e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1438e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7188e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1775
    reference variance = 0.273304
====================================================
  Execution time = 1.9134e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5424e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0010e-01
  Total weights = 1.973748825e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5237e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290095291690
                                         uncertainty =       0.002235858995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290095291690
                                         uncertainty =       0.002235858995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380826411
  error estimate for blocks of size 2^( 2) =       0.000396047223
  error estimate for blocks of size 2^( 3) =       0.000409799459
  error estimate for blocks of size 2^( 4) =       0.000419912135
  error estimate for blocks of size 2^( 5) =       0.000426098959
  error estimate for blocks of size 2^( 6) =       0.000431557139
  error estimate for blocks of size 2^( 7) =       0.000431109257

      target function =      -0.912613522459
              le_mean =     -17.205969870282
             les_mean =     296.345502191045
             stat err =       0.000427169372
             autocorr =       1.258189605195
   target nu stat err =       0.000427169372
   target dn stat err =       0.003481819112
      target stat err =       0.005407654632
              std dev =       0.538569875802
             le_variance =       0.290057511122


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720596987028e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912644714543       residual = 4.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912657406296       residual = 7.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912662149834       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912663262922       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912663677785       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912664569918       residual = 9.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912664723346       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912665032758       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912665334204       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912665588177       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912666232787       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912666404040       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912666572294       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912666751170       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912666718078       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912666819329       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912666878991       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912666791129       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912666819683       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912666922648       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912666967830       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912666894563       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912666956442       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912666979152       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912666980657       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912666985292       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912667000838       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912667004548       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912666991108       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912666975349       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912666993441       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912666994249       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912666980820       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912666988399       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912666987459       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912666989097       residual = 9.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e-01 is 4.190239e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912644714543       residual = 4.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912648080723       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912649322300       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912649612243       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912649720501       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912649951683       residual = 9.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912649992419       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912650070769       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912650147447       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912650214863       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912650379415       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912650421351       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912650462358       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912650507150       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912650498900       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912650524943       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912650537140       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912650515154       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912650524778       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912650550056       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912650558060       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912650541025       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912650557025       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912650562061       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912650561222       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912650562862       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912650566561       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912650566868       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912650563059       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912650559873       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912650563961       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912650563866       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912650561023       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912650563238       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912650562878       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912650563359       residual = 6.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+00 is 1.052109e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912644714543       residual = 4.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912645569099       residual = 7.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912645883172       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912645956426       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912645983795       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912646042128       residual = 9.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912646052463       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912646072109       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912646091362       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912646108486       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912646149828       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912646160248       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912646170425       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912646181628       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912646179569       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912646186123       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912646188984       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912646183502       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912646186074       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912646192348       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912646194127       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912646189970       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912646194003       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912646195214       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912646194932       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912646195372       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912646196282       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912646196315       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912646195341       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912646194596       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912646195586       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912646195546       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912646194872       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912646195441       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912646195341       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912646195465       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+01 is 2.633024e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.750453 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4713e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
  uu_0                 2.101809e-01 1 1  ON 0
  uu_1                 5.281037e-02 1 1  ON 1
  uu_2                -3.829310e-02 1 1  ON 2
  uu_3                -9.171497e-02 1 1  ON 3
  uu_4                -1.223497e-01 1 1  ON 4
  uu_5                -1.301093e-01 1 1  ON 5
  uu_6                -1.126492e-01 1 1  ON 6
  uu_7                -5.649950e-02 1 1  ON 7
  uu_8                 6.008504e-02 1 1  ON 8
  uu_9                 1.247105e-01 1 1  ON 9
  ud_0                 3.051738e-01 1 1  ON 10
  ud_1                 7.603853e-02 1 1  ON 11
  ud_2                -2.623814e-02 1 1  ON 12
  ud_3                -7.917323e-02 1 1  ON 13
  ud_4                -1.149240e-01 1 1  ON 14
  ud_5                -1.334731e-01 1 1  ON 15
  ud_6                -1.266814e-01 1 1  ON 16
  ud_7                -8.513728e-02 1 1  ON 17
  ud_8                -5.971416e-03 1 1  ON 18
  ud_9                 8.613269e-02 1 1  ON 19
  eO_0                -7.035114e-01 1 1  ON 20
  eO_1                -4.200839e-01 1 1  ON 21
  eO_2                -4.158375e-02 1 1  ON 22
  eO_3                 1.846159e-01 1 1  ON 23
  eO_4                 2.570827e-01 1 1  ON 24
  eO_5                 2.803168e-01 1 1  ON 25
  eO_6                 2.509896e-01 1 1  ON 26
  eO_7                 1.323701e-01 1 1  ON 27
  eO_8                 2.922965e-02 1 1  ON 28
  eO_9                 1.913691e-02 1 1  ON 29
 eH1_0                -2.017942e-01 1 1  ON 30
 eH1_1                -9.598972e-02 1 1  ON 31
 eH1_2                -4.467376e-02 1 1  ON 32
 eH1_3                -1.418987e-02 1 1  ON 33
 eH1_4                 1.848618e-02 1 1  ON 34
 eH1_5                 2.191055e-02 1 1  ON 35
 eH1_6                 7.087654e-02 1 1  ON 36
 eH1_7                 1.028676e-01 1 1  ON 37
 eH1_8                 1.006046e-01 1 1  ON 38
 eH1_9                 2.592179e-02 1 1  ON 39
 eH2_0                -2.033303e-01 1 1  ON 40
 eH2_1                -9.800952e-02 1 1  ON 41
 eH2_2                -4.662533e-02 1 1  ON 42
 eH2_3                -1.574515e-02 1 1  ON 43
 eH2_4                 1.628137e-02 1 1  ON 44
 eH2_5                 1.991218e-02 1 1  ON 45
 eH2_6                 7.250332e-02 1 1  ON 46
 eH2_7                 1.104224e-01 1 1  ON 47
 eH2_8                 1.030846e-01 1 1  ON 48
 eH2_9                 2.884924e-02 1 1  ON 49
ci_001                -4.206996e-02 3 1  ON 50
ci_002                -3.078135e-02 3 1  ON 51
ci_003                -1.125831e-02 3 1  ON 52
ci_004                 2.570272e-02 3 1  ON 53
ci_005                 2.583966e-02 3 1  ON 54
ci_006                -2.025602e-02 3 1  ON 55
ci_007                -1.957015e-02 3 1  ON 56
ci_008                -4.045992e-03 3 1  ON 57
ci_009                -1.505524e-02 3 1  ON 58
ci_010                -9.409651e-03 3 1  ON 59
ci_011                -9.742302e-03 3 1  ON 60
ci_012                -9.674123e-03 3 1  ON 61
ci_013                -2.162216e-02 3 1  ON 62
ci_014                 1.324519e-02 3 1  ON 63
ci_015                 1.290460e-02 3 1  ON 64
ci_016                 1.635318e-02 3 1  ON 65
ci_017                 1.621542e-02 3 1  ON 66
ci_018                 1.100197e-02 3 1  ON 67
ci_019                 1.070281e-02 3 1  ON 68
ci_020                 1.835286e-02 3 1  ON 69
ci_021                 1.803889e-02 3 1  ON 70
ci_022                 1.041878e-02 3 1  ON 71
ci_023                 1.005232e-02 3 1  ON 72
ci_024                 6.618801e-03 3 1  ON 73
ci_025                 6.570095e-03 3 1  ON 74
ci_026                 1.164199e-02 3 1  ON 75
ci_027                 1.154028e-02 3 1  ON 76
ci_028                -8.801867e-03 3 1  ON 77
ci_029                -9.841608e-03 3 1  ON 78
ci_030                -5.395372e-03 3 1  ON 79
ci_031                -4.535931e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1168
    reference variance = 0.14264
====================================================
  Execution time = 1.8921e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9615e-01
  Total weights = 1.9739e+06
  Execution time = 1.5570e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289671759369
                                         uncertainty =       0.001805163300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289671759369
                                         uncertainty =       0.001805163300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380550878
  error estimate for blocks of size 2^( 2) =       0.000395852926
  error estimate for blocks of size 2^( 3) =       0.000410013285
  error estimate for blocks of size 2^( 4) =       0.000420874215
  error estimate for blocks of size 2^( 5) =       0.000427172301
  error estimate for blocks of size 2^( 6) =       0.000431322950
  error estimate for blocks of size 2^( 7) =       0.000433316308

      target function =      -0.918782918886
              le_mean =     -17.206300357148
             les_mean =     296.352902625877
             stat err =       0.000428171444
             autocorr =       1.265930731169
   target nu stat err =       0.000428171444
   target dn stat err =       0.002364897604
      target stat err =       0.003762770067
              std dev =       0.538180212226
             le_variance =       0.289637940832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289701130225
                                         uncertainty =       0.001807882240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289701130225
                                         uncertainty =       0.001807882240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380570304
  error estimate for blocks of size 2^( 2) =       0.000395864361
  error estimate for blocks of size 2^( 3) =       0.000410016475
  error estimate for blocks of size 2^( 4) =       0.000420871568
  error estimate for blocks of size 2^( 5) =       0.000427164941
  error estimate for blocks of size 2^( 6) =       0.000431313484
  error estimate for blocks of size 2^( 7) =       0.000433306799

      target function =      -0.918697281940
              le_mean =     -17.206300945759
             les_mean =     296.352977679987
             stat err =       0.000428164198
             autocorr =       1.265758652521
   target nu stat err =       0.000428164198
   target dn stat err =       0.002372409394
      target stat err =       0.003773587579
              std dev =       0.538207685629
             le_variance =       0.289667512870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289686933526
                                         uncertainty =       0.001806595930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289686933526
                                         uncertainty =       0.001806595930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380560916
  error estimate for blocks of size 2^( 2) =       0.000395858752
  error estimate for blocks of size 2^( 3) =       0.000410014773
  error estimate for blocks of size 2^( 4) =       0.000420872638
  error estimate for blocks of size 2^( 5) =       0.000427168263
  error estimate for blocks of size 2^( 6) =       0.000431317821
  error estimate for blocks of size 2^( 7) =       0.000433311073

      target function =      -0.918278235695
              le_mean =     -17.206300617707
             les_mean =     296.353234886140
             stat err =       0.000428167449
             autocorr =       1.265840324794
   target nu stat err =       0.000428167449
   target dn stat err =       0.002389567783
      target stat err =       0.003796466638
              std dev =       0.538194408877
             le_variance =       0.289653221746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289673639600
                                         uncertainty =       0.001805343907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289673639600
                                         uncertainty =       0.001805343907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380552122
  error estimate for blocks of size 2^( 2) =       0.000395853636
  error estimate for blocks of size 2^( 3) =       0.000410013446
  error estimate for blocks of size 2^( 4) =       0.000420873986
  error estimate for blocks of size 2^( 5) =       0.000427171760
  error estimate for blocks of size 2^( 6) =       0.000431322271
  error estimate for blocks of size 2^( 7) =       0.000433315620

      target function =      -0.918776900098
              le_mean =     -17.206300385063
             les_mean =     296.352907437942
             stat err =       0.000428170909
             autocorr =       1.265919294835
   target nu stat err =       0.000428170909
   target dn stat err =       0.002365395318
      target stat err =       0.003763484035
              std dev =       0.538181971660
             le_variance =       0.289639834620


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918782918886        initial  <--
     9.7656e-01     9.7656e+00             4.1902e-04        -0.918697281940
     3.9062e+00     3.9062e+01             1.0521e-04        -0.918278235695
     1.5625e+01     1.5625e+02             2.6330e-05        -0.918776900098

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.7774
  </log>
  <optVariables href="H2O.s026.opt.xml">
  uu_0                 2.101252e-01 1 1  ON 0
  uu_1                 5.276910e-02 1 1  ON 1
  uu_2                -3.832883e-02 1 1  ON 2
  uu_3                -9.174410e-02 1 1  ON 3
  uu_4                -1.223666e-01 1 1  ON 4
  uu_5                -1.300918e-01 1 1  ON 5
  uu_6                -1.126297e-01 1 1  ON 6
  uu_7                -5.643838e-02 1 1  ON 7
  uu_8                 6.019025e-02 1 1  ON 8
  uu_9                 1.247144e-01 1 1  ON 9
  ud_0                 3.051703e-01 1 1  ON 10
  ud_1                 7.603888e-02 1 1  ON 11
  ud_2                -2.623788e-02 1 1  ON 12
  ud_3                -7.918071e-02 1 1  ON 13
  ud_4                -1.149303e-01 1 1  ON 14
  ud_5                -1.334614e-01 1 1  ON 15
  ud_6                -1.266657e-01 1 1  ON 16
  ud_7                -8.515801e-02 1 1  ON 17
  ud_8                -5.947327e-03 1 1  ON 18
  ud_9                 8.615109e-02 1 1  ON 19
  eO_0                -7.034902e-01 1 1  ON 20
  eO_1                -4.200787e-01 1 1  ON 21
  eO_2                -4.158111e-02 1 1  ON 22
  eO_3                 1.846087e-01 1 1  ON 23
  eO_4                 2.570682e-01 1 1  ON 24
  eO_5                 2.803751e-01 1 1  ON 25
  eO_6                 2.509965e-01 1 1  ON 26
  eO_7                 1.323097e-01 1 1  ON 27
  eO_8                 2.921995e-02 1 1  ON 28
  eO_9                 1.913435e-02 1 1  ON 29
 eH1_0                -2.017843e-01 1 1  ON 30
 eH1_1                -9.601102e-02 1 1  ON 31
 eH1_2                -4.468230e-02 1 1  ON 32
 eH1_3                -1.417836e-02 1 1  ON 33
 eH1_4                 1.851804e-02 1 1  ON 34
 eH1_5                 2.193253e-02 1 1  ON 35
 eH1_6                 7.086600e-02 1 1  ON 36
 eH1_7                 1.028882e-01 1 1  ON 37
 eH1_8                 1.005608e-01 1 1  ON 38
 eH1_9                 2.590880e-02 1 1  ON 39
 eH2_0                -2.032902e-01 1 1  ON 40
 eH2_1                -9.795656e-02 1 1  ON 41
 eH2_2                -4.657637e-02 1 1  ON 42
 eH2_3                -1.571855e-02 1 1  ON 43
 eH2_4                 1.627621e-02 1 1  ON 44
 eH2_5                 1.981589e-02 1 1  ON 45
 eH2_6                 7.243844e-02 1 1  ON 46
 eH2_7                 1.104471e-01 1 1  ON 47
 eH2_8                 1.030599e-01 1 1  ON 48
 eH2_9                 2.884661e-02 1 1  ON 49
ci_001                -4.206772e-02 3 1  ON 50
ci_002                -3.076455e-02 3 1  ON 51
ci_003                -1.127045e-02 3 1  ON 52
ci_004                 2.572029e-02 3 1  ON 53
ci_005                 2.584729e-02 3 1  ON 54
ci_006                -2.025554e-02 3 1  ON 55
ci_007                -1.956766e-02 3 1  ON 56
ci_008                -4.019958e-03 3 1  ON 57
ci_009                -1.505705e-02 3 1  ON 58
ci_010                -9.384461e-03 3 1  ON 59
ci_011                -9.742018e-03 3 1  ON 60
ci_012                -9.676944e-03 3 1  ON 61
ci_013                -2.163356e-02 3 1  ON 62
ci_014                 1.325296e-02 3 1  ON 63
ci_015                 1.289009e-02 3 1  ON 64
ci_016                 1.635261e-02 3 1  ON 65
ci_017                 1.621559e-02 3 1  ON 66
ci_018                 1.100093e-02 3 1  ON 67
ci_019                 1.071344e-02 3 1  ON 68
ci_020                 1.835323e-02 3 1  ON 69
ci_021                 1.805184e-02 3 1  ON 70
ci_022                 1.041384e-02 3 1  ON 71
ci_023                 1.005032e-02 3 1  ON 72
ci_024                 6.615712e-03 3 1  ON 73
ci_025                 6.585728e-03 3 1  ON 74
ci_026                 1.163039e-02 3 1  ON 75
ci_027                 1.153706e-02 3 1  ON 76
ci_028                -8.788778e-03 3 1  ON 77
ci_029                -9.830289e-03 3 1  ON 78
ci_030                -5.405893e-03 3 1  ON 79
ci_031                -4.539832e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1497e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7187e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2636
    reference variance = 0.424316
====================================================
  Execution time = 2.1374e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5418e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9751e-01
  Total weights = 1.973771589e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5266e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289887248539
                                         uncertainty =       0.001942749174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289887248539
                                         uncertainty =       0.001942749174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380708612
  error estimate for blocks of size 2^( 2) =       0.000395783748
  error estimate for blocks of size 2^( 3) =       0.000409772080
  error estimate for blocks of size 2^( 4) =       0.000419420046
  error estimate for blocks of size 2^( 5) =       0.000424723717
  error estimate for blocks of size 2^( 6) =       0.000427004794
  error estimate for blocks of size 2^( 7) =       0.000429310314

      target function =      -0.916638310660
              le_mean =     -17.206245092726
             les_mean =     296.352376305136
             stat err =       0.000425114718
             autocorr =       1.246886375737
   target nu stat err =       0.000425114718
   target dn stat err =       0.002620411331
      target stat err =       0.004134444139
              std dev =       0.538403282130
             le_variance =       0.289878094208


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720624509273e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916655910930       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916657451685       residual = 7.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916657710837       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916657794408       residual = 6.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916657810730       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916657855567       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916657886650       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916657905814       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916657918763       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916657915910       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916657914045       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916657936874       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916657986302       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916658004623       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916657998149       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916658006605       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916658017698       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916658017303       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916658014509       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916658007614       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916658015121       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916658017924       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916658019119       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916658022526       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916658027692       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916658030918       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916658033694       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916658029920       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916658031588       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916658031539       residual = 7.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916658031095       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916658029847       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916658029451       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916658029697       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916658030310       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e+00 is 2.938300e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916655910930       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916656298341       residual = 7.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916656363435       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916656384413       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916656388506       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916656399918       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916656407541       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916656412313       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916656415541       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916656414837       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916656414391       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916656420145       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916656432505       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916656437042       residual = 7.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916656435406       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916656437537       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916656440328       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916656440211       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916656439500       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916656437788       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916656439684       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916656440375       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916656440669       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916656441517       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916656442805       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916656443608       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916656444289       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916656443343       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916656443764       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916656443751       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916656443639       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916656443330       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916656443229       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916656443294       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916656443445       residual = 7.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+01 is 7.363668e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916655910930       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916656007923       residual = 7.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916656024216       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916656029465       residual = 6.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916656030489       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916656033355       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916656035252       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916656036444       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916656037250       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916656037074       residual = 8.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916656036964       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916656038405       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916656041496       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916656042628       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916656042217       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916656042751       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916656043450       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916656043420       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916656043241       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916656042814       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916656043289       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916656043461       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916656043534       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916656043746       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916656044068       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916656044269       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916656044438       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916656044201       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916656044307       residual = 9.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916656044303       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916656044276       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916656044198       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916656044173       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916656044190       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916656044227       residual = 7.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5625e+02 is 1.842041e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.807937 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6977e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
  uu_0                 2.101230e-01 1 1  ON 0
  uu_1                 5.276746e-02 1 1  ON 1
  uu_2                -3.833005e-02 1 1  ON 2
  uu_3                -9.174478e-02 1 1  ON 3
  uu_4                -1.223663e-01 1 1  ON 4
  uu_5                -1.300915e-01 1 1  ON 5
  uu_6                -1.126278e-01 1 1  ON 6
  uu_7                -5.643102e-02 1 1  ON 7
  uu_8                 6.018395e-02 1 1  ON 8
  uu_9                 1.247140e-01 1 1  ON 9
  ud_0                 3.051707e-01 1 1  ON 10
  ud_1                 7.603857e-02 1 1  ON 11
  ud_2                -2.623831e-02 1 1  ON 12
  ud_3                -7.918084e-02 1 1  ON 13
  ud_4                -1.149302e-01 1 1  ON 14
  ud_5                -1.334618e-01 1 1  ON 15
  ud_6                -1.266664e-01 1 1  ON 16
  ud_7                -8.515905e-02 1 1  ON 17
  ud_8                -5.948339e-03 1 1  ON 18
  ud_9                 8.615060e-02 1 1  ON 19
  eO_0                -7.034955e-01 1 1  ON 20
  eO_1                -4.200852e-01 1 1  ON 21
  eO_2                -4.158445e-02 1 1  ON 22
  eO_3                 1.846092e-01 1 1  ON 23
  eO_4                 2.570741e-01 1 1  ON 24
  eO_5                 2.803740e-01 1 1  ON 25
  eO_6                 2.509997e-01 1 1  ON 26
  eO_7                 1.323154e-01 1 1  ON 27
  eO_8                 2.922065e-02 1 1  ON 28
  eO_9                 1.913460e-02 1 1  ON 29
 eH1_0                -2.017837e-01 1 1  ON 30
 eH1_1                -9.601045e-02 1 1  ON 31
 eH1_2                -4.468170e-02 1 1  ON 32
 eH1_3                -1.417710e-02 1 1  ON 33
 eH1_4                 1.851458e-02 1 1  ON 34
 eH1_5                 2.192940e-02 1 1  ON 35
 eH1_6                 7.086607e-02 1 1  ON 36
 eH1_7                 1.028875e-01 1 1  ON 37
 eH1_8                 1.005640e-01 1 1  ON 38
 eH1_9                 2.590969e-02 1 1  ON 39
 eH2_0                -2.032876e-01 1 1  ON 40
 eH2_1                -9.795252e-02 1 1  ON 41
 eH2_2                -4.657350e-02 1 1  ON 42
 eH2_3                -1.571762e-02 1 1  ON 43
 eH2_4                 1.627411e-02 1 1  ON 44
 eH2_5                 1.981031e-02 1 1  ON 45
 eH2_6                 7.243351e-02 1 1  ON 46
 eH2_7                 1.104459e-01 1 1  ON 47
 eH2_8                 1.030625e-01 1 1  ON 48
 eH2_9                 2.884727e-02 1 1  ON 49
ci_001                -4.206722e-02 3 1  ON 50
ci_002                -3.076382e-02 3 1  ON 51
ci_003                -1.127070e-02 3 1  ON 52
ci_004                 2.571993e-02 3 1  ON 53
ci_005                 2.584785e-02 3 1  ON 54
ci_006                -2.025571e-02 3 1  ON 55
ci_007                -1.956764e-02 3 1  ON 56
ci_008                -4.021612e-03 3 1  ON 57
ci_009                -1.505595e-02 3 1  ON 58
ci_010                -9.383714e-03 3 1  ON 59
ci_011                -9.741466e-03 3 1  ON 60
ci_012                -9.676915e-03 3 1  ON 61
ci_013                -2.163357e-02 3 1  ON 62
ci_014                 1.325072e-02 3 1  ON 63
ci_015                 1.289075e-02 3 1  ON 64
ci_016                 1.635168e-02 3 1  ON 65
ci_017                 1.621405e-02 3 1  ON 66
ci_018                 1.100046e-02 3 1  ON 67
ci_019                 1.071462e-02 3 1  ON 68
ci_020                 1.834996e-02 3 1  ON 69
ci_021                 1.805094e-02 3 1  ON 70
ci_022                 1.041417e-02 3 1  ON 71
ci_023                 1.004986e-02 3 1  ON 72
ci_024                 6.615223e-03 3 1  ON 73
ci_025                 6.586497e-03 3 1  ON 74
ci_026                 1.163290e-02 3 1  ON 75
ci_027                 1.153703e-02 3 1  ON 76
ci_028                -8.788821e-03 3 1  ON 77
ci_029                -9.828512e-03 3 1  ON 78
ci_030                -5.405737e-03 3 1  ON 79
ci_031                -4.539993e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2286
    reference variance = 0.181783
====================================================
  Execution time = 1.8994e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0137e-01
  Total weights = 1.9738e+06
  Execution time = 1.5587e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290916087588
                                         uncertainty =       0.001634749058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290916087588
                                         uncertainty =       0.001634749058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381455165
  error estimate for blocks of size 2^( 2) =       0.000396766019
  error estimate for blocks of size 2^( 3) =       0.000410664271
  error estimate for blocks of size 2^( 4) =       0.000421113510
  error estimate for blocks of size 2^( 5) =       0.000426980148
  error estimate for blocks of size 2^( 6) =       0.000430510337
  error estimate for blocks of size 2^( 7) =       0.000431527244

      target function =      -0.910639985605
              le_mean =     -17.206155032667
             les_mean =     296.353164539123
             stat err =       0.000427532810
             autocorr =       1.256180069407
   target nu stat err =       0.000427532810
   target dn stat err =       0.002672674402
      target stat err =       0.004160262064
              std dev =       0.539459067630
             le_variance =       0.291016085649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290914234533
                                         uncertainty =       0.001634731447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290914234533
                                         uncertainty =       0.001634731447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381453965
  error estimate for blocks of size 2^( 2) =       0.000396764902
  error estimate for blocks of size 2^( 3) =       0.000410663270
  error estimate for blocks of size 2^( 4) =       0.000421112659
  error estimate for blocks of size 2^( 5) =       0.000426979323
  error estimate for blocks of size 2^( 6) =       0.000430509700
  error estimate for blocks of size 2^( 7) =       0.000431526589

      target function =      -0.910746054926
              le_mean =     -17.206154999661
             les_mean =     296.353094376057
             stat err =       0.000427532068
             autocorr =       1.256183609257
   target nu stat err =       0.000427532068
   target dn stat err =       0.002655735542
      target stat err =       0.004135634019
              std dev =       0.539457371128
             le_variance =       0.291014255264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290915152549
                                         uncertainty =       0.001634740075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290915152549
                                         uncertainty =       0.001634740075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381454560
  error estimate for blocks of size 2^( 2) =       0.000396765455
  error estimate for blocks of size 2^( 3) =       0.000410663765
  error estimate for blocks of size 2^( 4) =       0.000421113079
  error estimate for blocks of size 2^( 5) =       0.000426979731
  error estimate for blocks of size 2^( 6) =       0.000430510014
  error estimate for blocks of size 2^( 7) =       0.000431526911

      target function =      -0.910696121871
              le_mean =     -17.206155015654
             les_mean =     296.353127421323
             stat err =       0.000427532433
             autocorr =       1.256181845443
   target nu stat err =       0.000427532433
   target dn stat err =       0.002663527658
      target stat err =       0.004146953937
              std dev =       0.539458211553
             le_variance =       0.291015162012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290915970118
                                         uncertainty =       0.001634747922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290915970118
                                         uncertainty =       0.001634747922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381455089
  error estimate for blocks of size 2^( 2) =       0.000396765948
  error estimate for blocks of size 2^( 3) =       0.000410664207
  error estimate for blocks of size 2^( 4) =       0.000421113455
  error estimate for blocks of size 2^( 5) =       0.000426980096
  error estimate for blocks of size 2^( 6) =       0.000430510296
  error estimate for blocks of size 2^( 7) =       0.000431527202

      target function =      -0.910647345162
              le_mean =     -17.206155030483
             les_mean =     296.353159674478
             stat err =       0.000427532762
             autocorr =       1.256180291629
   target nu stat err =       0.000427532762
   target dn stat err =       0.002671453086
      target stat err =       0.004158483994
              std dev =       0.539458960076
             le_variance =       0.291015969606


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910639985605        initial
     9.7656e+00     9.7656e+01             2.9383e-05        -0.910746054926  <--
     3.9062e+01     3.9062e+02             7.3637e-06        -0.910696121871
     1.5625e+02     1.5625e+03             1.8420e-06        -0.910647345162

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 2.6885e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
  uu_0                 2.101166e-01 1 1  ON 0
  uu_1                 5.276257e-02 1 1  ON 1
  uu_2                -3.833369e-02 1 1  ON 2
  uu_3                -9.174680e-02 1 1  ON 3
  uu_4                -1.223656e-01 1 1  ON 4
  uu_5                -1.300905e-01 1 1  ON 5
  uu_6                -1.126224e-01 1 1  ON 6
  uu_7                -5.640900e-02 1 1  ON 7
  uu_8                 6.016508e-02 1 1  ON 8
  uu_9                 1.247127e-01 1 1  ON 9
  ud_0                 3.051717e-01 1 1  ON 10
  ud_1                 7.603764e-02 1 1  ON 11
  ud_2                -2.623961e-02 1 1  ON 12
  ud_3                -7.918123e-02 1 1  ON 13
  ud_4                -1.149300e-01 1 1  ON 14
  ud_5                -1.334630e-01 1 1  ON 15
  ud_6                -1.266686e-01 1 1  ON 16
  ud_7                -8.516217e-02 1 1  ON 17
  ud_8                -5.951371e-03 1 1  ON 18
  ud_9                 8.614912e-02 1 1  ON 19
  eO_0                -7.035112e-01 1 1  ON 20
  eO_1                -4.201048e-01 1 1  ON 21
  eO_2                -4.159448e-02 1 1  ON 22
  eO_3                 1.846105e-01 1 1  ON 23
  eO_4                 2.570917e-01 1 1  ON 24
  eO_5                 2.803706e-01 1 1  ON 25
  eO_6                 2.510093e-01 1 1  ON 26
  eO_7                 1.323325e-01 1 1  ON 27
  eO_8                 2.922273e-02 1 1  ON 28
  eO_9                 1.913534e-02 1 1  ON 29
 eH1_0                -2.017819e-01 1 1  ON 30
 eH1_1                -9.600873e-02 1 1  ON 31
 eH1_2                -4.467991e-02 1 1  ON 32
 eH1_3                -1.417334e-02 1 1  ON 33
 eH1_4                 1.850425e-02 1 1  ON 34
 eH1_5                 2.192002e-02 1 1  ON 35
 eH1_6                 7.086627e-02 1 1  ON 36
 eH1_7                 1.028854e-01 1 1  ON 37
 eH1_8                 1.005736e-01 1 1  ON 38
 eH1_9                 2.591237e-02 1 1  ON 39
 eH2_0                -2.032800e-01 1 1  ON 40
 eH2_1                -9.794044e-02 1 1  ON 41
 eH2_2                -4.656492e-02 1 1  ON 42
 eH2_3                -1.571484e-02 1 1  ON 43
 eH2_4                 1.626784e-02 1 1  ON 44
 eH2_5                 1.979364e-02 1 1  ON 45
 eH2_6                 7.241873e-02 1 1  ON 46
 eH2_7                 1.104422e-01 1 1  ON 47
 eH2_8                 1.030702e-01 1 1  ON 48
 eH2_9                 2.884928e-02 1 1  ON 49
ci_001                -4.206573e-02 3 1  ON 50
ci_002                -3.076162e-02 3 1  ON 51
ci_003                -1.127143e-02 3 1  ON 52
ci_004                 2.571886e-02 3 1  ON 53
ci_005                 2.584955e-02 3 1  ON 54
ci_006                -2.025622e-02 3 1  ON 55
ci_007                -1.956761e-02 3 1  ON 56
ci_008                -4.026535e-03 3 1  ON 57
ci_009                -1.505267e-02 3 1  ON 58
ci_010                -9.381491e-03 3 1  ON 59
ci_011                -9.739822e-03 3 1  ON 60
ci_012                -9.676829e-03 3 1  ON 61
ci_013                -2.163361e-02 3 1  ON 62
ci_014                 1.324403e-02 3 1  ON 63
ci_015                 1.289272e-02 3 1  ON 64
ci_016                 1.634890e-02 3 1  ON 65
ci_017                 1.620948e-02 3 1  ON 66
ci_018                 1.099907e-02 3 1  ON 67
ci_019                 1.071813e-02 3 1  ON 68
ci_020                 1.834021e-02 3 1  ON 69
ci_021                 1.804826e-02 3 1  ON 70
ci_022                 1.041516e-02 3 1  ON 71
ci_023                 1.004851e-02 3 1  ON 72
ci_024                 6.613767e-03 3 1  ON 73
ci_025                 6.588793e-03 3 1  ON 74
ci_026                 1.164038e-02 3 1  ON 75
ci_027                 1.153692e-02 3 1  ON 76
ci_028                -8.788952e-03 3 1  ON 77
ci_029                -9.823219e-03 3 1  ON 78
ci_030                -5.405271e-03 3 1  ON 79
ci_031                -4.540472e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.3880e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7189e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2495
    reference variance = 0.362117
====================================================
  Execution time = 1.9278e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5406e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9811e-01
  Total weights = 1.974029289e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4525e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287415363819
                                         uncertainty =       0.001643895408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287415363819
                                         uncertainty =       0.001643895408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379097205
  error estimate for blocks of size 2^( 2) =       0.000394444899
  error estimate for blocks of size 2^( 3) =       0.000408374131
  error estimate for blocks of size 2^( 4) =       0.000419672059
  error estimate for blocks of size 2^( 5) =       0.000425593860
  error estimate for blocks of size 2^( 6) =       0.000429761573
  error estimate for blocks of size 2^( 7) =       0.000430729828

      target function =      -0.915668753886
              le_mean =     -17.206029321795
             les_mean =     296.345556605415
             stat err =       0.000426439330
             autocorr =       1.265357780066
   target nu stat err =       0.000426439330
   target dn stat err =       0.004432701482
      target stat err =       0.006907576125
              std dev =       0.536124408499
             le_variance =       0.287429381388


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720602932180e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915719579751       residual = 5.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915730457354       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915732652899       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915733318098       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915733616905       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915733733034       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915733802342       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915733888005       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915733831127       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915733822643       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915733935797       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915733997825       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915734082326       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915734127793       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915734183347       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915734189125       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915734178352       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915734230926       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915734245276       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915734252169       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915734251766       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915734270139       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915734246869       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915734238307       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915734237558       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915734249778       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915734248789       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915734238822       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915734240307       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915734235971       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915734248216       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915734257958       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915734257852       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915734263702       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915734267461       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915734263123       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.4414e+00 is 1.322296e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915719579751       residual = 5.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915722360264       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915722919234       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915723087943       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915723163990       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915723193173       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915723210969       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915723232294       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915723217836       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915723215906       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915723244833       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915723260552       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915723281873       residual = 8.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915723293194       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915723306915       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915723308365       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915723305676       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915723318831       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915723322434       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915723324013       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915723323810       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915723328371       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915723322390       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915723320236       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915723320304       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915723323396       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915723322789       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915723320630       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915723320748       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915723319806       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915723323026       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915723324852       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915723325613       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915723325673       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915723327708       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915723326521       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e+00 is 3.314016e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915719579751       residual = 5.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915720278806       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915720419193       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915720461523       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915720480621       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915720487926       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915720492406       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915720497729       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915720494098       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915720493631       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915720500903       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915720504846       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915720510189       residual = 8.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915720513015       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915720516435       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915720516798       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915720516126       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915720519415       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915720520317       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915720520702       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915720520645       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915720521783       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915720520277       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915720519739       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915720519773       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915720520546       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915720520373       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915720519854       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915720519866       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915720519642       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915720520453       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915720520878       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915720521100       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915720521090       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915720521606       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915720521313       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+01 is 8.290268e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.869979 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4806e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
  uu_0                 2.101291e-01 1 1  ON 0
  uu_1                 5.277043e-02 1 1  ON 1
  uu_2                -3.832519e-02 1 1  ON 2
  uu_3                -9.174358e-02 1 1  ON 3
  uu_4                -1.223706e-01 1 1  ON 4
  uu_5                -1.300944e-01 1 1  ON 5
  uu_6                -1.126286e-01 1 1  ON 6
  uu_7                -5.641723e-02 1 1  ON 7
  uu_8                 6.013194e-02 1 1  ON 8
  uu_9                 1.247181e-01 1 1  ON 9
  ud_0                 3.051611e-01 1 1  ON 10
  ud_1                 7.603152e-02 1 1  ON 11
  ud_2                -2.624246e-02 1 1  ON 12
  ud_3                -7.918403e-02 1 1  ON 13
  ud_4                -1.149259e-01 1 1  ON 14
  ud_5                -1.334515e-01 1 1  ON 15
  ud_6                -1.266604e-01 1 1  ON 16
  ud_7                -8.516070e-02 1 1  ON 17
  ud_8                -5.965980e-03 1 1  ON 18
  ud_9                 8.614064e-02 1 1  ON 19
  eO_0                -7.035100e-01 1 1  ON 20
  eO_1                -4.201052e-01 1 1  ON 21
  eO_2                -4.159203e-02 1 1  ON 22
  eO_3                 1.846101e-01 1 1  ON 23
  eO_4                 2.570683e-01 1 1  ON 24
  eO_5                 2.803605e-01 1 1  ON 25
  eO_6                 2.510200e-01 1 1  ON 26
  eO_7                 1.323484e-01 1 1  ON 27
  eO_8                 2.922326e-02 1 1  ON 28
  eO_9                 1.913608e-02 1 1  ON 29
 eH1_0                -2.018015e-01 1 1  ON 30
 eH1_1                -9.601476e-02 1 1  ON 31
 eH1_2                -4.468853e-02 1 1  ON 32
 eH1_3                -1.417048e-02 1 1  ON 33
 eH1_4                 1.851345e-02 1 1  ON 34
 eH1_5                 2.193008e-02 1 1  ON 35
 eH1_6                 7.086718e-02 1 1  ON 36
 eH1_7                 1.028780e-01 1 1  ON 37
 eH1_8                 1.005879e-01 1 1  ON 38
 eH1_9                 2.591509e-02 1 1  ON 39
 eH2_0                -2.032779e-01 1 1  ON 40
 eH2_1                -9.793982e-02 1 1  ON 41
 eH2_2                -4.656748e-02 1 1  ON 42
 eH2_3                -1.571585e-02 1 1  ON 43
 eH2_4                 1.626103e-02 1 1  ON 44
 eH2_5                 1.982097e-02 1 1  ON 45
 eH2_6                 7.241086e-02 1 1  ON 46
 eH2_7                 1.104176e-01 1 1  ON 47
 eH2_8                 1.030798e-01 1 1  ON 48
 eH2_9                 2.885086e-02 1 1  ON 49
ci_001                -4.206792e-02 3 1  ON 50
ci_002                -3.076733e-02 3 1  ON 51
ci_003                -1.127257e-02 3 1  ON 52
ci_004                 2.572158e-02 3 1  ON 53
ci_005                 2.585414e-02 3 1  ON 54
ci_006                -2.025847e-02 3 1  ON 55
ci_007                -1.956119e-02 3 1  ON 56
ci_008                -4.029774e-03 3 1  ON 57
ci_009                -1.506271e-02 3 1  ON 58
ci_010                -9.377211e-03 3 1  ON 59
ci_011                -9.746730e-03 3 1  ON 60
ci_012                -9.680722e-03 3 1  ON 61
ci_013                -2.163669e-02 3 1  ON 62
ci_014                 1.324263e-02 3 1  ON 63
ci_015                 1.288285e-02 3 1  ON 64
ci_016                 1.635521e-02 3 1  ON 65
ci_017                 1.620366e-02 3 1  ON 66
ci_018                 1.099728e-02 3 1  ON 67
ci_019                 1.071659e-02 3 1  ON 68
ci_020                 1.833678e-02 3 1  ON 69
ci_021                 1.805010e-02 3 1  ON 70
ci_022                 1.042357e-02 3 1  ON 71
ci_023                 1.006837e-02 3 1  ON 72
ci_024                 6.622039e-03 3 1  ON 73
ci_025                 6.583575e-03 3 1  ON 74
ci_026                 1.163819e-02 3 1  ON 75
ci_027                 1.154314e-02 3 1  ON 76
ci_028                -8.788638e-03 3 1  ON 77
ci_029                -9.812375e-03 3 1  ON 78
ci_030                -5.392469e-03 3 1  ON 79
ci_031                -4.539799e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1756
    reference variance = 0.178759
====================================================
  Execution time = 1.8973e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0189e-01
  Total weights = 1.9739e+06
  Execution time = 1.5542e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292483147746
                                         uncertainty =       0.001963366220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292483147746
                                         uncertainty =       0.001963366220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382354621
  error estimate for blocks of size 2^( 2) =       0.000397756851
  error estimate for blocks of size 2^( 3) =       0.000411487030
  error estimate for blocks of size 2^( 4) =       0.000421214940
  error estimate for blocks of size 2^( 5) =       0.000427472922
  error estimate for blocks of size 2^( 6) =       0.000430092406
  error estimate for blocks of size 2^( 7) =       0.000431583694

      target function =      -0.910005213516
              le_mean =     -17.206310482045
             les_mean =     296.358920473546
             stat err =       0.000427590991
             autocorr =       1.250617222716
   target nu stat err =       0.000427590991
   target dn stat err =       0.003192396222
      target stat err =       0.004941617440
              std dev =       0.540731090768
             le_variance =       0.292390112523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292485860070
                                         uncertainty =       0.001965154868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292485860070
                                         uncertainty =       0.001965154868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382356378
  error estimate for blocks of size 2^( 2) =       0.000397757720
  error estimate for blocks of size 2^( 3) =       0.000411485700
  error estimate for blocks of size 2^( 4) =       0.000421214439
  error estimate for blocks of size 2^( 5) =       0.000427470941
  error estimate for blocks of size 2^( 6) =       0.000430089999
  error estimate for blocks of size 2^( 7) =       0.000431585705

      target function =      -0.482521076788
              le_mean =     -17.206311490497
             les_mean =     296.737865365897
             stat err =       0.000427590271
             autocorr =       1.250601518892
   target nu stat err =       0.000427590271
   target dn stat err =       0.379109564005
      target stat err =       0.187980440910
              std dev =       0.540733575738
             le_variance =       0.292392799930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292483428340
                                         uncertainty =       0.001964339997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292483428340
                                         uncertainty =       0.001964339997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382354798
  error estimate for blocks of size 2^( 2) =       0.000397756815
  error estimate for blocks of size 2^( 3) =       0.000411486818
  error estimate for blocks of size 2^( 4) =       0.000421214371
  error estimate for blocks of size 2^( 5) =       0.000427472454
  error estimate for blocks of size 2^( 6) =       0.000430091708
  error estimate for blocks of size 2^( 7) =       0.000431582148

      target function =      -0.909804788081
              le_mean =     -17.206310498839
             les_mean =     296.359051871712
             stat err =       0.000427590170
             autocorr =       1.250611267628
   target nu stat err =       0.000427590170
   target dn stat err =       0.003200764329
      target stat err =       0.004952137964
              std dev =       0.540731341071
             le_variance =       0.292390383217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292483168069
                                         uncertainty =       0.001963487728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292483168069
                                         uncertainty =       0.001963487728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382354634
  error estimate for blocks of size 2^( 2) =       0.000397756837
  error estimate for blocks of size 2^( 3) =       0.000411486996
  error estimate for blocks of size 2^( 4) =       0.000421214860
  error estimate for blocks of size 2^( 5) =       0.000427472856
  error estimate for blocks of size 2^( 6) =       0.000430092311
  error estimate for blocks of size 2^( 7) =       0.000431583488

      target function =      -0.909995342730
              le_mean =     -17.206310481994
             les_mean =     296.358926910234
             stat err =       0.000427590879
             autocorr =       1.250616486701
   target nu stat err =       0.000427590879
   target dn stat err =       0.003193088219
      target stat err =       0.004942559837
              std dev =       0.540731108422
             le_variance =       0.292390131616


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910005213516        initial  <--
     2.4414e+00     2.4414e+01             1.3223e-04        -0.482521076788
     9.7656e+00     9.7656e+01             3.3140e-05        -0.909804788081
     3.9062e+01     3.9062e+02             8.2903e-06        -0.909995342730

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.8242
  </log>
  <optVariables href="H2O.s028.opt.xml">
  uu_0                 2.101166e-01 1 1  ON 0
  uu_1                 5.276257e-02 1 1  ON 1
  uu_2                -3.833369e-02 1 1  ON 2
  uu_3                -9.174680e-02 1 1  ON 3
  uu_4                -1.223656e-01 1 1  ON 4
  uu_5                -1.300905e-01 1 1  ON 5
  uu_6                -1.126224e-01 1 1  ON 6
  uu_7                -5.640900e-02 1 1  ON 7
  uu_8                 6.016508e-02 1 1  ON 8
  uu_9                 1.247127e-01 1 1  ON 9
  ud_0                 3.051717e-01 1 1  ON 10
  ud_1                 7.603764e-02 1 1  ON 11
  ud_2                -2.623961e-02 1 1  ON 12
  ud_3                -7.918123e-02 1 1  ON 13
  ud_4                -1.149300e-01 1 1  ON 14
  ud_5                -1.334630e-01 1 1  ON 15
  ud_6                -1.266686e-01 1 1  ON 16
  ud_7                -8.516217e-02 1 1  ON 17
  ud_8                -5.951371e-03 1 1  ON 18
  ud_9                 8.614912e-02 1 1  ON 19
  eO_0                -7.035112e-01 1 1  ON 20
  eO_1                -4.201048e-01 1 1  ON 21
  eO_2                -4.159448e-02 1 1  ON 22
  eO_3                 1.846105e-01 1 1  ON 23
  eO_4                 2.570917e-01 1 1  ON 24
  eO_5                 2.803706e-01 1 1  ON 25
  eO_6                 2.510093e-01 1 1  ON 26
  eO_7                 1.323325e-01 1 1  ON 27
  eO_8                 2.922273e-02 1 1  ON 28
  eO_9                 1.913534e-02 1 1  ON 29
 eH1_0                -2.017819e-01 1 1  ON 30
 eH1_1                -9.600873e-02 1 1  ON 31
 eH1_2                -4.467991e-02 1 1  ON 32
 eH1_3                -1.417334e-02 1 1  ON 33
 eH1_4                 1.850425e-02 1 1  ON 34
 eH1_5                 2.192002e-02 1 1  ON 35
 eH1_6                 7.086627e-02 1 1  ON 36
 eH1_7                 1.028854e-01 1 1  ON 37
 eH1_8                 1.005736e-01 1 1  ON 38
 eH1_9                 2.591237e-02 1 1  ON 39
 eH2_0                -2.032800e-01 1 1  ON 40
 eH2_1                -9.794044e-02 1 1  ON 41
 eH2_2                -4.656492e-02 1 1  ON 42
 eH2_3                -1.571484e-02 1 1  ON 43
 eH2_4                 1.626784e-02 1 1  ON 44
 eH2_5                 1.979364e-02 1 1  ON 45
 eH2_6                 7.241873e-02 1 1  ON 46
 eH2_7                 1.104422e-01 1 1  ON 47
 eH2_8                 1.030702e-01 1 1  ON 48
 eH2_9                 2.884928e-02 1 1  ON 49
ci_001                -4.206573e-02 3 1  ON 50
ci_002                -3.076162e-02 3 1  ON 51
ci_003                -1.127143e-02 3 1  ON 52
ci_004                 2.571886e-02 3 1  ON 53
ci_005                 2.584955e-02 3 1  ON 54
ci_006                -2.025622e-02 3 1  ON 55
ci_007                -1.956761e-02 3 1  ON 56
ci_008                -4.026535e-03 3 1  ON 57
ci_009                -1.505267e-02 3 1  ON 58
ci_010                -9.381491e-03 3 1  ON 59
ci_011                -9.739822e-03 3 1  ON 60
ci_012                -9.676829e-03 3 1  ON 61
ci_013                -2.163361e-02 3 1  ON 62
ci_014                 1.324403e-02 3 1  ON 63
ci_015                 1.289272e-02 3 1  ON 64
ci_016                 1.634890e-02 3 1  ON 65
ci_017                 1.620948e-02 3 1  ON 66
ci_018                 1.099907e-02 3 1  ON 67
ci_019                 1.071813e-02 3 1  ON 68
ci_020                 1.834021e-02 3 1  ON 69
ci_021                 1.804826e-02 3 1  ON 70
ci_022                 1.041516e-02 3 1  ON 71
ci_023                 1.004851e-02 3 1  ON 72
ci_024                 6.613767e-03 3 1  ON 73
ci_025                 6.588793e-03 3 1  ON 74
ci_026                 1.164038e-02 3 1  ON 75
ci_027                 1.153692e-02 3 1  ON 76
ci_028                -8.788952e-03 3 1  ON 77
ci_029                -9.823219e-03 3 1  ON 78
ci_030                -5.405271e-03 3 1  ON 79
ci_031                -4.540472e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1649e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7190e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.3243
    reference variance = 0.747753
====================================================
  Execution time = 1.9030e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5433e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9966e-01
  Total weights = 1.973806305e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4910e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291063846907
                                         uncertainty =       0.002267847438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291063846907
                                         uncertainty =       0.002267847438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381536421
  error estimate for blocks of size 2^( 2) =       0.000396836662
  error estimate for blocks of size 2^( 3) =       0.000410457880
  error estimate for blocks of size 2^( 4) =       0.000420335186
  error estimate for blocks of size 2^( 5) =       0.000426564758
  error estimate for blocks of size 2^( 6) =       0.000429287368
  error estimate for blocks of size 2^( 7) =       0.000431128789

      target function =      -0.913312375421
              le_mean =     -17.205907883771
             les_mean =     296.342921723291
             stat err =       0.000426829025
             autocorr =       1.251514500156
   target nu stat err =       0.000426829025
   target dn stat err =       0.002966483271
      target stat err =       0.004629030486
              std dev =       0.539573981618
             le_variance =       0.291140081640


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720590788377e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913335127313       residual = 4.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913335886698       residual = 7.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913336051178       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913336104394       residual = 8.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913336113867       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913336123378       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913336121240       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913336122559       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913336133964       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913336132041       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913336136096       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913336140879       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913336138633       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913336142222       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913336143403       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913336143908       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913336142502       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913336143893       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913336143492       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913336147222       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913336147951       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913336146962       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913336145751       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913336147945       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913336149903       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913336149108       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913336148818       residual = 8.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913336149451       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913336150518       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913336150339       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913336150674       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913336149777       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913336149974       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913336150056       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.4414e+01 is 1.468574e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913335127313       residual = 4.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913335317611       residual = 7.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913335358803       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913335372125       residual = 8.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913335374494       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913335376873       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913335376340       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913335376661       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913335379522       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913335379043       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913335380059       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913335381257       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913335380694       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913335381592       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913335381885       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913335382010       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913335381659       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913335382008       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913335381909       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913335382841       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913335383020       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913335382771       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913335382470       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913335383022       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913335383510       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913335383309       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913335383237       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913335383396       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913335383662       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913335383616       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913335383698       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913335383475       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913335383525       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913335383545       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e+01 is 3.672248e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913335127313       residual = 4.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913335174916       residual = 7.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913335185218       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913335188550       residual = 8.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913335189142       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913335189737       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913335189604       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913335189684       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913335190399       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913335190280       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913335190534       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913335190833       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913335190693       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913335190918       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913335190991       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913335191021       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913335190935       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913335191022       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913335190996       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913335191230       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913335191274       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913335191211       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913335191136       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913335191275       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913335191397       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913335191347       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913335191328       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913335191367       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913335191433       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913335191422       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913335191444       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913335191388       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913335191401       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913335191405       residual = 7.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.9062e+02 is 9.181128e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.923776 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4583e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
  uu_0                 2.101176e-01 1 1  ON 0
  uu_1                 5.276373e-02 1 1  ON 1
  uu_2                -3.833232e-02 1 1  ON 2
  uu_3                -9.174575e-02 1 1  ON 3
  uu_4                -1.223650e-01 1 1  ON 4
  uu_5                -1.300901e-01 1 1  ON 5
  uu_6                -1.126230e-01 1 1  ON 6
  uu_7                -5.641063e-02 1 1  ON 7
  uu_8                 6.016141e-02 1 1  ON 8
  uu_9                 1.247120e-01 1 1  ON 9
  ud_0                 3.051714e-01 1 1  ON 10
  ud_1                 7.603731e-02 1 1  ON 11
  ud_2                -2.623964e-02 1 1  ON 12
  ud_3                -7.918101e-02 1 1  ON 13
  ud_4                -1.149292e-01 1 1  ON 14
  ud_5                -1.334625e-01 1 1  ON 15
  ud_6                -1.266685e-01 1 1  ON 16
  ud_7                -8.516260e-02 1 1  ON 17
  ud_8                -5.951693e-03 1 1  ON 18
  ud_9                 8.614771e-02 1 1  ON 19
  eO_0                -7.035110e-01 1 1  ON 20
  eO_1                -4.201045e-01 1 1  ON 21
  eO_2                -4.159471e-02 1 1  ON 22
  eO_3                 1.846097e-01 1 1  ON 23
  eO_4                 2.570911e-01 1 1  ON 24
  eO_5                 2.803695e-01 1 1  ON 25
  eO_6                 2.510091e-01 1 1  ON 26
  eO_7                 1.323346e-01 1 1  ON 27
  eO_8                 2.922293e-02 1 1  ON 28
  eO_9                 1.913536e-02 1 1  ON 29
 eH1_0                -2.017819e-01 1 1  ON 30
 eH1_1                -9.600794e-02 1 1  ON 31
 eH1_2                -4.467927e-02 1 1  ON 32
 eH1_3                -1.417321e-02 1 1  ON 33
 eH1_4                 1.850431e-02 1 1  ON 34
 eH1_5                 2.191952e-02 1 1  ON 35
 eH1_6                 7.086528e-02 1 1  ON 36
 eH1_7                 1.028845e-01 1 1  ON 37
 eH1_8                 1.005741e-01 1 1  ON 38
 eH1_9                 2.591263e-02 1 1  ON 39
 eH2_0                -2.032792e-01 1 1  ON 40
 eH2_1                -9.794007e-02 1 1  ON 41
 eH2_2                -4.656436e-02 1 1  ON 42
 eH2_3                -1.571441e-02 1 1  ON 43
 eH2_4                 1.626917e-02 1 1  ON 44
 eH2_5                 1.979270e-02 1 1  ON 45
 eH2_6                 7.241662e-02 1 1  ON 46
 eH2_7                 1.104403e-01 1 1  ON 47
 eH2_8                 1.030710e-01 1 1  ON 48
 eH2_9                 2.884979e-02 1 1  ON 49
ci_001                -4.206547e-02 3 1  ON 50
ci_002                -3.076192e-02 3 1  ON 51
ci_003                -1.127143e-02 3 1  ON 52
ci_004                 2.571770e-02 3 1  ON 53
ci_005                 2.585033e-02 3 1  ON 54
ci_006                -2.025641e-02 3 1  ON 55
ci_007                -1.956770e-02 3 1  ON 56
ci_008                -4.027236e-03 3 1  ON 57
ci_009                -1.505223e-02 3 1  ON 58
ci_010                -9.382482e-03 3 1  ON 59
ci_011                -9.740170e-03 3 1  ON 60
ci_012                -9.677799e-03 3 1  ON 61
ci_013                -2.163358e-02 3 1  ON 62
ci_014                 1.324349e-02 3 1  ON 63
ci_015                 1.289290e-02 3 1  ON 64
ci_016                 1.634822e-02 3 1  ON 65
ci_017                 1.620982e-02 3 1  ON 66
ci_018                 1.099870e-02 3 1  ON 67
ci_019                 1.071784e-02 3 1  ON 68
ci_020                 1.834081e-02 3 1  ON 69
ci_021                 1.804842e-02 3 1  ON 70
ci_022                 1.041559e-02 3 1  ON 71
ci_023                 1.004831e-02 3 1  ON 72
ci_024                 6.613530e-03 3 1  ON 73
ci_025                 6.588630e-03 3 1  ON 74
ci_026                 1.164087e-02 3 1  ON 75
ci_027                 1.153644e-02 3 1  ON 76
ci_028                -8.790428e-03 3 1  ON 77
ci_029                -9.823568e-03 3 1  ON 78
ci_030                -5.405918e-03 3 1  ON 79
ci_031                -4.540741e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2294
    reference variance = 0.191905
====================================================
  Execution time = 1.9337e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0097e-01
  Total weights = 1.9737e+06
  Execution time = 1.5540e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292479666993
                                         uncertainty =       0.001652382037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292479666993
                                         uncertainty =       0.001652382037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382370808
  error estimate for blocks of size 2^( 2) =       0.000397641344
  error estimate for blocks of size 2^( 3) =       0.000412146452
  error estimate for blocks of size 2^( 4) =       0.000422477222
  error estimate for blocks of size 2^( 5) =       0.000428556960
  error estimate for blocks of size 2^( 6) =       0.000431164232
  error estimate for blocks of size 2^( 7) =       0.000432034032

      target function =      -0.911300796322
              le_mean =     -17.205844328731
             les_mean =     296.342047212590
             stat err =       0.000428558111
             autocorr =       1.256174521604
   target nu stat err =       0.000428558111
   target dn stat err =       0.002609201292
      target stat err =       0.004068226127
              std dev =       0.540753983143
             le_variance =       0.292414870285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292478818368
                                         uncertainty =       0.001652392154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292478818368
                                         uncertainty =       0.001652392154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382370254
  error estimate for blocks of size 2^( 2) =       0.000397640604
  error estimate for blocks of size 2^( 3) =       0.000412145558
  error estimate for blocks of size 2^( 4) =       0.000422476158
  error estimate for blocks of size 2^( 5) =       0.000428555826
  error estimate for blocks of size 2^( 6) =       0.000431163161
  error estimate for blocks of size 2^( 7) =       0.000432032843

      target function =      -0.911309156339
              le_mean =     -17.205844330682
             les_mean =     296.342041835896
             stat err =       0.000428556997
             autocorr =       1.256171632081
   target nu stat err =       0.000428556997
   target dn stat err =       0.002608695239
      target stat err =       0.004067535029
              std dev =       0.540753199147
             le_variance =       0.292414022388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292479240750
                                         uncertainty =       0.001652387064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292479240750
                                         uncertainty =       0.001652387064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382370530
  error estimate for blocks of size 2^( 2) =       0.000397640973
  error estimate for blocks of size 2^( 3) =       0.000412146004
  error estimate for blocks of size 2^( 4) =       0.000422476688
  error estimate for blocks of size 2^( 5) =       0.000428556391
  error estimate for blocks of size 2^( 6) =       0.000431163695
  error estimate for blocks of size 2^( 7) =       0.000432033436

      target function =      -0.911305181604
              le_mean =     -17.205844329634
             les_mean =     296.342044387966
             stat err =       0.000428557552
             autocorr =       1.256173074117
   target nu stat err =       0.000428557552
   target dn stat err =       0.002608945149
      target stat err =       0.004067877676
              std dev =       0.540753589362
             le_variance =       0.292414444408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292479613580
                                         uncertainty =       0.001652382661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292479613580
                                         uncertainty =       0.001652382661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382370774
  error estimate for blocks of size 2^( 2) =       0.000397641298
  error estimate for blocks of size 2^( 3) =       0.000412146396
  error estimate for blocks of size 2^( 4) =       0.000422477155
  error estimate for blocks of size 2^( 5) =       0.000428556889
  error estimate for blocks of size 2^( 6) =       0.000431164165
  error estimate for blocks of size 2^( 7) =       0.000432033957

      target function =      -0.911301368700
              le_mean =     -17.205844328836
             les_mean =     296.342046843451
             stat err =       0.000428558041
             autocorr =       1.256174340665
   target nu stat err =       0.000428558041
   target dn stat err =       0.002609168953
      target stat err =       0.004068182297
              std dev =       0.540753933799
             le_variance =       0.292414816919


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911300796322        initial
     2.4414e+01     2.4414e+02             1.4686e-05        -0.911309156339  <--
     9.7656e+01     9.7656e+02             3.6722e-06        -0.911305181604
     3.9062e+02     3.9062e+03             9.1811e-07        -0.911301368700

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 2.7202e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
  uu_0                 2.101204e-01 1 1  ON 0
  uu_1                 5.276717e-02 1 1  ON 1
  uu_2                -3.832822e-02 1 1  ON 2
  uu_3                -9.174261e-02 1 1  ON 3
  uu_4                -1.223633e-01 1 1  ON 4
  uu_5                -1.300890e-01 1 1  ON 5
  uu_6                -1.126249e-01 1 1  ON 6
  uu_7                -5.641553e-02 1 1  ON 7
  uu_8                 6.015040e-02 1 1  ON 8
  uu_9                 1.247100e-01 1 1  ON 9
  ud_0                 3.051703e-01 1 1  ON 10
  ud_1                 7.603634e-02 1 1  ON 11
  ud_2                -2.623972e-02 1 1  ON 12
  ud_3                -7.918036e-02 1 1  ON 13
  ud_4                -1.149269e-01 1 1  ON 14
  ud_5                -1.334608e-01 1 1  ON 15
  ud_6                -1.266683e-01 1 1  ON 16
  ud_7                -8.516389e-02 1 1  ON 17
  ud_8                -5.952659e-03 1 1  ON 18
  ud_9                 8.614350e-02 1 1  ON 19
  eO_0                -7.035102e-01 1 1  ON 20
  eO_1                -4.201035e-01 1 1  ON 21
  eO_2                -4.159540e-02 1 1  ON 22
  eO_3                 1.846073e-01 1 1  ON 23
  eO_4                 2.570893e-01 1 1  ON 24
  eO_5                 2.803662e-01 1 1  ON 25
  eO_6                 2.510083e-01 1 1  ON 26
  eO_7                 1.323410e-01 1 1  ON 27
  eO_8                 2.922353e-02 1 1  ON 28
  eO_9                 1.913542e-02 1 1  ON 29
 eH1_0                -2.017819e-01 1 1  ON 30
 eH1_1                -9.600557e-02 1 1  ON 31
 eH1_2                -4.467737e-02 1 1  ON 32
 eH1_3                -1.417282e-02 1 1  ON 33
 eH1_4                 1.850447e-02 1 1  ON 34
 eH1_5                 2.191800e-02 1 1  ON 35
 eH1_6                 7.086230e-02 1 1  ON 36
 eH1_7                 1.028818e-01 1 1  ON 37
 eH1_8                 1.005756e-01 1 1  ON 38
 eH1_9                 2.591343e-02 1 1  ON 39
 eH2_0                -2.032768e-01 1 1  ON 40
 eH2_1                -9.793895e-02 1 1  ON 41
 eH2_2                -4.656269e-02 1 1  ON 42
 eH2_3                -1.571310e-02 1 1  ON 43
 eH2_4                 1.627315e-02 1 1  ON 44
 eH2_5                 1.978990e-02 1 1  ON 45
 eH2_6                 7.241031e-02 1 1  ON 46
 eH2_7                 1.104345e-01 1 1  ON 47
 eH2_8                 1.030735e-01 1 1  ON 48
 eH2_9                 2.885134e-02 1 1  ON 49
ci_001                -4.206469e-02 3 1  ON 50
ci_002                -3.076280e-02 3 1  ON 51
ci_003                -1.127141e-02 3 1  ON 52
ci_004                 2.571426e-02 3 1  ON 53
ci_005                 2.585269e-02 3 1  ON 54
ci_006                -2.025695e-02 3 1  ON 55
ci_007                -1.956798e-02 3 1  ON 56
ci_008                -4.029332e-03 3 1  ON 57
ci_009                -1.505089e-02 3 1  ON 58
ci_010                -9.385446e-03 3 1  ON 59
ci_011                -9.741209e-03 3 1  ON 60
ci_012                -9.680697e-03 3 1  ON 61
ci_013                -2.163349e-02 3 1  ON 62
ci_014                 1.324186e-02 3 1  ON 63
ci_015                 1.289343e-02 3 1  ON 64
ci_016                 1.634617e-02 3 1  ON 65
ci_017                 1.621085e-02 3 1  ON 66
ci_018                 1.099758e-02 3 1  ON 67
ci_019                 1.071698e-02 3 1  ON 68
ci_020                 1.834259e-02 3 1  ON 69
ci_021                 1.804890e-02 3 1  ON 70
ci_022                 1.041690e-02 3 1  ON 71
ci_023                 1.004771e-02 3 1  ON 72
ci_024                 6.612821e-03 3 1  ON 73
ci_025                 6.588144e-03 3 1  ON 74
ci_026                 1.164234e-02 3 1  ON 75
ci_027                 1.153500e-02 3 1  ON 76
ci_028                -8.794844e-03 3 1  ON 77
ci_029                -9.824612e-03 3 1  ON 78
ci_030                -5.407855e-03 3 1  ON 79
ci_031                -4.541545e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1804e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7193e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1639
    reference variance = 0.276916
====================================================
  Execution time = 1.8874e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5418e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9642e-01
  Total weights = 1.973861173e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5401e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289105375041
                                         uncertainty =       0.001888966809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289105375041
                                         uncertainty =       0.001888966809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380181424
  error estimate for blocks of size 2^( 2) =       0.000395824961
  error estimate for blocks of size 2^( 3) =       0.000410479905
  error estimate for blocks of size 2^( 4) =       0.000420966563
  error estimate for blocks of size 2^( 5) =       0.000427022189
  error estimate for blocks of size 2^( 6) =       0.000430357515
  error estimate for blocks of size 2^( 7) =       0.000431479317

      target function =      -0.918328714932
              le_mean =     -17.205851261948
             les_mean =     296.337741561427
             stat err =       0.000427456396
             autocorr =       1.264159445613
   target nu stat err =       0.000427456396
   target dn stat err =       0.002482128836
      target stat err =       0.003935165801
              std dev =       0.537657725891
             le_variance =       0.289075830211


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720585126195e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918344608435       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918349698510       residual = 7.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918350301016       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918350603015       residual = 8.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918350607807       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918350656720       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918350707174       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918350728602       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918350779065       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918350797817       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918350829697       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918350868376       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918350872706       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918350910327       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918350931437       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918350948974       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918350954102       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918350952135       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918350953449       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918350953799       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918350960821       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918350968132       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918350976778       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918350975007       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918350973828       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918350973562       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918350977735       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918350977930       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918350980372       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918350978974       residual = 8.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918350979928       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918350981365       residual = 5.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918350979367       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918350979875       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918350980238       residual = 9.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.1035e+00 is 5.453069e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918344608435       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918345893054       residual = 7.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918346044555       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918346120646       residual = 8.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918346121757       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918346134127       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918346146746       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918346152125       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918346164788       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918346169507       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918346177541       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918346187239       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918346188305       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918346197721       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918346203014       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918346207328       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918346208624       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918346208110       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918346208440       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918346208525       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918346210296       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918346212106       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918346214235       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918346213767       residual = 8.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918346213477       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918346213416       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918346214456       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918346214501       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918346215094       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918346214743       residual = 7.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918346215003       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918346215320       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918346214832       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918346214971       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918346215058       residual = 9.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.4414e+01 is 1.368591e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918344608435       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918344930355       residual = 7.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918344968286       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918344987346       residual = 8.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918344987618       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918344990719       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918344993874       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918344995220       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918344998389       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918344999571       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918345001584       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918345004010       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918345004275       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918345006630       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918345007954       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918345009028       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918345009353       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918345009223       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918345009306       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918345009327       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918345009770       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918345010222       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918345010752       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918345010633       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918345010561       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918345010546       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918345010806       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918345010816       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918345010964       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918345010876       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918345010943       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918345011019       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918345010898       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918345010933       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918345010955       residual = 9.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e+01 is 3.424825e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.981186 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4481e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
  uu_0                 2.101203e-01 1 1  ON 0
  uu_1                 5.277012e-02 1 1  ON 1
  uu_2                -3.832575e-02 1 1  ON 2
  uu_3                -9.174052e-02 1 1  ON 3
  uu_4                -1.223620e-01 1 1  ON 4
  uu_5                -1.300892e-01 1 1  ON 5
  uu_6                -1.126272e-01 1 1  ON 6
  uu_7                -5.641727e-02 1 1  ON 7
  uu_8                 6.013819e-02 1 1  ON 8
  uu_9                 1.247095e-01 1 1  ON 9
  ud_0                 3.051649e-01 1 1  ON 10
  ud_1                 7.603368e-02 1 1  ON 11
  ud_2                -2.624285e-02 1 1  ON 12
  ud_3                -7.918338e-02 1 1  ON 13
  ud_4                -1.149282e-01 1 1  ON 14
  ud_5                -1.334608e-01 1 1  ON 15
  ud_6                -1.266636e-01 1 1  ON 16
  ud_7                -8.515814e-02 1 1  ON 17
  ud_8                -5.949725e-03 1 1  ON 18
  ud_9                 8.614035e-02 1 1  ON 19
  eO_0                -7.035216e-01 1 1  ON 20
  eO_1                -4.201163e-01 1 1  ON 21
  eO_2                -4.160332e-02 1 1  ON 22
  eO_3                 1.846093e-01 1 1  ON 23
  eO_4                 2.570972e-01 1 1  ON 24
  eO_5                 2.803714e-01 1 1  ON 25
  eO_6                 2.510122e-01 1 1  ON 26
  eO_7                 1.323510e-01 1 1  ON 27
  eO_8                 2.922522e-02 1 1  ON 28
  eO_9                 1.913626e-02 1 1  ON 29
 eH1_0                -2.017819e-01 1 1  ON 30
 eH1_1                -9.600573e-02 1 1  ON 31
 eH1_2                -4.467650e-02 1 1  ON 32
 eH1_3                -1.417056e-02 1 1  ON 33
 eH1_4                 1.850482e-02 1 1  ON 34
 eH1_5                 2.191493e-02 1 1  ON 35
 eH1_6                 7.085614e-02 1 1  ON 36
 eH1_7                 1.028809e-01 1 1  ON 37
 eH1_8                 1.005801e-01 1 1  ON 38
 eH1_9                 2.591519e-02 1 1  ON 39
 eH2_0                -2.032679e-01 1 1  ON 40
 eH2_1                -9.793184e-02 1 1  ON 41
 eH2_2                -4.655808e-02 1 1  ON 42
 eH2_3                -1.571034e-02 1 1  ON 43
 eH2_4                 1.627181e-02 1 1  ON 44
 eH2_5                 1.977621e-02 1 1  ON 45
 eH2_6                 7.239888e-02 1 1  ON 46
 eH2_7                 1.104308e-01 1 1  ON 47
 eH2_8                 1.030783e-01 1 1  ON 48
 eH2_9                 2.885256e-02 1 1  ON 49
ci_001                -4.206048e-02 3 1  ON 50
ci_002                -3.076508e-02 3 1  ON 51
ci_003                -1.127104e-02 3 1  ON 52
ci_004                 2.570993e-02 3 1  ON 53
ci_005                 2.585384e-02 3 1  ON 54
ci_006                -2.025715e-02 3 1  ON 55
ci_007                -1.956963e-02 3 1  ON 56
ci_008                -4.031052e-03 3 1  ON 57
ci_009                -1.505474e-02 3 1  ON 58
ci_010                -9.385053e-03 3 1  ON 59
ci_011                -9.737906e-03 3 1  ON 60
ci_012                -9.681545e-03 3 1  ON 61
ci_013                -2.163338e-02 3 1  ON 62
ci_014                 1.324197e-02 3 1  ON 63
ci_015                 1.289513e-02 3 1  ON 64
ci_016                 1.634861e-02 3 1  ON 65
ci_017                 1.620768e-02 3 1  ON 66
ci_018                 1.099502e-02 3 1  ON 67
ci_019                 1.071130e-02 3 1  ON 68
ci_020                 1.834818e-02 3 1  ON 69
ci_021                 1.804947e-02 3 1  ON 70
ci_022                 1.041918e-02 3 1  ON 71
ci_023                 1.005094e-02 3 1  ON 72
ci_024                 6.611048e-03 3 1  ON 73
ci_025                 6.585315e-03 3 1  ON 74
ci_026                 1.164313e-02 3 1  ON 75
ci_027                 1.153394e-02 3 1  ON 76
ci_028                -8.796165e-03 3 1  ON 77
ci_029                -9.822540e-03 3 1  ON 78
ci_030                -5.407187e-03 3 1  ON 79
ci_031                -4.542687e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1413
    reference variance = 0.2928
====================================================
  Execution time = 1.9115e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9759e-01
  Total weights = 1.9739e+06
  Execution time = 1.5671e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291020991078
                                         uncertainty =       0.002129620199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291020991078
                                         uncertainty =       0.002129620199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381471841
  error estimate for blocks of size 2^( 2) =       0.000397042359
  error estimate for blocks of size 2^( 3) =       0.000411190220
  error estimate for blocks of size 2^( 4) =       0.000421762879
  error estimate for blocks of size 2^( 5) =       0.000427303996
  error estimate for blocks of size 2^( 6) =       0.000431217833
  error estimate for blocks of size 2^( 7) =       0.000432158739

      target function =      -0.916501488069
              le_mean =     -17.207122081401
             les_mean =     296.382636191643
             stat err =       0.000428110862
             autocorr =       1.259469115903
   target nu stat err =       0.000428110862
   target dn stat err =       0.002515627340
      target stat err =       0.003980446944
              std dev =       0.539482651363
             le_variance =       0.291041531122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291021026636
                                         uncertainty =       0.002131196703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291021026636
                                         uncertainty =       0.002131196703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381471862
  error estimate for blocks of size 2^( 2) =       0.000397042645
  error estimate for blocks of size 2^( 3) =       0.000411190510
  error estimate for blocks of size 2^( 4) =       0.000421763457
  error estimate for blocks of size 2^( 5) =       0.000427304288
  error estimate for blocks of size 2^( 6) =       0.000431218165
  error estimate for blocks of size 2^( 7) =       0.000432158571

      target function =      -0.916476548497
              le_mean =     -17.207122025664
             les_mean =     296.382650291253
             stat err =       0.000428111120
             autocorr =       1.259470496592
   target nu stat err =       0.000428111120
   target dn stat err =       0.002517378737
      target stat err =       0.003982912428
              std dev =       0.539482681563
             le_variance =       0.291041563706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291020990557
                                         uncertainty =       0.002130414088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291020990557
                                         uncertainty =       0.002130414088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381471840
  error estimate for blocks of size 2^( 2) =       0.000397042492
  error estimate for blocks of size 2^( 3) =       0.000411190354
  error estimate for blocks of size 2^( 4) =       0.000421763159
  error estimate for blocks of size 2^( 5) =       0.000427304131
  error estimate for blocks of size 2^( 6) =       0.000431217987
  error estimate for blocks of size 2^( 7) =       0.000432158642

      target function =      -0.916490909177
              le_mean =     -17.207122051738
             les_mean =     296.382641964103
             stat err =       0.000428110980
             autocorr =       1.259469818533
   target nu stat err =       0.000428110980
   target dn stat err =       0.002516498574
      target stat err =       0.003981689026
              std dev =       0.539482649504
             le_variance =       0.291041529116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291020989038
                                         uncertainty =       0.002129719541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291020989038
                                         uncertainty =       0.002129719541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381471840
  error estimate for blocks of size 2^( 2) =       0.000397042375
  error estimate for blocks of size 2^( 3) =       0.000411190236
  error estimate for blocks of size 2^( 4) =       0.000421762913
  error estimate for blocks of size 2^( 5) =       0.000427304012
  error estimate for blocks of size 2^( 6) =       0.000431217850
  error estimate for blocks of size 2^( 7) =       0.000432158725

      target function =      -0.916500320129
              le_mean =     -17.207122077481
             les_mean =     296.382636806641
             stat err =       0.000428110875
             autocorr =       1.259469204305
   target nu stat err =       0.000428110875
   target dn stat err =       0.002515735616
      target stat err =       0.003980602563
              std dev =       0.539482649301
             le_variance =       0.291041528897


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916501488069        initial  <--
     6.1035e+00     6.1035e+01             5.4531e-05        -0.916476548497
     2.4414e+01     2.4414e+02             1.3686e-05        -0.916490909177
     9.7656e+01     9.7656e+02             3.4248e-06        -0.916500320129

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.9953
  </log>
  <optVariables href="H2O.s030.opt.xml">
  uu_0                 2.101204e-01 1 1  ON 0
  uu_1                 5.276717e-02 1 1  ON 1
  uu_2                -3.832822e-02 1 1  ON 2
  uu_3                -9.174261e-02 1 1  ON 3
  uu_4                -1.223633e-01 1 1  ON 4
  uu_5                -1.300890e-01 1 1  ON 5
  uu_6                -1.126249e-01 1 1  ON 6
  uu_7                -5.641553e-02 1 1  ON 7
  uu_8                 6.015040e-02 1 1  ON 8
  uu_9                 1.247100e-01 1 1  ON 9
  ud_0                 3.051703e-01 1 1  ON 10
  ud_1                 7.603634e-02 1 1  ON 11
  ud_2                -2.623972e-02 1 1  ON 12
  ud_3                -7.918036e-02 1 1  ON 13
  ud_4                -1.149269e-01 1 1  ON 14
  ud_5                -1.334608e-01 1 1  ON 15
  ud_6                -1.266683e-01 1 1  ON 16
  ud_7                -8.516389e-02 1 1  ON 17
  ud_8                -5.952659e-03 1 1  ON 18
  ud_9                 8.614350e-02 1 1  ON 19
  eO_0                -7.035102e-01 1 1  ON 20
  eO_1                -4.201035e-01 1 1  ON 21
  eO_2                -4.159540e-02 1 1  ON 22
  eO_3                 1.846073e-01 1 1  ON 23
  eO_4                 2.570893e-01 1 1  ON 24
  eO_5                 2.803662e-01 1 1  ON 25
  eO_6                 2.510083e-01 1 1  ON 26
  eO_7                 1.323410e-01 1 1  ON 27
  eO_8                 2.922353e-02 1 1  ON 28
  eO_9                 1.913542e-02 1 1  ON 29
 eH1_0                -2.017819e-01 1 1  ON 30
 eH1_1                -9.600557e-02 1 1  ON 31
 eH1_2                -4.467737e-02 1 1  ON 32
 eH1_3                -1.417282e-02 1 1  ON 33
 eH1_4                 1.850447e-02 1 1  ON 34
 eH1_5                 2.191800e-02 1 1  ON 35
 eH1_6                 7.086230e-02 1 1  ON 36
 eH1_7                 1.028818e-01 1 1  ON 37
 eH1_8                 1.005756e-01 1 1  ON 38
 eH1_9                 2.591343e-02 1 1  ON 39
 eH2_0                -2.032768e-01 1 1  ON 40
 eH2_1                -9.793895e-02 1 1  ON 41
 eH2_2                -4.656269e-02 1 1  ON 42
 eH2_3                -1.571310e-02 1 1  ON 43
 eH2_4                 1.627315e-02 1 1  ON 44
 eH2_5                 1.978990e-02 1 1  ON 45
 eH2_6                 7.241031e-02 1 1  ON 46
 eH2_7                 1.104345e-01 1 1  ON 47
 eH2_8                 1.030735e-01 1 1  ON 48
 eH2_9                 2.885134e-02 1 1  ON 49
ci_001                -4.206469e-02 3 1  ON 50
ci_002                -3.076280e-02 3 1  ON 51
ci_003                -1.127141e-02 3 1  ON 52
ci_004                 2.571426e-02 3 1  ON 53
ci_005                 2.585269e-02 3 1  ON 54
ci_006                -2.025695e-02 3 1  ON 55
ci_007                -1.956798e-02 3 1  ON 56
ci_008                -4.029332e-03 3 1  ON 57
ci_009                -1.505089e-02 3 1  ON 58
ci_010                -9.385446e-03 3 1  ON 59
ci_011                -9.741209e-03 3 1  ON 60
ci_012                -9.680697e-03 3 1  ON 61
ci_013                -2.163349e-02 3 1  ON 62
ci_014                 1.324186e-02 3 1  ON 63
ci_015                 1.289343e-02 3 1  ON 64
ci_016                 1.634617e-02 3 1  ON 65
ci_017                 1.621085e-02 3 1  ON 66
ci_018                 1.099758e-02 3 1  ON 67
ci_019                 1.071698e-02 3 1  ON 68
ci_020                 1.834259e-02 3 1  ON 69
ci_021                 1.804890e-02 3 1  ON 70
ci_022                 1.041690e-02 3 1  ON 71
ci_023                 1.004771e-02 3 1  ON 72
ci_024                 6.612821e-03 3 1  ON 73
ci_025                 6.588144e-03 3 1  ON 74
ci_026                 1.164234e-02 3 1  ON 75
ci_027                 1.153500e-02 3 1  ON 76
ci_028                -8.794844e-03 3 1  ON 77
ci_029                -9.824612e-03 3 1  ON 78
ci_030                -5.407855e-03 3 1  ON 79
ci_031                -4.541545e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1491e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7191e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2069
    reference variance = 0.719048
====================================================
  Execution time = 1.9373e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5422e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9676e-01
  Total weights = 1.973597588e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5451e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289192556363
                                         uncertainty =       0.001922634504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289192556363
                                         uncertainty =       0.001922634504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380276330
  error estimate for blocks of size 2^( 2) =       0.000395572242
  error estimate for blocks of size 2^( 3) =       0.000409642840
  error estimate for blocks of size 2^( 4) =       0.000419334546
  error estimate for blocks of size 2^( 5) =       0.000425267600
  error estimate for blocks of size 2^( 6) =       0.000428954780
  error estimate for blocks of size 2^( 7) =       0.000431534758

      target function =      -0.917799044930
              le_mean =     -17.206446986660
             les_mean =     296.358579524055
             stat err =       0.000426272921
             autocorr =       1.256541692064
   target nu stat err =       0.000426272921
   target dn stat err =       0.002214292028
      target stat err =       0.003525277207
              std dev =       0.537791942712
             le_variance =       0.289220173646


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720644698666e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917811522104       residual = 4.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917811793607       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917811920930       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917811932366       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917811935984       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917811940757       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917811948116       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917811949492       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917811955949       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917811958058       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917811963014       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917811962615       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917811959635       residual = 7.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917811961923       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917811961501       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917811963394       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917811962791       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917811963429       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917811963183       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917811963482       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917811965664       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917811965528       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917811965522       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917811965785       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917811965463       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917811965486       residual = 9.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917811966066       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917811966128       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917811966209       residual = 7.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917811966473       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917811966165       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917811966328       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917811966202       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917811966253       residual = 7.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.1035e+01 is 6.228426e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917811522104       residual = 4.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917811590041       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917811621900       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917811624761       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917811625666       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917811626860       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917811628701       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917811629045       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917811630661       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917811631189       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917811632427       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917811632327       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917811631582       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917811632153       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917811632049       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917811632522       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917811632371       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917811632530       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917811632469       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917811632544       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917811633090       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917811633055       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917811633054       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917811633119       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917811633038       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917811633045       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917811633190       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917811633205       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917811633226       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917811633291       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917811633213       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917811633253       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917811633224       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917811633236       residual = 7.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.4414e+02 is 1.557285e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917811522104       residual = 4.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917811539092       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917811547058       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917811547774       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917811548000       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917811548299       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917811548758       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917811548845       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917811549249       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917811549381       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917811549689       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917811549664       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917811549481       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917811549623       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917811549595       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917811549715       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917811549677       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917811549714       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917811549699       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917811549719       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917811549853       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917811549848       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917811549846       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917811549867       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917811549845       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917811549849       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917811549879       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917811549885       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917811549892       residual = 7.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917811549902       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917811549884       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917811549901       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917811549887       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917811549893       residual = 7.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e+02 is 3.893324e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.023173 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4968e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
  uu_0                 2.101208e-01 1 1  ON 0
  uu_1                 5.276764e-02 1 1  ON 1
  uu_2                -3.832772e-02 1 1  ON 2
  uu_3                -9.174235e-02 1 1  ON 3
  uu_4                -1.223634e-01 1 1  ON 4
  uu_5                -1.300891e-01 1 1  ON 5
  uu_6                -1.126250e-01 1 1  ON 6
  uu_7                -5.641560e-02 1 1  ON 7
  uu_8                 6.014884e-02 1 1  ON 8
  uu_9                 1.247101e-01 1 1  ON 9
  ud_0                 3.051698e-01 1 1  ON 10
  ud_1                 7.603580e-02 1 1  ON 11
  ud_2                -2.623983e-02 1 1  ON 12
  ud_3                -7.918023e-02 1 1  ON 13
  ud_4                -1.149268e-01 1 1  ON 14
  ud_5                -1.334608e-01 1 1  ON 15
  ud_6                -1.266679e-01 1 1  ON 16
  ud_7                -8.516287e-02 1 1  ON 17
  ud_8                -5.953166e-03 1 1  ON 18
  ud_9                 8.614295e-02 1 1  ON 19
  eO_0                -7.035104e-01 1 1  ON 20
  eO_1                -4.201038e-01 1 1  ON 21
  eO_2                -4.159585e-02 1 1  ON 22
  eO_3                 1.846073e-01 1 1  ON 23
  eO_4                 2.570894e-01 1 1  ON 24
  eO_5                 2.803660e-01 1 1  ON 25
  eO_6                 2.510083e-01 1 1  ON 26
  eO_7                 1.323420e-01 1 1  ON 27
  eO_8                 2.922359e-02 1 1  ON 28
  eO_9                 1.913541e-02 1 1  ON 29
 eH1_0                -2.017817e-01 1 1  ON 30
 eH1_1                -9.600554e-02 1 1  ON 31
 eH1_2                -4.467737e-02 1 1  ON 32
 eH1_3                -1.417276e-02 1 1  ON 33
 eH1_4                 1.850463e-02 1 1  ON 34
 eH1_5                 2.191780e-02 1 1  ON 35
 eH1_6                 7.086186e-02 1 1  ON 36
 eH1_7                 1.028815e-01 1 1  ON 37
 eH1_8                 1.005760e-01 1 1  ON 38
 eH1_9                 2.591350e-02 1 1  ON 39
 eH2_0                -2.032770e-01 1 1  ON 40
 eH2_1                -9.793927e-02 1 1  ON 41
 eH2_2                -4.656284e-02 1 1  ON 42
 eH2_3                -1.571324e-02 1 1  ON 43
 eH2_4                 1.627325e-02 1 1  ON 44
 eH2_5                 1.979062e-02 1 1  ON 45
 eH2_6                 7.240999e-02 1 1  ON 46
 eH2_7                 1.104342e-01 1 1  ON 47
 eH2_8                 1.030741e-01 1 1  ON 48
 eH2_9                 2.885140e-02 1 1  ON 49
ci_001                -4.206453e-02 3 1  ON 50
ci_002                -3.076304e-02 3 1  ON 51
ci_003                -1.127140e-02 3 1  ON 52
ci_004                 2.571437e-02 3 1  ON 53
ci_005                 2.585256e-02 3 1  ON 54
ci_006                -2.025717e-02 3 1  ON 55
ci_007                -1.956797e-02 3 1  ON 56
ci_008                -4.029554e-03 3 1  ON 57
ci_009                -1.505088e-02 3 1  ON 58
ci_010                -9.385187e-03 3 1  ON 59
ci_011                -9.741215e-03 3 1  ON 60
ci_012                -9.680626e-03 3 1  ON 61
ci_013                -2.163322e-02 3 1  ON 62
ci_014                 1.324191e-02 3 1  ON 63
ci_015                 1.289397e-02 3 1  ON 64
ci_016                 1.634607e-02 3 1  ON 65
ci_017                 1.621086e-02 3 1  ON 66
ci_018                 1.099773e-02 3 1  ON 67
ci_019                 1.071719e-02 3 1  ON 68
ci_020                 1.834260e-02 3 1  ON 69
ci_021                 1.804899e-02 3 1  ON 70
ci_022                 1.041726e-02 3 1  ON 71
ci_023                 1.004806e-02 3 1  ON 72
ci_024                 6.612915e-03 3 1  ON 73
ci_025                 6.588724e-03 3 1  ON 74
ci_026                 1.164232e-02 3 1  ON 75
ci_027                 1.153513e-02 3 1  ON 76
ci_028                -8.794900e-03 3 1  ON 77
ci_029                -9.824579e-03 3 1  ON 78
ci_030                -5.407554e-03 3 1  ON 79
ci_031                -4.541667e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.244
    reference variance = 0.740275
====================================================
  Execution time = 1.9318e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9922e-01
  Total weights = 1.9738e+06
  Execution time = 1.6232e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290589408988
                                         uncertainty =       0.001732720283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290589408988
                                         uncertainty =       0.001732720283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381226405
  error estimate for blocks of size 2^( 2) =       0.000396377362
  error estimate for blocks of size 2^( 3) =       0.000411061792
  error estimate for blocks of size 2^( 4) =       0.000421359523
  error estimate for blocks of size 2^( 5) =       0.000427846326
  error estimate for blocks of size 2^( 6) =       0.000430746303
  error estimate for blocks of size 2^( 7) =       0.000434438497

      target function =      -0.913963780345
              le_mean =     -17.206814029891
             les_mean =     296.373669348246
             stat err =       0.000428597662
             autocorr =       1.263960929580
   target nu stat err =       0.000428597662
   target dn stat err =       0.003126877812
      target stat err =       0.004888926897
              std dev =       0.539135551764
             le_variance =       0.290667143176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290589378159
                                         uncertainty =       0.001732823777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290589378159
                                         uncertainty =       0.001732823777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381226382
  error estimate for blocks of size 2^( 2) =       0.000396377293
  error estimate for blocks of size 2^( 3) =       0.000411061642
  error estimate for blocks of size 2^( 4) =       0.000421359315
  error estimate for blocks of size 2^( 5) =       0.000427846070
  error estimate for blocks of size 2^( 6) =       0.000430746109
  error estimate for blocks of size 2^( 7) =       0.000434438211

      target function =      -0.913958489132
              le_mean =     -17.206814034250
             les_mean =     296.373672907633
             stat err =       0.000428597426
             autocorr =       1.263959690348
   target nu stat err =       0.000428597426
   target dn stat err =       0.003128090523
      target stat err =       0.004890725371
              std dev =       0.539135519091
             le_variance =       0.290667107946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290589393386
                                         uncertainty =       0.001732772055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290589393386
                                         uncertainty =       0.001732772055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381226393
  error estimate for blocks of size 2^( 2) =       0.000396377327
  error estimate for blocks of size 2^( 3) =       0.000411061717
  error estimate for blocks of size 2^( 4) =       0.000421359419
  error estimate for blocks of size 2^( 5) =       0.000427846198
  error estimate for blocks of size 2^( 6) =       0.000430746206
  error estimate for blocks of size 2^( 7) =       0.000434438354

      target function =      -0.913961148731
              le_mean =     -17.206814032055
             les_mean =     296.373671118361
             stat err =       0.000428597544
             autocorr =       1.263960309664
   target nu stat err =       0.000428597544
   target dn stat err =       0.003127483899
      target stat err =       0.004889825874
              std dev =       0.539135535252
             le_variance =       0.290667125371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290589407021
                                         uncertainty =       0.001732726754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290589407021
                                         uncertainty =       0.001732726754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381226403
  error estimate for blocks of size 2^( 2) =       0.000396377358
  error estimate for blocks of size 2^( 3) =       0.000411061782
  error estimate for blocks of size 2^( 4) =       0.000421359510
  error estimate for blocks of size 2^( 5) =       0.000427846310
  error estimate for blocks of size 2^( 6) =       0.000430746291
  error estimate for blocks of size 2^( 7) =       0.000434438479

      target function =      -0.913963453216
              le_mean =     -17.206814030159
             les_mean =     296.373669568266
             stat err =       0.000428597648
             autocorr =       1.263960852092
   target nu stat err =       0.000428597648
   target dn stat err =       0.003126953500
      target stat err =       0.004889039178
              std dev =       0.539135549685
             le_variance =       0.290667140934


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913963780345        initial  <--
     6.1035e+01     6.1035e+02             6.2284e-06        -0.913958489132
     2.4414e+02     2.4414e+03             1.5573e-06        -0.913961148731
     9.7656e+02     9.7656e+03             3.8933e-07        -0.913963453216

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.4769
  </log>
  <optVariables href="H2O.s031.opt.xml">
  uu_0                 2.101204e-01 1 1  ON 0
  uu_1                 5.276717e-02 1 1  ON 1
  uu_2                -3.832822e-02 1 1  ON 2
  uu_3                -9.174261e-02 1 1  ON 3
  uu_4                -1.223633e-01 1 1  ON 4
  uu_5                -1.300890e-01 1 1  ON 5
  uu_6                -1.126249e-01 1 1  ON 6
  uu_7                -5.641553e-02 1 1  ON 7
  uu_8                 6.015040e-02 1 1  ON 8
  uu_9                 1.247100e-01 1 1  ON 9
  ud_0                 3.051703e-01 1 1  ON 10
  ud_1                 7.603634e-02 1 1  ON 11
  ud_2                -2.623972e-02 1 1  ON 12
  ud_3                -7.918036e-02 1 1  ON 13
  ud_4                -1.149269e-01 1 1  ON 14
  ud_5                -1.334608e-01 1 1  ON 15
  ud_6                -1.266683e-01 1 1  ON 16
  ud_7                -8.516389e-02 1 1  ON 17
  ud_8                -5.952659e-03 1 1  ON 18
  ud_9                 8.614350e-02 1 1  ON 19
  eO_0                -7.035102e-01 1 1  ON 20
  eO_1                -4.201035e-01 1 1  ON 21
  eO_2                -4.159540e-02 1 1  ON 22
  eO_3                 1.846073e-01 1 1  ON 23
  eO_4                 2.570893e-01 1 1  ON 24
  eO_5                 2.803662e-01 1 1  ON 25
  eO_6                 2.510083e-01 1 1  ON 26
  eO_7                 1.323410e-01 1 1  ON 27
  eO_8                 2.922353e-02 1 1  ON 28
  eO_9                 1.913542e-02 1 1  ON 29
 eH1_0                -2.017819e-01 1 1  ON 30
 eH1_1                -9.600557e-02 1 1  ON 31
 eH1_2                -4.467737e-02 1 1  ON 32
 eH1_3                -1.417282e-02 1 1  ON 33
 eH1_4                 1.850447e-02 1 1  ON 34
 eH1_5                 2.191800e-02 1 1  ON 35
 eH1_6                 7.086230e-02 1 1  ON 36
 eH1_7                 1.028818e-01 1 1  ON 37
 eH1_8                 1.005756e-01 1 1  ON 38
 eH1_9                 2.591343e-02 1 1  ON 39
 eH2_0                -2.032768e-01 1 1  ON 40
 eH2_1                -9.793895e-02 1 1  ON 41
 eH2_2                -4.656269e-02 1 1  ON 42
 eH2_3                -1.571310e-02 1 1  ON 43
 eH2_4                 1.627315e-02 1 1  ON 44
 eH2_5                 1.978990e-02 1 1  ON 45
 eH2_6                 7.241031e-02 1 1  ON 46
 eH2_7                 1.104345e-01 1 1  ON 47
 eH2_8                 1.030735e-01 1 1  ON 48
 eH2_9                 2.885134e-02 1 1  ON 49
ci_001                -4.206469e-02 3 1  ON 50
ci_002                -3.076280e-02 3 1  ON 51
ci_003                -1.127141e-02 3 1  ON 52
ci_004                 2.571426e-02 3 1  ON 53
ci_005                 2.585269e-02 3 1  ON 54
ci_006                -2.025695e-02 3 1  ON 55
ci_007                -1.956798e-02 3 1  ON 56
ci_008                -4.029332e-03 3 1  ON 57
ci_009                -1.505089e-02 3 1  ON 58
ci_010                -9.385446e-03 3 1  ON 59
ci_011                -9.741209e-03 3 1  ON 60
ci_012                -9.680697e-03 3 1  ON 61
ci_013                -2.163349e-02 3 1  ON 62
ci_014                 1.324186e-02 3 1  ON 63
ci_015                 1.289343e-02 3 1  ON 64
ci_016                 1.634617e-02 3 1  ON 65
ci_017                 1.621085e-02 3 1  ON 66
ci_018                 1.099758e-02 3 1  ON 67
ci_019                 1.071698e-02 3 1  ON 68
ci_020                 1.834259e-02 3 1  ON 69
ci_021                 1.804890e-02 3 1  ON 70
ci_022                 1.041690e-02 3 1  ON 71
ci_023                 1.004771e-02 3 1  ON 72
ci_024                 6.612821e-03 3 1  ON 73
ci_025                 6.588144e-03 3 1  ON 74
ci_026                 1.164234e-02 3 1  ON 75
ci_027                 1.153500e-02 3 1  ON 76
ci_028                -8.794844e-03 3 1  ON 77
ci_029                -9.824612e-03 3 1  ON 78
ci_030                -5.407855e-03 3 1  ON 79
ci_031                -4.541545e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2451e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7192e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1532
    reference variance = 0.264479
====================================================
  Execution time = 1.9293e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5423e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9834e-01
  Total weights = 1.973776832e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290903546236
                                         uncertainty =       0.001834711049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290903546236
                                         uncertainty =       0.001834711049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381373085
  error estimate for blocks of size 2^( 2) =       0.000396474181
  error estimate for blocks of size 2^( 3) =       0.000410629661
  error estimate for blocks of size 2^( 4) =       0.000421564910
  error estimate for blocks of size 2^( 5) =       0.000427880082
  error estimate for blocks of size 2^( 6) =       0.000429144618
  error estimate for blocks of size 2^( 7) =       0.000432337501

      target function =      -0.915354958239
              le_mean =     -17.206399592801
             les_mean =     296.358521996422
             stat err =       0.000427731778
             autocorr =       1.257890837850
   target nu stat err =       0.000427731778
   target dn stat err =       0.002196315053
      target stat err =       0.003479868447
              std dev =       0.539342989076
             le_variance =       0.290890859865


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720639959280e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915367201049       residual = 6.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915367237549       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915367245995       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915367247719       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915367249071       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915367249309       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915367249763       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915367250477       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915367251114       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915367251076       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915367251030       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915367251119       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915367251092       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915367251342       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915367251518       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915367251555       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915367251642       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915367251597       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915367251655       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915367251682       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915367251660       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915367251682       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915367251791       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915367251876       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915367251871       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915367251889       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915367251831       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915367251826       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915367251918       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915367251933       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915367251926       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915367251955       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915367251949       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915367251943       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915367251944       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915367251928       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.1035e+02 is 7.918857e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915367201049       residual = 6.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915367210175       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915367212287       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915367212720       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915367213057       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915367213115       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915367213230       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915367213407       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915367213570       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915367213557       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915367213545       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915367213565       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915367213563       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915367213623       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915367213666       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915367213679       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915367213698       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915367213685       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915367213700       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915367213718       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915367213706       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915367213709       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915367213737       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915367213750       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915367213756       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915367213767       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915367213755       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915367213744       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915367213765       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915367213774       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915367213763       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915367213769       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915367213772       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915367213770       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915367213770       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915367213769       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.4414e+03 is 1.979736e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915367201049       residual = 6.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915367203331       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915367203859       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915367203967       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915367204052       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915367204074       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915367204108       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915367204134       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915367204187       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915367204187       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915367204171       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915367204217       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915367204189       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915367204194       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915367204207       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915367204212       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915367204199       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915367204218       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915367204215       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915367204201       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915367204222       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915367204221       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915367204209       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915367204192       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915367204206       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915367204237       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915367204212       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915367204264       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915367204211       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915367204250       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915367204205       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915367204224       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915367204211       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915367204265       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915367204226       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915367204253       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.7656e+03 is 4.949353e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.072461 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4961e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
  uu_0                 2.101205e-01 1 1  ON 0
  uu_1                 5.276721e-02 1 1  ON 1
  uu_2                -3.832819e-02 1 1  ON 2
  uu_3                -9.174259e-02 1 1  ON 3
  uu_4                -1.223632e-01 1 1  ON 4
  uu_5                -1.300890e-01 1 1  ON 5
  uu_6                -1.126249e-01 1 1  ON 6
  uu_7                -5.641551e-02 1 1  ON 7
  uu_8                 6.015020e-02 1 1  ON 8
  uu_9                 1.247099e-01 1 1  ON 9
  ud_0                 3.051702e-01 1 1  ON 10
  ud_1                 7.603628e-02 1 1  ON 11
  ud_2                -2.623975e-02 1 1  ON 12
  ud_3                -7.918036e-02 1 1  ON 13
  ud_4                -1.149269e-01 1 1  ON 14
  ud_5                -1.334608e-01 1 1  ON 15
  ud_6                -1.266682e-01 1 1  ON 16
  ud_7                -8.516384e-02 1 1  ON 17
  ud_8                -5.952703e-03 1 1  ON 18
  ud_9                 8.614347e-02 1 1  ON 19
  eO_0                -7.035102e-01 1 1  ON 20
  eO_1                -4.201035e-01 1 1  ON 21
  eO_2                -4.159544e-02 1 1  ON 22
  eO_3                 1.846073e-01 1 1  ON 23
  eO_4                 2.570892e-01 1 1  ON 24
  eO_5                 2.803662e-01 1 1  ON 25
  eO_6                 2.510084e-01 1 1  ON 26
  eO_7                 1.323411e-01 1 1  ON 27
  eO_8                 2.922353e-02 1 1  ON 28
  eO_9                 1.913543e-02 1 1  ON 29
 eH1_0                -2.017819e-01 1 1  ON 30
 eH1_1                -9.600562e-02 1 1  ON 31
 eH1_2                -4.467739e-02 1 1  ON 32
 eH1_3                -1.417282e-02 1 1  ON 33
 eH1_4                 1.850445e-02 1 1  ON 34
 eH1_5                 2.191798e-02 1 1  ON 35
 eH1_6                 7.086227e-02 1 1  ON 36
 eH1_7                 1.028819e-01 1 1  ON 37
 eH1_8                 1.005756e-01 1 1  ON 38
 eH1_9                 2.591343e-02 1 1  ON 39
 eH2_0                -2.032768e-01 1 1  ON 40
 eH2_1                -9.793899e-02 1 1  ON 41
 eH2_2                -4.656270e-02 1 1  ON 42
 eH2_3                -1.571312e-02 1 1  ON 43
 eH2_4                 1.627316e-02 1 1  ON 44
 eH2_5                 1.979001e-02 1 1  ON 45
 eH2_6                 7.241027e-02 1 1  ON 46
 eH2_7                 1.104344e-01 1 1  ON 47
 eH2_8                 1.030736e-01 1 1  ON 48
 eH2_9                 2.885135e-02 1 1  ON 49
ci_001                -4.206471e-02 3 1  ON 50
ci_002                -3.076280e-02 3 1  ON 51
ci_003                -1.127136e-02 3 1  ON 52
ci_004                 2.571429e-02 3 1  ON 53
ci_005                 2.585270e-02 3 1  ON 54
ci_006                -2.025695e-02 3 1  ON 55
ci_007                -1.956799e-02 3 1  ON 56
ci_008                -4.029352e-03 3 1  ON 57
ci_009                -1.505090e-02 3 1  ON 58
ci_010                -9.385436e-03 3 1  ON 59
ci_011                -9.741190e-03 3 1  ON 60
ci_012                -9.680691e-03 3 1  ON 61
ci_013                -2.163346e-02 3 1  ON 62
ci_014                 1.324185e-02 3 1  ON 63
ci_015                 1.289345e-02 3 1  ON 64
ci_016                 1.634617e-02 3 1  ON 65
ci_017                 1.621083e-02 3 1  ON 66
ci_018                 1.099757e-02 3 1  ON 67
ci_019                 1.071698e-02 3 1  ON 68
ci_020                 1.834258e-02 3 1  ON 69
ci_021                 1.804887e-02 3 1  ON 70
ci_022                 1.041691e-02 3 1  ON 71
ci_023                 1.004773e-02 3 1  ON 72
ci_024                 6.612834e-03 3 1  ON 73
ci_025                 6.588140e-03 3 1  ON 74
ci_026                 1.164235e-02 3 1  ON 75
ci_027                 1.153500e-02 3 1  ON 76
ci_028                -8.794856e-03 3 1  ON 77
ci_029                -9.824619e-03 3 1  ON 78
ci_030                -5.407782e-03 3 1  ON 79
ci_031                -4.541510e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.0611
    reference variance = 0.731448
====================================================
  Execution time = 1.8903e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9312e-01
  Total weights = 1.9737e+06
  Execution time = 1.5699e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286643064465
                                         uncertainty =       0.001666764816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286643064465
                                         uncertainty =       0.001666764816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378566277
  error estimate for blocks of size 2^( 2) =       0.000394089494
  error estimate for blocks of size 2^( 3) =       0.000408307780
  error estimate for blocks of size 2^( 4) =       0.000418756152
  error estimate for blocks of size 2^( 5) =       0.000424634613
  error estimate for blocks of size 2^( 6) =       0.000428980592
  error estimate for blocks of size 2^( 7) =       0.000431993351

      target function =      -0.923503404719
              le_mean =     -17.206039966741
             les_mean =     296.340936320348
             stat err =       0.000426091177
             autocorr =       1.266838446475
   target nu stat err =       0.000426091177
   target dn stat err =       0.002027830714
      target stat err =       0.003278346058
              std dev =       0.535373562986
             le_variance =       0.286624851944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286643012933
                                         uncertainty =       0.001666761840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286643012933
                                         uncertainty =       0.001666761840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378566243
  error estimate for blocks of size 2^( 2) =       0.000394089472
  error estimate for blocks of size 2^( 3) =       0.000408307766
  error estimate for blocks of size 2^( 4) =       0.000418756145
  error estimate for blocks of size 2^( 5) =       0.000424634608
  error estimate for blocks of size 2^( 6) =       0.000428980590
  error estimate for blocks of size 2^( 7) =       0.000431993339

      target function =      -0.923503834948
              le_mean =     -17.206039969288
             les_mean =     296.340936135174
             stat err =       0.000426091170
             autocorr =       1.266838634119
   target nu stat err =       0.000426091170
   target dn stat err =       0.002027812909
      target stat err =       0.003278321682
              std dev =       0.535373515149
             le_variance =       0.286624800723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286643038695
                                         uncertainty =       0.001666763328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286643038695
                                         uncertainty =       0.001666763328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378566260
  error estimate for blocks of size 2^( 2) =       0.000394089483
  error estimate for blocks of size 2^( 3) =       0.000408307773
  error estimate for blocks of size 2^( 4) =       0.000418756149
  error estimate for blocks of size 2^( 5) =       0.000424634610
  error estimate for blocks of size 2^( 6) =       0.000428980591
  error estimate for blocks of size 2^( 7) =       0.000431993345

      target function =      -0.923503620336
              le_mean =     -17.206039968014
             les_mean =     296.340936227440
             stat err =       0.000426091174
             autocorr =       1.266838540308
   target nu stat err =       0.000426091174
   target dn stat err =       0.002027821808
      target stat err =       0.003278333869
              std dev =       0.535373539064
             le_variance =       0.286624826330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286643061243
                                         uncertainty =       0.001666764630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286643061243
                                         uncertainty =       0.001666764630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378566275
  error estimate for blocks of size 2^( 2) =       0.000394089493
  error estimate for blocks of size 2^( 3) =       0.000408307779
  error estimate for blocks of size 2^( 4) =       0.000418756152
  error estimate for blocks of size 2^( 5) =       0.000424634612
  error estimate for blocks of size 2^( 6) =       0.000428980592
  error estimate for blocks of size 2^( 7) =       0.000431993350

      target function =      -0.923503431725
              le_mean =     -17.206039966900
             les_mean =     296.340936308699
             stat err =       0.000426091177
             autocorr =       1.266838458203
   target nu stat err =       0.000426091177
   target dn stat err =       0.002027829600
      target stat err =       0.003278344534
              std dev =       0.535373559995
             le_variance =       0.286624848742


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923503404719        initial
     6.1035e+02     6.1035e+03             7.9189e-07        -0.923503834948  <--
     2.4414e+03     2.4414e+04             1.9797e-07        -0.923503620336
     9.7656e+03     9.7656e+04             4.9494e-08        -0.923503431725

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 3.0807e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
  uu_0                 2.101206e-01 1 1  ON 0
  uu_1                 5.276731e-02 1 1  ON 1
  uu_2                -3.832809e-02 1 1  ON 2
  uu_3                -9.174250e-02 1 1  ON 3
  uu_4                -1.223632e-01 1 1  ON 4
  uu_5                -1.300890e-01 1 1  ON 5
  uu_6                -1.126250e-01 1 1  ON 6
  uu_7                -5.641546e-02 1 1  ON 7
  uu_8                 6.014961e-02 1 1  ON 8
  uu_9                 1.247099e-01 1 1  ON 9
  ud_0                 3.051701e-01 1 1  ON 10
  ud_1                 7.603613e-02 1 1  ON 11
  ud_2                -2.623982e-02 1 1  ON 12
  ud_3                -7.918036e-02 1 1  ON 13
  ud_4                -1.149269e-01 1 1  ON 14
  ud_5                -1.334607e-01 1 1  ON 15
  ud_6                -1.266681e-01 1 1  ON 16
  ud_7                -8.516370e-02 1 1  ON 17
  ud_8                -5.952835e-03 1 1  ON 18
  ud_9                 8.614340e-02 1 1  ON 19
  eO_0                -7.035101e-01 1 1  ON 20
  eO_1                -4.201036e-01 1 1  ON 21
  eO_2                -4.159555e-02 1 1  ON 22
  eO_3                 1.846071e-01 1 1  ON 23
  eO_4                 2.570889e-01 1 1  ON 24
  eO_5                 2.803662e-01 1 1  ON 25
  eO_6                 2.510088e-01 1 1  ON 26
  eO_7                 1.323414e-01 1 1  ON 27
  eO_8                 2.922353e-02 1 1  ON 28
  eO_9                 1.913544e-02 1 1  ON 29
 eH1_0                -2.017819e-01 1 1  ON 30
 eH1_1                -9.600575e-02 1 1  ON 31
 eH1_2                -4.467747e-02 1 1  ON 32
 eH1_3                -1.417283e-02 1 1  ON 33
 eH1_4                 1.850438e-02 1 1  ON 34
 eH1_5                 2.191790e-02 1 1  ON 35
 eH1_6                 7.086221e-02 1 1  ON 36
 eH1_7                 1.028822e-01 1 1  ON 37
 eH1_8                 1.005757e-01 1 1  ON 38
 eH1_9                 2.591343e-02 1 1  ON 39
 eH2_0                -2.032768e-01 1 1  ON 40
 eH2_1                -9.793909e-02 1 1  ON 41
 eH2_2                -4.656274e-02 1 1  ON 42
 eH2_3                -1.571320e-02 1 1  ON 43
 eH2_4                 1.627321e-02 1 1  ON 44
 eH2_5                 1.979035e-02 1 1  ON 45
 eH2_6                 7.241014e-02 1 1  ON 46
 eH2_7                 1.104343e-01 1 1  ON 47
 eH2_8                 1.030737e-01 1 1  ON 48
 eH2_9                 2.885138e-02 1 1  ON 49
ci_001                -4.206476e-02 3 1  ON 50
ci_002                -3.076279e-02 3 1  ON 51
ci_003                -1.127120e-02 3 1  ON 52
ci_004                 2.571436e-02 3 1  ON 53
ci_005                 2.585274e-02 3 1  ON 54
ci_006                -2.025695e-02 3 1  ON 55
ci_007                -1.956801e-02 3 1  ON 56
ci_008                -4.029410e-03 3 1  ON 57
ci_009                -1.505093e-02 3 1  ON 58
ci_010                -9.385407e-03 3 1  ON 59
ci_011                -9.741132e-03 3 1  ON 60
ci_012                -9.680673e-03 3 1  ON 61
ci_013                -2.163339e-02 3 1  ON 62
ci_014                 1.324181e-02 3 1  ON 63
ci_015                 1.289351e-02 3 1  ON 64
ci_016                 1.634616e-02 3 1  ON 65
ci_017                 1.621076e-02 3 1  ON 66
ci_018                 1.099755e-02 3 1  ON 67
ci_019                 1.071698e-02 3 1  ON 68
ci_020                 1.834256e-02 3 1  ON 69
ci_021                 1.804877e-02 3 1  ON 70
ci_022                 1.041692e-02 3 1  ON 71
ci_023                 1.004777e-02 3 1  ON 72
ci_024                 6.612874e-03 3 1  ON 73
ci_025                 6.588127e-03 3 1  ON 74
ci_026                 1.164239e-02 3 1  ON 75
ci_027                 1.153500e-02 3 1  ON 76
ci_028                -8.794892e-03 3 1  ON 77
ci_029                -9.824641e-03 3 1  ON 78
ci_030                -5.407564e-03 3 1  ON 79
ci_031                -4.541403e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5774e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7190e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2528
    reference variance = 0.258523
====================================================
  Execution time = 1.9120e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5422e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0512e-01
  Total weights = 1.973741178e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5747e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294113364259
                                         uncertainty =       0.002847790581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294113364259
                                         uncertainty =       0.002847790581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383489178
  error estimate for blocks of size 2^( 2) =       0.000398511433
  error estimate for blocks of size 2^( 3) =       0.000412249501
  error estimate for blocks of size 2^( 4) =       0.000422569077
  error estimate for blocks of size 2^( 5) =       0.000429181309
  error estimate for blocks of size 2^( 6) =       0.000432178327
  error estimate for blocks of size 2^( 7) =       0.000436055155

      target function =      -0.904935616440
              le_mean =     -17.205900570125
             les_mean =     296.348131633826
             stat err =       0.000429995967
             autocorr =       1.257252592301
   target nu stat err =       0.000429995967
   target dn stat err =       0.004776146343
      target stat err =       0.007263544166
              std dev =       0.542335595985
             le_variance =       0.294127898673


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720590057012e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904993388455       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904994063143       residual = 3.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904994161944       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904994217340       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904994227130       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904994226890       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904994229788       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904994229220       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904994229100       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904994230290       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.904994230729       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.904994231288       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.904994232063       residual = 9.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.904994232417       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.904994234005       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.904994234145       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.904994233830       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.904994233899       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.904994234591       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.904994234901       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.904994234844       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.904994234614       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.904994234771       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.904994234697       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.904994234838       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.904994235294       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.904994235524       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.904994235360       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.904994235327       residual = 9.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.904994235433       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.904994235468       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.904994235468       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.904994235328       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.904994235339       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5259e+02 is 1.930942e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904993388455       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904993557189       residual = 3.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904993581895       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904993595747       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904993598195       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904993598133       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904993598859       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904993598717       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904993598685       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904993598987       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.904993599076       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.904993599282       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.904993599304       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.904993599546       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.904993599904       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.904993599949       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.904993599870       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.904993599887       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.904993600060       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.904993600136       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.904993600123       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.904993600066       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.904993600104       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.904993600085       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.904993600121       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.904993600235       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.904993600294       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.904993600250       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.904993600241       residual = 9.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.904993600271       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.904993600278       residual = 5.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.904993600279       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.904993600243       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.904993600247       residual = 8.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.1035e+02 is 4.827479e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904993388455       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904993430643       residual = 3.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904993436820       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904993440283       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904993440895       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904993440879       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904993441061       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904993441032       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904993441015       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904993441096       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.904993441112       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.904993441166       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.904993441168       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.904993441235       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.904993441322       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.904993441331       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.904993441314       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.904993441317       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.904993441359       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.904993441389       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.904993441371       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.904993441364       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.904993441374       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.904993441361       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.904993441378       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.904993441402       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.904993441414       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.904993441403       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.904993441406       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.904993441417       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.904993441415       residual = 5.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.904993441413       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.904993441406       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.904993441407       residual = 8.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.4414e+03 is 1.206877e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.114735 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4743e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
  uu_0                 2.101206e-01 1 1  ON 0
  uu_1                 5.276732e-02 1 1  ON 1
  uu_2                -3.832803e-02 1 1  ON 2
  uu_3                -9.174241e-02 1 1  ON 3
  uu_4                -1.223632e-01 1 1  ON 4
  uu_5                -1.300889e-01 1 1  ON 5
  uu_6                -1.126249e-01 1 1  ON 6
  uu_7                -5.641549e-02 1 1  ON 7
  uu_8                 6.014918e-02 1 1  ON 8
  uu_9                 1.247099e-01 1 1  ON 9
  ud_0                 3.051702e-01 1 1  ON 10
  ud_1                 7.603619e-02 1 1  ON 11
  ud_2                -2.623986e-02 1 1  ON 12
  ud_3                -7.918042e-02 1 1  ON 13
  ud_4                -1.149269e-01 1 1  ON 14
  ud_5                -1.334607e-01 1 1  ON 15
  ud_6                -1.266682e-01 1 1  ON 16
  ud_7                -8.516364e-02 1 1  ON 17
  ud_8                -5.952918e-03 1 1  ON 18
  ud_9                 8.614336e-02 1 1  ON 19
  eO_0                -7.035102e-01 1 1  ON 20
  eO_1                -4.201038e-01 1 1  ON 21
  eO_2                -4.159581e-02 1 1  ON 22
  eO_3                 1.846073e-01 1 1  ON 23
  eO_4                 2.570889e-01 1 1  ON 24
  eO_5                 2.803658e-01 1 1  ON 25
  eO_6                 2.510089e-01 1 1  ON 26
  eO_7                 1.323418e-01 1 1  ON 27
  eO_8                 2.922355e-02 1 1  ON 28
  eO_9                 1.913546e-02 1 1  ON 29
 eH1_0                -2.017817e-01 1 1  ON 30
 eH1_1                -9.600574e-02 1 1  ON 31
 eH1_2                -4.467753e-02 1 1  ON 32
 eH1_3                -1.417288e-02 1 1  ON 33
 eH1_4                 1.850434e-02 1 1  ON 34
 eH1_5                 2.191768e-02 1 1  ON 35
 eH1_6                 7.086225e-02 1 1  ON 36
 eH1_7                 1.028822e-01 1 1  ON 37
 eH1_8                 1.005760e-01 1 1  ON 38
 eH1_9                 2.591345e-02 1 1  ON 39
 eH2_0                -2.032769e-01 1 1  ON 40
 eH2_1                -9.793925e-02 1 1  ON 41
 eH2_2                -4.656254e-02 1 1  ON 42
 eH2_3                -1.571296e-02 1 1  ON 43
 eH2_4                 1.627353e-02 1 1  ON 44
 eH2_5                 1.979007e-02 1 1  ON 45
 eH2_6                 7.240966e-02 1 1  ON 46
 eH2_7                 1.104342e-01 1 1  ON 47
 eH2_8                 1.030739e-01 1 1  ON 48
 eH2_9                 2.885145e-02 1 1  ON 49
ci_001                -4.206457e-02 3 1  ON 50
ci_002                -3.076256e-02 3 1  ON 51
ci_003                -1.127149e-02 3 1  ON 52
ci_004                 2.571438e-02 3 1  ON 53
ci_005                 2.585265e-02 3 1  ON 54
ci_006                -2.025687e-02 3 1  ON 55
ci_007                -1.956805e-02 3 1  ON 56
ci_008                -4.029527e-03 3 1  ON 57
ci_009                -1.505085e-02 3 1  ON 58
ci_010                -9.385362e-03 3 1  ON 59
ci_011                -9.740981e-03 3 1  ON 60
ci_012                -9.680364e-03 3 1  ON 61
ci_013                -2.163380e-02 3 1  ON 62
ci_014                 1.324187e-02 3 1  ON 63
ci_015                 1.289330e-02 3 1  ON 64
ci_016                 1.634624e-02 3 1  ON 65
ci_017                 1.621092e-02 3 1  ON 66
ci_018                 1.099737e-02 3 1  ON 67
ci_019                 1.071696e-02 3 1  ON 68
ci_020                 1.834248e-02 3 1  ON 69
ci_021                 1.804917e-02 3 1  ON 70
ci_022                 1.041671e-02 3 1  ON 71
ci_023                 1.004775e-02 3 1  ON 72
ci_024                 6.612703e-03 3 1  ON 73
ci_025                 6.588047e-03 3 1  ON 74
ci_026                 1.164250e-02 3 1  ON 75
ci_027                 1.153506e-02 3 1  ON 76
ci_028                -8.795207e-03 3 1  ON 77
ci_029                -9.824437e-03 3 1  ON 78
ci_030                -5.407339e-03 3 1  ON 79
ci_031                -4.541444e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2229
    reference variance = 0.223921
====================================================
  Execution time = 1.9162e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9824e-01
  Total weights = 1.9735e+06
  Execution time = 1.5548e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291114313569
                                         uncertainty =       0.001847246621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291114313569
                                         uncertainty =       0.001847246621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381509717
  error estimate for blocks of size 2^( 2) =       0.000396876339
  error estimate for blocks of size 2^( 3) =       0.000410964496
  error estimate for blocks of size 2^( 4) =       0.000420890785
  error estimate for blocks of size 2^( 5) =       0.000426419752
  error estimate for blocks of size 2^( 6) =       0.000431102812
  error estimate for blocks of size 2^( 7) =       0.000431769642

      target function =      -0.915499387641
              le_mean =     -17.206526684072
             les_mean =     296.362800691581
             stat err =       0.000427545748
             autocorr =       1.255896861046
   target nu stat err =       0.000427545748
   target dn stat err =       0.002235817947
      target stat err =       0.003541633395
              std dev =       0.539536216144
             le_variance =       0.291099328531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291114072262
                                         uncertainty =       0.001847235660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291114072262
                                         uncertainty =       0.001847235660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381509560
  error estimate for blocks of size 2^( 2) =       0.000396876235
  error estimate for blocks of size 2^( 3) =       0.000410964463
  error estimate for blocks of size 2^( 4) =       0.000420890784
  error estimate for blocks of size 2^( 5) =       0.000426419761
  error estimate for blocks of size 2^( 6) =       0.000431102889
  error estimate for blocks of size 2^( 7) =       0.000431769740

      target function =      -0.915500490369
              le_mean =     -17.206526681755
             les_mean =     296.362799901084
             stat err =       0.000427545793
             autocorr =       1.255898166003
   target nu stat err =       0.000427545793
   target dn stat err =       0.002235764658
      target stat err =       0.003541560863
              std dev =       0.539535993381
             le_variance =       0.291099088153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291114192810
                                         uncertainty =       0.001847241138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291114192810
                                         uncertainty =       0.001847241138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381509638
  error estimate for blocks of size 2^( 2) =       0.000396876287
  error estimate for blocks of size 2^( 3) =       0.000410964479
  error estimate for blocks of size 2^( 4) =       0.000420890784
  error estimate for blocks of size 2^( 5) =       0.000426419756
  error estimate for blocks of size 2^( 6) =       0.000431102850
  error estimate for blocks of size 2^( 7) =       0.000431769691

      target function =      -0.915499940469
              le_mean =     -17.206526682903
             les_mean =     296.362800295023
             stat err =       0.000427545771
             autocorr =       1.255897513792
   target nu stat err =       0.000427545771
   target dn stat err =       0.002235791282
      target stat err =       0.003541597109
              std dev =       0.539536104665
             le_variance =       0.291099208237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291114298465
                                         uncertainty =       0.001847245936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291114298465
                                         uncertainty =       0.001847245936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381509707
  error estimate for blocks of size 2^( 2) =       0.000396876332
  error estimate for blocks of size 2^( 3) =       0.000410964494
  error estimate for blocks of size 2^( 4) =       0.000420890785
  error estimate for blocks of size 2^( 5) =       0.000426419752
  error estimate for blocks of size 2^( 6) =       0.000431102816
  error estimate for blocks of size 2^( 7) =       0.000431769648

      target function =      -0.915499456894
              le_mean =     -17.206526683925
             les_mean =     296.362800641876
             stat err =       0.000427545751
             autocorr =       1.255896942660
   target nu stat err =       0.000427545751
   target dn stat err =       0.002235814612
      target stat err =       0.003541628858
              std dev =       0.539536202201
             le_variance =       0.291099313485


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915499387641        initial
     1.5259e+02     1.5259e+03             1.9309e-06        -0.915500490369  <--
     6.1035e+02     6.1035e+03             4.8275e-07        -0.915499940469
     2.4414e+03     2.4414e+04             1.2069e-07        -0.915499456894

*****************************************************************************
Applying the update for shift_i =   1.5259e+02     and shift_s =   1.5259e+03
*****************************************************************************

  Execution time = 2.7001e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
  uu_0                 2.101207e-01 1 1  ON 0
  uu_1                 5.276735e-02 1 1  ON 1
  uu_2                -3.832787e-02 1 1  ON 2
  uu_3                -9.174215e-02 1 1  ON 3
  uu_4                -1.223632e-01 1 1  ON 4
  uu_5                -1.300887e-01 1 1  ON 5
  uu_6                -1.126246e-01 1 1  ON 6
  uu_7                -5.641557e-02 1 1  ON 7
  uu_8                 6.014789e-02 1 1  ON 8
  uu_9                 1.247098e-01 1 1  ON 9
  ud_0                 3.051703e-01 1 1  ON 10
  ud_1                 7.603637e-02 1 1  ON 11
  ud_2                -2.623996e-02 1 1  ON 12
  ud_3                -7.918061e-02 1 1  ON 13
  ud_4                -1.149268e-01 1 1  ON 14
  ud_5                -1.334606e-01 1 1  ON 15
  ud_6                -1.266685e-01 1 1  ON 16
  ud_7                -8.516347e-02 1 1  ON 17
  ud_8                -5.953168e-03 1 1  ON 18
  ud_9                 8.614321e-02 1 1  ON 19
  eO_0                -7.035104e-01 1 1  ON 20
  eO_1                -4.201044e-01 1 1  ON 21
  eO_2                -4.159658e-02 1 1  ON 22
  eO_3                 1.846079e-01 1 1  ON 23
  eO_4                 2.570891e-01 1 1  ON 24
  eO_5                 2.803649e-01 1 1  ON 25
  eO_6                 2.510095e-01 1 1  ON 26
  eO_7                 1.323430e-01 1 1  ON 27
  eO_8                 2.922362e-02 1 1  ON 28
  eO_9                 1.913553e-02 1 1  ON 29
 eH1_0                -2.017813e-01 1 1  ON 30
 eH1_1                -9.600574e-02 1 1  ON 31
 eH1_2                -4.467772e-02 1 1  ON 32
 eH1_3                -1.417302e-02 1 1  ON 33
 eH1_4                 1.850419e-02 1 1  ON 34
 eH1_5                 2.191702e-02 1 1  ON 35
 eH1_6                 7.086237e-02 1 1  ON 36
 eH1_7                 1.028820e-01 1 1  ON 37
 eH1_8                 1.005766e-01 1 1  ON 38
 eH1_9                 2.591351e-02 1 1  ON 39
 eH2_0                -2.032771e-01 1 1  ON 40
 eH2_1                -9.793972e-02 1 1  ON 41
 eH2_2                -4.656194e-02 1 1  ON 42
 eH2_3                -1.571221e-02 1 1  ON 43
 eH2_4                 1.627448e-02 1 1  ON 44
 eH2_5                 1.978925e-02 1 1  ON 45
 eH2_6                 7.240821e-02 1 1  ON 46
 eH2_7                 1.104340e-01 1 1  ON 47
 eH2_8                 1.030746e-01 1 1  ON 48
 eH2_9                 2.885167e-02 1 1  ON 49
ci_001                -4.206401e-02 3 1  ON 50
ci_002                -3.076186e-02 3 1  ON 51
ci_003                -1.127236e-02 3 1  ON 52
ci_004                 2.571445e-02 3 1  ON 53
ci_005                 2.585239e-02 3 1  ON 54
ci_006                -2.025662e-02 3 1  ON 55
ci_007                -1.956816e-02 3 1  ON 56
ci_008                -4.029877e-03 3 1  ON 57
ci_009                -1.505062e-02 3 1  ON 58
ci_010                -9.385226e-03 3 1  ON 59
ci_011                -9.740528e-03 3 1  ON 60
ci_012                -9.679436e-03 3 1  ON 61
ci_013                -2.163503e-02 3 1  ON 62
ci_014                 1.324203e-02 3 1  ON 63
ci_015                 1.289268e-02 3 1  ON 64
ci_016                 1.634649e-02 3 1  ON 65
ci_017                 1.621138e-02 3 1  ON 66
ci_018                 1.099683e-02 3 1  ON 67
ci_019                 1.071689e-02 3 1  ON 68
ci_020                 1.834224e-02 3 1  ON 69
ci_021                 1.805036e-02 3 1  ON 70
ci_022                 1.041608e-02 3 1  ON 71
ci_023                 1.004769e-02 3 1  ON 72
ci_024                 6.612190e-03 3 1  ON 73
ci_025                 6.587809e-03 3 1  ON 74
ci_026                 1.164283e-02 3 1  ON 75
ci_027                 1.153522e-02 3 1  ON 76
ci_028                -8.796150e-03 3 1  ON 77
ci_029                -9.823827e-03 3 1  ON 78
ci_030                -5.406664e-03 3 1  ON 79
ci_031                -4.541567e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1750e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7191e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.196
    reference variance = 0.552341
====================================================
  Execution time = 1.9108e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5436e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0059e-01
  Total weights = 1.973627192e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5559e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290862973778
                                         uncertainty =       0.003040479594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290862973778
                                         uncertainty =       0.003040479594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381358348
  error estimate for blocks of size 2^( 2) =       0.000396644010
  error estimate for blocks of size 2^( 3) =       0.000409691908
  error estimate for blocks of size 2^( 4) =       0.000419920171
  error estimate for blocks of size 2^( 5) =       0.000425591099
  error estimate for blocks of size 2^( 6) =       0.000429357056
  error estimate for blocks of size 2^( 7) =       0.000431140671

      target function =      -0.911817250872
              le_mean =     -17.206445357558
             les_mean =     296.362353469402
             stat err =       0.000426502249
             autocorr =       1.250766198930
   target nu stat err =       0.000426502249
   target dn stat err =       0.005042518249
      target stat err =       0.007788631117
              std dev =       0.539322147757
             le_variance =       0.290868379061


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720644535756e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911882305020       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911884608451       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911884950587       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911885059642       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911885073845       residual = 9.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911885093101       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911885096856       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911885102695       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911885107122       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911885108978       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911885107369       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911885112976       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911885118754       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911885125223       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911885128772       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911885136236       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911885136450       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911885135543       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911885137236       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911885138730       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911885138029       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911885137848       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911885136803       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911885137467       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911885137118       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911885137297       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911885138022       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911885137996       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911885137173       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911885137024       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911885137675       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911885138012       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911885138018       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.8147e+01 is 1.246667e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911882305020       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911882881730       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911882967361       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911882994651       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911882998206       residual = 9.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911883003026       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911883003964       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911883005434       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911883006534       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911883006999       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911883006597       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911883008000       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911883009446       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911883011064       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911883011950       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911883013816       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911883013869       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911883013642       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911883014066       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911883014439       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911883014262       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911883014217       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911883013956       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911883014122       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911883014034       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911883014079       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911883014260       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911883014253       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911883014047       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911883014011       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911883014173       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911883014257       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911883014259       residual = 8.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5259e+02 is 3.120918e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911882305020       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911882449251       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911882470665       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911882477489       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911882478378       residual = 9.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911882479583       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911882479818       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911882480186       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911882480461       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911882480577       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911882480476       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911882480826       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911882481188       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911882481593       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911882481815       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911882482282       residual = 7.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911882482293       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911882482238       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911882482346       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911882482438       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911882482394       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911882482381       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911882482316       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911882482359       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911882482334       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911882482346       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911882482392       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911882482390       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911882482338       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911882482330       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911882482371       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911882482390       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911882482392       residual = 8.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 6.1035e+02 is 7.804955e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.153467 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4708e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
  uu_0                 2.101213e-01 1 1  ON 0
  uu_1                 5.276761e-02 1 1  ON 1
  uu_2                -3.832774e-02 1 1  ON 2
  uu_3                -9.174230e-02 1 1  ON 3
  uu_4                -1.223635e-01 1 1  ON 4
  uu_5                -1.300887e-01 1 1  ON 5
  uu_6                -1.126246e-01 1 1  ON 6
  uu_7                -5.641511e-02 1 1  ON 7
  uu_8                 6.014636e-02 1 1  ON 8
  uu_9                 1.247097e-01 1 1  ON 9
  ud_0                 3.051698e-01 1 1  ON 10
  ud_1                 7.603567e-02 1 1  ON 11
  ud_2                -2.624016e-02 1 1  ON 12
  ud_3                -7.918067e-02 1 1  ON 13
  ud_4                -1.149265e-01 1 1  ON 14
  ud_5                -1.334602e-01 1 1  ON 15
  ud_6                -1.266689e-01 1 1  ON 16
  ud_7                -8.516298e-02 1 1  ON 17
  ud_8                -5.953356e-03 1 1  ON 18
  ud_9                 8.614332e-02 1 1  ON 19
  eO_0                -7.035107e-01 1 1  ON 20
  eO_1                -4.201045e-01 1 1  ON 21
  eO_2                -4.159652e-02 1 1  ON 22
  eO_3                 1.846069e-01 1 1  ON 23
  eO_4                 2.570884e-01 1 1  ON 24
  eO_5                 2.803645e-01 1 1  ON 25
  eO_6                 2.510102e-01 1 1  ON 26
  eO_7                 1.323444e-01 1 1  ON 27
  eO_8                 2.922381e-02 1 1  ON 28
  eO_9                 1.913560e-02 1 1  ON 29
 eH1_0                -2.017815e-01 1 1  ON 30
 eH1_1                -9.600720e-02 1 1  ON 31
 eH1_2                -4.467864e-02 1 1  ON 32
 eH1_3                -1.417336e-02 1 1  ON 33
 eH1_4                 1.850367e-02 1 1  ON 34
 eH1_5                 2.191725e-02 1 1  ON 35
 eH1_6                 7.086479e-02 1 1  ON 36
 eH1_7                 1.028817e-01 1 1  ON 37
 eH1_8                 1.005774e-01 1 1  ON 38
 eH1_9                 2.591391e-02 1 1  ON 39
 eH2_0                -2.032784e-01 1 1  ON 40
 eH2_1                -9.793986e-02 1 1  ON 41
 eH2_2                -4.656179e-02 1 1  ON 42
 eH2_3                -1.571314e-02 1 1  ON 43
 eH2_4                 1.627382e-02 1 1  ON 44
 eH2_5                 1.978910e-02 1 1  ON 45
 eH2_6                 7.241092e-02 1 1  ON 46
 eH2_7                 1.104337e-01 1 1  ON 47
 eH2_8                 1.030750e-01 1 1  ON 48
 eH2_9                 2.885181e-02 1 1  ON 49
ci_001                -4.206336e-02 3 1  ON 50
ci_002                -3.076197e-02 3 1  ON 51
ci_003                -1.127360e-02 3 1  ON 52
ci_004                 2.571408e-02 3 1  ON 53
ci_005                 2.585239e-02 3 1  ON 54
ci_006                -2.025681e-02 3 1  ON 55
ci_007                -1.956865e-02 3 1  ON 56
ci_008                -4.029832e-03 3 1  ON 57
ci_009                -1.505085e-02 3 1  ON 58
ci_010                -9.388347e-03 3 1  ON 59
ci_011                -9.740426e-03 3 1  ON 60
ci_012                -9.680106e-03 3 1  ON 61
ci_013                -2.163516e-02 3 1  ON 62
ci_014                 1.324222e-02 3 1  ON 63
ci_015                 1.289271e-02 3 1  ON 64
ci_016                 1.634561e-02 3 1  ON 65
ci_017                 1.621108e-02 3 1  ON 66
ci_018                 1.099662e-02 3 1  ON 67
ci_019                 1.071726e-02 3 1  ON 68
ci_020                 1.834193e-02 3 1  ON 69
ci_021                 1.805078e-02 3 1  ON 70
ci_022                 1.041581e-02 3 1  ON 71
ci_023                 1.004751e-02 3 1  ON 72
ci_024                 6.613339e-03 3 1  ON 73
ci_025                 6.587829e-03 3 1  ON 74
ci_026                 1.164343e-02 3 1  ON 75
ci_027                 1.153605e-02 3 1  ON 76
ci_028                -8.796176e-03 3 1  ON 77
ci_029                -9.822480e-03 3 1  ON 78
ci_030                -5.406117e-03 3 1  ON 79
ci_031                -4.540859e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1936
    reference variance = 0.514981
====================================================
  Execution time = 1.8939e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9869e-01
  Total weights = 1.9738e+06
  Execution time = 1.5808e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290919495654
                                         uncertainty =       0.001852732767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290919495654
                                         uncertainty =       0.001852732767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381344652
  error estimate for blocks of size 2^( 2) =       0.000396368773
  error estimate for blocks of size 2^( 3) =       0.000410660514
  error estimate for blocks of size 2^( 4) =       0.000421431937
  error estimate for blocks of size 2^( 5) =       0.000428758878
  error estimate for blocks of size 2^( 6) =       0.000432035298
  error estimate for blocks of size 2^( 7) =       0.000433375990

      target function =      -0.914808581043
              le_mean =     -17.206304088998
             les_mean =     296.355587177908
             stat err =       0.000428900526
             autocorr =       1.264963041760
   target nu stat err =       0.000428900526
   target dn stat err =       0.002476144548
      target stat err =       0.003900188614
              std dev =       0.539302778620
             le_variance =       0.290847487027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290919648800
                                         uncertainty =       0.001852762284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290919648800
                                         uncertainty =       0.001852762284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381344755
  error estimate for blocks of size 2^( 2) =       0.000396368712
  error estimate for blocks of size 2^( 3) =       0.000410660313
  error estimate for blocks of size 2^( 4) =       0.000421431604
  error estimate for blocks of size 2^( 5) =       0.000428758497
  error estimate for blocks of size 2^( 6) =       0.000432034738
  error estimate for blocks of size 2^( 7) =       0.000433375220

      target function =      -0.914814905730
              le_mean =     -17.206304073845
             les_mean =     296.355582574900
             stat err =       0.000428900015
             autocorr =       1.264959345578
   target nu stat err =       0.000428900015
   target dn stat err =       0.002475535650
      target stat err =       0.003899315413
              std dev =       0.539302924226
             le_variance =       0.290847644078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290919570692
                                         uncertainty =       0.001852747464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290919570692
                                         uncertainty =       0.001852747464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381344702
  error estimate for blocks of size 2^( 2) =       0.000396368742
  error estimate for blocks of size 2^( 3) =       0.000410660412
  error estimate for blocks of size 2^( 4) =       0.000421431769
  error estimate for blocks of size 2^( 5) =       0.000428758686
  error estimate for blocks of size 2^( 6) =       0.000432035017
  error estimate for blocks of size 2^( 7) =       0.000433375603

      target function =      -0.914811820382
              le_mean =     -17.206304081231
             les_mean =     296.355584820109
             stat err =       0.000428900269
             autocorr =       1.264961192135
   target nu stat err =       0.000428900269
   target dn stat err =       0.002475836294
      target stat err =       0.003899746873
              std dev =       0.539302850003
             le_variance =       0.290847564022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290919504866
                                         uncertainty =       0.001852734599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290919504866
                                         uncertainty =       0.001852734599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381344658
  error estimate for blocks of size 2^( 2) =       0.000396368769
  error estimate for blocks of size 2^( 3) =       0.000410660501
  error estimate for blocks of size 2^( 4) =       0.000421431916
  error estimate for blocks of size 2^( 5) =       0.000428758854
  error estimate for blocks of size 2^( 6) =       0.000432035262
  error estimate for blocks of size 2^( 7) =       0.000433375942

      target function =      -0.914808992587
              le_mean =     -17.206304088008
             les_mean =     296.355586878247
             stat err =       0.000428900493
             autocorr =       1.264962810581
   target nu stat err =       0.000428900493
   target dn stat err =       0.002476105639
      target stat err =       0.003900132878
              std dev =       0.539302787387
             le_variance =       0.290847496483


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914808581043        initial
     3.8147e+01     3.8147e+02             1.2467e-05        -0.914814905730  <--
     1.5259e+02     1.5259e+03             3.1209e-06        -0.914811820382
     6.1035e+02     6.1035e+03             7.8050e-07        -0.914808992587

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 2.6812e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
  uu_0                 2.101234e-01 1 1  ON 0
  uu_1                 5.276838e-02 1 1  ON 1
  uu_2                -3.832733e-02 1 1  ON 2
  uu_3                -9.174276e-02 1 1  ON 3
  uu_4                -1.223643e-01 1 1  ON 4
  uu_5                -1.300888e-01 1 1  ON 5
  uu_6                -1.126247e-01 1 1  ON 6
  uu_7                -5.641372e-02 1 1  ON 7
  uu_8                 6.014176e-02 1 1  ON 8
  uu_9                 1.247092e-01 1 1  ON 9
  ud_0                 3.051683e-01 1 1  ON 10
  ud_1                 7.603358e-02 1 1  ON 11
  ud_2                -2.624077e-02 1 1  ON 12
  ud_3                -7.918084e-02 1 1  ON 13
  ud_4                -1.149256e-01 1 1  ON 14
  ud_5                -1.334589e-01 1 1  ON 15
  ud_6                -1.266702e-01 1 1  ON 16
  ud_7                -8.516151e-02 1 1  ON 17
  ud_8                -5.953917e-03 1 1  ON 18
  ud_9                 8.614365e-02 1 1  ON 19
  eO_0                -7.035116e-01 1 1  ON 20
  eO_1                -4.201047e-01 1 1  ON 21
  eO_2                -4.159632e-02 1 1  ON 22
  eO_3                 1.846038e-01 1 1  ON 23
  eO_4                 2.570864e-01 1 1  ON 24
  eO_5                 2.803632e-01 1 1  ON 25
  eO_6                 2.510124e-01 1 1  ON 26
  eO_7                 1.323486e-01 1 1  ON 27
  eO_8                 2.922439e-02 1 1  ON 28
  eO_9                 1.913579e-02 1 1  ON 29
 eH1_0                -2.017824e-01 1 1  ON 30
 eH1_1                -9.601156e-02 1 1  ON 31
 eH1_2                -4.468142e-02 1 1  ON 32
 eH1_3                -1.417437e-02 1 1  ON 33
 eH1_4                 1.850212e-02 1 1  ON 34
 eH1_5                 2.191792e-02 1 1  ON 35
 eH1_6                 7.087206e-02 1 1  ON 36
 eH1_7                 1.028809e-01 1 1  ON 37
 eH1_8                 1.005795e-01 1 1  ON 38
 eH1_9                 2.591511e-02 1 1  ON 39
 eH2_0                -2.032825e-01 1 1  ON 40
 eH2_1                -9.794027e-02 1 1  ON 41
 eH2_2                -4.656134e-02 1 1  ON 42
 eH2_3                -1.571590e-02 1 1  ON 43
 eH2_4                 1.627186e-02 1 1  ON 44
 eH2_5                 1.978862e-02 1 1  ON 45
 eH2_6                 7.241906e-02 1 1  ON 46
 eH2_7                 1.104329e-01 1 1  ON 47
 eH2_8                 1.030764e-01 1 1  ON 48
 eH2_9                 2.885226e-02 1 1  ON 49
ci_001                -4.206141e-02 3 1  ON 50
ci_002                -3.076230e-02 3 1  ON 51
ci_003                -1.127732e-02 3 1  ON 52
ci_004                 2.571299e-02 3 1  ON 53
ci_005                 2.585242e-02 3 1  ON 54
ci_006                -2.025737e-02 3 1  ON 55
ci_007                -1.957009e-02 3 1  ON 56
ci_008                -4.029695e-03 3 1  ON 57
ci_009                -1.505155e-02 3 1  ON 58
ci_010                -9.397693e-03 3 1  ON 59
ci_011                -9.740122e-03 3 1  ON 60
ci_012                -9.682112e-03 3 1  ON 61
ci_013                -2.163553e-02 3 1  ON 62
ci_014                 1.324280e-02 3 1  ON 63
ci_015                 1.289280e-02 3 1  ON 64
ci_016                 1.634298e-02 3 1  ON 65
ci_017                 1.621019e-02 3 1  ON 66
ci_018                 1.099602e-02 3 1  ON 67
ci_019                 1.071837e-02 3 1  ON 68
ci_020                 1.834099e-02 3 1  ON 69
ci_021                 1.805202e-02 3 1  ON 70
ci_022                 1.041500e-02 3 1  ON 71
ci_023                 1.004696e-02 3 1  ON 72
ci_024                 6.616780e-03 3 1  ON 73
ci_025                 6.587891e-03 3 1  ON 74
ci_026                 1.164522e-02 3 1  ON 75
ci_027                 1.153855e-02 3 1  ON 76
ci_028                -8.796252e-03 3 1  ON 77
ci_029                -9.818448e-03 3 1  ON 78
ci_030                -5.404480e-03 3 1  ON 79
ci_031                -4.538737e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1526e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7191e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2108
    reference variance = 0.264268
====================================================
  Execution time = 1.8956e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5421e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9590e-01
  Total weights = 1.973837462e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5146e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289463056152
                                         uncertainty =       0.001900484948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289463056152
                                         uncertainty =       0.001900484948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380436914
  error estimate for blocks of size 2^( 2) =       0.000395454128
  error estimate for blocks of size 2^( 3) =       0.000409570052
  error estimate for blocks of size 2^( 4) =       0.000419557826
  error estimate for blocks of size 2^( 5) =       0.000424293261
  error estimate for blocks of size 2^( 6) =       0.000427062500
  error estimate for blocks of size 2^( 7) =       0.000427381022

      target function =      -0.919153145361
              le_mean =     -17.206127676461
             les_mean =     296.346726548894
             stat err =       0.000424573652
             autocorr =       1.245491532292
   target nu stat err =       0.000424573652
   target dn stat err =       0.002072052143
      target stat err =       0.003315621938
              std dev =       0.538019043562
             le_variance =       0.289464491235


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720612767646e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919164024256       residual = 8.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919167512135       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919168191172       residual = 5.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919168396334       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919168447994       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919168483718       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919168498945       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919168504415       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919168526210       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919168504564       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919168524632       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919168549573       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919168555915       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919168566203       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919168573646       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919168578647       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919168587243       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919168583422       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919168582560       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919168593863       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919168595289       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919168605102       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919168606134       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919168603009       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919168607094       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919168604272       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919168601174       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919168603794       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919168605294       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919168604680       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919168603890       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919168603592       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919168605990       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919168606249       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919168606953       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919168606955       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.5367e+00 is 2.915482e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919164024256       residual = 8.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919164901627       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919165072223       residual = 5.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919165123759       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919165136709       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919165145661       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919165149470       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919165150810       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919165156288       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919165150863       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919165155904       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919165162162       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919165163739       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919165166312       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919165168168       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919165169424       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919165171580       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919165170594       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919165170406       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919165173228       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919165173578       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919165176029       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919165176279       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919165175508       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919165176522       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919165175800       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919165175027       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919165175693       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919165176061       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919165175907       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919165175708       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919165175639       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919165176232       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919165176296       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919165176472       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919165176470       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.8147e+01 is 7.290464e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919164024256       residual = 8.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919164243939       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919164286640       residual = 5.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919164299540       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919164302780       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919164305019       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919164305971       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919164306304       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919164307676       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919164306319       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919164307581       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919164309146       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919164309540       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919164310183       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919164310647       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919164310961       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919164311501       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919164311253       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919164311207       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919164311913       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919164312000       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919164312612       residual = 8.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919164312674       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919164312482       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919164312735       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919164312553       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919164312360       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919164312527       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919164312619       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919164312581       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919164312531       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919164312513       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919164312661       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919164312677       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919164312722       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919164312721       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.5259e+02 is 1.822725e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.215704 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4541e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
  uu_0                 2.101247e-01 1 1  ON 0
  uu_1                 5.277126e-02 1 1  ON 1
  uu_2                -3.832465e-02 1 1  ON 2
  uu_3                -9.174128e-02 1 1  ON 3
  uu_4                -1.223628e-01 1 1  ON 4
  uu_5                -1.300890e-01 1 1  ON 5
  uu_6                -1.126267e-01 1 1  ON 6
  uu_7                -5.641868e-02 1 1  ON 7
  uu_8                 6.013447e-02 1 1  ON 8
  uu_9                 1.247099e-01 1 1  ON 9
  ud_0                 3.051673e-01 1 1  ON 10
  ud_1                 7.603187e-02 1 1  ON 11
  ud_2                -2.624019e-02 1 1  ON 12
  ud_3                -7.917947e-02 1 1  ON 13
  ud_4                -1.149252e-01 1 1  ON 14
  ud_5                -1.334594e-01 1 1  ON 15
  ud_6                -1.266715e-01 1 1  ON 16
  ud_7                -8.516001e-02 1 1  ON 17
  ud_8                -5.956533e-03 1 1  ON 18
  ud_9                 8.614239e-02 1 1  ON 19
  eO_0                -7.035148e-01 1 1  ON 20
  eO_1                -4.201085e-01 1 1  ON 21
  eO_2                -4.159874e-02 1 1  ON 22
  eO_3                 1.846078e-01 1 1  ON 23
  eO_4                 2.570862e-01 1 1  ON 24
  eO_5                 2.803626e-01 1 1  ON 25
  eO_6                 2.510118e-01 1 1  ON 26
  eO_7                 1.323546e-01 1 1  ON 27
  eO_8                 2.922525e-02 1 1  ON 28
  eO_9                 1.913583e-02 1 1  ON 29
 eH1_0                -2.017790e-01 1 1  ON 30
 eH1_1                -9.600966e-02 1 1  ON 31
 eH1_2                -4.467968e-02 1 1  ON 32
 eH1_3                -1.417306e-02 1 1  ON 33
 eH1_4                 1.849734e-02 1 1  ON 34
 eH1_5                 2.191099e-02 1 1  ON 35
 eH1_6                 7.086878e-02 1 1  ON 36
 eH1_7                 1.028824e-01 1 1  ON 37
 eH1_8                 1.005836e-01 1 1  ON 38
 eH1_9                 2.591610e-02 1 1  ON 39
 eH2_0                -2.032809e-01 1 1  ON 40
 eH2_1                -9.793955e-02 1 1  ON 41
 eH2_2                -4.656088e-02 1 1  ON 42
 eH2_3                -1.571790e-02 1 1  ON 43
 eH2_4                 1.627014e-02 1 1  ON 44
 eH2_5                 1.978940e-02 1 1  ON 45
 eH2_6                 7.241834e-02 1 1  ON 46
 eH2_7                 1.104304e-01 1 1  ON 47
 eH2_8                 1.030791e-01 1 1  ON 48
 eH2_9                 2.885287e-02 1 1  ON 49
ci_001                -4.206158e-02 3 1  ON 50
ci_002                -3.076247e-02 3 1  ON 51
ci_003                -1.128017e-02 3 1  ON 52
ci_004                 2.571265e-02 3 1  ON 53
ci_005                 2.585048e-02 3 1  ON 54
ci_006                -2.025809e-02 3 1  ON 55
ci_007                -1.957261e-02 3 1  ON 56
ci_008                -4.031677e-03 3 1  ON 57
ci_009                -1.505018e-02 3 1  ON 58
ci_010                -9.397615e-03 3 1  ON 59
ci_011                -9.742386e-03 3 1  ON 60
ci_012                -9.686074e-03 3 1  ON 61
ci_013                -2.163554e-02 3 1  ON 62
ci_014                 1.324391e-02 3 1  ON 63
ci_015                 1.289260e-02 3 1  ON 64
ci_016                 1.634126e-02 3 1  ON 65
ci_017                 1.620854e-02 3 1  ON 66
ci_018                 1.099560e-02 3 1  ON 67
ci_019                 1.071848e-02 3 1  ON 68
ci_020                 1.834154e-02 3 1  ON 69
ci_021                 1.805260e-02 3 1  ON 70
ci_022                 1.041554e-02 3 1  ON 71
ci_023                 1.004867e-02 3 1  ON 72
ci_024                 6.615698e-03 3 1  ON 73
ci_025                 6.591306e-03 3 1  ON 74
ci_026                 1.164530e-02 3 1  ON 75
ci_027                 1.154237e-02 3 1  ON 76
ci_028                -8.793226e-03 3 1  ON 77
ci_029                -9.816994e-03 3 1  ON 78
ci_030                -5.402489e-03 3 1  ON 79
ci_031                -4.538006e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1013
    reference variance = 0.274164
====================================================
  Execution time = 1.9339e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9800e-01
  Total weights = 1.9737e+06
  Execution time = 1.5579e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289967189383
                                         uncertainty =       0.001559160831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289967189383
                                         uncertainty =       0.001559160831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380933577
  error estimate for blocks of size 2^( 2) =       0.000396122221
  error estimate for blocks of size 2^( 3) =       0.000409804226
  error estimate for blocks of size 2^( 4) =       0.000420541274
  error estimate for blocks of size 2^( 5) =       0.000426373985
  error estimate for blocks of size 2^( 6) =       0.000430074502
  error estimate for blocks of size 2^( 7) =       0.000432177365

      target function =      -0.915871702927
              le_mean =     -17.206514850642
             les_mean =     296.362154183085
             stat err =       0.000427291782
             autocorr =       1.258202575438
   target nu stat err =       0.000427291782
   target dn stat err =       0.002153269401
      target stat err =       0.003418987038
              std dev =       0.538721431135
             le_variance =       0.290220780365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289965518105
                                         uncertainty =       0.001559385716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289965518105
                                         uncertainty =       0.001559385716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380932530
  error estimate for blocks of size 2^( 2) =       0.000396121204
  error estimate for blocks of size 2^( 3) =       0.000409802695
  error estimate for blocks of size 2^( 4) =       0.000420539455
  error estimate for blocks of size 2^( 5) =       0.000426371921
  error estimate for blocks of size 2^( 6) =       0.000430071876
  error estimate for blocks of size 2^( 7) =       0.000432174518

      target function =      -0.915875085593
              le_mean =     -17.206514798709
             les_mean =     296.362150219142
             stat err =       0.000427289443
             autocorr =       1.258195719411
   target nu stat err =       0.000427289443
   target dn stat err =       0.002152918972
      target stat err =       0.003418479076
              std dev =       0.538719949769
             le_variance =       0.290219184279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289966340199
                                         uncertainty =       0.001559273786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289966340199
                                         uncertainty =       0.001559273786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380933045
  error estimate for blocks of size 2^( 2) =       0.000396121703
  error estimate for blocks of size 2^( 3) =       0.000409803450
  error estimate for blocks of size 2^( 4) =       0.000420540354
  error estimate for blocks of size 2^( 5) =       0.000426372942
  error estimate for blocks of size 2^( 6) =       0.000430073177
  error estimate for blocks of size 2^( 7) =       0.000432175928

      target function =      -0.915873739232
              le_mean =     -17.206514823612
             les_mean =     296.362151942319
             stat err =       0.000427290600
             autocorr =       1.258199134044
   target nu stat err =       0.000427290600
   target dn stat err =       0.002153080456
      target stat err =       0.003418714740
              std dev =       0.538720678034
             le_variance =       0.290219968941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289967082132
                                         uncertainty =       0.001559174947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289967082132
                                         uncertainty =       0.001559174947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380933510
  error estimate for blocks of size 2^( 2) =       0.000396122155
  error estimate for blocks of size 2^( 3) =       0.000409804128
  error estimate for blocks of size 2^( 4) =       0.000420541158
  error estimate for blocks of size 2^( 5) =       0.000426373853
  error estimate for blocks of size 2^( 6) =       0.000430074336
  error estimate for blocks of size 2^( 7) =       0.000432177185

      target function =      -0.915871995751
              le_mean =     -17.206514847154
             les_mean =     296.362153874568
             stat err =       0.000427291633
             autocorr =       1.258202144954
   target nu stat err =       0.000427291633
   target dn stat err =       0.002153244365
      target stat err =       0.003418951129
              std dev =       0.538721335979
             le_variance =       0.290220677839


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915871702927        initial
     9.5367e+00     9.5367e+01             2.9155e-05        -0.915875085593  <--
     3.8147e+01     3.8147e+02             7.2905e-06        -0.915873739232
     1.5259e+02     1.5259e+03             1.8227e-06        -0.915871995751

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 2.7178e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
  uu_0                 2.101287e-01 1 1  ON 0
  uu_1                 5.277985e-02 1 1  ON 1
  uu_2                -3.831664e-02 1 1  ON 2
  uu_3                -9.173684e-02 1 1  ON 3
  uu_4                -1.223582e-01 1 1  ON 4
  uu_5                -1.300897e-01 1 1  ON 5
  uu_6                -1.126324e-01 1 1  ON 6
  uu_7                -5.643354e-02 1 1  ON 7
  uu_8                 6.011260e-02 1 1  ON 8
  uu_9                 1.247121e-01 1 1  ON 9
  ud_0                 3.051645e-01 1 1  ON 10
  ud_1                 7.602678e-02 1 1  ON 11
  ud_2                -2.623845e-02 1 1  ON 12
  ud_3                -7.917541e-02 1 1  ON 13
  ud_4                -1.149242e-01 1 1  ON 14
  ud_5                -1.334611e-01 1 1  ON 15
  ud_6                -1.266753e-01 1 1  ON 16
  ud_7                -8.515556e-02 1 1  ON 17
  ud_8                -5.964375e-03 1 1  ON 18
  ud_9                 8.613860e-02 1 1  ON 19
  eO_0                -7.035246e-01 1 1  ON 20
  eO_1                -4.201200e-01 1 1  ON 21
  eO_2                -4.160598e-02 1 1  ON 22
  eO_3                 1.846195e-01 1 1  ON 23
  eO_4                 2.570858e-01 1 1  ON 24
  eO_5                 2.803607e-01 1 1  ON 25
  eO_6                 2.510100e-01 1 1  ON 26
  eO_7                 1.323723e-01 1 1  ON 27
  eO_8                 2.922783e-02 1 1  ON 28
  eO_9                 1.913594e-02 1 1  ON 29
 eH1_0                -2.017691e-01 1 1  ON 30
 eH1_1                -9.600397e-02 1 1  ON 31
 eH1_2                -4.467447e-02 1 1  ON 32
 eH1_3                -1.416916e-02 1 1  ON 33
 eH1_4                 1.848307e-02 1 1  ON 34
 eH1_5                 2.189027e-02 1 1  ON 35
 eH1_6                 7.085892e-02 1 1  ON 36
 eH1_7                 1.028872e-01 1 1  ON 37
 eH1_8                 1.005956e-01 1 1  ON 38
 eH1_9                 2.591908e-02 1 1  ON 39
 eH2_0                -2.032761e-01 1 1  ON 40
 eH2_1                -9.793738e-02 1 1  ON 41
 eH2_2                -4.655950e-02 1 1  ON 42
 eH2_3                -1.572386e-02 1 1  ON 43
 eH2_4                 1.626501e-02 1 1  ON 44
 eH2_5                 1.979174e-02 1 1  ON 45
 eH2_6                 7.241621e-02 1 1  ON 46
 eH2_7                 1.104229e-01 1 1  ON 47
 eH2_8                 1.030870e-01 1 1  ON 48
 eH2_9                 2.885472e-02 1 1  ON 49
ci_001                -4.206211e-02 3 1  ON 50
ci_002                -3.076299e-02 3 1  ON 51
ci_003                -1.128864e-02 3 1  ON 52
ci_004                 2.571163e-02 3 1  ON 53
ci_005                 2.584472e-02 3 1  ON 54
ci_006                -2.026024e-02 3 1  ON 55
ci_007                -1.958014e-02 3 1  ON 56
ci_008                -4.037570e-03 3 1  ON 57
ci_009                -1.504611e-02 3 1  ON 58
ci_010                -9.397382e-03 3 1  ON 59
ci_011                -9.749127e-03 3 1  ON 60
ci_012                -9.697869e-03 3 1  ON 61
ci_013                -2.163554e-02 3 1  ON 62
ci_014                 1.324719e-02 3 1  ON 63
ci_015                 1.289200e-02 3 1  ON 64
ci_016                 1.633615e-02 3 1  ON 65
ci_017                 1.620361e-02 3 1  ON 66
ci_018                 1.099433e-02 3 1  ON 67
ci_019                 1.071883e-02 3 1  ON 68
ci_020                 1.834318e-02 3 1  ON 69
ci_021                 1.805434e-02 3 1  ON 70
ci_022                 1.041715e-02 3 1  ON 71
ci_023                 1.005375e-02 3 1  ON 72
ci_024                 6.612475e-03 3 1  ON 73
ci_025                 6.601477e-03 3 1  ON 74
ci_026                 1.164556e-02 3 1  ON 75
ci_027                 1.155375e-02 3 1  ON 76
ci_028                -8.784213e-03 3 1  ON 77
ci_029                -9.812663e-03 3 1  ON 78
ci_030                -5.396565e-03 3 1  ON 79
ci_031                -4.535830e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1737e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7190e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2527
    reference variance = 0.272079
====================================================
  Execution time = 1.9080e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5427e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9836e-01
  Total weights = 1.973532088e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5357e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290748250952
                                         uncertainty =       0.001879318962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290748250952
                                         uncertainty =       0.001879318962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381247457
  error estimate for blocks of size 2^( 2) =       0.000396670841
  error estimate for blocks of size 2^( 3) =       0.000410548367
  error estimate for blocks of size 2^( 4) =       0.000420549751
  error estimate for blocks of size 2^( 5) =       0.000426965043
  error estimate for blocks of size 2^( 6) =       0.000427838593
  error estimate for blocks of size 2^( 7) =       0.000429464384

      target function =      -0.915313086428
              le_mean =     -17.206811386295
             les_mean =     296.372714238253
             stat err =       0.000426204443
             autocorr =       1.249746803610
   target nu stat err =       0.000426204443
   target dn stat err =       0.002335255956
      target stat err =       0.003692728776
              std dev =       0.539165323636
             le_variance =       0.290699246211


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720681138630e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915327102361       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915333605508       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915335792293       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915336242926       residual = 7.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915336343935       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915336471194       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915336567433       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915336592806       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915336672146       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915336766868       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915336741870       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915336856238       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915336847635       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915336868857       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915336949004       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915337034429       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915337093030       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915337074194       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915337045288       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915337050542       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915337043702       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915337086574       residual = 9.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915337089781       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915337081636       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915337078810       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915337082892       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915337084439       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915337080988       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915337092682       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915337090364       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915337086635       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915337094881       residual = 8.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915337096730       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915337094889       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915337097195       residual = 7.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3842e+00 is 1.798625e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915327102361       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915328766064       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915329324243       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915329438537       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915329464032       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915329496110       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915329520839       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915329527393       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915329547402       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915329571419       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915329564957       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915329593975       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915329591720       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915329597112       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915329617421       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915329639234       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915329653367       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915329648017       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915329640733       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915329642277       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915329640852       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915329651379       residual = 8.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915329651920       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915329649786       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915329649188       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915329650223       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915329650608       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915329649826       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915329652619       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915329651992       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915329651162       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915329653158       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915329653592       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915329653164       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915329653724       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.5367e+00 is 4.505035e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915327102361       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915327520726       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915327661007       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915327689685       residual = 7.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915327696073       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915327704110       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915327710335       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915327711987       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915327717000       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915327723025       residual = 7.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915327721396       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915327728678       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915327728107       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915327729461       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915327734556       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915327740038       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915327743536       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915327742158       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915327740335       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915327740736       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915327740398       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915327743016       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915327743135       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915327742596       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915327742453       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915327742713       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915327742809       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915327742619       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915327743309       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915327743149       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915327742948       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915327743443       residual = 7.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915327743549       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915327743444       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915327743583       residual = 6.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.8147e+01 is 1.126786e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.273761 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4683e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
  uu_0                 2.101436e-01 1 1  ON 0
  uu_1                 5.279899e-02 1 1  ON 1
  uu_2                -3.829898e-02 1 1  ON 2
  uu_3                -9.172454e-02 1 1  ON 3
  uu_4                -1.223507e-01 1 1  ON 4
  uu_5                -1.300874e-01 1 1  ON 5
  uu_6                -1.126452e-01 1 1  ON 6
  uu_7                -5.646421e-02 1 1  ON 7
  uu_8                 6.006755e-02 1 1  ON 8
  uu_9                 1.247128e-01 1 1  ON 9
  ud_0                 3.051555e-01 1 1  ON 10
  ud_1                 7.601495e-02 1 1  ON 11
  ud_2                -2.624677e-02 1 1  ON 12
  ud_3                -7.917980e-02 1 1  ON 13
  ud_4                -1.149230e-01 1 1  ON 14
  ud_5                -1.334536e-01 1 1  ON 15
  ud_6                -1.266617e-01 1 1  ON 16
  ud_7                -8.513828e-02 1 1  ON 17
  ud_8                -5.978695e-03 1 1  ON 18
  ud_9                 8.613320e-02 1 1  ON 19
  eO_0                -7.035253e-01 1 1  ON 20
  eO_1                -4.201158e-01 1 1  ON 21
  eO_2                -4.159821e-02 1 1  ON 22
  eO_3                 1.846287e-01 1 1  ON 23
  eO_4                 2.570704e-01 1 1  ON 24
  eO_5                 2.803397e-01 1 1  ON 25
  eO_6                 2.510061e-01 1 1  ON 26
  eO_7                 1.323904e-01 1 1  ON 27
  eO_8                 2.922868e-02 1 1  ON 28
  eO_9                 1.913632e-02 1 1  ON 29
 eH1_0                -2.017630e-01 1 1  ON 30
 eH1_1                -9.600657e-02 1 1  ON 31
 eH1_2                -4.467973e-02 1 1  ON 32
 eH1_3                -1.417563e-02 1 1  ON 33
 eH1_4                 1.847464e-02 1 1  ON 34
 eH1_5                 2.188686e-02 1 1  ON 35
 eH1_6                 7.087040e-02 1 1  ON 36
 eH1_7                 1.028797e-01 1 1  ON 37
 eH1_8                 1.006060e-01 1 1  ON 38
 eH1_9                 2.592511e-02 1 1  ON 39
 eH2_0                -2.032748e-01 1 1  ON 40
 eH2_1                -9.793211e-02 1 1  ON 41
 eH2_2                -4.655298e-02 1 1  ON 42
 eH2_3                -1.571175e-02 1 1  ON 43
 eH2_4                 1.627277e-02 1 1  ON 44
 eH2_5                 1.978650e-02 1 1  ON 45
 eH2_6                 7.239858e-02 1 1  ON 46
 eH2_7                 1.104049e-01 1 1  ON 47
 eH2_8                 1.030928e-01 1 1  ON 48
 eH2_9                 2.885620e-02 1 1  ON 49
ci_001                -4.205938e-02 3 1  ON 50
ci_002                -3.076267e-02 3 1  ON 51
ci_003                -1.129374e-02 3 1  ON 52
ci_004                 2.571762e-02 3 1  ON 53
ci_005                 2.584163e-02 3 1  ON 54
ci_006                -2.025660e-02 3 1  ON 55
ci_007                -1.958406e-02 3 1  ON 56
ci_008                -4.037429e-03 3 1  ON 57
ci_009                -1.503882e-02 3 1  ON 58
ci_010                -9.404509e-03 3 1  ON 59
ci_011                -9.751792e-03 3 1  ON 60
ci_012                -9.705366e-03 3 1  ON 61
ci_013                -2.163777e-02 3 1  ON 62
ci_014                 1.325734e-02 3 1  ON 63
ci_015                 1.288950e-02 3 1  ON 64
ci_016                 1.632706e-02 3 1  ON 65
ci_017                 1.620418e-02 3 1  ON 66
ci_018                 1.098647e-02 3 1  ON 67
ci_019                 1.071685e-02 3 1  ON 68
ci_020                 1.833542e-02 3 1  ON 69
ci_021                 1.805483e-02 3 1  ON 70
ci_022                 1.041310e-02 3 1  ON 71
ci_023                 1.005667e-02 3 1  ON 72
ci_024                 6.615115e-03 3 1  ON 73
ci_025                 6.609918e-03 3 1  ON 74
ci_026                 1.164741e-02 3 1  ON 75
ci_027                 1.156014e-02 3 1  ON 76
ci_028                -8.790921e-03 3 1  ON 77
ci_029                -9.804120e-03 3 1  ON 78
ci_030                -5.392926e-03 3 1  ON 79
ci_031                -4.541947e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1489
    reference variance = 0.280155
====================================================
  Execution time = 1.8913e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9583e-01
  Total weights = 1.9735e+06
  Execution time = 1.6604e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289462799395
                                         uncertainty =       0.001831655928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289462799395
                                         uncertainty =       0.001831655928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380454030
  error estimate for blocks of size 2^( 2) =       0.000395616624
  error estimate for blocks of size 2^( 3) =       0.000409668929
  error estimate for blocks of size 2^( 4) =       0.000419693478
  error estimate for blocks of size 2^( 5) =       0.000425327795
  error estimate for blocks of size 2^( 6) =       0.000429262717
  error estimate for blocks of size 2^( 7) =       0.000433462050

      target function =      -0.919223991528
              le_mean =     -17.206267287159
             les_mean =     296.351483886968
             stat err =       0.000426936510
             autocorr =       1.259279730572
   target nu stat err =       0.000426936510
   target dn stat err =       0.002170630359
      target stat err =       0.003468317375
              std dev =       0.538043249717
             le_variance =       0.289490538566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289454540546
                                         uncertainty =       0.001832588296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289454540546
                                         uncertainty =       0.001832588296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380448579
  error estimate for blocks of size 2^( 2) =       0.000395609531
  error estimate for blocks of size 2^( 3) =       0.000409660140
  error estimate for blocks of size 2^( 4) =       0.000419683838
  error estimate for blocks of size 2^( 5) =       0.000425318398
  error estimate for blocks of size 2^( 6) =       0.000429254231
  error estimate for blocks of size 2^( 7) =       0.000433452914

      target function =      -0.919348174877
              le_mean =     -17.206267516656
             les_mean =     296.351412342473
             stat err =       0.000426927345
             autocorr =       1.259261753437
   target nu stat err =       0.000426927345
   target dn stat err =       0.002166636555
      target stat err =       0.003463128561
              std dev =       0.538035540074
             le_variance =       0.289482242383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289458507016
                                         uncertainty =       0.001832130513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289458507016
                                         uncertainty =       0.001832130513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380451197
  error estimate for blocks of size 2^( 2) =       0.000395612953
  error estimate for blocks of size 2^( 3) =       0.000409664393
  error estimate for blocks of size 2^( 4) =       0.000419688506
  error estimate for blocks of size 2^( 5) =       0.000425322955
  error estimate for blocks of size 2^( 6) =       0.000429258340
  error estimate for blocks of size 2^( 7) =       0.000433457347

      target function =      -0.919292296253
              le_mean =     -17.206267393462
             les_mean =     296.351443847694
             stat err =       0.000426931787
             autocorr =       1.259270623435
   target nu stat err =       0.000426931787
   target dn stat err =       0.002168333219
      target stat err =       0.003465310238
              std dev =       0.538039243217
             le_variance =       0.289486227242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289462251828
                                         uncertainty =       0.001831715389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289462251828
                                         uncertainty =       0.001831715389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380453669
  error estimate for blocks of size 2^( 2) =       0.000395616158
  error estimate for blocks of size 2^( 3) =       0.000409668354
  error estimate for blocks of size 2^( 4) =       0.000419692848
  error estimate for blocks of size 2^( 5) =       0.000425327182
  error estimate for blocks of size 2^( 6) =       0.000429262163
  error estimate for blocks of size 2^( 7) =       0.000433461455

      target function =      -0.919233212044
              le_mean =     -17.206267299178
             les_mean =     296.351478401558
             stat err =       0.000426935912
             autocorr =       1.259278594522
   target nu stat err =       0.000426935912
   target dn stat err =       0.002170305557
      target stat err =       0.003467889014
              std dev =       0.538042738661
             le_variance =       0.289489988625


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919223991528        initial
     2.3842e+00     2.3842e+01             1.7986e-04        -0.919348174877  <--
     9.5367e+00     9.5367e+01             4.5050e-05        -0.919292296253
     3.8147e+01     3.8147e+02             1.1268e-05        -0.919233212044

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 2.6994e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
  uu_0                 2.101878e-01 1 1  ON 0
  uu_1                 5.285558e-02 1 1  ON 1
  uu_2                -3.824672e-02 1 1  ON 2
  uu_3                -9.168793e-02 1 1  ON 3
  uu_4                -1.223284e-01 1 1  ON 4
  uu_5                -1.300804e-01 1 1  ON 5
  uu_6                -1.126826e-01 1 1  ON 6
  uu_7                -5.655530e-02 1 1  ON 7
  uu_8                 5.993274e-02 1 1  ON 8
  uu_9                 1.247146e-01 1 1  ON 9
  ud_0                 3.051290e-01 1 1  ON 10
  ud_1                 7.598020e-02 1 1  ON 11
  ud_2                -2.627128e-02 1 1  ON 12
  ud_3                -7.919282e-02 1 1  ON 13
  ud_4                -1.149196e-01 1 1  ON 14
  ud_5                -1.334314e-01 1 1  ON 15
  ud_6                -1.266214e-01 1 1  ON 16
  ud_7                -8.508704e-02 1 1  ON 17
  ud_8                -6.021248e-03 1 1  ON 18
  ud_9                 8.611699e-02 1 1  ON 19
  eO_0                -7.035271e-01 1 1  ON 20
  eO_1                -4.201035e-01 1 1  ON 21
  eO_2                -4.157530e-02 1 1  ON 22
  eO_3                 1.846558e-01 1 1  ON 23
  eO_4                 2.570249e-01 1 1  ON 24
  eO_5                 2.802770e-01 1 1  ON 25
  eO_6                 2.509944e-01 1 1  ON 26
  eO_7                 1.324444e-01 1 1  ON 27
  eO_8                 2.923120e-02 1 1  ON 28
  eO_9                 1.913747e-02 1 1  ON 29
 eH1_0                -2.017453e-01 1 1  ON 30
 eH1_1                -9.601445e-02 1 1  ON 31
 eH1_2                -4.469539e-02 1 1  ON 32
 eH1_3                -1.419482e-02 1 1  ON 33
 eH1_4                 1.844971e-02 1 1  ON 34
 eH1_5                 2.187687e-02 1 1  ON 35
 eH1_6                 7.090466e-02 1 1  ON 36
 eH1_7                 1.028572e-01 1 1  ON 37
 eH1_8                 1.006371e-01 1 1  ON 38
 eH1_9                 2.594314e-02 1 1  ON 39
 eH2_0                -2.032708e-01 1 1  ON 40
 eH2_1                -9.791633e-02 1 1  ON 41
 eH2_2                -4.653353e-02 1 1  ON 42
 eH2_3                -1.567604e-02 1 1  ON 43
 eH2_4                 1.629583e-02 1 1  ON 44
 eH2_5                 1.977122e-02 1 1  ON 45
 eH2_6                 7.234597e-02 1 1  ON 46
 eH2_7                 1.103511e-01 1 1  ON 47
 eH2_8                 1.031101e-01 1 1  ON 48
 eH2_9                 2.886063e-02 1 1  ON 49
ci_001                -4.205137e-02 3 1  ON 50
ci_002                -3.076173e-02 3 1  ON 51
ci_003                -1.130862e-02 3 1  ON 52
ci_004                 2.573516e-02 3 1  ON 53
ci_005                 2.583266e-02 3 1  ON 54
ci_006                -2.024595e-02 3 1  ON 55
ci_007                -1.959554e-02 3 1  ON 56
ci_008                -4.037025e-03 3 1  ON 57
ci_009                -1.501763e-02 3 1  ON 58
ci_010                -9.425261e-03 3 1  ON 59
ci_011                -9.759552e-03 3 1  ON 60
ci_012                -9.727200e-03 3 1  ON 61
ci_013                -2.164429e-02 3 1  ON 62
ci_014                 1.328691e-02 3 1  ON 63
ci_015                 1.288218e-02 3 1  ON 64
ci_016                 1.630049e-02 3 1  ON 65
ci_017                 1.620582e-02 3 1  ON 66
ci_018                 1.096363e-02 3 1  ON 67
ci_019                 1.071103e-02 3 1  ON 68
ci_020                 1.831274e-02 3 1  ON 69
ci_021                 1.805618e-02 3 1  ON 70
ci_022                 1.040128e-02 3 1  ON 71
ci_023                 1.006517e-02 3 1  ON 72
ci_024                 6.622816e-03 3 1  ON 73
ci_025                 6.634558e-03 3 1  ON 74
ci_026                 1.165287e-02 3 1  ON 75
ci_027                 1.157867e-02 3 1  ON 76
ci_028                -8.810506e-03 3 1  ON 77
ci_029                -9.779191e-03 3 1  ON 78
ci_030                -5.382359e-03 3 1  ON 79
ci_031                -4.559706e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1695e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7191e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2018
    reference variance = 0.463388
====================================================
  Execution time = 1.9167e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5409e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0141e-01
  Total weights = 1.973807094e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5226e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291248696131
                                         uncertainty =       0.002526011592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291248696131
                                         uncertainty =       0.002526011592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381591267
  error estimate for blocks of size 2^( 2) =       0.000396574819
  error estimate for blocks of size 2^( 3) =       0.000411092374
  error estimate for blocks of size 2^( 4) =       0.000421264574
  error estimate for blocks of size 2^( 5) =       0.000428033610
  error estimate for blocks of size 2^( 6) =       0.000431987285
  error estimate for blocks of size 2^( 7) =       0.000433637599

      target function =      -0.910600016251
              le_mean =     -17.206090145176
             les_mean =     296.350945039525
             stat err =       0.000428730767
             autocorr =       1.262328675392
   target nu stat err =       0.000428730767
   target dn stat err =       0.003905714985
      target stat err =       0.006030156027
              std dev =       0.539651545007
             le_variance =       0.291223790029


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720609014518e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910638977832       residual = 7.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910682886927       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910693476198       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910695276961       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910696204876       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910697053305       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910697581560       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910697950025       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910698156919       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910698106062       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910698456447       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910698609837       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910698642002       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910698744192       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910698722635       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910698853374       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910698889321       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910698851227       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910698742646       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910698898680       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910698816781       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910698901621       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910698978612       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910699007450       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910698997672       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910699026313       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910699049298       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910699063705       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910699019869       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910699074392       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910699089561       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910699100537       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910699111562       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910699096151       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.910699112248       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910699122672       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.9605e-01 is 4.434504e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910638977832       residual = 7.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910650996993       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910653820904       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910654293404       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910654535440       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910654765424       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910654905636       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910654997008       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910655049169       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910655036872       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910655132159       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910655169845       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910655177186       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910655202940       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910655198424       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910655232857       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910655239864       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910655226493       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910655201493       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910655241599       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910655222998       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910655245833       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910655260087       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910655268265       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910655264450       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910655271737       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910655278950       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910655276955       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910655269684       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910655283924       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910655285631       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910655288188       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910655290424       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910655287113       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.910655290979       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910655293040       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3842e+00 is 1.109486e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910638977832       residual = 7.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910642055650       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910642773476       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910642893070       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910642954204       residual = 5.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910643013083       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910643048708       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910643071306       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910643084379       residual = 9.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910643081357       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910643105726       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910643115049       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910643116839       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910643123288       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910643122233       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910643130942       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910643132543       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910643128941       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910643122859       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910643132974       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910643128444       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910643134233       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910643137468       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910643139574       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910643138513       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910643140383       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910643142236       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910643141283       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910643139949       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910643143481       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910643143690       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910643144347       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910643144865       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910643144069       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.910643145031       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.910643145508       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.5367e+00 is 2.774078e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.337065 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4761e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
  uu_0                 2.102173e-01 1 1  ON 0
  uu_1                 5.288174e-02 1 1  ON 1
  uu_2                -3.822679e-02 1 1  ON 2
  uu_3                -9.168646e-02 1 1  ON 3
  uu_4                -1.223322e-01 1 1  ON 4
  uu_5                -1.300821e-01 1 1  ON 5
  uu_6                -1.126548e-01 1 1  ON 6
  uu_7                -5.662938e-02 1 1  ON 7
  uu_8                 5.985706e-02 1 1  ON 8
  uu_9                 1.247220e-01 1 1  ON 9
  ud_0                 3.051096e-01 1 1  ON 10
  ud_1                 7.595967e-02 1 1  ON 11
  ud_2                -2.629774e-02 1 1  ON 12
  ud_3                -7.922048e-02 1 1  ON 13
  ud_4                -1.149284e-01 1 1  ON 14
  ud_5                -1.334026e-01 1 1  ON 15
  ud_6                -1.265582e-01 1 1  ON 16
  ud_7                -8.508487e-02 1 1  ON 17
  ud_8                -6.033483e-03 1 1  ON 18
  ud_9                 8.607838e-02 1 1  ON 19
  eO_0                -7.035717e-01 1 1  ON 20
  eO_1                -4.201315e-01 1 1  ON 21
  eO_2                -4.159446e-02 1 1  ON 22
  eO_3                 1.846304e-01 1 1  ON 23
  eO_4                 2.569533e-01 1 1  ON 24
  eO_5                 2.802589e-01 1 1  ON 25
  eO_6                 2.510765e-01 1 1  ON 26
  eO_7                 1.325554e-01 1 1  ON 27
  eO_8                 2.924091e-02 1 1  ON 28
  eO_9                 1.913688e-02 1 1  ON 29
 eH1_0                -2.017603e-01 1 1  ON 30
 eH1_1                -9.601734e-02 1 1  ON 31
 eH1_2                -4.470798e-02 1 1  ON 32
 eH1_3                -1.420255e-02 1 1  ON 33
 eH1_4                 1.844626e-02 1 1  ON 34
 eH1_5                 2.192945e-02 1 1  ON 35
 eH1_6                 7.086822e-02 1 1  ON 36
 eH1_7                 1.028208e-01 1 1  ON 37
 eH1_8                 1.006860e-01 1 1  ON 38
 eH1_9                 2.595714e-02 1 1  ON 39
 eH2_0                -2.032064e-01 1 1  ON 40
 eH2_1                -9.793259e-02 1 1  ON 41
 eH2_2                -4.658018e-02 1 1  ON 42
 eH2_3                -1.570241e-02 1 1  ON 43
 eH2_4                 1.629171e-02 1 1  ON 44
 eH2_5                 1.980970e-02 1 1  ON 45
 eH2_6                 7.231240e-02 1 1  ON 46
 eH2_7                 1.103065e-01 1 1  ON 47
 eH2_8                 1.031595e-01 1 1  ON 48
 eH2_9                 2.887778e-02 1 1  ON 49
ci_001                -4.202078e-02 3 1  ON 50
ci_002                -3.077674e-02 3 1  ON 51
ci_003                -1.127885e-02 3 1  ON 52
ci_004                 2.571498e-02 3 1  ON 53
ci_005                 2.581290e-02 3 1  ON 54
ci_006                -2.022434e-02 3 1  ON 55
ci_007                -1.961358e-02 3 1  ON 56
ci_008                -4.014597e-03 3 1  ON 57
ci_009                -1.500567e-02 3 1  ON 58
ci_010                -9.446387e-03 3 1  ON 59
ci_011                -9.695995e-03 3 1  ON 60
ci_012                -9.675476e-03 3 1  ON 61
ci_013                -2.161536e-02 3 1  ON 62
ci_014                 1.330935e-02 3 1  ON 63
ci_015                 1.288134e-02 3 1  ON 64
ci_016                 1.632443e-02 3 1  ON 65
ci_017                 1.617104e-02 3 1  ON 66
ci_018                 1.097583e-02 3 1  ON 67
ci_019                 1.067048e-02 3 1  ON 68
ci_020                 1.835037e-02 3 1  ON 69
ci_021                 1.806552e-02 3 1  ON 70
ci_022                 1.040608e-02 3 1  ON 71
ci_023                 1.008891e-02 3 1  ON 72
ci_024                 6.564811e-03 3 1  ON 73
ci_025                 6.590190e-03 3 1  ON 74
ci_026                 1.165446e-02 3 1  ON 75
ci_027                 1.154629e-02 3 1  ON 76
ci_028                -8.811448e-03 3 1  ON 77
ci_029                -9.754415e-03 3 1  ON 78
ci_030                -5.377079e-03 3 1  ON 79
ci_031                -4.533966e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2299
    reference variance = 0.231021
====================================================
  Execution time = 1.9493e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9765e-01
  Total weights = 1.9738e+06
  Execution time = 1.5501e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290191690298
                                         uncertainty =       0.001784893618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290191690298
                                         uncertainty =       0.001784893618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380901089
  error estimate for blocks of size 2^( 2) =       0.000396004116
  error estimate for blocks of size 2^( 3) =       0.000410105970
  error estimate for blocks of size 2^( 4) =       0.000420296701
  error estimate for blocks of size 2^( 5) =       0.000426728636
  error estimate for blocks of size 2^( 6) =       0.000429361275
  error estimate for blocks of size 2^( 7) =       0.000433708658

      target function =      -0.916435843090
              le_mean =     -17.206840508915
             les_mean =     296.372994832011
             stat err =       0.000427523818
             autocorr =       1.259784329115
   target nu stat err =       0.000427523818
   target dn stat err =       0.002087255773
      target stat err =       0.003325020200
              std dev =       0.538675485313
             le_variance =       0.290171278477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290216532154
                                         uncertainty =       0.001787305427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290216532154
                                         uncertainty =       0.001787305427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380917534
  error estimate for blocks of size 2^( 2) =       0.000396029942
  error estimate for blocks of size 2^( 3) =       0.000410141505
  error estimate for blocks of size 2^( 4) =       0.000420339679
  error estimate for blocks of size 2^( 5) =       0.000426771060
  error estimate for blocks of size 2^( 6) =       0.000429401288
  error estimate for blocks of size 2^( 7) =       0.000433749392

      target function =      -0.915971841455
              le_mean =     -17.206840820602
             les_mean =     296.373304071379
             stat err =       0.000427565355
             autocorr =       1.259920336769
   target nu stat err =       0.000427565355
   target dn stat err =       0.002101315452
      target stat err =       0.003343064784
              std dev =       0.538698743282
             le_variance =       0.290196336014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290203425979
                                         uncertainty =       0.001786124406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290203425979
                                         uncertainty =       0.001786124406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380908869
  error estimate for blocks of size 2^( 2) =       0.000396016979
  error estimate for blocks of size 2^( 3) =       0.000410124047
  error estimate for blocks of size 2^( 4) =       0.000420318824
  error estimate for blocks of size 2^( 5) =       0.000426750517
  error estimate for blocks of size 2^( 6) =       0.000429381631
  error estimate for blocks of size 2^( 7) =       0.000433729640

      target function =      -0.916196503076
              le_mean =     -17.206840587225
             les_mean =     296.373151478151
             stat err =       0.000427545153
             autocorr =       1.259858603995
   target nu stat err =       0.000427545153
   target dn stat err =       0.002093097910
      target stat err =       0.003332193216
              std dev =       0.538686487862
             le_variance =       0.290183132205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290192962236
                                         uncertainty =       0.001785041988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290192962236
                                         uncertainty =       0.001785041988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380901933
  error estimate for blocks of size 2^( 2) =       0.000396005611
  error estimate for blocks of size 2^( 3) =       0.000410108131
  error estimate for blocks of size 2^( 4) =       0.000420299381
  error estimate for blocks of size 2^( 5) =       0.000426731287
  error estimate for blocks of size 2^( 6) =       0.000429363735
  error estimate for blocks of size 2^( 7) =       0.000433711185

      target function =      -0.916434149015
              le_mean =     -17.206840487334
             les_mean =     296.372995179805
             stat err =       0.000427526397
             autocorr =       1.259793941993
   target nu stat err =       0.000427526397
   target dn stat err =       0.002087172575
      target stat err =       0.003324882788
              std dev =       0.538676680010
             le_variance =       0.290172565586


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916435843090        initial  <--
     5.9605e-01     5.9605e+00             4.4345e-04        -0.915971841455
     2.3842e+00     2.3842e+01             1.1095e-04        -0.916196503076
     9.5367e+00     9.5367e+01             2.7741e-05        -0.916434149015

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.3225
  </log>
  <optVariables href="H2O.s037.opt.xml">
  uu_0                 2.101878e-01 1 1  ON 0
  uu_1                 5.285558e-02 1 1  ON 1
  uu_2                -3.824672e-02 1 1  ON 2
  uu_3                -9.168793e-02 1 1  ON 3
  uu_4                -1.223284e-01 1 1  ON 4
  uu_5                -1.300804e-01 1 1  ON 5
  uu_6                -1.126826e-01 1 1  ON 6
  uu_7                -5.655530e-02 1 1  ON 7
  uu_8                 5.993274e-02 1 1  ON 8
  uu_9                 1.247146e-01 1 1  ON 9
  ud_0                 3.051290e-01 1 1  ON 10
  ud_1                 7.598020e-02 1 1  ON 11
  ud_2                -2.627128e-02 1 1  ON 12
  ud_3                -7.919282e-02 1 1  ON 13
  ud_4                -1.149196e-01 1 1  ON 14
  ud_5                -1.334314e-01 1 1  ON 15
  ud_6                -1.266214e-01 1 1  ON 16
  ud_7                -8.508704e-02 1 1  ON 17
  ud_8                -6.021248e-03 1 1  ON 18
  ud_9                 8.611699e-02 1 1  ON 19
  eO_0                -7.035271e-01 1 1  ON 20
  eO_1                -4.201035e-01 1 1  ON 21
  eO_2                -4.157530e-02 1 1  ON 22
  eO_3                 1.846558e-01 1 1  ON 23
  eO_4                 2.570249e-01 1 1  ON 24
  eO_5                 2.802770e-01 1 1  ON 25
  eO_6                 2.509944e-01 1 1  ON 26
  eO_7                 1.324444e-01 1 1  ON 27
  eO_8                 2.923120e-02 1 1  ON 28
  eO_9                 1.913747e-02 1 1  ON 29
 eH1_0                -2.017453e-01 1 1  ON 30
 eH1_1                -9.601445e-02 1 1  ON 31
 eH1_2                -4.469539e-02 1 1  ON 32
 eH1_3                -1.419482e-02 1 1  ON 33
 eH1_4                 1.844971e-02 1 1  ON 34
 eH1_5                 2.187687e-02 1 1  ON 35
 eH1_6                 7.090466e-02 1 1  ON 36
 eH1_7                 1.028572e-01 1 1  ON 37
 eH1_8                 1.006371e-01 1 1  ON 38
 eH1_9                 2.594314e-02 1 1  ON 39
 eH2_0                -2.032708e-01 1 1  ON 40
 eH2_1                -9.791633e-02 1 1  ON 41
 eH2_2                -4.653353e-02 1 1  ON 42
 eH2_3                -1.567604e-02 1 1  ON 43
 eH2_4                 1.629583e-02 1 1  ON 44
 eH2_5                 1.977122e-02 1 1  ON 45
 eH2_6                 7.234597e-02 1 1  ON 46
 eH2_7                 1.103511e-01 1 1  ON 47
 eH2_8                 1.031101e-01 1 1  ON 48
 eH2_9                 2.886063e-02 1 1  ON 49
ci_001                -4.205137e-02 3 1  ON 50
ci_002                -3.076173e-02 3 1  ON 51
ci_003                -1.130862e-02 3 1  ON 52
ci_004                 2.573516e-02 3 1  ON 53
ci_005                 2.583266e-02 3 1  ON 54
ci_006                -2.024595e-02 3 1  ON 55
ci_007                -1.959554e-02 3 1  ON 56
ci_008                -4.037025e-03 3 1  ON 57
ci_009                -1.501763e-02 3 1  ON 58
ci_010                -9.425261e-03 3 1  ON 59
ci_011                -9.759552e-03 3 1  ON 60
ci_012                -9.727200e-03 3 1  ON 61
ci_013                -2.164429e-02 3 1  ON 62
ci_014                 1.328691e-02 3 1  ON 63
ci_015                 1.288218e-02 3 1  ON 64
ci_016                 1.630049e-02 3 1  ON 65
ci_017                 1.620582e-02 3 1  ON 66
ci_018                 1.096363e-02 3 1  ON 67
ci_019                 1.071103e-02 3 1  ON 68
ci_020                 1.831274e-02 3 1  ON 69
ci_021                 1.805618e-02 3 1  ON 70
ci_022                 1.040128e-02 3 1  ON 71
ci_023                 1.006517e-02 3 1  ON 72
ci_024                 6.622816e-03 3 1  ON 73
ci_025                 6.634558e-03 3 1  ON 74
ci_026                 1.165287e-02 3 1  ON 75
ci_027                 1.157867e-02 3 1  ON 76
ci_028                -8.810506e-03 3 1  ON 77
ci_029                -9.779191e-03 3 1  ON 78
ci_030                -5.382359e-03 3 1  ON 79
ci_031                -4.559706e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2097e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7191e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2429
    reference variance = 0.313645
====================================================
  Execution time = 1.9285e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5418e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.1096e-01
  Total weights = 1.973771709e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6538e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295714986215
                                         uncertainty =       0.006098652407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295714986215
                                         uncertainty =       0.006098652407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384571833
  error estimate for blocks of size 2^( 2) =       0.000400137871
  error estimate for blocks of size 2^( 3) =       0.000414117412
  error estimate for blocks of size 2^( 4) =       0.000424019926
  error estimate for blocks of size 2^( 5) =       0.000430650339
  error estimate for blocks of size 2^( 6) =       0.000434398732
  error estimate for blocks of size 2^( 7) =       0.000435947184

      target function =      -0.895960426523
              le_mean =     -17.206297858334
             les_mean =     296.367647897298
             stat err =       0.000431254046
             autocorr =       1.257509918201
   target nu stat err =       0.000431254046
   target dn stat err =       0.010132495943
      target stat err =       0.015062405223
              std dev =       0.543866702342
             le_variance =       0.295790989917


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720629785833e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896213527203       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896220308490       residual = 3.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896223334044       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896224219728       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896224656770       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896224689724       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896224877859       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896224960202       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896225123721       residual = 6.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.896225233744       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.896225278743       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.896225267259       residual = 9.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.896225290317       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.896225320219       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.896225307006       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.896225318327       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.896225353791       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.896225362113       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.896225374909       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.896225382759       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.896225390521       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.896225402595       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.896225416124       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.896225414212       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.896225416276       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.896225409654       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.896225414512       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.896225409977       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.896225408371       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.896225411107       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.896225410197       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.896225406989       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.896225410482       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.896225412221       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.896225413364       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.896225413765       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.896225413584       residual = 9.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.9605e+00 is 5.933134e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896213527203       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896215238020       residual = 3.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896215999938       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896216223671       residual = 4.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896216333147       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896216341105       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896216388518       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896216409033       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896216450272       residual = 6.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.896216477884       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.896216489066       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.896216486205       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.896216492023       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.896216499418       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.896216496063       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.896216499009       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.896216507894       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.896216509867       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.896216513012       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.896216515002       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.896216516987       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.896216519984       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.896216523304       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.896216522795       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.896216523318       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.896216521670       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.896216522872       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.896216521742       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.896216521329       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.896216522021       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.896216521816       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.896216521013       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.896216521872       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.896216522284       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.896216522588       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.896216522686       residual = 9.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3842e+01 is 1.489970e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896213527203       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896213955887       residual = 3.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896214146715       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896214202795       residual = 4.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896214230177       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896214232149       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896214244026       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896214249150       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896214259483       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.896214266392       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.896214269183       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.896214268469       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.896214269927       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.896214271770       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.896214270928       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.896214271672       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.896214273894       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.896214274381       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.896214275164       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.896214275663       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.896214276162       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.896214276910       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.896214277736       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.896214277607       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.896214277738       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.896214277326       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.896214277626       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.896214277344       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.896214277240       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.896214277413       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.896214277363       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.896214277163       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.896214277376       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.896214277478       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.896214277555       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.896214277580       residual = 9.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.5367e+01 is 3.729645e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.388075 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4996e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
  uu_0                 2.101939e-01 1 1  ON 0
  uu_1                 5.285822e-02 1 1  ON 1
  uu_2                -3.824809e-02 1 1  ON 2
  uu_3                -9.168751e-02 1 1  ON 3
  uu_4                -1.223303e-01 1 1  ON 4
  uu_5                -1.300811e-01 1 1  ON 5
  uu_6                -1.126823e-01 1 1  ON 6
  uu_7                -5.655553e-02 1 1  ON 7
  uu_8                 5.991985e-02 1 1  ON 8
  uu_9                 1.247172e-01 1 1  ON 9
  ud_0                 3.051277e-01 1 1  ON 10
  ud_1                 7.598234e-02 1 1  ON 11
  ud_2                -2.626716e-02 1 1  ON 12
  ud_3                -7.919509e-02 1 1  ON 13
  ud_4                -1.149219e-01 1 1  ON 14
  ud_5                -1.334324e-01 1 1  ON 15
  ud_6                -1.266161e-01 1 1  ON 16
  ud_7                -8.508938e-02 1 1  ON 17
  ud_8                -6.024696e-03 1 1  ON 18
  ud_9                 8.611322e-02 1 1  ON 19
  eO_0                -7.035350e-01 1 1  ON 20
  eO_1                -4.201095e-01 1 1  ON 21
  eO_2                -4.156914e-02 1 1  ON 22
  eO_3                 1.846640e-01 1 1  ON 23
  eO_4                 2.570164e-01 1 1  ON 24
  eO_5                 2.802690e-01 1 1  ON 25
  eO_6                 2.509981e-01 1 1  ON 26
  eO_7                 1.324552e-01 1 1  ON 27
  eO_8                 2.923200e-02 1 1  ON 28
  eO_9                 1.913816e-02 1 1  ON 29
 eH1_0                -2.017534e-01 1 1  ON 30
 eH1_1                -9.602185e-02 1 1  ON 31
 eH1_2                -4.468747e-02 1 1  ON 32
 eH1_3                -1.418382e-02 1 1  ON 33
 eH1_4                 1.844664e-02 1 1  ON 34
 eH1_5                 2.187176e-02 1 1  ON 35
 eH1_6                 7.090527e-02 1 1  ON 36
 eH1_7                 1.028564e-01 1 1  ON 37
 eH1_8                 1.006414e-01 1 1  ON 38
 eH1_9                 2.594369e-02 1 1  ON 39
 eH2_0                -2.032650e-01 1 1  ON 40
 eH2_1                -9.790506e-02 1 1  ON 41
 eH2_2                -4.651863e-02 1 1  ON 42
 eH2_3                -1.567007e-02 1 1  ON 43
 eH2_4                 1.628530e-02 1 1  ON 44
 eH2_5                 1.976161e-02 1 1  ON 45
 eH2_6                 7.233166e-02 1 1  ON 46
 eH2_7                 1.103412e-01 1 1  ON 47
 eH2_8                 1.031142e-01 1 1  ON 48
 eH2_9                 2.886251e-02 1 1  ON 49
ci_001                -4.205318e-02 3 1  ON 50
ci_002                -3.076208e-02 3 1  ON 51
ci_003                -1.131273e-02 3 1  ON 52
ci_004                 2.573344e-02 3 1  ON 53
ci_005                 2.583405e-02 3 1  ON 54
ci_006                -2.024732e-02 3 1  ON 55
ci_007                -1.959928e-02 3 1  ON 56
ci_008                -4.040909e-03 3 1  ON 57
ci_009                -1.501730e-02 3 1  ON 58
ci_010                -9.425662e-03 3 1  ON 59
ci_011                -9.759572e-03 3 1  ON 60
ci_012                -9.725016e-03 3 1  ON 61
ci_013                -2.164436e-02 3 1  ON 62
ci_014                 1.328821e-02 3 1  ON 63
ci_015                 1.287635e-02 3 1  ON 64
ci_016                 1.629763e-02 3 1  ON 65
ci_017                 1.620711e-02 3 1  ON 66
ci_018                 1.096352e-02 3 1  ON 67
ci_019                 1.071138e-02 3 1  ON 68
ci_020                 1.831542e-02 3 1  ON 69
ci_021                 1.806113e-02 3 1  ON 70
ci_022                 1.040249e-02 3 1  ON 71
ci_023                 1.006436e-02 3 1  ON 72
ci_024                 6.620094e-03 3 1  ON 73
ci_025                 6.640241e-03 3 1  ON 74
ci_026                 1.165193e-02 3 1  ON 75
ci_027                 1.158079e-02 3 1  ON 76
ci_028                -8.811798e-03 3 1  ON 77
ci_029                -9.778023e-03 3 1  ON 78
ci_030                -5.377370e-03 3 1  ON 79
ci_031                -4.558057e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2635
    reference variance = 0.258003
====================================================
  Execution time = 2.1307e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7205e+01
  VMC Evar = 3.0010e-01
  Total weights = 1.9739e+06
  Execution time = 1.5558e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292166293855
                                         uncertainty =       0.001880170663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292166293855
                                         uncertainty =       0.001880170663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382166155
  error estimate for blocks of size 2^( 2) =       0.000397202955
  error estimate for blocks of size 2^( 3) =       0.000411760262
  error estimate for blocks of size 2^( 4) =       0.000421173582
  error estimate for blocks of size 2^( 5) =       0.000427182044
  error estimate for blocks of size 2^( 6) =       0.000430746986
  error estimate for blocks of size 2^( 7) =       0.000433017821

      target function =      -0.912663349915
              le_mean =     -17.205272390355
             les_mean =     296.321488983276
             stat err =       0.000428030108
             autocorr =       1.254423529386
   target nu stat err =       0.000428030108
   target dn stat err =       0.002331880371
      target stat err =       0.003656872904
              std dev =       0.540464560067
             le_variance =       0.292101940688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292175412460
                                         uncertainty =       0.001880455979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292175412460
                                         uncertainty =       0.001880455979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382172075
  error estimate for blocks of size 2^( 2) =       0.000397210059
  error estimate for blocks of size 2^( 3) =       0.000411768744
  error estimate for blocks of size 2^( 4) =       0.000421182803
  error estimate for blocks of size 2^( 5) =       0.000427191140
  error estimate for blocks of size 2^( 6) =       0.000430756799
  error estimate for blocks of size 2^( 7) =       0.000433027110

      target function =      -0.912603510818
              le_mean =     -17.205272195841
             les_mean =     296.321521182948
             stat err =       0.000428039463
             autocorr =       1.254439500834
   target nu stat err =       0.000428039463
   target dn stat err =       0.002336268966
      target stat err =       0.003663018730
              std dev =       0.540472931251
             le_variance =       0.292110989415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292170863428
                                         uncertainty =       0.001880314333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292170863428
                                         uncertainty =       0.001880314333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382169122
  error estimate for blocks of size 2^( 2) =       0.000397206516
  error estimate for blocks of size 2^( 3) =       0.000411764514
  error estimate for blocks of size 2^( 4) =       0.000421178205
  error estimate for blocks of size 2^( 5) =       0.000427186603
  error estimate for blocks of size 2^( 6) =       0.000430751903
  error estimate for blocks of size 2^( 7) =       0.000433022476

      target function =      -0.912634826519
              le_mean =     -17.205272287462
             les_mean =     296.321503980416
             stat err =       0.000428034797
             autocorr =       1.254431538349
   target nu stat err =       0.000428034797
   target dn stat err =       0.002334071746
      target stat err =       0.003659952518
              std dev =       0.540468754846
             le_variance =       0.292106474965

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292166863215
                                         uncertainty =       0.001880188626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292166863215
                                         uncertainty =       0.001880188626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382166525
  error estimate for blocks of size 2^( 2) =       0.000397203399
  error estimate for blocks of size 2^( 3) =       0.000411760792
  error estimate for blocks of size 2^( 4) =       0.000421174159
  error estimate for blocks of size 2^( 5) =       0.000427182613
  error estimate for blocks of size 2^( 6) =       0.000430747599
  error estimate for blocks of size 2^( 7) =       0.000433018402

      target function =      -0.912659937204
              le_mean =     -17.205272376912
             les_mean =     296.321490738530
             stat err =       0.000428030693
             autocorr =       1.254424531071
   target nu stat err =       0.000428030693
   target dn stat err =       0.002332152081
      target stat err =       0.003657255734
              std dev =       0.540465082708
             le_variance =       0.292102505627


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912663349915        initial  <--
     5.9605e+00     5.9605e+01             5.9331e-05        -0.912603510818
     2.3842e+01     2.3842e+02             1.4900e-05        -0.912634826519
     9.5367e+01     9.5367e+02             3.7296e-06        -0.912659937204

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1706
  </log>
  <optVariables href="H2O.s038.opt.xml">
  uu_0                 2.101878e-01 1 1  ON 0
  uu_1                 5.285558e-02 1 1  ON 1
  uu_2                -3.824672e-02 1 1  ON 2
  uu_3                -9.168793e-02 1 1  ON 3
  uu_4                -1.223284e-01 1 1  ON 4
  uu_5                -1.300804e-01 1 1  ON 5
  uu_6                -1.126826e-01 1 1  ON 6
  uu_7                -5.655530e-02 1 1  ON 7
  uu_8                 5.993274e-02 1 1  ON 8
  uu_9                 1.247146e-01 1 1  ON 9
  ud_0                 3.051290e-01 1 1  ON 10
  ud_1                 7.598020e-02 1 1  ON 11
  ud_2                -2.627128e-02 1 1  ON 12
  ud_3                -7.919282e-02 1 1  ON 13
  ud_4                -1.149196e-01 1 1  ON 14
  ud_5                -1.334314e-01 1 1  ON 15
  ud_6                -1.266214e-01 1 1  ON 16
  ud_7                -8.508704e-02 1 1  ON 17
  ud_8                -6.021248e-03 1 1  ON 18
  ud_9                 8.611699e-02 1 1  ON 19
  eO_0                -7.035271e-01 1 1  ON 20
  eO_1                -4.201035e-01 1 1  ON 21
  eO_2                -4.157530e-02 1 1  ON 22
  eO_3                 1.846558e-01 1 1  ON 23
  eO_4                 2.570249e-01 1 1  ON 24
  eO_5                 2.802770e-01 1 1  ON 25
  eO_6                 2.509944e-01 1 1  ON 26
  eO_7                 1.324444e-01 1 1  ON 27
  eO_8                 2.923120e-02 1 1  ON 28
  eO_9                 1.913747e-02 1 1  ON 29
 eH1_0                -2.017453e-01 1 1  ON 30
 eH1_1                -9.601445e-02 1 1  ON 31
 eH1_2                -4.469539e-02 1 1  ON 32
 eH1_3                -1.419482e-02 1 1  ON 33
 eH1_4                 1.844971e-02 1 1  ON 34
 eH1_5                 2.187687e-02 1 1  ON 35
 eH1_6                 7.090466e-02 1 1  ON 36
 eH1_7                 1.028572e-01 1 1  ON 37
 eH1_8                 1.006371e-01 1 1  ON 38
 eH1_9                 2.594314e-02 1 1  ON 39
 eH2_0                -2.032708e-01 1 1  ON 40
 eH2_1                -9.791633e-02 1 1  ON 41
 eH2_2                -4.653353e-02 1 1  ON 42
 eH2_3                -1.567604e-02 1 1  ON 43
 eH2_4                 1.629583e-02 1 1  ON 44
 eH2_5                 1.977122e-02 1 1  ON 45
 eH2_6                 7.234597e-02 1 1  ON 46
 eH2_7                 1.103511e-01 1 1  ON 47
 eH2_8                 1.031101e-01 1 1  ON 48
 eH2_9                 2.886063e-02 1 1  ON 49
ci_001                -4.205137e-02 3 1  ON 50
ci_002                -3.076173e-02 3 1  ON 51
ci_003                -1.130862e-02 3 1  ON 52
ci_004                 2.573516e-02 3 1  ON 53
ci_005                 2.583266e-02 3 1  ON 54
ci_006                -2.024595e-02 3 1  ON 55
ci_007                -1.959554e-02 3 1  ON 56
ci_008                -4.037025e-03 3 1  ON 57
ci_009                -1.501763e-02 3 1  ON 58
ci_010                -9.425261e-03 3 1  ON 59
ci_011                -9.759552e-03 3 1  ON 60
ci_012                -9.727200e-03 3 1  ON 61
ci_013                -2.164429e-02 3 1  ON 62
ci_014                 1.328691e-02 3 1  ON 63
ci_015                 1.288218e-02 3 1  ON 64
ci_016                 1.630049e-02 3 1  ON 65
ci_017                 1.620582e-02 3 1  ON 66
ci_018                 1.096363e-02 3 1  ON 67
ci_019                 1.071103e-02 3 1  ON 68
ci_020                 1.831274e-02 3 1  ON 69
ci_021                 1.805618e-02 3 1  ON 70
ci_022                 1.040128e-02 3 1  ON 71
ci_023                 1.006517e-02 3 1  ON 72
ci_024                 6.622816e-03 3 1  ON 73
ci_025                 6.634558e-03 3 1  ON 74
ci_026                 1.165287e-02 3 1  ON 75
ci_027                 1.157867e-02 3 1  ON 76
ci_028                -8.810506e-03 3 1  ON 77
ci_029                -9.779191e-03 3 1  ON 78
ci_030                -5.382359e-03 3 1  ON 79
ci_031                -4.559706e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4173e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7193e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.189
    reference variance = 0.21149
====================================================
  Execution time = 1.9316e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5434e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0350e-01
  Total weights = 1.973861111e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5888e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290746968987
                                         uncertainty =       0.001627736348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290746968987
                                         uncertainty =       0.001627736348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381309986
  error estimate for blocks of size 2^( 2) =       0.000396692746
  error estimate for blocks of size 2^( 3) =       0.000410899224
  error estimate for blocks of size 2^( 4) =       0.000420064189
  error estimate for blocks of size 2^( 5) =       0.000427622317
  error estimate for blocks of size 2^( 6) =       0.000431421574
  error estimate for blocks of size 2^( 7) =       0.000434614168

      target function =      -0.907389977340
              le_mean =     -17.206100866589
             les_mean =     296.353403107423
             stat err =       0.000428430562
             autocorr =       1.262421923711
   target nu stat err =       0.000428430562
   target dn stat err =       0.004776077940
      target stat err =       0.007305142526
              std dev =       0.539253754082
             le_variance =       0.290794611292


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720610086659e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907447456367       residual = 3.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907447715885       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907447808274       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907447824461       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907447836345       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907447849892       residual = 7.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907447859232       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907447864979       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907447868108       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907447871350       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.907447874761       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.907447883243       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.907447886224       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.907447887543       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.907447891976       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.907447894188       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.907447894114       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.907447892947       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.907447894853       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.907447895611       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.907447895084       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.907447895246       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.907447895235       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.907447897362       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.907447897724       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.907447897075       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.907447897299       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.907447897581       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.907447897617       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.907447898186       residual = 8.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.907447898143       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.907447897845       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.907447897896       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.907447897723       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.907447897879       residual = 6.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.9605e+01 is 7.467379e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907447456367       residual = 3.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907447521309       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907447544425       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907447548473       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907447551446       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907447554834       residual = 7.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907447557170       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907447558609       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907447559391       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907447560202       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.907447561056       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.907447563178       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.907447563922       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.907447564252       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.907447565360       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.907447565912       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.907447565894       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.907447565603       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.907447566079       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.907447566268       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.907447566136       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.907447566177       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.907447566174       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.907447566705       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.907447566795       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.907447566634       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.907447566690       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.907447566760       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.907447566769       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.907447566911       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.907447566900       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.907447566825       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.907447566838       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.907447566794       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.907447566835       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3842e+02 is 1.867081e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907447456367       residual = 3.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907447472607       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907447478387       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907447479399       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907447480143       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907447480990       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907447481572       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907447481931       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907447482128       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907447482334       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.907447482544       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.907447483076       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.907447483260       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.907447483346       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.907447483622       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.907447483761       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.907447483754       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.907447483680       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.907447483801       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.907447483850       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.907447483816       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.907447483825       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.907447483823       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.907447483956       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.907447483978       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.907447483936       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.907447483949       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.907447483967       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.907447483972       residual = 8.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.907447484006       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.907447484004       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.907447483987       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.907447483987       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.907447483978       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.907447483987       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.5367e+02 is 4.667849e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.433971 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4956e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
  uu_0                 2.101882e-01 1 1  ON 0
  uu_1                 5.285649e-02 1 1  ON 1
  uu_2                -3.824617e-02 1 1  ON 2
  uu_3                -9.168767e-02 1 1  ON 3
  uu_4                -1.223285e-01 1 1  ON 4
  uu_5                -1.300810e-01 1 1  ON 5
  uu_6                -1.126826e-01 1 1  ON 6
  uu_7                -5.655560e-02 1 1  ON 7
  uu_8                 5.993087e-02 1 1  ON 8
  uu_9                 1.247148e-01 1 1  ON 9
  ud_0                 3.051286e-01 1 1  ON 10
  ud_1                 7.597973e-02 1 1  ON 11
  ud_2                -2.627149e-02 1 1  ON 12
  ud_3                -7.919290e-02 1 1  ON 13
  ud_4                -1.149194e-01 1 1  ON 14
  ud_5                -1.334311e-01 1 1  ON 15
  ud_6                -1.266216e-01 1 1  ON 16
  ud_7                -8.508670e-02 1 1  ON 17
  ud_8                -6.021125e-03 1 1  ON 18
  ud_9                 8.611698e-02 1 1  ON 19
  eO_0                -7.035269e-01 1 1  ON 20
  eO_1                -4.201031e-01 1 1  ON 21
  eO_2                -4.157481e-02 1 1  ON 22
  eO_3                 1.846557e-01 1 1  ON 23
  eO_4                 2.570246e-01 1 1  ON 24
  eO_5                 2.802757e-01 1 1  ON 25
  eO_6                 2.509938e-01 1 1  ON 26
  eO_7                 1.324454e-01 1 1  ON 27
  eO_8                 2.923132e-02 1 1  ON 28
  eO_9                 1.913750e-02 1 1  ON 29
 eH1_0                -2.017463e-01 1 1  ON 30
 eH1_1                -9.601513e-02 1 1  ON 31
 eH1_2                -4.469594e-02 1 1  ON 32
 eH1_3                -1.419534e-02 1 1  ON 33
 eH1_4                 1.845045e-02 1 1  ON 34
 eH1_5                 2.187827e-02 1 1  ON 35
 eH1_6                 7.090498e-02 1 1  ON 36
 eH1_7                 1.028569e-01 1 1  ON 37
 eH1_8                 1.006377e-01 1 1  ON 38
 eH1_9                 2.594320e-02 1 1  ON 39
 eH2_0                -2.032711e-01 1 1  ON 40
 eH2_1                -9.791682e-02 1 1  ON 41
 eH2_2                -4.653357e-02 1 1  ON 42
 eH2_3                -1.567629e-02 1 1  ON 43
 eH2_4                 1.629579e-02 1 1  ON 44
 eH2_5                 1.977206e-02 1 1  ON 45
 eH2_6                 7.234612e-02 1 1  ON 46
 eH2_7                 1.103505e-01 1 1  ON 47
 eH2_8                 1.031106e-01 1 1  ON 48
 eH2_9                 2.886072e-02 1 1  ON 49
ci_001                -4.205108e-02 3 1  ON 50
ci_002                -3.076167e-02 3 1  ON 51
ci_003                -1.130850e-02 3 1  ON 52
ci_004                 2.573474e-02 3 1  ON 53
ci_005                 2.583265e-02 3 1  ON 54
ci_006                -2.024572e-02 3 1  ON 55
ci_007                -1.959586e-02 3 1  ON 56
ci_008                -4.037111e-03 3 1  ON 57
ci_009                -1.501776e-02 3 1  ON 58
ci_010                -9.425314e-03 3 1  ON 59
ci_011                -9.759325e-03 3 1  ON 60
ci_012                -9.727063e-03 3 1  ON 61
ci_013                -2.164419e-02 3 1  ON 62
ci_014                 1.328649e-02 3 1  ON 63
ci_015                 1.288183e-02 3 1  ON 64
ci_016                 1.630042e-02 3 1  ON 65
ci_017                 1.620580e-02 3 1  ON 66
ci_018                 1.096370e-02 3 1  ON 67
ci_019                 1.071110e-02 3 1  ON 68
ci_020                 1.831267e-02 3 1  ON 69
ci_021                 1.805603e-02 3 1  ON 70
ci_022                 1.040118e-02 3 1  ON 71
ci_023                 1.006525e-02 3 1  ON 72
ci_024                 6.622576e-03 3 1  ON 73
ci_025                 6.634650e-03 3 1  ON 74
ci_026                 1.165271e-02 3 1  ON 75
ci_027                 1.157829e-02 3 1  ON 76
ci_028                -8.810119e-03 3 1  ON 77
ci_029                -9.779137e-03 3 1  ON 78
ci_030                -5.382159e-03 3 1  ON 79
ci_031                -4.559640e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2823
    reference variance = 0.394812
====================================================
  Execution time = 1.9393e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0333e-01
  Total weights = 1.9738e+06
  Execution time = 1.5467e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294077229389
                                         uncertainty =       0.002920400775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294077229389
                                         uncertainty =       0.002920400775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383454596
  error estimate for blocks of size 2^( 2) =       0.000398560324
  error estimate for blocks of size 2^( 3) =       0.000412626852
  error estimate for blocks of size 2^( 4) =       0.000423391265
  error estimate for blocks of size 2^( 5) =       0.000429385737
  error estimate for blocks of size 2^( 6) =       0.000433446956
  error estimate for blocks of size 2^( 7) =       0.000435263004

      target function =      -0.907668559731
              le_mean =     -17.206333118224
             les_mean =     296.361226988599
             stat err =       0.000430371740
             autocorr =       1.259678156486
   target nu stat err =       0.000430371740
   target dn stat err =       0.003348298000
      target stat err =       0.005152524852
              std dev =       0.542286689696
             le_variance =       0.294074853822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294076910788
                                         uncertainty =       0.002920263049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294076910788
                                         uncertainty =       0.002920263049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383454390
  error estimate for blocks of size 2^( 2) =       0.000398560294
  error estimate for blocks of size 2^( 3) =       0.000412627004
  error estimate for blocks of size 2^( 4) =       0.000423391549
  error estimate for blocks of size 2^( 5) =       0.000429386156
  error estimate for blocks of size 2^( 6) =       0.000433447442
  error estimate for blocks of size 2^( 7) =       0.000435263537

      target function =      -0.907670583366
              le_mean =     -17.206333109060
             les_mean =     296.361225347363
             stat err =       0.000430372171
             autocorr =       1.259682028020
   target nu stat err =       0.000430372171
   target dn stat err =       0.003348110799
      target stat err =       0.005152265186
              std dev =       0.542286398931
             le_variance =       0.294074538465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294077069768
                                         uncertainty =       0.002920331833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294077069768
                                         uncertainty =       0.002920331833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383454493
  error estimate for blocks of size 2^( 2) =       0.000398560309
  error estimate for blocks of size 2^( 3) =       0.000412626928
  error estimate for blocks of size 2^( 4) =       0.000423391407
  error estimate for blocks of size 2^( 5) =       0.000429385947
  error estimate for blocks of size 2^( 6) =       0.000433447199
  error estimate for blocks of size 2^( 7) =       0.000435263270

      target function =      -0.907669575514
              le_mean =     -17.206333113623
             les_mean =     296.361226164715
             stat err =       0.000430371956
             autocorr =       1.259680093938
   target nu stat err =       0.000430371956
   target dn stat err =       0.003348204242
      target stat err =       0.005152394826
              std dev =       0.542286544020
             le_variance =       0.294074695825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294077209412
                                         uncertainty =       0.002920392153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294077209412
                                         uncertainty =       0.002920392153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383454583
  error estimate for blocks of size 2^( 2) =       0.000398560322
  error estimate for blocks of size 2^( 3) =       0.000412626861
  error estimate for blocks of size 2^( 4) =       0.000423391283
  error estimate for blocks of size 2^( 5) =       0.000429385763
  error estimate for blocks of size 2^( 6) =       0.000433446986
  error estimate for blocks of size 2^( 7) =       0.000435263037

      target function =      -0.907668687074
              le_mean =     -17.206333117647
             les_mean =     296.361226885304
             stat err =       0.000430371767
             autocorr =       1.259678398733
   target nu stat err =       0.000430371767
   target dn stat err =       0.003348286269
      target stat err =       0.005152508586
              std dev =       0.542286671464
             le_variance =       0.294074834047


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.907668559731        initial
     5.9605e+01     5.9605e+02             7.4674e-06        -0.907670583366  <--
     2.3842e+02     2.3842e+03             1.8671e-06        -0.907669575514
     9.5367e+02     9.5367e+03             4.6678e-07        -0.907668687074

*****************************************************************************
Applying the update for shift_i =   5.9605e+01     and shift_s =   5.9605e+02
*****************************************************************************

  Execution time = 2.7231e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
  uu_0                 2.101894e-01 1 1  ON 0
  uu_1                 5.285920e-02 1 1  ON 1
  uu_2                -3.824453e-02 1 1  ON 2
  uu_3                -9.168691e-02 1 1  ON 3
  uu_4                -1.223289e-01 1 1  ON 4
  uu_5                -1.300825e-01 1 1  ON 5
  uu_6                -1.126828e-01 1 1  ON 6
  uu_7                -5.655647e-02 1 1  ON 7
  uu_8                 5.992527e-02 1 1  ON 8
  uu_9                 1.247155e-01 1 1  ON 9
  ud_0                 3.051274e-01 1 1  ON 10
  ud_1                 7.597835e-02 1 1  ON 11
  ud_2                -2.627213e-02 1 1  ON 12
  ud_3                -7.919314e-02 1 1  ON 13
  ud_4                -1.149189e-01 1 1  ON 14
  ud_5                -1.334302e-01 1 1  ON 15
  ud_6                -1.266219e-01 1 1  ON 16
  ud_7                -8.508569e-02 1 1  ON 17
  ud_8                -6.020755e-03 1 1  ON 18
  ud_9                 8.611697e-02 1 1  ON 19
  eO_0                -7.035260e-01 1 1  ON 20
  eO_1                -4.201019e-01 1 1  ON 21
  eO_2                -4.157336e-02 1 1  ON 22
  eO_3                 1.846554e-01 1 1  ON 23
  eO_4                 2.570235e-01 1 1  ON 24
  eO_5                 2.802720e-01 1 1  ON 25
  eO_6                 2.509919e-01 1 1  ON 26
  eO_7                 1.324482e-01 1 1  ON 27
  eO_8                 2.923169e-02 1 1  ON 28
  eO_9                 1.913762e-02 1 1  ON 29
 eH1_0                -2.017493e-01 1 1  ON 30
 eH1_1                -9.601718e-02 1 1  ON 31
 eH1_2                -4.469760e-02 1 1  ON 32
 eH1_3                -1.419692e-02 1 1  ON 33
 eH1_4                 1.845265e-02 1 1  ON 34
 eH1_5                 2.188247e-02 1 1  ON 35
 eH1_6                 7.090595e-02 1 1  ON 36
 eH1_7                 1.028561e-01 1 1  ON 37
 eH1_8                 1.006393e-01 1 1  ON 38
 eH1_9                 2.594336e-02 1 1  ON 39
 eH2_0                -2.032717e-01 1 1  ON 40
 eH2_1                -9.791829e-02 1 1  ON 41
 eH2_2                -4.653367e-02 1 1  ON 42
 eH2_3                -1.567702e-02 1 1  ON 43
 eH2_4                 1.629564e-02 1 1  ON 44
 eH2_5                 1.977460e-02 1 1  ON 45
 eH2_6                 7.234659e-02 1 1  ON 46
 eH2_7                 1.103488e-01 1 1  ON 47
 eH2_8                 1.031121e-01 1 1  ON 48
 eH2_9                 2.886098e-02 1 1  ON 49
ci_001                -4.205022e-02 3 1  ON 50
ci_002                -3.076149e-02 3 1  ON 51
ci_003                -1.130815e-02 3 1  ON 52
ci_004                 2.573349e-02 3 1  ON 53
ci_005                 2.583262e-02 3 1  ON 54
ci_006                -2.024505e-02 3 1  ON 55
ci_007                -1.959681e-02 3 1  ON 56
ci_008                -4.037369e-03 3 1  ON 57
ci_009                -1.501817e-02 3 1  ON 58
ci_010                -9.425475e-03 3 1  ON 59
ci_011                -9.758643e-03 3 1  ON 60
ci_012                -9.726655e-03 3 1  ON 61
ci_013                -2.164388e-02 3 1  ON 62
ci_014                 1.328521e-02 3 1  ON 63
ci_015                 1.288079e-02 3 1  ON 64
ci_016                 1.630018e-02 3 1  ON 65
ci_017                 1.620572e-02 3 1  ON 66
ci_018                 1.096393e-02 3 1  ON 67
ci_019                 1.071131e-02 3 1  ON 68
ci_020                 1.831244e-02 3 1  ON 69
ci_021                 1.805559e-02 3 1  ON 70
ci_022                 1.040088e-02 3 1  ON 71
ci_023                 1.006550e-02 3 1  ON 72
ci_024                 6.621857e-03 3 1  ON 73
ci_025                 6.634925e-03 3 1  ON 74
ci_026                 1.165223e-02 3 1  ON 75
ci_027                 1.157717e-02 3 1  ON 76
ci_028                -8.808958e-03 3 1  ON 77
ci_029                -9.778978e-03 3 1  ON 78
ci_030                -5.381557e-03 3 1  ON 79
ci_031                -4.559442e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2193e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7194e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.2645
    reference variance = 0.505719
====================================================
  Execution time = 1.9362e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5442e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0684e-01
  Total weights = 1.973744227e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5775e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294133809038
                                         uncertainty =       0.005452532896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294133809038
                                         uncertainty =       0.005452532896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383525872
  error estimate for blocks of size 2^( 2) =       0.000398640814
  error estimate for blocks of size 2^( 3) =       0.000412929568
  error estimate for blocks of size 2^( 4) =       0.000423184243
  error estimate for blocks of size 2^( 5) =       0.000430160463
  error estimate for blocks of size 2^( 6) =       0.000434523347
  error estimate for blocks of size 2^( 7) =       0.000436437100

      target function =      -0.902077937894
              le_mean =     -17.206297053160
             les_mean =     296.363495025989
             stat err =       0.000431076288
             autocorr =       1.263336188487
   target nu stat err =       0.000431076288
   target dn stat err =       0.011004970426
      target stat err =       0.016581364522
              std dev =       0.542387489899
             le_variance =       0.294184189199


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720629705316e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902382803239       residual = 6.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902400112753       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902403139814       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902404136356       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902404442886       residual = 5.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902404787214       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902404953566       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902405038745       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902405251746       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902405504757       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902405597179       residual = 7.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.902405663761       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.902405728298       residual = 8.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.902405782148       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.902405813042       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.902405835158       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.902405862804       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.902405882958       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.902405905921       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.902405923400       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.902405939420       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.902405942051       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.902405950245       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.902405964638       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.902405969136       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.902405968604       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.902405971052       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.902405971394       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.902405972349       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.902405973165       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.902405976463       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.902405974993       residual = 8.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.902405976524       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.902405977485       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.902405976850       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.902405976503       residual = 5.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.902405977004       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.902405976857       residual = 8.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4901e+01 is 6.513359e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902382803239       residual = 6.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902387147366       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902387906255       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902388156189       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902388233033       residual = 5.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902388319383       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902388361009       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902388382334       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902388435703       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902388499052       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902388522203       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.902388538737       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.902388554940       residual = 8.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.902388568449       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.902388576146       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.902388581665       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.902388588584       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.902388593611       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.902388599348       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.902388603707       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.902388607706       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.902388608352       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.902388610400       residual = 7.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.902388613970       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.902388615079       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.902388614943       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.902388615551       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.902388615635       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.902388615874       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.902388616082       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.902388616901       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.902388616534       residual = 8.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.902388616916       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.902388617152       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.902388616995       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.902388616908       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.902388617032       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.902388616995       residual = 8.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.9605e+01 is 1.629002e-05

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902382803239       residual = 6.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902383890323       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902384080178       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902384142712       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902384161936       residual = 5.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902384183541       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902384193950       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902384199283       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902384212632       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902384228476       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902384234266       residual = 7.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.902384238392       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.902384242448       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.902384245827       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.902384247750       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.902384249129       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.902384250859       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.902384252115       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.902384253550       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.902384254639       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.902384255638       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.902384255800       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.902384256311       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.902384257201       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.902384257478       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.902384257443       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.902384257595       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.902384257616       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.902384257676       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.902384257728       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.902384257934       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.902384257842       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.902384257936       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.902384257995       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.902384257956       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.902384257934       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.902384257965       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.902384257958       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3842e+02 is 4.072920e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.491614 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5002e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
  uu_0                 2.101834e-01 1 1  ON 0
  uu_1                 5.285710e-02 1 1  ON 1
  uu_2                -3.824264e-02 1 1  ON 2
  uu_3                -9.168472e-02 1 1  ON 3
  uu_4                -1.223258e-01 1 1  ON 4
  uu_5                -1.300783e-01 1 1  ON 5
  uu_6                -1.126796e-01 1 1  ON 6
  uu_7                -5.655820e-02 1 1  ON 7
  uu_8                 5.991908e-02 1 1  ON 8
  uu_9                 1.247152e-01 1 1  ON 9
  ud_0                 3.051243e-01 1 1  ON 10
  ud_1                 7.597736e-02 1 1  ON 11
  ud_2                -2.627589e-02 1 1  ON 12
  ud_3                -7.919595e-02 1 1  ON 13
  ud_4                -1.149180e-01 1 1  ON 14
  ud_5                -1.334245e-01 1 1  ON 15
  ud_6                -1.266163e-01 1 1  ON 16
  ud_7                -8.508661e-02 1 1  ON 17
  ud_8                -6.022301e-03 1 1  ON 18
  ud_9                 8.611606e-02 1 1  ON 19
  eO_0                -7.035213e-01 1 1  ON 20
  eO_1                -4.201016e-01 1 1  ON 21
  eO_2                -4.157323e-02 1 1  ON 22
  eO_3                 1.846507e-01 1 1  ON 23
  eO_4                 2.570185e-01 1 1  ON 24
  eO_5                 2.802674e-01 1 1  ON 25
  eO_6                 2.509974e-01 1 1  ON 26
  eO_7                 1.324514e-01 1 1  ON 27
  eO_8                 2.923197e-02 1 1  ON 28
  eO_9                 1.913782e-02 1 1  ON 29
 eH1_0                -2.017452e-01 1 1  ON 30
 eH1_1                -9.601327e-02 1 1  ON 31
 eH1_2                -4.469358e-02 1 1  ON 32
 eH1_3                -1.419479e-02 1 1  ON 33
 eH1_4                 1.844898e-02 1 1  ON 34
 eH1_5                 2.186874e-02 1 1  ON 35
 eH1_6                 7.089875e-02 1 1  ON 36
 eH1_7                 1.028575e-01 1 1  ON 37
 eH1_8                 1.006476e-01 1 1  ON 38
 eH1_9                 2.594396e-02 1 1  ON 39
 eH2_0                -2.032785e-01 1 1  ON 40
 eH2_1                -9.792529e-02 1 1  ON 41
 eH2_2                -4.653796e-02 1 1  ON 42
 eH2_3                -1.568204e-02 1 1  ON 43
 eH2_4                 1.629167e-02 1 1  ON 44
 eH2_5                 1.978560e-02 1 1  ON 45
 eH2_6                 7.236288e-02 1 1  ON 46
 eH2_7                 1.103463e-01 1 1  ON 47
 eH2_8                 1.031142e-01 1 1  ON 48
 eH2_9                 2.886106e-02 1 1  ON 49
ci_001                -4.204925e-02 3 1  ON 50
ci_002                -3.076098e-02 3 1  ON 51
ci_003                -1.130641e-02 3 1  ON 52
ci_004                 2.572986e-02 3 1  ON 53
ci_005                 2.583142e-02 3 1  ON 54
ci_006                -2.024441e-02 3 1  ON 55
ci_007                -1.959512e-02 3 1  ON 56
ci_008                -4.037671e-03 3 1  ON 57
ci_009                -1.501681e-02 3 1  ON 58
ci_010                -9.424856e-03 3 1  ON 59
ci_011                -9.751182e-03 3 1  ON 60
ci_012                -9.726400e-03 3 1  ON 61
ci_013                -2.164534e-02 3 1  ON 62
ci_014                 1.327465e-02 3 1  ON 63
ci_015                 1.288122e-02 3 1  ON 64
ci_016                 1.630218e-02 3 1  ON 65
ci_017                 1.620560e-02 3 1  ON 66
ci_018                 1.096256e-02 3 1  ON 67
ci_019                 1.071074e-02 3 1  ON 68
ci_020                 1.831112e-02 3 1  ON 69
ci_021                 1.805550e-02 3 1  ON 70
ci_022                 1.040045e-02 3 1  ON 71
ci_023                 1.006581e-02 3 1  ON 72
ci_024                 6.622194e-03 3 1  ON 73
ci_025                 6.635554e-03 3 1  ON 74
ci_026                 1.165513e-02 3 1  ON 75
ci_027                 1.157644e-02 3 1  ON 76
ci_028                -8.809256e-03 3 1  ON 77
ci_029                -9.785429e-03 3 1  ON 78
ci_030                -5.380330e-03 3 1  ON 79
ci_031                -4.555572e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1761
    reference variance = 0.314917
====================================================
  Execution time = 1.9074e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9483e-01
  Total weights = 1.9739e+06
  Execution time = 1.5702e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288184822443
                                         uncertainty =       0.001387519480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288184822443
                                         uncertainty =       0.001387519480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379629913
  error estimate for blocks of size 2^( 2) =       0.000394878489
  error estimate for blocks of size 2^( 3) =       0.000409100548
  error estimate for blocks of size 2^( 4) =       0.000419378878
  error estimate for blocks of size 2^( 5) =       0.000425920959
  error estimate for blocks of size 2^( 6) =       0.000430023331
  error estimate for blocks of size 2^( 7) =       0.000432452218

      target function =      -0.920822517691
              le_mean =     -17.205686000566
             les_mean =     296.330462384390
             stat err =       0.000426943846
             autocorr =       1.264796530983
   target nu stat err =       0.000426943846
   target dn stat err =       0.002059981443
      target stat err =       0.003307107922
              std dev =       0.536877771684
             le_variance =       0.288237741729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288174327342
                                         uncertainty =       0.001387055507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288174327342
                                         uncertainty =       0.001387055507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379622978
  error estimate for blocks of size 2^( 2) =       0.000394873412
  error estimate for blocks of size 2^( 3) =       0.000409097621
  error estimate for blocks of size 2^( 4) =       0.000419378143
  error estimate for blocks of size 2^( 5) =       0.000425921764
  error estimate for blocks of size 2^( 6) =       0.000430024943
  error estimate for blocks of size 2^( 7) =       0.000432454393

      target function =      -0.920854559559
              le_mean =     -17.205686423953
             les_mean =     296.330456500160
             stat err =       0.000426944811
             autocorr =       1.264848459344
   target nu stat err =       0.000426944811
   target dn stat err =       0.002059209721
      target stat err =       0.003306156187
              std dev =       0.536867963615
             le_variance =       0.288227210357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288179534667
                                         uncertainty =       0.001387286229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288179534667
                                         uncertainty =       0.001387286229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379626419
  error estimate for blocks of size 2^( 2) =       0.000394875926
  error estimate for blocks of size 2^( 3) =       0.000409099064
  error estimate for blocks of size 2^( 4) =       0.000419378493
  error estimate for blocks of size 2^( 5) =       0.000425921347
  error estimate for blocks of size 2^( 6) =       0.000430024123
  error estimate for blocks of size 2^( 7) =       0.000432453292

      target function =      -0.920839038957
              le_mean =     -17.205686210087
             les_mean =     296.330459047940
             stat err =       0.000426944314
             autocorr =       1.264822583697
   target nu stat err =       0.000426944314
   target dn stat err =       0.002059589199
      target stat err =       0.003306625805
              std dev =       0.536872830153
             le_variance =       0.288232435757

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288184158490
                                         uncertainty =       0.001387490250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288184158490
                                         uncertainty =       0.001387490250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379629474
  error estimate for blocks of size 2^( 2) =       0.000394878167
  error estimate for blocks of size 2^( 3) =       0.000409100361
  error estimate for blocks of size 2^( 4) =       0.000419378828
  error estimate for blocks of size 2^( 5) =       0.000425921006
  error estimate for blocks of size 2^( 6) =       0.000430023428
  error estimate for blocks of size 2^( 7) =       0.000432452351

      target function =      -0.920824638522
              le_mean =     -17.205686026454
             les_mean =     296.330461921366
             stat err =       0.000426943903
             autocorr =       1.264799790701
   target nu stat err =       0.000426943903
   target dn stat err =       0.002059931761
      target stat err =       0.003307047052
              std dev =       0.536877151218
             le_variance =       0.288237075500


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920822517691        initial
     1.4901e+01     1.4901e+02             6.5134e-05        -0.920854559559  <--
     5.9605e+01     5.9605e+02             1.6290e-05        -0.920839038957
     2.3842e+02     2.3842e+03             4.0729e-06        -0.920824638522

*****************************************************************************
Applying the update for shift_i =   1.4901e+01     and shift_s =   1.4901e+02
*****************************************************************************

  Execution time = 2.6962e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
  uu_0                 2.101654e-01 1 1  ON 0
  uu_1                 5.285083e-02 1 1  ON 1
  uu_2                -3.823698e-02 1 1  ON 2
  uu_3                -9.167818e-02 1 1  ON 3
  uu_4                -1.223168e-01 1 1  ON 4
  uu_5                -1.300656e-01 1 1  ON 5
  uu_6                -1.126700e-01 1 1  ON 6
  uu_7                -5.656337e-02 1 1  ON 7
  uu_8                 5.990051e-02 1 1  ON 8
  uu_9                 1.247144e-01 1 1  ON 9
  ud_0                 3.051149e-01 1 1  ON 10
  ud_1                 7.597437e-02 1 1  ON 11
  ud_2                -2.628712e-02 1 1  ON 12
  ud_3                -7.920433e-02 1 1  ON 13
  ud_4                -1.149154e-01 1 1  ON 14
  ud_5                -1.334075e-01 1 1  ON 15
  ud_6                -1.265995e-01 1 1  ON 16
  ud_7                -8.508936e-02 1 1  ON 17
  ud_8                -6.026932e-03 1 1  ON 18
  ud_9                 8.611334e-02 1 1  ON 19
  eO_0                -7.035072e-01 1 1  ON 20
  eO_1                -4.201009e-01 1 1  ON 21
  eO_2                -4.157284e-02 1 1  ON 22
  eO_3                 1.846367e-01 1 1  ON 23
  eO_4                 2.570035e-01 1 1  ON 24
  eO_5                 2.802535e-01 1 1  ON 25
  eO_6                 2.510141e-01 1 1  ON 26
  eO_7                 1.324610e-01 1 1  ON 27
  eO_8                 2.923279e-02 1 1  ON 28
  eO_9                 1.913844e-02 1 1  ON 29
 eH1_0                -2.017330e-01 1 1  ON 30
 eH1_1                -9.600158e-02 1 1  ON 31
 eH1_2                -4.468155e-02 1 1  ON 32
 eH1_3                -1.418843e-02 1 1  ON 33
 eH1_4                 1.843800e-02 1 1  ON 34
 eH1_5                 2.182764e-02 1 1  ON 35
 eH1_6                 7.087717e-02 1 1  ON 36
 eH1_7                 1.028620e-01 1 1  ON 37
 eH1_8                 1.006727e-01 1 1  ON 38
 eH1_9                 2.594574e-02 1 1  ON 39
 eH2_0                -2.032988e-01 1 1  ON 40
 eH2_1                -9.794625e-02 1 1  ON 41
 eH2_2                -4.655083e-02 1 1  ON 42
 eH2_3                -1.569710e-02 1 1  ON 43
 eH2_4                 1.627977e-02 1 1  ON 44
 eH2_5                 1.981849e-02 1 1  ON 45
 eH2_6                 7.241172e-02 1 1  ON 46
 eH2_7                 1.103390e-01 1 1  ON 47
 eH2_8                 1.031205e-01 1 1  ON 48
 eH2_9                 2.886132e-02 1 1  ON 49
ci_001                -4.204638e-02 3 1  ON 50
ci_002                -3.075944e-02 3 1  ON 51
ci_003                -1.130123e-02 3 1  ON 52
ci_004                 2.571901e-02 3 1  ON 53
ci_005                 2.582784e-02 3 1  ON 54
ci_006                -2.024248e-02 3 1  ON 55
ci_007                -1.959004e-02 3 1  ON 56
ci_008                -4.038571e-03 3 1  ON 57
ci_009                -1.501277e-02 3 1  ON 58
ci_010                -9.423008e-03 3 1  ON 59
ci_011                -9.728909e-03 3 1  ON 60
ci_012                -9.725640e-03 3 1  ON 61
ci_013                -2.164969e-02 3 1  ON 62
ci_014                 1.324312e-02 3 1  ON 63
ci_015                 1.288252e-02 3 1  ON 64
ci_016                 1.630812e-02 3 1  ON 65
ci_017                 1.620522e-02 3 1  ON 66
ci_018                 1.095847e-02 3 1  ON 67
ci_019                 1.070904e-02 3 1  ON 68
ci_020                 1.830720e-02 3 1  ON 69
ci_021                 1.805522e-02 3 1  ON 70
ci_022                 1.039915e-02 3 1  ON 71
ci_023                 1.006675e-02 3 1  ON 72
ci_024                 6.623200e-03 3 1  ON 73
ci_025                 6.637432e-03 3 1  ON 74
ci_026                 1.166377e-02 3 1  ON 75
ci_027                 1.157425e-02 3 1  ON 76
ci_028                -8.810149e-03 3 1  ON 77
ci_029                -9.804694e-03 3 1  ON 78
ci_030                -5.376666e-03 3 1  ON 79
ci_031                -4.544021e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1971e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7195e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.2599
    reference variance = 0.22537
====================================================
  Execution time = 1.9185e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5409e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0315e-01
  Total weights = 1.973812472e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5838e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291423530099
                                         uncertainty =       0.002003635395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291423530099
                                         uncertainty =       0.002003635395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381799512
  error estimate for blocks of size 2^( 2) =       0.000397037987
  error estimate for blocks of size 2^( 3) =       0.000410865679
  error estimate for blocks of size 2^( 4) =       0.000421925242
  error estimate for blocks of size 2^( 5) =       0.000428419018
  error estimate for blocks of size 2^( 6) =       0.000431189430
  error estimate for blocks of size 2^( 7) =       0.000434910042

      target function =      -0.907911788257
              le_mean =     -17.206846649087
             les_mean =     296.378724789591
             stat err =       0.000429110933
             autocorr =       1.263189250745
   target nu stat err =       0.000429110933
   target dn stat err =       0.003711362713
      target stat err =       0.005708997449
              std dev =       0.539946047887
             le_variance =       0.291541734629


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720684664909e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907946751246       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907968899875       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907972288007       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907973632175       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907973888298       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907974084362       residual = 9.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907974219682       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907974368552       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907974424035       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907974568604       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.907974589639       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.907974652701       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.907974639809       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.907974712274       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.907974744505       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.907974759395       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.907974774862       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.907974786507       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.907974779735       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.907974801984       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.907974847972       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.907974889037       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.907974893328       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.907974899671       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.907974904305       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.907974904839       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.907974909847       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.907974907813       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.907974914622       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.907974904209       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.907974910711       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.907974915375       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.907974916623       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.907974914645       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.907974910588       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.907974912258       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.7253e+00 is 1.358186e-04

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907946751246       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907952374214       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907953231374       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907953571790       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907953636535       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907953686202       residual = 9.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907953720378       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907953758241       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907953771993       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907953808581       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.907953813971       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.907953829823       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.907953826546       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.907953844878       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.907953852952       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.907953856689       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.907953860505       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.907953863333       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.907953861742       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.907953867432       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.907953879061       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.907953889036       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.907953889973       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.907953891585       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.907953892733       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.907953892872       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.907953894075       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.907953893532       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.907953895189       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.907953892633       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.907953894310       residual = 9.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.907953895417       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.907953895686       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.907953895195       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.907953894229       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.907953894619       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4901e+01 is 3.399770e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907946751246       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907948162455       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907948377387       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907948462769       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907948479001       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907948491459       residual = 9.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907948500025       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907948509532       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907948512962       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907948522137       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.907948523493       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.907948527461       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.907948526639       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.907948531235       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.907948533255       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.907948534190       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.907948535141       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.907948535843       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.907948535452       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.907948536882       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.907948539798       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.907948542272       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.907948542498       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.907948542903       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.907948543190       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.907948543224       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.907948543522       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.907948543384       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.907948543795       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.907948543160       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.907948543582       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.907948543855       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.907948543920       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.907948543797       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.907948543559       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.907948543654       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.9605e+01 is 8.502121e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.541306 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4824e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
  uu_0                 2.101789e-01 1 1  ON 0
  uu_1                 5.285868e-02 1 1  ON 1
  uu_2                -3.822849e-02 1 1  ON 2
  uu_3                -9.167341e-02 1 1  ON 3
  uu_4                -1.223162e-01 1 1  ON 4
  uu_5                -1.300736e-01 1 1  ON 5
  uu_6                -1.126871e-01 1 1  ON 6
  uu_7                -5.657760e-02 1 1  ON 7
  uu_8                 5.986651e-02 1 1  ON 8
  uu_9                 1.247232e-01 1 1  ON 9
  ud_0                 3.050927e-01 1 1  ON 10
  ud_1                 7.595753e-02 1 1  ON 11
  ud_2                -2.629683e-02 1 1  ON 12
  ud_3                -7.920766e-02 1 1  ON 13
  ud_4                -1.149117e-01 1 1  ON 14
  ud_5                -1.333991e-01 1 1  ON 15
  ud_6                -1.265885e-01 1 1  ON 16
  ud_7                -8.508035e-02 1 1  ON 17
  ud_8                -6.026279e-03 1 1  ON 18
  ud_9                 8.611849e-02 1 1  ON 19
  eO_0                -7.035057e-01 1 1  ON 20
  eO_1                -4.201018e-01 1 1  ON 21
  eO_2                -4.157961e-02 1 1  ON 22
  eO_3                 1.846291e-01 1 1  ON 23
  eO_4                 2.569941e-01 1 1  ON 24
  eO_5                 2.802515e-01 1 1  ON 25
  eO_6                 2.510181e-01 1 1  ON 26
  eO_7                 1.324738e-01 1 1  ON 27
  eO_8                 2.923493e-02 1 1  ON 28
  eO_9                 1.914297e-02 1 1  ON 29
 eH1_0                -2.017253e-01 1 1  ON 30
 eH1_1                -9.599652e-02 1 1  ON 31
 eH1_2                -4.468164e-02 1 1  ON 32
 eH1_3                -1.419133e-02 1 1  ON 33
 eH1_4                 1.843515e-02 1 1  ON 34
 eH1_5                 2.182275e-02 1 1  ON 35
 eH1_6                 7.086888e-02 1 1  ON 36
 eH1_7                 1.028607e-01 1 1  ON 37
 eH1_8                 1.006788e-01 1 1  ON 38
 eH1_9                 2.594643e-02 1 1  ON 39
 eH2_0                -2.032969e-01 1 1  ON 40
 eH2_1                -9.793949e-02 1 1  ON 41
 eH2_2                -4.655084e-02 1 1  ON 42
 eH2_3                -1.570135e-02 1 1  ON 43
 eH2_4                 1.627669e-02 1 1  ON 44
 eH2_5                 1.980853e-02 1 1  ON 45
 eH2_6                 7.241312e-02 1 1  ON 46
 eH2_7                 1.103312e-01 1 1  ON 47
 eH2_8                 1.031277e-01 1 1  ON 48
 eH2_9                 2.886469e-02 1 1  ON 49
ci_001                -4.204716e-02 3 1  ON 50
ci_002                -3.076339e-02 3 1  ON 51
ci_003                -1.129537e-02 3 1  ON 52
ci_004                 2.572628e-02 3 1  ON 53
ci_005                 2.583236e-02 3 1  ON 54
ci_006                -2.024199e-02 3 1  ON 55
ci_007                -1.959105e-02 3 1  ON 56
ci_008                -4.036338e-03 3 1  ON 57
ci_009                -1.502104e-02 3 1  ON 58
ci_010                -9.413480e-03 3 1  ON 59
ci_011                -9.734185e-03 3 1  ON 60
ci_012                -9.710919e-03 3 1  ON 61
ci_013                -2.165933e-02 3 1  ON 62
ci_014                 1.323541e-02 3 1  ON 63
ci_015                 1.288700e-02 3 1  ON 64
ci_016                 1.630303e-02 3 1  ON 65
ci_017                 1.619649e-02 3 1  ON 66
ci_018                 1.095418e-02 3 1  ON 67
ci_019                 1.071295e-02 3 1  ON 68
ci_020                 1.830659e-02 3 1  ON 69
ci_021                 1.805829e-02 3 1  ON 70
ci_022                 1.040014e-02 3 1  ON 71
ci_023                 1.006135e-02 3 1  ON 72
ci_024                 6.635336e-03 3 1  ON 73
ci_025                 6.635633e-03 3 1  ON 74
ci_026                 1.165867e-02 3 1  ON 75
ci_027                 1.157550e-02 3 1  ON 76
ci_028                -8.811171e-03 3 1  ON 77
ci_029                -9.821572e-03 3 1  ON 78
ci_030                -5.373017e-03 3 1  ON 79
ci_031                -4.550982e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.1389
    reference variance = 0.51977
====================================================
  Execution time = 1.9363e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9663e-01
  Total weights = 1.9736e+06
  Execution time = 1.5548e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289873737445
                                         uncertainty =       0.001824459463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289873737445
                                         uncertainty =       0.001824459463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380697474
  error estimate for blocks of size 2^( 2) =       0.000396026626
  error estimate for blocks of size 2^( 3) =       0.000409810451
  error estimate for blocks of size 2^( 4) =       0.000419518486
  error estimate for blocks of size 2^( 5) =       0.000426732795
  error estimate for blocks of size 2^( 6) =       0.000430432722
  error estimate for blocks of size 2^( 7) =       0.000432452216

      target function =      -0.918000121229
              le_mean =     -17.205546093130
             les_mean =     296.327454786671
             stat err =       0.000427284055
             autocorr =       1.259718135298
   target nu stat err =       0.000427284055
   target dn stat err =       0.002309004708
      target stat err =       0.003665647006
              std dev =       0.538387531159
             le_variance =       0.289861133708

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289872407231
                                         uncertainty =       0.001824488949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289872407231
                                         uncertainty =       0.001824488949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380696597
  error estimate for blocks of size 2^( 2) =       0.000396028452
  error estimate for blocks of size 2^( 3) =       0.000409813870
  error estimate for blocks of size 2^( 4) =       0.000419524124
  error estimate for blocks of size 2^( 5) =       0.000426738692
  error estimate for blocks of size 2^( 6) =       0.000430438008
  error estimate for blocks of size 2^( 7) =       0.000432458948

      target function =      -0.918049556894
              le_mean =     -17.205545844654
             les_mean =     296.327414485970
             stat err =       0.000427289943
             autocorr =       1.259758662998
   target nu stat err =       0.000427289943
   target dn stat err =       0.002307328222
      target stat err =       0.003663476511
              std dev =       0.538386290288
             le_variance =       0.289859797570

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289872944640
                                         uncertainty =       0.001824470269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289872944640
                                         uncertainty =       0.001824470269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380696952
  error estimate for blocks of size 2^( 2) =       0.000396027476
  error estimate for blocks of size 2^( 3) =       0.000409812104
  error estimate for blocks of size 2^( 4) =       0.000419521264
  error estimate for blocks of size 2^( 5) =       0.000426735703
  error estimate for blocks of size 2^( 6) =       0.000430435318
  error estimate for blocks of size 2^( 7) =       0.000432455543

      target function =      -0.918007218446
              le_mean =     -17.205545952109
             les_mean =     296.327445383722
             stat err =       0.000427286957
             autocorr =       1.259738706303
   target nu stat err =       0.000427286957
   target dn stat err =       0.002307802029
      target stat err =       0.003663867779
              std dev =       0.538386792181
             le_variance =       0.289860337995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289873624351
                                         uncertainty =       0.001824460333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289873624351
                                         uncertainty =       0.001824460333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380697400
  error estimate for blocks of size 2^( 2) =       0.000396026723
  error estimate for blocks of size 2^( 3) =       0.000409810651
  error estimate for blocks of size 2^( 4) =       0.000419518827
  error estimate for blocks of size 2^( 5) =       0.000426733153
  error estimate for blocks of size 2^( 6) =       0.000430433041
  error estimate for blocks of size 2^( 7) =       0.000432452626

      target function =      -0.918004799597
              le_mean =     -17.205546074455
             les_mean =     296.327451139618
             stat err =       0.000427284411
             autocorr =       1.259720731962
   target nu stat err =       0.000427284411
   target dn stat err =       0.002308785778
      target stat err =       0.003665349630
              std dev =       0.538387425801
             le_variance =       0.289861020261


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918000121229        initial
     3.7253e+00     3.7253e+01             1.3582e-04        -0.918049556894  <--
     1.4901e+01     1.4901e+02             3.3998e-05        -0.918007218446
     5.9605e+01     5.9605e+02             8.5021e-06        -0.918004799597

*****************************************************************************
Applying the update for shift_i =   3.7253e+00     and shift_s =   3.7253e+01
*****************************************************************************

  Execution time = 2.7208e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
  uu_0                 2.102188e-01 1 1  ON 0
  uu_1                 5.288202e-02 1 1  ON 1
  uu_2                -3.820334e-02 1 1  ON 2
  uu_3                -9.165919e-02 1 1  ON 3
  uu_4                -1.223144e-01 1 1  ON 4
  uu_5                -1.300974e-01 1 1  ON 5
  uu_6                -1.127377e-01 1 1  ON 6
  uu_7                -5.662028e-02 1 1  ON 7
  uu_8                 5.976469e-02 1 1  ON 8
  uu_9                 1.247495e-01 1 1  ON 9
  ud_0                 3.050269e-01 1 1  ON 10
  ud_1                 7.590754e-02 1 1  ON 11
  ud_2                -2.632577e-02 1 1  ON 12
  ud_3                -7.921780e-02 1 1  ON 13
  ud_4                -1.149010e-01 1 1  ON 14
  ud_5                -1.333742e-01 1 1  ON 15
  ud_6                -1.265560e-01 1 1  ON 16
  ud_7                -8.505345e-02 1 1  ON 17
  ud_8                -6.024243e-03 1 1  ON 18
  ud_9                 8.613390e-02 1 1  ON 19
  eO_0                -7.035017e-01 1 1  ON 20
  eO_1                -4.201051e-01 1 1  ON 21
  eO_2                -4.159980e-02 1 1  ON 22
  eO_3                 1.846066e-01 1 1  ON 23
  eO_4                 2.569664e-01 1 1  ON 24
  eO_5                 2.802456e-01 1 1  ON 25
  eO_6                 2.510304e-01 1 1  ON 26
  eO_7                 1.325120e-01 1 1  ON 27
  eO_8                 2.924137e-02 1 1  ON 28
  eO_9                 1.915652e-02 1 1  ON 29
 eH1_0                -2.017024e-01 1 1  ON 30
 eH1_1                -9.598160e-02 1 1  ON 31
 eH1_2                -4.468188e-02 1 1  ON 32
 eH1_3                -1.419986e-02 1 1  ON 33
 eH1_4                 1.842671e-02 1 1  ON 34
 eH1_5                 2.180827e-02 1 1  ON 35
 eH1_6                 7.084409e-02 1 1  ON 36
 eH1_7                 1.028570e-01 1 1  ON 37
 eH1_8                 1.006972e-01 1 1  ON 38
 eH1_9                 2.594850e-02 1 1  ON 39
 eH2_0                -2.032913e-01 1 1  ON 40
 eH2_1                -9.791960e-02 1 1  ON 41
 eH2_2                -4.655089e-02 1 1  ON 42
 eH2_3                -1.571395e-02 1 1  ON 43
 eH2_4                 1.626747e-02 1 1  ON 44
 eH2_5                 1.977897e-02 1 1  ON 45
 eH2_6                 7.241721e-02 1 1  ON 46
 eH2_7                 1.103080e-01 1 1  ON 47
 eH2_8                 1.031494e-01 1 1  ON 48
 eH2_9                 2.887480e-02 1 1  ON 49
ci_001                -4.204946e-02 3 1  ON 50
ci_002                -3.077502e-02 3 1  ON 51
ci_003                -1.127811e-02 3 1  ON 52
ci_004                 2.574766e-02 3 1  ON 53
ci_005                 2.584567e-02 3 1  ON 54
ci_006                -2.024051e-02 3 1  ON 55
ci_007                -1.959398e-02 3 1  ON 56
ci_008                -4.029797e-03 3 1  ON 57
ci_009                -1.504534e-02 3 1  ON 58
ci_010                -9.385426e-03 3 1  ON 59
ci_011                -9.749721e-03 3 1  ON 60
ci_012                -9.667617e-03 3 1  ON 61
ci_013                -2.168781e-02 3 1  ON 62
ci_014                 1.321271e-02 3 1  ON 63
ci_015                 1.290020e-02 3 1  ON 64
ci_016                 1.628800e-02 3 1  ON 65
ci_017                 1.617074e-02 3 1  ON 66
ci_018                 1.094157e-02 3 1  ON 67
ci_019                 1.072444e-02 3 1  ON 68
ci_020                 1.830478e-02 3 1  ON 69
ci_021                 1.806734e-02 3 1  ON 70
ci_022                 1.040306e-02 3 1  ON 71
ci_023                 1.004545e-02 3 1  ON 72
ci_024                 6.671096e-03 3 1  ON 73
ci_025                 6.630325e-03 3 1  ON 74
ci_026                 1.164375e-02 3 1  ON 75
ci_027                 1.157917e-02 3 1  ON 76
ci_028                -8.814171e-03 3 1  ON 77
ci_029                -9.871279e-03 3 1  ON 78
ci_030                -5.362285e-03 3 1  ON 79
ci_031                -4.571393e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2039e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7195e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.1746
    reference variance = 0.310866
====================================================
  Execution time = 1.9222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5396e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9822e-01
  Total weights = 1.973741705e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4721e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290702419343
                                         uncertainty =       0.001945909833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290702419343
                                         uncertainty =       0.001945909833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381279453
  error estimate for blocks of size 2^( 2) =       0.000396698874
  error estimate for blocks of size 2^( 3) =       0.000410403607
  error estimate for blocks of size 2^( 4) =       0.000420755988
  error estimate for blocks of size 2^( 5) =       0.000426420372
  error estimate for blocks of size 2^( 6) =       0.000429529848
  error estimate for blocks of size 2^( 7) =       0.000432960013

      target function =      -0.915526042078
              le_mean =     -17.206649957904
             les_mean =     296.367022005712
             stat err =       0.000427416555
             autocorr =       1.256654455679
   target nu stat err =       0.000427416555
   target dn stat err =       0.002538918206
      target stat err =       0.004003958122
              std dev =       0.539210573780
             le_variance =       0.290748042876


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720664995790e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915542390179       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915559296443       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915565411876       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915566781285       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915567097477       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915567146409       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915567471101       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915567755063       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915567701034       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915567450791       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915567583738       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915567771749       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915567724803       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915567827567       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915567827663       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915567787956       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915567866770       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915567923183       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915567963906       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915567956722       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915568097383       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915568153112       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915568188936       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915568164206       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915568177039       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915568136177       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915568154960       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915568160476       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915568149016       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915568114642       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915568114835       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915568124760       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915568126734       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915568125364       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.3132e-01 is 2.971589e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915542390179       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915546862460       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915548477425       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915548837080       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915548916139       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915548928165       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915549013751       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915549085835       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915549073586       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915549006186       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915549040628       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915549089250       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915549076838       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915549101631       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915549102340       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915549092047       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915549113395       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915549127010       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915549136446       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915549134843       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915549171227       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915549183852       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915549191332       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915549185191       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915549187849       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915549177972       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915549183275       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915549183400       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915549180204       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915549171949       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915549173116       residual = 8.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915549175401       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915549175779       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915549175454       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.7253e+00 is 7.455404e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915542390179       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915543524738       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915543934248       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915544025321       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915544045069       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915544048061       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915544069753       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915544087834       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915544084853       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915544067683       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915544076378       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915544088638       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915544085490       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915544091628       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915544091849       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915544089256       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915544094703       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915544098063       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915544100373       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915544099994       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915544109160       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915544112224       residual = 9.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915544114001       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915544112471       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915544113101       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915544110659       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915544112018       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915544111962       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915544111152       residual = 9.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915544109121       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915544109480       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915544110033       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915544110121       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915544110042       residual = 7.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4901e+01 is 1.865480e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.583992 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4742e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
  uu_0                 2.102339e-01 1 1  ON 0
  uu_1                 5.288900e-02 1 1  ON 1
  uu_2                -3.819314e-02 1 1  ON 2
  uu_3                -9.165188e-02 1 1  ON 3
  uu_4                -1.223131e-01 1 1  ON 4
  uu_5                -1.300952e-01 1 1  ON 5
  uu_6                -1.127390e-01 1 1  ON 6
  uu_7                -5.666248e-02 1 1  ON 7
  uu_8                 5.971428e-02 1 1  ON 8
  uu_9                 1.247682e-01 1 1  ON 9
  ud_0                 3.049963e-01 1 1  ON 10
  ud_1                 7.587144e-02 1 1  ON 11
  ud_2                -2.634409e-02 1 1  ON 12
  ud_3                -7.922994e-02 1 1  ON 13
  ud_4                -1.149186e-01 1 1  ON 14
  ud_5                -1.333808e-01 1 1  ON 15
  ud_6                -1.265678e-01 1 1  ON 16
  ud_7                -8.498452e-02 1 1  ON 17
  ud_8                -5.993969e-03 1 1  ON 18
  ud_9                 8.614330e-02 1 1  ON 19
  eO_0                -7.035249e-01 1 1  ON 20
  eO_1                -4.201403e-01 1 1  ON 21
  eO_2                -4.162515e-02 1 1  ON 22
  eO_3                 1.845963e-01 1 1  ON 23
  eO_4                 2.569860e-01 1 1  ON 24
  eO_5                 2.802503e-01 1 1  ON 25
  eO_6                 2.510104e-01 1 1  ON 26
  eO_7                 1.325866e-01 1 1  ON 27
  eO_8                 2.925272e-02 1 1  ON 28
  eO_9                 1.916009e-02 1 1  ON 29
 eH1_0                -2.016821e-01 1 1  ON 30
 eH1_1                -9.595491e-02 1 1  ON 31
 eH1_2                -4.466470e-02 1 1  ON 32
 eH1_3                -1.418145e-02 1 1  ON 33
 eH1_4                 1.841205e-02 1 1  ON 34
 eH1_5                 2.174820e-02 1 1  ON 35
 eH1_6                 7.082022e-02 1 1  ON 36
 eH1_7                 1.028444e-01 1 1  ON 37
 eH1_8                 1.007236e-01 1 1  ON 38
 eH1_9                 2.594881e-02 1 1  ON 39
 eH2_0                -2.033205e-01 1 1  ON 40
 eH2_1                -9.794528e-02 1 1  ON 41
 eH2_2                -4.656994e-02 1 1  ON 42
 eH2_3                -1.572775e-02 1 1  ON 43
 eH2_4                 1.626857e-02 1 1  ON 44
 eH2_5                 1.981742e-02 1 1  ON 45
 eH2_6                 7.241647e-02 1 1  ON 46
 eH2_7                 1.103089e-01 1 1  ON 47
 eH2_8                 1.031863e-01 1 1  ON 48
 eH2_9                 2.888505e-02 1 1  ON 49
ci_001                -4.203624e-02 3 1  ON 50
ci_002                -3.079545e-02 3 1  ON 51
ci_003                -1.125706e-02 3 1  ON 52
ci_004                 2.574638e-02 3 1  ON 53
ci_005                 2.585330e-02 3 1  ON 54
ci_006                -2.025030e-02 3 1  ON 55
ci_007                -1.960369e-02 3 1  ON 56
ci_008                -4.043092e-03 3 1  ON 57
ci_009                -1.504006e-02 3 1  ON 58
ci_010                -9.413133e-03 3 1  ON 59
ci_011                -9.732329e-03 3 1  ON 60
ci_012                -9.677884e-03 3 1  ON 61
ci_013                -2.169478e-02 3 1  ON 62
ci_014                 1.321796e-02 3 1  ON 63
ci_015                 1.291283e-02 3 1  ON 64
ci_016                 1.628496e-02 3 1  ON 65
ci_017                 1.616575e-02 3 1  ON 66
ci_018                 1.093212e-02 3 1  ON 67
ci_019                 1.072277e-02 3 1  ON 68
ci_020                 1.831326e-02 3 1  ON 69
ci_021                 1.807768e-02 3 1  ON 70
ci_022                 1.041038e-02 3 1  ON 71
ci_023                 1.003396e-02 3 1  ON 72
ci_024                 6.644516e-03 3 1  ON 73
ci_025                 6.641507e-03 3 1  ON 74
ci_026                 1.166155e-02 3 1  ON 75
ci_027                 1.156275e-02 3 1  ON 76
ci_028                -8.827390e-03 3 1  ON 77
ci_029                -9.841390e-03 3 1  ON 78
ci_030                -5.334854e-03 3 1  ON 79
ci_031                -4.570098e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2502
    reference variance = 0.262232
====================================================
  Execution time = 1.8996e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0058e-01
  Total weights = 1.9737e+06
  Execution time = 1.5561e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291247573880
                                         uncertainty =       0.002255738321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291247573880
                                         uncertainty =       0.002255738321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381652623
  error estimate for blocks of size 2^( 2) =       0.000396856013
  error estimate for blocks of size 2^( 3) =       0.000410375927
  error estimate for blocks of size 2^( 4) =       0.000421019546
  error estimate for blocks of size 2^( 5) =       0.000427708401
  error estimate for blocks of size 2^( 6) =       0.000430507175
  error estimate for blocks of size 2^( 7) =       0.000431459505

      target function =      -0.912058596895
              le_mean =     -17.205938452850
             les_mean =     296.344787090666
             stat err =       0.000427673657
             autocorr =       1.255707523549
   target nu stat err =       0.000427673657
   target dn stat err =       0.003040508535
      target stat err =       0.004729407784
              std dev =       0.539738316108
             le_variance =       0.291317449875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291211317546
                                         uncertainty =       0.002250427118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291211317546
                                         uncertainty =       0.002250427118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381629899
  error estimate for blocks of size 2^( 2) =       0.000396835232
  error estimate for blocks of size 2^( 3) =       0.000410354721
  error estimate for blocks of size 2^( 4) =       0.000420998062
  error estimate for blocks of size 2^( 5) =       0.000427682768
  error estimate for blocks of size 2^( 6) =       0.000430479731
  error estimate for blocks of size 2^( 7) =       0.000431436497

      target function =      -0.911158045610
              le_mean =     -17.205938548029
             les_mean =     296.345374571425
             stat err =       0.000427649265
             autocorr =       1.255713820544
   target nu stat err =       0.000427649265
   target dn stat err =       0.003248407631
      target stat err =       0.005035666605
              std dev =       0.539706179251
             le_variance =       0.291282759922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291227910903
                                         uncertainty =       0.002252930648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291227910903
                                         uncertainty =       0.002252930648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381640280
  error estimate for blocks of size 2^( 2) =       0.000396844700
  error estimate for blocks of size 2^( 3) =       0.000410364398
  error estimate for blocks of size 2^( 4) =       0.000421007860
  error estimate for blocks of size 2^( 5) =       0.000427694604
  error estimate for blocks of size 2^( 6) =       0.000430492409
  error estimate for blocks of size 2^( 7) =       0.000431446998

      target function =      -0.911686508354
              le_mean =     -17.205938439128
             les_mean =     296.345027937057
             stat err =       0.000427660468
             autocorr =       1.255711296100
   target nu stat err =       0.000427660468
   target dn stat err =       0.003120696595
      target stat err =       0.004847365773
              std dev =       0.539720860585
             le_variance =       0.291298607350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291245014147
                                         uncertainty =       0.002255381838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291245014147
                                         uncertainty =       0.002255381838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381651014
  error estimate for blocks of size 2^( 2) =       0.000396854536
  error estimate for blocks of size 2^( 3) =       0.000410374415
  error estimate for blocks of size 2^( 4) =       0.000421018015
  error estimate for blocks of size 2^( 5) =       0.000427706603
  error estimate for blocks of size 2^( 6) =       0.000430505250
  error estimate for blocks of size 2^( 7) =       0.000431457878

      target function =      -0.911997109167
              le_mean =     -17.205938445853
             les_mean =     296.344826771356
             stat err =       0.000427671936
             autocorr =       1.255708008023
   target nu stat err =       0.000427671936
   target dn stat err =       0.003048360240
      target stat err =       0.004740705721
              std dev =       0.539736040675
             le_variance =       0.291314993604


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912058596895        initial  <--
     9.3132e-01     9.3132e+00             2.9716e-04        -0.911158045610
     3.7253e+00     3.7253e+01             7.4554e-05        -0.911686508354
     1.4901e+01     1.4901e+02             1.8655e-05        -0.911997109167

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.8463
  </log>
  <optVariables href="H2O.s042.opt.xml">
  uu_0                 2.102188e-01 1 1  ON 0
  uu_1                 5.288202e-02 1 1  ON 1
  uu_2                -3.820334e-02 1 1  ON 2
  uu_3                -9.165919e-02 1 1  ON 3
  uu_4                -1.223144e-01 1 1  ON 4
  uu_5                -1.300974e-01 1 1  ON 5
  uu_6                -1.127377e-01 1 1  ON 6
  uu_7                -5.662028e-02 1 1  ON 7
  uu_8                 5.976469e-02 1 1  ON 8
  uu_9                 1.247495e-01 1 1  ON 9
  ud_0                 3.050269e-01 1 1  ON 10
  ud_1                 7.590754e-02 1 1  ON 11
  ud_2                -2.632577e-02 1 1  ON 12
  ud_3                -7.921780e-02 1 1  ON 13
  ud_4                -1.149010e-01 1 1  ON 14
  ud_5                -1.333742e-01 1 1  ON 15
  ud_6                -1.265560e-01 1 1  ON 16
  ud_7                -8.505345e-02 1 1  ON 17
  ud_8                -6.024243e-03 1 1  ON 18
  ud_9                 8.613390e-02 1 1  ON 19
  eO_0                -7.035017e-01 1 1  ON 20
  eO_1                -4.201051e-01 1 1  ON 21
  eO_2                -4.159980e-02 1 1  ON 22
  eO_3                 1.846066e-01 1 1  ON 23
  eO_4                 2.569664e-01 1 1  ON 24
  eO_5                 2.802456e-01 1 1  ON 25
  eO_6                 2.510304e-01 1 1  ON 26
  eO_7                 1.325120e-01 1 1  ON 27
  eO_8                 2.924137e-02 1 1  ON 28
  eO_9                 1.915652e-02 1 1  ON 29
 eH1_0                -2.017024e-01 1 1  ON 30
 eH1_1                -9.598160e-02 1 1  ON 31
 eH1_2                -4.468188e-02 1 1  ON 32
 eH1_3                -1.419986e-02 1 1  ON 33
 eH1_4                 1.842671e-02 1 1  ON 34
 eH1_5                 2.180827e-02 1 1  ON 35
 eH1_6                 7.084409e-02 1 1  ON 36
 eH1_7                 1.028570e-01 1 1  ON 37
 eH1_8                 1.006972e-01 1 1  ON 38
 eH1_9                 2.594850e-02 1 1  ON 39
 eH2_0                -2.032913e-01 1 1  ON 40
 eH2_1                -9.791960e-02 1 1  ON 41
 eH2_2                -4.655089e-02 1 1  ON 42
 eH2_3                -1.571395e-02 1 1  ON 43
 eH2_4                 1.626747e-02 1 1  ON 44
 eH2_5                 1.977897e-02 1 1  ON 45
 eH2_6                 7.241721e-02 1 1  ON 46
 eH2_7                 1.103080e-01 1 1  ON 47
 eH2_8                 1.031494e-01 1 1  ON 48
 eH2_9                 2.887480e-02 1 1  ON 49
ci_001                -4.204946e-02 3 1  ON 50
ci_002                -3.077502e-02 3 1  ON 51
ci_003                -1.127811e-02 3 1  ON 52
ci_004                 2.574766e-02 3 1  ON 53
ci_005                 2.584567e-02 3 1  ON 54
ci_006                -2.024051e-02 3 1  ON 55
ci_007                -1.959398e-02 3 1  ON 56
ci_008                -4.029797e-03 3 1  ON 57
ci_009                -1.504534e-02 3 1  ON 58
ci_010                -9.385426e-03 3 1  ON 59
ci_011                -9.749721e-03 3 1  ON 60
ci_012                -9.667617e-03 3 1  ON 61
ci_013                -2.168781e-02 3 1  ON 62
ci_014                 1.321271e-02 3 1  ON 63
ci_015                 1.290020e-02 3 1  ON 64
ci_016                 1.628800e-02 3 1  ON 65
ci_017                 1.617074e-02 3 1  ON 66
ci_018                 1.094157e-02 3 1  ON 67
ci_019                 1.072444e-02 3 1  ON 68
ci_020                 1.830478e-02 3 1  ON 69
ci_021                 1.806734e-02 3 1  ON 70
ci_022                 1.040306e-02 3 1  ON 71
ci_023                 1.004545e-02 3 1  ON 72
ci_024                 6.671096e-03 3 1  ON 73
ci_025                 6.630325e-03 3 1  ON 74
ci_026                 1.164375e-02 3 1  ON 75
ci_027                 1.157917e-02 3 1  ON 76
ci_028                -8.814171e-03 3 1  ON 77
ci_029                -9.871279e-03 3 1  ON 78
ci_030                -5.362285e-03 3 1  ON 79
ci_031                -4.571393e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1594e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7195e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.216
    reference variance = 0.157481
====================================================
  Execution time = 1.9161e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5410e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0013e-01
  Total weights = 1.973752171e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6984e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291562505332
                                         uncertainty =       0.001689175457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291562505332
                                         uncertainty =       0.001689175457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381808079
  error estimate for blocks of size 2^( 2) =       0.000397085625
  error estimate for blocks of size 2^( 3) =       0.000411246124
  error estimate for blocks of size 2^( 4) =       0.000421365428
  error estimate for blocks of size 2^( 5) =       0.000428903442
  error estimate for blocks of size 2^( 6) =       0.000432872711
  error estimate for blocks of size 2^( 7) =       0.000433625670

      target function =      -0.912576248680
              le_mean =     -17.206414951034
             les_mean =     296.360842589876
             stat err =       0.000429191813
             autocorr =       1.263608768859
   target nu stat err =       0.000429191813
   target dn stat err =       0.002918339578
      target stat err =       0.004553383782
              std dev =       0.539958163172
             le_variance =       0.291554817976


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720641495103e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912597998789       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912602532340       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912603925438       residual = 7.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912604114355       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912604249062       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912604334764       residual = 7.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912604351237       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912604398330       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912604416975       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912604437573       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912604426513       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912604418822       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912604422217       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912604441654       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912604456055       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912604482144       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912604492862       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912604517160       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912604521175       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912604532364       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912604528525       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912604528843       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912604533627       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912604531135       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912604527619       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912604527979       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912604528505       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912604528088       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912604530345       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912604529037       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912604527464       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912604526274       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912604523754       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912604524870       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912604524840       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912604525626       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.3132e+00 is 3.822003e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912597998789       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912599139381       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912599489199       residual = 7.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912599536658       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912599570516       residual = 7.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912599592055       residual = 7.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912599596166       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912599607998       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912599612655       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912599617818       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912599615038       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912599613104       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912599613968       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912599618852       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912599622446       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912599628979       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912599631670       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912599637736       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912599638741       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912599641512       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912599640525       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912599640623       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912599641816       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912599641180       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912599640301       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912599640392       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912599640523       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912599640421       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912599640976       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912599640650       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912599640260       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912599639957       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912599639333       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912599639619       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912599639609       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912599639804       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.7253e+01 is 9.561102e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912597998789       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912598284391       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912598371942       residual = 7.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912598383821       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912598392297       residual = 7.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912598397689       residual = 7.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912598398716       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912598401678       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912598402842       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912598404134       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912598403438       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912598402953       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912598403171       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912598404393       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912598405291       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912598406925       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912598407599       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912598409114       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912598409366       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912598410057       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912598409809       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912598409834       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912598410132       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912598409972       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912598409752       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912598409776       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912598409809       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912598409783       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912598409921       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912598409839       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912598409742       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912598409666       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912598409511       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912598409583       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912598409579       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912598409628       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4901e+02 is 2.390657e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.633699 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4916e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
  uu_0                 2.102183e-01 1 1  ON 0
  uu_1                 5.288320e-02 1 1  ON 1
  uu_2                -3.820094e-02 1 1  ON 2
  uu_3                -9.165635e-02 1 1  ON 3
  uu_4                -1.223127e-01 1 1  ON 4
  uu_5                -1.300969e-01 1 1  ON 5
  uu_6                -1.127393e-01 1 1  ON 6
  uu_7                -5.662233e-02 1 1  ON 7
  uu_8                 5.975513e-02 1 1  ON 8
  uu_9                 1.247501e-01 1 1  ON 9
  ud_0                 3.050243e-01 1 1  ON 10
  ud_1                 7.590382e-02 1 1  ON 11
  ud_2                -2.632766e-02 1 1  ON 12
  ud_3                -7.921914e-02 1 1  ON 13
  ud_4                -1.149016e-01 1 1  ON 14
  ud_5                -1.333715e-01 1 1  ON 15
  ud_6                -1.265531e-01 1 1  ON 16
  ud_7                -8.505014e-02 1 1  ON 17
  ud_8                -6.024589e-03 1 1  ON 18
  ud_9                 8.613052e-02 1 1  ON 19
  eO_0                -7.034987e-01 1 1  ON 20
  eO_1                -4.201064e-01 1 1  ON 21
  eO_2                -4.160423e-02 1 1  ON 22
  eO_3                 1.846016e-01 1 1  ON 23
  eO_4                 2.569685e-01 1 1  ON 24
  eO_5                 2.802421e-01 1 1  ON 25
  eO_6                 2.510319e-01 1 1  ON 26
  eO_7                 1.325186e-01 1 1  ON 27
  eO_8                 2.924190e-02 1 1  ON 28
  eO_9                 1.915654e-02 1 1  ON 29
 eH1_0                -2.016971e-01 1 1  ON 30
 eH1_1                -9.598216e-02 1 1  ON 31
 eH1_2                -4.468232e-02 1 1  ON 32
 eH1_3                -1.419964e-02 1 1  ON 33
 eH1_4                 1.842379e-02 1 1  ON 34
 eH1_5                 2.180477e-02 1 1  ON 35
 eH1_6                 7.084384e-02 1 1  ON 36
 eH1_7                 1.028547e-01 1 1  ON 37
 eH1_8                 1.007003e-01 1 1  ON 38
 eH1_9                 2.594965e-02 1 1  ON 39
 eH2_0                -2.032913e-01 1 1  ON 40
 eH2_1                -9.791579e-02 1 1  ON 41
 eH2_2                -4.654931e-02 1 1  ON 42
 eH2_3                -1.571116e-02 1 1  ON 43
 eH2_4                 1.627054e-02 1 1  ON 44
 eH2_5                 1.977578e-02 1 1  ON 45
 eH2_6                 7.241022e-02 1 1  ON 46
 eH2_7                 1.103034e-01 1 1  ON 47
 eH2_8                 1.031513e-01 1 1  ON 48
 eH2_9                 2.887655e-02 1 1  ON 49
ci_001                -4.204875e-02 3 1  ON 50
ci_002                -3.077291e-02 3 1  ON 51
ci_003                -1.127639e-02 3 1  ON 52
ci_004                 2.574531e-02 3 1  ON 53
ci_005                 2.584543e-02 3 1  ON 54
ci_006                -2.024241e-02 3 1  ON 55
ci_007                -1.959400e-02 3 1  ON 56
ci_008                -4.033990e-03 3 1  ON 57
ci_009                -1.504568e-02 3 1  ON 58
ci_010                -9.382555e-03 3 1  ON 59
ci_011                -9.745589e-03 3 1  ON 60
ci_012                -9.663812e-03 3 1  ON 61
ci_013                -2.168602e-02 3 1  ON 62
ci_014                 1.321139e-02 3 1  ON 63
ci_015                 1.290356e-02 3 1  ON 64
ci_016                 1.628955e-02 3 1  ON 65
ci_017                 1.617115e-02 3 1  ON 66
ci_018                 1.094163e-02 3 1  ON 67
ci_019                 1.072532e-02 3 1  ON 68
ci_020                 1.830508e-02 3 1  ON 69
ci_021                 1.806492e-02 3 1  ON 70
ci_022                 1.039975e-02 3 1  ON 71
ci_023                 1.004436e-02 3 1  ON 72
ci_024                 6.670968e-03 3 1  ON 73
ci_025                 6.633100e-03 3 1  ON 74
ci_026                 1.164341e-02 3 1  ON 75
ci_027                 1.158035e-02 3 1  ON 76
ci_028                -8.819416e-03 3 1  ON 77
ci_029                -9.870773e-03 3 1  ON 78
ci_030                -5.362705e-03 3 1  ON 79
ci_031                -4.571034e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2154
    reference variance = 0.186594
====================================================
  Execution time = 1.8979e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0164e-01
  Total weights = 1.9735e+06
  Execution time = 1.5632e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291641753119
                                         uncertainty =       0.002049332510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291641753119
                                         uncertainty =       0.002049332510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381942061
  error estimate for blocks of size 2^( 2) =       0.000397285241
  error estimate for blocks of size 2^( 3) =       0.000411658247
  error estimate for blocks of size 2^( 4) =       0.000421944521
  error estimate for blocks of size 2^( 5) =       0.000428382296
  error estimate for blocks of size 2^( 6) =       0.000432097703
  error estimate for blocks of size 2^( 7) =       0.000434245642

      target function =      -0.910265191682
              le_mean =     -17.205910791354
             les_mean =     296.345005491194
             stat err =       0.000429167540
             autocorr =       1.262579578036
   target nu stat err =       0.000429167540
   target dn stat err =       0.002974134037
      target stat err =       0.004610774791
              std dev =       0.540147642256
             le_variance =       0.291759475435

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291634392766
                                         uncertainty =       0.002048810646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291634392766
                                         uncertainty =       0.002048810646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381937236
  error estimate for blocks of size 2^( 2) =       0.000397281036
  error estimate for blocks of size 2^( 3) =       0.000411655126
  error estimate for blocks of size 2^( 4) =       0.000421941884
  error estimate for blocks of size 2^( 5) =       0.000428380409
  error estimate for blocks of size 2^( 6) =       0.000432095927
  error estimate for blocks of size 2^( 7) =       0.000434243785

      target function =      -0.910275016660
              le_mean =     -17.205910653032
             les_mean =     296.344994335816
             stat err =       0.000429165501
             autocorr =       1.262599481226
   target nu stat err =       0.000429165501
   target dn stat err =       0.002972211885
      target stat err =       0.004607964358
              std dev =       0.540140818563
             le_variance =       0.291752103878

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291638038620
                                         uncertainty =       0.002049069742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291638038620
                                         uncertainty =       0.002049069742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381939626
  error estimate for blocks of size 2^( 2) =       0.000397283117
  error estimate for blocks of size 2^( 3) =       0.000411656668
  error estimate for blocks of size 2^( 4) =       0.000421943184
  error estimate for blocks of size 2^( 5) =       0.000428381336
  error estimate for blocks of size 2^( 6) =       0.000432096799
  error estimate for blocks of size 2^( 7) =       0.000434244696

      target function =      -0.910270683025
              le_mean =     -17.205910720491
             les_mean =     296.344999476993
             stat err =       0.000429166504
             autocorr =       1.262589579206
   target nu stat err =       0.000429166504
   target dn stat err =       0.002973161277
      target stat err =       0.004609357685
              std dev =       0.540144198601
             le_variance =       0.291755755282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291641286628
                                         uncertainty =       0.002049299566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291641286628
                                         uncertainty =       0.002049299566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381941755
  error estimate for blocks of size 2^( 2) =       0.000397284974
  error estimate for blocks of size 2^( 3) =       0.000411658049
  error estimate for blocks of size 2^( 4) =       0.000421944352
  error estimate for blocks of size 2^( 5) =       0.000428382175
  error estimate for blocks of size 2^( 6) =       0.000432097589
  error estimate for blocks of size 2^( 7) =       0.000434245522

      target function =      -0.910265930333
              le_mean =     -17.205910782335
             les_mean =     296.345004699760
             stat err =       0.000429167410
             autocorr =       1.262580830326
   target nu stat err =       0.000429167410
   target dn stat err =       0.002974011581
      target stat err =       0.004610596874
              std dev =       0.540147209782
             le_variance =       0.291759008235


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910265191682        initial
     9.3132e+00     9.3132e+01             3.8220e-05        -0.910275016660  <--
     3.7253e+01     3.7253e+02             9.5611e-06        -0.910270683025
     1.4901e+02     1.4901e+03             2.3907e-06        -0.910265930333

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 2.6899e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
  uu_0                 2.102168e-01 1 1  ON 0
  uu_1                 5.288672e-02 1 1  ON 1
  uu_2                -3.819377e-02 1 1  ON 2
  uu_3                -9.164788e-02 1 1  ON 3
  uu_4                -1.223076e-01 1 1  ON 4
  uu_5                -1.300955e-01 1 1  ON 5
  uu_6                -1.127442e-01 1 1  ON 6
  uu_7                -5.662848e-02 1 1  ON 7
  uu_8                 5.972647e-02 1 1  ON 8
  uu_9                 1.247517e-01 1 1  ON 9
  ud_0                 3.050168e-01 1 1  ON 10
  ud_1                 7.589272e-02 1 1  ON 11
  ud_2                -2.633333e-02 1 1  ON 12
  ud_3                -7.922314e-02 1 1  ON 13
  ud_4                -1.149033e-01 1 1  ON 14
  ud_5                -1.333632e-01 1 1  ON 15
  ud_6                -1.265445e-01 1 1  ON 16
  ud_7                -8.504022e-02 1 1  ON 17
  ud_8                -6.025614e-03 1 1  ON 18
  ud_9                 8.612039e-02 1 1  ON 19
  eO_0                -7.034896e-01 1 1  ON 20
  eO_1                -4.201103e-01 1 1  ON 21
  eO_2                -4.161747e-02 1 1  ON 22
  eO_3                 1.845867e-01 1 1  ON 23
  eO_4                 2.569749e-01 1 1  ON 24
  eO_5                 2.802316e-01 1 1  ON 25
  eO_6                 2.510366e-01 1 1  ON 26
  eO_7                 1.325384e-01 1 1  ON 27
  eO_8                 2.924348e-02 1 1  ON 28
  eO_9                 1.915660e-02 1 1  ON 29
 eH1_0                -2.016812e-01 1 1  ON 30
 eH1_1                -9.598383e-02 1 1  ON 31
 eH1_2                -4.468361e-02 1 1  ON 32
 eH1_3                -1.419895e-02 1 1  ON 33
 eH1_4                 1.841506e-02 1 1  ON 34
 eH1_5                 2.179430e-02 1 1  ON 35
 eH1_6                 7.084307e-02 1 1  ON 36
 eH1_7                 1.028476e-01 1 1  ON 37
 eH1_8                 1.007096e-01 1 1  ON 38
 eH1_9                 2.595310e-02 1 1  ON 39
 eH2_0                -2.032915e-01 1 1  ON 40
 eH2_1                -9.790442e-02 1 1  ON 41
 eH2_2                -4.654455e-02 1 1  ON 42
 eH2_3                -1.570284e-02 1 1  ON 43
 eH2_4                 1.627973e-02 1 1  ON 44
 eH2_5                 1.976623e-02 1 1  ON 45
 eH2_6                 7.238925e-02 1 1  ON 46
 eH2_7                 1.102893e-01 1 1  ON 47
 eH2_8                 1.031571e-01 1 1  ON 48
 eH2_9                 2.888177e-02 1 1  ON 49
ci_001                -4.204663e-02 3 1  ON 50
ci_002                -3.076662e-02 3 1  ON 51
ci_003                -1.127128e-02 3 1  ON 52
ci_004                 2.573831e-02 3 1  ON 53
ci_005                 2.584471e-02 3 1  ON 54
ci_006                -2.024807e-02 3 1  ON 55
ci_007                -1.959407e-02 3 1  ON 56
ci_008                -4.046460e-03 3 1  ON 57
ci_009                -1.504668e-02 3 1  ON 58
ci_010                -9.374008e-03 3 1  ON 59
ci_011                -9.733286e-03 3 1  ON 60
ci_012                -9.652487e-03 3 1  ON 61
ci_013                -2.168070e-02 3 1  ON 62
ci_014                 1.320746e-02 3 1  ON 63
ci_015                 1.291357e-02 3 1  ON 64
ci_016                 1.629417e-02 3 1  ON 65
ci_017                 1.617238e-02 3 1  ON 66
ci_018                 1.094183e-02 3 1  ON 67
ci_019                 1.072796e-02 3 1  ON 68
ci_020                 1.830599e-02 3 1  ON 69
ci_021                 1.805773e-02 3 1  ON 70
ci_022                 1.038988e-02 3 1  ON 71
ci_023                 1.004110e-02 3 1  ON 72
ci_024                 6.670585e-03 3 1  ON 73
ci_025                 6.641369e-03 3 1  ON 74
ci_026                 1.164241e-02 3 1  ON 75
ci_027                 1.158386e-02 3 1  ON 76
ci_028                -8.835041e-03 3 1  ON 77
ci_029                -9.869268e-03 3 1  ON 78
ci_030                -5.363953e-03 3 1  ON 79
ci_031                -4.569968e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1822e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7196e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.2563
    reference variance = 0.21415
====================================================
  Execution time = 1.9255e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5431e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.1507e-01
  Total weights = 1.973772853e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0353e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289705138314
                                         uncertainty =       0.002401643668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289705138314
                                         uncertainty =       0.002401643668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380568494
  error estimate for blocks of size 2^( 2) =       0.000395712559
  error estimate for blocks of size 2^( 3) =       0.000409619357
  error estimate for blocks of size 2^( 4) =       0.000420317392
  error estimate for blocks of size 2^( 5) =       0.000425540953
  error estimate for blocks of size 2^( 6) =       0.000425930432
  error estimate for blocks of size 2^( 7) =       0.000426073678

      target function =      -0.889197893478
              le_mean =     -17.206594200870
             les_mean =     296.381949382959
             stat err =       0.000424465614
             autocorr =       1.243997091000
   target nu stat err =       0.000424465614
   target dn stat err =       0.019774702536
      target stat err =       0.028968106955
              std dev =       0.538205125016
             le_variance =       0.289664756594


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720659420087e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.890141513298       residual = 6.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.890250501864       residual = 2.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.890296508848       residual = 5.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.890311128704       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.890313201421       residual = 7.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.890315830465       residual = 5.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.890316528331       residual = 5.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.890317623230       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.890318829584       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.890319339948       residual = 9.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.890319646208       residual = 5.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.890319730563       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.890319936667       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.890320293481       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.890320477140       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.890320520041       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.890320668288       residual = 9.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.890320810135       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.890320833001       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.890320844115       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.890320902045       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.890320963795       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.890320916063       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.890320915318       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.890320990414       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.890321003354       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.890321042639       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.890321049875       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.890321031718       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.890321022050       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.890321035438       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.890321035823       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.890321030766       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.890321023521       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.890321025945       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.890321022105       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.890321027607       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.890321027272       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.890321025788       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.890321027351       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.890321029669       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3283e+00 is 3.283546e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.890141513298       residual = 6.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.890169374080       residual = 2.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.890181126095       residual = 5.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.890184858003       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.890185385859       residual = 7.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.890186052649       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.890186216073       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.890186501104       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.890186816251       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.890186944540       residual = 9.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.890187022520       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.890187042981       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.890187093323       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.890187183337       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.890187229159       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.890187239826       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.890187277115       residual = 9.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.890187312369       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.890187317232       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.890187320202       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.890187335402       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.890187349980       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.890187337869       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.890187337759       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.890187356542       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.890187359819       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.890187368691       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.890187370294       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.890187365915       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.890187363937       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.890187367348       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.890187367016       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.890187365635       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.890187364167       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.890187364788       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.890187363678       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.890187364966       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.890187364909       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.890187364672       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.890187365018       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.890187365540       residual = 8.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.3132e+00 is 8.340662e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.890141513298       residual = 6.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.890148517926       residual = 2.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.890151472001       residual = 5.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.890152409910       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.890152542522       residual = 7.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.890152709729       residual = 5.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.890152750260       residual = 5.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.890152822123       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.890152901596       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.890152933730       residual = 9.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.890152953309       residual = 5.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.890152958382       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.890152970892       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.890152993447       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.890153004894       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.890153007559       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.890153016896       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.890153025693       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.890153026854       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.890153027611       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.890153031456       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.890153035044       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.890153032006       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.890153031985       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.890153036683       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.890153037501       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.890153039657       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.890153040047       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.890153038964       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.890153038499       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.890153039353       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.890153039242       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.890153038891       residual = 9.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.890153038547       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.890153038702       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.890153038414       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.890153038731       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.890153038718       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.890153038668       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.890153038751       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.890153038877       residual = 7.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.7253e+01 is 2.093620e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.705134 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5368e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
  uu_0                 2.101396e-01 1 1  ON 0
  uu_1                 5.289315e-02 1 1  ON 1
  uu_2                -3.819851e-02 1 1  ON 2
  uu_3                -9.163449e-02 1 1  ON 3
  uu_4                -1.222848e-01 1 1  ON 4
  uu_5                -1.300602e-01 1 1  ON 5
  uu_6                -1.127232e-01 1 1  ON 6
  uu_7                -5.662674e-02 1 1  ON 7
  uu_8                 5.969066e-02 1 1  ON 8
  uu_9                 1.247517e-01 1 1  ON 9
  ud_0                 3.050270e-01 1 1  ON 10
  ud_1                 7.591603e-02 1 1  ON 11
  ud_2                -2.631293e-02 1 1  ON 12
  ud_3                -7.922542e-02 1 1  ON 13
  ud_4                -1.149146e-01 1 1  ON 14
  ud_5                -1.333790e-01 1 1  ON 15
  ud_6                -1.265642e-01 1 1  ON 16
  ud_7                -8.503423e-02 1 1  ON 17
  ud_8                -6.032648e-03 1 1  ON 18
  ud_9                 8.610574e-02 1 1  ON 19
  eO_0                -7.035067e-01 1 1  ON 20
  eO_1                -4.201289e-01 1 1  ON 21
  eO_2                -4.159382e-02 1 1  ON 22
  eO_3                 1.846115e-01 1 1  ON 23
  eO_4                 2.569626e-01 1 1  ON 24
  eO_5                 2.802216e-01 1 1  ON 25
  eO_6                 2.510201e-01 1 1  ON 26
  eO_7                 1.325610e-01 1 1  ON 27
  eO_8                 2.924527e-02 1 1  ON 28
  eO_9                 1.915713e-02 1 1  ON 29
 eH1_0                -2.017185e-01 1 1  ON 30
 eH1_1                -9.602888e-02 1 1  ON 31
 eH1_2                -4.464708e-02 1 1  ON 32
 eH1_3                -1.418214e-02 1 1  ON 33
 eH1_4                 1.841560e-02 1 1  ON 34
 eH1_5                 2.180132e-02 1 1  ON 35
 eH1_6                 7.085014e-02 1 1  ON 36
 eH1_7                 1.028446e-01 1 1  ON 37
 eH1_8                 1.007230e-01 1 1  ON 38
 eH1_9                 2.595579e-02 1 1  ON 39
 eH2_0                -2.032419e-01 1 1  ON 40
 eH2_1                -9.783465e-02 1 1  ON 41
 eH2_2                -4.646114e-02 1 1  ON 42
 eH2_3                -1.570923e-02 1 1  ON 43
 eH2_4                 1.622992e-02 1 1  ON 44
 eH2_5                 1.969548e-02 1 1  ON 45
 eH2_6                 7.233762e-02 1 1  ON 46
 eH2_7                 1.102554e-01 1 1  ON 47
 eH2_8                 1.031624e-01 1 1  ON 48
 eH2_9                 2.888338e-02 1 1  ON 49
ci_001                -4.204594e-02 3 1  ON 50
ci_002                -3.075223e-02 3 1  ON 51
ci_003                -1.127830e-02 3 1  ON 52
ci_004                 2.573843e-02 3 1  ON 53
ci_005                 2.582882e-02 3 1  ON 54
ci_006                -2.024047e-02 3 1  ON 55
ci_007                -1.959540e-02 3 1  ON 56
ci_008                -4.042303e-03 3 1  ON 57
ci_009                -1.505316e-02 3 1  ON 58
ci_010                -9.377538e-03 3 1  ON 59
ci_011                -9.722595e-03 3 1  ON 60
ci_012                -9.662550e-03 3 1  ON 61
ci_013                -2.170386e-02 3 1  ON 62
ci_014                 1.319791e-02 3 1  ON 63
ci_015                 1.292128e-02 3 1  ON 64
ci_016                 1.629611e-02 3 1  ON 65
ci_017                 1.618483e-02 3 1  ON 66
ci_018                 1.093770e-02 3 1  ON 67
ci_019                 1.074412e-02 3 1  ON 68
ci_020                 1.827242e-02 3 1  ON 69
ci_021                 1.805514e-02 3 1  ON 70
ci_022                 1.038476e-02 3 1  ON 71
ci_023                 1.005426e-02 3 1  ON 72
ci_024                 6.658062e-03 3 1  ON 73
ci_025                 6.624608e-03 3 1  ON 74
ci_026                 1.164249e-02 3 1  ON 75
ci_027                 1.159183e-02 3 1  ON 76
ci_028                -8.910051e-03 3 1  ON 77
ci_029                -9.868037e-03 3 1  ON 78
ci_030                -5.338264e-03 3 1  ON 79
ci_031                -4.569703e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.1904
    reference variance = 0.205415
====================================================
  Execution time = 1.9001e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9798e-01
  Total weights = 1.9741e+06
  Execution time = 1.5569e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290264813571
                                         uncertainty =       0.001497761218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290264813571
                                         uncertainty =       0.001497761218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381068301
  error estimate for blocks of size 2^( 2) =       0.000396396663
  error estimate for blocks of size 2^( 3) =       0.000410850382
  error estimate for blocks of size 2^( 4) =       0.000421539104
  error estimate for blocks of size 2^( 5) =       0.000428585408
  error estimate for blocks of size 2^( 6) =       0.000431298233
  error estimate for blocks of size 2^( 7) =       0.000434214992

      target function =      -0.912201539890
              le_mean =     -17.206588507082
             les_mean =     296.367053918983
             stat err =       0.000428909434
             autocorr =       1.266851032693
   target nu stat err =       0.000428909434
   target dn stat err =       0.003109413099
      target stat err =       0.004841755258
              std dev =       0.538911960146
             le_variance =       0.290426100788

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290204398304
                                         uncertainty =       0.001497087937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290204398304
                                         uncertainty =       0.001497087937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381028942
  error estimate for blocks of size 2^( 2) =       0.000396365908
  error estimate for blocks of size 2^( 3) =       0.000410827890
  error estimate for blocks of size 2^( 4) =       0.000421518938
  error estimate for blocks of size 2^( 5) =       0.000428565599
  error estimate for blocks of size 2^( 6) =       0.000431282660
  error estimate for blocks of size 2^( 7) =       0.000434196813

      target function =      -0.915866804607
              le_mean =     -17.206587787603
             les_mean =     296.364667496964
             stat err =       0.000428891002
             autocorr =       1.267003868388
   target nu stat err =       0.000428891002
   target dn stat err =       0.002008008374
      target stat err =       0.003200045581
              std dev =       0.538856297427
             le_variance =       0.290366109277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290232785356
                                         uncertainty =       0.001497399518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290232785356
                                         uncertainty =       0.001497399518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381047431
  error estimate for blocks of size 2^( 2) =       0.000396380199
  error estimate for blocks of size 2^( 3) =       0.000410838132
  error estimate for blocks of size 2^( 4) =       0.000421528072
  error estimate for blocks of size 2^( 5) =       0.000428574524
  error estimate for blocks of size 2^( 6) =       0.000431289481
  error estimate for blocks of size 2^( 7) =       0.000434205074

      target function =      -0.915900020285
              le_mean =     -17.206588025469
             les_mean =     296.364654334056
             stat err =       0.000428899288
             autocorr =       1.266929862877
   target nu stat err =       0.000428899288
   target dn stat err =       0.001999703068
      target stat err =       0.003187723470
              std dev =       0.538882445339
             le_variance =       0.290394289895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290260660630
                                         uncertainty =       0.001497713609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290260660630
                                         uncertainty =       0.001497713609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381065595
  error estimate for blocks of size 2^( 2) =       0.000396394518
  error estimate for blocks of size 2^( 3) =       0.000410848774
  error estimate for blocks of size 2^( 4) =       0.000421537710
  error estimate for blocks of size 2^( 5) =       0.000428583977
  error estimate for blocks of size 2^( 6) =       0.000431296992
  error estimate for blocks of size 2^( 7) =       0.000434213791

      target function =      -0.915782953429
              le_mean =     -17.206588463828
             les_mean =     296.364744855924
             stat err =       0.000428908118
             autocorr =       1.266861250635
   target nu stat err =       0.000428908118
   target dn stat err =       0.001998733866
      target stat err =       0.003185471494
              std dev =       0.538908132471
             le_variance =       0.290421975244


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912201539890        initial
     2.3283e+00     2.3283e+01             3.2835e-04        -0.915866804607
     9.3132e+00     9.3132e+01             8.3407e-05        -0.915900020285  <--
     3.7253e+01     3.7253e+02             2.0936e-05        -0.915782953429

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 2.6880e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
  uu_0                 2.101396e-01 1 1  ON 0
  uu_1                 5.289315e-02 1 1  ON 1
  uu_2                -3.819851e-02 1 1  ON 2
  uu_3                -9.163449e-02 1 1  ON 3
  uu_4                -1.222848e-01 1 1  ON 4
  uu_5                -1.300602e-01 1 1  ON 5
  uu_6                -1.127232e-01 1 1  ON 6
  uu_7                -5.662674e-02 1 1  ON 7
  uu_8                 5.969066e-02 1 1  ON 8
  uu_9                 1.247517e-01 1 1  ON 9
  ud_0                 3.050270e-01 1 1  ON 10
  ud_1                 7.591603e-02 1 1  ON 11
  ud_2                -2.631293e-02 1 1  ON 12
  ud_3                -7.922542e-02 1 1  ON 13
  ud_4                -1.149146e-01 1 1  ON 14
  ud_5                -1.333790e-01 1 1  ON 15
  ud_6                -1.265642e-01 1 1  ON 16
  ud_7                -8.503423e-02 1 1  ON 17
  ud_8                -6.032648e-03 1 1  ON 18
  ud_9                 8.610574e-02 1 1  ON 19
  eO_0                -7.035067e-01 1 1  ON 20
  eO_1                -4.201289e-01 1 1  ON 21
  eO_2                -4.159382e-02 1 1  ON 22
  eO_3                 1.846115e-01 1 1  ON 23
  eO_4                 2.569626e-01 1 1  ON 24
  eO_5                 2.802216e-01 1 1  ON 25
  eO_6                 2.510201e-01 1 1  ON 26
  eO_7                 1.325610e-01 1 1  ON 27
  eO_8                 2.924527e-02 1 1  ON 28
  eO_9                 1.915713e-02 1 1  ON 29
 eH1_0                -2.017185e-01 1 1  ON 30
 eH1_1                -9.602888e-02 1 1  ON 31
 eH1_2                -4.464708e-02 1 1  ON 32
 eH1_3                -1.418214e-02 1 1  ON 33
 eH1_4                 1.841560e-02 1 1  ON 34
 eH1_5                 2.180132e-02 1 1  ON 35
 eH1_6                 7.085014e-02 1 1  ON 36
 eH1_7                 1.028446e-01 1 1  ON 37
 eH1_8                 1.007230e-01 1 1  ON 38
 eH1_9                 2.595579e-02 1 1  ON 39
 eH2_0                -2.032419e-01 1 1  ON 40
 eH2_1                -9.783465e-02 1 1  ON 41
 eH2_2                -4.646114e-02 1 1  ON 42
 eH2_3                -1.570923e-02 1 1  ON 43
 eH2_4                 1.622992e-02 1 1  ON 44
 eH2_5                 1.969548e-02 1 1  ON 45
 eH2_6                 7.233762e-02 1 1  ON 46
 eH2_7                 1.102554e-01 1 1  ON 47
 eH2_8                 1.031624e-01 1 1  ON 48
 eH2_9                 2.888338e-02 1 1  ON 49
ci_001                -4.204594e-02 3 1  ON 50
ci_002                -3.075223e-02 3 1  ON 51
ci_003                -1.127830e-02 3 1  ON 52
ci_004                 2.573843e-02 3 1  ON 53
ci_005                 2.582882e-02 3 1  ON 54
ci_006                -2.024047e-02 3 1  ON 55
ci_007                -1.959540e-02 3 1  ON 56
ci_008                -4.042303e-03 3 1  ON 57
ci_009                -1.505316e-02 3 1  ON 58
ci_010                -9.377538e-03 3 1  ON 59
ci_011                -9.722595e-03 3 1  ON 60
ci_012                -9.662550e-03 3 1  ON 61
ci_013                -2.170386e-02 3 1  ON 62
ci_014                 1.319791e-02 3 1  ON 63
ci_015                 1.292128e-02 3 1  ON 64
ci_016                 1.629611e-02 3 1  ON 65
ci_017                 1.618483e-02 3 1  ON 66
ci_018                 1.093770e-02 3 1  ON 67
ci_019                 1.074412e-02 3 1  ON 68
ci_020                 1.827242e-02 3 1  ON 69
ci_021                 1.805514e-02 3 1  ON 70
ci_022                 1.038476e-02 3 1  ON 71
ci_023                 1.005426e-02 3 1  ON 72
ci_024                 6.658062e-03 3 1  ON 73
ci_025                 6.624608e-03 3 1  ON 74
ci_026                 1.164249e-02 3 1  ON 75
ci_027                 1.159183e-02 3 1  ON 76
ci_028                -8.910051e-03 3 1  ON 77
ci_029                -9.868037e-03 3 1  ON 78
ci_030                -5.338264e-03 3 1  ON 79
ci_031                -4.569703e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2267e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7196e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2217
    reference variance = 0.252628
====================================================
  Execution time = 1.9104e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5413e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9700e-01
  Total weights = 1.974020295e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5439e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289792822830
                                         uncertainty =       0.002022973133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289792822830
                                         uncertainty =       0.002022973133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380684994
  error estimate for blocks of size 2^( 2) =       0.000396155577
  error estimate for blocks of size 2^( 3) =       0.000410146232
  error estimate for blocks of size 2^( 4) =       0.000420630324
  error estimate for blocks of size 2^( 5) =       0.000427834548
  error estimate for blocks of size 2^( 6) =       0.000429510897
  error estimate for blocks of size 2^( 7) =       0.000432526528

      target function =      -0.917432930601
              le_mean =     -17.206415960227
             les_mean =     296.357746347184
             stat err =       0.000427625574
             autocorr =       1.261815406030
   target nu stat err =       0.000427625574
   target dn stat err =       0.002311001131
      target stat err =       0.003670260041
              std dev =       0.538369880948
             le_variance =       0.289842128712


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720641596023e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917446648481       residual = 8.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917458150602       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917461084464       residual = 4.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917461562140       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917461914566       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917462067197       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917462154898       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917462136705       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917462212869       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917462252058       residual = 8.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917462194831       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917462188546       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917462196472       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917462300144       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917462292350       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917462326906       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917462364951       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917462390036       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917462419422       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917462434698       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917462449225       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917462470050       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917462488794       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917462486320       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917462475479       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917462467849       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917462470299       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917462476586       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917462478520       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917462477755       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917462473230       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917462482137       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917462481101       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917462484629       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917462485882       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917462485290       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3283e+00 is 1.833693e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917446648481       residual = 8.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917449595461       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917450345130       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917450467088       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917450556524       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917450594971       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917450617282       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917450612421       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917450631793       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917450641735       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917450626855       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917450625727       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917450627767       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917450653621       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917450652095       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917450660325       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917450670177       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917450676251       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917450683653       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917450687376       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917450690983       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917450696378       residual = 8.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917450700800       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917450699932       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917450697176       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917450695382       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917450696062       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917450697624       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917450698033       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917450697785       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917450696759       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917450698951       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917450698695       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917450699569       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917450699812       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917450699689       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.3132e+00 is 4.611735e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917446648481       residual = 8.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917447389831       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917447578289       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917447608942       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917447631386       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917447641016       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917447646618       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917447645382       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917447650247       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917447652741       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917447648984       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917447648732       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917447649245       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917447655703       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917447655349       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917447657383       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917447659865       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917447661371       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917447663225       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917447664150       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917447665050       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917447666411       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917447667498       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917447667266       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917447666574       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917447666133       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917447666308       residual = 9.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917447666697       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917447666795       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917447666729       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917447666480       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917447667025       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917447666961       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917447667179       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917447667236       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917447667206       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.7253e+01 is 1.154665e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.754916 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4704e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
  uu_0                 2.101358e-01 1 1  ON 0
  uu_1                 5.289593e-02 1 1  ON 1
  uu_2                -3.818855e-02 1 1  ON 2
  uu_3                -9.162657e-02 1 1  ON 3
  uu_4                -1.222806e-01 1 1  ON 4
  uu_5                -1.300540e-01 1 1  ON 5
  uu_6                -1.127192e-01 1 1  ON 6
  uu_7                -5.663508e-02 1 1  ON 7
  uu_8                 5.965386e-02 1 1  ON 8
  uu_9                 1.247532e-01 1 1  ON 9
  ud_0                 3.050200e-01 1 1  ON 10
  ud_1                 7.590818e-02 1 1  ON 11
  ud_2                -2.631434e-02 1 1  ON 12
  ud_3                -7.922374e-02 1 1  ON 13
  ud_4                -1.149087e-01 1 1  ON 14
  ud_5                -1.333728e-01 1 1  ON 15
  ud_6                -1.265575e-01 1 1  ON 16
  ud_7                -8.502171e-02 1 1  ON 17
  ud_8                -6.052279e-03 1 1  ON 18
  ud_9                 8.609328e-02 1 1  ON 19
  eO_0                -7.034949e-01 1 1  ON 20
  eO_1                -4.201194e-01 1 1  ON 21
  eO_2                -4.158915e-02 1 1  ON 22
  eO_3                 1.846135e-01 1 1  ON 23
  eO_4                 2.569531e-01 1 1  ON 24
  eO_5                 2.801755e-01 1 1  ON 25
  eO_6                 2.510197e-01 1 1  ON 26
  eO_7                 1.325877e-01 1 1  ON 27
  eO_8                 2.924710e-02 1 1  ON 28
  eO_9                 1.915648e-02 1 1  ON 29
 eH1_0                -2.017106e-01 1 1  ON 30
 eH1_1                -9.602776e-02 1 1  ON 31
 eH1_2                -4.464254e-02 1 1  ON 32
 eH1_3                -1.417002e-02 1 1  ON 33
 eH1_4                 1.842178e-02 1 1  ON 34
 eH1_5                 2.178146e-02 1 1  ON 35
 eH1_6                 7.083027e-02 1 1  ON 36
 eH1_7                 1.028424e-01 1 1  ON 37
 eH1_8                 1.007276e-01 1 1  ON 38
 eH1_9                 2.596023e-02 1 1  ON 39
 eH2_0                -2.032382e-01 1 1  ON 40
 eH2_1                -9.782021e-02 1 1  ON 41
 eH2_2                -4.645677e-02 1 1  ON 42
 eH2_3                -1.571594e-02 1 1  ON 43
 eH2_4                 1.622506e-02 1 1  ON 44
 eH2_5                 1.969277e-02 1 1  ON 45
 eH2_6                 7.232568e-02 1 1  ON 46
 eH2_7                 1.102519e-01 1 1  ON 47
 eH2_8                 1.031695e-01 1 1  ON 48
 eH2_9                 2.888389e-02 1 1  ON 49
ci_001                -4.204061e-02 3 1  ON 50
ci_002                -3.075011e-02 3 1  ON 51
ci_003                -1.126274e-02 3 1  ON 52
ci_004                 2.574269e-02 3 1  ON 53
ci_005                 2.583246e-02 3 1  ON 54
ci_006                -2.024629e-02 3 1  ON 55
ci_007                -1.959753e-02 3 1  ON 56
ci_008                -4.053784e-03 3 1  ON 57
ci_009                -1.506156e-02 3 1  ON 58
ci_010                -9.380658e-03 3 1  ON 59
ci_011                -9.719612e-03 3 1  ON 60
ci_012                -9.670620e-03 3 1  ON 61
ci_013                -2.170688e-02 3 1  ON 62
ci_014                 1.319404e-02 3 1  ON 63
ci_015                 1.292524e-02 3 1  ON 64
ci_016                 1.629221e-02 3 1  ON 65
ci_017                 1.618151e-02 3 1  ON 66
ci_018                 1.092600e-02 3 1  ON 67
ci_019                 1.074413e-02 3 1  ON 68
ci_020                 1.827393e-02 3 1  ON 69
ci_021                 1.805423e-02 3 1  ON 70
ci_022                 1.038162e-02 3 1  ON 71
ci_023                 1.006164e-02 3 1  ON 72
ci_024                 6.657941e-03 3 1  ON 73
ci_025                 6.617961e-03 3 1  ON 74
ci_026                 1.163735e-02 3 1  ON 75
ci_027                 1.160107e-02 3 1  ON 76
ci_028                -8.911063e-03 3 1  ON 77
ci_029                -9.869383e-03 3 1  ON 78
ci_030                -5.340976e-03 3 1  ON 79
ci_031                -4.567621e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.193
    reference variance = 0.284152
====================================================
  Execution time = 1.9167e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9821e-01
  Total weights = 1.9739e+06
  Execution time = 1.5557e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290470019404
                                         uncertainty =       0.001704626861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290470019404
                                         uncertainty =       0.001704626861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381167064
  error estimate for blocks of size 2^( 2) =       0.000396639170
  error estimate for blocks of size 2^( 3) =       0.000410417536
  error estimate for blocks of size 2^( 4) =       0.000420420127
  error estimate for blocks of size 2^( 5) =       0.000427008468
  error estimate for blocks of size 2^( 6) =       0.000430158552
  error estimate for blocks of size 2^( 7) =       0.000431375081

      target function =      -0.915513696884
              le_mean =     -17.206615435463
             les_mean =     296.365844890791
             stat err =       0.000427240557
             autocorr =       1.256360315597
   target nu stat err =       0.000427240557
   target dn stat err =       0.002204174379
      target stat err =       0.003494190688
              std dev =       0.539051632036
             le_variance =       0.290576662000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290438365163
                                         uncertainty =       0.001703844669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290438365163
                                         uncertainty =       0.001703844669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381146229
  error estimate for blocks of size 2^( 2) =       0.000396617970
  error estimate for blocks of size 2^( 3) =       0.000410396413
  error estimate for blocks of size 2^( 4) =       0.000420398314
  error estimate for blocks of size 2^( 5) =       0.000426986505
  error estimate for blocks of size 2^( 6) =       0.000430137264
  error estimate for blocks of size 2^( 7) =       0.000431354087

      target function =      -0.915611297371
              le_mean =     -17.206616093153
             les_mean =     296.365804620802
             stat err =       0.000427219043
             autocorr =       1.256371139109
   target nu stat err =       0.000427219043
   target dn stat err =       0.002199967060
      target stat err =       0.003488531586
              std dev =       0.539022165907
             le_variance =       0.290544895339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290453720134
                                         uncertainty =       0.001704224722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290453720134
                                         uncertainty =       0.001704224722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381156336
  error estimate for blocks of size 2^( 2) =       0.000396628254
  error estimate for blocks of size 2^( 3) =       0.000410406658
  error estimate for blocks of size 2^( 4) =       0.000420408894
  error estimate for blocks of size 2^( 5) =       0.000426997156
  error estimate for blocks of size 2^( 6) =       0.000430147585
  error estimate for blocks of size 2^( 7) =       0.000431364261

      target function =      -0.915566942949
              le_mean =     -17.206615756992
             les_mean =     296.365821636907
             stat err =       0.000427229474
             autocorr =       1.256365857711
   target nu stat err =       0.000427229474
   target dn stat err =       0.002201951347
      target stat err =       0.003491213294
              std dev =       0.539036460202
             le_variance =       0.290560305427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290467957917
                                         uncertainty =       0.001704576061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290467957917
                                         uncertainty =       0.001704576061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381165708
  error estimate for blocks of size 2^( 2) =       0.000396637790
  error estimate for blocks of size 2^( 3) =       0.000410416160
  error estimate for blocks of size 2^( 4) =       0.000420418707
  error estimate for blocks of size 2^( 5) =       0.000427007037
  error estimate for blocks of size 2^( 6) =       0.000430157164
  error estimate for blocks of size 2^( 7) =       0.000431373712

      target function =      -0.915520813398
              le_mean =     -17.206615474285
             les_mean =     296.365841639712
             stat err =       0.000427239155
             autocorr =       1.256361015253
   target nu stat err =       0.000427239155
   target dn stat err =       0.002203885131
      target stat err =       0.003493804725
              std dev =       0.539049713218
             le_variance =       0.290574593321


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915513696884        initial
     2.3283e+00     2.3283e+01             1.8337e-04        -0.915611297371  <--
     9.3132e+00     9.3132e+01             4.6117e-05        -0.915566942949
     3.7253e+01     3.7253e+02             1.1547e-05        -0.915520813398

*****************************************************************************
Applying the update for shift_i =   2.3283e+00     and shift_s =   2.3283e+01
*****************************************************************************

  Execution time = 2.7052e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
  uu_0                 2.101251e-01 1 1  ON 0
  uu_1                 5.290432e-02 1 1  ON 1
  uu_2                -3.815930e-02 1 1  ON 2
  uu_3                -9.160319e-02 1 1  ON 3
  uu_4                -1.222678e-01 1 1  ON 4
  uu_5                -1.300356e-01 1 1  ON 5
  uu_6                -1.127071e-01 1 1  ON 6
  uu_7                -5.665984e-02 1 1  ON 7
  uu_8                 5.954391e-02 1 1  ON 8
  uu_9                 1.247579e-01 1 1  ON 9
  ud_0                 3.049995e-01 1 1  ON 10
  ud_1                 7.588520e-02 1 1  ON 11
  ud_2                -2.631859e-02 1 1  ON 12
  ud_3                -7.921891e-02 1 1  ON 13
  ud_4                -1.148913e-01 1 1  ON 14
  ud_5                -1.333546e-01 1 1  ON 15
  ud_6                -1.265373e-01 1 1  ON 16
  ud_7                -8.498470e-02 1 1  ON 17
  ud_8                -6.110731e-03 1 1  ON 18
  ud_9                 8.605598e-02 1 1  ON 19
  eO_0                -7.034601e-01 1 1  ON 20
  eO_1                -4.200911e-01 1 1  ON 21
  eO_2                -4.157502e-02 1 1  ON 22
  eO_3                 1.846195e-01 1 1  ON 23
  eO_4                 2.569246e-01 1 1  ON 24
  eO_5                 2.800383e-01 1 1  ON 25
  eO_6                 2.510183e-01 1 1  ON 26
  eO_7                 1.326676e-01 1 1  ON 27
  eO_8                 2.925258e-02 1 1  ON 28
  eO_9                 1.915452e-02 1 1  ON 29
 eH1_0                -2.016874e-01 1 1  ON 30
 eH1_1                -9.602405e-02 1 1  ON 31
 eH1_2                -4.462892e-02 1 1  ON 32
 eH1_3                -1.413439e-02 1 1  ON 33
 eH1_4                 1.844003e-02 1 1  ON 34
 eH1_5                 2.172299e-02 1 1  ON 35
 eH1_6                 7.077083e-02 1 1  ON 36
 eH1_7                 1.028360e-01 1 1  ON 37
 eH1_8                 1.007413e-01 1 1  ON 38
 eH1_9                 2.597353e-02 1 1  ON 39
 eH2_0                -2.032269e-01 1 1  ON 40
 eH2_1                -9.777805e-02 1 1  ON 41
 eH2_2                -4.644393e-02 1 1  ON 42
 eH2_3                -1.573540e-02 1 1  ON 43
 eH2_4                 1.621069e-02 1 1  ON 44
 eH2_5                 1.968472e-02 1 1  ON 45
 eH2_6                 7.229030e-02 1 1  ON 46
 eH2_7                 1.102413e-01 1 1  ON 47
 eH2_8                 1.031909e-01 1 1  ON 48
 eH2_9                 2.888544e-02 1 1  ON 49
ci_001                -4.202499e-02 3 1  ON 50
ci_002                -3.074392e-02 3 1  ON 51
ci_003                -1.121747e-02 3 1  ON 52
ci_004                 2.575511e-02 3 1  ON 53
ci_005                 2.584322e-02 3 1  ON 54
ci_006                -2.026330e-02 3 1  ON 55
ci_007                -1.960375e-02 3 1  ON 56
ci_008                -4.087035e-03 3 1  ON 57
ci_009                -1.508596e-02 3 1  ON 58
ci_010                -9.389745e-03 3 1  ON 59
ci_011                -9.710937e-03 3 1  ON 60
ci_012                -9.694074e-03 3 1  ON 61
ci_013                -2.171574e-02 3 1  ON 62
ci_014                 1.318277e-02 3 1  ON 63
ci_015                 1.293677e-02 3 1  ON 64
ci_016                 1.628077e-02 3 1  ON 65
ci_017                 1.617179e-02 3 1  ON 66
ci_018                 1.089205e-02 3 1  ON 67
ci_019                 1.074416e-02 3 1  ON 68
ci_020                 1.827834e-02 3 1  ON 69
ci_021                 1.805143e-02 3 1  ON 70
ci_022                 1.037251e-02 3 1  ON 71
ci_023                 1.008313e-02 3 1  ON 72
ci_024                 6.657579e-03 3 1  ON 73
ci_025                 6.598554e-03 3 1  ON 74
ci_026                 1.162245e-02 3 1  ON 75
ci_027                 1.162795e-02 3 1  ON 76
ci_028                -8.914013e-03 3 1  ON 77
ci_029                -9.873322e-03 3 1  ON 78
ci_030                -5.348840e-03 3 1  ON 79
ci_031                -4.561580e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1762e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7196e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.1546
    reference variance = 0.195829
====================================================
  Execution time = 1.9423e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5418e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0261e-01
  Total weights = 1.973730917e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5558e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293039255981
                                         uncertainty =       0.002586837138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293039255981
                                         uncertainty =       0.002586837138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382731968
  error estimate for blocks of size 2^( 2) =       0.000397951200
  error estimate for blocks of size 2^( 3) =       0.000412043202
  error estimate for blocks of size 2^( 4) =       0.000422866071
  error estimate for blocks of size 2^( 5) =       0.000430148606
  error estimate for blocks of size 2^( 6) =       0.000433733985
  error estimate for blocks of size 2^( 7) =       0.000435620407

      target function =      -0.908730320167
              le_mean =     -17.206459501279
             les_mean =     296.364859221816
             stat err =       0.000430592267
             autocorr =       1.265735540733
   target nu stat err =       0.000430592267
   target dn stat err =       0.004706112362
      target stat err =       0.007225495323
              std dev =       0.541264740573
             le_variance =       0.292967519388


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720645950128e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908786968820       residual = 6.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908826105598       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908836278727       residual = 5.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908839933881       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908841077845       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908841662964       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908842098563       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908842654633       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908842649024       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908842633349       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908842891203       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908843106872       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.908843464727       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.908843467476       residual = 9.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.908843353443       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.908843210229       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.908843153332       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.908843470444       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.908843481438       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908843547132       residual = 9.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.908843557297       residual = 9.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.908843556290       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908843620627       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.908843574632       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.908843633970       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908843616374       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.908843660153       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.908843629464       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.908843697016       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908843734774       residual = 9.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.908843765711       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.908843774038       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.908843792668       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908843786874       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.908843811416       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.908843803798       residual = 8.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.8208e-01 is 6.725140e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908786968820       residual = 6.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908797694059       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908800436670       residual = 5.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908801398887       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908801694842       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908801845534       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908801960186       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908802100388       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908802100480       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908802095564       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908802168708       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908802230036       residual = 9.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.908802321887       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.908802314623       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.908802282162       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.908802247383       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.908802236213       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.908802319785       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.908802317556       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908802331431       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.908802334534       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.908802336987       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908802352180       residual = 9.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.908802337522       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.908802352533       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908802347451       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.908802357944       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.908802351545       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.908802368852       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908802376682       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.908802383192       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.908802385536       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.908802388571       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908802387998       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.908802393100       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.908802391118       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3283e+00 is 1.710655e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908786968820       residual = 6.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908789716187       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908790415517       residual = 5.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908790659241       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908790733851       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908790771793       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908790800822       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908790835870       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908790836026       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908790834747       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908790853663       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908790869524       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.908790892563       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.908790890156       residual = 7.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.908790881803       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.908790873231       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.908790870665       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.908790891805       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.908790890879       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908790894197       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.908790895029       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.908790895840       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908790899531       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.908790895650       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.908790899421       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908790898118       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.908790900720       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.908790899215       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.908790903549       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908790905397       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.908790906956       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.908790907550       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.908790908213       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908790908111       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.908790909322       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.908790908840       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.3132e+00 is 4.306079e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.805022 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5035e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
  uu_0                 2.101344e-01 1 1  ON 0
  uu_1                 5.292604e-02 1 1  ON 1
  uu_2                -3.813802e-02 1 1  ON 2
  uu_3                -9.158865e-02 1 1  ON 3
  uu_4                -1.222545e-01 1 1  ON 4
  uu_5                -1.300260e-01 1 1  ON 5
  uu_6                -1.127415e-01 1 1  ON 6
  uu_7                -5.662463e-02 1 1  ON 7
  uu_8                 5.937338e-02 1 1  ON 8
  uu_9                 1.247848e-01 1 1  ON 9
  ud_0                 3.050303e-01 1 1  ON 10
  ud_1                 7.591006e-02 1 1  ON 11
  ud_2                -2.628665e-02 1 1  ON 12
  ud_3                -7.921409e-02 1 1  ON 13
  ud_4                -1.149096e-01 1 1  ON 14
  ud_5                -1.333476e-01 1 1  ON 15
  ud_6                -1.265599e-01 1 1  ON 16
  ud_7                -8.503272e-02 1 1  ON 17
  ud_8                -6.164483e-03 1 1  ON 18
  ud_9                 8.601434e-02 1 1  ON 19
  eO_0                -7.035044e-01 1 1  ON 20
  eO_1                -4.201345e-01 1 1  ON 21
  eO_2                -4.154248e-02 1 1  ON 22
  eO_3                 1.847051e-01 1 1  ON 23
  eO_4                 2.569774e-01 1 1  ON 24
  eO_5                 2.798672e-01 1 1  ON 25
  eO_6                 2.510073e-01 1 1  ON 26
  eO_7                 1.327468e-01 1 1  ON 27
  eO_8                 2.926091e-02 1 1  ON 28
  eO_9                 1.915706e-02 1 1  ON 29
 eH1_0                -2.017009e-01 1 1  ON 30
 eH1_1                -9.600004e-02 1 1  ON 31
 eH1_2                -4.459944e-02 1 1  ON 32
 eH1_3                -1.413604e-02 1 1  ON 33
 eH1_4                 1.839044e-02 1 1  ON 34
 eH1_5                 2.171430e-02 1 1  ON 35
 eH1_6                 7.074769e-02 1 1  ON 36
 eH1_7                 1.028032e-01 1 1  ON 37
 eH1_8                 1.007923e-01 1 1  ON 38
 eH1_9                 2.598536e-02 1 1  ON 39
 eH2_0                -2.032718e-01 1 1  ON 40
 eH2_1                -9.774298e-02 1 1  ON 41
 eH2_2                -4.642217e-02 1 1  ON 42
 eH2_3                -1.570609e-02 1 1  ON 43
 eH2_4                 1.618888e-02 1 1  ON 44
 eH2_5                 1.971995e-02 1 1  ON 45
 eH2_6                 7.225245e-02 1 1  ON 46
 eH2_7                 1.101785e-01 1 1  ON 47
 eH2_8                 1.032298e-01 1 1  ON 48
 eH2_9                 2.888666e-02 1 1  ON 49
ci_001                -4.199896e-02 3 1  ON 50
ci_002                -3.076211e-02 3 1  ON 51
ci_003                -1.123626e-02 3 1  ON 52
ci_004                 2.578209e-02 3 1  ON 53
ci_005                 2.583905e-02 3 1  ON 54
ci_006                -2.024612e-02 3 1  ON 55
ci_007                -1.958729e-02 3 1  ON 56
ci_008                -4.058951e-03 3 1  ON 57
ci_009                -1.509063e-02 3 1  ON 58
ci_010                -9.368273e-03 3 1  ON 59
ci_011                -9.731288e-03 3 1  ON 60
ci_012                -9.720328e-03 3 1  ON 61
ci_013                -2.168758e-02 3 1  ON 62
ci_014                 1.318678e-02 3 1  ON 63
ci_015                 1.295855e-02 3 1  ON 64
ci_016                 1.631275e-02 3 1  ON 65
ci_017                 1.615635e-02 3 1  ON 66
ci_018                 1.084579e-02 3 1  ON 67
ci_019                 1.072817e-02 3 1  ON 68
ci_020                 1.827712e-02 3 1  ON 69
ci_021                 1.806402e-02 3 1  ON 70
ci_022                 1.036280e-02 3 1  ON 71
ci_023                 1.005878e-02 3 1  ON 72
ci_024                 6.577478e-03 3 1  ON 73
ci_025                 6.632403e-03 3 1  ON 74
ci_026                 1.163950e-02 3 1  ON 75
ci_027                 1.161143e-02 3 1  ON 76
ci_028                -8.883264e-03 3 1  ON 77
ci_029                -9.829179e-03 3 1  ON 78
ci_030                -5.336868e-03 3 1  ON 79
ci_031                -4.606120e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.1802
    reference variance = 0.234069
====================================================
  Execution time = 1.9117e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0173e-01
  Total weights = 1.9738e+06
  Execution time = 1.5537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289023143906
                                         uncertainty =       0.001849702974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289023143906
                                         uncertainty =       0.001849702974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380108184
  error estimate for blocks of size 2^( 2) =       0.000395223938
  error estimate for blocks of size 2^( 3) =       0.000409662511
  error estimate for blocks of size 2^( 4) =       0.000419297961
  error estimate for blocks of size 2^( 5) =       0.000425008501
  error estimate for blocks of size 2^( 6) =       0.000428380432
  error estimate for blocks of size 2^( 7) =       0.000430564838

      target function =      -0.911537724534
              le_mean =     -17.206533541634
             les_mean =     296.365589797541
             stat err =       0.000425812933
             autocorr =       1.254940844289
   target nu stat err =       0.000425812933
   target dn stat err =       0.003558305163
      target stat err =       0.005516910186
              std dev =       0.537554149413
             le_variance =       0.288964463551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289039077399
                                         uncertainty =       0.001844230642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289039077399
                                         uncertainty =       0.001844230642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380118648
  error estimate for blocks of size 2^( 2) =       0.000395244885
  error estimate for blocks of size 2^( 3) =       0.000409689300
  error estimate for blocks of size 2^( 4) =       0.000419327859
  error estimate for blocks of size 2^( 5) =       0.000425042928
  error estimate for blocks of size 2^( 6) =       0.000428410862
  error estimate for blocks of size 2^( 7) =       0.000430583877

      target function =      -0.896629749293
              le_mean =     -17.206535809094
             les_mean =     296.375344635251
             stat err =       0.000425841381
             autocorr =       1.255039433223
   target nu stat err =       0.000425841381
   target dn stat err =       0.011088378760
      target stat err =       0.016512708824
              std dev =       0.537568947378
             le_variance =       0.288980373185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289029212071
                                         uncertainty =       0.001846516230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289029212071
                                         uncertainty =       0.001846516230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380112168
  error estimate for blocks of size 2^( 2) =       0.000395233840
  error estimate for blocks of size 2^( 3) =       0.000409675815
  error estimate for blocks of size 2^( 4) =       0.000419312991
  error estimate for blocks of size 2^( 5) =       0.000425026112
  error estimate for blocks of size 2^( 6) =       0.000428395955
  error estimate for blocks of size 2^( 7) =       0.000430574885

      target function =      -0.907637724068
              le_mean =     -17.206534590790
             les_mean =     296.368145562247
             stat err =       0.000425827486
             autocorr =       1.255000316137
   target nu stat err =       0.000425827486
   target dn stat err =       0.005438895868
      target stat err =       0.008320700286
              std dev =       0.537559783681
             le_variance =       0.288970521031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289023637795
                                         uncertainty =       0.001849278622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289023637795
                                         uncertainty =       0.001849278622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380108508
  error estimate for blocks of size 2^( 2) =       0.000395225029
  error estimate for blocks of size 2^( 3) =       0.000409664047
  error estimate for blocks of size 2^( 4) =       0.000419299722
  error estimate for blocks of size 2^( 5) =       0.000425010596
  error estimate for blocks of size 2^( 6) =       0.000428382256
  error estimate for blocks of size 2^( 7) =       0.000430566001

      target function =      -0.911229473856
              le_mean =     -17.206533653044
             les_mean =     296.365792625173
             stat err =       0.000425814644
             autocorr =       1.254948787897
   target nu stat err =       0.000425814644
   target dn stat err =       0.003689883325
      target stat err =       0.005713698550
              std dev =       0.537554607699
             le_variance =       0.288964956259


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911537724534        initial  <--
     5.8208e-01     5.8208e+00             6.7251e-04        -0.896629749293
     2.3283e+00     2.3283e+01             1.7107e-04        -0.907637724068
     9.3132e+00     9.3132e+01             4.3061e-05        -0.911229473856

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.9656
  </log>
  <optVariables href="H2O.s046.opt.xml">
  uu_0                 2.101251e-01 1 1  ON 0
  uu_1                 5.290432e-02 1 1  ON 1
  uu_2                -3.815930e-02 1 1  ON 2
  uu_3                -9.160319e-02 1 1  ON 3
  uu_4                -1.222678e-01 1 1  ON 4
  uu_5                -1.300356e-01 1 1  ON 5
  uu_6                -1.127071e-01 1 1  ON 6
  uu_7                -5.665984e-02 1 1  ON 7
  uu_8                 5.954391e-02 1 1  ON 8
  uu_9                 1.247579e-01 1 1  ON 9
  ud_0                 3.049995e-01 1 1  ON 10
  ud_1                 7.588520e-02 1 1  ON 11
  ud_2                -2.631859e-02 1 1  ON 12
  ud_3                -7.921891e-02 1 1  ON 13
  ud_4                -1.148913e-01 1 1  ON 14
  ud_5                -1.333546e-01 1 1  ON 15
  ud_6                -1.265373e-01 1 1  ON 16
  ud_7                -8.498470e-02 1 1  ON 17
  ud_8                -6.110731e-03 1 1  ON 18
  ud_9                 8.605598e-02 1 1  ON 19
  eO_0                -7.034601e-01 1 1  ON 20
  eO_1                -4.200911e-01 1 1  ON 21
  eO_2                -4.157502e-02 1 1  ON 22
  eO_3                 1.846195e-01 1 1  ON 23
  eO_4                 2.569246e-01 1 1  ON 24
  eO_5                 2.800383e-01 1 1  ON 25
  eO_6                 2.510183e-01 1 1  ON 26
  eO_7                 1.326676e-01 1 1  ON 27
  eO_8                 2.925258e-02 1 1  ON 28
  eO_9                 1.915452e-02 1 1  ON 29
 eH1_0                -2.016874e-01 1 1  ON 30
 eH1_1                -9.602405e-02 1 1  ON 31
 eH1_2                -4.462892e-02 1 1  ON 32
 eH1_3                -1.413439e-02 1 1  ON 33
 eH1_4                 1.844003e-02 1 1  ON 34
 eH1_5                 2.172299e-02 1 1  ON 35
 eH1_6                 7.077083e-02 1 1  ON 36
 eH1_7                 1.028360e-01 1 1  ON 37
 eH1_8                 1.007413e-01 1 1  ON 38
 eH1_9                 2.597353e-02 1 1  ON 39
 eH2_0                -2.032269e-01 1 1  ON 40
 eH2_1                -9.777805e-02 1 1  ON 41
 eH2_2                -4.644393e-02 1 1  ON 42
 eH2_3                -1.573540e-02 1 1  ON 43
 eH2_4                 1.621069e-02 1 1  ON 44
 eH2_5                 1.968472e-02 1 1  ON 45
 eH2_6                 7.229030e-02 1 1  ON 46
 eH2_7                 1.102413e-01 1 1  ON 47
 eH2_8                 1.031909e-01 1 1  ON 48
 eH2_9                 2.888544e-02 1 1  ON 49
ci_001                -4.202499e-02 3 1  ON 50
ci_002                -3.074392e-02 3 1  ON 51
ci_003                -1.121747e-02 3 1  ON 52
ci_004                 2.575511e-02 3 1  ON 53
ci_005                 2.584322e-02 3 1  ON 54
ci_006                -2.026330e-02 3 1  ON 55
ci_007                -1.960375e-02 3 1  ON 56
ci_008                -4.087035e-03 3 1  ON 57
ci_009                -1.508596e-02 3 1  ON 58
ci_010                -9.389745e-03 3 1  ON 59
ci_011                -9.710937e-03 3 1  ON 60
ci_012                -9.694074e-03 3 1  ON 61
ci_013                -2.171574e-02 3 1  ON 62
ci_014                 1.318277e-02 3 1  ON 63
ci_015                 1.293677e-02 3 1  ON 64
ci_016                 1.628077e-02 3 1  ON 65
ci_017                 1.617179e-02 3 1  ON 66
ci_018                 1.089205e-02 3 1  ON 67
ci_019                 1.074416e-02 3 1  ON 68
ci_020                 1.827834e-02 3 1  ON 69
ci_021                 1.805143e-02 3 1  ON 70
ci_022                 1.037251e-02 3 1  ON 71
ci_023                 1.008313e-02 3 1  ON 72
ci_024                 6.657579e-03 3 1  ON 73
ci_025                 6.598554e-03 3 1  ON 74
ci_026                 1.162245e-02 3 1  ON 75
ci_027                 1.162795e-02 3 1  ON 76
ci_028                -8.914013e-03 3 1  ON 77
ci_029                -9.873322e-03 3 1  ON 78
ci_030                -5.348840e-03 3 1  ON 79
ci_031                -4.561580e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2007e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7196e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2343
    reference variance = 0.163523
====================================================
  Execution time = 1.9223e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5410e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9995e-01
  Total weights = 1.973834297e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4880e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292473666878
                                         uncertainty =       0.002067609910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292473666878
                                         uncertainty =       0.002067609910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382369512
  error estimate for blocks of size 2^( 2) =       0.000397895372
  error estimate for blocks of size 2^( 3) =       0.000411439019
  error estimate for blocks of size 2^( 4) =       0.000421971455
  error estimate for blocks of size 2^( 5) =       0.000428008309
  error estimate for blocks of size 2^( 6) =       0.000430844544
  error estimate for blocks of size 2^( 7) =       0.000434924858

      target function =      -0.912859941711
              le_mean =     -17.205873260478
             les_mean =     296.342026135753
             stat err =       0.000428937291
             autocorr =       1.258406913222
   target nu stat err =       0.000428937291
   target dn stat err =       0.002801094354
      target stat err =       0.004373397491
              std dev =       0.540752150212
             le_variance =       0.292412887959


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720587326048e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912879990762       residual = 2.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912892820953       residual = 2.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912894689481       residual = 5.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912895041587       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912895259136       residual = 5.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912895314138       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912895317368       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912895332926       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912895290399       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912895310966       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912895338504       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912895348872       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912895368622       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912895378726       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912895413221       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912895415206       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912895414519       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912895420595       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912895426235       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912895430092       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912895441035       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912895443414       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912895449524       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912895452282       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912895454086       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912895458228       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912895462588       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912895461601       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912895459212       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912895459050       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912895460401       residual = 9.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912895457316       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912895458304       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912895459124       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912895457640       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912895457285       residual = 2.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.8208e+00 is 4.692088e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912879990762       residual = 2.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912883231643       residual = 2.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912883703143       residual = 5.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912883791486       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912883846348       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912883860136       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912883860794       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912883864751       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912883854134       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912883859169       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912883866218       residual = 8.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912883868828       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912883873797       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912883876344       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912883884965       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912883885412       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912883885256       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912883886784       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912883888198       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912883889164       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912883891926       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912883892489       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912883893989       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912883894678       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912883895139       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912883896179       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912883897235       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912883896960       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912883896369       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912883896348       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912883896681       residual = 9.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912883895903       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912883896158       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912883896358       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912883895989       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912883895900       residual = 2.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3283e+01 is 1.173366e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912879990762       residual = 2.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912880803092       residual = 2.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912880921244       residual = 5.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912880943349       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912880957095       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912880960544       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912880960699       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912880961692       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912880959039       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912880960292       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912880962064       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912880962718       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912880963962       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912880964600       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912880966755       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912880966864       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912880966825       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912880967208       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912880967562       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912880967803       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912880968496       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912880968634       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912880969008       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912880969180       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912880969296       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912880969556       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912880969818       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912880969747       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912880969600       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912880969596       residual = 7.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912880969679       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912880969484       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912880969548       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912880969598       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912880969506       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.3132e+01 is 2.926621e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.853782 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4765e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
  uu_0                 2.101255e-01 1 1  ON 0
  uu_1                 5.290477e-02 1 1  ON 1
  uu_2                -3.815830e-02 1 1  ON 2
  uu_3                -9.160355e-02 1 1  ON 3
  uu_4                -1.222666e-01 1 1  ON 4
  uu_5                -1.300377e-01 1 1  ON 5
  uu_6                -1.127063e-01 1 1  ON 6
  uu_7                -5.666059e-02 1 1  ON 7
  uu_8                 5.953255e-02 1 1  ON 8
  uu_9                 1.247602e-01 1 1  ON 9
  ud_0                 3.049967e-01 1 1  ON 10
  ud_1                 7.588147e-02 1 1  ON 11
  ud_2                -2.632049e-02 1 1  ON 12
  ud_3                -7.922133e-02 1 1  ON 13
  ud_4                -1.148941e-01 1 1  ON 14
  ud_5                -1.333553e-01 1 1  ON 15
  ud_6                -1.265377e-01 1 1  ON 16
  ud_7                -8.497760e-02 1 1  ON 17
  ud_8                -6.109705e-03 1 1  ON 18
  ud_9                 8.605382e-02 1 1  ON 19
  eO_0                -7.034678e-01 1 1  ON 20
  eO_1                -4.200984e-01 1 1  ON 21
  eO_2                -4.157961e-02 1 1  ON 22
  eO_3                 1.846213e-01 1 1  ON 23
  eO_4                 2.569315e-01 1 1  ON 24
  eO_5                 2.800367e-01 1 1  ON 25
  eO_6                 2.510170e-01 1 1  ON 26
  eO_7                 1.326793e-01 1 1  ON 27
  eO_8                 2.925334e-02 1 1  ON 28
  eO_9                 1.915501e-02 1 1  ON 29
 eH1_0                -2.016911e-01 1 1  ON 30
 eH1_1                -9.602828e-02 1 1  ON 31
 eH1_2                -4.463291e-02 1 1  ON 32
 eH1_3                -1.413886e-02 1 1  ON 33
 eH1_4                 1.844456e-02 1 1  ON 34
 eH1_5                 2.172626e-02 1 1  ON 35
 eH1_6                 7.077778e-02 1 1  ON 36
 eH1_7                 1.028323e-01 1 1  ON 37
 eH1_8                 1.007448e-01 1 1  ON 38
 eH1_9                 2.597455e-02 1 1  ON 39
 eH2_0                -2.032245e-01 1 1  ON 40
 eH2_1                -9.777925e-02 1 1  ON 41
 eH2_2                -4.644786e-02 1 1  ON 42
 eH2_3                -1.573683e-02 1 1  ON 43
 eH2_4                 1.620441e-02 1 1  ON 44
 eH2_5                 1.968142e-02 1 1  ON 45
 eH2_6                 7.229705e-02 1 1  ON 46
 eH2_7                 1.102410e-01 1 1  ON 47
 eH2_8                 1.031966e-01 1 1  ON 48
 eH2_9                 2.888683e-02 1 1  ON 49
ci_001                -4.202689e-02 3 1  ON 50
ci_002                -3.074545e-02 3 1  ON 51
ci_003                -1.121815e-02 3 1  ON 52
ci_004                 2.575855e-02 3 1  ON 53
ci_005                 2.584680e-02 3 1  ON 54
ci_006                -2.026425e-02 3 1  ON 55
ci_007                -1.960700e-02 3 1  ON 56
ci_008                -4.082278e-03 3 1  ON 57
ci_009                -1.508766e-02 3 1  ON 58
ci_010                -9.387996e-03 3 1  ON 59
ci_011                -9.706569e-03 3 1  ON 60
ci_012                -9.691157e-03 3 1  ON 61
ci_013                -2.171569e-02 3 1  ON 62
ci_014                 1.318218e-02 3 1  ON 63
ci_015                 1.293759e-02 3 1  ON 64
ci_016                 1.627989e-02 3 1  ON 65
ci_017                 1.617315e-02 3 1  ON 66
ci_018                 1.088978e-02 3 1  ON 67
ci_019                 1.073491e-02 3 1  ON 68
ci_020                 1.828323e-02 3 1  ON 69
ci_021                 1.805206e-02 3 1  ON 70
ci_022                 1.037281e-02 3 1  ON 71
ci_023                 1.008415e-02 3 1  ON 72
ci_024                 6.656650e-03 3 1  ON 73
ci_025                 6.597206e-03 3 1  ON 74
ci_026                 1.162130e-02 3 1  ON 75
ci_027                 1.162306e-02 3 1  ON 76
ci_028                -8.917621e-03 3 1  ON 77
ci_029                -9.865864e-03 3 1  ON 78
ci_030                -5.341376e-03 3 1  ON 79
ci_031                -4.560688e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.1874
    reference variance = 0.218356
====================================================
  Execution time = 1.9177e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9510e-01
  Total weights = 1.9735e+06
  Execution time = 1.5656e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289330582734
                                         uncertainty =       0.002301989726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289330582734
                                         uncertainty =       0.002301989726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380348558
  error estimate for blocks of size 2^( 2) =       0.000395705541
  error estimate for blocks of size 2^( 3) =       0.000409734949
  error estimate for blocks of size 2^( 4) =       0.000420138525
  error estimate for blocks of size 2^( 5) =       0.000426147119
  error estimate for blocks of size 2^( 6) =       0.000427779483
  error estimate for blocks of size 2^( 7) =       0.000430139009

      target function =      -0.920385597253
              le_mean =     -17.206608074169
             les_mean =     296.362464271127
             stat err =       0.000426051034
             autocorr =       1.254757210599
   target nu stat err =       0.000426051034
   target dn stat err =       0.002524266552
      target stat err =       0.004022557746
              std dev =       0.537894088490
             le_variance =       0.289330050432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289327989232
                                         uncertainty =       0.002301752134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289327989232
                                         uncertainty =       0.002301752134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380346832
  error estimate for blocks of size 2^( 2) =       0.000395705603
  error estimate for blocks of size 2^( 3) =       0.000409735832
  error estimate for blocks of size 2^( 4) =       0.000420139862
  error estimate for blocks of size 2^( 5) =       0.000426148894
  error estimate for blocks of size 2^( 6) =       0.000427781766
  error estimate for blocks of size 2^( 7) =       0.000430142168

      target function =      -0.920386244175
              le_mean =     -17.206608101363
             les_mean =     296.362464794638
             stat err =       0.000426053172
             autocorr =       1.254781193081
   target nu stat err =       0.000426053172
   target dn stat err =       0.002524199302
      target stat err =       0.004022460484
              std dev =       0.537891648011
             le_variance =       0.289327425000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289329245230
                                         uncertainty =       0.002301869646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289329245230
                                         uncertainty =       0.002301869646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380347668
  error estimate for blocks of size 2^( 2) =       0.000395705555
  error estimate for blocks of size 2^( 3) =       0.000409735379
  error estimate for blocks of size 2^( 4) =       0.000420139186
  error estimate for blocks of size 2^( 5) =       0.000426148003
  error estimate for blocks of size 2^( 6) =       0.000427780622
  error estimate for blocks of size 2^( 7) =       0.000430140589

      target function =      -0.920386399226
              le_mean =     -17.206608083983
             les_mean =     296.362464097485
             stat err =       0.000426052100
             autocorr =       1.254769361223
   target nu stat err =       0.000426052100
   target dn stat err =       0.002524227029
      target stat err =       0.004022504107
              std dev =       0.537892830229
             le_variance =       0.289328696812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289330412885
                                         uncertainty =       0.002301974647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289330412885
                                         uncertainty =       0.002301974647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380348445
  error estimate for blocks of size 2^( 2) =       0.000395705541
  error estimate for blocks of size 2^( 3) =       0.000409735001
  error estimate for blocks of size 2^( 4) =       0.000420138606
  error estimate for blocks of size 2^( 5) =       0.000426147228
  error estimate for blocks of size 2^( 6) =       0.000427779624
  error estimate for blocks of size 2^( 7) =       0.000430139205

      target function =      -0.920385745321
              le_mean =     -17.206608074941
             les_mean =     296.362464203255
             stat err =       0.000426051166
             autocorr =       1.254758732721
   target nu stat err =       0.000426051166
   target dn stat err =       0.002524261093
      target stat err =       0.004022550649
              std dev =       0.537893928729
             le_variance =       0.289329878563


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920385597253        initial
     5.8208e+00     5.8208e+01             4.6921e-05        -0.920386244175
     2.3283e+01     2.3283e+02             1.1734e-05        -0.920386399226  <--
     9.3132e+01     9.3132e+02             2.9266e-06        -0.920385745321

*****************************************************************************
Applying the update for shift_i =   2.3283e+01     and shift_s =   2.3283e+02
*****************************************************************************

  Execution time = 2.7085e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
  uu_0                 2.101255e-01 1 1  ON 0
  uu_1                 5.290477e-02 1 1  ON 1
  uu_2                -3.815830e-02 1 1  ON 2
  uu_3                -9.160355e-02 1 1  ON 3
  uu_4                -1.222666e-01 1 1  ON 4
  uu_5                -1.300377e-01 1 1  ON 5
  uu_6                -1.127063e-01 1 1  ON 6
  uu_7                -5.666059e-02 1 1  ON 7
  uu_8                 5.953255e-02 1 1  ON 8
  uu_9                 1.247602e-01 1 1  ON 9
  ud_0                 3.049967e-01 1 1  ON 10
  ud_1                 7.588147e-02 1 1  ON 11
  ud_2                -2.632049e-02 1 1  ON 12
  ud_3                -7.922133e-02 1 1  ON 13
  ud_4                -1.148941e-01 1 1  ON 14
  ud_5                -1.333553e-01 1 1  ON 15
  ud_6                -1.265377e-01 1 1  ON 16
  ud_7                -8.497760e-02 1 1  ON 17
  ud_8                -6.109705e-03 1 1  ON 18
  ud_9                 8.605382e-02 1 1  ON 19
  eO_0                -7.034678e-01 1 1  ON 20
  eO_1                -4.200984e-01 1 1  ON 21
  eO_2                -4.157961e-02 1 1  ON 22
  eO_3                 1.846213e-01 1 1  ON 23
  eO_4                 2.569315e-01 1 1  ON 24
  eO_5                 2.800367e-01 1 1  ON 25
  eO_6                 2.510170e-01 1 1  ON 26
  eO_7                 1.326793e-01 1 1  ON 27
  eO_8                 2.925334e-02 1 1  ON 28
  eO_9                 1.915501e-02 1 1  ON 29
 eH1_0                -2.016911e-01 1 1  ON 30
 eH1_1                -9.602828e-02 1 1  ON 31
 eH1_2                -4.463291e-02 1 1  ON 32
 eH1_3                -1.413886e-02 1 1  ON 33
 eH1_4                 1.844456e-02 1 1  ON 34
 eH1_5                 2.172626e-02 1 1  ON 35
 eH1_6                 7.077778e-02 1 1  ON 36
 eH1_7                 1.028323e-01 1 1  ON 37
 eH1_8                 1.007448e-01 1 1  ON 38
 eH1_9                 2.597455e-02 1 1  ON 39
 eH2_0                -2.032245e-01 1 1  ON 40
 eH2_1                -9.777925e-02 1 1  ON 41
 eH2_2                -4.644786e-02 1 1  ON 42
 eH2_3                -1.573683e-02 1 1  ON 43
 eH2_4                 1.620441e-02 1 1  ON 44
 eH2_5                 1.968142e-02 1 1  ON 45
 eH2_6                 7.229705e-02 1 1  ON 46
 eH2_7                 1.102410e-01 1 1  ON 47
 eH2_8                 1.031966e-01 1 1  ON 48
 eH2_9                 2.888683e-02 1 1  ON 49
ci_001                -4.202689e-02 3 1  ON 50
ci_002                -3.074545e-02 3 1  ON 51
ci_003                -1.121815e-02 3 1  ON 52
ci_004                 2.575855e-02 3 1  ON 53
ci_005                 2.584680e-02 3 1  ON 54
ci_006                -2.026425e-02 3 1  ON 55
ci_007                -1.960700e-02 3 1  ON 56
ci_008                -4.082278e-03 3 1  ON 57
ci_009                -1.508766e-02 3 1  ON 58
ci_010                -9.387996e-03 3 1  ON 59
ci_011                -9.706569e-03 3 1  ON 60
ci_012                -9.691157e-03 3 1  ON 61
ci_013                -2.171569e-02 3 1  ON 62
ci_014                 1.318218e-02 3 1  ON 63
ci_015                 1.293759e-02 3 1  ON 64
ci_016                 1.627989e-02 3 1  ON 65
ci_017                 1.617315e-02 3 1  ON 66
ci_018                 1.088978e-02 3 1  ON 67
ci_019                 1.073491e-02 3 1  ON 68
ci_020                 1.828323e-02 3 1  ON 69
ci_021                 1.805206e-02 3 1  ON 70
ci_022                 1.037281e-02 3 1  ON 71
ci_023                 1.008415e-02 3 1  ON 72
ci_024                 6.656650e-03 3 1  ON 73
ci_025                 6.597206e-03 3 1  ON 74
ci_026                 1.162130e-02 3 1  ON 75
ci_027                 1.162306e-02 3 1  ON 76
ci_028                -8.917621e-03 3 1  ON 77
ci_029                -9.865864e-03 3 1  ON 78
ci_030                -5.341376e-03 3 1  ON 79
ci_031                -4.560688e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1857e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7196e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2649
    reference variance = 0.222763
====================================================
  Execution time = 1.9247e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5429e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0001e-01
  Total weights = 1.973914100e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5483e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291732072149
                                         uncertainty =       0.002143849006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291732072149
                                         uncertainty =       0.002143849006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382002795
  error estimate for blocks of size 2^( 2) =       0.000397726594
  error estimate for blocks of size 2^( 3) =       0.000412344982
  error estimate for blocks of size 2^( 4) =       0.000422856144
  error estimate for blocks of size 2^( 5) =       0.000429277483
  error estimate for blocks of size 2^( 6) =       0.000432736207
  error estimate for blocks of size 2^( 7) =       0.000434736394

      target function =      -0.912781072167
              le_mean =     -17.205571387279
             les_mean =     296.331695253446
             stat err =       0.000429901557
             autocorr =       1.266499305511
   target nu stat err =       0.000429901557
   target dn stat err =       0.002593188052
      target stat err =       0.004055345023
              std dev =       0.540233533087
             le_variance =       0.291852270272


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720557138728e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912798180840       residual = 4.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912801996066       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912802912387       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912803092681       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912803163333       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912803172550       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912803199219       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912803198004       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912803195784       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912803237172       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912803288088       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912803306370       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912803313238       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912803307718       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912803331098       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912803351662       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912803356967       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912803349629       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912803353733       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912803354806       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912803357023       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912803353944       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912803360702       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912803362686       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912803365278       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912803368107       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912803369893       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912803369558       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912803361210       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912803364124       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912803366402       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912803365348       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912803365898       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912803365513       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912803365007       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912803364521       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.8208e+00 is 6.596843e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912798180840       residual = 4.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912799144012       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912799374626       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912799420187       residual = 6.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912799437957       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912799440228       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912799446941       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912799446639       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912799446080       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912799456521       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912799469256       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912799473819       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912799475527       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912799474137       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912799480060       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912799485180       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912799486459       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912799484604       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912799485664       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912799485924       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912799486474       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912799485712       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912799487384       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912799487877       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912799488520       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912799489231       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912799489668       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912799489530       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912799487473       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912799488236       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912799488782       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912799488516       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912799488659       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912799488561       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912799488439       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912799488317       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3283e+01 is 1.650651e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912798180840       residual = 4.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912798422226       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912798479976       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912798491397       residual = 6.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912798495846       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912798496412       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912798498093       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912798498017       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912798497877       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912798500494       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912798503678       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912798504818       residual = 9.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912798505244       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912798504896       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912798506382       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912798507661       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912798507977       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912798507512       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912798507780       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912798507844       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912798507981       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912798507791       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912798508208       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912798508331       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912798508492       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912798508669       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912798508778       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912798508741       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912798508228       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912798508421       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912798508555       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912798508489       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912798508525       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912798508501       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912798508471       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912798508440       residual = 2.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.3132e+01 is 4.127529e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.903668 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4851e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
  uu_0                 2.101272e-01 1 1  ON 0
  uu_1                 5.290904e-02 1 1  ON 1
  uu_2                -3.815439e-02 1 1  ON 2
  uu_3                -9.160017e-02 1 1  ON 3
  uu_4                -1.222654e-01 1 1  ON 4
  uu_5                -1.300352e-01 1 1  ON 5
  uu_6                -1.127090e-01 1 1  ON 6
  uu_7                -5.666413e-02 1 1  ON 7
  uu_8                 5.951604e-02 1 1  ON 8
  uu_9                 1.247591e-01 1 1  ON 9
  ud_0                 3.049954e-01 1 1  ON 10
  ud_1                 7.587922e-02 1 1  ON 11
  ud_2                -2.632298e-02 1 1  ON 12
  ud_3                -7.922353e-02 1 1  ON 13
  ud_4                -1.148949e-01 1 1  ON 14
  ud_5                -1.333514e-01 1 1  ON 15
  ud_6                -1.265332e-01 1 1  ON 16
  ud_7                -8.496863e-02 1 1  ON 17
  ud_8                -6.116327e-03 1 1  ON 18
  ud_9                 8.604852e-02 1 1  ON 19
  eO_0                -7.034735e-01 1 1  ON 20
  eO_1                -4.201055e-01 1 1  ON 21
  eO_2                -4.158204e-02 1 1  ON 22
  eO_3                 1.846248e-01 1 1  ON 23
  eO_4                 2.569332e-01 1 1  ON 24
  eO_5                 2.800333e-01 1 1  ON 25
  eO_6                 2.510195e-01 1 1  ON 26
  eO_7                 1.326898e-01 1 1  ON 27
  eO_8                 2.925401e-02 1 1  ON 28
  eO_9                 1.915461e-02 1 1  ON 29
 eH1_0                -2.016877e-01 1 1  ON 30
 eH1_1                -9.602721e-02 1 1  ON 31
 eH1_2                -4.463441e-02 1 1  ON 32
 eH1_3                -1.413986e-02 1 1  ON 33
 eH1_4                 1.843968e-02 1 1  ON 34
 eH1_5                 2.172065e-02 1 1  ON 35
 eH1_6                 7.077935e-02 1 1  ON 36
 eH1_7                 1.028341e-01 1 1  ON 37
 eH1_8                 1.007496e-01 1 1  ON 38
 eH1_9                 2.597493e-02 1 1  ON 39
 eH2_0                -2.032250e-01 1 1  ON 40
 eH2_1                -9.777775e-02 1 1  ON 41
 eH2_2                -4.644730e-02 1 1  ON 42
 eH2_3                -1.573514e-02 1 1  ON 43
 eH2_4                 1.620178e-02 1 1  ON 44
 eH2_5                 1.967769e-02 1 1  ON 45
 eH2_6                 7.229918e-02 1 1  ON 46
 eH2_7                 1.102358e-01 1 1  ON 47
 eH2_8                 1.032010e-01 1 1  ON 48
 eH2_9                 2.888889e-02 1 1  ON 49
ci_001                -4.202339e-02 3 1  ON 50
ci_002                -3.074286e-02 3 1  ON 51
ci_003                -1.121438e-02 3 1  ON 52
ci_004                 2.575782e-02 3 1  ON 53
ci_005                 2.584685e-02 3 1  ON 54
ci_006                -2.026321e-02 3 1  ON 55
ci_007                -1.960518e-02 3 1  ON 56
ci_008                -4.084076e-03 3 1  ON 57
ci_009                -1.508691e-02 3 1  ON 58
ci_010                -9.387270e-03 3 1  ON 59
ci_011                -9.704710e-03 3 1  ON 60
ci_012                -9.696354e-03 3 1  ON 61
ci_013                -2.171670e-02 3 1  ON 62
ci_014                 1.318330e-02 3 1  ON 63
ci_015                 1.293462e-02 3 1  ON 64
ci_016                 1.628081e-02 3 1  ON 65
ci_017                 1.617304e-02 3 1  ON 66
ci_018                 1.088692e-02 3 1  ON 67
ci_019                 1.073223e-02 3 1  ON 68
ci_020                 1.827946e-02 3 1  ON 69
ci_021                 1.805364e-02 3 1  ON 70
ci_022                 1.036886e-02 3 1  ON 71
ci_023                 1.008344e-02 3 1  ON 72
ci_024                 6.654591e-03 3 1  ON 73
ci_025                 6.597555e-03 3 1  ON 74
ci_026                 1.161932e-02 3 1  ON 75
ci_027                 1.162404e-02 3 1  ON 76
ci_028                -8.917207e-03 3 1  ON 77
ci_029                -9.858364e-03 3 1  ON 78
ci_030                -5.340663e-03 3 1  ON 79
ci_031                -4.557015e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.1727
    reference variance = 0.244438
====================================================
  Execution time = 1.9370e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9645e-01
  Total weights = 1.9740e+06
  Execution time = 1.5800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288442151484
                                         uncertainty =       0.001723330921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288442151484
                                         uncertainty =       0.001723330921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379802792
  error estimate for blocks of size 2^( 2) =       0.000395353397
  error estimate for blocks of size 2^( 3) =       0.000409258639
  error estimate for blocks of size 2^( 4) =       0.000419621226
  error estimate for blocks of size 2^( 5) =       0.000425049396
  error estimate for blocks of size 2^( 6) =       0.000428256907
  error estimate for blocks of size 2^( 7) =       0.000431034800

      target function =      -0.918271491097
              le_mean =     -17.206623955177
             les_mean =     296.364362389412
             stat err =       0.000425990582
             autocorr =       1.258008834132
   target nu stat err =       0.000425990582
   target dn stat err =       0.002533474371
      target stat err =       0.004018630814
              std dev =       0.537122258818
             le_variance =       0.288500320918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288441426184
                                         uncertainty =       0.001723173585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288441426184
                                         uncertainty =       0.001723173585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379802287
  error estimate for blocks of size 2^( 2) =       0.000395354150
  error estimate for blocks of size 2^( 3) =       0.000409260448
  error estimate for blocks of size 2^( 4) =       0.000419624234
  error estimate for blocks of size 2^( 5) =       0.000425053186
  error estimate for blocks of size 2^( 6) =       0.000428260648
  error estimate for blocks of size 2^( 7) =       0.000431037280

      target function =      -0.918269450680
              le_mean =     -17.206624291150
             les_mean =     296.364375253045
             stat err =       0.000425993837
             autocorr =       1.258031401110
   target nu stat err =       0.000425993837
   target dn stat err =       0.002533890162
      target stat err =       0.004019254899
              std dev =       0.537121545082
             le_variance =       0.288499554192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288441772843
                                         uncertainty =       0.001723251155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288441772843
                                         uncertainty =       0.001723251155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379802529
  error estimate for blocks of size 2^( 2) =       0.000395353768
  error estimate for blocks of size 2^( 3) =       0.000409259543
  error estimate for blocks of size 2^( 4) =       0.000419622735
  error estimate for blocks of size 2^( 5) =       0.000425051299
  error estimate for blocks of size 2^( 6) =       0.000428258786
  error estimate for blocks of size 2^( 7) =       0.000431036043

      target function =      -0.918271344702
              le_mean =     -17.206624122837
             les_mean =     296.364368249967
             stat err =       0.000425992216
             autocorr =       1.258020226101
   target nu stat err =       0.000425992216
   target dn stat err =       0.002533677218
      target stat err =       0.004018942633
              std dev =       0.537121886870
             le_variance =       0.288499921355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288442102549
                                         uncertainty =       0.001723320904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288442102549
                                         uncertainty =       0.001723320904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379802758
  error estimate for blocks of size 2^( 2) =       0.000395353443
  error estimate for blocks of size 2^( 3) =       0.000409258751
  error estimate for blocks of size 2^( 4) =       0.000419621414
  error estimate for blocks of size 2^( 5) =       0.000425049633
  error estimate for blocks of size 2^( 6) =       0.000428257142
  error estimate for blocks of size 2^( 7) =       0.000431034955

      target function =      -0.918271706865
              le_mean =     -17.206623975955
             les_mean =     296.364362965761
             stat err =       0.000425990786
             autocorr =       1.258010262553
   target nu stat err =       0.000425990786
   target dn stat err =       0.002533498980
      target stat err =       0.004018670661
              std dev =       0.537122210822
             le_variance =       0.288500269358


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918271491097        initial
     5.8208e+00     5.8208e+01             6.5968e-05        -0.918269450680
     2.3283e+01     2.3283e+02             1.6507e-05        -0.918271344702
     9.3132e+01     9.3132e+02             4.1275e-06        -0.918271706865  <--

*****************************************************************************
Applying the update for shift_i =   9.3132e+01     and shift_s =   9.3132e+02
*****************************************************************************

  Execution time = 2.7315e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
  uu_0                 2.101259e-01 1 1  ON 0
  uu_1                 5.290584e-02 1 1  ON 1
  uu_2                -3.815732e-02 1 1  ON 2
  uu_3                -9.160271e-02 1 1  ON 3
  uu_4                -1.222663e-01 1 1  ON 4
  uu_5                -1.300371e-01 1 1  ON 5
  uu_6                -1.127069e-01 1 1  ON 6
  uu_7                -5.666147e-02 1 1  ON 7
  uu_8                 5.952842e-02 1 1  ON 8
  uu_9                 1.247600e-01 1 1  ON 9
  ud_0                 3.049964e-01 1 1  ON 10
  ud_1                 7.588091e-02 1 1  ON 11
  ud_2                -2.632112e-02 1 1  ON 12
  ud_3                -7.922188e-02 1 1  ON 13
  ud_4                -1.148943e-01 1 1  ON 14
  ud_5                -1.333543e-01 1 1  ON 15
  ud_6                -1.265366e-01 1 1  ON 16
  ud_7                -8.497535e-02 1 1  ON 17
  ud_8                -6.111362e-03 1 1  ON 18
  ud_9                 8.605249e-02 1 1  ON 19
  eO_0                -7.034692e-01 1 1  ON 20
  eO_1                -4.201002e-01 1 1  ON 21
  eO_2                -4.158022e-02 1 1  ON 22
  eO_3                 1.846222e-01 1 1  ON 23
  eO_4                 2.569319e-01 1 1  ON 24
  eO_5                 2.800359e-01 1 1  ON 25
  eO_6                 2.510176e-01 1 1  ON 26
  eO_7                 1.326820e-01 1 1  ON 27
  eO_8                 2.925351e-02 1 1  ON 28
  eO_9                 1.915491e-02 1 1  ON 29
 eH1_0                -2.016902e-01 1 1  ON 30
 eH1_1                -9.602801e-02 1 1  ON 31
 eH1_2                -4.463329e-02 1 1  ON 32
 eH1_3                -1.413911e-02 1 1  ON 33
 eH1_4                 1.844334e-02 1 1  ON 34
 eH1_5                 2.172486e-02 1 1  ON 35
 eH1_6                 7.077817e-02 1 1  ON 36
 eH1_7                 1.028328e-01 1 1  ON 37
 eH1_8                 1.007460e-01 1 1  ON 38
 eH1_9                 2.597464e-02 1 1  ON 39
 eH2_0                -2.032246e-01 1 1  ON 40
 eH2_1                -9.777888e-02 1 1  ON 41
 eH2_2                -4.644772e-02 1 1  ON 42
 eH2_3                -1.573640e-02 1 1  ON 43
 eH2_4                 1.620375e-02 1 1  ON 44
 eH2_5                 1.968049e-02 1 1  ON 45
 eH2_6                 7.229758e-02 1 1  ON 46
 eH2_7                 1.102397e-01 1 1  ON 47
 eH2_8                 1.031977e-01 1 1  ON 48
 eH2_9                 2.888735e-02 1 1  ON 49
ci_001                -4.202601e-02 3 1  ON 50
ci_002                -3.074480e-02 3 1  ON 51
ci_003                -1.121720e-02 3 1  ON 52
ci_004                 2.575837e-02 3 1  ON 53
ci_005                 2.584682e-02 3 1  ON 54
ci_006                -2.026399e-02 3 1  ON 55
ci_007                -1.960654e-02 3 1  ON 56
ci_008                -4.082729e-03 3 1  ON 57
ci_009                -1.508747e-02 3 1  ON 58
ci_010                -9.387814e-03 3 1  ON 59
ci_011                -9.706103e-03 3 1  ON 60
ci_012                -9.692459e-03 3 1  ON 61
ci_013                -2.171594e-02 3 1  ON 62
ci_014                 1.318246e-02 3 1  ON 63
ci_015                 1.293685e-02 3 1  ON 64
ci_016                 1.628012e-02 3 1  ON 65
ci_017                 1.617312e-02 3 1  ON 66
ci_018                 1.088906e-02 3 1  ON 67
ci_019                 1.073424e-02 3 1  ON 68
ci_020                 1.828229e-02 3 1  ON 69
ci_021                 1.805246e-02 3 1  ON 70
ci_022                 1.037182e-02 3 1  ON 71
ci_023                 1.008397e-02 3 1  ON 72
ci_024                 6.656134e-03 3 1  ON 73
ci_025                 6.597293e-03 3 1  ON 74
ci_026                 1.162080e-02 3 1  ON 75
ci_027                 1.162331e-02 3 1  ON 76
ci_028                -8.917517e-03 3 1  ON 77
ci_029                -9.863985e-03 3 1  ON 78
ci_030                -5.341197e-03 3 1  ON 79
ci_031                -4.559768e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2173e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.1712
    reference variance = 0.232717
====================================================
  Execution time = 1.8997e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5446e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0665e-01
  Total weights = 1.973925540e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4933e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294710044980
                                         uncertainty =       0.002339857552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294710044980
                                         uncertainty =       0.002339857552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383853497
  error estimate for blocks of size 2^( 2) =       0.000399003417
  error estimate for blocks of size 2^( 3) =       0.000412781028
  error estimate for blocks of size 2^( 4) =       0.000423981262
  error estimate for blocks of size 2^( 5) =       0.000430038377
  error estimate for blocks of size 2^( 6) =       0.000432922298
  error estimate for blocks of size 2^( 7) =       0.000435294053

      target function =      -0.902612064014
              le_mean =     -17.206618561715
             les_mean =     296.374373499127
             stat err =       0.000430558997
             autocorr =       1.258155543087
   target nu stat err =       0.000430558997
   target dn stat err =       0.003892739599
      target stat err =       0.005912317854
              std dev =       0.542850821456
             le_variance =       0.294687014355


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720661856172e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902649427262       residual = 7.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902650990900       residual = 8.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902651176561       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902651254494       residual = 9.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902651273252       residual = 9.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902651300216       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902651315593       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902651334073       residual = 6.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902651346492       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902651345781       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902651363509       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.902651364026       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.902651373061       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.902651384297       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.902651388762       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.902651393241       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.902651395933       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.902651398434       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.902651399137       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.902651400504       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.902651399266       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.902651402331       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.902651402937       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.902651403505       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.902651405339       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.902651405633       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.902651406449       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.902651407191       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.902651407307       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.902651406940       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.902651407160       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.902651407305       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.902651408605       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.902651408786       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.902651408230       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.902651408544       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3283e+01 is 1.426437e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902649427262       residual = 7.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902649819115       residual = 8.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902649865607       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902649885122       residual = 9.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902649889826       residual = 9.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902649896574       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902649900423       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902649905050       residual = 6.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902649908160       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902649907980       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902649912420       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.902649912551       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.902649914806       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.902649917618       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.902649918735       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.902649919855       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.902649920526       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.902649921153       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.902649921325       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.902649921668       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.902649921358       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.902649922125       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.902649922275       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.902649922416       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.902649922875       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.902649922948       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.902649923152       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.902649923337       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.902649923364       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.902649923273       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.902649923328       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.902649923364       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.902649923689       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.902649923732       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.902649923595       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.902649923673       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.3132e+01 is 3.571815e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902649427262       residual = 7.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902649525285       residual = 8.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902649536912       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902649541793       residual = 9.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902649542970       residual = 9.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902649544657       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902649545620       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902649546777       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902649547555       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902649547510       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902649548621       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.902649548654       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.902649549216       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.902649549919       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.902649550199       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.902649550480       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.902649550648       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.902649550804       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.902649550847       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.902649550932       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.902649550856       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.902649551047       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.902649551085       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.902649551119       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.902649551232       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.902649551252       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.902649551303       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.902649551348       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.902649551356       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.902649551332       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.902649551347       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.902649551356       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.902649551438       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.902649551448       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.902649551414       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.902649551433       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.7253e+02 is 8.933122e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               2.953223 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4546e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
  uu_0                 2.101265e-01 1 1  ON 0
  uu_1                 5.290623e-02 1 1  ON 1
  uu_2                -3.815664e-02 1 1  ON 2
  uu_3                -9.160194e-02 1 1  ON 3
  uu_4                -1.222657e-01 1 1  ON 4
  uu_5                -1.300366e-01 1 1  ON 5
  uu_6                -1.127058e-01 1 1  ON 6
  uu_7                -5.666359e-02 1 1  ON 7
  uu_8                 5.952535e-02 1 1  ON 8
  uu_9                 1.247596e-01 1 1  ON 9
  ud_0                 3.049950e-01 1 1  ON 10
  ud_1                 7.587958e-02 1 1  ON 11
  ud_2                -2.632167e-02 1 1  ON 12
  ud_3                -7.922154e-02 1 1  ON 13
  ud_4                -1.148933e-01 1 1  ON 14
  ud_5                -1.333520e-01 1 1  ON 15
  ud_6                -1.265358e-01 1 1  ON 16
  ud_7                -8.497632e-02 1 1  ON 17
  ud_8                -6.112131e-03 1 1  ON 18
  ud_9                 8.605173e-02 1 1  ON 19
  eO_0                -7.034657e-01 1 1  ON 20
  eO_1                -4.200984e-01 1 1  ON 21
  eO_2                -4.157982e-02 1 1  ON 22
  eO_3                 1.846194e-01 1 1  ON 23
  eO_4                 2.569287e-01 1 1  ON 24
  eO_5                 2.800337e-01 1 1  ON 25
  eO_6                 2.510177e-01 1 1  ON 26
  eO_7                 1.326840e-01 1 1  ON 27
  eO_8                 2.925372e-02 1 1  ON 28
  eO_9                 1.915494e-02 1 1  ON 29
 eH1_0                -2.016897e-01 1 1  ON 30
 eH1_1                -9.602646e-02 1 1  ON 31
 eH1_2                -4.463224e-02 1 1  ON 32
 eH1_3                -1.413878e-02 1 1  ON 33
 eH1_4                 1.844364e-02 1 1  ON 34
 eH1_5                 2.172255e-02 1 1  ON 35
 eH1_6                 7.077589e-02 1 1  ON 36
 eH1_7                 1.028328e-01 1 1  ON 37
 eH1_8                 1.007466e-01 1 1  ON 38
 eH1_9                 2.597478e-02 1 1  ON 39
 eH2_0                -2.032246e-01 1 1  ON 40
 eH2_1                -9.777973e-02 1 1  ON 41
 eH2_2                -4.644809e-02 1 1  ON 42
 eH2_3                -1.573754e-02 1 1  ON 43
 eH2_4                 1.620282e-02 1 1  ON 44
 eH2_5                 1.968226e-02 1 1  ON 45
 eH2_6                 7.229890e-02 1 1  ON 46
 eH2_7                 1.102386e-01 1 1  ON 47
 eH2_8                 1.031988e-01 1 1  ON 48
 eH2_9                 2.888760e-02 1 1  ON 49
ci_001                -4.202598e-02 3 1  ON 50
ci_002                -3.074539e-02 3 1  ON 51
ci_003                -1.121740e-02 3 1  ON 52
ci_004                 2.575910e-02 3 1  ON 53
ci_005                 2.584638e-02 3 1  ON 54
ci_006                -2.026368e-02 3 1  ON 55
ci_007                -1.960732e-02 3 1  ON 56
ci_008                -4.082834e-03 3 1  ON 57
ci_009                -1.508837e-02 3 1  ON 58
ci_010                -9.387171e-03 3 1  ON 59
ci_011                -9.706299e-03 3 1  ON 60
ci_012                -9.692875e-03 3 1  ON 61
ci_013                -2.171472e-02 3 1  ON 62
ci_014                 1.318139e-02 3 1  ON 63
ci_015                 1.293581e-02 3 1  ON 64
ci_016                 1.628030e-02 3 1  ON 65
ci_017                 1.617174e-02 3 1  ON 66
ci_018                 1.088842e-02 3 1  ON 67
ci_019                 1.073373e-02 3 1  ON 68
ci_020                 1.828272e-02 3 1  ON 69
ci_021                 1.805210e-02 3 1  ON 70
ci_022                 1.037188e-02 3 1  ON 71
ci_023                 1.008345e-02 3 1  ON 72
ci_024                 6.655614e-03 3 1  ON 73
ci_025                 6.596715e-03 3 1  ON 74
ci_026                 1.162117e-02 3 1  ON 75
ci_027                 1.162333e-02 3 1  ON 76
ci_028                -8.918029e-03 3 1  ON 77
ci_029                -9.863211e-03 3 1  ON 78
ci_030                -5.339060e-03 3 1  ON 79
ci_031                -4.558438e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2235
    reference variance = 0.267119
====================================================
  Execution time = 1.9102e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0300e-01
  Total weights = 1.9738e+06
  Execution time = 1.5632e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295929669846
                                         uncertainty =       0.004052246056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295929669846
                                         uncertainty =       0.004052246056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384639022
  error estimate for blocks of size 2^( 2) =       0.000399818300
  error estimate for blocks of size 2^( 3) =       0.000413356506
  error estimate for blocks of size 2^( 4) =       0.000424024508
  error estimate for blocks of size 2^( 5) =       0.000430387878
  error estimate for blocks of size 2^( 6) =       0.000433235490
  error estimate for blocks of size 2^( 7) =       0.000436007531

      target function =      -0.908129038605
              le_mean =     -17.206624336859
             les_mean =     296.370919152696
             stat err =       0.000430913852
             autocorr =       1.255088140606
   target nu stat err =       0.000430913852
   target dn stat err =       0.004879118438
      target stat err =       0.007481012271
              std dev =       0.543961721440
             le_variance =       0.295894354392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295929452724
                                         uncertainty =       0.004052497316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295929452724
                                         uncertainty =       0.004052497316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384638887
  error estimate for blocks of size 2^( 2) =       0.000399819023
  error estimate for blocks of size 2^( 3) =       0.000413358065
  error estimate for blocks of size 2^( 4) =       0.000424026791
  error estimate for blocks of size 2^( 5) =       0.000430390592
  error estimate for blocks of size 2^( 6) =       0.000433238392
  error estimate for blocks of size 2^( 7) =       0.000436010059

      target function =      -0.908135555225
              le_mean =     -17.206624333198
             les_mean =     296.370914753229
             stat err =       0.000430916458
             autocorr =       1.255104209499
   target nu stat err =       0.000430916458
   target dn stat err =       0.004879289673
      target stat err =       0.007481379643
              std dev =       0.543961530028
             le_variance =       0.295894146151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295929560044
                                         uncertainty =       0.004052372035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295929560044
                                         uncertainty =       0.004052372035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384638953
  error estimate for blocks of size 2^( 2) =       0.000399818662
  error estimate for blocks of size 2^( 3) =       0.000413357286
  error estimate for blocks of size 2^( 4) =       0.000424025651
  error estimate for blocks of size 2^( 5) =       0.000430389237
  error estimate for blocks of size 2^( 6) =       0.000433236943
  error estimate for blocks of size 2^( 7) =       0.000436008797

      target function =      -0.908132406127
              le_mean =     -17.206624334757
             les_mean =     296.370916872076
             stat err =       0.000430915157
             autocorr =       1.255096192051
   target nu stat err =       0.000430915157
   target dn stat err =       0.004879202584
      target stat err =       0.007481195509
              std dev =       0.543961624603
             le_variance =       0.295894249041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295929655964
                                         uncertainty =       0.004052261813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295929655964
                                         uncertainty =       0.004052261813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384639013
  error estimate for blocks of size 2^( 2) =       0.000399818345
  error estimate for blocks of size 2^( 3) =       0.000413356603
  error estimate for blocks of size 2^( 4) =       0.000424024651
  error estimate for blocks of size 2^( 5) =       0.000430388048
  error estimate for blocks of size 2^( 6) =       0.000433235671
  error estimate for blocks of size 2^( 7) =       0.000436007689

      target function =      -0.908129471207
              le_mean =     -17.206624336568
             les_mean =     296.370918859009
             stat err =       0.000430914015
             autocorr =       1.255089147631
   target nu stat err =       0.000430914015
   target dn stat err =       0.004879128767
      target stat err =       0.007481035078
              std dev =       0.543961709192
             le_variance =       0.295894341067


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908129038605        initial
     2.3283e+01     2.3283e+02             1.4264e-05        -0.908135555225  <--
     9.3132e+01     9.3132e+02             3.5718e-06        -0.908132406127
     3.7253e+02     3.7253e+03             8.9331e-07        -0.908129471207

*****************************************************************************
Applying the update for shift_i =   2.3283e+01     and shift_s =   2.3283e+02
*****************************************************************************

  Execution time = 2.6980e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
  uu_0                 2.101282e-01 1 1  ON 0
  uu_1                 5.290741e-02 1 1  ON 1
  uu_2                -3.815460e-02 1 1  ON 2
  uu_3                -9.159965e-02 1 1  ON 3
  uu_4                -1.222638e-01 1 1  ON 4
  uu_5                -1.300353e-01 1 1  ON 5
  uu_6                -1.127023e-01 1 1  ON 6
  uu_7                -5.666995e-02 1 1  ON 7
  uu_8                 5.951616e-02 1 1  ON 8
  uu_9                 1.247583e-01 1 1  ON 9
  ud_0                 3.049909e-01 1 1  ON 10
  ud_1                 7.587562e-02 1 1  ON 11
  ud_2                -2.632331e-02 1 1  ON 12
  ud_3                -7.922053e-02 1 1  ON 13
  ud_4                -1.148904e-01 1 1  ON 14
  ud_5                -1.333449e-01 1 1  ON 15
  ud_6                -1.265334e-01 1 1  ON 16
  ud_7                -8.497919e-02 1 1  ON 17
  ud_8                -6.114439e-03 1 1  ON 18
  ud_9                 8.604945e-02 1 1  ON 19
  eO_0                -7.034550e-01 1 1  ON 20
  eO_1                -4.200930e-01 1 1  ON 21
  eO_2                -4.157862e-02 1 1  ON 22
  eO_3                 1.846111e-01 1 1  ON 23
  eO_4                 2.569190e-01 1 1  ON 24
  eO_5                 2.800272e-01 1 1  ON 25
  eO_6                 2.510180e-01 1 1  ON 26
  eO_7                 1.326902e-01 1 1  ON 27
  eO_8                 2.925436e-02 1 1  ON 28
  eO_9                 1.915501e-02 1 1  ON 29
 eH1_0                -2.016879e-01 1 1  ON 30
 eH1_1                -9.602183e-02 1 1  ON 31
 eH1_2                -4.462909e-02 1 1  ON 32
 eH1_3                -1.413778e-02 1 1  ON 33
 eH1_4                 1.844455e-02 1 1  ON 34
 eH1_5                 2.171564e-02 1 1  ON 35
 eH1_6                 7.076906e-02 1 1  ON 36
 eH1_7                 1.028329e-01 1 1  ON 37
 eH1_8                 1.007482e-01 1 1  ON 38
 eH1_9                 2.597521e-02 1 1  ON 39
 eH2_0                -2.032246e-01 1 1  ON 40
 eH2_1                -9.778229e-02 1 1  ON 41
 eH2_2                -4.644921e-02 1 1  ON 42
 eH2_3                -1.574094e-02 1 1  ON 43
 eH2_4                 1.620002e-02 1 1  ON 44
 eH2_5                 1.968755e-02 1 1  ON 45
 eH2_6                 7.230285e-02 1 1  ON 46
 eH2_7                 1.102353e-01 1 1  ON 47
 eH2_8                 1.032019e-01 1 1  ON 48
 eH2_9                 2.888835e-02 1 1  ON 49
ci_001                -4.202587e-02 3 1  ON 50
ci_002                -3.074715e-02 3 1  ON 51
ci_003                -1.121797e-02 3 1  ON 52
ci_004                 2.576127e-02 3 1  ON 53
ci_005                 2.584509e-02 3 1  ON 54
ci_006                -2.026275e-02 3 1  ON 55
ci_007                -1.960964e-02 3 1  ON 56
ci_008                -4.083149e-03 3 1  ON 57
ci_009                -1.509108e-02 3 1  ON 58
ci_010                -9.385250e-03 3 1  ON 59
ci_011                -9.706886e-03 3 1  ON 60
ci_012                -9.694119e-03 3 1  ON 61
ci_013                -2.171105e-02 3 1  ON 62
ci_014                 1.317817e-02 3 1  ON 63
ci_015                 1.293270e-02 3 1  ON 64
ci_016                 1.628082e-02 3 1  ON 65
ci_017                 1.616759e-02 3 1  ON 66
ci_018                 1.088649e-02 3 1  ON 67
ci_019                 1.073221e-02 3 1  ON 68
ci_020                 1.828403e-02 3 1  ON 69
ci_021                 1.805103e-02 3 1  ON 70
ci_022                 1.037206e-02 3 1  ON 71
ci_023                 1.008190e-02 3 1  ON 72
ci_024                 6.654058e-03 3 1  ON 73
ci_025                 6.594986e-03 3 1  ON 74
ci_026                 1.162229e-02 3 1  ON 75
ci_027                 1.162339e-02 3 1  ON 76
ci_028                -8.919561e-03 3 1  ON 77
ci_029                -9.860896e-03 3 1  ON 78
ci_030                -5.332671e-03 3 1  ON 79
ci_031                -4.554463e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1538e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.1529
    reference variance = 0.443984
====================================================
  Execution time = 2.1396e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5417e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9730e-01
  Total weights = 1.973707321e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288890963237
                                         uncertainty =       0.001870822319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288890963237
                                         uncertainty =       0.001870822319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380051992
  error estimate for blocks of size 2^( 2) =       0.000395412710
  error estimate for blocks of size 2^( 3) =       0.000409824232
  error estimate for blocks of size 2^( 4) =       0.000419874788
  error estimate for blocks of size 2^( 5) =       0.000425829888
  error estimate for blocks of size 2^( 6) =       0.000429340644
  error estimate for blocks of size 2^( 7) =       0.000431375257

      target function =      -0.916948734293
              le_mean =     -17.206117089246
             les_mean =     296.347768338478
             stat err =       0.000426605144
             autocorr =       1.259987248242
   target nu stat err =       0.000426605144
   target dn stat err =       0.003071162202
      target stat err =       0.004828078849
              std dev =       0.537474681674
             le_variance =       0.288879033441


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720611708925e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916973260173       residual = 4.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916977388384       residual = 9.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916977958718       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916978398706       residual = 7.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916978406511       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916978403235       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916978401503       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916978425816       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916978402377       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916978406821       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916978454562       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916978471436       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916978488872       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916978499668       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916978492274       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916978488419       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916978480286       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916978484014       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916978484337       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916978491039       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916978506967       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916978502456       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916978507775       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916978513584       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916978513195       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916978523902       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916978524753       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916978524035       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916978528120       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916978525743       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916978525748       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916978527293       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916978526997       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916978525943       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916978526287       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916978525432       residual = 2.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.8208e+00 is 7.197981e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916973260173       residual = 4.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916974302371       residual = 9.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916974446035       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916974556581       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916974558467       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916974557616       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916974557128       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916974563278       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916974557440       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916974558579       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916974570613       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916974574833       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916974579150       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916974581843       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916974579971       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916974579034       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916974576993       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916974577886       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916974577971       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916974579697       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916974583680       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916974582543       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916974583845       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916974585266       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916974585226       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916974587882       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916974588063       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916974587897       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916974588907       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916974588308       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916974588317       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916974588702       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916974588615       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916974588362       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916974588441       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916974588233       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3283e+01 is 1.801682e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916973260173       residual = 4.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916973521364       residual = 9.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916973557348       residual = 4.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916973585019       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916973585487       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916973585271       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916973585146       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916973586688       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916973585230       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916973585517       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916973588531       residual = 8.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916973589586       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916973590663       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916973591336       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916973590866       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916973590634       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916973590123       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916973590344       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916973590366       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916973590800       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916973591796       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916973591511       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916973591835       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916973592188       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916973592181       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916973592844       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916973592888       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916973592846       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916973593099       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916973592949       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916973592951       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916973593048       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916973593025       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916973592963       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916973592982       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916973592930       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.3132e+01 is 4.505574e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.002765 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6935e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
  uu_0                 2.101290e-01 1 1  ON 0
  uu_1                 5.291239e-02 1 1  ON 1
  uu_2                -3.815103e-02 1 1  ON 2
  uu_3                -9.159606e-02 1 1  ON 3
  uu_4                -1.222618e-01 1 1  ON 4
  uu_5                -1.300305e-01 1 1  ON 5
  uu_6                -1.127046e-01 1 1  ON 6
  uu_7                -5.667075e-02 1 1  ON 7
  uu_8                 5.949815e-02 1 1  ON 8
  uu_9                 1.247579e-01 1 1  ON 9
  ud_0                 3.049909e-01 1 1  ON 10
  ud_1                 7.587499e-02 1 1  ON 11
  ud_2                -2.632599e-02 1 1  ON 12
  ud_3                -7.922322e-02 1 1  ON 13
  ud_4                -1.148904e-01 1 1  ON 14
  ud_5                -1.333393e-01 1 1  ON 15
  ud_6                -1.265271e-01 1 1  ON 16
  ud_7                -8.497745e-02 1 1  ON 17
  ud_8                -6.122246e-03 1 1  ON 18
  ud_9                 8.604472e-02 1 1  ON 19
  eO_0                -7.034612e-01 1 1  ON 20
  eO_1                -4.200985e-01 1 1  ON 21
  eO_2                -4.157751e-02 1 1  ON 22
  eO_3                 1.846141e-01 1 1  ON 23
  eO_4                 2.569164e-01 1 1  ON 24
  eO_5                 2.800288e-01 1 1  ON 25
  eO_6                 2.510189e-01 1 1  ON 26
  eO_7                 1.326984e-01 1 1  ON 27
  eO_8                 2.925407e-02 1 1  ON 28
  eO_9                 1.915469e-02 1 1  ON 29
 eH1_0                -2.016859e-01 1 1  ON 30
 eH1_1                -9.602208e-02 1 1  ON 31
 eH1_2                -4.462698e-02 1 1  ON 32
 eH1_3                -1.413566e-02 1 1  ON 33
 eH1_4                 1.844549e-02 1 1  ON 34
 eH1_5                 2.170650e-02 1 1  ON 35
 eH1_6                 7.077282e-02 1 1  ON 36
 eH1_7                 1.028295e-01 1 1  ON 37
 eH1_8                 1.007495e-01 1 1  ON 38
 eH1_9                 2.597590e-02 1 1  ON 39
 eH2_0                -2.032222e-01 1 1  ON 40
 eH2_1                -9.778259e-02 1 1  ON 41
 eH2_2                -4.645034e-02 1 1  ON 42
 eH2_3                -1.574555e-02 1 1  ON 43
 eH2_4                 1.619611e-02 1 1  ON 44
 eH2_5                 1.968795e-02 1 1  ON 45
 eH2_6                 7.230875e-02 1 1  ON 46
 eH2_7                 1.102310e-01 1 1  ON 47
 eH2_8                 1.032063e-01 1 1  ON 48
 eH2_9                 2.888958e-02 1 1  ON 49
ci_001                -4.202584e-02 3 1  ON 50
ci_002                -3.074443e-02 3 1  ON 51
ci_003                -1.121588e-02 3 1  ON 52
ci_004                 2.575423e-02 3 1  ON 53
ci_005                 2.583961e-02 3 1  ON 54
ci_006                -2.025842e-02 3 1  ON 55
ci_007                -1.961291e-02 3 1  ON 56
ci_008                -4.083629e-03 3 1  ON 57
ci_009                -1.509179e-02 3 1  ON 58
ci_010                -9.385368e-03 3 1  ON 59
ci_011                -9.710116e-03 3 1  ON 60
ci_012                -9.693315e-03 3 1  ON 61
ci_013                -2.170896e-02 3 1  ON 62
ci_014                 1.317861e-02 3 1  ON 63
ci_015                 1.293434e-02 3 1  ON 64
ci_016                 1.628233e-02 3 1  ON 65
ci_017                 1.616614e-02 3 1  ON 66
ci_018                 1.088228e-02 3 1  ON 67
ci_019                 1.073074e-02 3 1  ON 68
ci_020                 1.828644e-02 3 1  ON 69
ci_021                 1.805140e-02 3 1  ON 70
ci_022                 1.037152e-02 3 1  ON 71
ci_023                 1.008300e-02 3 1  ON 72
ci_024                 6.652854e-03 3 1  ON 73
ci_025                 6.590865e-03 3 1  ON 74
ci_026                 1.162403e-02 3 1  ON 75
ci_027                 1.162389e-02 3 1  ON 76
ci_028                -8.920758e-03 3 1  ON 77
ci_029                -9.857497e-03 3 1  ON 78
ci_030                -5.332686e-03 3 1  ON 79
ci_031                -4.551267e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2442
    reference variance = 0.407978
====================================================
  Execution time = 1.9199e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9871e-01
  Total weights = 1.9741e+06
  Execution time = 1.5714e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290568550950
                                         uncertainty =       0.001560102259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290568550950
                                         uncertainty =       0.001560102259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381137507
  error estimate for blocks of size 2^( 2) =       0.000396467878
  error estimate for blocks of size 2^( 3) =       0.000410907864
  error estimate for blocks of size 2^( 4) =       0.000421332192
  error estimate for blocks of size 2^( 5) =       0.000428468505
  error estimate for blocks of size 2^( 6) =       0.000431626923
  error estimate for blocks of size 2^( 7) =       0.000436179775

      target function =      -0.914697542405
              le_mean =     -17.206371187529
             les_mean =     296.357969593614
             stat err =       0.000429401849
             autocorr =       1.269300473591
   target nu stat err =       0.000429401849
   target dn stat err =       0.002227921580
      target stat err =       0.003523228449
              std dev =       0.539009831402
             le_variance =       0.290531598348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290565107435
                                         uncertainty =       0.001560091772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290565107435
                                         uncertainty =       0.001560091772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381135250
  error estimate for blocks of size 2^( 2) =       0.000396465922
  error estimate for blocks of size 2^( 3) =       0.000410906390
  error estimate for blocks of size 2^( 4) =       0.000421331157
  error estimate for blocks of size 2^( 5) =       0.000428467572
  error estimate for blocks of size 2^( 6) =       0.000431625378
  error estimate for blocks of size 2^( 7) =       0.000436178414

      target function =      -0.914817842626
              le_mean =     -17.206371387334
             les_mean =     296.357898752393
             stat err =       0.000429400630
             autocorr =       1.269308299788
   target nu stat err =       0.000429400630
   target dn stat err =       0.002225275209
      target stat err =       0.003520128297
              std dev =       0.539006640353
             le_variance =       0.290528158344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290566797612
                                         uncertainty =       0.001560096535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290566797612
                                         uncertainty =       0.001560096535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381136358
  error estimate for blocks of size 2^( 2) =       0.000396466880
  error estimate for blocks of size 2^( 3) =       0.000410907107
  error estimate for blocks of size 2^( 4) =       0.000421331657
  error estimate for blocks of size 2^( 5) =       0.000428468020
  error estimate for blocks of size 2^( 6) =       0.000431626133
  error estimate for blocks of size 2^( 7) =       0.000436179080

      target function =      -0.914799438769
              le_mean =     -17.206371285077
             les_mean =     296.357907119916
             stat err =       0.000429401222
             autocorr =       1.269304422169
   target nu stat err =       0.000429401222
   target dn stat err =       0.002226021328
      target stat err =       0.003521119213
              std dev =       0.539008206606
             le_variance =       0.290529846789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290568329398
                                         uncertainty =       0.001560101499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290568329398
                                         uncertainty =       0.001560101499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381137362
  error estimate for blocks of size 2^( 2) =       0.000396467752
  error estimate for blocks of size 2^( 3) =       0.000410907767
  error estimate for blocks of size 2^( 4) =       0.000421332123
  error estimate for blocks of size 2^( 5) =       0.000428468442
  error estimate for blocks of size 2^( 6) =       0.000431626823
  error estimate for blocks of size 2^( 7) =       0.000436179688

      target function =      -0.914730545586
              le_mean =     -17.206371199106
             les_mean =     296.357948669252
             stat err =       0.000429401769
             autocorr =       1.269300970068
   target nu stat err =       0.000429401769
   target dn stat err =       0.002227252358
      target stat err =       0.003522463930
              std dev =       0.539009626092
             le_variance =       0.290531377020


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914697542405        initial
     5.8208e+00     5.8208e+01             7.1980e-05        -0.914817842626  <--
     2.3283e+01     2.3283e+02             1.8017e-05        -0.914799438769
     9.3132e+01     9.3132e+02             4.5056e-06        -0.914730545586

*****************************************************************************
Applying the update for shift_i =   5.8208e+00     and shift_s =   5.8208e+01
*****************************************************************************

  Execution time = 2.7129e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
  uu_0                 2.101312e-01 1 1  ON 0
  uu_1                 5.292724e-02 1 1  ON 1
  uu_2                -3.814037e-02 1 1  ON 2
  uu_3                -9.158532e-02 1 1  ON 3
  uu_4                -1.222559e-01 1 1  ON 4
  uu_5                -1.300159e-01 1 1  ON 5
  uu_6                -1.127113e-01 1 1  ON 6
  uu_7                -5.667319e-02 1 1  ON 7
  uu_8                 5.944418e-02 1 1  ON 8
  uu_9                 1.247567e-01 1 1  ON 9
  ud_0                 3.049908e-01 1 1  ON 10
  ud_1                 7.587311e-02 1 1  ON 11
  ud_2                -2.633394e-02 1 1  ON 12
  ud_3                -7.923121e-02 1 1  ON 13
  ud_4                -1.148902e-01 1 1  ON 14
  ud_5                -1.333229e-01 1 1  ON 15
  ud_6                -1.265085e-01 1 1  ON 16
  ud_7                -8.497220e-02 1 1  ON 17
  ud_8                -6.145605e-03 1 1  ON 18
  ud_9                 8.603056e-02 1 1  ON 19
  eO_0                -7.034798e-01 1 1  ON 20
  eO_1                -4.201149e-01 1 1  ON 21
  eO_2                -4.157432e-02 1 1  ON 22
  eO_3                 1.846232e-01 1 1  ON 23
  eO_4                 2.569084e-01 1 1  ON 24
  eO_5                 2.800334e-01 1 1  ON 25
  eO_6                 2.510218e-01 1 1  ON 26
  eO_7                 1.327229e-01 1 1  ON 27
  eO_8                 2.925321e-02 1 1  ON 28
  eO_9                 1.915372e-02 1 1  ON 29
 eH1_0                -2.016798e-01 1 1  ON 30
 eH1_1                -9.602279e-02 1 1  ON 31
 eH1_2                -4.462070e-02 1 1  ON 32
 eH1_3                -1.412936e-02 1 1  ON 33
 eH1_4                 1.844825e-02 1 1  ON 34
 eH1_5                 2.167933e-02 1 1  ON 35
 eH1_6                 7.078399e-02 1 1  ON 36
 eH1_7                 1.028192e-01 1 1  ON 37
 eH1_8                 1.007534e-01 1 1  ON 38
 eH1_9                 2.597795e-02 1 1  ON 39
 eH2_0                -2.032151e-01 1 1  ON 40
 eH2_1                -9.778353e-02 1 1  ON 41
 eH2_2                -4.645376e-02 1 1  ON 42
 eH2_3                -1.575928e-02 1 1  ON 43
 eH2_4                 1.618444e-02 1 1  ON 44
 eH2_5                 1.968913e-02 1 1  ON 45
 eH2_6                 7.232644e-02 1 1  ON 46
 eH2_7                 1.102179e-01 1 1  ON 47
 eH2_8                 1.032194e-01 1 1  ON 48
 eH2_9                 2.889326e-02 1 1  ON 49
ci_001                -4.202575e-02 3 1  ON 50
ci_002                -3.073637e-02 3 1  ON 51
ci_003                -1.120968e-02 3 1  ON 52
ci_004                 2.573333e-02 3 1  ON 53
ci_005                 2.582334e-02 3 1  ON 54
ci_006                -2.024558e-02 3 1  ON 55
ci_007                -1.962262e-02 3 1  ON 56
ci_008                -4.085052e-03 3 1  ON 57
ci_009                -1.509389e-02 3 1  ON 58
ci_010                -9.385718e-03 3 1  ON 59
ci_011                -9.719689e-03 3 1  ON 60
ci_012                -9.690934e-03 3 1  ON 61
ci_013                -2.170274e-02 3 1  ON 62
ci_014                 1.317993e-02 3 1  ON 63
ci_015                 1.293922e-02 3 1  ON 64
ci_016                 1.628683e-02 3 1  ON 65
ci_017                 1.616186e-02 3 1  ON 66
ci_018                 1.086983e-02 3 1  ON 67
ci_019                 1.072641e-02 3 1  ON 68
ci_020                 1.829360e-02 3 1  ON 69
ci_021                 1.805250e-02 3 1  ON 70
ci_022                 1.036992e-02 3 1  ON 71
ci_023                 1.008628e-02 3 1  ON 72
ci_024                 6.649283e-03 3 1  ON 73
ci_025                 6.578637e-03 3 1  ON 74
ci_026                 1.162916e-02 3 1  ON 75
ci_027                 1.162536e-02 3 1  ON 76
ci_028                -8.924312e-03 3 1  ON 77
ci_029                -9.847416e-03 3 1  ON 78
ci_030                -5.332730e-03 3 1  ON 79
ci_031                -4.541812e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4071e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2435
    reference variance = 0.229484
====================================================
  Execution time = 1.9153e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5445e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0268e-01
  Total weights = 1.973773997e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293293869125
                                         uncertainty =       0.002538324737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293293869125
                                         uncertainty =       0.002538324737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382943971
  error estimate for blocks of size 2^( 2) =       0.000398505822
  error estimate for blocks of size 2^( 3) =       0.000412672311
  error estimate for blocks of size 2^( 4) =       0.000423395249
  error estimate for blocks of size 2^( 5) =       0.000429486639
  error estimate for blocks of size 2^( 6) =       0.000433931422
  error estimate for blocks of size 2^( 7) =       0.000434457855

      target function =      -0.908626608460
              le_mean =     -17.206787267986
             les_mean =     296.376208295121
             stat err =       0.000430317791
             autocorr =       1.262723118039
   target nu stat err =       0.000430317791
   target dn stat err =       0.004192357267
      target stat err =       0.006447408899
              std dev =       0.541564557023
             le_variance =       0.293292169424


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720678726799e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908670895622       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908679894467       residual = 7.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908681815772       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908682465826       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908682640102       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908682718451       residual = 8.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908682820679       residual = 7.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908683441388       residual = 9.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908683949585       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908684066731       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908684372394       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908684369847       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.908684412644       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.908684683341       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.908684731123       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.908684717557       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.908684731164       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.908684854526       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.908684814587       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908684891191       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.908684844166       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.908684861005       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908684845947       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.908684860592       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.908684892807       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908684903685       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.908684898459       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.908684896149       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.908684926638       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908684922942       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.908684926263       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.908684929071       residual = 9.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.908684917750       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908684917284       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.908684912938       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.908684906024       residual = 9.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4552e+00 is 3.271363e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908670895622       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908673232635       residual = 7.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908673726609       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908673893396       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908673937558       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908673957201       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908673983539       residual = 7.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908674140238       residual = 9.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908674272334       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908674302563       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908674381679       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908674380386       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.908674390064       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.908674457900       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.908674468204       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.908674464999       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.908674468415       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.908674499474       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.908674488976       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908674507542       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.908674495937       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.908674500224       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908674496197       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.908674500092       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.908674508268       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908674510381       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.908674509156       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.908674508092       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.908674513369       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908674516041       residual = 7.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.908674515240       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.908674516381       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.908674513471       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908674513501       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.908674512426       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.908674510671       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.8208e+00 is 8.184592e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908670895622       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908671485599       residual = 7.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908671609973       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908671651947       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908671663023       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908671667939       residual = 8.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908671674574       residual = 7.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908671713849       residual = 9.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908671747194       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908671754813       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908671774768       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908671774399       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.908671776748       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.908671793716       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.908671796183       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.908671795398       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.908671796256       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.908671804028       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.908671801372       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908671805975       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.908671803085       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.908671804161       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908671803139       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.908671804129       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.908671806175       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908671806667       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.908671806365       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.908671806083       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.908671807299       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908671808072       residual = 7.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.908671807869       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.908671808140       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.908671807414       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908671807431       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.908671807163       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.908671806726       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.3283e+01 is 2.046466e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.052233 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4828e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
  uu_0                 2.101586e-01 1 1  ON 0
  uu_1                 5.296394e-02 1 1  ON 1
  uu_2                -3.810434e-02 1 1  ON 2
  uu_3                -9.155881e-02 1 1  ON 3
  uu_4                -1.222382e-01 1 1  ON 4
  uu_5                -1.300269e-01 1 1  ON 5
  uu_6                -1.127478e-01 1 1  ON 6
  uu_7                -5.674082e-02 1 1  ON 7
  uu_8                 5.938495e-02 1 1  ON 8
  uu_9                 1.247571e-01 1 1  ON 9
  ud_0                 3.049659e-01 1 1  ON 10
  ud_1                 7.584898e-02 1 1  ON 11
  ud_2                -2.635365e-02 1 1  ON 12
  ud_3                -7.924717e-02 1 1  ON 13
  ud_4                -1.148940e-01 1 1  ON 14
  ud_5                -1.333117e-01 1 1  ON 15
  ud_6                -1.264798e-01 1 1  ON 16
  ud_7                -8.491538e-02 1 1  ON 17
  ud_8                -6.163096e-03 1 1  ON 18
  ud_9                 8.600886e-02 1 1  ON 19
  eO_0                -7.034769e-01 1 1  ON 20
  eO_1                -4.201215e-01 1 1  ON 21
  eO_2                -4.156441e-02 1 1  ON 22
  eO_3                 1.846205e-01 1 1  ON 23
  eO_4                 2.568951e-01 1 1  ON 24
  eO_5                 2.800050e-01 1 1  ON 25
  eO_6                 2.510261e-01 1 1  ON 26
  eO_7                 1.327513e-01 1 1  ON 27
  eO_8                 2.925192e-02 1 1  ON 28
  eO_9                 1.915789e-02 1 1  ON 29
 eH1_0                -2.017205e-01 1 1  ON 30
 eH1_1                -9.604490e-02 1 1  ON 31
 eH1_2                -4.466015e-02 1 1  ON 32
 eH1_3                -1.416864e-02 1 1  ON 33
 eH1_4                 1.842141e-02 1 1  ON 34
 eH1_5                 2.174740e-02 1 1  ON 35
 eH1_6                 7.086584e-02 1 1  ON 36
 eH1_7                 1.028177e-01 1 1  ON 37
 eH1_8                 1.007650e-01 1 1  ON 38
 eH1_9                 2.598275e-02 1 1  ON 39
 eH2_0                -2.032240e-01 1 1  ON 40
 eH2_1                -9.779087e-02 1 1  ON 41
 eH2_2                -4.644344e-02 1 1  ON 42
 eH2_3                -1.574477e-02 1 1  ON 43
 eH2_4                 1.618193e-02 1 1  ON 44
 eH2_5                 1.968782e-02 1 1  ON 45
 eH2_6                 7.231177e-02 1 1  ON 46
 eH2_7                 1.102059e-01 1 1  ON 47
 eH2_8                 1.032388e-01 1 1  ON 48
 eH2_9                 2.889278e-02 1 1  ON 49
ci_001                -4.200996e-02 3 1  ON 50
ci_002                -3.073394e-02 3 1  ON 51
ci_003                -1.121810e-02 3 1  ON 52
ci_004                 2.573687e-02 3 1  ON 53
ci_005                 2.582006e-02 3 1  ON 54
ci_006                -2.023902e-02 3 1  ON 55
ci_007                -1.962821e-02 3 1  ON 56
ci_008                -4.091233e-03 3 1  ON 57
ci_009                -1.508969e-02 3 1  ON 58
ci_010                -9.387079e-03 3 1  ON 59
ci_011                -9.724483e-03 3 1  ON 60
ci_012                -9.695601e-03 3 1  ON 61
ci_013                -2.169894e-02 3 1  ON 62
ci_014                 1.319172e-02 3 1  ON 63
ci_015                 1.294921e-02 3 1  ON 64
ci_016                 1.629526e-02 3 1  ON 65
ci_017                 1.615934e-02 3 1  ON 66
ci_018                 1.087384e-02 3 1  ON 67
ci_019                 1.071614e-02 3 1  ON 68
ci_020                 1.829745e-02 3 1  ON 69
ci_021                 1.804263e-02 3 1  ON 70
ci_022                 1.036964e-02 3 1  ON 71
ci_023                 1.009306e-02 3 1  ON 72
ci_024                 6.658628e-03 3 1  ON 73
ci_025                 6.581632e-03 3 1  ON 74
ci_026                 1.162449e-02 3 1  ON 75
ci_027                 1.163941e-02 3 1  ON 76
ci_028                -8.916752e-03 3 1  ON 77
ci_029                -9.839926e-03 3 1  ON 78
ci_030                -5.322892e-03 3 1  ON 79
ci_031                -4.540207e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2235
    reference variance = 0.345508
====================================================
  Execution time = 1.9004e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9656e-01
  Total weights = 1.9738e+06
  Execution time = 1.5660e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289568903295
                                         uncertainty =       0.002024459062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289568903295
                                         uncertainty =       0.002024459062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380487174
  error estimate for blocks of size 2^( 2) =       0.000395441685
  error estimate for blocks of size 2^( 3) =       0.000408796986
  error estimate for blocks of size 2^( 4) =       0.000418709116
  error estimate for blocks of size 2^( 5) =       0.000424616345
  error estimate for blocks of size 2^( 6) =       0.000428540895
  error estimate for blocks of size 2^( 7) =       0.000428576819

      target function =      -0.918089406943
              le_mean =     -17.206289124209
             les_mean =     296.352961788285
             stat err =       0.000425110794
             autocorr =       1.248315091899
   target nu stat err =       0.000425110794
   target dn stat err =       0.002233184315
      target stat err =       0.003554856884
              std dev =       0.538090121920
             le_variance =       0.289540979308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289551085338
                                         uncertainty =       0.002021213305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289551085338
                                         uncertainty =       0.002021213305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380475452
  error estimate for blocks of size 2^( 2) =       0.000395430544
  error estimate for blocks of size 2^( 3) =       0.000408786087
  error estimate for blocks of size 2^( 4) =       0.000418699517
  error estimate for blocks of size 2^( 5) =       0.000424606044
  error estimate for blocks of size 2^( 6) =       0.000428530554
  error estimate for blocks of size 2^( 7) =       0.000428567811

      target function =      -0.918162086120
              le_mean =     -17.206288933508
             les_mean =     296.352908638046
             stat err =       0.000425100982
             autocorr =       1.248334380054
   target nu stat err =       0.000425100982
   target dn stat err =       0.002228341541
      target stat err =       0.003548011287
              std dev =       0.538073545030
             le_variance =       0.289523139861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289559508857
                                         uncertainty =       0.002022772706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289559508857
                                         uncertainty =       0.002022772706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380480994
  error estimate for blocks of size 2^( 2) =       0.000395435798
  error estimate for blocks of size 2^( 3) =       0.000408791217
  error estimate for blocks of size 2^( 4) =       0.000418704012
  error estimate for blocks of size 2^( 5) =       0.000424610878
  error estimate for blocks of size 2^( 6) =       0.000428535402
  error estimate for blocks of size 2^( 7) =       0.000428572029

      target function =      -0.918130450783
              le_mean =     -17.206289005593
             les_mean =     296.352931394771
             stat err =       0.000425105580
             autocorr =       1.248325022905
   target nu stat err =       0.000425105580
   target dn stat err =       0.002230646195
      target stat err =       0.003551291508
              std dev =       0.538081382204
             le_variance =       0.289531573874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289567699577
                                         uncertainty =       0.002024245662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289567699577
                                         uncertainty =       0.002024245662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380486382
  error estimate for blocks of size 2^( 2) =       0.000395440930
  error estimate for blocks of size 2^( 3) =       0.000408796245
  error estimate for blocks of size 2^( 4) =       0.000418708459
  error estimate for blocks of size 2^( 5) =       0.000424615642
  error estimate for blocks of size 2^( 6) =       0.000428540188
  error estimate for blocks of size 2^( 7) =       0.000428576200

      target function =      -0.918095081740
              le_mean =     -17.206289106634
             les_mean =     296.352957545269
             stat err =       0.000425110122
             autocorr =       1.248316341750
   target nu stat err =       0.000425110122
   target dn stat err =       0.002232857970
      target stat err =       0.003554401484
              std dev =       0.538089002131
             le_variance =       0.289539774214


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918089406943        initial
     1.4552e+00     1.4552e+01             3.2714e-04        -0.918162086120  <--
     5.8208e+00     5.8208e+01             8.1846e-05        -0.918130450783
     2.3283e+01     2.3283e+02             2.0465e-05        -0.918095081740

*****************************************************************************
Applying the update for shift_i =   1.4552e+00     and shift_s =   1.4552e+01
*****************************************************************************

  Execution time = 2.6908e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
  uu_0                 2.102398e-01 1 1  ON 0
  uu_1                 5.307172e-02 1 1  ON 1
  uu_2                -3.799854e-02 1 1  ON 2
  uu_3                -9.148039e-02 1 1  ON 3
  uu_4                -1.221858e-01 1 1  ON 4
  uu_5                -1.300576e-01 1 1  ON 5
  uu_6                -1.128546e-01 1 1  ON 6
  uu_7                -5.694141e-02 1 1  ON 7
  uu_8                 5.920781e-02 1 1  ON 8
  uu_9                 1.247583e-01 1 1  ON 9
  ud_0                 3.048935e-01 1 1  ON 10
  ud_1                 7.577852e-02 1 1  ON 11
  ud_2                -2.641147e-02 1 1  ON 12
  ud_3                -7.929405e-02 1 1  ON 13
  ud_4                -1.149056e-01 1 1  ON 14
  ud_5                -1.332794e-01 1 1  ON 15
  ud_6                -1.263959e-01 1 1  ON 16
  ud_7                -8.474850e-02 1 1  ON 17
  ud_8                -6.214085e-03 1 1  ON 18
  ud_9                 8.594404e-02 1 1  ON 19
  eO_0                -7.034685e-01 1 1  ON 20
  eO_1                -4.201401e-01 1 1  ON 21
  eO_2                -4.153590e-02 1 1  ON 22
  eO_3                 1.846128e-01 1 1  ON 23
  eO_4                 2.568554e-01 1 1  ON 24
  eO_5                 2.799205e-01 1 1  ON 25
  eO_6                 2.510388e-01 1 1  ON 26
  eO_7                 1.328358e-01 1 1  ON 27
  eO_8                 2.924807e-02 1 1  ON 28
  eO_9                 1.917033e-02 1 1  ON 29
 eH1_0                -2.018408e-01 1 1  ON 30
 eH1_1                -9.611234e-02 1 1  ON 31
 eH1_2                -4.477694e-02 1 1  ON 32
 eH1_3                -1.428493e-02 1 1  ON 33
 eH1_4                 1.834246e-02 1 1  ON 34
 eH1_5                 2.194619e-02 1 1  ON 35
 eH1_6                 7.111113e-02 1 1  ON 36
 eH1_7                 1.028139e-01 1 1  ON 37
 eH1_8                 1.007996e-01 1 1  ON 38
 eH1_9                 2.599706e-02 1 1  ON 39
 eH2_0                -2.032496e-01 1 1  ON 40
 eH2_1                -9.781149e-02 1 1  ON 41
 eH2_2                -4.641364e-02 1 1  ON 42
 eH2_3                -1.570294e-02 1 1  ON 43
 eH2_4                 1.617496e-02 1 1  ON 44
 eH2_5                 1.968356e-02 1 1  ON 45
 eH2_6                 7.226816e-02 1 1  ON 46
 eH2_7                 1.101698e-01 1 1  ON 47
 eH2_8                 1.032966e-01 1 1  ON 48
 eH2_9                 2.889135e-02 1 1  ON 49
ci_001                -4.196433e-02 3 1  ON 50
ci_002                -3.072691e-02 3 1  ON 51
ci_003                -1.124223e-02 3 1  ON 52
ci_004                 2.574698e-02 3 1  ON 53
ci_005                 2.581085e-02 3 1  ON 54
ci_006                -2.022011e-02 3 1  ON 55
ci_007                -1.964436e-02 3 1  ON 56
ci_008                -4.108781e-03 3 1  ON 57
ci_009                -1.507769e-02 3 1  ON 58
ci_010                -9.390973e-03 3 1  ON 59
ci_011                -9.738221e-03 3 1  ON 60
ci_012                -9.708983e-03 3 1  ON 61
ci_013                -2.168798e-02 3 1  ON 62
ci_014                 1.322557e-02 3 1  ON 63
ci_015                 1.297786e-02 3 1  ON 64
ci_016                 1.631961e-02 3 1  ON 65
ci_017                 1.615208e-02 3 1  ON 66
ci_018                 1.088516e-02 3 1  ON 67
ci_019                 1.068688e-02 3 1  ON 68
ci_020                 1.830834e-02 3 1  ON 69
ci_021                 1.801426e-02 3 1  ON 70
ci_022                 1.036882e-02 3 1  ON 71
ci_023                 1.011252e-02 3 1  ON 72
ci_024                 6.685471e-03 3 1  ON 73
ci_025                 6.590204e-03 3 1  ON 74
ci_026                 1.161121e-02 3 1  ON 75
ci_027                 1.167945e-02 3 1  ON 76
ci_028                -8.895064e-03 3 1  ON 77
ci_029                -9.818376e-03 3 1  ON 78
ci_030                -5.294848e-03 3 1  ON 79
ci_031                -4.535633e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1742e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.2926
    reference variance = 0.280181
====================================================
  Execution time = 1.8985e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5410e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9629e-01
  Total weights = 1.973912796e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288929237765
                                         uncertainty =       0.001897275407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288929237765
                                         uncertainty =       0.001897275407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380094759
  error estimate for blocks of size 2^( 2) =       0.000395452767
  error estimate for blocks of size 2^( 3) =       0.000409697755
  error estimate for blocks of size 2^( 4) =       0.000419986135
  error estimate for blocks of size 2^( 5) =       0.000427114898
  error estimate for blocks of size 2^( 6) =       0.000430264311
  error estimate for blocks of size 2^( 7) =       0.000432949877

      target function =      -0.918534113828
              le_mean =     -17.206270225204
             les_mean =     296.352024173731
             stat err =       0.000427578805
             autocorr =       1.265460448469
   target nu stat err =       0.000427578805
   target dn stat err =       0.002525090008
      target stat err =       0.004005882349
              std dev =       0.537535163310
             le_variance =       0.288944051794


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720627022520e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918550363861       residual = 8.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918622965953       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918638259514       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918643217593       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918644616330       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918645259694       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918645321644       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918645532419       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918645766637       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918645769883       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918646184524       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918646231064       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918646420047       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918646590098       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918646576118       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918646582036       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918646745751       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918646940163       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918646946810       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918647247627       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918647316901       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918647366303       residual = 9.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918647347412       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918647457288       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918647431733       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918647400260       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918647451817       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918647445668       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918647453185       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918647414882       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918647404739       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918647453059       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918647480876       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918647487150       residual = 9.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.6380e-01 is 1.092128e-03

solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918550363861       residual = 8.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918571245938       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918575601944       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918576980096       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918577370036       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918577542094       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918577560529       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918577609731       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918577681411       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918577683811       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918577800667       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918577812799       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918577863809       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918577912191       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918577898417       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918577905642       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918577951783       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918577991869       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918577993724       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918578075113       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918578080973       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918578091542       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918578093176       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918578113315       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918578101604       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918578097291       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918578109517       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918578107345       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918578108559       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918578098709       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918578098701       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918578108774       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918578115696       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918578115817       residual = 6.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4552e+00 is 2.782505e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918550363861       residual = 8.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918555788457       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918556916789       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918557271310       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918557371767       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918557415512       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918557420286       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918557432285       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918557451148       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918557451920       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918557482091       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918557485128       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918557498128       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918557510656       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918557506405       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918557508716       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918557520514       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918557529809       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918557530427       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918557551096       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918557551701       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918557554383       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918557555181       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918557559554       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918557556407       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918557555637       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918557558635       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918557558007       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918557558278       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918557555828       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918557555999       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918557558367       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918557560065       residual = 8.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.8208e+00 is 6.989917e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.094256 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4527e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
  uu_0                 2.101554e-01 1 1  ON 0
  uu_1                 5.303819e-02 1 1  ON 1
  uu_2                -3.796639e-02 1 1  ON 2
  uu_3                -9.141119e-02 1 1  ON 3
  uu_4                -1.221198e-01 1 1  ON 4
  uu_5                -1.299923e-01 1 1  ON 5
  uu_6                -1.127769e-01 1 1  ON 6
  uu_7                -5.688532e-02 1 1  ON 7
  uu_8                 5.892956e-02 1 1  ON 8
  uu_9                 1.246950e-01 1 1  ON 9
  ud_0                 3.048950e-01 1 1  ON 10
  ud_1                 7.574474e-02 1 1  ON 11
  ud_2                -2.642552e-02 1 1  ON 12
  ud_3                -7.929270e-02 1 1  ON 13
  ud_4                -1.149328e-01 1 1  ON 14
  ud_5                -1.332909e-01 1 1  ON 15
  ud_6                -1.263988e-01 1 1  ON 16
  ud_7                -8.471353e-02 1 1  ON 17
  ud_8                -6.230602e-03 1 1  ON 18
  ud_9                 8.591244e-02 1 1  ON 19
  eO_0                -7.034659e-01 1 1  ON 20
  eO_1                -4.201647e-01 1 1  ON 21
  eO_2                -4.160395e-02 1 1  ON 22
  eO_3                 1.845664e-01 1 1  ON 23
  eO_4                 2.568694e-01 1 1  ON 24
  eO_5                 2.799033e-01 1 1  ON 25
  eO_6                 2.509943e-01 1 1  ON 26
  eO_7                 1.329985e-01 1 1  ON 27
  eO_8                 2.925736e-02 1 1  ON 28
  eO_9                 1.917766e-02 1 1  ON 29
 eH1_0                -2.018121e-01 1 1  ON 30
 eH1_1                -9.609283e-02 1 1  ON 31
 eH1_2                -4.471612e-02 1 1  ON 32
 eH1_3                -1.427145e-02 1 1  ON 33
 eH1_4                 1.827101e-02 1 1  ON 34
 eH1_5                 2.192420e-02 1 1  ON 35
 eH1_6                 7.105567e-02 1 1  ON 36
 eH1_7                 1.027494e-01 1 1  ON 37
 eH1_8                 1.008637e-01 1 1  ON 38
 eH1_9                 2.602004e-02 1 1  ON 39
 eH2_0                -2.032314e-01 1 1  ON 40
 eH2_1                -9.776581e-02 1 1  ON 41
 eH2_2                -4.637290e-02 1 1  ON 42
 eH2_3                -1.570442e-02 1 1  ON 43
 eH2_4                 1.615247e-02 1 1  ON 44
 eH2_5                 1.964762e-02 1 1  ON 45
 eH2_6                 7.220177e-02 1 1  ON 46
 eH2_7                 1.101072e-01 1 1  ON 47
 eH2_8                 1.033608e-01 1 1  ON 48
 eH2_9                 2.890755e-02 1 1  ON 49
ci_001                -4.187809e-02 3 1  ON 50
ci_002                -3.078732e-02 3 1  ON 51
ci_003                -1.129050e-02 3 1  ON 52
ci_004                 2.569694e-02 3 1  ON 53
ci_005                 2.578882e-02 3 1  ON 54
ci_006                -2.021889e-02 3 1  ON 55
ci_007                -1.968688e-02 3 1  ON 56
ci_008                -4.089434e-03 3 1  ON 57
ci_009                -1.510253e-02 3 1  ON 58
ci_010                -9.427660e-03 3 1  ON 59
ci_011                -9.709573e-03 3 1  ON 60
ci_012                -9.687177e-03 3 1  ON 61
ci_013                -2.168353e-02 3 1  ON 62
ci_014                 1.325603e-02 3 1  ON 63
ci_015                 1.302198e-02 3 1  ON 64
ci_016                 1.630872e-02 3 1  ON 65
ci_017                 1.614498e-02 3 1  ON 66
ci_018                 1.087879e-02 3 1  ON 67
ci_019                 1.063683e-02 3 1  ON 68
ci_020                 1.835569e-02 3 1  ON 69
ci_021                 1.804550e-02 3 1  ON 70
ci_022                 1.033965e-02 3 1  ON 71
ci_023                 1.016306e-02 3 1  ON 72
ci_024                 6.692879e-03 3 1  ON 73
ci_025                 6.567780e-03 3 1  ON 74
ci_026                 1.168778e-02 3 1  ON 75
ci_027                 1.172638e-02 3 1  ON 76
ci_028                -8.973763e-03 3 1  ON 77
ci_029                -9.801523e-03 3 1  ON 78
ci_030                -5.209396e-03 3 1  ON 79
ci_031                -4.575204e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.216
    reference variance = 0.236803
====================================================
  Execution time = 1.9107e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9624e-01
  Total weights = 1.9737e+06
  Execution time = 1.5576e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290547812887
                                         uncertainty =       0.002018331229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290547812887
                                         uncertainty =       0.002018331229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381172128
  error estimate for blocks of size 2^( 2) =       0.000396549059
  error estimate for blocks of size 2^( 3) =       0.000410450289
  error estimate for blocks of size 2^( 4) =       0.000420827237
  error estimate for blocks of size 2^( 5) =       0.000427032267
  error estimate for blocks of size 2^( 6) =       0.000431534452
  error estimate for blocks of size 2^( 7) =       0.000433182771

      target function =      -0.918495573134
              le_mean =     -17.206278931286
             les_mean =     296.352350998631
             stat err =       0.000428144182
             autocorr =       1.261646883849
   target nu stat err =       0.000428144182
   target dn stat err =       0.002199037591
      target stat err =       0.003506788812
              std dev =       0.539058793504
             le_variance =       0.290584382854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290363990010
                                         uncertainty =       0.002015231887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290363990010
                                         uncertainty =       0.002015231887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381052056
  error estimate for blocks of size 2^( 2) =       0.000396437001
  error estimate for blocks of size 2^( 3) =       0.000410348558
  error estimate for blocks of size 2^( 4) =       0.000420733106
  error estimate for blocks of size 2^( 5) =       0.000426930955
  error estimate for blocks of size 2^( 6) =       0.000431441031
  error estimate for blocks of size 2^( 7) =       0.000433090778

      target function =      -0.918748788251
              le_mean =     -17.206282953530
             les_mean =     296.352327145534
             stat err =       0.000428048968
             autocorr =       1.261880671983
   target nu stat err =       0.000428048968
   target dn stat err =       0.002194763263
      target stat err =       0.003502146784
              std dev =       0.538888986232
             le_variance =       0.290401339482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290439669849
                                         uncertainty =       0.002016532606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290439669849
                                         uncertainty =       0.002016532606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381101479
  error estimate for blocks of size 2^( 2) =       0.000396483046
  error estimate for blocks of size 2^( 3) =       0.000410390235
  error estimate for blocks of size 2^( 4) =       0.000420771596
  error estimate for blocks of size 2^( 5) =       0.000426972547
  error estimate for blocks of size 2^( 6) =       0.000431479528
  error estimate for blocks of size 2^( 7) =       0.000433128741

      target function =      -0.918686936661
              le_mean =     -17.206280798296
             les_mean =     296.352292613053
             stat err =       0.000428088103
             autocorr =       1.261784096124
   target nu stat err =       0.000428088103
   target dn stat err =       0.002196013195
      target stat err =       0.003503593568
              std dev =       0.538958880134
             le_variance =       0.290476674475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290533253511
                                         uncertainty =       0.002018089864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290533253511
                                         uncertainty =       0.002018089864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381162615
  error estimate for blocks of size 2^( 2) =       0.000396540163
  error estimate for blocks of size 2^( 3) =       0.000410442164
  error estimate for blocks of size 2^( 4) =       0.000420819691
  error estimate for blocks of size 2^( 5) =       0.000427024194
  error estimate for blocks of size 2^( 6) =       0.000431527010
  error estimate for blocks of size 2^( 7) =       0.000433175438

      target function =      -0.918534260592
              le_mean =     -17.206279114169
             les_mean =     296.352332495497
             stat err =       0.000428136583
             autocorr =       1.261665073672
   target nu stat err =       0.000428136583
   target dn stat err =       0.002198575891
      target stat err =       0.003506371706
              std dev =       0.539045340293
             le_variance =       0.290569878891


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918495573134        initial
     3.6380e-01     3.6380e+00             1.0921e-03        -0.918748788251  <--
     1.4552e+00     1.4552e+01             2.7825e-04        -0.918686936661
     5.8208e+00     5.8208e+01             6.9899e-05        -0.918534260592

*****************************************************************************
Applying the update for shift_i =   3.6380e-01     and shift_s =   3.6380e+00
*****************************************************************************

  Execution time = 2.6995e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
  uu_0                 2.099554e-01 1 1  ON 0
  uu_1                 5.296366e-02 1 1  ON 1
  uu_2                -3.787667e-02 1 1  ON 2
  uu_3                -9.122636e-02 1 1  ON 3
  uu_4                -1.219397e-01 1 1  ON 4
  uu_5                -1.298121e-01 1 1  ON 5
  uu_6                -1.125630e-01 1 1  ON 6
  uu_7                -5.673179e-02 1 1  ON 7
  uu_8                 5.811568e-02 1 1  ON 8
  uu_9                 1.245063e-01 1 1  ON 9
  ud_0                 3.048895e-01 1 1  ON 10
  ud_1                 7.565361e-02 1 1  ON 11
  ud_2                -2.646812e-02 1 1  ON 12
  ud_3                -7.929722e-02 1 1  ON 13
  ud_4                -1.150067e-01 1 1  ON 14
  ud_5                -1.333237e-01 1 1  ON 15
  ud_6                -1.264020e-01 1 1  ON 16
  ud_7                -8.461485e-02 1 1  ON 17
  ud_8                -6.276329e-03 1 1  ON 18
  ud_9                 8.581903e-02 1 1  ON 19
  eO_0                -7.034795e-01 1 1  ON 20
  eO_1                -4.202478e-01 1 1  ON 21
  eO_2                -4.178959e-02 1 1  ON 22
  eO_3                 1.844432e-01 1 1  ON 23
  eO_4                 2.569101e-01 1 1  ON 24
  eO_5                 2.798569e-01 1 1  ON 25
  eO_6                 2.508623e-01 1 1  ON 26
  eO_7                 1.334787e-01 1 1  ON 27
  eO_8                 2.928496e-02 1 1  ON 28
  eO_9                 1.919927e-02 1 1  ON 29
 eH1_0                -2.017296e-01 1 1  ON 30
 eH1_1                -9.603339e-02 1 1  ON 31
 eH1_2                -4.455536e-02 1 1  ON 32
 eH1_3                -1.423159e-02 1 1  ON 33
 eH1_4                 1.808755e-02 1 1  ON 34
 eH1_5                 2.185290e-02 1 1  ON 35
 eH1_6                 7.088946e-02 1 1  ON 36
 eH1_7                 1.025589e-01 1 1  ON 37
 eH1_8                 1.010528e-01 1 1  ON 38
 eH1_9                 2.608797e-02 1 1  ON 39
 eH2_0                -2.031746e-01 1 1  ON 40
 eH2_1                -9.764259e-02 1 1  ON 41
 eH2_2                -4.626308e-02 1 1  ON 42
 eH2_3                -1.570208e-02 1 1  ON 43
 eH2_4                 1.609454e-02 1 1  ON 44
 eH2_5                 1.954708e-02 1 1  ON 45
 eH2_6                 7.200443e-02 1 1  ON 46
 eH2_7                 1.099222e-01 1 1  ON 47
 eH2_8                 1.035504e-01 1 1  ON 48
 eH2_9                 2.895545e-02 1 1  ON 49
ci_001                -4.165466e-02 3 1  ON 50
ci_002                -3.094180e-02 3 1  ON 51
ci_003                -1.141100e-02 3 1  ON 52
ci_004                 2.557269e-02 3 1  ON 53
ci_005                 2.573472e-02 3 1  ON 54
ci_006                -2.021568e-02 3 1  ON 55
ci_007                -1.979710e-02 3 1  ON 56
ci_008                -4.042621e-03 3 1  ON 57
ci_009                -1.516429e-02 3 1  ON 58
ci_010                -9.520128e-03 3 1  ON 59
ci_011                -9.638016e-03 3 1  ON 60
ci_012                -9.632110e-03 3 1  ON 61
ci_013                -2.167173e-02 3 1  ON 62
ci_014                 1.333306e-02 3 1  ON 63
ci_015                 1.313413e-02 3 1  ON 64
ci_016                 1.627930e-02 3 1  ON 65
ci_017                 1.612529e-02 3 1  ON 66
ci_018                 1.086407e-02 3 1  ON 67
ci_019                 1.051424e-02 3 1  ON 68
ci_020                 1.847339e-02 3 1  ON 69
ci_021                 1.812453e-02 3 1  ON 70
ci_022                 1.026580e-02 3 1  ON 71
ci_023                 1.029006e-02 3 1  ON 72
ci_024                 6.711674e-03 3 1  ON 73
ci_025                 6.510694e-03 3 1  ON 74
ci_026                 1.187562e-02 3 1  ON 75
ci_027                 1.184173e-02 3 1  ON 76
ci_028                -9.172368e-03 3 1  ON 77
ci_029                -9.757716e-03 3 1  ON 78
ci_030                -4.998884e-03 3 1  ON 79
ci_031                -4.672902e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1529e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2067
    reference variance = 0.277408
====================================================
  Execution time = 1.9121e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5400e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9747e-01
  Total weights = 1.973628486e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4589e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289016925619
                                         uncertainty =       0.001906548868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289016925619
                                         uncertainty =       0.001906548868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380145195
  error estimate for blocks of size 2^( 2) =       0.000394917514
  error estimate for blocks of size 2^( 3) =       0.000408758451
  error estimate for blocks of size 2^( 4) =       0.000418552667
  error estimate for blocks of size 2^( 5) =       0.000424672682
  error estimate for blocks of size 2^( 6) =       0.000428873317
  error estimate for blocks of size 2^( 7) =       0.000430264461

      target function =      -0.916677473597
              le_mean =     -17.206934799157
             les_mean =     296.376078558581
             stat err =       0.000425590782
             autocorr =       1.253387661344
   target nu stat err =       0.000425590782
   target dn stat err =       0.002693287351
      target stat err =       0.004251902286
              std dev =       0.537606489856
             le_variance =       0.289020737935


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720693479916e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-02, overlap shift 9.0949e-01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916696145511       residual = 5.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916808003602       residual = 7.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916829501462       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916835372622       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916841596498       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916841823898       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916842377676       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916844802230       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916845750513       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916845858072       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916847182585       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916847718472       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916849214455       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916849096015       residual = 9.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916849819664       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916849230997       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916849198280       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916849403022       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916849855386       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916850525653       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916850806364       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916851509510       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916851422083       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916851599971       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916852380160       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916852657175       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916852862120       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916852930638       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916852920952       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916852770638       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916852858879       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916852868979       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916852812135       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916852912672       residual = 8.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916852876235       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916852978804       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.916853015314       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.916853027184       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916853052455       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.916853025723       residual = 9.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.0949e-02 is 2.710178e-03

solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916696145511       residual = 5.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916739232724       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916746994635       residual = 4.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916748957219       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916750985548       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916750983610       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916751206531       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916752052597       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916752390323       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916752310591       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916752757546       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916752950762       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916753453799       residual = 8.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916753274661       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916753424832       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916753248555       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916753286183       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916753397398       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916753571871       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916753728322       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916753790878       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916753914147       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916753854332       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916753960083       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916754116089       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916754140364       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916754152205       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916754141675       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916754134902       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916754113915       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916754119950       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916754112596       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916754106981       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916754127936       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916754122295       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916754135560       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.6380e-01 is 7.125498e-04

solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916696145511       residual = 5.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916708601077       residual = 7.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916710781076       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916711315481       residual = 9.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916711859923       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916711852123       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916711925338       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916712151494       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916712244619       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916712214186       residual = 9.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916712336247       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916712389971       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916712521499       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916712459034       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916712494042       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916712450148       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916712467237       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916712502418       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916712547432       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916712582406       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916712597440       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916712622689       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916712607725       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916712639641       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916712670630       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916712671380       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916712672684       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916712669223       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916712667612       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916712663067       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916712663302       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916712661486       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916712661862       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916712666045       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916712664475       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916712667169       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4552e+00 is 1.806235e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.153209 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4645e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
  uu_0                 2.100850e-01 1 1  ON 0
  uu_1                 5.304958e-02 1 1  ON 1
  uu_2                -3.774353e-02 1 1  ON 2
  uu_3                -9.108979e-02 1 1  ON 3
  uu_4                -1.218028e-01 1 1  ON 4
  uu_5                -1.299179e-01 1 1  ON 5
  uu_6                -1.125978e-01 1 1  ON 6
  uu_7                -5.701184e-02 1 1  ON 7
  uu_8                 5.740313e-02 1 1  ON 8
  uu_9                 1.246055e-01 1 1  ON 9
  ud_0                 3.048185e-01 1 1  ON 10
  ud_1                 7.558916e-02 1 1  ON 11
  ud_2                -2.644230e-02 1 1  ON 12
  ud_3                -7.932625e-02 1 1  ON 13
  ud_4                -1.150033e-01 1 1  ON 14
  ud_5                -1.331588e-01 1 1  ON 15
  ud_6                -1.261479e-01 1 1  ON 16
  ud_7                -8.466797e-02 1 1  ON 17
  ud_8                -6.640328e-03 1 1  ON 18
  ud_9                 8.556642e-02 1 1  ON 19
  eO_0                -7.035457e-01 1 1  ON 20
  eO_1                -4.202988e-01 1 1  ON 21
  eO_2                -4.182357e-02 1 1  ON 22
  eO_3                 1.843516e-01 1 1  ON 23
  eO_4                 2.569074e-01 1 1  ON 24
  eO_5                 2.795840e-01 1 1  ON 25
  eO_6                 2.505860e-01 1 1  ON 26
  eO_7                 1.340853e-01 1 1  ON 27
  eO_8                 2.938311e-02 1 1  ON 28
  eO_9                 1.925626e-02 1 1  ON 29
 eH1_0                -2.016180e-01 1 1  ON 30
 eH1_1                -9.588027e-02 1 1  ON 31
 eH1_2                -4.448531e-02 1 1  ON 32
 eH1_3                -1.428563e-02 1 1  ON 33
 eH1_4                 1.792057e-02 1 1  ON 34
 eH1_5                 2.134775e-02 1 1  ON 35
 eH1_6                 7.112091e-02 1 1  ON 36
 eH1_7                 1.025519e-01 1 1  ON 37
 eH1_8                 1.011535e-01 1 1  ON 38
 eH1_9                 2.609820e-02 1 1  ON 39
 eH2_0                -2.035146e-01 1 1  ON 40
 eH2_1                -9.762095e-02 1 1  ON 41
 eH2_2                -4.625373e-02 1 1  ON 42
 eH2_3                -1.542935e-02 1 1  ON 43
 eH2_4                 1.629911e-02 1 1  ON 44
 eH2_5                 1.973886e-02 1 1  ON 45
 eH2_6                 7.171319e-02 1 1  ON 46
 eH2_7                 1.093694e-01 1 1  ON 47
 eH2_8                 1.039059e-01 1 1  ON 48
 eH2_9                 2.905507e-02 1 1  ON 49
ci_001                -4.160935e-02 3 1  ON 50
ci_002                -3.093786e-02 3 1  ON 51
ci_003                -1.150223e-02 3 1  ON 52
ci_004                 2.554436e-02 3 1  ON 53
ci_005                 2.557992e-02 3 1  ON 54
ci_006                -2.032325e-02 3 1  ON 55
ci_007                -1.979008e-02 3 1  ON 56
ci_008                -4.335626e-03 3 1  ON 57
ci_009                -1.502351e-02 3 1  ON 58
ci_010                -9.479639e-03 3 1  ON 59
ci_011                -9.689984e-03 3 1  ON 60
ci_012                -9.622761e-03 3 1  ON 61
ci_013                -2.131131e-02 3 1  ON 62
ci_014                 1.334728e-02 3 1  ON 63
ci_015                 1.303968e-02 3 1  ON 64
ci_016                 1.628666e-02 3 1  ON 65
ci_017                 1.612802e-02 3 1  ON 66
ci_018                 1.093532e-02 3 1  ON 67
ci_019                 1.059330e-02 3 1  ON 68
ci_020                 1.855416e-02 3 1  ON 69
ci_021                 1.806842e-02 3 1  ON 70
ci_022                 1.042703e-02 3 1  ON 71
ci_023                 1.044402e-02 3 1  ON 72
ci_024                 6.739870e-03 3 1  ON 73
ci_025                 6.453101e-03 3 1  ON 74
ci_026                 1.178622e-02 3 1  ON 75
ci_027                 1.192701e-02 3 1  ON 76
ci_028                -9.294679e-03 3 1  ON 77
ci_029                -9.832809e-03 3 1  ON 78
ci_030                -5.036851e-03 3 1  ON 79
ci_031                -4.702439e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2286
    reference variance = 0.28126
====================================================
  Execution time = 1.9311e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0138e-01
  Total weights = 1.9740e+06
  Execution time = 1.5631e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290020413745
                                         uncertainty =       0.001716273400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290020413745
                                         uncertainty =       0.001716273400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380836177
  error estimate for blocks of size 2^( 2) =       0.000395808108
  error estimate for blocks of size 2^( 3) =       0.000410249459
  error estimate for blocks of size 2^( 4) =       0.000420663174
  error estimate for blocks of size 2^( 5) =       0.000427248444
  error estimate for blocks of size 2^( 6) =       0.000430806599
  error estimate for blocks of size 2^( 7) =       0.000432549238

      target function =      -0.910601001915
              le_mean =     -17.205900072248
             les_mean =     296.344409732728
             stat err =       0.000427816864
             autocorr =       1.261942033119
   target nu stat err =       0.000427816864
   target dn stat err =       0.003677889660
      target stat err =       0.005681392692
              std dev =       0.538583685960
             le_variance =       0.290072386782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290029277576
                                         uncertainty =       0.001736894487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290029277576
                                         uncertainty =       0.001736894487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380839303
  error estimate for blocks of size 2^( 2) =       0.000395792076
  error estimate for blocks of size 2^( 3) =       0.000410215666
  error estimate for blocks of size 2^( 4) =       0.000420609599
  error estimate for blocks of size 2^( 5) =       0.000427194336
  error estimate for blocks of size 2^( 6) =       0.000430753070
  error estimate for blocks of size 2^( 7) =       0.000432489241

      target function =      -0.910043282100
              le_mean =     -17.205898795355
             les_mean =     296.344727735796
             stat err =       0.000427761561
             autocorr =       1.261595085742
   target nu stat err =       0.000427761561
   target dn stat err =       0.003860682571
      target stat err =       0.005952085830
              std dev =       0.538588107564
             le_variance =       0.290077149610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290009012825
                                         uncertainty =       0.001730575783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290009012825
                                         uncertainty =       0.001730575783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380826789
  error estimate for blocks of size 2^( 2) =       0.000395783860
  error estimate for blocks of size 2^( 3) =       0.000410210989
  error estimate for blocks of size 2^( 4) =       0.000420609996
  error estimate for blocks of size 2^( 5) =       0.000427193464
  error estimate for blocks of size 2^( 6) =       0.000430751395
  error estimate for blocks of size 2^( 7) =       0.000432488543

      target function =      -0.910370962955
              le_mean =     -17.205898038265
             les_mean =     296.344488395757
             stat err =       0.000427760849
             autocorr =       1.261673802661
   target nu stat err =       0.000427760849
   target dn stat err =       0.003801940360
      target stat err =       0.005867030267
              std dev =       0.538570409700
             le_variance =       0.290058086204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290014263501
                                         uncertainty =       0.001718075967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290014263501
                                         uncertainty =       0.001718075967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380831871
  error estimate for blocks of size 2^( 2) =       0.000395802154
  error estimate for blocks of size 2^( 3) =       0.000410241426
  error estimate for blocks of size 2^( 4) =       0.000420654913
  error estimate for blocks of size 2^( 5) =       0.000427239330
  error estimate for blocks of size 2^( 6) =       0.000430797352
  error estimate for blocks of size 2^( 7) =       0.000432539426

      target function =      -0.907616832848
              le_mean =     -17.205899986187
             les_mean =     296.346353521508
             stat err =       0.000427807755
             autocorr =       1.261916833740
   target nu stat err =       0.000427807755
   target dn stat err =       0.004231178617
      target stat err =       0.006480893592
              std dev =       0.538577596716
             le_variance =       0.290065827685


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910601001915        initial  <--
     9.0949e-02     9.0949e-01             2.7102e-03        -0.910043282100
     3.6380e-01     3.6380e+00             7.1255e-04        -0.910370962955
     1.4552e+00     1.4552e+01             1.8062e-04        -0.907616832848

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.2182
  </log>
  <optVariables href="H2O.s053.opt.xml">
  uu_0                 2.099554e-01 1 1  ON 0
  uu_1                 5.296366e-02 1 1  ON 1
  uu_2                -3.787667e-02 1 1  ON 2
  uu_3                -9.122636e-02 1 1  ON 3
  uu_4                -1.219397e-01 1 1  ON 4
  uu_5                -1.298121e-01 1 1  ON 5
  uu_6                -1.125630e-01 1 1  ON 6
  uu_7                -5.673179e-02 1 1  ON 7
  uu_8                 5.811568e-02 1 1  ON 8
  uu_9                 1.245063e-01 1 1  ON 9
  ud_0                 3.048895e-01 1 1  ON 10
  ud_1                 7.565361e-02 1 1  ON 11
  ud_2                -2.646812e-02 1 1  ON 12
  ud_3                -7.929722e-02 1 1  ON 13
  ud_4                -1.150067e-01 1 1  ON 14
  ud_5                -1.333237e-01 1 1  ON 15
  ud_6                -1.264020e-01 1 1  ON 16
  ud_7                -8.461485e-02 1 1  ON 17
  ud_8                -6.276329e-03 1 1  ON 18
  ud_9                 8.581903e-02 1 1  ON 19
  eO_0                -7.034795e-01 1 1  ON 20
  eO_1                -4.202478e-01 1 1  ON 21
  eO_2                -4.178959e-02 1 1  ON 22
  eO_3                 1.844432e-01 1 1  ON 23
  eO_4                 2.569101e-01 1 1  ON 24
  eO_5                 2.798569e-01 1 1  ON 25
  eO_6                 2.508623e-01 1 1  ON 26
  eO_7                 1.334787e-01 1 1  ON 27
  eO_8                 2.928496e-02 1 1  ON 28
  eO_9                 1.919927e-02 1 1  ON 29
 eH1_0                -2.017296e-01 1 1  ON 30
 eH1_1                -9.603339e-02 1 1  ON 31
 eH1_2                -4.455536e-02 1 1  ON 32
 eH1_3                -1.423159e-02 1 1  ON 33
 eH1_4                 1.808755e-02 1 1  ON 34
 eH1_5                 2.185290e-02 1 1  ON 35
 eH1_6                 7.088946e-02 1 1  ON 36
 eH1_7                 1.025589e-01 1 1  ON 37
 eH1_8                 1.010528e-01 1 1  ON 38
 eH1_9                 2.608797e-02 1 1  ON 39
 eH2_0                -2.031746e-01 1 1  ON 40
 eH2_1                -9.764259e-02 1 1  ON 41
 eH2_2                -4.626308e-02 1 1  ON 42
 eH2_3                -1.570208e-02 1 1  ON 43
 eH2_4                 1.609454e-02 1 1  ON 44
 eH2_5                 1.954708e-02 1 1  ON 45
 eH2_6                 7.200443e-02 1 1  ON 46
 eH2_7                 1.099222e-01 1 1  ON 47
 eH2_8                 1.035504e-01 1 1  ON 48
 eH2_9                 2.895545e-02 1 1  ON 49
ci_001                -4.165466e-02 3 1  ON 50
ci_002                -3.094180e-02 3 1  ON 51
ci_003                -1.141100e-02 3 1  ON 52
ci_004                 2.557269e-02 3 1  ON 53
ci_005                 2.573472e-02 3 1  ON 54
ci_006                -2.021568e-02 3 1  ON 55
ci_007                -1.979710e-02 3 1  ON 56
ci_008                -4.042621e-03 3 1  ON 57
ci_009                -1.516429e-02 3 1  ON 58
ci_010                -9.520128e-03 3 1  ON 59
ci_011                -9.638016e-03 3 1  ON 60
ci_012                -9.632110e-03 3 1  ON 61
ci_013                -2.167173e-02 3 1  ON 62
ci_014                 1.333306e-02 3 1  ON 63
ci_015                 1.313413e-02 3 1  ON 64
ci_016                 1.627930e-02 3 1  ON 65
ci_017                 1.612529e-02 3 1  ON 66
ci_018                 1.086407e-02 3 1  ON 67
ci_019                 1.051424e-02 3 1  ON 68
ci_020                 1.847339e-02 3 1  ON 69
ci_021                 1.812453e-02 3 1  ON 70
ci_022                 1.026580e-02 3 1  ON 71
ci_023                 1.029006e-02 3 1  ON 72
ci_024                 6.711674e-03 3 1  ON 73
ci_025                 6.510694e-03 3 1  ON 74
ci_026                 1.187562e-02 3 1  ON 75
ci_027                 1.184173e-02 3 1  ON 76
ci_028                -9.172368e-03 3 1  ON 77
ci_029                -9.757716e-03 3 1  ON 78
ci_030                -4.998884e-03 3 1  ON 79
ci_031                -4.672902e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1869e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.1856
    reference variance = 0.319196
====================================================
  Execution time = 1.9348e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5433e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9769e-01
  Total weights = 1.973741583e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5462e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289295094301
                                         uncertainty =       0.001664775169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289295094301
                                         uncertainty =       0.001664775169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380416613
  error estimate for blocks of size 2^( 2) =       0.000396245586
  error estimate for blocks of size 2^( 3) =       0.000410528383
  error estimate for blocks of size 2^( 4) =       0.000420622300
  error estimate for blocks of size 2^( 5) =       0.000427100167
  error estimate for blocks of size 2^( 6) =       0.000430443068
  error estimate for blocks of size 2^( 7) =       0.000431751446

      target function =      -0.916359440150
              le_mean =     -17.205848383350
             les_mean =     296.338910985966
             stat err =       0.000427479245
             autocorr =       1.262731800311
   target nu stat err =       0.000427479245
   target dn stat err =       0.002249886532
      target stat err =       0.003565052912
              std dev =       0.537990333873
             le_variance =       0.289433599341


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720584838335e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916372261784       residual = 4.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916389136533       residual = 7.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916392821938       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916393820829       residual = 9.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916394151952       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916394185381       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916394552471       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916394704245       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916395032808       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916395156442       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916395149295       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916395206347       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916395310246       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916395610924       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916395485399       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916395528239       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916395545388       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916395620658       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916395591734       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916395741299       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916395820883       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916395907496       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916395873067       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916395860505       residual = 9.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916395896178       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916395873326       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916395869032       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916395893716       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916395884498       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916395883252       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916395887753       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916395888989       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916395870831       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916395863774       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916395871571       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916395861633       residual = 8.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.0949e-01 is 3.362317e-04

solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916372261784       residual = 4.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916376750554       residual = 7.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916377712093       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916377976940       residual = 9.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916378060723       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916378070239       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916378167166       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916378204995       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916378291301       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916378321612       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916378319464       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916378335331       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916378362475       residual = 9.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916378437252       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916378403676       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916378414876       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916378419305       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916378438707       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916378431274       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916378469886       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916378489691       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916378508213       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916378498712       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916378497327       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916378504972       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916378498539       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916378498911       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916378503034       residual = 9.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916378503327       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916378500026       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916378504445       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916378500571       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916378497546       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916378498049       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916378498203       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916378496414       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.6380e+00 is 8.463122e-05

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916372261784       residual = 4.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916373402229       residual = 7.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916373645242       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916373712482       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916373733480       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916373735957       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916373760530       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916373769967       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916373791820       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916373799346       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916373798790       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916373802867       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916373809724       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916373828374       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916373819841       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916373822678       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916373823799       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916373828679       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916373826808       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916373836550       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916373841478       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916373845896       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916373843481       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916373843247       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916373845063       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916373843422       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916373843606       residual = 9.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916373844499       residual = 9.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916373844732       residual = 8.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916373843800       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916373844921       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916373843753       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916373843177       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916373843383       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916373843377       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916373842925       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4552e+01 is 2.119390e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.203498 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4950e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
  uu_0                 2.099620e-01 1 1  ON 0
  uu_1                 5.297237e-02 1 1  ON 1
  uu_2                -3.787162e-02 1 1  ON 2
  uu_3                -9.121618e-02 1 1  ON 3
  uu_4                -1.219255e-01 1 1  ON 4
  uu_5                -1.297934e-01 1 1  ON 5
  uu_6                -1.125681e-01 1 1  ON 6
  uu_7                -5.675188e-02 1 1  ON 7
  uu_8                 5.803105e-02 1 1  ON 8
  uu_9                 1.245152e-01 1 1  ON 9
  ud_0                 3.048557e-01 1 1  ON 10
  ud_1                 7.561762e-02 1 1  ON 11
  ud_2                -2.648606e-02 1 1  ON 12
  ud_3                -7.931215e-02 1 1  ON 13
  ud_4                -1.150019e-01 1 1  ON 14
  ud_5                -1.332991e-01 1 1  ON 15
  ud_6                -1.263862e-01 1 1  ON 16
  ud_7                -8.455506e-02 1 1  ON 17
  ud_8                -6.311374e-03 1 1  ON 18
  ud_9                 8.579224e-02 1 1  ON 19
  eO_0                -7.034881e-01 1 1  ON 20
  eO_1                -4.202665e-01 1 1  ON 21
  eO_2                -4.181706e-02 1 1  ON 22
  eO_3                 1.844212e-01 1 1  ON 23
  eO_4                 2.568758e-01 1 1  ON 24
  eO_5                 2.798822e-01 1 1  ON 25
  eO_6                 2.508627e-01 1 1  ON 26
  eO_7                 1.335477e-01 1 1  ON 27
  eO_8                 2.929553e-02 1 1  ON 28
  eO_9                 1.919980e-02 1 1  ON 29
 eH1_0                -2.016764e-01 1 1  ON 30
 eH1_1                -9.600539e-02 1 1  ON 31
 eH1_2                -4.453389e-02 1 1  ON 32
 eH1_3                -1.421979e-02 1 1  ON 33
 eH1_4                 1.806887e-02 1 1  ON 34
 eH1_5                 2.178729e-02 1 1  ON 35
 eH1_6                 7.084195e-02 1 1  ON 36
 eH1_7                 1.025175e-01 1 1  ON 37
 eH1_8                 1.011078e-01 1 1  ON 38
 eH1_9                 2.608731e-02 1 1  ON 39
 eH2_0                -2.031473e-01 1 1  ON 40
 eH2_1                -9.761881e-02 1 1  ON 41
 eH2_2                -4.623918e-02 1 1  ON 42
 eH2_3                -1.568227e-02 1 1  ON 43
 eH2_4                 1.607883e-02 1 1  ON 44
 eH2_5                 1.949515e-02 1 1  ON 45
 eH2_6                 7.193372e-02 1 1  ON 46
 eH2_7                 1.099287e-01 1 1  ON 47
 eH2_8                 1.035783e-01 1 1  ON 48
 eH2_9                 2.896446e-02 1 1  ON 49
ci_001                -4.168547e-02 3 1  ON 50
ci_002                -3.095205e-02 3 1  ON 51
ci_003                -1.140752e-02 3 1  ON 52
ci_004                 2.558379e-02 3 1  ON 53
ci_005                 2.571182e-02 3 1  ON 54
ci_006                -2.021055e-02 3 1  ON 55
ci_007                -1.979676e-02 3 1  ON 56
ci_008                -4.064237e-03 3 1  ON 57
ci_009                -1.516441e-02 3 1  ON 58
ci_010                -9.514899e-03 3 1  ON 59
ci_011                -9.661526e-03 3 1  ON 60
ci_012                -9.645201e-03 3 1  ON 61
ci_013                -2.166977e-02 3 1  ON 62
ci_014                 1.335575e-02 3 1  ON 63
ci_015                 1.314200e-02 3 1  ON 64
ci_016                 1.625845e-02 3 1  ON 65
ci_017                 1.612637e-02 3 1  ON 66
ci_018                 1.088663e-02 3 1  ON 67
ci_019                 1.051005e-02 3 1  ON 68
ci_020                 1.847575e-02 3 1  ON 69
ci_021                 1.811868e-02 3 1  ON 70
ci_022                 1.028027e-02 3 1  ON 71
ci_023                 1.030191e-02 3 1  ON 72
ci_024                 6.713965e-03 3 1  ON 73
ci_025                 6.524101e-03 3 1  ON 74
ci_026                 1.187771e-02 3 1  ON 75
ci_027                 1.184807e-02 3 1  ON 76
ci_028                -9.182074e-03 3 1  ON 77
ci_029                -9.750733e-03 3 1  ON 78
ci_030                -4.987938e-03 3 1  ON 79
ci_031                -4.689282e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.1726
    reference variance = 0.277131
====================================================
  Execution time = 1.8974e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9722e-01
  Total weights = 1.9740e+06
  Execution time = 1.5666e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288695125469
                                         uncertainty =       0.001590499351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288695125469
                                         uncertainty =       0.001590499351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379904877
  error estimate for blocks of size 2^( 2) =       0.000395124546
  error estimate for blocks of size 2^( 3) =       0.000409272173
  error estimate for blocks of size 2^( 4) =       0.000418883004
  error estimate for blocks of size 2^( 5) =       0.000425845031
  error estimate for blocks of size 2^( 6) =       0.000428578262
  error estimate for blocks of size 2^( 7) =       0.000430039172

      target function =      -0.917097713195
              le_mean =     -17.206565846968
             les_mean =     296.363117870769
             stat err =       0.000425836367
             autocorr =       1.256422654190
   target nu stat err =       0.000425836367
   target dn stat err =       0.002377630604
      target stat err =       0.003769758940
              std dev =       0.537266630067
             le_variance =       0.288655431784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288689950183
                                         uncertainty =       0.001591757702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288689950183
                                         uncertainty =       0.001591757702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379901465
  error estimate for blocks of size 2^( 2) =       0.000395115682
  error estimate for blocks of size 2^( 3) =       0.000409259469
  error estimate for blocks of size 2^( 4) =       0.000418867990
  error estimate for blocks of size 2^( 5) =       0.000425828930
  error estimate for blocks of size 2^( 6) =       0.000428559220
  error estimate for blocks of size 2^( 7) =       0.000430015652

      target function =      -0.916895588195
              le_mean =     -17.206566067620
             les_mean =     296.363255325246
             stat err =       0.000425817948
             autocorr =       1.256336535108
   target nu stat err =       0.000425817948
   target dn stat err =       0.002385017522
      target stat err =       0.003779401235
              std dev =       0.537261803604
             le_variance =       0.288650245611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288692103542
                                         uncertainty =       0.001591159324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288692103542
                                         uncertainty =       0.001591159324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379902885
  error estimate for blocks of size 2^( 2) =       0.000395119630
  error estimate for blocks of size 2^( 3) =       0.000409265167
  error estimate for blocks of size 2^( 4) =       0.000418874775
  error estimate for blocks of size 2^( 5) =       0.000425836231
  error estimate for blocks of size 2^( 6) =       0.000428567904
  error estimate for blocks of size 2^( 7) =       0.000430026479

      target function =      -0.917045946280
              le_mean =     -17.206565936417
             les_mean =     296.363154193483
             stat err =       0.000425826347
             autocorr =       1.256376702840
   target nu stat err =       0.000425826347
   target dn stat err =       0.002380648609
      target stat err =       0.003773947573
              std dev =       0.537263812384
             le_variance =       0.288652404098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288694697097
                                         uncertainty =       0.001590581762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288694697097
                                         uncertainty =       0.001590581762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379904595
  error estimate for blocks of size 2^( 2) =       0.000395123892
  error estimate for blocks of size 2^( 3) =       0.000409271252
  error estimate for blocks of size 2^( 4) =       0.000418881929
  error estimate for blocks of size 2^( 5) =       0.000425843884
  error estimate for blocks of size 2^( 6) =       0.000428576916
  error estimate for blocks of size 2^( 7) =       0.000430037531

      target function =      -0.917093342782
              le_mean =     -17.206565853353
             les_mean =     296.363120896475
             stat err =       0.000425835065
             autocorr =       1.256416836298
   target nu stat err =       0.000425835065
   target dn stat err =       0.002377954786
      target stat err =       0.003770218415
              std dev =       0.537266230749
             le_variance =       0.288655002703


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917097713195        initial  <--
     9.0949e-01     9.0949e+00             3.3623e-04        -0.916895588195
     3.6380e+00     3.6380e+01             8.4631e-05        -0.917045946280
     1.4552e+01     1.4552e+02             2.1194e-05        -0.917093342782

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.8459
  </log>
  <optVariables href="H2O.s054.opt.xml">
  uu_0                 2.099554e-01 1 1  ON 0
  uu_1                 5.296366e-02 1 1  ON 1
  uu_2                -3.787667e-02 1 1  ON 2
  uu_3                -9.122636e-02 1 1  ON 3
  uu_4                -1.219397e-01 1 1  ON 4
  uu_5                -1.298121e-01 1 1  ON 5
  uu_6                -1.125630e-01 1 1  ON 6
  uu_7                -5.673179e-02 1 1  ON 7
  uu_8                 5.811568e-02 1 1  ON 8
  uu_9                 1.245063e-01 1 1  ON 9
  ud_0                 3.048895e-01 1 1  ON 10
  ud_1                 7.565361e-02 1 1  ON 11
  ud_2                -2.646812e-02 1 1  ON 12
  ud_3                -7.929722e-02 1 1  ON 13
  ud_4                -1.150067e-01 1 1  ON 14
  ud_5                -1.333237e-01 1 1  ON 15
  ud_6                -1.264020e-01 1 1  ON 16
  ud_7                -8.461485e-02 1 1  ON 17
  ud_8                -6.276329e-03 1 1  ON 18
  ud_9                 8.581903e-02 1 1  ON 19
  eO_0                -7.034795e-01 1 1  ON 20
  eO_1                -4.202478e-01 1 1  ON 21
  eO_2                -4.178959e-02 1 1  ON 22
  eO_3                 1.844432e-01 1 1  ON 23
  eO_4                 2.569101e-01 1 1  ON 24
  eO_5                 2.798569e-01 1 1  ON 25
  eO_6                 2.508623e-01 1 1  ON 26
  eO_7                 1.334787e-01 1 1  ON 27
  eO_8                 2.928496e-02 1 1  ON 28
  eO_9                 1.919927e-02 1 1  ON 29
 eH1_0                -2.017296e-01 1 1  ON 30
 eH1_1                -9.603339e-02 1 1  ON 31
 eH1_2                -4.455536e-02 1 1  ON 32
 eH1_3                -1.423159e-02 1 1  ON 33
 eH1_4                 1.808755e-02 1 1  ON 34
 eH1_5                 2.185290e-02 1 1  ON 35
 eH1_6                 7.088946e-02 1 1  ON 36
 eH1_7                 1.025589e-01 1 1  ON 37
 eH1_8                 1.010528e-01 1 1  ON 38
 eH1_9                 2.608797e-02 1 1  ON 39
 eH2_0                -2.031746e-01 1 1  ON 40
 eH2_1                -9.764259e-02 1 1  ON 41
 eH2_2                -4.626308e-02 1 1  ON 42
 eH2_3                -1.570208e-02 1 1  ON 43
 eH2_4                 1.609454e-02 1 1  ON 44
 eH2_5                 1.954708e-02 1 1  ON 45
 eH2_6                 7.200443e-02 1 1  ON 46
 eH2_7                 1.099222e-01 1 1  ON 47
 eH2_8                 1.035504e-01 1 1  ON 48
 eH2_9                 2.895545e-02 1 1  ON 49
ci_001                -4.165466e-02 3 1  ON 50
ci_002                -3.094180e-02 3 1  ON 51
ci_003                -1.141100e-02 3 1  ON 52
ci_004                 2.557269e-02 3 1  ON 53
ci_005                 2.573472e-02 3 1  ON 54
ci_006                -2.021568e-02 3 1  ON 55
ci_007                -1.979710e-02 3 1  ON 56
ci_008                -4.042621e-03 3 1  ON 57
ci_009                -1.516429e-02 3 1  ON 58
ci_010                -9.520128e-03 3 1  ON 59
ci_011                -9.638016e-03 3 1  ON 60
ci_012                -9.632110e-03 3 1  ON 61
ci_013                -2.167173e-02 3 1  ON 62
ci_014                 1.333306e-02 3 1  ON 63
ci_015                 1.313413e-02 3 1  ON 64
ci_016                 1.627930e-02 3 1  ON 65
ci_017                 1.612529e-02 3 1  ON 66
ci_018                 1.086407e-02 3 1  ON 67
ci_019                 1.051424e-02 3 1  ON 68
ci_020                 1.847339e-02 3 1  ON 69
ci_021                 1.812453e-02 3 1  ON 70
ci_022                 1.026580e-02 3 1  ON 71
ci_023                 1.029006e-02 3 1  ON 72
ci_024                 6.711674e-03 3 1  ON 73
ci_025                 6.510694e-03 3 1  ON 74
ci_026                 1.187562e-02 3 1  ON 75
ci_027                 1.184173e-02 3 1  ON 76
ci_028                -9.172368e-03 3 1  ON 77
ci_029                -9.757716e-03 3 1  ON 78
ci_030                -4.998884e-03 3 1  ON 79
ci_031                -4.672902e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1802e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2199
    reference variance = 0.179064
====================================================
  Execution time = 1.9428e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5417e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0079e-01
  Total weights = 1.973703670e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4374e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292847331799
                                         uncertainty =       0.002350775259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292847331799
                                         uncertainty =       0.002350775259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382730708
  error estimate for blocks of size 2^( 2) =       0.000397715366
  error estimate for blocks of size 2^( 3) =       0.000411531989
  error estimate for blocks of size 2^( 4) =       0.000422203383
  error estimate for blocks of size 2^( 5) =       0.000428905796
  error estimate for blocks of size 2^( 6) =       0.000431376690
  error estimate for blocks of size 2^( 7) =       0.000432051589

      target function =      -0.911576017790
              le_mean =     -17.205687069458
             les_mean =     296.336459069341
             stat err =       0.000428634364
             autocorr =       1.254259370947
   target nu stat err =       0.000428634364
   target dn stat err =       0.002561978818
      target stat err =       0.003998168589
              std dev =       0.541262958343
             le_variance =       0.292965590074


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720568706946e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911592388785       residual = 3.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911593803672       residual = 6.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911594236070       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911594342342       residual = 8.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911594437759       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911594477560       residual = 7.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911594497118       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911594545948       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911594557411       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911594560257       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911594588062       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911594598272       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911594596244       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911594627053       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911594640024       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911594648121       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911594659137       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911594680578       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911594684559       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911594687320       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911594692153       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911594698399       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911594702478       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911594703578       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911594703380       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911594702217       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911594700325       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911594695163       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911594695755       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911594697713       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911594697156       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911594696894       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911594699199       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911594699785       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911594700486       residual = 9.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.0949e+00 is 3.417389e-05

solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911592388785       residual = 3.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911592744815       residual = 6.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911592853485       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911592880148       residual = 8.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911592904101       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911592914092       residual = 7.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911592919036       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911592931300       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911592934160       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911592934870       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911592941841       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911592944392       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911592943890       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911592951609       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911592954856       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911592956889       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911592959659       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911592964998       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911592965967       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911592966652       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911592967858       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911592969417       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911592970433       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911592970701       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911592970647       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911592970351       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911592969876       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911592968589       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911592968751       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911592969235       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911592969094       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911592969024       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911592969605       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911592969746       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911592969920       residual = 9.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.6380e+01 is 8.546004e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911592388785       residual = 3.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911592477938       residual = 6.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911592505141       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911592511813       residual = 8.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911592517807       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911592520308       residual = 7.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911592521547       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911592524617       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911592525331       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911592525509       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911592527253       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911592527890       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911592527765       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911592529696       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911592530507       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911592531017       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911592531710       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911592533044       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911592533284       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911592533455       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911592533757       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911592534146       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911592534400       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911592534466       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911592534453       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911592534378       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911592534259       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911592533938       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911592533979       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911592534101       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911592534065       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911592534046       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911592534192       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911592534227       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911592534271       residual = 9.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4552e+02 is 2.136659e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.249117 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4916e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
  uu_0                 2.099597e-01 1 1  ON 0
  uu_1                 5.296708e-02 1 1  ON 1
  uu_2                -3.787355e-02 1 1  ON 2
  uu_3                -9.122471e-02 1 1  ON 3
  uu_4                -1.219390e-01 1 1  ON 4
  uu_5                -1.298137e-01 1 1  ON 5
  uu_6                -1.125694e-01 1 1  ON 6
  uu_7                -5.673783e-02 1 1  ON 7
  uu_8                 5.811134e-02 1 1  ON 8
  uu_9                 1.245078e-01 1 1  ON 9
  ud_0                 3.048832e-01 1 1  ON 10
  ud_1                 7.564859e-02 1 1  ON 11
  ud_2                -2.647159e-02 1 1  ON 12
  ud_3                -7.930022e-02 1 1  ON 13
  ud_4                -1.150074e-01 1 1  ON 14
  ud_5                -1.333209e-01 1 1  ON 15
  ud_6                -1.263977e-01 1 1  ON 16
  ud_7                -8.461015e-02 1 1  ON 17
  ud_8                -6.273150e-03 1 1  ON 18
  ud_9                 8.582007e-02 1 1  ON 19
  eO_0                -7.034775e-01 1 1  ON 20
  eO_1                -4.202475e-01 1 1  ON 21
  eO_2                -4.178969e-02 1 1  ON 22
  eO_3                 1.844406e-01 1 1  ON 23
  eO_4                 2.569042e-01 1 1  ON 24
  eO_5                 2.798497e-01 1 1  ON 25
  eO_6                 2.508649e-01 1 1  ON 26
  eO_7                 1.334872e-01 1 1  ON 27
  eO_8                 2.928667e-02 1 1  ON 28
  eO_9                 1.919974e-02 1 1  ON 29
 eH1_0                -2.017320e-01 1 1  ON 30
 eH1_1                -9.603399e-02 1 1  ON 31
 eH1_2                -4.455550e-02 1 1  ON 32
 eH1_3                -1.423148e-02 1 1  ON 33
 eH1_4                 1.808815e-02 1 1  ON 34
 eH1_5                 2.185127e-02 1 1  ON 35
 eH1_6                 7.088816e-02 1 1  ON 36
 eH1_7                 1.025588e-01 1 1  ON 37
 eH1_8                 1.010570e-01 1 1  ON 38
 eH1_9                 2.608928e-02 1 1  ON 39
 eH2_0                -2.031747e-01 1 1  ON 40
 eH2_1                -9.764050e-02 1 1  ON 41
 eH2_2                -4.626199e-02 1 1  ON 42
 eH2_3                -1.570158e-02 1 1  ON 43
 eH2_4                 1.609669e-02 1 1  ON 44
 eH2_5                 1.954397e-02 1 1  ON 45
 eH2_6                 7.199879e-02 1 1  ON 46
 eH2_7                 1.099181e-01 1 1  ON 47
 eH2_8                 1.035555e-01 1 1  ON 48
 eH2_9                 2.895669e-02 1 1  ON 49
ci_001                -4.165299e-02 3 1  ON 50
ci_002                -3.094304e-02 3 1  ON 51
ci_003                -1.141300e-02 3 1  ON 52
ci_004                 2.557279e-02 3 1  ON 53
ci_005                 2.573366e-02 3 1  ON 54
ci_006                -2.021520e-02 3 1  ON 55
ci_007                -1.979913e-02 3 1  ON 56
ci_008                -4.044945e-03 3 1  ON 57
ci_009                -1.516425e-02 3 1  ON 58
ci_010                -9.522170e-03 3 1  ON 59
ci_011                -9.638929e-03 3 1  ON 60
ci_012                -9.633341e-03 3 1  ON 61
ci_013                -2.167034e-02 3 1  ON 62
ci_014                 1.333226e-02 3 1  ON 63
ci_015                 1.313389e-02 3 1  ON 64
ci_016                 1.628024e-02 3 1  ON 65
ci_017                 1.612608e-02 3 1  ON 66
ci_018                 1.086325e-02 3 1  ON 67
ci_019                 1.051499e-02 3 1  ON 68
ci_020                 1.847177e-02 3 1  ON 69
ci_021                 1.812435e-02 3 1  ON 70
ci_022                 1.026480e-02 3 1  ON 71
ci_023                 1.029065e-02 3 1  ON 72
ci_024                 6.712192e-03 3 1  ON 73
ci_025                 6.509654e-03 3 1  ON 74
ci_026                 1.187374e-02 3 1  ON 75
ci_027                 1.184175e-02 3 1  ON 76
ci_028                -9.172167e-03 3 1  ON 77
ci_029                -9.757597e-03 3 1  ON 78
ci_030                -4.996708e-03 3 1  ON 79
ci_031                -4.672388e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.1493
    reference variance = 0.279442
====================================================
  Execution time = 1.9269e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9625e-01
  Total weights = 1.9734e+06
  Execution time = 1.5622e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286427250099
                                         uncertainty =       0.001573091455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286427250099
                                         uncertainty =       0.001573091455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378423655
  error estimate for blocks of size 2^( 2) =       0.000394012513
  error estimate for blocks of size 2^( 3) =       0.000408724721
  error estimate for blocks of size 2^( 4) =       0.000419211417
  error estimate for blocks of size 2^( 5) =       0.000426039469
  error estimate for blocks of size 2^( 6) =       0.000429592033
  error estimate for blocks of size 2^( 7) =       0.000432346066

      target function =      -0.918593779283
              le_mean =     -17.206269958293
             les_mean =     296.351977625334
             stat err =       0.000426797246
             autocorr =       1.271998693241
   target nu stat err =       0.000426797246
   target dn stat err =       0.002410823092
      target stat err =       0.003830929964
              std dev =       0.535171865198
             le_variance =       0.286408925300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286427479838
                                         uncertainty =       0.001572960617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286427479838
                                         uncertainty =       0.001572960617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378423808
  error estimate for blocks of size 2^( 2) =       0.000394013062
  error estimate for blocks of size 2^( 3) =       0.000408725725
  error estimate for blocks of size 2^( 4) =       0.000419212920
  error estimate for blocks of size 2^( 5) =       0.000426041277
  error estimate for blocks of size 2^( 6) =       0.000429593812
  error estimate for blocks of size 2^( 7) =       0.000432347948

      target function =      -0.918579773094
              le_mean =     -17.206269908639
             les_mean =     296.351984885627
             stat err =       0.000426798990
             autocorr =       1.272008054562
   target nu stat err =       0.000426798990
   target dn stat err =       0.002411824611
      target stat err =       0.003832349931
              std dev =       0.535172081899
             le_variance =       0.286409157244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286427360439
                                         uncertainty =       0.001573025624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286427360439
                                         uncertainty =       0.001573025624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378423729
  error estimate for blocks of size 2^( 2) =       0.000394012785
  error estimate for blocks of size 2^( 3) =       0.000408725221
  error estimate for blocks of size 2^( 4) =       0.000419212168
  error estimate for blocks of size 2^( 5) =       0.000426040373
  error estimate for blocks of size 2^( 6) =       0.000429592923
  error estimate for blocks of size 2^( 7) =       0.000432347008

      target function =      -0.918587421228
              le_mean =     -17.206269932944
             les_mean =     296.351980824115
             stat err =       0.000426798118
             autocorr =       1.272003394634
   target nu stat err =       0.000426798118
   target dn stat err =       0.002411317273
      target stat err =       0.003831635159
              std dev =       0.535171969328
             le_variance =       0.286409036754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286427263349
                                         uncertainty =       0.001573083209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286427263349
                                         uncertainty =       0.001573083209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378423664
  error estimate for blocks of size 2^( 2) =       0.000394012547
  error estimate for blocks of size 2^( 3) =       0.000408724783
  error estimate for blocks of size 2^( 4) =       0.000419211510
  error estimate for blocks of size 2^( 5) =       0.000426039582
  error estimate for blocks of size 2^( 6) =       0.000429592144
  error estimate for blocks of size 2^( 7) =       0.000432346184

      target function =      -0.918593049535
              le_mean =     -17.206269955078
             les_mean =     296.351977981929
             stat err =       0.000426797355
             autocorr =       1.271999281760
   target nu stat err =       0.000426797355
   target dn stat err =       0.002410884118
      target stat err =       0.003831017503
              std dev =       0.535171877708
             le_variance =       0.286408938689


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918593779283        initial  <--
     9.0949e+00     9.0949e+01             3.4174e-05        -0.918579773094
     3.6380e+01     3.6380e+02             8.5460e-06        -0.918587421228
     1.4552e+02     1.4552e+03             2.1367e-06        -0.918593049535

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1888
  </log>
  <optVariables href="H2O.s055.opt.xml">
  uu_0                 2.099554e-01 1 1  ON 0
  uu_1                 5.296366e-02 1 1  ON 1
  uu_2                -3.787667e-02 1 1  ON 2
  uu_3                -9.122636e-02 1 1  ON 3
  uu_4                -1.219397e-01 1 1  ON 4
  uu_5                -1.298121e-01 1 1  ON 5
  uu_6                -1.125630e-01 1 1  ON 6
  uu_7                -5.673179e-02 1 1  ON 7
  uu_8                 5.811568e-02 1 1  ON 8
  uu_9                 1.245063e-01 1 1  ON 9
  ud_0                 3.048895e-01 1 1  ON 10
  ud_1                 7.565361e-02 1 1  ON 11
  ud_2                -2.646812e-02 1 1  ON 12
  ud_3                -7.929722e-02 1 1  ON 13
  ud_4                -1.150067e-01 1 1  ON 14
  ud_5                -1.333237e-01 1 1  ON 15
  ud_6                -1.264020e-01 1 1  ON 16
  ud_7                -8.461485e-02 1 1  ON 17
  ud_8                -6.276329e-03 1 1  ON 18
  ud_9                 8.581903e-02 1 1  ON 19
  eO_0                -7.034795e-01 1 1  ON 20
  eO_1                -4.202478e-01 1 1  ON 21
  eO_2                -4.178959e-02 1 1  ON 22
  eO_3                 1.844432e-01 1 1  ON 23
  eO_4                 2.569101e-01 1 1  ON 24
  eO_5                 2.798569e-01 1 1  ON 25
  eO_6                 2.508623e-01 1 1  ON 26
  eO_7                 1.334787e-01 1 1  ON 27
  eO_8                 2.928496e-02 1 1  ON 28
  eO_9                 1.919927e-02 1 1  ON 29
 eH1_0                -2.017296e-01 1 1  ON 30
 eH1_1                -9.603339e-02 1 1  ON 31
 eH1_2                -4.455536e-02 1 1  ON 32
 eH1_3                -1.423159e-02 1 1  ON 33
 eH1_4                 1.808755e-02 1 1  ON 34
 eH1_5                 2.185290e-02 1 1  ON 35
 eH1_6                 7.088946e-02 1 1  ON 36
 eH1_7                 1.025589e-01 1 1  ON 37
 eH1_8                 1.010528e-01 1 1  ON 38
 eH1_9                 2.608797e-02 1 1  ON 39
 eH2_0                -2.031746e-01 1 1  ON 40
 eH2_1                -9.764259e-02 1 1  ON 41
 eH2_2                -4.626308e-02 1 1  ON 42
 eH2_3                -1.570208e-02 1 1  ON 43
 eH2_4                 1.609454e-02 1 1  ON 44
 eH2_5                 1.954708e-02 1 1  ON 45
 eH2_6                 7.200443e-02 1 1  ON 46
 eH2_7                 1.099222e-01 1 1  ON 47
 eH2_8                 1.035504e-01 1 1  ON 48
 eH2_9                 2.895545e-02 1 1  ON 49
ci_001                -4.165466e-02 3 1  ON 50
ci_002                -3.094180e-02 3 1  ON 51
ci_003                -1.141100e-02 3 1  ON 52
ci_004                 2.557269e-02 3 1  ON 53
ci_005                 2.573472e-02 3 1  ON 54
ci_006                -2.021568e-02 3 1  ON 55
ci_007                -1.979710e-02 3 1  ON 56
ci_008                -4.042621e-03 3 1  ON 57
ci_009                -1.516429e-02 3 1  ON 58
ci_010                -9.520128e-03 3 1  ON 59
ci_011                -9.638016e-03 3 1  ON 60
ci_012                -9.632110e-03 3 1  ON 61
ci_013                -2.167173e-02 3 1  ON 62
ci_014                 1.333306e-02 3 1  ON 63
ci_015                 1.313413e-02 3 1  ON 64
ci_016                 1.627930e-02 3 1  ON 65
ci_017                 1.612529e-02 3 1  ON 66
ci_018                 1.086407e-02 3 1  ON 67
ci_019                 1.051424e-02 3 1  ON 68
ci_020                 1.847339e-02 3 1  ON 69
ci_021                 1.812453e-02 3 1  ON 70
ci_022                 1.026580e-02 3 1  ON 71
ci_023                 1.029006e-02 3 1  ON 72
ci_024                 6.711674e-03 3 1  ON 73
ci_025                 6.510694e-03 3 1  ON 74
ci_026                 1.187562e-02 3 1  ON 75
ci_027                 1.184173e-02 3 1  ON 76
ci_028                -9.172368e-03 3 1  ON 77
ci_029                -9.757716e-03 3 1  ON 78
ci_030                -4.998884e-03 3 1  ON 79
ci_031                -4.672902e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5112e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2438
    reference variance = 0.28273
====================================================
  Execution time = 1.9070e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5425e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9664e-01
  Total weights = 1.973594300e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4727e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288991842048
                                         uncertainty =       0.001595143878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288991842048
                                         uncertainty =       0.001595143878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380142354
  error estimate for blocks of size 2^( 2) =       0.000395447108
  error estimate for blocks of size 2^( 3) =       0.000409472643
  error estimate for blocks of size 2^( 4) =       0.000419622801
  error estimate for blocks of size 2^( 5) =       0.000426428144
  error estimate for blocks of size 2^( 6) =       0.000428915248
  error estimate for blocks of size 2^( 7) =       0.000429763383

      target function =      -0.917986226826
              le_mean =     -17.206218972920
             les_mean =     296.350614961372
             stat err =       0.000426182394
             autocorr =       1.256893527622
   target nu stat err =       0.000426182394
   target dn stat err =       0.002162029377
      target stat err =       0.003445506367
              std dev =       0.537602472632
             le_variance =       0.289016418580


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720621897292e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917998219667       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917998330822       residual = 6.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917998371502       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917998386562       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917998393051       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917998394673       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917998394761       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917998393935       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917998394811       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917998394816       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917998395017       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917998396671       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917998397487       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917998398915       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917998399456       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917998400080       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917998399717       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917998399751       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917998401285       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917998401664       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917998401830       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917998401887       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917998401959       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917998401849       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917998401449       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917998401218       residual = 7.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917998401151       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917998401218       residual = 9.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917998401203       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917998401171       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917998401103       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917998401181       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917998401387       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917998401397       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.0949e+01 is 3.695987e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917998219667       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917998247473       residual = 6.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917998257648       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917998261415       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917998263038       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917998263444       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917998263465       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917998263259       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917998263478       residual = 9.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917998263479       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917998263529       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917998263942       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917998264147       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917998264504       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917998264640       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917998264794       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917998264705       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917998264711       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917998265095       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917998265193       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917998265233       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917998265248       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917998265265       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917998265238       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917998265140       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917998265079       residual = 7.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917998265065       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917998265080       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917998265080       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917998265067       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917998265050       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917998265070       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917998265122       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917998265125       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.6380e+02 is 9.240641e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917998219667       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917998226619       residual = 6.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917998229163       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917998230105       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917998230511       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917998230612       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917998230618       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917998230570       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917998230621       residual = 9.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917998230618       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917998230636       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917998230736       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917998230788       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917998230878       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917998230910       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917998230952       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917998230928       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917998230933       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917998231025       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917998231050       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917998231063       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917998231061       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917998231066       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917998231063       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917998231035       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917998231016       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917998231016       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917998231018       residual = 9.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917998231013       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917998231020       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917998231010       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917998231016       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917998231034       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917998231032       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4552e+03 is 2.310203e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.290769 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4590e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
  uu_0                 2.099553e-01 1 1  ON 0
  uu_1                 5.296359e-02 1 1  ON 1
  uu_2                -3.787661e-02 1 1  ON 2
  uu_3                -9.122627e-02 1 1  ON 3
  uu_4                -1.219396e-01 1 1  ON 4
  uu_5                -1.298118e-01 1 1  ON 5
  uu_6                -1.125627e-01 1 1  ON 6
  uu_7                -5.673194e-02 1 1  ON 7
  uu_8                 5.811475e-02 1 1  ON 8
  uu_9                 1.245063e-01 1 1  ON 9
  ud_0                 3.048893e-01 1 1  ON 10
  ud_1                 7.565340e-02 1 1  ON 11
  ud_2                -2.646820e-02 1 1  ON 12
  ud_3                -7.929724e-02 1 1  ON 13
  ud_4                -1.150067e-01 1 1  ON 14
  ud_5                -1.333238e-01 1 1  ON 15
  ud_6                -1.264019e-01 1 1  ON 16
  ud_7                -8.461430e-02 1 1  ON 17
  ud_8                -6.276527e-03 1 1  ON 18
  ud_9                 8.581879e-02 1 1  ON 19
  eO_0                -7.034794e-01 1 1  ON 20
  eO_1                -4.202478e-01 1 1  ON 21
  eO_2                -4.178976e-02 1 1  ON 22
  eO_3                 1.844431e-01 1 1  ON 23
  eO_4                 2.569100e-01 1 1  ON 24
  eO_5                 2.798564e-01 1 1  ON 25
  eO_6                 2.508621e-01 1 1  ON 26
  eO_7                 1.334794e-01 1 1  ON 27
  eO_8                 2.928501e-02 1 1  ON 28
  eO_9                 1.919933e-02 1 1  ON 29
 eH1_0                -2.017292e-01 1 1  ON 30
 eH1_1                -9.603332e-02 1 1  ON 31
 eH1_2                -4.455524e-02 1 1  ON 32
 eH1_3                -1.423150e-02 1 1  ON 33
 eH1_4                 1.808752e-02 1 1  ON 34
 eH1_5                 2.185266e-02 1 1  ON 35
 eH1_6                 7.088870e-02 1 1  ON 36
 eH1_7                 1.025588e-01 1 1  ON 37
 eH1_8                 1.010533e-01 1 1  ON 38
 eH1_9                 2.608804e-02 1 1  ON 39
 eH2_0                -2.031746e-01 1 1  ON 40
 eH2_1                -9.764258e-02 1 1  ON 41
 eH2_2                -4.626302e-02 1 1  ON 42
 eH2_3                -1.570204e-02 1 1  ON 43
 eH2_4                 1.609460e-02 1 1  ON 44
 eH2_5                 1.954683e-02 1 1  ON 45
 eH2_6                 7.200437e-02 1 1  ON 46
 eH2_7                 1.099220e-01 1 1  ON 47
 eH2_8                 1.035506e-01 1 1  ON 48
 eH2_9                 2.895549e-02 1 1  ON 49
ci_001                -4.165478e-02 3 1  ON 50
ci_002                -3.094183e-02 3 1  ON 51
ci_003                -1.141103e-02 3 1  ON 52
ci_004                 2.557272e-02 3 1  ON 53
ci_005                 2.573466e-02 3 1  ON 54
ci_006                -2.021582e-02 3 1  ON 55
ci_007                -1.979718e-02 3 1  ON 56
ci_008                -4.042827e-03 3 1  ON 57
ci_009                -1.516439e-02 3 1  ON 58
ci_010                -9.520159e-03 3 1  ON 59
ci_011                -9.638260e-03 3 1  ON 60
ci_012                -9.632167e-03 3 1  ON 61
ci_013                -2.167184e-02 3 1  ON 62
ci_014                 1.333309e-02 3 1  ON 63
ci_015                 1.313425e-02 3 1  ON 64
ci_016                 1.627928e-02 3 1  ON 65
ci_017                 1.612526e-02 3 1  ON 66
ci_018                 1.086414e-02 3 1  ON 67
ci_019                 1.051429e-02 3 1  ON 68
ci_020                 1.847339e-02 3 1  ON 69
ci_021                 1.812435e-02 3 1  ON 70
ci_022                 1.026577e-02 3 1  ON 71
ci_023                 1.028996e-02 3 1  ON 72
ci_024                 6.711548e-03 3 1  ON 73
ci_025                 6.510534e-03 3 1  ON 74
ci_026                 1.187547e-02 3 1  ON 75
ci_027                 1.184159e-02 3 1  ON 76
ci_028                -9.172406e-03 3 1  ON 77
ci_029                -9.757912e-03 3 1  ON 78
ci_030                -4.998982e-03 3 1  ON 79
ci_031                -4.672969e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2462
    reference variance = 0.186463
====================================================
  Execution time = 1.8694e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9718e-01
  Total weights = 1.9737e+06
  Execution time = 1.5580e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289259548295
                                         uncertainty =       0.001813409400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289259548295
                                         uncertainty =       0.001813409400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380316283
  error estimate for blocks of size 2^( 2) =       0.000395412301
  error estimate for blocks of size 2^( 3) =       0.000408966185
  error estimate for blocks of size 2^( 4) =       0.000419116831
  error estimate for blocks of size 2^( 5) =       0.000424442204
  error estimate for blocks of size 2^( 6) =       0.000428333354
  error estimate for blocks of size 2^( 7) =       0.000430097136

      target function =      -0.917153434987
              le_mean =     -17.205643392909
             les_mean =     296.331345134134
             stat err =       0.000425497381
             autocorr =       1.251710637853
   target nu stat err =       0.000425497381
   target dn stat err =       0.002517081346
      target stat err =       0.003976545870
              std dev =       0.537848445457
             le_variance =       0.289280950280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289259014002
                                         uncertainty =       0.001813408589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289259014002
                                         uncertainty =       0.001813408589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380315934
  error estimate for blocks of size 2^( 2) =       0.000395411904
  error estimate for blocks of size 2^( 3) =       0.000408965749
  error estimate for blocks of size 2^( 4) =       0.000419116368
  error estimate for blocks of size 2^( 5) =       0.000424441719
  error estimate for blocks of size 2^( 6) =       0.000428332825
  error estimate for blocks of size 2^( 7) =       0.000430096620

      target function =      -0.917153764118
              le_mean =     -17.205643395045
             les_mean =     296.331344994675
             stat err =       0.000425496883
             autocorr =       1.251710001542
   target nu stat err =       0.000425496883
   target dn stat err =       0.002517213638
      target stat err =       0.003976750679
              std dev =       0.537847952371
             le_variance =       0.289280419869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289259280957
                                         uncertainty =       0.001813408989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289259280957
                                         uncertainty =       0.001813408989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380316109
  error estimate for blocks of size 2^( 2) =       0.000395412102
  error estimate for blocks of size 2^( 3) =       0.000408965967
  error estimate for blocks of size 2^( 4) =       0.000419116599
  error estimate for blocks of size 2^( 5) =       0.000424441962
  error estimate for blocks of size 2^( 6) =       0.000428333089
  error estimate for blocks of size 2^( 7) =       0.000430096878

      target function =      -0.917153602618
              le_mean =     -17.205643393974
             les_mean =     296.331345062318
             stat err =       0.000425497132
             autocorr =       1.251710319525
   target nu stat err =       0.000425497132
   target dn stat err =       0.002517147476
      target stat err =       0.003976648275
              std dev =       0.537848198737
             le_variance =       0.289280684884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289259514868
                                         uncertainty =       0.001813409348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289259514868
                                         uncertainty =       0.001813409348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380316261
  error estimate for blocks of size 2^( 2) =       0.000395412276
  error estimate for blocks of size 2^( 3) =       0.000408966157
  error estimate for blocks of size 2^( 4) =       0.000419116802
  error estimate for blocks of size 2^( 5) =       0.000424442174
  error estimate for blocks of size 2^( 6) =       0.000428333321
  error estimate for blocks of size 2^( 7) =       0.000430097103

      target function =      -0.917153456271
              le_mean =     -17.205643393041
             les_mean =     296.331345124929
             stat err =       0.000425497350
             autocorr =       1.251710598057
   target nu stat err =       0.000425497350
   target dn stat err =       0.002517089608
      target stat err =       0.003976558666
              std dev =       0.537848414608
             le_variance =       0.289280917096


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917153434987        initial
     9.0949e+01     9.0949e+02             3.6960e-06        -0.917153764118  <--
     3.6380e+02     3.6380e+03             9.2406e-07        -0.917153602618
     1.4552e+03     1.4552e+04             2.3102e-07        -0.917153456271

*****************************************************************************
Applying the update for shift_i =   9.0949e+01     and shift_s =   9.0949e+02
*****************************************************************************

  Execution time = 2.6566e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
  uu_0                 2.099550e-01 1 1  ON 0
  uu_1                 5.296337e-02 1 1  ON 1
  uu_2                -3.787645e-02 1 1  ON 2
  uu_3                -9.122602e-02 1 1  ON 3
  uu_4                -1.219391e-01 1 1  ON 4
  uu_5                -1.298110e-01 1 1  ON 5
  uu_6                -1.125619e-01 1 1  ON 6
  uu_7                -5.673239e-02 1 1  ON 7
  uu_8                 5.811198e-02 1 1  ON 8
  uu_9                 1.245062e-01 1 1  ON 9
  ud_0                 3.048887e-01 1 1  ON 10
  ud_1                 7.565277e-02 1 1  ON 11
  ud_2                -2.646843e-02 1 1  ON 12
  ud_3                -7.929728e-02 1 1  ON 13
  ud_4                -1.150065e-01 1 1  ON 14
  ud_5                -1.333241e-01 1 1  ON 15
  ud_6                -1.264017e-01 1 1  ON 16
  ud_7                -8.461266e-02 1 1  ON 17
  ud_8                -6.277121e-03 1 1  ON 18
  ud_9                 8.581804e-02 1 1  ON 19
  eO_0                -7.034788e-01 1 1  ON 20
  eO_1                -4.202479e-01 1 1  ON 21
  eO_2                -4.179027e-02 1 1  ON 22
  eO_3                 1.844429e-01 1 1  ON 23
  eO_4                 2.569097e-01 1 1  ON 24
  eO_5                 2.798552e-01 1 1  ON 25
  eO_6                 2.508614e-01 1 1  ON 26
  eO_7                 1.334814e-01 1 1  ON 27
  eO_8                 2.928519e-02 1 1  ON 28
  eO_9                 1.919951e-02 1 1  ON 29
 eH1_0                -2.017282e-01 1 1  ON 30
 eH1_1                -9.603310e-02 1 1  ON 31
 eH1_2                -4.455488e-02 1 1  ON 32
 eH1_3                -1.423123e-02 1 1  ON 33
 eH1_4                 1.808742e-02 1 1  ON 34
 eH1_5                 2.185193e-02 1 1  ON 35
 eH1_6                 7.088640e-02 1 1  ON 36
 eH1_7                 1.025583e-01 1 1  ON 37
 eH1_8                 1.010546e-01 1 1  ON 38
 eH1_9                 2.608824e-02 1 1  ON 39
 eH2_0                -2.031745e-01 1 1  ON 40
 eH2_1                -9.764253e-02 1 1  ON 41
 eH2_2                -4.626287e-02 1 1  ON 42
 eH2_3                -1.570193e-02 1 1  ON 43
 eH2_4                 1.609478e-02 1 1  ON 44
 eH2_5                 1.954608e-02 1 1  ON 45
 eH2_6                 7.200419e-02 1 1  ON 46
 eH2_7                 1.099215e-01 1 1  ON 47
 eH2_8                 1.035514e-01 1 1  ON 48
 eH2_9                 2.895559e-02 1 1  ON 49
ci_001                -4.165513e-02 3 1  ON 50
ci_002                -3.094190e-02 3 1  ON 51
ci_003                -1.141110e-02 3 1  ON 52
ci_004                 2.557279e-02 3 1  ON 53
ci_005                 2.573449e-02 3 1  ON 54
ci_006                -2.021624e-02 3 1  ON 55
ci_007                -1.979743e-02 3 1  ON 56
ci_008                -4.043444e-03 3 1  ON 57
ci_009                -1.516469e-02 3 1  ON 58
ci_010                -9.520253e-03 3 1  ON 59
ci_011                -9.638995e-03 3 1  ON 60
ci_012                -9.632337e-03 3 1  ON 61
ci_013                -2.167217e-02 3 1  ON 62
ci_014                 1.333317e-02 3 1  ON 63
ci_015                 1.313462e-02 3 1  ON 64
ci_016                 1.627921e-02 3 1  ON 65
ci_017                 1.612516e-02 3 1  ON 66
ci_018                 1.086438e-02 3 1  ON 67
ci_019                 1.051446e-02 3 1  ON 68
ci_020                 1.847340e-02 3 1  ON 69
ci_021                 1.812381e-02 3 1  ON 70
ci_022                 1.026568e-02 3 1  ON 71
ci_023                 1.028964e-02 3 1  ON 72
ci_024                 6.711171e-03 3 1  ON 73
ci_025                 6.510055e-03 3 1  ON 74
ci_026                 1.187499e-02 3 1  ON 75
ci_027                 1.184119e-02 3 1  ON 76
ci_028                -9.172518e-03 3 1  ON 77
ci_029                -9.758500e-03 3 1  ON 78
ci_030                -4.999277e-03 3 1  ON 79
ci_031                -4.673170e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1163e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.164
    reference variance = 0.181743
====================================================
  Execution time = 1.9214e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5410e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9898e-01
  Total weights = 1.973723997e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4810e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291246596792
                                         uncertainty =       0.001841036278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291246596792
                                         uncertainty =       0.001841036278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381612497
  error estimate for blocks of size 2^( 2) =       0.000396836698
  error estimate for blocks of size 2^( 3) =       0.000411101966
  error estimate for blocks of size 2^( 4) =       0.000421705088
  error estimate for blocks of size 2^( 5) =       0.000428321688
  error estimate for blocks of size 2^( 6) =       0.000431610463
  error estimate for blocks of size 2^( 7) =       0.000434801209

      target function =      -0.914340958710
              le_mean =     -17.206944464027
             les_mean =     296.377919626605
             stat err =       0.000429109612
             autocorr =       1.264419861116
   target nu stat err =       0.000429109612
   target dn stat err =       0.002344271646
      target stat err =       0.003700595671
              std dev =       0.539681568536
             le_variance =       0.291256195418


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720694446403e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914355087404       residual = 3.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914355809036       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914355940108       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914355971112       residual = 9.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914355979842       residual = 6.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914355997006       residual = 7.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914356012578       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914356044371       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914356074783       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914356097925       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914356104307       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914356107795       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914356106989       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914356113434       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914356112110       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914356119496       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914356123328       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914356122758       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914356124408       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914356129555       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914356133463       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914356134253       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914356134406       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914356134114       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914356132089       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914356133706       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914356134990       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914356134661       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914356133494       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914356133775       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914356134455       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914356134385       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914356134434       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914356133713       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914356133382       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914356133769       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914356133585       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.2737e+01 is 1.405707e-05

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914355087404       residual = 3.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914355268270       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914355301099       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914355308858       residual = 9.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914355311043       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914355315340       residual = 7.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914355319243       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914355327209       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914355334816       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914355340611       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914355342201       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914355343072       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914355342868       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914355344480       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914355344148       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914355345995       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914355346951       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914355346807       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914355347220       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914355348509       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914355349487       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914355349680       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914355349713       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914355349639       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914355349137       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914355349542       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914355349861       residual = 8.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914355349777       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914355349484       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914355349560       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914355349727       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914355349709       residual = 7.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914355349721       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914355349540       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914355349459       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914355349556       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914355349509       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.0949e+01 is 3.518395e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914355087404       residual = 3.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914355132649       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914355140861       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914355142801       residual = 9.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914355143347       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914355144422       residual = 7.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914355145399       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914355147391       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914355149292       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914355150742       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914355151140       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914355151356       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914355151307       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914355151708       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914355151626       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914355152088       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914355152327       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914355152290       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914355152394       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914355152715       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914355152960       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914355153009       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914355153016       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914355152998       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914355152872       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914355152974       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914355153054       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914355153033       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914355152959       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914355152980       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914355153020       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914355153015       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914355153018       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914355152974       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914355152955       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914355152978       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.914355152967       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.6380e+02 is 8.798570e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.344467 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4754e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
  uu_0                 2.099552e-01 1 1  ON 0
  uu_1                 5.296339e-02 1 1  ON 1
  uu_2                -3.787663e-02 1 1  ON 2
  uu_3                -9.122603e-02 1 1  ON 3
  uu_4                -1.219401e-01 1 1  ON 4
  uu_5                -1.298118e-01 1 1  ON 5
  uu_6                -1.125607e-01 1 1  ON 6
  uu_7                -5.673220e-02 1 1  ON 7
  uu_8                 5.810912e-02 1 1  ON 8
  uu_9                 1.245073e-01 1 1  ON 9
  ud_0                 3.048879e-01 1 1  ON 10
  ud_1                 7.565138e-02 1 1  ON 11
  ud_2                -2.646996e-02 1 1  ON 12
  ud_3                -7.929845e-02 1 1  ON 13
  ud_4                -1.150073e-01 1 1  ON 14
  ud_5                -1.333245e-01 1 1  ON 15
  ud_6                -1.264013e-01 1 1  ON 16
  ud_7                -8.461106e-02 1 1  ON 17
  ud_8                -6.274138e-03 1 1  ON 18
  ud_9                 8.581706e-02 1 1  ON 19
  eO_0                -7.034799e-01 1 1  ON 20
  eO_1                -4.202486e-01 1 1  ON 21
  eO_2                -4.179204e-02 1 1  ON 22
  eO_3                 1.844412e-01 1 1  ON 23
  eO_4                 2.569098e-01 1 1  ON 24
  eO_5                 2.798551e-01 1 1  ON 25
  eO_6                 2.508628e-01 1 1  ON 26
  eO_7                 1.334844e-01 1 1  ON 27
  eO_8                 2.928583e-02 1 1  ON 28
  eO_9                 1.919969e-02 1 1  ON 29
 eH1_0                -2.017273e-01 1 1  ON 30
 eH1_1                -9.603278e-02 1 1  ON 31
 eH1_2                -4.455423e-02 1 1  ON 32
 eH1_3                -1.423064e-02 1 1  ON 33
 eH1_4                 1.808751e-02 1 1  ON 34
 eH1_5                 2.184935e-02 1 1  ON 35
 eH1_6                 7.088354e-02 1 1  ON 36
 eH1_7                 1.025589e-01 1 1  ON 37
 eH1_8                 1.010564e-01 1 1  ON 38
 eH1_9                 2.608864e-02 1 1  ON 39
 eH2_0                -2.031770e-01 1 1  ON 40
 eH2_1                -9.764492e-02 1 1  ON 41
 eH2_2                -4.626443e-02 1 1  ON 42
 eH2_3                -1.570248e-02 1 1  ON 43
 eH2_4                 1.609559e-02 1 1  ON 44
 eH2_5                 1.954960e-02 1 1  ON 45
 eH2_6                 7.200572e-02 1 1  ON 46
 eH2_7                 1.099207e-01 1 1  ON 47
 eH2_8                 1.035526e-01 1 1  ON 48
 eH2_9                 2.895601e-02 1 1  ON 49
ci_001                -4.165566e-02 3 1  ON 50
ci_002                -3.094196e-02 3 1  ON 51
ci_003                -1.141071e-02 3 1  ON 52
ci_004                 2.557226e-02 3 1  ON 53
ci_005                 2.573462e-02 3 1  ON 54
ci_006                -2.021577e-02 3 1  ON 55
ci_007                -1.979746e-02 3 1  ON 56
ci_008                -4.043805e-03 3 1  ON 57
ci_009                -1.516474e-02 3 1  ON 58
ci_010                -9.521083e-03 3 1  ON 59
ci_011                -9.639494e-03 3 1  ON 60
ci_012                -9.631761e-03 3 1  ON 61
ci_013                -2.167191e-02 3 1  ON 62
ci_014                 1.333178e-02 3 1  ON 63
ci_015                 1.313455e-02 3 1  ON 64
ci_016                 1.627826e-02 3 1  ON 65
ci_017                 1.612586e-02 3 1  ON 66
ci_018                 1.086495e-02 3 1  ON 67
ci_019                 1.051486e-02 3 1  ON 68
ci_020                 1.847284e-02 3 1  ON 69
ci_021                 1.812322e-02 3 1  ON 70
ci_022                 1.026482e-02 3 1  ON 71
ci_023                 1.028955e-02 3 1  ON 72
ci_024                 6.711663e-03 3 1  ON 73
ci_025                 6.510300e-03 3 1  ON 74
ci_026                 1.187499e-02 3 1  ON 75
ci_027                 1.184053e-02 3 1  ON 76
ci_028                -9.171966e-03 3 1  ON 77
ci_029                -9.759269e-03 3 1  ON 78
ci_030                -4.999505e-03 3 1  ON 79
ci_031                -4.673374e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.1633
    reference variance = 0.248314
====================================================
  Execution time = 1.9359e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9701e-01
  Total weights = 1.9738e+06
  Execution time = 1.5637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290008303058
                                         uncertainty =       0.001801845937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290008303058
                                         uncertainty =       0.001801845937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380803852
  error estimate for blocks of size 2^( 2) =       0.000396099963
  error estimate for blocks of size 2^( 3) =       0.000409757132
  error estimate for blocks of size 2^( 4) =       0.000419565716
  error estimate for blocks of size 2^( 5) =       0.000426378009
  error estimate for blocks of size 2^( 6) =       0.000429959428
  error estimate for blocks of size 2^( 7) =       0.000432892455

      target function =      -0.917410236622
              le_mean =     -17.206340126555
             les_mean =     296.355152497441
             stat err =       0.000427198902
             autocorr =       1.258512662838
   target nu stat err =       0.000427198902
   target dn stat err =       0.002240820464
      target stat err =       0.003562400579
              std dev =       0.538537972011
             le_variance =       0.290023147298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290008840940
                                         uncertainty =       0.001801862895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290008840940
                                         uncertainty =       0.001801862895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380804203
  error estimate for blocks of size 2^( 2) =       0.000396100191
  error estimate for blocks of size 2^( 3) =       0.000409757401
  error estimate for blocks of size 2^( 4) =       0.000419565996
  error estimate for blocks of size 2^( 5) =       0.000426378346
  error estimate for blocks of size 2^( 6) =       0.000429960021
  error estimate for blocks of size 2^( 7) =       0.000432892977

      target function =      -0.917408929021
              le_mean =     -17.206340167666
             les_mean =     296.355154752495
             stat err =       0.000427199335
             autocorr =       1.258512897766
   target nu stat err =       0.000427199335
   target dn stat err =       0.002240746835
      target stat err =       0.003562278842
              std dev =       0.538538468051
             le_variance =       0.290023681571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290008571859
                                         uncertainty =       0.001801854436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290008571859
                                         uncertainty =       0.001801854436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380804027
  error estimate for blocks of size 2^( 2) =       0.000396100077
  error estimate for blocks of size 2^( 3) =       0.000409757266
  error estimate for blocks of size 2^( 4) =       0.000419565856
  error estimate for blocks of size 2^( 5) =       0.000426378177
  error estimate for blocks of size 2^( 6) =       0.000429959724
  error estimate for blocks of size 2^( 7) =       0.000432892716

      target function =      -0.917409607197
              le_mean =     -17.206340147063
             les_mean =     296.355153607693
             stat err =       0.000427199118
             autocorr =       1.258512778945
   target nu stat err =       0.000427199118
   target dn stat err =       0.002240783330
      target stat err =       0.003562339408
              std dev =       0.538538219897
             le_variance =       0.290023414290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290008336595
                                         uncertainty =       0.001801846998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290008336595
                                         uncertainty =       0.001801846998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380803874
  error estimate for blocks of size 2^( 2) =       0.000396099977
  error estimate for blocks of size 2^( 3) =       0.000409757149
  error estimate for blocks of size 2^( 4) =       0.000419565733
  error estimate for blocks of size 2^( 5) =       0.000426378030
  error estimate for blocks of size 2^( 6) =       0.000429959465
  error estimate for blocks of size 2^( 7) =       0.000432892487

      target function =      -0.917410160691
              le_mean =     -17.206340129109
             les_mean =     296.355152634132
             stat err =       0.000427198929
             autocorr =       1.258512677296
   target nu stat err =       0.000427198929
   target dn stat err =       0.002240815791
      target stat err =       0.003562392906
              std dev =       0.538538002938
             le_variance =       0.290023180608


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917410236622        initial  <--
     2.2737e+01     2.2737e+02             1.4057e-05        -0.917408929021
     9.0949e+01     9.0949e+02             3.5184e-06        -0.917409607197
     3.6380e+02     3.6380e+03             8.7986e-07        -0.917410160691

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.2542
  </log>
  <optVariables href="H2O.s057.opt.xml">
  uu_0                 2.099550e-01 1 1  ON 0
  uu_1                 5.296337e-02 1 1  ON 1
  uu_2                -3.787645e-02 1 1  ON 2
  uu_3                -9.122602e-02 1 1  ON 3
  uu_4                -1.219391e-01 1 1  ON 4
  uu_5                -1.298110e-01 1 1  ON 5
  uu_6                -1.125619e-01 1 1  ON 6
  uu_7                -5.673239e-02 1 1  ON 7
  uu_8                 5.811198e-02 1 1  ON 8
  uu_9                 1.245062e-01 1 1  ON 9
  ud_0                 3.048887e-01 1 1  ON 10
  ud_1                 7.565277e-02 1 1  ON 11
  ud_2                -2.646843e-02 1 1  ON 12
  ud_3                -7.929728e-02 1 1  ON 13
  ud_4                -1.150065e-01 1 1  ON 14
  ud_5                -1.333241e-01 1 1  ON 15
  ud_6                -1.264017e-01 1 1  ON 16
  ud_7                -8.461266e-02 1 1  ON 17
  ud_8                -6.277121e-03 1 1  ON 18
  ud_9                 8.581804e-02 1 1  ON 19
  eO_0                -7.034788e-01 1 1  ON 20
  eO_1                -4.202479e-01 1 1  ON 21
  eO_2                -4.179027e-02 1 1  ON 22
  eO_3                 1.844429e-01 1 1  ON 23
  eO_4                 2.569097e-01 1 1  ON 24
  eO_5                 2.798552e-01 1 1  ON 25
  eO_6                 2.508614e-01 1 1  ON 26
  eO_7                 1.334814e-01 1 1  ON 27
  eO_8                 2.928519e-02 1 1  ON 28
  eO_9                 1.919951e-02 1 1  ON 29
 eH1_0                -2.017282e-01 1 1  ON 30
 eH1_1                -9.603310e-02 1 1  ON 31
 eH1_2                -4.455488e-02 1 1  ON 32
 eH1_3                -1.423123e-02 1 1  ON 33
 eH1_4                 1.808742e-02 1 1  ON 34
 eH1_5                 2.185193e-02 1 1  ON 35
 eH1_6                 7.088640e-02 1 1  ON 36
 eH1_7                 1.025583e-01 1 1  ON 37
 eH1_8                 1.010546e-01 1 1  ON 38
 eH1_9                 2.608824e-02 1 1  ON 39
 eH2_0                -2.031745e-01 1 1  ON 40
 eH2_1                -9.764253e-02 1 1  ON 41
 eH2_2                -4.626287e-02 1 1  ON 42
 eH2_3                -1.570193e-02 1 1  ON 43
 eH2_4                 1.609478e-02 1 1  ON 44
 eH2_5                 1.954608e-02 1 1  ON 45
 eH2_6                 7.200419e-02 1 1  ON 46
 eH2_7                 1.099215e-01 1 1  ON 47
 eH2_8                 1.035514e-01 1 1  ON 48
 eH2_9                 2.895559e-02 1 1  ON 49
ci_001                -4.165513e-02 3 1  ON 50
ci_002                -3.094190e-02 3 1  ON 51
ci_003                -1.141110e-02 3 1  ON 52
ci_004                 2.557279e-02 3 1  ON 53
ci_005                 2.573449e-02 3 1  ON 54
ci_006                -2.021624e-02 3 1  ON 55
ci_007                -1.979743e-02 3 1  ON 56
ci_008                -4.043444e-03 3 1  ON 57
ci_009                -1.516469e-02 3 1  ON 58
ci_010                -9.520253e-03 3 1  ON 59
ci_011                -9.638995e-03 3 1  ON 60
ci_012                -9.632337e-03 3 1  ON 61
ci_013                -2.167217e-02 3 1  ON 62
ci_014                 1.333317e-02 3 1  ON 63
ci_015                 1.313462e-02 3 1  ON 64
ci_016                 1.627921e-02 3 1  ON 65
ci_017                 1.612516e-02 3 1  ON 66
ci_018                 1.086438e-02 3 1  ON 67
ci_019                 1.051446e-02 3 1  ON 68
ci_020                 1.847340e-02 3 1  ON 69
ci_021                 1.812381e-02 3 1  ON 70
ci_022                 1.026568e-02 3 1  ON 71
ci_023                 1.028964e-02 3 1  ON 72
ci_024                 6.711171e-03 3 1  ON 73
ci_025                 6.510055e-03 3 1  ON 74
ci_026                 1.187499e-02 3 1  ON 75
ci_027                 1.184119e-02 3 1  ON 76
ci_028                -9.172518e-03 3 1  ON 77
ci_029                -9.758500e-03 3 1  ON 78
ci_030                -4.999277e-03 3 1  ON 79
ci_031                -4.673170e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2015e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.1509
    reference variance = 0.263864
====================================================
  Execution time = 1.8907e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5410e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9485e-01
  Total weights = 1.973847656e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6041e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287427521310
                                         uncertainty =       0.001563957755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287427521310
                                         uncertainty =       0.001563957755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379101687
  error estimate for blocks of size 2^( 2) =       0.000394571074
  error estimate for blocks of size 2^( 3) =       0.000408931518
  error estimate for blocks of size 2^( 4) =       0.000419007982
  error estimate for blocks of size 2^( 5) =       0.000425606795
  error estimate for blocks of size 2^( 6) =       0.000429929389
  error estimate for blocks of size 2^( 7) =       0.000433129885

      target function =      -0.920792000554
              le_mean =     -17.205791931422
             les_mean =     296.334125316105
             stat err =       0.000426918513
             autocorr =       1.268173110784
   target nu stat err =       0.000426918513
   target dn stat err =       0.002267219953
      target stat err =       0.003624942999
              std dev =       0.536130747648
             le_variance =       0.287436178574


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720579193142e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920805127523       residual = 6.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920805231627       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920805255957       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920805265642       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920805267865       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920805267884       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920805268255       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920805268935       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920805268728       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920805269081       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920805269481       residual = 9.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920805269486       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920805270558       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920805271224       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920805270942       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920805271083       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920805270871       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920805270985       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920805271029       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920805271015       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920805271019       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920805270969       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920805270997       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920805271204       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920805271386       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920805271495       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920805271472       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920805271460       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920805271484       residual = 9.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920805271457       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920805271505       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920805271435       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920805271445       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920805271407       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.920805271453       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.920805271480       residual = 6.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.2737e+02 is 1.120951e-06

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920805127523       residual = 6.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920805153555       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920805159639       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920805162061       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920805162617       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920805162621       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920805162714       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920805162885       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920805162834       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920805162921       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920805163022       residual = 9.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920805163022       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920805163290       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920805163456       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920805163385       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920805163424       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920805163368       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920805163396       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920805163408       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920805163404       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920805163408       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920805163392       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920805163398       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920805163455       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920805163498       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920805163529       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920805163517       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920805163517       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920805163521       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920805163513       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920805163531       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920805163508       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920805163514       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920805163504       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.920805163508       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.920805163519       residual = 6.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.0949e+02 is 2.802722e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920805127523       residual = 6.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920805134031       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920805135552       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920805136158       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920805136294       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920805136293       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920805136321       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920805136364       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920805136353       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920805136370       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920805136397       residual = 9.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920805136394       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920805136466       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920805136518       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920805136489       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920805136497       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920805136484       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920805136487       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920805136499       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920805136507       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920805136491       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920805136485       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920805136500       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920805136507       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920805136522       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920805136526       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920805136514       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920805136520       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920805136512       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920805136535       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920805136514       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920805136517       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920805136520       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920805136521       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.920805136532       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.920805136530       residual = 6.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.6380e+03 is 7.007019e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.393329 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4566e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
  uu_0                 2.099549e-01 1 1  ON 0
  uu_1                 5.296326e-02 1 1  ON 1
  uu_2                -3.787655e-02 1 1  ON 2
  uu_3                -9.122607e-02 1 1  ON 3
  uu_4                -1.219390e-01 1 1  ON 4
  uu_5                -1.298109e-01 1 1  ON 5
  uu_6                -1.125618e-01 1 1  ON 6
  uu_7                -5.673215e-02 1 1  ON 7
  uu_8                 5.811171e-02 1 1  ON 8
  uu_9                 1.245062e-01 1 1  ON 9
  ud_0                 3.048888e-01 1 1  ON 10
  ud_1                 7.565278e-02 1 1  ON 11
  ud_2                -2.646836e-02 1 1  ON 12
  ud_3                -7.929720e-02 1 1  ON 13
  ud_4                -1.150065e-01 1 1  ON 14
  ud_5                -1.333241e-01 1 1  ON 15
  ud_6                -1.264019e-01 1 1  ON 16
  ud_7                -8.461271e-02 1 1  ON 17
  ud_8                -6.277234e-03 1 1  ON 18
  ud_9                 8.581794e-02 1 1  ON 19
  eO_0                -7.034789e-01 1 1  ON 20
  eO_1                -4.202480e-01 1 1  ON 21
  eO_2                -4.179040e-02 1 1  ON 22
  eO_3                 1.844429e-01 1 1  ON 23
  eO_4                 2.569098e-01 1 1  ON 24
  eO_5                 2.798551e-01 1 1  ON 25
  eO_6                 2.508615e-01 1 1  ON 26
  eO_7                 1.334816e-01 1 1  ON 27
  eO_8                 2.928522e-02 1 1  ON 28
  eO_9                 1.919953e-02 1 1  ON 29
 eH1_0                -2.017280e-01 1 1  ON 30
 eH1_1                -9.603310e-02 1 1  ON 31
 eH1_2                -4.455489e-02 1 1  ON 32
 eH1_3                -1.423123e-02 1 1  ON 33
 eH1_4                 1.808736e-02 1 1  ON 34
 eH1_5                 2.185165e-02 1 1  ON 35
 eH1_6                 7.088637e-02 1 1  ON 36
 eH1_7                 1.025584e-01 1 1  ON 37
 eH1_8                 1.010548e-01 1 1  ON 38
 eH1_9                 2.608827e-02 1 1  ON 39
 eH2_0                -2.031743e-01 1 1  ON 40
 eH2_1                -9.764254e-02 1 1  ON 41
 eH2_2                -4.626273e-02 1 1  ON 42
 eH2_3                -1.570181e-02 1 1  ON 43
 eH2_4                 1.609477e-02 1 1  ON 44
 eH2_5                 1.954581e-02 1 1  ON 45
 eH2_6                 7.200399e-02 1 1  ON 46
 eH2_7                 1.099214e-01 1 1  ON 47
 eH2_8                 1.035515e-01 1 1  ON 48
 eH2_9                 2.895561e-02 1 1  ON 49
ci_001                -4.165513e-02 3 1  ON 50
ci_002                -3.094189e-02 3 1  ON 51
ci_003                -1.141101e-02 3 1  ON 52
ci_004                 2.557275e-02 3 1  ON 53
ci_005                 2.573451e-02 3 1  ON 54
ci_006                -2.021626e-02 3 1  ON 55
ci_007                -1.979745e-02 3 1  ON 56
ci_008                -4.043477e-03 3 1  ON 57
ci_009                -1.516474e-02 3 1  ON 58
ci_010                -9.520296e-03 3 1  ON 59
ci_011                -9.639059e-03 3 1  ON 60
ci_012                -9.632389e-03 3 1  ON 61
ci_013                -2.167206e-02 3 1  ON 62
ci_014                 1.333315e-02 3 1  ON 63
ci_015                 1.313467e-02 3 1  ON 64
ci_016                 1.627915e-02 3 1  ON 65
ci_017                 1.612520e-02 3 1  ON 66
ci_018                 1.086445e-02 3 1  ON 67
ci_019                 1.051461e-02 3 1  ON 68
ci_020                 1.847335e-02 3 1  ON 69
ci_021                 1.812383e-02 3 1  ON 70
ci_022                 1.026571e-02 3 1  ON 71
ci_023                 1.028962e-02 3 1  ON 72
ci_024                 6.711106e-03 3 1  ON 73
ci_025                 6.510030e-03 3 1  ON 74
ci_026                 1.187500e-02 3 1  ON 75
ci_027                 1.184125e-02 3 1  ON 76
ci_028                -9.172563e-03 3 1  ON 77
ci_029                -9.758455e-03 3 1  ON 78
ci_030                -4.999227e-03 3 1  ON 79
ci_031                -4.673175e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.1435
    reference variance = 0.407287
====================================================
  Execution time = 1.8963e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0293e-01
  Total weights = 1.9735e+06
  Execution time = 1.5668e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292631364936
                                         uncertainty =       0.001911907884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292631364936
                                         uncertainty =       0.001911907884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382573690
  error estimate for blocks of size 2^( 2) =       0.000397610430
  error estimate for blocks of size 2^( 3) =       0.000411296039
  error estimate for blocks of size 2^( 4) =       0.000422126655
  error estimate for blocks of size 2^( 5) =       0.000428111350
  error estimate for blocks of size 2^( 6) =       0.000431294570
  error estimate for blocks of size 2^( 7) =       0.000433469549

      target function =      -0.908245981851
              le_mean =     -17.207183127545
             les_mean =     296.390085318479
             stat err =       0.000428750531
             autocorr =       1.255969639608
   target nu stat err =       0.000428750531
   target dn stat err =       0.003108076413
      target stat err =       0.004803550393
              std dev =       0.541040901280
             le_variance =       0.292725256858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292631383546
                                         uncertainty =       0.001911921808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292631383546
                                         uncertainty =       0.001911921808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382573703
  error estimate for blocks of size 2^( 2) =       0.000397610415
  error estimate for blocks of size 2^( 3) =       0.000411296008
  error estimate for blocks of size 2^( 4) =       0.000422126597
  error estimate for blocks of size 2^( 5) =       0.000428111260
  error estimate for blocks of size 2^( 6) =       0.000431294465
  error estimate for blocks of size 2^( 7) =       0.000433469420

      target function =      -0.908246232591
              le_mean =     -17.207183131339
             les_mean =     296.390085284895
             stat err =       0.000428750435
             autocorr =       1.255968997234
   target nu stat err =       0.000428750435
   target dn stat err =       0.003108074070
      target stat err =       0.004803549486
              std dev =       0.541040919220
             le_variance =       0.292725276271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292631374237
                                         uncertainty =       0.001911914847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292631374237
                                         uncertainty =       0.001911914847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382573697
  error estimate for blocks of size 2^( 2) =       0.000397610422
  error estimate for blocks of size 2^( 3) =       0.000411296023
  error estimate for blocks of size 2^( 4) =       0.000422126626
  error estimate for blocks of size 2^( 5) =       0.000428111305
  error estimate for blocks of size 2^( 6) =       0.000431294518
  error estimate for blocks of size 2^( 7) =       0.000433469484

      target function =      -0.908246107995
              le_mean =     -17.207183129441
             les_mean =     296.390085301160
             stat err =       0.000428750483
             autocorr =       1.255969318340
   target nu stat err =       0.000428750483
   target dn stat err =       0.003108075232
      target stat err =       0.004803549934
              std dev =       0.541040910246
             le_variance =       0.292725266560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292631366097
                                         uncertainty =       0.001911908755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292631366097
                                         uncertainty =       0.001911908755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382573691
  error estimate for blocks of size 2^( 2) =       0.000397610429
  error estimate for blocks of size 2^( 3) =       0.000411296037
  error estimate for blocks of size 2^( 4) =       0.000422126651
  error estimate for blocks of size 2^( 5) =       0.000428111344
  error estimate for blocks of size 2^( 6) =       0.000431294563
  error estimate for blocks of size 2^( 7) =       0.000433469541

      target function =      -0.908245997702
              le_mean =     -17.207183127782
             les_mean =     296.390085316256
             stat err =       0.000428750525
             autocorr =       1.255969599451
   target nu stat err =       0.000428750525
   target dn stat err =       0.003108076264
      target stat err =       0.004803550335
              std dev =       0.541040902400
             le_variance =       0.292725258070


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908245981851        initial
     2.2737e+02     2.2737e+03             1.1210e-06        -0.908246232591  <--
     9.0949e+02     9.0949e+03             2.8027e-07        -0.908246107995
     3.6380e+03     3.6380e+04             7.0070e-08        -0.908245997702

*****************************************************************************
Applying the update for shift_i =   2.2737e+02     and shift_s =   2.2737e+03
*****************************************************************************

  Execution time = 2.7013e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
  uu_0                 2.099547e-01 1 1  ON 0
  uu_1                 5.296291e-02 1 1  ON 1
  uu_2                -3.787685e-02 1 1  ON 2
  uu_3                -9.122622e-02 1 1  ON 3
  uu_4                -1.219390e-01 1 1  ON 4
  uu_5                -1.298107e-01 1 1  ON 5
  uu_6                -1.125615e-01 1 1  ON 6
  uu_7                -5.673144e-02 1 1  ON 7
  uu_8                 5.811090e-02 1 1  ON 8
  uu_9                 1.245063e-01 1 1  ON 9
  ud_0                 3.048891e-01 1 1  ON 10
  ud_1                 7.565282e-02 1 1  ON 11
  ud_2                -2.646814e-02 1 1  ON 12
  ud_3                -7.929698e-02 1 1  ON 13
  ud_4                -1.150063e-01 1 1  ON 14
  ud_5                -1.333241e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.461287e-02 1 1  ON 17
  ud_8                -6.277575e-03 1 1  ON 18
  ud_9                 8.581763e-02 1 1  ON 19
  eO_0                -7.034791e-01 1 1  ON 20
  eO_1                -4.202483e-01 1 1  ON 21
  eO_2                -4.179078e-02 1 1  ON 22
  eO_3                 1.844427e-01 1 1  ON 23
  eO_4                 2.569101e-01 1 1  ON 24
  eO_5                 2.798549e-01 1 1  ON 25
  eO_6                 2.508618e-01 1 1  ON 26
  eO_7                 1.334822e-01 1 1  ON 27
  eO_8                 2.928532e-02 1 1  ON 28
  eO_9                 1.919958e-02 1 1  ON 29
 eH1_0                -2.017276e-01 1 1  ON 30
 eH1_1                -9.603312e-02 1 1  ON 31
 eH1_2                -4.455492e-02 1 1  ON 32
 eH1_3                -1.423122e-02 1 1  ON 33
 eH1_4                 1.808720e-02 1 1  ON 34
 eH1_5                 2.185081e-02 1 1  ON 35
 eH1_6                 7.088626e-02 1 1  ON 36
 eH1_7                 1.025586e-01 1 1  ON 37
 eH1_8                 1.010552e-01 1 1  ON 38
 eH1_9                 2.608834e-02 1 1  ON 39
 eH2_0                -2.031739e-01 1 1  ON 40
 eH2_1                -9.764257e-02 1 1  ON 41
 eH2_2                -4.626233e-02 1 1  ON 42
 eH2_3                -1.570143e-02 1 1  ON 43
 eH2_4                 1.609474e-02 1 1  ON 44
 eH2_5                 1.954499e-02 1 1  ON 45
 eH2_6                 7.200340e-02 1 1  ON 46
 eH2_7                 1.099213e-01 1 1  ON 47
 eH2_8                 1.035518e-01 1 1  ON 48
 eH2_9                 2.895566e-02 1 1  ON 49
ci_001                -4.165511e-02 3 1  ON 50
ci_002                -3.094183e-02 3 1  ON 51
ci_003                -1.141074e-02 3 1  ON 52
ci_004                 2.557265e-02 3 1  ON 53
ci_005                 2.573456e-02 3 1  ON 54
ci_006                -2.021633e-02 3 1  ON 55
ci_007                -1.979753e-02 3 1  ON 56
ci_008                -4.043577e-03 3 1  ON 57
ci_009                -1.516489e-02 3 1  ON 58
ci_010                -9.520426e-03 3 1  ON 59
ci_011                -9.639250e-03 3 1  ON 60
ci_012                -9.632545e-03 3 1  ON 61
ci_013                -2.167173e-02 3 1  ON 62
ci_014                 1.333309e-02 3 1  ON 63
ci_015                 1.313482e-02 3 1  ON 64
ci_016                 1.627897e-02 3 1  ON 65
ci_017                 1.612532e-02 3 1  ON 66
ci_018                 1.086468e-02 3 1  ON 67
ci_019                 1.051506e-02 3 1  ON 68
ci_020                 1.847318e-02 3 1  ON 69
ci_021                 1.812389e-02 3 1  ON 70
ci_022                 1.026580e-02 3 1  ON 71
ci_023                 1.028956e-02 3 1  ON 72
ci_024                 6.710913e-03 3 1  ON 73
ci_025                 6.509957e-03 3 1  ON 74
ci_026                 1.187503e-02 3 1  ON 75
ci_027                 1.184146e-02 3 1  ON 76
ci_028                -9.172699e-03 3 1  ON 77
ci_029                -9.758319e-03 3 1  ON 78
ci_030                -4.999077e-03 3 1  ON 79
ci_031                -4.673190e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1587e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2322
    reference variance = 0.299624
====================================================
  Execution time = 1.9014e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5425e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9848e-01
  Total weights = 1.973723397e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5376e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289600015458
                                         uncertainty =       0.001927875021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289600015458
                                         uncertainty =       0.001927875021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380521875
  error estimate for blocks of size 2^( 2) =       0.000396052896
  error estimate for blocks of size 2^( 3) =       0.000410477218
  error estimate for blocks of size 2^( 4) =       0.000421062739
  error estimate for blocks of size 2^( 5) =       0.000428177350
  error estimate for blocks of size 2^( 6) =       0.000431782401
  error estimate for blocks of size 2^( 7) =       0.000436235804

      target function =      -0.915119114726
              le_mean =     -17.206507982044
             les_mean =     296.362399263499
             stat err =       0.000429314573
             autocorr =       1.272893316352
   target nu stat err =       0.000429314573
   target dn stat err =       0.002654349638
      target stat err =       0.004175978099
              std dev =       0.538139196594
             le_variance =       0.289593794911


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720650798204e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915137081187       residual = 7.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915137659306       residual = 8.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915137739142       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915137780144       residual = 8.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915137790566       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915137803020       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915137803644       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915137804106       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915137807729       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915137806561       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915137807836       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915137811877       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915137814827       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915137815888       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915137816879       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915137814904       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915137816009       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915137818567       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915137819378       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915137821016       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915137820032       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915137820805       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915137819547       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915137819256       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915137820573       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915137821568       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915137821290       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915137821217       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915137821072       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915137821043       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915137821026       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915137821138       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915137821281       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915137821347       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915137821457       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915137821367       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.6843e+01 is 5.348394e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915137081187       residual = 7.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915137225863       residual = 8.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915137245837       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915137256095       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915137258703       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915137261817       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915137261973       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915137262088       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915137262994       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915137262703       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915137263022       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915137264032       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915137264770       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915137265035       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915137265282       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915137264789       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915137265066       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915137265705       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915137265908       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915137266317       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915137266071       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915137266264       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915137265949       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915137265878       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915137266208       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915137266455       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915137266386       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915137266367       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915137266331       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915137266324       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915137266320       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915137266347       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915137266383       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915137266400       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915137266427       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915137266405       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.2737e+02 is 1.337155e-06

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915137081187       residual = 7.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915137117365       residual = 8.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915137122359       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915137124924       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915137125576       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915137126355       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915137126394       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915137126422       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915137126649       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915137126576       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915137126654       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915137126909       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915137127095       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915137127160       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915137127218       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915137127097       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915137127165       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915137127327       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915137127376       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915137127481       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915137127420       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915137127471       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915137127388       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915137127369       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915137127453       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915137127512       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915137127497       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915137127495       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915137127485       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915137127483       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915137127483       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915137127485       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915137127494       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915137127505       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915137127507       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915137127502       residual = 4.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 9.0949e+02 is 3.342922e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.442559 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4607e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
  uu_0                 2.099541e-01 1 1  ON 0
  uu_1                 5.296253e-02 1 1  ON 1
  uu_2                -3.787728e-02 1 1  ON 2
  uu_3                -9.122660e-02 1 1  ON 3
  uu_4                -1.219389e-01 1 1  ON 4
  uu_5                -1.298103e-01 1 1  ON 5
  uu_6                -1.125604e-01 1 1  ON 6
  uu_7                -5.673150e-02 1 1  ON 7
  uu_8                 5.810999e-02 1 1  ON 8
  uu_9                 1.245067e-01 1 1  ON 9
  ud_0                 3.048894e-01 1 1  ON 10
  ud_1                 7.565290e-02 1 1  ON 11
  ud_2                -2.646818e-02 1 1  ON 12
  ud_3                -7.929702e-02 1 1  ON 13
  ud_4                -1.150063e-01 1 1  ON 14
  ud_5                -1.333244e-01 1 1  ON 15
  ud_6                -1.264031e-01 1 1  ON 16
  ud_7                -8.461321e-02 1 1  ON 17
  ud_8                -6.276968e-03 1 1  ON 18
  ud_9                 8.581734e-02 1 1  ON 19
  eO_0                -7.034796e-01 1 1  ON 20
  eO_1                -4.202489e-01 1 1  ON 21
  eO_2                -4.179090e-02 1 1  ON 22
  eO_3                 1.844424e-01 1 1  ON 23
  eO_4                 2.569097e-01 1 1  ON 24
  eO_5                 2.798551e-01 1 1  ON 25
  eO_6                 2.508618e-01 1 1  ON 26
  eO_7                 1.334835e-01 1 1  ON 27
  eO_8                 2.928557e-02 1 1  ON 28
  eO_9                 1.919963e-02 1 1  ON 29
 eH1_0                -2.017286e-01 1 1  ON 30
 eH1_1                -9.603332e-02 1 1  ON 31
 eH1_2                -4.455471e-02 1 1  ON 32
 eH1_3                -1.423078e-02 1 1  ON 33
 eH1_4                 1.808759e-02 1 1  ON 34
 eH1_5                 2.185094e-02 1 1  ON 35
 eH1_6                 7.088620e-02 1 1  ON 36
 eH1_7                 1.025580e-01 1 1  ON 37
 eH1_8                 1.010557e-01 1 1  ON 38
 eH1_9                 2.608854e-02 1 1  ON 39
 eH2_0                -2.031740e-01 1 1  ON 40
 eH2_1                -9.764253e-02 1 1  ON 41
 eH2_2                -4.626192e-02 1 1  ON 42
 eH2_3                -1.570113e-02 1 1  ON 43
 eH2_4                 1.609431e-02 1 1  ON 44
 eH2_5                 1.954408e-02 1 1  ON 45
 eH2_6                 7.200308e-02 1 1  ON 46
 eH2_7                 1.099213e-01 1 1  ON 47
 eH2_8                 1.035525e-01 1 1  ON 48
 eH2_9                 2.895585e-02 1 1  ON 49
ci_001                -4.165550e-02 3 1  ON 50
ci_002                -3.094197e-02 3 1  ON 51
ci_003                -1.141038e-02 3 1  ON 52
ci_004                 2.557257e-02 3 1  ON 53
ci_005                 2.573453e-02 3 1  ON 54
ci_006                -2.021610e-02 3 1  ON 55
ci_007                -1.979779e-02 3 1  ON 56
ci_008                -4.043723e-03 3 1  ON 57
ci_009                -1.516493e-02 3 1  ON 58
ci_010                -9.520088e-03 3 1  ON 59
ci_011                -9.639575e-03 3 1  ON 60
ci_012                -9.632477e-03 3 1  ON 61
ci_013                -2.167166e-02 3 1  ON 62
ci_014                 1.333272e-02 3 1  ON 63
ci_015                 1.313481e-02 3 1  ON 64
ci_016                 1.627902e-02 3 1  ON 65
ci_017                 1.612492e-02 3 1  ON 66
ci_018                 1.086469e-02 3 1  ON 67
ci_019                 1.051477e-02 3 1  ON 68
ci_020                 1.847317e-02 3 1  ON 69
ci_021                 1.812388e-02 3 1  ON 70
ci_022                 1.026630e-02 3 1  ON 71
ci_023                 1.028969e-02 3 1  ON 72
ci_024                 6.710734e-03 3 1  ON 73
ci_025                 6.509790e-03 3 1  ON 74
ci_026                 1.187503e-02 3 1  ON 75
ci_027                 1.184084e-02 3 1  ON 76
ci_028                -9.172451e-03 3 1  ON 77
ci_029                -9.758259e-03 3 1  ON 78
ci_030                -4.998405e-03 3 1  ON 79
ci_031                -4.672758e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.1676
    reference variance = 0.33089
====================================================
  Execution time = 1.9019e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9575e-01
  Total weights = 1.9737e+06
  Execution time = 1.5634e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289371746714
                                         uncertainty =       0.002392437239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289371746714
                                         uncertainty =       0.002392437239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380360423
  error estimate for blocks of size 2^( 2) =       0.000395578426
  error estimate for blocks of size 2^( 3) =       0.000409699830
  error estimate for blocks of size 2^( 4) =       0.000419242999
  error estimate for blocks of size 2^( 5) =       0.000425559219
  error estimate for blocks of size 2^( 6) =       0.000429074917
  error estimate for blocks of size 2^( 7) =       0.000429416366

      target function =      -0.919379662355
              le_mean =     -17.206435462239
             les_mean =     296.357167499149
             stat err =       0.000425823375
             autocorr =       1.253338420274
   target nu stat err =       0.000425823375
   target dn stat err =       0.002546828023
      target stat err =       0.004047263631
              std dev =       0.537910868645
             le_variance =       0.289348102606

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289371948543
                                         uncertainty =       0.002392562046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289371948543
                                         uncertainty =       0.002392562046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380360556
  error estimate for blocks of size 2^( 2) =       0.000395578712
  error estimate for blocks of size 2^( 3) =       0.000409700263
  error estimate for blocks of size 2^( 4) =       0.000419243538
  error estimate for blocks of size 2^( 5) =       0.000425559860
  error estimate for blocks of size 2^( 6) =       0.000429075605
  error estimate for blocks of size 2^( 7) =       0.000429416993

      target function =      -0.919382245418
              le_mean =     -17.206435464028
             les_mean =     296.357165907754
             stat err =       0.000425823999
             autocorr =       1.253341216732
   target nu stat err =       0.000425823999
   target dn stat err =       0.002546918182
      target stat err =       0.004047424907
              std dev =       0.537911056448
             le_variance =       0.289348304649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289371847509
                                         uncertainty =       0.002392499686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289371847509
                                         uncertainty =       0.002392499686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380360489
  error estimate for blocks of size 2^( 2) =       0.000395578569
  error estimate for blocks of size 2^( 3) =       0.000409700046
  error estimate for blocks of size 2^( 4) =       0.000419243268
  error estimate for blocks of size 2^( 5) =       0.000425559540
  error estimate for blocks of size 2^( 6) =       0.000429075261
  error estimate for blocks of size 2^( 7) =       0.000429416680

      target function =      -0.919380959175
              le_mean =     -17.206435463110
             les_mean =     296.357166699285
             stat err =       0.000425823687
             autocorr =       1.253339819865
   target nu stat err =       0.000425823687
   target dn stat err =       0.002546873020
      target stat err =       0.004047344188
              std dev =       0.537910962435
             le_variance =       0.289348203508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289371759289
                                         uncertainty =       0.002392445044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289371759289
                                         uncertainty =       0.002392445044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380360431
  error estimate for blocks of size 2^( 2) =       0.000395578444
  error estimate for blocks of size 2^( 3) =       0.000409699857
  error estimate for blocks of size 2^( 4) =       0.000419243033
  error estimate for blocks of size 2^( 5) =       0.000425559259
  error estimate for blocks of size 2^( 6) =       0.000429074960
  error estimate for blocks of size 2^( 7) =       0.000429416405

      target function =      -0.919379824940
              le_mean =     -17.206435462345
             les_mean =     296.357167398767
             stat err =       0.000425823414
             autocorr =       1.253338595282
   target nu stat err =       0.000425823414
   target dn stat err =       0.002546833635
      target stat err =       0.004047273685
              std dev =       0.537910880346
             le_variance =       0.289348115195


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919379662355        initial
     5.6843e+01     5.6843e+02             5.3484e-06        -0.919382245418  <--
     2.2737e+02     2.2737e+03             1.3372e-06        -0.919380959175
     9.0949e+02     9.0949e+03             3.3429e-07        -0.919379824940

*****************************************************************************
Applying the update for shift_i =   5.6843e+01     and shift_s =   5.6843e+02
*****************************************************************************

  Execution time = 2.6924e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
  uu_0                 2.099523e-01 1 1  ON 0
  uu_1                 5.296139e-02 1 1  ON 1
  uu_2                -3.787855e-02 1 1  ON 2
  uu_3                -9.122777e-02 1 1  ON 3
  uu_4                -1.219388e-01 1 1  ON 4
  uu_5                -1.298089e-01 1 1  ON 5
  uu_6                -1.125571e-01 1 1  ON 6
  uu_7                -5.673167e-02 1 1  ON 7
  uu_8                 5.810728e-02 1 1  ON 8
  uu_9                 1.245080e-01 1 1  ON 9
  ud_0                 3.048901e-01 1 1  ON 10
  ud_1                 7.565313e-02 1 1  ON 11
  ud_2                -2.646831e-02 1 1  ON 12
  ud_3                -7.929712e-02 1 1  ON 13
  ud_4                -1.150062e-01 1 1  ON 14
  ud_5                -1.333254e-01 1 1  ON 15
  ud_6                -1.264052e-01 1 1  ON 16
  ud_7                -8.461424e-02 1 1  ON 17
  ud_8                -6.275149e-03 1 1  ON 18
  ud_9                 8.581649e-02 1 1  ON 19
  eO_0                -7.034811e-01 1 1  ON 20
  eO_1                -4.202506e-01 1 1  ON 21
  eO_2                -4.179125e-02 1 1  ON 22
  eO_3                 1.844415e-01 1 1  ON 23
  eO_4                 2.569085e-01 1 1  ON 24
  eO_5                 2.798557e-01 1 1  ON 25
  eO_6                 2.508619e-01 1 1  ON 26
  eO_7                 1.334876e-01 1 1  ON 27
  eO_8                 2.928632e-02 1 1  ON 28
  eO_9                 1.919980e-02 1 1  ON 29
 eH1_0                -2.017315e-01 1 1  ON 30
 eH1_1                -9.603392e-02 1 1  ON 31
 eH1_2                -4.455408e-02 1 1  ON 32
 eH1_3                -1.422945e-02 1 1  ON 33
 eH1_4                 1.808875e-02 1 1  ON 34
 eH1_5                 2.185133e-02 1 1  ON 35
 eH1_6                 7.088601e-02 1 1  ON 36
 eH1_7                 1.025561e-01 1 1  ON 37
 eH1_8                 1.010570e-01 1 1  ON 38
 eH1_9                 2.608914e-02 1 1  ON 39
 eH2_0                -2.031742e-01 1 1  ON 40
 eH2_1                -9.764242e-02 1 1  ON 41
 eH2_2                -4.626070e-02 1 1  ON 42
 eH2_3                -1.570023e-02 1 1  ON 43
 eH2_4                 1.609302e-02 1 1  ON 44
 eH2_5                 1.954138e-02 1 1  ON 45
 eH2_6                 7.200212e-02 1 1  ON 46
 eH2_7                 1.099214e-01 1 1  ON 47
 eH2_8                 1.035548e-01 1 1  ON 48
 eH2_9                 2.895643e-02 1 1  ON 49
ci_001                -4.165666e-02 3 1  ON 50
ci_002                -3.094237e-02 3 1  ON 51
ci_003                -1.140931e-02 3 1  ON 52
ci_004                 2.557232e-02 3 1  ON 53
ci_005                 2.573442e-02 3 1  ON 54
ci_006                -2.021543e-02 3 1  ON 55
ci_007                -1.979858e-02 3 1  ON 56
ci_008                -4.044160e-03 3 1  ON 57
ci_009                -1.516504e-02 3 1  ON 58
ci_010                -9.519073e-03 3 1  ON 59
ci_011                -9.640548e-03 3 1  ON 60
ci_012                -9.632272e-03 3 1  ON 61
ci_013                -2.167146e-02 3 1  ON 62
ci_014                 1.333161e-02 3 1  ON 63
ci_015                 1.313477e-02 3 1  ON 64
ci_016                 1.627919e-02 3 1  ON 65
ci_017                 1.612371e-02 3 1  ON 66
ci_018                 1.086471e-02 3 1  ON 67
ci_019                 1.051392e-02 3 1  ON 68
ci_020                 1.847311e-02 3 1  ON 69
ci_021                 1.812385e-02 3 1  ON 70
ci_022                 1.026779e-02 3 1  ON 71
ci_023                 1.029007e-02 3 1  ON 72
ci_024                 6.710200e-03 3 1  ON 73
ci_025                 6.509292e-03 3 1  ON 74
ci_026                 1.187503e-02 3 1  ON 75
ci_027                 1.183897e-02 3 1  ON 76
ci_028                -9.171705e-03 3 1  ON 77
ci_029                -9.758077e-03 3 1  ON 78
ci_030                -4.996392e-03 3 1  ON 79
ci_031                -4.671466e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1538e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2012
    reference variance = 0.227641
====================================================
  Execution time = 1.9076e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5434e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9777e-01
  Total weights = 1.973575513e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5515e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290303181471
                                         uncertainty =       0.001734570018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290303181471
                                         uncertainty =       0.001734570018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380960816
  error estimate for blocks of size 2^( 2) =       0.000396540482
  error estimate for blocks of size 2^( 3) =       0.000410607306
  error estimate for blocks of size 2^( 4) =       0.000420857495
  error estimate for blocks of size 2^( 5) =       0.000426705078
  error estimate for blocks of size 2^( 6) =       0.000429619415
  error estimate for blocks of size 2^( 7) =       0.000431807463

      target function =      -0.916238428335
              le_mean =     -17.206008076376
             les_mean =     296.344482799489
             stat err =       0.000427247363
             autocorr =       1.257761114191
   target nu stat err =       0.000427247363
   target dn stat err =       0.002246635193
      target stat err =       0.003560163783
              std dev =       0.538759953332
             le_variance =       0.290262287314


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720600807638e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916251352837       residual = 3.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916252393718       residual = 7.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916252630219       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916252665112       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916252704244       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916252709561       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916252728713       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916252748806       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916252779110       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916252783141       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916252780439       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916252796173       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916252803892       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916252811226       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916252817008       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916252817798       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916252820582       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916252820022       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916252818501       residual = 8.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916252825404       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916252827310       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916252827314       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916252830185       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916252832143       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916252830184       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916252829303       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916252828992       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916252828068       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916252828943       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916252829500       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916252830076       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916252830263       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916252830892       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916252830461       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916252830197       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4211e+01 is 1.980556e-05

solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916251352837       residual = 3.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916251614124       residual = 7.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916251673420       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916251682170       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916251691982       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916251693310       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916251698123       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916251703157       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916251710748       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916251711762       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916251711082       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916251715032       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916251716961       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916251718798       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916251720242       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916251720437       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916251721131       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916251720987       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916251720610       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916251722340       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916251722810       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916251722812       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916251723530       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916251724017       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916251723521       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916251723302       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916251723225       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916251722995       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916251723213       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916251723353       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916251723496       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916251723542       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916251723697       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916251723592       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916251723524       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.6843e+01 is 4.952890e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916251352837       residual = 3.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916251418226       residual = 7.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916251433060       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916251435250       residual = 8.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916251437705       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916251438036       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916251439241       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916251440500       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916251442399       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916251442653       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916251442482       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916251443471       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916251443953       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916251444413       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916251444773       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916251444822       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916251444996       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916251444959       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916251444865       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916251445297       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916251445415       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916251445416       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916251445594       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916251445717       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916251445593       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916251445538       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916251445519       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916251445461       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916251445516       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916251445551       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916251445587       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916251445597       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916251445636       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916251445610       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916251445594       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.2737e+02 is 1.238316e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.488070 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4678e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
  uu_0                 2.099551e-01 1 1  ON 0
  uu_1                 5.296262e-02 1 1  ON 1
  uu_2                -3.787744e-02 1 1  ON 2
  uu_3                -9.122745e-02 1 1  ON 3
  uu_4                -1.219392e-01 1 1  ON 4
  uu_5                -1.298094e-01 1 1  ON 5
  uu_6                -1.125584e-01 1 1  ON 6
  uu_7                -5.673349e-02 1 1  ON 7
  uu_8                 5.810232e-02 1 1  ON 8
  uu_9                 1.245076e-01 1 1  ON 9
  ud_0                 3.048891e-01 1 1  ON 10
  ud_1                 7.565244e-02 1 1  ON 11
  ud_2                -2.646887e-02 1 1  ON 12
  ud_3                -7.929755e-02 1 1  ON 13
  ud_4                -1.150068e-01 1 1  ON 14
  ud_5                -1.333257e-01 1 1  ON 15
  ud_6                -1.264058e-01 1 1  ON 16
  ud_7                -8.461481e-02 1 1  ON 17
  ud_8                -6.272930e-03 1 1  ON 18
  ud_9                 8.581581e-02 1 1  ON 19
  eO_0                -7.034837e-01 1 1  ON 20
  eO_1                -4.202527e-01 1 1  ON 21
  eO_2                -4.179176e-02 1 1  ON 22
  eO_3                 1.844437e-01 1 1  ON 23
  eO_4                 2.569095e-01 1 1  ON 24
  eO_5                 2.798532e-01 1 1  ON 25
  eO_6                 2.508611e-01 1 1  ON 26
  eO_7                 1.334915e-01 1 1  ON 27
  eO_8                 2.928719e-02 1 1  ON 28
  eO_9                 1.919984e-02 1 1  ON 29
 eH1_0                -2.017312e-01 1 1  ON 30
 eH1_1                -9.603436e-02 1 1  ON 31
 eH1_2                -4.455536e-02 1 1  ON 32
 eH1_3                -1.423002e-02 1 1  ON 33
 eH1_4                 1.808724e-02 1 1  ON 34
 eH1_5                 2.185203e-02 1 1  ON 35
 eH1_6                 7.088743e-02 1 1  ON 36
 eH1_7                 1.025550e-01 1 1  ON 37
 eH1_8                 1.010586e-01 1 1  ON 38
 eH1_9                 2.609000e-02 1 1  ON 39
 eH2_0                -2.031747e-01 1 1  ON 40
 eH2_1                -9.764339e-02 1 1  ON 41
 eH2_2                -4.626205e-02 1 1  ON 42
 eH2_3                -1.570189e-02 1 1  ON 43
 eH2_4                 1.609300e-02 1 1  ON 44
 eH2_5                 1.954408e-02 1 1  ON 45
 eH2_6                 7.200214e-02 1 1  ON 46
 eH2_7                 1.099198e-01 1 1  ON 47
 eH2_8                 1.035571e-01 1 1  ON 48
 eH2_9                 2.895703e-02 1 1  ON 49
ci_001                -4.165634e-02 3 1  ON 50
ci_002                -3.094307e-02 3 1  ON 51
ci_003                -1.140759e-02 3 1  ON 52
ci_004                 2.557369e-02 3 1  ON 53
ci_005                 2.573370e-02 3 1  ON 54
ci_006                -2.021497e-02 3 1  ON 55
ci_007                -1.979886e-02 3 1  ON 56
ci_008                -4.045602e-03 3 1  ON 57
ci_009                -1.516605e-02 3 1  ON 58
ci_010                -9.520732e-03 3 1  ON 59
ci_011                -9.639705e-03 3 1  ON 60
ci_012                -9.631762e-03 3 1  ON 61
ci_013                -2.166924e-02 3 1  ON 62
ci_014                 1.333189e-02 3 1  ON 63
ci_015                 1.313461e-02 3 1  ON 64
ci_016                 1.627985e-02 3 1  ON 65
ci_017                 1.612302e-02 3 1  ON 66
ci_018                 1.086453e-02 3 1  ON 67
ci_019                 1.051508e-02 3 1  ON 68
ci_020                 1.847310e-02 3 1  ON 69
ci_021                 1.812314e-02 3 1  ON 70
ci_022                 1.026799e-02 3 1  ON 71
ci_023                 1.028894e-02 3 1  ON 72
ci_024                 6.711075e-03 3 1  ON 73
ci_025                 6.509031e-03 3 1  ON 74
ci_026                 1.187484e-02 3 1  ON 75
ci_027                 1.183907e-02 3 1  ON 76
ci_028                -9.171633e-03 3 1  ON 77
ci_029                -9.757633e-03 3 1  ON 78
ci_030                -4.996625e-03 3 1  ON 79
ci_031                -4.670022e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2237
    reference variance = 0.332929
====================================================
  Execution time = 1.8931e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9722e-01
  Total weights = 1.9736e+06
  Execution time = 1.5599e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290027856166
                                         uncertainty =       0.001683528170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290027856166
                                         uncertainty =       0.001683528170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380772722
  error estimate for blocks of size 2^( 2) =       0.000396088843
  error estimate for blocks of size 2^( 3) =       0.000410092121
  error estimate for blocks of size 2^( 4) =       0.000420515138
  error estimate for blocks of size 2^( 5) =       0.000426954709
  error estimate for blocks of size 2^( 6) =       0.000428284011
  error estimate for blocks of size 2^( 7) =       0.000431789890

      target function =      -0.917085253819
              le_mean =     -17.206184759555
             les_mean =     296.350016729098
             stat err =       0.000426885937
             autocorr =       1.256874858087
   target nu stat err =       0.000426885937
   target dn stat err =       0.002172327563
      target stat err =       0.003454584892
              std dev =       0.538493947645
             le_variance =       0.289975731650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290027759159
                                         uncertainty =       0.001683477178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290027759159
                                         uncertainty =       0.001683477178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380772659
  error estimate for blocks of size 2^( 2) =       0.000396088313
  error estimate for blocks of size 2^( 3) =       0.000410091076
  error estimate for blocks of size 2^( 4) =       0.000420513718
  error estimate for blocks of size 2^( 5) =       0.000426952992
  error estimate for blocks of size 2^( 6) =       0.000428282301
  error estimate for blocks of size 2^( 7) =       0.000431787992

      target function =      -0.917092910121
              le_mean =     -17.206184772872
             les_mean =     296.350012267759
             stat err =       0.000426884251
             autocorr =       1.256865341445
   target nu stat err =       0.000426884251
   target dn stat err =       0.002171733577
      target stat err =       0.003453737627
              std dev =       0.538493859030
             le_variance =       0.289975636213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290027805217
                                         uncertainty =       0.001683502468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290027805217
                                         uncertainty =       0.001683502468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380772689
  error estimate for blocks of size 2^( 2) =       0.000396088576
  error estimate for blocks of size 2^( 3) =       0.000410091595
  error estimate for blocks of size 2^( 4) =       0.000420514424
  error estimate for blocks of size 2^( 5) =       0.000426953847
  error estimate for blocks of size 2^( 6) =       0.000428283152
  error estimate for blocks of size 2^( 7) =       0.000431788937

      target function =      -0.917089239395
              le_mean =     -17.206184766059
             les_mean =     296.350014391897
             stat err =       0.000426885090
             autocorr =       1.256870086969
   target nu stat err =       0.000426885090
   target dn stat err =       0.002172028393
      target stat err =       0.003454159109
              std dev =       0.538493901074
             le_variance =       0.289975681494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290027849528
                                         uncertainty =       0.001683524943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290027849528
                                         uncertainty =       0.001683524943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380772718
  error estimate for blocks of size 2^( 2) =       0.000396088810
  error estimate for blocks of size 2^( 3) =       0.000410092055
  error estimate for blocks of size 2^( 4) =       0.000420515049
  error estimate for blocks of size 2^( 5) =       0.000426954601
  error estimate for blocks of size 2^( 6) =       0.000428283903
  error estimate for blocks of size 2^( 7) =       0.000431789771

      target function =      -0.917085771540
              le_mean =     -17.206184760346
             les_mean =     296.350016423638
             stat err =       0.000426885831
             autocorr =       1.256874261501
   target nu stat err =       0.000426885831
   target dn stat err =       0.002172289999
      target stat err =       0.003454531556
              std dev =       0.538493941574
             le_variance =       0.289975725112


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917085253819        initial
     1.4211e+01     1.4211e+02             1.9806e-05        -0.917092910121  <--
     5.6843e+01     5.6843e+02             4.9529e-06        -0.917089239395
     2.2737e+02     2.2737e+03             1.2383e-06        -0.917085771540

*****************************************************************************
Applying the update for shift_i =   1.4211e+01     and shift_s =   1.4211e+02
*****************************************************************************

  Execution time = 2.6817e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
  uu_0                 2.099635e-01 1 1  ON 0
  uu_1                 5.296632e-02 1 1  ON 1
  uu_2                -3.787411e-02 1 1  ON 2
  uu_3                -9.122648e-02 1 1  ON 3
  uu_4                -1.219405e-01 1 1  ON 4
  uu_5                -1.298108e-01 1 1  ON 5
  uu_6                -1.125621e-01 1 1  ON 6
  uu_7                -5.673895e-02 1 1  ON 7
  uu_8                 5.808747e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048860e-01 1 1  ON 10
  ud_1                 7.565036e-02 1 1  ON 11
  ud_2                -2.647054e-02 1 1  ON 12
  ud_3                -7.929886e-02 1 1  ON 13
  ud_4                -1.150085e-01 1 1  ON 14
  ud_5                -1.333268e-01 1 1  ON 15
  ud_6                -1.264076e-01 1 1  ON 16
  ud_7                -8.461651e-02 1 1  ON 17
  ud_8                -6.266279e-03 1 1  ON 18
  ud_9                 8.581379e-02 1 1  ON 19
  eO_0                -7.034912e-01 1 1  ON 20
  eO_1                -4.202588e-01 1 1  ON 21
  eO_2                -4.179328e-02 1 1  ON 22
  eO_3                 1.844500e-01 1 1  ON 23
  eO_4                 2.569126e-01 1 1  ON 24
  eO_5                 2.798456e-01 1 1  ON 25
  eO_6                 2.508586e-01 1 1  ON 26
  eO_7                 1.335035e-01 1 1  ON 27
  eO_8                 2.928981e-02 1 1  ON 28
  eO_9                 1.919997e-02 1 1  ON 29
 eH1_0                -2.017305e-01 1 1  ON 30
 eH1_1                -9.603568e-02 1 1  ON 31
 eH1_2                -4.455920e-02 1 1  ON 32
 eH1_3                -1.423174e-02 1 1  ON 33
 eH1_4                 1.808272e-02 1 1  ON 34
 eH1_5                 2.185411e-02 1 1  ON 35
 eH1_6                 7.089169e-02 1 1  ON 36
 eH1_7                 1.025516e-01 1 1  ON 37
 eH1_8                 1.010632e-01 1 1  ON 38
 eH1_9                 2.609260e-02 1 1  ON 39
 eH2_0                -2.031762e-01 1 1  ON 40
 eH2_1                -9.764630e-02 1 1  ON 41
 eH2_2                -4.626609e-02 1 1  ON 42
 eH2_3                -1.570684e-02 1 1  ON 43
 eH2_4                 1.609295e-02 1 1  ON 44
 eH2_5                 1.955215e-02 1 1  ON 45
 eH2_6                 7.200223e-02 1 1  ON 46
 eH2_7                 1.099148e-01 1 1  ON 47
 eH2_8                 1.035643e-01 1 1  ON 48
 eH2_9                 2.895885e-02 1 1  ON 49
ci_001                -4.165538e-02 3 1  ON 50
ci_002                -3.094516e-02 3 1  ON 51
ci_003                -1.140245e-02 3 1  ON 52
ci_004                 2.557780e-02 3 1  ON 53
ci_005                 2.573154e-02 3 1  ON 54
ci_006                -2.021359e-02 3 1  ON 55
ci_007                -1.979971e-02 3 1  ON 56
ci_008                -4.049903e-03 3 1  ON 57
ci_009                -1.516906e-02 3 1  ON 58
ci_010                -9.525685e-03 3 1  ON 59
ci_011                -9.637189e-03 3 1  ON 60
ci_012                -9.630239e-03 3 1  ON 61
ci_013                -2.166258e-02 3 1  ON 62
ci_014                 1.333273e-02 3 1  ON 63
ci_015                 1.313414e-02 3 1  ON 64
ci_016                 1.628183e-02 3 1  ON 65
ci_017                 1.612096e-02 3 1  ON 66
ci_018                 1.086399e-02 3 1  ON 67
ci_019                 1.051855e-02 3 1  ON 68
ci_020                 1.847307e-02 3 1  ON 69
ci_021                 1.812102e-02 3 1  ON 70
ci_022                 1.026858e-02 3 1  ON 71
ci_023                 1.028556e-02 3 1  ON 72
ci_024                 6.713690e-03 3 1  ON 73
ci_025                 6.508253e-03 3 1  ON 74
ci_026                 1.187427e-02 3 1  ON 75
ci_027                 1.183937e-02 3 1  ON 76
ci_028                -9.171419e-03 3 1  ON 77
ci_029                -9.756305e-03 3 1  ON 78
ci_030                -4.997319e-03 3 1  ON 79
ci_031                -4.665712e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1502e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.2919
    reference variance = 0.240516
====================================================
  Execution time = 1.9220e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5413e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9907e-01
  Total weights = 1.974076020e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5222e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289221340333
                                         uncertainty =       0.001398785406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289221340333
                                         uncertainty =       0.001398785406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380422141
  error estimate for blocks of size 2^( 2) =       0.000395941247
  error estimate for blocks of size 2^( 3) =       0.000410141114
  error estimate for blocks of size 2^( 4) =       0.000420179933
  error estimate for blocks of size 2^( 5) =       0.000425769179
  error estimate for blocks of size 2^( 6) =       0.000429103353
  error estimate for blocks of size 2^( 7) =       0.000429108783

      target function =      -0.914208797005
              le_mean =     -17.206238126073
             les_mean =     296.353702425112
             stat err =       0.000426040312
             autocorr =       1.254208723914
   target nu stat err =       0.000426040312
   target dn stat err =       0.002839112370
      target stat err =       0.004446277774
              std dev =       0.537998151346
             le_variance =       0.289442010851


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720623812607e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+00, overlap shift 3.5527e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914229651246       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914234363227       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914235909131       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914236131981       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914236235803       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914236261386       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914236314400       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914236343918       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914236357563       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914236302032       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914236373749       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914236402556       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914236402775       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914236422558       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914236417374       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914236424712       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914236438257       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914236443344       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914236442623       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914236452216       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914236453655       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914236461466       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914236467119       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914236491627       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914236493234       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914236498317       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914236502006       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914236498836       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914236498569       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914236499235       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914236498808       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914236501478       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914236504850       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914236505102       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914236508875       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.5527e+00 is 6.759581e-05

solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914229651246       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914230847679       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914231238561       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914231295199       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914231321330       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914231327730       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914231341148       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914231348287       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914231352039       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914231337919       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914231356063       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914231363368       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914231363363       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914231368367       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914231367064       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914231368938       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914231372364       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914231373627       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914231373436       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914231375812       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914231376133       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914231378095       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914231379584       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914231385700       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914231385994       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914231387238       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914231388097       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914231387299       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914231387294       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914231387458       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914231387345       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914231388000       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914231388801       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914231388919       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914231389796       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4211e+01 is 1.695806e-05

solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914229651246       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914229951529       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914230049528       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914230063747       residual = 7.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914230070291       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914230071891       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914230075256       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914230077025       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914230077985       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914230074440       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914230078990       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914230080822       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914230080817       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914230082072       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914230081746       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914230082217       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914230083076       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914230083391       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914230083343       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914230083935       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914230084013       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914230084504       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914230084881       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914230086409       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914230086476       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914230086785       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914230086996       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914230086796       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914230086799       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914230086839       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914230086811       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914230086974       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914230087172       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914230087204       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914230087419       residual = 6.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.6843e+01 is 4.243232e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.534235 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4794e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
  uu_0                 2.099687e-01 1 1  ON 0
  uu_1                 5.296915e-02 1 1  ON 1
  uu_2                -3.786852e-02 1 1  ON 2
  uu_3                -9.121922e-02 1 1  ON 3
  uu_4                -1.219339e-01 1 1  ON 4
  uu_5                -1.298061e-01 1 1  ON 5
  uu_6                -1.125722e-01 1 1  ON 6
  uu_7                -5.675276e-02 1 1  ON 7
  uu_8                 5.807527e-02 1 1  ON 8
  uu_9                 1.245046e-01 1 1  ON 9
  ud_0                 3.048827e-01 1 1  ON 10
  ud_1                 7.564618e-02 1 1  ON 11
  ud_2                -2.647381e-02 1 1  ON 12
  ud_3                -7.930107e-02 1 1  ON 13
  ud_4                -1.150090e-01 1 1  ON 14
  ud_5                -1.333247e-01 1 1  ON 15
  ud_6                -1.264106e-01 1 1  ON 16
  ud_7                -8.461358e-02 1 1  ON 17
  ud_8                -6.261892e-03 1 1  ON 18
  ud_9                 8.580993e-02 1 1  ON 19
  eO_0                -7.034895e-01 1 1  ON 20
  eO_1                -4.202629e-01 1 1  ON 21
  eO_2                -4.179622e-02 1 1  ON 22
  eO_3                 1.844498e-01 1 1  ON 23
  eO_4                 2.569122e-01 1 1  ON 24
  eO_5                 2.798286e-01 1 1  ON 25
  eO_6                 2.508627e-01 1 1  ON 26
  eO_7                 1.335189e-01 1 1  ON 27
  eO_8                 2.929293e-02 1 1  ON 28
  eO_9                 1.920018e-02 1 1  ON 29
 eH1_0                -2.017231e-01 1 1  ON 30
 eH1_1                -9.603292e-02 1 1  ON 31
 eH1_2                -4.456642e-02 1 1  ON 32
 eH1_3                -1.423795e-02 1 1  ON 33
 eH1_4                 1.806935e-02 1 1  ON 34
 eH1_5                 2.184331e-02 1 1  ON 35
 eH1_6                 7.090521e-02 1 1  ON 36
 eH1_7                 1.025555e-01 1 1  ON 37
 eH1_8                 1.010705e-01 1 1  ON 38
 eH1_9                 2.609553e-02 1 1  ON 39
 eH2_0                -2.031718e-01 1 1  ON 40
 eH2_1                -9.763995e-02 1 1  ON 41
 eH2_2                -4.626690e-02 1 1  ON 42
 eH2_3                -1.570717e-02 1 1  ON 43
 eH2_4                 1.608609e-02 1 1  ON 44
 eH2_5                 1.954251e-02 1 1  ON 45
 eH2_6                 7.199900e-02 1 1  ON 46
 eH2_7                 1.099140e-01 1 1  ON 47
 eH2_8                 1.035740e-01 1 1  ON 48
 eH2_9                 2.895947e-02 1 1  ON 49
ci_001                -4.165980e-02 3 1  ON 50
ci_002                -3.094209e-02 3 1  ON 51
ci_003                -1.138883e-02 3 1  ON 52
ci_004                 2.557844e-02 3 1  ON 53
ci_005                 2.572960e-02 3 1  ON 54
ci_006                -2.020950e-02 3 1  ON 55
ci_007                -1.979227e-02 3 1  ON 56
ci_008                -4.053891e-03 3 1  ON 57
ci_009                -1.517153e-02 3 1  ON 58
ci_010                -9.527001e-03 3 1  ON 59
ci_011                -9.636100e-03 3 1  ON 60
ci_012                -9.636028e-03 3 1  ON 61
ci_013                -2.166142e-02 3 1  ON 62
ci_014                 1.334059e-02 3 1  ON 63
ci_015                 1.313112e-02 3 1  ON 64
ci_016                 1.628539e-02 3 1  ON 65
ci_017                 1.612299e-02 3 1  ON 66
ci_018                 1.086248e-02 3 1  ON 67
ci_019                 1.052212e-02 3 1  ON 68
ci_020                 1.847839e-02 3 1  ON 69
ci_021                 1.812199e-02 3 1  ON 70
ci_022                 1.026894e-02 3 1  ON 71
ci_023                 1.028452e-02 3 1  ON 72
ci_024                 6.711710e-03 3 1  ON 73
ci_025                 6.511083e-03 3 1  ON 74
ci_026                 1.187486e-02 3 1  ON 75
ci_027                 1.184133e-02 3 1  ON 76
ci_028                -9.169120e-03 3 1  ON 77
ci_029                -9.760882e-03 3 1  ON 78
ci_030                -4.997257e-03 3 1  ON 79
ci_031                -4.662042e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.2037
    reference variance = 0.189303
====================================================
  Execution time = 2.1275e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0284e-01
  Total weights = 1.9737e+06
  Execution time = 1.6028e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292086163439
                                         uncertainty =       0.001523361058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292086163439
                                         uncertainty =       0.001523361058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382160873
  error estimate for blocks of size 2^( 2) =       0.000397140217
  error estimate for blocks of size 2^( 3) =       0.000411061697
  error estimate for blocks of size 2^( 4) =       0.000421495235
  error estimate for blocks of size 2^( 5) =       0.000427634565
  error estimate for blocks of size 2^( 6) =       0.000430028833
  error estimate for blocks of size 2^( 7) =       0.000433359278

      target function =      -0.908451383829
              le_mean =     -17.207027628748
             les_mean =     296.384583934035
             stat err =       0.000428129478
             autocorr =       1.255040737090
   target nu stat err =       0.000428129478
   target dn stat err =       0.004567997902
      target stat err =       0.007018242521
              std dev =       0.540457088984
             le_variance =       0.292093865033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292086211103
                                         uncertainty =       0.001523744140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292086211103
                                         uncertainty =       0.001523744140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382160948
  error estimate for blocks of size 2^( 2) =       0.000397138532
  error estimate for blocks of size 2^( 3) =       0.000411058453
  error estimate for blocks of size 2^( 4) =       0.000421490703
  error estimate for blocks of size 2^( 5) =       0.000427628502
  error estimate for blocks of size 2^( 6) =       0.000430022870
  error estimate for blocks of size 2^( 7) =       0.000433354803

      target function =      -0.908077623829
              le_mean =     -17.207027789864
             les_mean =     296.384830864971
             stat err =       0.000428124219
             autocorr =       1.255009411718
   target nu stat err =       0.000428124219
   target dn stat err =       0.004778241906
      target stat err =       0.007331966195
              std dev =       0.540457195406
             le_variance =       0.292093980066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292086140817
                                         uncertainty =       0.001523553573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292086140817
                                         uncertainty =       0.001523553573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382160880
  error estimate for blocks of size 2^( 2) =       0.000397139332
  error estimate for blocks of size 2^( 3) =       0.000411060021
  error estimate for blocks of size 2^( 4) =       0.000421492907
  error estimate for blocks of size 2^( 5) =       0.000427631461
  error estimate for blocks of size 2^( 6) =       0.000430025776
  error estimate for blocks of size 2^( 7) =       0.000433356976

      target function =      -0.908267876206
              le_mean =     -17.207027706276
             les_mean =     296.384705099981
             stat err =       0.000428126780
             autocorr =       1.255024869686
   target nu stat err =       0.000428126780
   target dn stat err =       0.004671882851
      target stat err =       0.007173323816
              std dev =       0.540457099637
             le_variance =       0.292093876548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292086155064
                                         uncertainty =       0.001523384999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292086155064
                                         uncertainty =       0.001523384999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382160870
  error estimate for blocks of size 2^( 2) =       0.000397140102
  error estimate for blocks of size 2^( 3) =       0.000411061483
  error estimate for blocks of size 2^( 4) =       0.000421494939
  error estimate for blocks of size 2^( 5) =       0.000427634172
  error estimate for blocks of size 2^( 6) =       0.000430028446
  error estimate for blocks of size 2^( 7) =       0.000433358986

      target function =      -0.908428963363
              le_mean =     -17.207027638034
             les_mean =     296.384598729609
             stat err =       0.000428129136
             autocorr =       1.255038748930
   target nu stat err =       0.000428129136
   target dn stat err =       0.004580759298
      target stat err =       0.007037299656
              std dev =       0.540457085196
             le_variance =       0.292093860939


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908451383829        initial  <--
     3.5527e+00     3.5527e+01             6.7596e-05        -0.908077623829
     1.4211e+01     1.4211e+02             1.6958e-05        -0.908267876206
     5.6843e+01     5.6843e+02             4.2432e-06        -0.908428963363

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2299
  </log>
  <optVariables href="H2O.s061.opt.xml">
  uu_0                 2.099635e-01 1 1  ON 0
  uu_1                 5.296632e-02 1 1  ON 1
  uu_2                -3.787411e-02 1 1  ON 2
  uu_3                -9.122648e-02 1 1  ON 3
  uu_4                -1.219405e-01 1 1  ON 4
  uu_5                -1.298108e-01 1 1  ON 5
  uu_6                -1.125621e-01 1 1  ON 6
  uu_7                -5.673895e-02 1 1  ON 7
  uu_8                 5.808747e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048860e-01 1 1  ON 10
  ud_1                 7.565036e-02 1 1  ON 11
  ud_2                -2.647054e-02 1 1  ON 12
  ud_3                -7.929886e-02 1 1  ON 13
  ud_4                -1.150085e-01 1 1  ON 14
  ud_5                -1.333268e-01 1 1  ON 15
  ud_6                -1.264076e-01 1 1  ON 16
  ud_7                -8.461651e-02 1 1  ON 17
  ud_8                -6.266279e-03 1 1  ON 18
  ud_9                 8.581379e-02 1 1  ON 19
  eO_0                -7.034912e-01 1 1  ON 20
  eO_1                -4.202588e-01 1 1  ON 21
  eO_2                -4.179328e-02 1 1  ON 22
  eO_3                 1.844500e-01 1 1  ON 23
  eO_4                 2.569126e-01 1 1  ON 24
  eO_5                 2.798456e-01 1 1  ON 25
  eO_6                 2.508586e-01 1 1  ON 26
  eO_7                 1.335035e-01 1 1  ON 27
  eO_8                 2.928981e-02 1 1  ON 28
  eO_9                 1.919997e-02 1 1  ON 29
 eH1_0                -2.017305e-01 1 1  ON 30
 eH1_1                -9.603568e-02 1 1  ON 31
 eH1_2                -4.455920e-02 1 1  ON 32
 eH1_3                -1.423174e-02 1 1  ON 33
 eH1_4                 1.808272e-02 1 1  ON 34
 eH1_5                 2.185411e-02 1 1  ON 35
 eH1_6                 7.089169e-02 1 1  ON 36
 eH1_7                 1.025516e-01 1 1  ON 37
 eH1_8                 1.010632e-01 1 1  ON 38
 eH1_9                 2.609260e-02 1 1  ON 39
 eH2_0                -2.031762e-01 1 1  ON 40
 eH2_1                -9.764630e-02 1 1  ON 41
 eH2_2                -4.626609e-02 1 1  ON 42
 eH2_3                -1.570684e-02 1 1  ON 43
 eH2_4                 1.609295e-02 1 1  ON 44
 eH2_5                 1.955215e-02 1 1  ON 45
 eH2_6                 7.200223e-02 1 1  ON 46
 eH2_7                 1.099148e-01 1 1  ON 47
 eH2_8                 1.035643e-01 1 1  ON 48
 eH2_9                 2.895885e-02 1 1  ON 49
ci_001                -4.165538e-02 3 1  ON 50
ci_002                -3.094516e-02 3 1  ON 51
ci_003                -1.140245e-02 3 1  ON 52
ci_004                 2.557780e-02 3 1  ON 53
ci_005                 2.573154e-02 3 1  ON 54
ci_006                -2.021359e-02 3 1  ON 55
ci_007                -1.979971e-02 3 1  ON 56
ci_008                -4.049903e-03 3 1  ON 57
ci_009                -1.516906e-02 3 1  ON 58
ci_010                -9.525685e-03 3 1  ON 59
ci_011                -9.637189e-03 3 1  ON 60
ci_012                -9.630239e-03 3 1  ON 61
ci_013                -2.166258e-02 3 1  ON 62
ci_014                 1.333273e-02 3 1  ON 63
ci_015                 1.313414e-02 3 1  ON 64
ci_016                 1.628183e-02 3 1  ON 65
ci_017                 1.612096e-02 3 1  ON 66
ci_018                 1.086399e-02 3 1  ON 67
ci_019                 1.051855e-02 3 1  ON 68
ci_020                 1.847307e-02 3 1  ON 69
ci_021                 1.812102e-02 3 1  ON 70
ci_022                 1.026858e-02 3 1  ON 71
ci_023                 1.028556e-02 3 1  ON 72
ci_024                 6.713690e-03 3 1  ON 73
ci_025                 6.508253e-03 3 1  ON 74
ci_026                 1.187427e-02 3 1  ON 75
ci_027                 1.183937e-02 3 1  ON 76
ci_028                -9.171419e-03 3 1  ON 77
ci_029                -9.756305e-03 3 1  ON 78
ci_030                -4.997319e-03 3 1  ON 79
ci_031                -4.665712e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4035e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.2198
    reference variance = 0.20429
====================================================
  Execution time = 1.9235e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5409e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0037e-01
  Total weights = 1.973755165e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289946819244
                                         uncertainty =       0.001556270039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289946819244
                                         uncertainty =       0.001556270039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380775941
  error estimate for blocks of size 2^( 2) =       0.000396418817
  error estimate for blocks of size 2^( 3) =       0.000410573282
  error estimate for blocks of size 2^( 4) =       0.000421352979
  error estimate for blocks of size 2^( 5) =       0.000427284076
  error estimate for blocks of size 2^( 6) =       0.000430019212
  error estimate for blocks of size 2^( 7) =       0.000432769300

      target function =      -0.912201187791
              le_mean =     -17.206067992680
             les_mean =     296.349147654588
             stat err =       0.000427856392
             autocorr =       1.262574603664
   target nu stat err =       0.000427856392
   target dn stat err =       0.003294466612
      target stat err =       0.005118474939
              std dev =       0.538498499643
             le_variance =       0.289980634118


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720606799268e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+01, overlap shift 3.5527e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912228891540       residual = 4.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912229522701       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912229711732       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912229726428       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912229735721       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912229738881       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912229744447       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912229755961       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912229758586       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912229768662       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912229774864       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912229774147       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912229782932       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912229784898       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912229786749       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912229788702       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912229789951       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912229793693       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912229794343       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912229798849       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912229798892       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912229795383       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912229795987       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912229795641       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912229796559       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912229798091       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912229797559       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912229797044       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912229797178       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912229797959       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912229798098       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912229798431       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912229798074       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912229797738       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912229797983       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.5527e+01 is 1.141293e-05

solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912228891540       residual = 4.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912229049574       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912229096894       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912229100571       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912229102897       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912229103684       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912229105078       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912229107959       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912229108613       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912229111135       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912229112688       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912229112508       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912229114707       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912229115197       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912229115659       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912229116148       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912229116459       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912229117396       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912229117559       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912229118684       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912229118692       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912229117816       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912229117967       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912229117880       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912229118110       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912229118493       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912229118359       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912229118231       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912229118265       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912229118460       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912229118494       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912229118577       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912229118488       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912229118404       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912229118466       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4211e+02 is 2.855221e-06

solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912228891540       residual = 4.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912228931064       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912228942898       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912228943817       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912228944399       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912228944595       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912228944944       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912228945665       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912228945829       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912228946459       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912228946846       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912228946801       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912228947350       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912228947474       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912228947589       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912228947711       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912228947790       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912228948022       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912228948063       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912228948347       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912228948349       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912228948129       residual = 9.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912228948167       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912228948147       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912228948201       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912228948297       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912228948266       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912228948233       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912228948241       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912228948288       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912228948297       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912228948318       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912228948296       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912228948277       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912228948291       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.6843e+02 is 7.139296e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.592312 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4888e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
  uu_0                 2.099638e-01 1 1  ON 0
  uu_1                 5.296671e-02 1 1  ON 1
  uu_2                -3.787360e-02 1 1  ON 2
  uu_3                -9.122605e-02 1 1  ON 3
  uu_4                -1.219400e-01 1 1  ON 4
  uu_5                -1.298102e-01 1 1  ON 5
  uu_6                -1.125628e-01 1 1  ON 6
  uu_7                -5.673990e-02 1 1  ON 7
  uu_8                 5.808598e-02 1 1  ON 8
  uu_9                 1.245060e-01 1 1  ON 9
  ud_0                 3.048863e-01 1 1  ON 10
  ud_1                 7.565017e-02 1 1  ON 11
  ud_2                -2.647058e-02 1 1  ON 12
  ud_3                -7.929905e-02 1 1  ON 13
  ud_4                -1.150087e-01 1 1  ON 14
  ud_5                -1.333270e-01 1 1  ON 15
  ud_6                -1.264075e-01 1 1  ON 16
  ud_7                -8.461592e-02 1 1  ON 17
  ud_8                -6.266053e-03 1 1  ON 18
  ud_9                 8.581280e-02 1 1  ON 19
  eO_0                -7.034930e-01 1 1  ON 20
  eO_1                -4.202608e-01 1 1  ON 21
  eO_2                -4.179460e-02 1 1  ON 22
  eO_3                 1.844504e-01 1 1  ON 23
  eO_4                 2.569142e-01 1 1  ON 24
  eO_5                 2.798465e-01 1 1  ON 25
  eO_6                 2.508586e-01 1 1  ON 26
  eO_7                 1.335054e-01 1 1  ON 27
  eO_8                 2.929004e-02 1 1  ON 28
  eO_9                 1.919993e-02 1 1  ON 29
 eH1_0                -2.017296e-01 1 1  ON 30
 eH1_1                -9.603570e-02 1 1  ON 31
 eH1_2                -4.455875e-02 1 1  ON 32
 eH1_3                -1.423086e-02 1 1  ON 33
 eH1_4                 1.808213e-02 1 1  ON 34
 eH1_5                 2.185125e-02 1 1  ON 35
 eH1_6                 7.089182e-02 1 1  ON 36
 eH1_7                 1.025517e-01 1 1  ON 37
 eH1_8                 1.010639e-01 1 1  ON 38
 eH1_9                 2.609297e-02 1 1  ON 39
 eH2_0                -2.031770e-01 1 1  ON 40
 eH2_1                -9.764708e-02 1 1  ON 41
 eH2_2                -4.626645e-02 1 1  ON 42
 eH2_3                -1.570730e-02 1 1  ON 43
 eH2_4                 1.609291e-02 1 1  ON 44
 eH2_5                 1.955351e-02 1 1  ON 45
 eH2_6                 7.200315e-02 1 1  ON 46
 eH2_7                 1.099141e-01 1 1  ON 47
 eH2_8                 1.035649e-01 1 1  ON 48
 eH2_9                 2.895909e-02 1 1  ON 49
ci_001                -4.165538e-02 3 1  ON 50
ci_002                -3.094464e-02 3 1  ON 51
ci_003                -1.140219e-02 3 1  ON 52
ci_004                 2.557726e-02 3 1  ON 53
ci_005                 2.573127e-02 3 1  ON 54
ci_006                -2.021298e-02 3 1  ON 55
ci_007                -1.980012e-02 3 1  ON 56
ci_008                -4.049563e-03 3 1  ON 57
ci_009                -1.516967e-02 3 1  ON 58
ci_010                -9.525517e-03 3 1  ON 59
ci_011                -9.637297e-03 3 1  ON 60
ci_012                -9.629172e-03 3 1  ON 61
ci_013                -2.166208e-02 3 1  ON 62
ci_014                 1.333323e-02 3 1  ON 63
ci_015                 1.313455e-02 3 1  ON 64
ci_016                 1.628204e-02 3 1  ON 65
ci_017                 1.612044e-02 3 1  ON 66
ci_018                 1.086381e-02 3 1  ON 67
ci_019                 1.051870e-02 3 1  ON 68
ci_020                 1.847257e-02 3 1  ON 69
ci_021                 1.812105e-02 3 1  ON 70
ci_022                 1.026885e-02 3 1  ON 71
ci_023                 1.028542e-02 3 1  ON 72
ci_024                 6.713824e-03 3 1  ON 73
ci_025                 6.507559e-03 3 1  ON 74
ci_026                 1.187458e-02 3 1  ON 75
ci_027                 1.183962e-02 3 1  ON 76
ci_028                -9.172177e-03 3 1  ON 77
ci_029                -9.756687e-03 3 1  ON 78
ci_030                -4.997141e-03 3 1  ON 79
ci_031                -4.665883e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.2916
    reference variance = 0.331928
====================================================
  Execution time = 1.8932e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0365e-01
  Total weights = 1.9735e+06
  Execution time = 1.5922e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292928829721
                                         uncertainty =       0.002511473538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292928829721
                                         uncertainty =       0.002511473538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382704577
  error estimate for blocks of size 2^( 2) =       0.000398181907
  error estimate for blocks of size 2^( 3) =       0.000411577162
  error estimate for blocks of size 2^( 4) =       0.000421535574
  error estimate for blocks of size 2^( 5) =       0.000427627649
  error estimate for blocks of size 2^( 6) =       0.000429802080
  error estimate for blocks of size 2^( 7) =       0.000433180204

      target function =      -0.907144126542
              le_mean =     -17.205964015527
             les_mean =     296.348852659409
             stat err =       0.000428036377
             autocorr =       1.250932988192
   target nu stat err =       0.000428036377
   target dn stat err =       0.005091193305
      target stat err =       0.007776442438
              std dev =       0.541226003440
             le_variance =       0.292925586799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292929058665
                                         uncertainty =       0.002511797891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292929058665
                                         uncertainty =       0.002511797891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382704725
  error estimate for blocks of size 2^( 2) =       0.000398182081
  error estimate for blocks of size 2^( 3) =       0.000411577352
  error estimate for blocks of size 2^( 4) =       0.000421535702
  error estimate for blocks of size 2^( 5) =       0.000427627794
  error estimate for blocks of size 2^( 6) =       0.000429802270
  error estimate for blocks of size 2^( 7) =       0.000433180347

      target function =      -0.907143970188
              le_mean =     -17.205964041794
             les_mean =     296.348853660992
             stat err =       0.000428036528
             autocorr =       1.250932907508
   target nu stat err =       0.000428036528
   target dn stat err =       0.005091465125
      target stat err =       0.007776851881
              std dev =       0.541226212437
             le_variance =       0.292925813029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292928943754
                                         uncertainty =       0.002511635878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292928943754
                                         uncertainty =       0.002511635878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382704651
  error estimate for blocks of size 2^( 2) =       0.000398181994
  error estimate for blocks of size 2^( 3) =       0.000411577257
  error estimate for blocks of size 2^( 4) =       0.000421535638
  error estimate for blocks of size 2^( 5) =       0.000427627721
  error estimate for blocks of size 2^( 6) =       0.000429802175
  error estimate for blocks of size 2^( 7) =       0.000433180275

      target function =      -0.907144060863
              le_mean =     -17.205964028617
             les_mean =     296.348853150487
             stat err =       0.000428036452
             autocorr =       1.250932948413
   target nu stat err =       0.000428036452
   target dn stat err =       0.005091329169
      target stat err =       0.007776647303
              std dev =       0.541226107532
             le_variance =       0.292925699474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292928843917
                                         uncertainty =       0.002511493832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292928843917
                                         uncertainty =       0.002511493832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382704586
  error estimate for blocks of size 2^( 2) =       0.000398181918
  error estimate for blocks of size 2^( 3) =       0.000411577174
  error estimate for blocks of size 2^( 4) =       0.000421535582
  error estimate for blocks of size 2^( 5) =       0.000427627658
  error estimate for blocks of size 2^( 6) =       0.000429802092
  error estimate for blocks of size 2^( 7) =       0.000433180213

      target function =      -0.907144119691
              le_mean =     -17.205964017157
             les_mean =     296.348852719684
             stat err =       0.000428036386
             autocorr =       1.250932983269
   target nu stat err =       0.000428036386
   target dn stat err =       0.005091210277
      target stat err =       0.007776468054
              std dev =       0.541226016397
             le_variance =       0.292925600825


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.907144126542        initial  <--
     3.5527e+01     3.5527e+02             1.1413e-05        -0.907143970188
     1.4211e+02     1.4211e+03             2.8552e-06        -0.907144060863
     5.6843e+02     5.6843e+03             7.1393e-07        -0.907144119691

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.0331
  </log>
  <optVariables href="H2O.s062.opt.xml">
  uu_0                 2.099635e-01 1 1  ON 0
  uu_1                 5.296632e-02 1 1  ON 1
  uu_2                -3.787411e-02 1 1  ON 2
  uu_3                -9.122648e-02 1 1  ON 3
  uu_4                -1.219405e-01 1 1  ON 4
  uu_5                -1.298108e-01 1 1  ON 5
  uu_6                -1.125621e-01 1 1  ON 6
  uu_7                -5.673895e-02 1 1  ON 7
  uu_8                 5.808747e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048860e-01 1 1  ON 10
  ud_1                 7.565036e-02 1 1  ON 11
  ud_2                -2.647054e-02 1 1  ON 12
  ud_3                -7.929886e-02 1 1  ON 13
  ud_4                -1.150085e-01 1 1  ON 14
  ud_5                -1.333268e-01 1 1  ON 15
  ud_6                -1.264076e-01 1 1  ON 16
  ud_7                -8.461651e-02 1 1  ON 17
  ud_8                -6.266279e-03 1 1  ON 18
  ud_9                 8.581379e-02 1 1  ON 19
  eO_0                -7.034912e-01 1 1  ON 20
  eO_1                -4.202588e-01 1 1  ON 21
  eO_2                -4.179328e-02 1 1  ON 22
  eO_3                 1.844500e-01 1 1  ON 23
  eO_4                 2.569126e-01 1 1  ON 24
  eO_5                 2.798456e-01 1 1  ON 25
  eO_6                 2.508586e-01 1 1  ON 26
  eO_7                 1.335035e-01 1 1  ON 27
  eO_8                 2.928981e-02 1 1  ON 28
  eO_9                 1.919997e-02 1 1  ON 29
 eH1_0                -2.017305e-01 1 1  ON 30
 eH1_1                -9.603568e-02 1 1  ON 31
 eH1_2                -4.455920e-02 1 1  ON 32
 eH1_3                -1.423174e-02 1 1  ON 33
 eH1_4                 1.808272e-02 1 1  ON 34
 eH1_5                 2.185411e-02 1 1  ON 35
 eH1_6                 7.089169e-02 1 1  ON 36
 eH1_7                 1.025516e-01 1 1  ON 37
 eH1_8                 1.010632e-01 1 1  ON 38
 eH1_9                 2.609260e-02 1 1  ON 39
 eH2_0                -2.031762e-01 1 1  ON 40
 eH2_1                -9.764630e-02 1 1  ON 41
 eH2_2                -4.626609e-02 1 1  ON 42
 eH2_3                -1.570684e-02 1 1  ON 43
 eH2_4                 1.609295e-02 1 1  ON 44
 eH2_5                 1.955215e-02 1 1  ON 45
 eH2_6                 7.200223e-02 1 1  ON 46
 eH2_7                 1.099148e-01 1 1  ON 47
 eH2_8                 1.035643e-01 1 1  ON 48
 eH2_9                 2.895885e-02 1 1  ON 49
ci_001                -4.165538e-02 3 1  ON 50
ci_002                -3.094516e-02 3 1  ON 51
ci_003                -1.140245e-02 3 1  ON 52
ci_004                 2.557780e-02 3 1  ON 53
ci_005                 2.573154e-02 3 1  ON 54
ci_006                -2.021359e-02 3 1  ON 55
ci_007                -1.979971e-02 3 1  ON 56
ci_008                -4.049903e-03 3 1  ON 57
ci_009                -1.516906e-02 3 1  ON 58
ci_010                -9.525685e-03 3 1  ON 59
ci_011                -9.637189e-03 3 1  ON 60
ci_012                -9.630239e-03 3 1  ON 61
ci_013                -2.166258e-02 3 1  ON 62
ci_014                 1.333273e-02 3 1  ON 63
ci_015                 1.313414e-02 3 1  ON 64
ci_016                 1.628183e-02 3 1  ON 65
ci_017                 1.612096e-02 3 1  ON 66
ci_018                 1.086399e-02 3 1  ON 67
ci_019                 1.051855e-02 3 1  ON 68
ci_020                 1.847307e-02 3 1  ON 69
ci_021                 1.812102e-02 3 1  ON 70
ci_022                 1.026858e-02 3 1  ON 71
ci_023                 1.028556e-02 3 1  ON 72
ci_024                 6.713690e-03 3 1  ON 73
ci_025                 6.508253e-03 3 1  ON 74
ci_026                 1.187427e-02 3 1  ON 75
ci_027                 1.183937e-02 3 1  ON 76
ci_028                -9.171419e-03 3 1  ON 77
ci_029                -9.756305e-03 3 1  ON 78
ci_030                -4.997319e-03 3 1  ON 79
ci_031                -4.665712e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1940e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.2593
    reference variance = 0.273801
====================================================
  Execution time = 1.9111e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5427e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0488e-01
  Total weights = 1.973745414e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5494e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293516704535
                                         uncertainty =       0.001993378191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293516704535
                                         uncertainty =       0.001993378191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383333904
  error estimate for blocks of size 2^( 2) =       0.000398377222
  error estimate for blocks of size 2^( 3) =       0.000412477447
  error estimate for blocks of size 2^( 4) =       0.000422945287
  error estimate for blocks of size 2^( 5) =       0.000429423721
  error estimate for blocks of size 2^( 6) =       0.000431863184
  error estimate for blocks of size 2^( 7) =       0.000432608935

      target function =      -0.905316872210
              le_mean =     -17.206171769460
             les_mean =     296.357224322239
             stat err =       0.000429210281
             autocorr =       1.253677320345
   target nu stat err =       0.000429210281
   target dn stat err =       0.003487277362
      target stat err =       0.005332931449
              std dev =       0.542116005741
             le_variance =       0.293889763681


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720617176946e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+02, overlap shift 3.5527e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905347280460       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905347338626       residual = 9.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905347350408       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905347354998       residual = 6.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905347355621       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905347356500       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905347357541       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905347359379       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905347359359       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905347359470       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905347359552       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.905347359887       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.905347359612       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.905347359928       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.905347360162       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.905347360162       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.905347359997       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.905347360437       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.905347360678       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.905347360852       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.905347361089       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.905347361056       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.905347360918       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.905347360905       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.905347361031       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.905347361176       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.905347361130       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.905347361107       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.905347361087       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.905347361069       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.905347361044       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.905347361042       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.905347361086       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.905347361098       residual = 7.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.5527e+02 is 1.351913e-06

solving harmonic davidson linear method for identity shift 1.4211e+03, overlap shift 1.4211e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905347280460       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905347295004       residual = 9.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905347297950       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905347299097       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905347299253       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905347299472       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905347299736       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905347300195       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905347300188       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905347300215       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905347300238       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.905347300320       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.905347300249       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.905347300332       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.905347300388       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.905347300391       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.905347300346       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.905347300462       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.905347300515       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.905347300559       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.905347300622       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.905347300615       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.905347300570       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.905347300570       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.905347300602       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.905347300638       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.905347300626       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.905347300628       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.905347300620       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.905347300615       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.905347300608       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.905347300603       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.905347300620       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.905347300624       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4211e+03 is 3.379863e-07

solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905347280460       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905347284096       residual = 9.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905347284833       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905347285120       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905347285157       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905347285219       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905347285276       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905347285394       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905347285389       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905347285398       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905347285418       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.905347285420       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.905347285431       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.905347285425       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.905347285452       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.905347285441       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.905347285429       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.905347285455       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.905347285487       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.905347285492       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.905347285513       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.905347285469       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.905347285497       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.905347285491       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.905347285511       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.905347285499       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.905347285495       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.905347285478       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.905347285488       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.905347285497       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.905347285514       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.905347285498       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.905347285491       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.905347285509       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.6843e+03 is 8.449706e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.645653 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4723e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
  uu_0                 2.099635e-01 1 1  ON 0
  uu_1                 5.296635e-02 1 1  ON 1
  uu_2                -3.787409e-02 1 1  ON 2
  uu_3                -9.122647e-02 1 1  ON 3
  uu_4                -1.219404e-01 1 1  ON 4
  uu_5                -1.298108e-01 1 1  ON 5
  uu_6                -1.125620e-01 1 1  ON 6
  uu_7                -5.673894e-02 1 1  ON 7
  uu_8                 5.808713e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048860e-01 1 1  ON 10
  ud_1                 7.565035e-02 1 1  ON 11
  ud_2                -2.647053e-02 1 1  ON 12
  ud_3                -7.929886e-02 1 1  ON 13
  ud_4                -1.150085e-01 1 1  ON 14
  ud_5                -1.333268e-01 1 1  ON 15
  ud_6                -1.264075e-01 1 1  ON 16
  ud_7                -8.461657e-02 1 1  ON 17
  ud_8                -6.266386e-03 1 1  ON 18
  ud_9                 8.581372e-02 1 1  ON 19
  eO_0                -7.034913e-01 1 1  ON 20
  eO_1                -4.202589e-01 1 1  ON 21
  eO_2                -4.179330e-02 1 1  ON 22
  eO_3                 1.844501e-01 1 1  ON 23
  eO_4                 2.569126e-01 1 1  ON 24
  eO_5                 2.798455e-01 1 1  ON 25
  eO_6                 2.508587e-01 1 1  ON 26
  eO_7                 1.335036e-01 1 1  ON 27
  eO_8                 2.928981e-02 1 1  ON 28
  eO_9                 1.919997e-02 1 1  ON 29
 eH1_0                -2.017304e-01 1 1  ON 30
 eH1_1                -9.603553e-02 1 1  ON 31
 eH1_2                -4.455913e-02 1 1  ON 32
 eH1_3                -1.423173e-02 1 1  ON 33
 eH1_4                 1.808264e-02 1 1  ON 34
 eH1_5                 2.185379e-02 1 1  ON 35
 eH1_6                 7.089164e-02 1 1  ON 36
 eH1_7                 1.025517e-01 1 1  ON 37
 eH1_8                 1.010632e-01 1 1  ON 38
 eH1_9                 2.609262e-02 1 1  ON 39
 eH2_0                -2.031763e-01 1 1  ON 40
 eH2_1                -9.764641e-02 1 1  ON 41
 eH2_2                -4.626612e-02 1 1  ON 42
 eH2_3                -1.570687e-02 1 1  ON 43
 eH2_4                 1.609290e-02 1 1  ON 44
 eH2_5                 1.955222e-02 1 1  ON 45
 eH2_6                 7.200239e-02 1 1  ON 46
 eH2_7                 1.099149e-01 1 1  ON 47
 eH2_8                 1.035643e-01 1 1  ON 48
 eH2_9                 2.895886e-02 1 1  ON 49
ci_001                -4.165535e-02 3 1  ON 50
ci_002                -3.094519e-02 3 1  ON 51
ci_003                -1.140251e-02 3 1  ON 52
ci_004                 2.557782e-02 3 1  ON 53
ci_005                 2.573150e-02 3 1  ON 54
ci_006                -2.021349e-02 3 1  ON 55
ci_007                -1.979979e-02 3 1  ON 56
ci_008                -4.049903e-03 3 1  ON 57
ci_009                -1.516910e-02 3 1  ON 58
ci_010                -9.525687e-03 3 1  ON 59
ci_011                -9.637230e-03 3 1  ON 60
ci_012                -9.630242e-03 3 1  ON 61
ci_013                -2.166262e-02 3 1  ON 62
ci_014                 1.333274e-02 3 1  ON 63
ci_015                 1.313407e-02 3 1  ON 64
ci_016                 1.628184e-02 3 1  ON 65
ci_017                 1.612095e-02 3 1  ON 66
ci_018                 1.086397e-02 3 1  ON 67
ci_019                 1.051855e-02 3 1  ON 68
ci_020                 1.847303e-02 3 1  ON 69
ci_021                 1.812105e-02 3 1  ON 70
ci_022                 1.026854e-02 3 1  ON 71
ci_023                 1.028558e-02 3 1  ON 72
ci_024                 6.713602e-03 3 1  ON 73
ci_025                 6.508263e-03 3 1  ON 74
ci_026                 1.187420e-02 3 1  ON 75
ci_027                 1.183937e-02 3 1  ON 76
ci_028                -9.171475e-03 3 1  ON 77
ci_029                -9.756316e-03 3 1  ON 78
ci_030                -4.997278e-03 3 1  ON 79
ci_031                -4.665705e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.2435
    reference variance = 0.247243
====================================================
  Execution time = 1.9006e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9872e-01
  Total weights = 1.9738e+06
  Execution time = 1.5994e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289774534725
                                         uncertainty =       0.001770982868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289774534725
                                         uncertainty =       0.001770982868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380613869
  error estimate for blocks of size 2^( 2) =       0.000395988970
  error estimate for blocks of size 2^( 3) =       0.000410454028
  error estimate for blocks of size 2^( 4) =       0.000420762256
  error estimate for blocks of size 2^( 5) =       0.000426173914
  error estimate for blocks of size 2^( 6) =       0.000429545893
  error estimate for blocks of size 2^( 7) =       0.000431381168

      target function =      -0.914764133019
              le_mean =     -17.206200974278
             les_mean =     296.352069556428
             stat err =       0.000426965807
             autocorr =       1.258394975907
   target nu stat err =       0.000426965807
   target dn stat err =       0.002360373051
      target stat err =       0.003722589897
              std dev =       0.538269295407
             le_variance =       0.289733834378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289774567864
                                         uncertainty =       0.001770986926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289774567864
                                         uncertainty =       0.001770986926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380613891
  error estimate for blocks of size 2^( 2) =       0.000395988999
  error estimate for blocks of size 2^( 3) =       0.000410454068
  error estimate for blocks of size 2^( 4) =       0.000420762299
  error estimate for blocks of size 2^( 5) =       0.000426173963
  error estimate for blocks of size 2^( 6) =       0.000429545955
  error estimate for blocks of size 2^( 7) =       0.000431381227

      target function =      -0.914764284409
              le_mean =     -17.206200972035
             les_mean =     296.352069381469
             stat err =       0.000426965861
             autocorr =       1.258395147430
   target nu stat err =       0.000426965861
   target dn stat err =       0.002360365244
      target stat err =       0.003722579257
              std dev =       0.538269326238
             le_variance =       0.289733867568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289774551293
                                         uncertainty =       0.001770984898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289774551293
                                         uncertainty =       0.001770984898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380613880
  error estimate for blocks of size 2^( 2) =       0.000395988985
  error estimate for blocks of size 2^( 3) =       0.000410454048
  error estimate for blocks of size 2^( 4) =       0.000420762277
  error estimate for blocks of size 2^( 5) =       0.000426173938
  error estimate for blocks of size 2^( 6) =       0.000429545924
  error estimate for blocks of size 2^( 7) =       0.000431381197

      target function =      -0.914764208852
              le_mean =     -17.206200973156
             les_mean =     296.352069468833
             stat err =       0.000426965834
             autocorr =       1.258395061677
   target nu stat err =       0.000426965834
   target dn stat err =       0.002360369141
      target stat err =       0.003722584568
              std dev =       0.538269310821
             le_variance =       0.289733850972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289774536795
                                         uncertainty =       0.001770983122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289774536795
                                         uncertainty =       0.001770983122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380613870
  error estimate for blocks of size 2^( 2) =       0.000395988972
  error estimate for blocks of size 2^( 3) =       0.000410454031
  error estimate for blocks of size 2^( 4) =       0.000420762258
  error estimate for blocks of size 2^( 5) =       0.000426173917
  error estimate for blocks of size 2^( 6) =       0.000429545897
  error estimate for blocks of size 2^( 7) =       0.000431381171

      target function =      -0.914764142512
              le_mean =     -17.206200974138
             les_mean =     296.352069545467
             stat err =       0.000426965811
             autocorr =       1.258394986632
   target nu stat err =       0.000426965811
   target dn stat err =       0.002360372562
      target stat err =       0.003722589230
              std dev =       0.538269297333
             le_variance =       0.289733836452


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914764133019        initial
     3.5527e+02     3.5527e+03             1.3519e-06        -0.914764284409  <--
     1.4211e+03     1.4211e+04             3.3799e-07        -0.914764208852
     5.6843e+03     5.6843e+04             8.4497e-08        -0.914764142512

*****************************************************************************
Applying the update for shift_i =   3.5527e+02     and shift_s =   3.5527e+03
*****************************************************************************

  Execution time = 2.6919e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
  uu_0                 2.099636e-01 1 1  ON 0
  uu_1                 5.296644e-02 1 1  ON 1
  uu_2                -3.787404e-02 1 1  ON 2
  uu_3                -9.122642e-02 1 1  ON 3
  uu_4                -1.219403e-01 1 1  ON 4
  uu_5                -1.298106e-01 1 1  ON 5
  uu_6                -1.125619e-01 1 1  ON 6
  uu_7                -5.673892e-02 1 1  ON 7
  uu_8                 5.808612e-02 1 1  ON 8
  uu_9                 1.245063e-01 1 1  ON 9
  ud_0                 3.048860e-01 1 1  ON 10
  ud_1                 7.565034e-02 1 1  ON 11
  ud_2                -2.647049e-02 1 1  ON 12
  ud_3                -7.929887e-02 1 1  ON 13
  ud_4                -1.150086e-01 1 1  ON 14
  ud_5                -1.333267e-01 1 1  ON 15
  ud_6                -1.264072e-01 1 1  ON 16
  ud_7                -8.461674e-02 1 1  ON 17
  ud_8                -6.266705e-03 1 1  ON 18
  ud_9                 8.581349e-02 1 1  ON 19
  eO_0                -7.034914e-01 1 1  ON 20
  eO_1                -4.202591e-01 1 1  ON 21
  eO_2                -4.179336e-02 1 1  ON 22
  eO_3                 1.844502e-01 1 1  ON 23
  eO_4                 2.569125e-01 1 1  ON 24
  eO_5                 2.798454e-01 1 1  ON 25
  eO_6                 2.508587e-01 1 1  ON 26
  eO_7                 1.335040e-01 1 1  ON 27
  eO_8                 2.928980e-02 1 1  ON 28
  eO_9                 1.919997e-02 1 1  ON 29
 eH1_0                -2.017300e-01 1 1  ON 30
 eH1_1                -9.603508e-02 1 1  ON 31
 eH1_2                -4.455890e-02 1 1  ON 32
 eH1_3                -1.423170e-02 1 1  ON 33
 eH1_4                 1.808242e-02 1 1  ON 34
 eH1_5                 2.185283e-02 1 1  ON 35
 eH1_6                 7.089149e-02 1 1  ON 36
 eH1_7                 1.025517e-01 1 1  ON 37
 eH1_8                 1.010633e-01 1 1  ON 38
 eH1_9                 2.609268e-02 1 1  ON 39
 eH2_0                -2.031766e-01 1 1  ON 40
 eH2_1                -9.764673e-02 1 1  ON 41
 eH2_2                -4.626622e-02 1 1  ON 42
 eH2_3                -1.570698e-02 1 1  ON 43
 eH2_4                 1.609275e-02 1 1  ON 44
 eH2_5                 1.955242e-02 1 1  ON 45
 eH2_6                 7.200286e-02 1 1  ON 46
 eH2_7                 1.099150e-01 1 1  ON 47
 eH2_8                 1.035644e-01 1 1  ON 48
 eH2_9                 2.895890e-02 1 1  ON 49
ci_001                -4.165527e-02 3 1  ON 50
ci_002                -3.094528e-02 3 1  ON 51
ci_003                -1.140269e-02 3 1  ON 52
ci_004                 2.557788e-02 3 1  ON 53
ci_005                 2.573138e-02 3 1  ON 54
ci_006                -2.021317e-02 3 1  ON 55
ci_007                -1.980003e-02 3 1  ON 56
ci_008                -4.049902e-03 3 1  ON 57
ci_009                -1.516923e-02 3 1  ON 58
ci_010                -9.525690e-03 3 1  ON 59
ci_011                -9.637351e-03 3 1  ON 60
ci_012                -9.630253e-03 3 1  ON 61
ci_013                -2.166273e-02 3 1  ON 62
ci_014                 1.333276e-02 3 1  ON 63
ci_015                 1.313387e-02 3 1  ON 64
ci_016                 1.628187e-02 3 1  ON 65
ci_017                 1.612095e-02 3 1  ON 66
ci_018                 1.086391e-02 3 1  ON 67
ci_019                 1.051855e-02 3 1  ON 68
ci_020                 1.847291e-02 3 1  ON 69
ci_021                 1.812112e-02 3 1  ON 70
ci_022                 1.026841e-02 3 1  ON 71
ci_023                 1.028565e-02 3 1  ON 72
ci_024                 6.713337e-03 3 1  ON 73
ci_025                 6.508292e-03 3 1  ON 74
ci_026                 1.187399e-02 3 1  ON 75
ci_027                 1.183937e-02 3 1  ON 76
ci_028                -9.171644e-03 3 1  ON 77
ci_029                -9.756347e-03 3 1  ON 78
ci_030                -4.997153e-03 3 1  ON 79
ci_031                -4.665684e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1661e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.1616
    reference variance = 0.216805
====================================================
  Execution time = 1.8981e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5397e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9762e-01
  Total weights = 1.973711164e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5543e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290153988965
                                         uncertainty =       0.001655547352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290153988965
                                         uncertainty =       0.001655547352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380847993
  error estimate for blocks of size 2^( 2) =       0.000396356652
  error estimate for blocks of size 2^( 3) =       0.000410174970
  error estimate for blocks of size 2^( 4) =       0.000420604613
  error estimate for blocks of size 2^( 5) =       0.000426695164
  error estimate for blocks of size 2^( 6) =       0.000429701956
  error estimate for blocks of size 2^( 7) =       0.000430014679

      target function =      -0.916469925181
              le_mean =     -17.206394742000
             les_mean =     296.357637225890
             stat err =       0.000426754103
             autocorr =       1.255602201934
   target nu stat err =       0.000426754103
   target dn stat err =       0.002109350672
      target stat err =       0.003355744503
              std dev =       0.538600396662
             le_variance =       0.290090387285


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720639474200e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+01, overlap shift 8.8818e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916481100147       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916481190776       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916481226825       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916481231893       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916481237487       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916481239999       residual = 5.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916481242175       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916481245489       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916481245771       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916481245463       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916481248902       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916481249117       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916481249723       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916481248980       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916481251046       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916481251501       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916481251638       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916481253094       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916481252717       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916481252605       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916481252909       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916481253112       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916481253806       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916481253244       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916481253420       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916481253291       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916481253501       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916481253349       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916481253363       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916481253646       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916481253709       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916481253724       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916481253680       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916481253613       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916481253660       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916481253607       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.8818e+01 is 4.354684e-06

solving harmonic davidson linear method for identity shift 3.5527e+02, overlap shift 3.5527e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916481100147       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916481122818       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916481131836       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916481133103       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916481134502       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916481135131       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916481135677       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916481136504       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916481136573       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916481136497       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916481137357       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916481137411       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916481137562       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916481137376       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916481137892       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916481138007       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916481138041       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916481138406       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916481138311       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916481138282       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916481138358       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916481138409       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916481138584       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916481138441       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916481138486       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916481138452       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916481138506       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916481138467       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916481138470       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916481138544       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916481138559       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916481138563       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916481138550       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916481138533       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916481138546       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916481138532       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.5527e+02 is 1.088820e-06

solving harmonic davidson linear method for identity shift 1.4211e+03, overlap shift 1.4211e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916481100147       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916481105816       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916481108071       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916481108387       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916481108737       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916481108896       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916481109030       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916481109239       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916481109253       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916481109236       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916481109449       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916481109462       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916481109498       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916481109454       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916481109584       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916481109613       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916481109621       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916481109716       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916481109689       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916481109682       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916481109702       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916481109714       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916481109752       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916481109720       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916481109731       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916481109725       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916481109734       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916481109726       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916481109730       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916481109750       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916481109747       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916481109750       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916481109750       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916481109747       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916481109750       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916481109744       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.4211e+03 is 2.722143e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.707204 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4606e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
  uu_0                 2.099636e-01 1 1  ON 0
  uu_1                 5.296653e-02 1 1  ON 1
  uu_2                -3.787404e-02 1 1  ON 2
  uu_3                -9.122638e-02 1 1  ON 3
  uu_4                -1.219404e-01 1 1  ON 4
  uu_5                -1.298108e-01 1 1  ON 5
  uu_6                -1.125621e-01 1 1  ON 6
  uu_7                -5.673847e-02 1 1  ON 7
  uu_8                 5.808581e-02 1 1  ON 8
  uu_9                 1.245062e-01 1 1  ON 9
  ud_0                 3.048857e-01 1 1  ON 10
  ud_1                 7.564994e-02 1 1  ON 11
  ud_2                -2.647086e-02 1 1  ON 12
  ud_3                -7.929908e-02 1 1  ON 13
  ud_4                -1.150085e-01 1 1  ON 14
  ud_5                -1.333266e-01 1 1  ON 15
  ud_6                -1.264069e-01 1 1  ON 16
  ud_7                -8.461635e-02 1 1  ON 17
  ud_8                -6.266435e-03 1 1  ON 18
  ud_9                 8.581344e-02 1 1  ON 19
  eO_0                -7.034917e-01 1 1  ON 20
  eO_1                -4.202594e-01 1 1  ON 21
  eO_2                -4.179348e-02 1 1  ON 22
  eO_3                 1.844501e-01 1 1  ON 23
  eO_4                 2.569125e-01 1 1  ON 24
  eO_5                 2.798454e-01 1 1  ON 25
  eO_6                 2.508586e-01 1 1  ON 26
  eO_7                 1.335046e-01 1 1  ON 27
  eO_8                 2.929008e-02 1 1  ON 28
  eO_9                 1.920003e-02 1 1  ON 29
 eH1_0                -2.017301e-01 1 1  ON 30
 eH1_1                -9.603516e-02 1 1  ON 31
 eH1_2                -4.455928e-02 1 1  ON 32
 eH1_3                -1.423199e-02 1 1  ON 33
 eH1_4                 1.808194e-02 1 1  ON 34
 eH1_5                 2.185243e-02 1 1  ON 35
 eH1_6                 7.089257e-02 1 1  ON 36
 eH1_7                 1.025519e-01 1 1  ON 37
 eH1_8                 1.010637e-01 1 1  ON 38
 eH1_9                 2.609273e-02 1 1  ON 39
 eH2_0                -2.031765e-01 1 1  ON 40
 eH2_1                -9.764664e-02 1 1  ON 41
 eH2_2                -4.626630e-02 1 1  ON 42
 eH2_3                -1.570718e-02 1 1  ON 43
 eH2_4                 1.609239e-02 1 1  ON 44
 eH2_5                 1.955240e-02 1 1  ON 45
 eH2_6                 7.200278e-02 1 1  ON 46
 eH2_7                 1.099149e-01 1 1  ON 47
 eH2_8                 1.035649e-01 1 1  ON 48
 eH2_9                 2.895905e-02 1 1  ON 49
ci_001                -4.165522e-02 3 1  ON 50
ci_002                -3.094518e-02 3 1  ON 51
ci_003                -1.140270e-02 3 1  ON 52
ci_004                 2.557793e-02 3 1  ON 53
ci_005                 2.573139e-02 3 1  ON 54
ci_006                -2.021318e-02 3 1  ON 55
ci_007                -1.980000e-02 3 1  ON 56
ci_008                -4.050009e-03 3 1  ON 57
ci_009                -1.516922e-02 3 1  ON 58
ci_010                -9.525782e-03 3 1  ON 59
ci_011                -9.637420e-03 3 1  ON 60
ci_012                -9.630365e-03 3 1  ON 61
ci_013                -2.166285e-02 3 1  ON 62
ci_014                 1.333259e-02 3 1  ON 63
ci_015                 1.313401e-02 3 1  ON 64
ci_016                 1.628182e-02 3 1  ON 65
ci_017                 1.612105e-02 3 1  ON 66
ci_018                 1.086371e-02 3 1  ON 67
ci_019                 1.051858e-02 3 1  ON 68
ci_020                 1.847280e-02 3 1  ON 69
ci_021                 1.812110e-02 3 1  ON 70
ci_022                 1.026837e-02 3 1  ON 71
ci_023                 1.028560e-02 3 1  ON 72
ci_024                 6.713471e-03 3 1  ON 73
ci_025                 6.508256e-03 3 1  ON 74
ci_026                 1.187405e-02 3 1  ON 75
ci_027                 1.183932e-02 3 1  ON 76
ci_028                -9.171677e-03 3 1  ON 77
ci_029                -9.756291e-03 3 1  ON 78
ci_030                -4.996993e-03 3 1  ON 79
ci_031                -4.665616e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.1343
    reference variance = 0.163329
====================================================
  Execution time = 1.9066e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9666e-01
  Total weights = 1.9739e+06
  Execution time = 1.6021e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290685098349
                                         uncertainty =       0.001973624138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290685098349
                                         uncertainty =       0.001973624138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381217840
  error estimate for blocks of size 2^( 2) =       0.000396172606
  error estimate for blocks of size 2^( 3) =       0.000410483677
  error estimate for blocks of size 2^( 4) =       0.000420993648
  error estimate for blocks of size 2^( 5) =       0.000427194181
  error estimate for blocks of size 2^( 6) =       0.000431408292
  error estimate for blocks of size 2^( 7) =       0.000434177747

      target function =      -0.917957336266
              le_mean =     -17.205849187486
             les_mean =     296.337911282544
             stat err =       0.000428443467
             autocorr =       1.263108382770
   target nu stat err =       0.000428443467
   target dn stat err =       0.002149649281
      target stat err =       0.003424907655
              std dev =       0.539123439558
             le_variance =       0.290654083081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290684942460
                                         uncertainty =       0.001973622259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290684942460
                                         uncertainty =       0.001973622259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381217738
  error estimate for blocks of size 2^( 2) =       0.000396172486
  error estimate for blocks of size 2^( 3) =       0.000410483534
  error estimate for blocks of size 2^( 4) =       0.000420993497
  error estimate for blocks of size 2^( 5) =       0.000427194017
  error estimate for blocks of size 2^( 6) =       0.000431408085
  error estimate for blocks of size 2^( 7) =       0.000434177527

      target function =      -0.917957607717
              le_mean =     -17.205849183145
             les_mean =     296.337910958851
             stat err =       0.000428443281
             autocorr =       1.263107963723
   target nu stat err =       0.000428443281
   target dn stat err =       0.002149648575
      target stat err =       0.003424908465
              std dev =       0.539123295196
             le_variance =       0.290653927423

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290685020342
                                         uncertainty =       0.001973623198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290685020342
                                         uncertainty =       0.001973623198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381217789
  error estimate for blocks of size 2^( 2) =       0.000396172546
  error estimate for blocks of size 2^( 3) =       0.000410483605
  error estimate for blocks of size 2^( 4) =       0.000420993572
  error estimate for blocks of size 2^( 5) =       0.000427194099
  error estimate for blocks of size 2^( 6) =       0.000431408188
  error estimate for blocks of size 2^( 7) =       0.000434177637

      target function =      -0.917957472671
              le_mean =     -17.205849185310
             les_mean =     296.337911120064
             stat err =       0.000428443374
             autocorr =       1.263108173116
   target nu stat err =       0.000428443374
   target dn stat err =       0.002149648924
      target stat err =       0.003424908058
              std dev =       0.539123367319
             le_variance =       0.290654005189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290685088594
                                         uncertainty =       0.001973624020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290685088594
                                         uncertainty =       0.001973624020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381217834
  error estimate for blocks of size 2^( 2) =       0.000396172599
  error estimate for blocks of size 2^( 3) =       0.000410483668
  error estimate for blocks of size 2^( 4) =       0.000420993638
  error estimate for blocks of size 2^( 5) =       0.000427194171
  error estimate for blocks of size 2^( 6) =       0.000431408279
  error estimate for blocks of size 2^( 7) =       0.000434177733

      target function =      -0.917957353386
              le_mean =     -17.205849187214
             les_mean =     296.337911262171
             stat err =       0.000428443455
             autocorr =       1.263108356553
   target nu stat err =       0.000428443455
   target dn stat err =       0.002149649236
      target stat err =       0.003424907705
              std dev =       0.539123430525
             le_variance =       0.290654073341


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917957336266        initial
     8.8818e+01     8.8818e+02             4.3547e-06        -0.917957607717  <--
     3.5527e+02     3.5527e+03             1.0888e-06        -0.917957472671
     1.4211e+03     1.4211e+04             2.7221e-07        -0.917957353386

*****************************************************************************
Applying the update for shift_i =   8.8818e+01     and shift_s =   8.8818e+02
*****************************************************************************

  Execution time = 2.6989e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
  uu_0                 2.099636e-01 1 1  ON 0
  uu_1                 5.296678e-02 1 1  ON 1
  uu_2                -3.787403e-02 1 1  ON 2
  uu_3                -9.122629e-02 1 1  ON 3
  uu_4                -1.219407e-01 1 1  ON 4
  uu_5                -1.298116e-01 1 1  ON 5
  uu_6                -1.125624e-01 1 1  ON 6
  uu_7                -5.673713e-02 1 1  ON 7
  uu_8                 5.808488e-02 1 1  ON 8
  uu_9                 1.245061e-01 1 1  ON 9
  ud_0                 3.048845e-01 1 1  ON 10
  ud_1                 7.564873e-02 1 1  ON 11
  ud_2                -2.647197e-02 1 1  ON 12
  ud_3                -7.929970e-02 1 1  ON 13
  ud_4                -1.150085e-01 1 1  ON 14
  ud_5                -1.333263e-01 1 1  ON 15
  ud_6                -1.264058e-01 1 1  ON 16
  ud_7                -8.461518e-02 1 1  ON 17
  ud_8                -6.265627e-03 1 1  ON 18
  ud_9                 8.581331e-02 1 1  ON 19
  eO_0                -7.034925e-01 1 1  ON 20
  eO_1                -4.202604e-01 1 1  ON 21
  eO_2                -4.179384e-02 1 1  ON 22
  eO_3                 1.844497e-01 1 1  ON 23
  eO_4                 2.569126e-01 1 1  ON 24
  eO_5                 2.798454e-01 1 1  ON 25
  eO_6                 2.508582e-01 1 1  ON 26
  eO_7                 1.335065e-01 1 1  ON 27
  eO_8                 2.929094e-02 1 1  ON 28
  eO_9                 1.920018e-02 1 1  ON 29
 eH1_0                -2.017304e-01 1 1  ON 30
 eH1_1                -9.603543e-02 1 1  ON 31
 eH1_2                -4.456042e-02 1 1  ON 32
 eH1_3                -1.423285e-02 1 1  ON 33
 eH1_4                 1.808049e-02 1 1  ON 34
 eH1_5                 2.185125e-02 1 1  ON 35
 eH1_6                 7.089584e-02 1 1  ON 36
 eH1_7                 1.025524e-01 1 1  ON 37
 eH1_8                 1.010649e-01 1 1  ON 38
 eH1_9                 2.609288e-02 1 1  ON 39
 eH2_0                -2.031759e-01 1 1  ON 40
 eH2_1                -9.764639e-02 1 1  ON 41
 eH2_2                -4.626654e-02 1 1  ON 42
 eH2_3                -1.570777e-02 1 1  ON 43
 eH2_4                 1.609131e-02 1 1  ON 44
 eH2_5                 1.955234e-02 1 1  ON 45
 eH2_6                 7.200252e-02 1 1  ON 46
 eH2_7                 1.099145e-01 1 1  ON 47
 eH2_8                 1.035661e-01 1 1  ON 48
 eH2_9                 2.895948e-02 1 1  ON 49
ci_001                -4.165510e-02 3 1  ON 50
ci_002                -3.094485e-02 3 1  ON 51
ci_003                -1.140274e-02 3 1  ON 52
ci_004                 2.557810e-02 3 1  ON 53
ci_005                 2.573144e-02 3 1  ON 54
ci_006                -2.021320e-02 3 1  ON 55
ci_007                -1.979990e-02 3 1  ON 56
ci_008                -4.050332e-03 3 1  ON 57
ci_009                -1.516917e-02 3 1  ON 58
ci_010                -9.526055e-03 3 1  ON 59
ci_011                -9.637627e-03 3 1  ON 60
ci_012                -9.630701e-03 3 1  ON 61
ci_013                -2.166321e-02 3 1  ON 62
ci_014                 1.333209e-02 3 1  ON 63
ci_015                 1.313441e-02 3 1  ON 64
ci_016                 1.628167e-02 3 1  ON 65
ci_017                 1.612137e-02 3 1  ON 66
ci_018                 1.086311e-02 3 1  ON 67
ci_019                 1.051865e-02 3 1  ON 68
ci_020                 1.847246e-02 3 1  ON 69
ci_021                 1.812105e-02 3 1  ON 70
ci_022                 1.026822e-02 3 1  ON 71
ci_023                 1.028544e-02 3 1  ON 72
ci_024                 6.713874e-03 3 1  ON 73
ci_025                 6.508147e-03 3 1  ON 74
ci_026                 1.187424e-02 3 1  ON 75
ci_027                 1.183916e-02 3 1  ON 76
ci_028                -9.171776e-03 3 1  ON 77
ci_029                -9.756122e-03 3 1  ON 78
ci_030                -4.996514e-03 3 1  ON 79
ci_031                -4.665414e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1613e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.284
    reference variance = 0.241912
====================================================
  Execution time = 1.8963e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5417e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9925e-01
  Total weights = 1.973835032e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4934e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291492938640
                                         uncertainty =       0.001722572364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291492938640
                                         uncertainty =       0.001722572364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381753730
  error estimate for blocks of size 2^( 2) =       0.000397196637
  error estimate for blocks of size 2^( 3) =       0.000411028318
  error estimate for blocks of size 2^( 4) =       0.000421199852
  error estimate for blocks of size 2^( 5) =       0.000427526777
  error estimate for blocks of size 2^( 6) =       0.000429845657
  error estimate for blocks of size 2^( 7) =       0.000431797909

      target function =      -0.913940858240
              le_mean =     -17.205875374053
             les_mean =     296.341401196120
             stat err =       0.000427592549
             autocorr =       1.254566478010
   target nu stat err =       0.000427592549
   target dn stat err =       0.002414206331
      target stat err =       0.003795527950
              std dev =       0.539881302648
             le_variance =       0.291471820949


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720587537405e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+01, overlap shift 2.2204e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913955518593       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913956286706       residual = 6.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913956426043       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913956486964       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913956494135       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913956503814       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913956538763       residual = 7.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913956537378       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913956550350       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913956556982       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913956562256       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913956570272       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913956574355       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913956580971       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913956584005       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913956585404       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913956582443       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913956584984       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913956589479       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913956591591       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913956591662       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913956592083       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913956596438       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913956599189       residual = 9.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913956597468       residual = 9.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913956599348       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913956600536       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913956599481       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913956598483       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913956598203       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913956598529       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913956598516       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913956598445       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913956598495       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913956598965       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913956599001       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.2204e+01 is 1.527845e-05

solving harmonic davidson linear method for identity shift 8.8818e+01, overlap shift 8.8818e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913955518593       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913955711106       residual = 6.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913955745992       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913955761255       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913955763053       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913955765460       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913955774215       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913955773881       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913955777121       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913955778785       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913955780104       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913955782111       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913955783132       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913955784785       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913955785540       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913955785888       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913955785150       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913955785789       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913955786913       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913955787438       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913955787456       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913955787562       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913955788651       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913955789334       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913955788903       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913955789374       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913955789669       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913955789404       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913955789155       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913955789086       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913955789168       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913955789163       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913955789146       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913955789160       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913955789276       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913955789284       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.8818e+01 is 3.823837e-06

solving harmonic davidson linear method for identity shift 3.5527e+02, overlap shift 3.5527e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913955518593       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913955566752       residual = 6.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913955575476       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913955579295       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913955579745       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913955580345       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913955582535       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913955582453       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913955583261       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913955583679       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913955584007       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913955584510       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913955584766       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913955585178       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913955585366       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913955585453       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913955585270       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913955585430       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913955585710       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913955585841       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913955585847       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913955585873       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913955586145       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913955586315       residual = 9.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913955586209       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913955586325       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913955586398       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913955586332       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913955586270       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913955586253       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913955586275       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913955586274       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913955586268       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913955586273       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913955586301       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913955586303       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.5527e+02 is 9.562238e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.769425 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4532e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
  uu_0                 2.099641e-01 1 1  ON 0
  uu_1                 5.296796e-02 1 1  ON 1
  uu_2                -3.787291e-02 1 1  ON 2
  uu_3                -9.122583e-02 1 1  ON 3
  uu_4                -1.219410e-01 1 1  ON 4
  uu_5                -1.298121e-01 1 1  ON 5
  uu_6                -1.125632e-01 1 1  ON 6
  uu_7                -5.673768e-02 1 1  ON 7
  uu_8                 5.808265e-02 1 1  ON 8
  uu_9                 1.245058e-01 1 1  ON 9
  ud_0                 3.048833e-01 1 1  ON 10
  ud_1                 7.564725e-02 1 1  ON 11
  ud_2                -2.647327e-02 1 1  ON 12
  ud_3                -7.930062e-02 1 1  ON 13
  ud_4                -1.150089e-01 1 1  ON 14
  ud_5                -1.333266e-01 1 1  ON 15
  ud_6                -1.264049e-01 1 1  ON 16
  ud_7                -8.461330e-02 1 1  ON 17
  ud_8                -6.263734e-03 1 1  ON 18
  ud_9                 8.581303e-02 1 1  ON 19
  eO_0                -7.034930e-01 1 1  ON 20
  eO_1                -4.202616e-01 1 1  ON 21
  eO_2                -4.179526e-02 1 1  ON 22
  eO_3                 1.844484e-01 1 1  ON 23
  eO_4                 2.569136e-01 1 1  ON 24
  eO_5                 2.798450e-01 1 1  ON 25
  eO_6                 2.508580e-01 1 1  ON 26
  eO_7                 1.335091e-01 1 1  ON 27
  eO_8                 2.929207e-02 1 1  ON 28
  eO_9                 1.920031e-02 1 1  ON 29
 eH1_0                -2.017307e-01 1 1  ON 30
 eH1_1                -9.603739e-02 1 1  ON 31
 eH1_2                -4.456247e-02 1 1  ON 32
 eH1_3                -1.423493e-02 1 1  ON 33
 eH1_4                 1.808126e-02 1 1  ON 34
 eH1_5                 2.185507e-02 1 1  ON 35
 eH1_6                 7.089732e-02 1 1  ON 36
 eH1_7                 1.025517e-01 1 1  ON 37
 eH1_8                 1.010657e-01 1 1  ON 38
 eH1_9                 2.609317e-02 1 1  ON 39
 eH2_0                -2.031752e-01 1 1  ON 40
 eH2_1                -9.764646e-02 1 1  ON 41
 eH2_2                -4.626694e-02 1 1  ON 42
 eH2_3                -1.570760e-02 1 1  ON 43
 eH2_4                 1.609287e-02 1 1  ON 44
 eH2_5                 1.955194e-02 1 1  ON 45
 eH2_6                 7.200066e-02 1 1  ON 46
 eH2_7                 1.099120e-01 1 1  ON 47
 eH2_8                 1.035680e-01 1 1  ON 48
 eH2_9                 2.896043e-02 1 1  ON 49
ci_001                -4.165573e-02 3 1  ON 50
ci_002                -3.094464e-02 3 1  ON 51
ci_003                -1.140226e-02 3 1  ON 52
ci_004                 2.557814e-02 3 1  ON 53
ci_005                 2.573173e-02 3 1  ON 54
ci_006                -2.021220e-02 3 1  ON 55
ci_007                -1.979945e-02 3 1  ON 56
ci_008                -4.050304e-03 3 1  ON 57
ci_009                -1.516934e-02 3 1  ON 58
ci_010                -9.526513e-03 3 1  ON 59
ci_011                -9.637929e-03 3 1  ON 60
ci_012                -9.629590e-03 3 1  ON 61
ci_013                -2.166310e-02 3 1  ON 62
ci_014                 1.333156e-02 3 1  ON 63
ci_015                 1.313438e-02 3 1  ON 64
ci_016                 1.628158e-02 3 1  ON 65
ci_017                 1.612092e-02 3 1  ON 66
ci_018                 1.086231e-02 3 1  ON 67
ci_019                 1.051917e-02 3 1  ON 68
ci_020                 1.847215e-02 3 1  ON 69
ci_021                 1.812195e-02 3 1  ON 70
ci_022                 1.026861e-02 3 1  ON 71
ci_023                 1.028538e-02 3 1  ON 72
ci_024                 6.713060e-03 3 1  ON 73
ci_025                 6.509496e-03 3 1  ON 74
ci_026                 1.187438e-02 3 1  ON 75
ci_027                 1.183985e-02 3 1  ON 76
ci_028                -9.172569e-03 3 1  ON 77
ci_029                -9.755350e-03 3 1  ON 78
ci_030                -4.996642e-03 3 1  ON 79
ci_031                -4.664985e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.1946
    reference variance = 0.355082
====================================================
  Execution time = 1.9202e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0283e-01
  Total weights = 1.9736e+06
  Execution time = 1.6035e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291739652952
                                         uncertainty =       0.002330779406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291739652952
                                         uncertainty =       0.002330779406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381954770
  error estimate for blocks of size 2^( 2) =       0.000397090032
  error estimate for blocks of size 2^( 3) =       0.000411286424
  error estimate for blocks of size 2^( 4) =       0.000421232445
  error estimate for blocks of size 2^( 5) =       0.000426975652
  error estimate for blocks of size 2^( 6) =       0.000429107002
  error estimate for blocks of size 2^( 7) =       0.000430251795

      target function =      -0.908428536649
              le_mean =     -17.205586273397
             les_mean =     296.335030146351
             stat err =       0.000426891723
             autocorr =       1.249141373108
   target nu stat err =       0.000426891723
   target dn stat err =       0.004285773632
      target stat err =       0.006571206854
              std dev =       0.540165616233
             le_variance =       0.291778892960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291737800451
                                         uncertainty =       0.002330509664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291737800451
                                         uncertainty =       0.002330509664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381953561
  error estimate for blocks of size 2^( 2) =       0.000397088744
  error estimate for blocks of size 2^( 3) =       0.000411285006
  error estimate for blocks of size 2^( 4) =       0.000421230855
  error estimate for blocks of size 2^( 5) =       0.000426974197
  error estimate for blocks of size 2^( 6) =       0.000429105576
  error estimate for blocks of size 2^( 7) =       0.000430250266

      target function =      -0.908446584027
              le_mean =     -17.205586280351
             les_mean =     296.335018663557
             stat err =       0.000426890224
             autocorr =       1.249140501794
   target nu stat err =       0.000426890224
   target dn stat err =       0.004277400828
      target stat err =       0.006558779360
              std dev =       0.540163906769
             le_variance =       0.291777046176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291738722922
                                         uncertainty =       0.002330644117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291738722922
                                         uncertainty =       0.002330644117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381954163
  error estimate for blocks of size 2^( 2) =       0.000397089386
  error estimate for blocks of size 2^( 3) =       0.000411285712
  error estimate for blocks of size 2^( 4) =       0.000421231647
  error estimate for blocks of size 2^( 5) =       0.000426974922
  error estimate for blocks of size 2^( 6) =       0.000429106287
  error estimate for blocks of size 2^( 7) =       0.000430251028

      target function =      -0.908437619692
              le_mean =     -17.205586276755
             les_mean =     296.335024362136
             stat err =       0.000426890971
             autocorr =       1.249140937954
   target nu stat err =       0.000426890971
   target dn stat err =       0.004281569356
      target stat err =       0.006564966963
              std dev =       0.540164758010
             le_variance =       0.291777965796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291739536445
                                         uncertainty =       0.002330762473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291739536445
                                         uncertainty =       0.002330762473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381954694
  error estimate for blocks of size 2^( 2) =       0.000397089951
  error estimate for blocks of size 2^( 3) =       0.000411286334
  error estimate for blocks of size 2^( 4) =       0.000421232345
  error estimate for blocks of size 2^( 5) =       0.000426975560
  error estimate for blocks of size 2^( 6) =       0.000429106913
  error estimate for blocks of size 2^( 7) =       0.000430251699

      target function =      -0.908429677065
              le_mean =     -17.205586273804
             les_mean =     296.335029419577
             stat err =       0.000426891629
             autocorr =       1.249141318812
   target nu stat err =       0.000426891629
   target dn stat err =       0.004285246826
      target stat err =       0.006570425023
              std dev =       0.540165508721
             le_variance =       0.291778776812


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908428536649        initial
     2.2204e+01     2.2204e+02             1.5278e-05        -0.908446584027  <--
     8.8818e+01     8.8818e+02             3.8238e-06        -0.908437619692
     3.5527e+02     3.5527e+03             9.5622e-07        -0.908429677065

*****************************************************************************
Applying the update for shift_i =   2.2204e+01     and shift_s =   2.2204e+02
*****************************************************************************

  Execution time = 2.7119e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
  uu_0                 2.099654e-01 1 1  ON 0
  uu_1                 5.297152e-02 1 1  ON 1
  uu_2                -3.786958e-02 1 1  ON 2
  uu_3                -9.122443e-02 1 1  ON 3
  uu_4                -1.219420e-01 1 1  ON 4
  uu_5                -1.298136e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.673931e-02 1 1  ON 7
  uu_8                 5.807598e-02 1 1  ON 8
  uu_9                 1.245050e-01 1 1  ON 9
  ud_0                 3.048797e-01 1 1  ON 10
  ud_1                 7.564280e-02 1 1  ON 11
  ud_2                -2.647716e-02 1 1  ON 12
  ud_3                -7.930338e-02 1 1  ON 13
  ud_4                -1.150102e-01 1 1  ON 14
  ud_5                -1.333276e-01 1 1  ON 15
  ud_6                -1.264022e-01 1 1  ON 16
  ud_7                -8.460767e-02 1 1  ON 17
  ud_8                -6.258056e-03 1 1  ON 18
  ud_9                 8.581220e-02 1 1  ON 19
  eO_0                -7.034943e-01 1 1  ON 20
  eO_1                -4.202650e-01 1 1  ON 21
  eO_2                -4.179951e-02 1 1  ON 22
  eO_3                 1.844443e-01 1 1  ON 23
  eO_4                 2.569169e-01 1 1  ON 24
  eO_5                 2.798439e-01 1 1  ON 25
  eO_6                 2.508574e-01 1 1  ON 26
  eO_7                 1.335169e-01 1 1  ON 27
  eO_8                 2.929549e-02 1 1  ON 28
  eO_9                 1.920069e-02 1 1  ON 29
 eH1_0                -2.017318e-01 1 1  ON 30
 eH1_1                -9.604327e-02 1 1  ON 31
 eH1_2                -4.456860e-02 1 1  ON 32
 eH1_3                -1.424117e-02 1 1  ON 33
 eH1_4                 1.808358e-02 1 1  ON 34
 eH1_5                 2.186653e-02 1 1  ON 35
 eH1_6                 7.090175e-02 1 1  ON 36
 eH1_7                 1.025496e-01 1 1  ON 37
 eH1_8                 1.010681e-01 1 1  ON 38
 eH1_9                 2.609405e-02 1 1  ON 39
 eH2_0                -2.031729e-01 1 1  ON 40
 eH2_1                -9.764666e-02 1 1  ON 41
 eH2_2                -4.626812e-02 1 1  ON 42
 eH2_3                -1.570708e-02 1 1  ON 43
 eH2_4                 1.609753e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199509e-02 1 1  ON 46
 eH2_7                 1.099043e-01 1 1  ON 47
 eH2_8                 1.035734e-01 1 1  ON 48
 eH2_9                 2.896329e-02 1 1  ON 49
ci_001                -4.165761e-02 3 1  ON 50
ci_002                -3.094400e-02 3 1  ON 51
ci_003                -1.140082e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573258e-02 3 1  ON 54
ci_006                -2.020920e-02 3 1  ON 55
ci_007                -1.979810e-02 3 1  ON 56
ci_008                -4.050220e-03 3 1  ON 57
ci_009                -1.516984e-02 3 1  ON 58
ci_010                -9.527884e-03 3 1  ON 59
ci_011                -9.638831e-03 3 1  ON 60
ci_012                -9.626269e-03 3 1  ON 61
ci_013                -2.166278e-02 3 1  ON 62
ci_014                 1.332997e-02 3 1  ON 63
ci_015                 1.313427e-02 3 1  ON 64
ci_016                 1.628130e-02 3 1  ON 65
ci_017                 1.611958e-02 3 1  ON 66
ci_018                 1.085993e-02 3 1  ON 67
ci_019                 1.052071e-02 3 1  ON 68
ci_020                 1.847122e-02 3 1  ON 69
ci_021                 1.812464e-02 3 1  ON 70
ci_022                 1.026979e-02 3 1  ON 71
ci_023                 1.028520e-02 3 1  ON 72
ci_024                 6.710626e-03 3 1  ON 73
ci_025                 6.513532e-03 3 1  ON 74
ci_026                 1.187477e-02 3 1  ON 75
ci_027                 1.184189e-02 3 1  ON 76
ci_028                -9.174942e-03 3 1  ON 77
ci_029                -9.753041e-03 3 1  ON 78
ci_030                -4.997025e-03 3 1  ON 79
ci_031                -4.663702e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1669e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.2192
    reference variance = 0.160517
====================================================
  Execution time = 1.8993e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5397e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9753e-01
  Total weights = 1.973659606e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5282e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290162508034
                                         uncertainty =       0.002961829041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290162508034
                                         uncertainty =       0.002961829041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380939241
  error estimate for blocks of size 2^( 2) =       0.000395959026
  error estimate for blocks of size 2^( 3) =       0.000410206505
  error estimate for blocks of size 2^( 4) =       0.000420374998
  error estimate for blocks of size 2^( 5) =       0.000426944894
  error estimate for blocks of size 2^( 6) =       0.000429148394
  error estimate for blocks of size 2^( 7) =       0.000432919900

      target function =      -0.916596076049
              le_mean =     -17.206290678201
             les_mean =     296.353964790588
             stat err =       0.000427347047
             autocorr =       1.258490639728
   target nu stat err =       0.000427347047
   target dn stat err =       0.003322447441
      target stat err =       0.005212480412
              std dev =       0.538729440829
             le_variance =       0.290229410416


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720629067820e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+00, overlap shift 5.5511e+01 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916624527502       residual = 9.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916632327895       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916633576557       residual = 7.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916633810221       residual = 8.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916633942923       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916633980825       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916634021807       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916634054738       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916634081307       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916634085486       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916634095817       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916634121865       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916634118181       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916634167556       residual = 8.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916634168908       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916634155420       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916634170424       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916634181243       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916634192701       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916634183519       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916634198623       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916634200828       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916634203859       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916634208330       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916634209852       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916634205129       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916634205371       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916634204497       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916634209293       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916634213453       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916634213125       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916634212279       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916634213071       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916634211337       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.5511e+00 is 6.949839e-05

solving harmonic davidson linear method for identity shift 2.2204e+01, overlap shift 2.2204e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916624527502       residual = 9.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916626497741       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916626811840       residual = 7.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916626870731       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916626904103       residual = 6.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916626913571       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916626923965       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916626932173       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916626938856       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916626939877       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916626942493       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916626949085       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916626948159       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916626960510       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916626960758       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916626957363       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916626961172       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916626963875       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916626966697       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916626964397       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916626968240       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916626968765       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916626969539       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916626970641       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916626970973       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916626969804       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916626969860       residual = 9.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916626969660       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916626970875       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916626971866       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916626971780       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916626971572       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916626971760       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916626971328       residual = 9.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.2204e+01 is 1.739255e-05

solving harmonic davidson linear method for identity shift 8.8818e+01, overlap shift 8.8818e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916624527502       residual = 9.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916625021337       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916625099983       residual = 7.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916625114736       residual = 8.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916625123091       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916625125458       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916625128066       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916625130116       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916625131789       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916625132043       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916625132699       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916625134352       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916625134120       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916625137209       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916625137265       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916625136415       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916625137370       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916625138046       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916625138749       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916625138174       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916625139139       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916625139268       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916625139463       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916625139737       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916625139817       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916625139526       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916625139540       residual = 9.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916625139491       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916625139796       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916625140040       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916625140018       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916625139967       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916625140013       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916625139905       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.8818e+01 is 4.349259e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.823564 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4584e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
  uu_0                 2.099688e-01 1 1  ON 0
  uu_1                 5.297578e-02 1 1  ON 1
  uu_2                -3.786683e-02 1 1  ON 2
  uu_3                -9.122258e-02 1 1  ON 3
  uu_4                -1.219416e-01 1 1  ON 4
  uu_5                -1.298130e-01 1 1  ON 5
  uu_6                -1.125668e-01 1 1  ON 6
  uu_7                -5.674506e-02 1 1  ON 7
  uu_8                 5.805859e-02 1 1  ON 8
  uu_9                 1.245082e-01 1 1  ON 9
  ud_0                 3.048721e-01 1 1  ON 10
  ud_1                 7.563604e-02 1 1  ON 11
  ud_2                -2.648135e-02 1 1  ON 12
  ud_3                -7.930619e-02 1 1  ON 13
  ud_4                -1.150135e-01 1 1  ON 14
  ud_5                -1.333294e-01 1 1  ON 15
  ud_6                -1.263986e-01 1 1  ON 16
  ud_7                -8.459552e-02 1 1  ON 17
  ud_8                -6.254175e-03 1 1  ON 18
  ud_9                 8.581199e-02 1 1  ON 19
  eO_0                -7.034961e-01 1 1  ON 20
  eO_1                -4.202679e-01 1 1  ON 21
  eO_2                -4.180588e-02 1 1  ON 22
  eO_3                 1.844426e-01 1 1  ON 23
  eO_4                 2.569173e-01 1 1  ON 24
  eO_5                 2.798429e-01 1 1  ON 25
  eO_6                 2.508566e-01 1 1  ON 26
  eO_7                 1.335283e-01 1 1  ON 27
  eO_8                 2.929670e-02 1 1  ON 28
  eO_9                 1.920169e-02 1 1  ON 29
 eH1_0                -2.017242e-01 1 1  ON 30
 eH1_1                -9.603879e-02 1 1  ON 31
 eH1_2                -4.457134e-02 1 1  ON 32
 eH1_3                -1.424185e-02 1 1  ON 33
 eH1_4                 1.808445e-02 1 1  ON 34
 eH1_5                 2.186209e-02 1 1  ON 35
 eH1_6                 7.089481e-02 1 1  ON 36
 eH1_7                 1.025467e-01 1 1  ON 37
 eH1_8                 1.010707e-01 1 1  ON 38
 eH1_9                 2.609565e-02 1 1  ON 39
 eH2_0                -2.031727e-01 1 1  ON 40
 eH2_1                -9.764967e-02 1 1  ON 41
 eH2_2                -4.627385e-02 1 1  ON 42
 eH2_3                -1.571164e-02 1 1  ON 43
 eH2_4                 1.609466e-02 1 1  ON 44
 eH2_5                 1.955015e-02 1 1  ON 45
 eH2_6                 7.200275e-02 1 1  ON 46
 eH2_7                 1.099051e-01 1 1  ON 47
 eH2_8                 1.035776e-01 1 1  ON 48
 eH2_9                 2.896656e-02 1 1  ON 49
ci_001                -4.165814e-02 3 1  ON 50
ci_002                -3.093973e-02 3 1  ON 51
ci_003                -1.139969e-02 3 1  ON 52
ci_004                 2.557612e-02 3 1  ON 53
ci_005                 2.573979e-02 3 1  ON 54
ci_006                -2.021368e-02 3 1  ON 55
ci_007                -1.980114e-02 3 1  ON 56
ci_008                -4.050252e-03 3 1  ON 57
ci_009                -1.516805e-02 3 1  ON 58
ci_010                -9.529213e-03 3 1  ON 59
ci_011                -9.636703e-03 3 1  ON 60
ci_012                -9.628386e-03 3 1  ON 61
ci_013                -2.166420e-02 3 1  ON 62
ci_014                 1.333164e-02 3 1  ON 63
ci_015                 1.314316e-02 3 1  ON 64
ci_016                 1.627387e-02 3 1  ON 65
ci_017                 1.612349e-02 3 1  ON 66
ci_018                 1.086023e-02 3 1  ON 67
ci_019                 1.052858e-02 3 1  ON 68
ci_020                 1.846707e-02 3 1  ON 69
ci_021                 1.812880e-02 3 1  ON 70
ci_022                 1.027028e-02 3 1  ON 71
ci_023                 1.027921e-02 3 1  ON 72
ci_024                 6.710858e-03 3 1  ON 73
ci_025                 6.515840e-03 3 1  ON 74
ci_026                 1.187479e-02 3 1  ON 75
ci_027                 1.184035e-02 3 1  ON 76
ci_028                -9.177194e-03 3 1  ON 77
ci_029                -9.754840e-03 3 1  ON 78
ci_030                -4.993642e-03 3 1  ON 79
ci_031                -4.662437e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.2018
    reference variance = 0.328351
====================================================
  Execution time = 1.9296e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9758e-01
  Total weights = 1.9737e+06
  Execution time = 1.6033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291326478391
                                         uncertainty =       0.001948650697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291326478391
                                         uncertainty =       0.001948650697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381616880
  error estimate for blocks of size 2^( 2) =       0.000396692711
  error estimate for blocks of size 2^( 3) =       0.000410745138
  error estimate for blocks of size 2^( 4) =       0.000421043106
  error estimate for blocks of size 2^( 5) =       0.000427334722
  error estimate for blocks of size 2^( 6) =       0.000429368374
  error estimate for blocks of size 2^( 7) =       0.000431790198

      target function =      -0.916530159473
              le_mean =     -17.205848187989
             les_mean =     296.338795352443
             stat err =       0.000427384100
             autocorr =       1.254242659776
   target nu stat err =       0.000427384100
   target dn stat err =       0.002109786899
      target stat err =       0.003353677162
              std dev =       0.539687767640
             le_variance =       0.291262886540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291324656562
                                         uncertainty =       0.001948740251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291324656562
                                         uncertainty =       0.001948740251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381615668
  error estimate for blocks of size 2^( 2) =       0.000396690710
  error estimate for blocks of size 2^( 3) =       0.000410741710
  error estimate for blocks of size 2^( 4) =       0.000421038196
  error estimate for blocks of size 2^( 5) =       0.000427329707
  error estimate for blocks of size 2^( 6) =       0.000429362388
  error estimate for blocks of size 2^( 7) =       0.000431782678

      target function =      -0.916523724267
              le_mean =     -17.205847946769
             les_mean =     296.338791199450
             stat err =       0.000427378242
             autocorr =       1.254216247911
   target nu stat err =       0.000427378242
   target dn stat err =       0.002109809309
      target stat err =       0.003353661495
              std dev =       0.539686053212
             le_variance =       0.291261036032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291325525566
                                         uncertainty =       0.001948695311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291325525566
                                         uncertainty =       0.001948695311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381616247
  error estimate for blocks of size 2^( 2) =       0.000396691681
  error estimate for blocks of size 2^( 3) =       0.000410743391
  error estimate for blocks of size 2^( 4) =       0.000421040610
  error estimate for blocks of size 2^( 5) =       0.000427332177
  error estimate for blocks of size 2^( 6) =       0.000429365345
  error estimate for blocks of size 2^( 7) =       0.000431786397

      target function =      -0.916523958552
              le_mean =     -17.205848064170
             les_mean =     296.338795087726
             stat err =       0.000427381132
             autocorr =       1.254229407765
   target nu stat err =       0.000427381132
   target dn stat err =       0.002109787546
      target stat err =       0.003353631969
              std dev =       0.539686871496
             le_variance =       0.291261919265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291326355498
                                         uncertainty =       0.001948656227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291326355498
                                         uncertainty =       0.001948656227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381616799
  error estimate for blocks of size 2^( 2) =       0.000396692580
  error estimate for blocks of size 2^( 3) =       0.000410744917
  error estimate for blocks of size 2^( 4) =       0.000421042791
  error estimate for blocks of size 2^( 5) =       0.000427334401
  error estimate for blocks of size 2^( 6) =       0.000429367991
  error estimate for blocks of size 2^( 7) =       0.000431789719

      target function =      -0.916530351952
              le_mean =     -17.205848171988
             les_mean =     296.338794677925
             stat err =       0.000427383725
             autocorr =       1.254240998995
   target nu stat err =       0.000427383725
   target dn stat err =       0.002109785819
      target stat err =       0.003353676665
              std dev =       0.539687652109
             le_variance =       0.291262761839


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916530159473        initial
     5.5511e+00     5.5511e+01             6.9498e-05        -0.916523724267
     2.2204e+01     2.2204e+02             1.7393e-05        -0.916523958552
     8.8818e+01     8.8818e+02             4.3493e-06        -0.916530351952  <--

*****************************************************************************
Applying the update for shift_i =   8.8818e+01     and shift_s =   8.8818e+02
*****************************************************************************

  Execution time = 2.7263e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
  uu_0                 2.099663e-01 1 1  ON 0
  uu_1                 5.297259e-02 1 1  ON 1
  uu_2                -3.786889e-02 1 1  ON 2
  uu_3                -9.122397e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298134e-01 1 1  ON 5
  uu_6                -1.125659e-01 1 1  ON 6
  uu_7                -5.674075e-02 1 1  ON 7
  uu_8                 5.807163e-02 1 1  ON 8
  uu_9                 1.245058e-01 1 1  ON 9
  ud_0                 3.048778e-01 1 1  ON 10
  ud_1                 7.564111e-02 1 1  ON 11
  ud_2                -2.647821e-02 1 1  ON 12
  ud_3                -7.930409e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333280e-01 1 1  ON 15
  ud_6                -1.264013e-01 1 1  ON 16
  ud_7                -8.460463e-02 1 1  ON 17
  ud_8                -6.257086e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034947e-01 1 1  ON 20
  eO_1                -4.202658e-01 1 1  ON 21
  eO_2                -4.180111e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569170e-01 1 1  ON 24
  eO_5                 2.798437e-01 1 1  ON 25
  eO_6                 2.508572e-01 1 1  ON 26
  eO_7                 1.335198e-01 1 1  ON 27
  eO_8                 2.929579e-02 1 1  ON 28
  eO_9                 1.920094e-02 1 1  ON 29
 eH1_0                -2.017299e-01 1 1  ON 30
 eH1_1                -9.604215e-02 1 1  ON 31
 eH1_2                -4.456929e-02 1 1  ON 32
 eH1_3                -1.424134e-02 1 1  ON 33
 eH1_4                 1.808380e-02 1 1  ON 34
 eH1_5                 2.186542e-02 1 1  ON 35
 eH1_6                 7.090002e-02 1 1  ON 36
 eH1_7                 1.025489e-01 1 1  ON 37
 eH1_8                 1.010688e-01 1 1  ON 38
 eH1_9                 2.609445e-02 1 1  ON 39
 eH2_0                -2.031729e-01 1 1  ON 40
 eH2_1                -9.764741e-02 1 1  ON 41
 eH2_2                -4.626955e-02 1 1  ON 42
 eH2_3                -1.570822e-02 1 1  ON 43
 eH2_4                 1.609681e-02 1 1  ON 44
 eH2_5                 1.955059e-02 1 1  ON 45
 eH2_6                 7.199701e-02 1 1  ON 46
 eH2_7                 1.099045e-01 1 1  ON 47
 eH2_8                 1.035744e-01 1 1  ON 48
 eH2_9                 2.896411e-02 1 1  ON 49
ci_001                -4.165774e-02 3 1  ON 50
ci_002                -3.094293e-02 3 1  ON 51
ci_003                -1.140054e-02 3 1  ON 52
ci_004                 2.557773e-02 3 1  ON 53
ci_005                 2.573439e-02 3 1  ON 54
ci_006                -2.021032e-02 3 1  ON 55
ci_007                -1.979886e-02 3 1  ON 56
ci_008                -4.050228e-03 3 1  ON 57
ci_009                -1.516939e-02 3 1  ON 58
ci_010                -9.528217e-03 3 1  ON 59
ci_011                -9.638298e-03 3 1  ON 60
ci_012                -9.626799e-03 3 1  ON 61
ci_013                -2.166313e-02 3 1  ON 62
ci_014                 1.333039e-02 3 1  ON 63
ci_015                 1.313650e-02 3 1  ON 64
ci_016                 1.627944e-02 3 1  ON 65
ci_017                 1.612056e-02 3 1  ON 66
ci_018                 1.086001e-02 3 1  ON 67
ci_019                 1.052268e-02 3 1  ON 68
ci_020                 1.847018e-02 3 1  ON 69
ci_021                 1.812568e-02 3 1  ON 70
ci_022                 1.026991e-02 3 1  ON 71
ci_023                 1.028370e-02 3 1  ON 72
ci_024                 6.710684e-03 3 1  ON 73
ci_025                 6.514110e-03 3 1  ON 74
ci_026                 1.187478e-02 3 1  ON 75
ci_027                 1.184150e-02 3 1  ON 76
ci_028                -9.175506e-03 3 1  ON 77
ci_029                -9.753492e-03 3 1  ON 78
ci_030                -4.996177e-03 3 1  ON 79
ci_031                -4.663385e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1865e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.1031
    reference variance = 0.392127
====================================================
  Execution time = 1.9210e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5421e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9484e-01
  Total weights = 1.973993427e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4429e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288885328651
                                         uncertainty =       0.001690578186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288885328651
                                         uncertainty =       0.001690578186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380094972
  error estimate for blocks of size 2^( 2) =       0.000395164098
  error estimate for blocks of size 2^( 3) =       0.000409406101
  error estimate for blocks of size 2^( 4) =       0.000420046414
  error estimate for blocks of size 2^( 5) =       0.000425710433
  error estimate for blocks of size 2^( 6) =       0.000429109078
  error estimate for blocks of size 2^( 7) =       0.000430804409

      target function =      -0.920810020767
              le_mean =     -17.206210254143
             les_mean =     296.348510039457
             stat err =       0.000426417584
             autocorr =       1.258594879134
   target nu stat err =       0.000426417584
   target dn stat err =       0.001890614156
      target stat err =       0.003051527308
              std dev =       0.537535464495
             le_variance =       0.288944375590


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720621025414e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+01, overlap shift 2.2204e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920819203517       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920819764177       residual = 9.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920819902373       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920819907058       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920819922719       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920819926259       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920819930958       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920819925476       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920819930363       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920819931161       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920819930458       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920819936343       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920819938940       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920819940763       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920819938817       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920819937466       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920819938336       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920819940825       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920819942916       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920819942318       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920819941509       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920819941152       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920819941734       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920819942200       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920819941543       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920819941405       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920819941638       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920819941926       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920819941801       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920819941372       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920819941744       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920819942173       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920819942648       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920819942530       residual = 9.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.2204e+01 is 9.624883e-06

solving harmonic davidson linear method for identity shift 8.8818e+01, overlap shift 8.8818e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920819203517       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920819344030       residual = 9.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920819378671       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920819379842       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920819383763       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920819384649       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920819385827       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920819384452       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920819385674       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920819385875       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920819385699       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920819387174       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920819387825       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920819388279       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920819387789       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920819387452       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920819387672       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920819388293       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920819388816       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920819388668       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920819388464       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920819388374       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920819388520       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920819388636       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920819388471       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920819388437       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920819388495       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920819388568       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920819388536       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920819388429       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920819388522       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920819388630       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920819388747       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920819388718       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.8818e+01 is 2.406601e-06

solving harmonic davidson linear method for identity shift 3.5527e+02, overlap shift 3.5527e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920819203517       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920819238667       residual = 9.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920819247333       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920819247626       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920819248606       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920819248828       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920819249123       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920819248778       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920819249083       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920819249134       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920819249091       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920819249459       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920819249622       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920819249735       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920819249613       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920819249528       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920819249584       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920819249740       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920819249870       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920819249832       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920819249782       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920819249760       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920819249796       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920819249824       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920819249784       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920819249775       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920819249790       residual = 8.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920819249808       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920819249799       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920819249773       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920819249797       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920819249822       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920819249854       residual = 9.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.5527e+02 is 5.988655e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.876720 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5715e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
  uu_0                 2.099668e-01 1 1  ON 0
  uu_1                 5.297326e-02 1 1  ON 1
  uu_2                -3.786815e-02 1 1  ON 2
  uu_3                -9.122346e-02 1 1  ON 3
  uu_4                -1.219415e-01 1 1  ON 4
  uu_5                -1.298131e-01 1 1  ON 5
  uu_6                -1.125659e-01 1 1  ON 6
  uu_7                -5.674268e-02 1 1  ON 7
  uu_8                 5.806922e-02 1 1  ON 8
  uu_9                 1.245059e-01 1 1  ON 9
  ud_0                 3.048775e-01 1 1  ON 10
  ud_1                 7.564007e-02 1 1  ON 11
  ud_2                -2.647889e-02 1 1  ON 12
  ud_3                -7.930430e-02 1 1  ON 13
  ud_4                -1.150107e-01 1 1  ON 14
  ud_5                -1.333283e-01 1 1  ON 15
  ud_6                -1.264009e-01 1 1  ON 16
  ud_7                -8.460378e-02 1 1  ON 17
  ud_8                -6.256692e-03 1 1  ON 18
  ud_9                 8.581174e-02 1 1  ON 19
  eO_0                -7.034953e-01 1 1  ON 20
  eO_1                -4.202666e-01 1 1  ON 21
  eO_2                -4.180155e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569166e-01 1 1  ON 24
  eO_5                 2.798423e-01 1 1  ON 25
  eO_6                 2.508584e-01 1 1  ON 26
  eO_7                 1.335218e-01 1 1  ON 27
  eO_8                 2.929618e-02 1 1  ON 28
  eO_9                 1.920091e-02 1 1  ON 29
 eH1_0                -2.017298e-01 1 1  ON 30
 eH1_1                -9.604216e-02 1 1  ON 31
 eH1_2                -4.456957e-02 1 1  ON 32
 eH1_3                -1.424127e-02 1 1  ON 33
 eH1_4                 1.808336e-02 1 1  ON 34
 eH1_5                 2.186573e-02 1 1  ON 35
 eH1_6                 7.089921e-02 1 1  ON 36
 eH1_7                 1.025488e-01 1 1  ON 37
 eH1_8                 1.010696e-01 1 1  ON 38
 eH1_9                 2.609475e-02 1 1  ON 39
 eH2_0                -2.031728e-01 1 1  ON 40
 eH2_1                -9.764722e-02 1 1  ON 41
 eH2_2                -4.626950e-02 1 1  ON 42
 eH2_3                -1.570811e-02 1 1  ON 43
 eH2_4                 1.609624e-02 1 1  ON 44
 eH2_5                 1.955008e-02 1 1  ON 45
 eH2_6                 7.199682e-02 1 1  ON 46
 eH2_7                 1.099047e-01 1 1  ON 47
 eH2_8                 1.035751e-01 1 1  ON 48
 eH2_9                 2.896412e-02 1 1  ON 49
ci_001                -4.165786e-02 3 1  ON 50
ci_002                -3.094293e-02 3 1  ON 51
ci_003                -1.140039e-02 3 1  ON 52
ci_004                 2.557791e-02 3 1  ON 53
ci_005                 2.573490e-02 3 1  ON 54
ci_006                -2.020993e-02 3 1  ON 55
ci_007                -1.979946e-02 3 1  ON 56
ci_008                -4.050652e-03 3 1  ON 57
ci_009                -1.516932e-02 3 1  ON 58
ci_010                -9.529397e-03 3 1  ON 59
ci_011                -9.639247e-03 3 1  ON 60
ci_012                -9.627740e-03 3 1  ON 61
ci_013                -2.166313e-02 3 1  ON 62
ci_014                 1.333085e-02 3 1  ON 63
ci_015                 1.313651e-02 3 1  ON 64
ci_016                 1.627942e-02 3 1  ON 65
ci_017                 1.612042e-02 3 1  ON 66
ci_018                 1.085954e-02 3 1  ON 67
ci_019                 1.052335e-02 3 1  ON 68
ci_020                 1.846932e-02 3 1  ON 69
ci_021                 1.812588e-02 3 1  ON 70
ci_022                 1.027016e-02 3 1  ON 71
ci_023                 1.028387e-02 3 1  ON 72
ci_024                 6.710919e-03 3 1  ON 73
ci_025                 6.514752e-03 3 1  ON 74
ci_026                 1.187528e-02 3 1  ON 75
ci_027                 1.184152e-02 3 1  ON 76
ci_028                -9.176126e-03 3 1  ON 77
ci_029                -9.753541e-03 3 1  ON 78
ci_030                -4.995890e-03 3 1  ON 79
ci_031                -4.663045e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.2087
    reference variance = 0.194204
====================================================
  Execution time = 1.8934e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0282e-01
  Total weights = 1.9738e+06
  Execution time = 1.5948e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293771728802
                                         uncertainty =       0.002254096148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293771728802
                                         uncertainty =       0.002254096148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383209807
  error estimate for blocks of size 2^( 2) =       0.000398456711
  error estimate for blocks of size 2^( 3) =       0.000412975726
  error estimate for blocks of size 2^( 4) =       0.000423717786
  error estimate for blocks of size 2^( 5) =       0.000430754820
  error estimate for blocks of size 2^( 6) =       0.000434220882
  error estimate for blocks of size 2^( 7) =       0.000435859766

      target function =      -0.908439332397
              le_mean =     -17.206499919998
             les_mean =     296.366458482056
             stat err =       0.000431138314
             autocorr =       1.265785181916
   target nu stat err =       0.000431138314
   target dn stat err =       0.003351060062
      target stat err =       0.005167141207
              std dev =       0.541940506573
             le_variance =       0.293699512664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293771540986
                                         uncertainty =       0.002254114904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293771540986
                                         uncertainty =       0.002254114904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383209685
  error estimate for blocks of size 2^( 2) =       0.000398456105
  error estimate for blocks of size 2^( 3) =       0.000412974677
  error estimate for blocks of size 2^( 4) =       0.000423716388
  error estimate for blocks of size 2^( 5) =       0.000430753209
  error estimate for blocks of size 2^( 6) =       0.000434219268
  error estimate for blocks of size 2^( 7) =       0.000435858105

      target function =      -0.908435731909
              le_mean =     -17.206499940031
             les_mean =     296.366461516639
             stat err =       0.000431136742
             autocorr =       1.265776766554
   target nu stat err =       0.000431136742
   target dn stat err =       0.003352203780
      target stat err =       0.005168829446
              std dev =       0.541940333065
             le_variance =       0.293699324602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293771634228
                                         uncertainty =       0.002254105533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293771634228
                                         uncertainty =       0.002254105533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383209745
  error estimate for blocks of size 2^( 2) =       0.000398456407
  error estimate for blocks of size 2^( 3) =       0.000412975200
  error estimate for blocks of size 2^( 4) =       0.000423717085
  error estimate for blocks of size 2^( 5) =       0.000430754013
  error estimate for blocks of size 2^( 6) =       0.000434220072
  error estimate for blocks of size 2^( 7) =       0.000435858934

      target function =      -0.908437653857
              le_mean =     -17.206499929981
             les_mean =     296.366459918455
             stat err =       0.000431137526
             autocorr =       1.265780964934
   target nu stat err =       0.000431137526
   target dn stat err =       0.003351632469
      target stat err =       0.005167987528
              std dev =       0.541940419205
             le_variance =       0.293699417968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293771717026
                                         uncertainty =       0.002254097308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293771717026
                                         uncertainty =       0.002254097308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383209800
  error estimate for blocks of size 2^( 2) =       0.000398456673
  error estimate for blocks of size 2^( 3) =       0.000412975660
  error estimate for blocks of size 2^( 4) =       0.000423717699
  error estimate for blocks of size 2^( 5) =       0.000430754719
  error estimate for blocks of size 2^( 6) =       0.000434220780
  error estimate for blocks of size 2^( 7) =       0.000435859662

      target function =      -0.908439131381
              le_mean =     -17.206499921243
             les_mean =     296.366458655717
             stat err =       0.000431138215
             autocorr =       1.265784654803
   target nu stat err =       0.000431138215
   target dn stat err =       0.003351131488
      target stat err =       0.005167246908
              std dev =       0.541940495694
             le_variance =       0.293699500873


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908439332397        initial  <--
     2.2204e+01     2.2204e+02             9.6249e-06        -0.908435731909
     8.8818e+01     8.8818e+02             2.4066e-06        -0.908437653857
     3.5527e+02     3.5527e+03             5.9887e-07        -0.908439131381

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.8253
  </log>
  <optVariables href="H2O.s067.opt.xml">
  uu_0                 2.099663e-01 1 1  ON 0
  uu_1                 5.297259e-02 1 1  ON 1
  uu_2                -3.786889e-02 1 1  ON 2
  uu_3                -9.122397e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298134e-01 1 1  ON 5
  uu_6                -1.125659e-01 1 1  ON 6
  uu_7                -5.674075e-02 1 1  ON 7
  uu_8                 5.807163e-02 1 1  ON 8
  uu_9                 1.245058e-01 1 1  ON 9
  ud_0                 3.048778e-01 1 1  ON 10
  ud_1                 7.564111e-02 1 1  ON 11
  ud_2                -2.647821e-02 1 1  ON 12
  ud_3                -7.930409e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333280e-01 1 1  ON 15
  ud_6                -1.264013e-01 1 1  ON 16
  ud_7                -8.460463e-02 1 1  ON 17
  ud_8                -6.257086e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034947e-01 1 1  ON 20
  eO_1                -4.202658e-01 1 1  ON 21
  eO_2                -4.180111e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569170e-01 1 1  ON 24
  eO_5                 2.798437e-01 1 1  ON 25
  eO_6                 2.508572e-01 1 1  ON 26
  eO_7                 1.335198e-01 1 1  ON 27
  eO_8                 2.929579e-02 1 1  ON 28
  eO_9                 1.920094e-02 1 1  ON 29
 eH1_0                -2.017299e-01 1 1  ON 30
 eH1_1                -9.604215e-02 1 1  ON 31
 eH1_2                -4.456929e-02 1 1  ON 32
 eH1_3                -1.424134e-02 1 1  ON 33
 eH1_4                 1.808380e-02 1 1  ON 34
 eH1_5                 2.186542e-02 1 1  ON 35
 eH1_6                 7.090002e-02 1 1  ON 36
 eH1_7                 1.025489e-01 1 1  ON 37
 eH1_8                 1.010688e-01 1 1  ON 38
 eH1_9                 2.609445e-02 1 1  ON 39
 eH2_0                -2.031729e-01 1 1  ON 40
 eH2_1                -9.764741e-02 1 1  ON 41
 eH2_2                -4.626955e-02 1 1  ON 42
 eH2_3                -1.570822e-02 1 1  ON 43
 eH2_4                 1.609681e-02 1 1  ON 44
 eH2_5                 1.955059e-02 1 1  ON 45
 eH2_6                 7.199701e-02 1 1  ON 46
 eH2_7                 1.099045e-01 1 1  ON 47
 eH2_8                 1.035744e-01 1 1  ON 48
 eH2_9                 2.896411e-02 1 1  ON 49
ci_001                -4.165774e-02 3 1  ON 50
ci_002                -3.094293e-02 3 1  ON 51
ci_003                -1.140054e-02 3 1  ON 52
ci_004                 2.557773e-02 3 1  ON 53
ci_005                 2.573439e-02 3 1  ON 54
ci_006                -2.021032e-02 3 1  ON 55
ci_007                -1.979886e-02 3 1  ON 56
ci_008                -4.050228e-03 3 1  ON 57
ci_009                -1.516939e-02 3 1  ON 58
ci_010                -9.528217e-03 3 1  ON 59
ci_011                -9.638298e-03 3 1  ON 60
ci_012                -9.626799e-03 3 1  ON 61
ci_013                -2.166313e-02 3 1  ON 62
ci_014                 1.333039e-02 3 1  ON 63
ci_015                 1.313650e-02 3 1  ON 64
ci_016                 1.627944e-02 3 1  ON 65
ci_017                 1.612056e-02 3 1  ON 66
ci_018                 1.086001e-02 3 1  ON 67
ci_019                 1.052268e-02 3 1  ON 68
ci_020                 1.847018e-02 3 1  ON 69
ci_021                 1.812568e-02 3 1  ON 70
ci_022                 1.026991e-02 3 1  ON 71
ci_023                 1.028370e-02 3 1  ON 72
ci_024                 6.710684e-03 3 1  ON 73
ci_025                 6.514110e-03 3 1  ON 74
ci_026                 1.187478e-02 3 1  ON 75
ci_027                 1.184150e-02 3 1  ON 76
ci_028                -9.175506e-03 3 1  ON 77
ci_029                -9.753492e-03 3 1  ON 78
ci_030                -4.996177e-03 3 1  ON 79
ci_031                -4.663385e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2559e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.1588
    reference variance = 0.293769
====================================================
  Execution time = 1.9249e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5414e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0182e-01
  Total weights = 1.973675439e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4794e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292752314589
                                         uncertainty =       0.002222385245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292752314589
                                         uncertainty =       0.002222385245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382605071
  error estimate for blocks of size 2^( 2) =       0.000397624623
  error estimate for blocks of size 2^( 3) =       0.000411416673
  error estimate for blocks of size 2^( 4) =       0.000421388799
  error estimate for blocks of size 2^( 5) =       0.000427512924
  error estimate for blocks of size 2^( 6) =       0.000430071193
  error estimate for blocks of size 2^( 7) =       0.000431435277

      target function =      -0.909983167445
              le_mean =     -17.206186729506
             les_mean =     296.354681532943
             stat err =       0.000427602048
             autocorr =       1.249045072055
   target nu stat err =       0.000427602048
   target dn stat err =       0.002875480181
      target stat err =       0.004460759398
              std dev =       0.541085280276
             le_variance =       0.292773280531


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720618672951e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+02, overlap shift 2.2204e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910004107060       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910004185460       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910004197543       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910004203912       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910004205931       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910004206030       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910004206818       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910004207342       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910004206637       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910004206556       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910004206392       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910004207364       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910004207705       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910004208423       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910004208765       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910004208918       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910004208932       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910004208412       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910004209151       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910004209246       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910004209421       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910004209629       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910004209563       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910004209683       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910004209778       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910004209920       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910004209930       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910004209929       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910004209992       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910004210049       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910004209997       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910004209926       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910004209947       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910004209936       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.910004209951       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.2204e+02 is 1.277691e-06

solving harmonic davidson linear method for identity shift 8.8818e+02, overlap shift 8.8818e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910004107060       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910004126665       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910004129686       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910004131279       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910004131784       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910004131809       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910004132005       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910004132135       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910004131960       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910004131939       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910004131901       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910004132142       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910004132226       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910004132407       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910004132489       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910004132530       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910004132531       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910004132406       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910004132590       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910004132615       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910004132658       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910004132705       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910004132690       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910004132720       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910004132747       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910004132780       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910004132785       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910004132785       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910004132800       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910004132811       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910004132801       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910004132783       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910004132789       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910004132783       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.910004132784       residual = 8.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.8818e+02 is 3.194260e-07

solving harmonic davidson linear method for identity shift 3.5527e+03, overlap shift 3.5527e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910004107060       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910004111961       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910004112717       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910004113117       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910004113238       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910004113247       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910004113283       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910004113328       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910004113286       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910004113278       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910004113283       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910004113344       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910004113342       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910004113386       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910004113426       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910004113425       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910004113433       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910004113396       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910004113432       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910004113445       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910004113464       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910004113462       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910004113478       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910004113479       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910004113467       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910004113489       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910004113485       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910004113494       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910004113497       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910004113495       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910004113492       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910004113488       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910004113498       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910004113487       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.910004113499       residual = 8.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.5527e+03 is 7.985670e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.922487 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4780e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
  uu_0                 2.099662e-01 1 1  ON 0
  uu_1                 5.297256e-02 1 1  ON 1
  uu_2                -3.786896e-02 1 1  ON 2
  uu_3                -9.122405e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298134e-01 1 1  ON 5
  uu_6                -1.125658e-01 1 1  ON 6
  uu_7                -5.674069e-02 1 1  ON 7
  uu_8                 5.807133e-02 1 1  ON 8
  uu_9                 1.245059e-01 1 1  ON 9
  ud_0                 3.048778e-01 1 1  ON 10
  ud_1                 7.564104e-02 1 1  ON 11
  ud_2                -2.647826e-02 1 1  ON 12
  ud_3                -7.930413e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333281e-01 1 1  ON 15
  ud_6                -1.264016e-01 1 1  ON 16
  ud_7                -8.460456e-02 1 1  ON 17
  ud_8                -6.256909e-03 1 1  ON 18
  ud_9                 8.581223e-02 1 1  ON 19
  eO_0                -7.034949e-01 1 1  ON 20
  eO_1                -4.202659e-01 1 1  ON 21
  eO_2                -4.180120e-02 1 1  ON 22
  eO_3                 1.844438e-01 1 1  ON 23
  eO_4                 2.569169e-01 1 1  ON 24
  eO_5                 2.798437e-01 1 1  ON 25
  eO_6                 2.508572e-01 1 1  ON 26
  eO_7                 1.335201e-01 1 1  ON 27
  eO_8                 2.929591e-02 1 1  ON 28
  eO_9                 1.920095e-02 1 1  ON 29
 eH1_0                -2.017298e-01 1 1  ON 30
 eH1_1                -9.604209e-02 1 1  ON 31
 eH1_2                -4.456925e-02 1 1  ON 32
 eH1_3                -1.424132e-02 1 1  ON 33
 eH1_4                 1.808383e-02 1 1  ON 34
 eH1_5                 2.186519e-02 1 1  ON 35
 eH1_6                 7.089973e-02 1 1  ON 36
 eH1_7                 1.025489e-01 1 1  ON 37
 eH1_8                 1.010689e-01 1 1  ON 38
 eH1_9                 2.609449e-02 1 1  ON 39
 eH2_0                -2.031727e-01 1 1  ON 40
 eH2_1                -9.764748e-02 1 1  ON 41
 eH2_2                -4.626960e-02 1 1  ON 42
 eH2_3                -1.570833e-02 1 1  ON 43
 eH2_4                 1.609678e-02 1 1  ON 44
 eH2_5                 1.955067e-02 1 1  ON 45
 eH2_6                 7.199680e-02 1 1  ON 46
 eH2_7                 1.099045e-01 1 1  ON 47
 eH2_8                 1.035747e-01 1 1  ON 48
 eH2_9                 2.896416e-02 1 1  ON 49
ci_001                -4.165778e-02 3 1  ON 50
ci_002                -3.094293e-02 3 1  ON 51
ci_003                -1.140044e-02 3 1  ON 52
ci_004                 2.557778e-02 3 1  ON 53
ci_005                 2.573441e-02 3 1  ON 54
ci_006                -2.021031e-02 3 1  ON 55
ci_007                -1.979887e-02 3 1  ON 56
ci_008                -4.050263e-03 3 1  ON 57
ci_009                -1.516938e-02 3 1  ON 58
ci_010                -9.528224e-03 3 1  ON 59
ci_011                -9.638183e-03 3 1  ON 60
ci_012                -9.626744e-03 3 1  ON 61
ci_013                -2.166317e-02 3 1  ON 62
ci_014                 1.333042e-02 3 1  ON 63
ci_015                 1.313650e-02 3 1  ON 64
ci_016                 1.627942e-02 3 1  ON 65
ci_017                 1.612053e-02 3 1  ON 66
ci_018                 1.085997e-02 3 1  ON 67
ci_019                 1.052271e-02 3 1  ON 68
ci_020                 1.847021e-02 3 1  ON 69
ci_021                 1.812563e-02 3 1  ON 70
ci_022                 1.026986e-02 3 1  ON 71
ci_023                 1.028368e-02 3 1  ON 72
ci_024                 6.710595e-03 3 1  ON 73
ci_025                 6.514234e-03 3 1  ON 74
ci_026                 1.187469e-02 3 1  ON 75
ci_027                 1.184153e-02 3 1  ON 76
ci_028                -9.175560e-03 3 1  ON 77
ci_029                -9.753476e-03 3 1  ON 78
ci_030                -4.996165e-03 3 1  ON 79
ci_031                -4.663255e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.122
    reference variance = 0.167921
====================================================
  Execution time = 1.9212e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9819e-01
  Total weights = 1.9738e+06
  Execution time = 1.6012e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288999853513
                                         uncertainty =       0.001705329422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288999853513
                                         uncertainty =       0.001705329422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380107188
  error estimate for blocks of size 2^( 2) =       0.000395346267
  error estimate for blocks of size 2^( 3) =       0.000409160412
  error estimate for blocks of size 2^( 4) =       0.000419520253
  error estimate for blocks of size 2^( 5) =       0.000425795880
  error estimate for blocks of size 2^( 6) =       0.000430356460
  error estimate for blocks of size 2^( 7) =       0.000432654146

      target function =      -0.915565422002
              le_mean =     -17.206593679042
             les_mean =     296.365058731602
             stat err =       0.000427081685
             autocorr =       1.262437042872
   target nu stat err =       0.000427081685
   target dn stat err =       0.002744730522
      target stat err =       0.004318136045
              std dev =       0.537552740600
             le_variance =       0.288962948927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288999896736
                                         uncertainty =       0.001705336862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288999896736
                                         uncertainty =       0.001705336862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380107216
  error estimate for blocks of size 2^( 2) =       0.000395346284
  error estimate for blocks of size 2^( 3) =       0.000409160417
  error estimate for blocks of size 2^( 4) =       0.000419520246
  error estimate for blocks of size 2^( 5) =       0.000425795861
  error estimate for blocks of size 2^( 6) =       0.000430356440
  error estimate for blocks of size 2^( 7) =       0.000432654105

      target function =      -0.915565921394
              le_mean =     -17.206593682426
             les_mean =     296.365058525740
             stat err =       0.000427081663
             autocorr =       1.262436728964
   target nu stat err =       0.000427081663
   target dn stat err =       0.002744758732
      target stat err =       0.004318183848
              std dev =       0.537552780330
             le_variance =       0.288962991641

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288999875122
                                         uncertainty =       0.001705333142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288999875122
                                         uncertainty =       0.001705333142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380107202
  error estimate for blocks of size 2^( 2) =       0.000395346275
  error estimate for blocks of size 2^( 3) =       0.000409160415
  error estimate for blocks of size 2^( 4) =       0.000419520249
  error estimate for blocks of size 2^( 5) =       0.000425795871
  error estimate for blocks of size 2^( 6) =       0.000430356450
  error estimate for blocks of size 2^( 7) =       0.000432654125

      target function =      -0.915565674365
              le_mean =     -17.206593680733
             les_mean =     296.365058626925
             stat err =       0.000427081674
             autocorr =       1.262436885886
   target nu stat err =       0.000427081674
   target dn stat err =       0.002744744620
      target stat err =       0.004318159961
              std dev =       0.537552760464
             le_variance =       0.288962970282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288999856213
                                         uncertainty =       0.001705329887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288999856213
                                         uncertainty =       0.001705329887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380107190
  error estimate for blocks of size 2^( 2) =       0.000395346268
  error estimate for blocks of size 2^( 3) =       0.000409160413
  error estimate for blocks of size 2^( 4) =       0.000419520252
  error estimate for blocks of size 2^( 5) =       0.000425795879
  error estimate for blocks of size 2^( 6) =       0.000430356459
  error estimate for blocks of size 2^( 7) =       0.000432654143

      target function =      -0.915565453840
              le_mean =     -17.206593679254
             les_mean =     296.365058718325
             stat err =       0.000427081683
             autocorr =       1.262437023245
   target nu stat err =       0.000427081683
   target dn stat err =       0.002744732283
      target stat err =       0.004318139036
              std dev =       0.537552743082
             le_variance =       0.288962951595


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915565422002        initial
     2.2204e+02     2.2204e+03             1.2777e-06        -0.915565921394  <--
     8.8818e+02     8.8818e+03             3.1943e-07        -0.915565674365
     3.5527e+03     3.5527e+04             7.9857e-08        -0.915565453840

*****************************************************************************
Applying the update for shift_i =   2.2204e+02     and shift_s =   2.2204e+03
*****************************************************************************

  Execution time = 2.7120e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
  uu_0                 2.099661e-01 1 1  ON 0
  uu_1                 5.297248e-02 1 1  ON 1
  uu_2                -3.786918e-02 1 1  ON 2
  uu_3                -9.122430e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298133e-01 1 1  ON 5
  uu_6                -1.125654e-01 1 1  ON 6
  uu_7                -5.674050e-02 1 1  ON 7
  uu_8                 5.807042e-02 1 1  ON 8
  uu_9                 1.245061e-01 1 1  ON 9
  ud_0                 3.048776e-01 1 1  ON 10
  ud_1                 7.564083e-02 1 1  ON 11
  ud_2                -2.647841e-02 1 1  ON 12
  ud_3                -7.930427e-02 1 1  ON 13
  ud_4                -1.150112e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264024e-01 1 1  ON 16
  ud_7                -8.460436e-02 1 1  ON 17
  ud_8                -6.256379e-03 1 1  ON 18
  ud_9                 8.581248e-02 1 1  ON 19
  eO_0                -7.034955e-01 1 1  ON 20
  eO_1                -4.202662e-01 1 1  ON 21
  eO_2                -4.180149e-02 1 1  ON 22
  eO_3                 1.844436e-01 1 1  ON 23
  eO_4                 2.569168e-01 1 1  ON 24
  eO_5                 2.798438e-01 1 1  ON 25
  eO_6                 2.508573e-01 1 1  ON 26
  eO_7                 1.335210e-01 1 1  ON 27
  eO_8                 2.929629e-02 1 1  ON 28
  eO_9                 1.920097e-02 1 1  ON 29
 eH1_0                -2.017294e-01 1 1  ON 30
 eH1_1                -9.604192e-02 1 1  ON 31
 eH1_2                -4.456912e-02 1 1  ON 32
 eH1_3                -1.424126e-02 1 1  ON 33
 eH1_4                 1.808391e-02 1 1  ON 34
 eH1_5                 2.186451e-02 1 1  ON 35
 eH1_6                 7.089887e-02 1 1  ON 36
 eH1_7                 1.025490e-01 1 1  ON 37
 eH1_8                 1.010694e-01 1 1  ON 38
 eH1_9                 2.609462e-02 1 1  ON 39
 eH2_0                -2.031724e-01 1 1  ON 40
 eH2_1                -9.764769e-02 1 1  ON 41
 eH2_2                -4.626973e-02 1 1  ON 42
 eH2_3                -1.570864e-02 1 1  ON 43
 eH2_4                 1.609668e-02 1 1  ON 44
 eH2_5                 1.955091e-02 1 1  ON 45
 eH2_6                 7.199618e-02 1 1  ON 46
 eH2_7                 1.099043e-01 1 1  ON 47
 eH2_8                 1.035754e-01 1 1  ON 48
 eH2_9                 2.896433e-02 1 1  ON 49
ci_001                -4.165791e-02 3 1  ON 50
ci_002                -3.094293e-02 3 1  ON 51
ci_003                -1.140016e-02 3 1  ON 52
ci_004                 2.557791e-02 3 1  ON 53
ci_005                 2.573446e-02 3 1  ON 54
ci_006                -2.021030e-02 3 1  ON 55
ci_007                -1.979891e-02 3 1  ON 56
ci_008                -4.050367e-03 3 1  ON 57
ci_009                -1.516935e-02 3 1  ON 58
ci_010                -9.528244e-03 3 1  ON 59
ci_011                -9.637837e-03 3 1  ON 60
ci_012                -9.626576e-03 3 1  ON 61
ci_013                -2.166329e-02 3 1  ON 62
ci_014                 1.333051e-02 3 1  ON 63
ci_015                 1.313651e-02 3 1  ON 64
ci_016                 1.627937e-02 3 1  ON 65
ci_017                 1.612043e-02 3 1  ON 66
ci_018                 1.085985e-02 3 1  ON 67
ci_019                 1.052277e-02 3 1  ON 68
ci_020                 1.847030e-02 3 1  ON 69
ci_021                 1.812547e-02 3 1  ON 70
ci_022                 1.026971e-02 3 1  ON 71
ci_023                 1.028362e-02 3 1  ON 72
ci_024                 6.710328e-03 3 1  ON 73
ci_025                 6.514604e-03 3 1  ON 74
ci_026                 1.187443e-02 3 1  ON 75
ci_027                 1.184161e-02 3 1  ON 76
ci_028                -9.175722e-03 3 1  ON 77
ci_029                -9.753429e-03 3 1  ON 78
ci_030                -4.996129e-03 3 1  ON 79
ci_031                -4.662864e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1906e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.1185
    reference variance = 0.158642
====================================================
  Execution time = 1.9236e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5426e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9732e-01
  Total weights = 1.973853545e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289490985953
                                         uncertainty =       0.001939184755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289490985953
                                         uncertainty =       0.001939184755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380451490
  error estimate for blocks of size 2^( 2) =       0.000395853550
  error estimate for blocks of size 2^( 3) =       0.000409894192
  error estimate for blocks of size 2^( 4) =       0.000419266868
  error estimate for blocks of size 2^( 5) =       0.000424465038
  error estimate for blocks of size 2^( 6) =       0.000428293868
  error estimate for blocks of size 2^( 7) =       0.000429716940

      target function =      -0.916934831619
              le_mean =     -17.206403928587
             les_mean =     296.357651535140
             stat err =       0.000425435678
             autocorr =       1.250458369320
   target nu stat err =       0.000425435678
   target dn stat err =       0.002451676023
      target stat err =       0.003880267490
              std dev =       0.538039657295
             le_variance =       0.289486672822


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720640392859e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+01, overlap shift 5.5511e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916950098238       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916950469760       residual = 9.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916950547200       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916950562084       residual = 9.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916950574680       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916950574519       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916950577116       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916950579152       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916950580593       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916950583232       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916950586780       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916950590044       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916950596308       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916950598005       residual = 9.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916950601448       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916950600861       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916950601150       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916950602745       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916950603959       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916950604011       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916950603864       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916950603474       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916950603942       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916950604482       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916950603981       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916950604501       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916950604153       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916950604123       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916950604385       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916950604360       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916950604532       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916950604449       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916950604381       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916950604315       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916950604191       residual = 9.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.5511e+01 is 6.210402e-06

solving harmonic davidson linear method for identity shift 2.2204e+02, overlap shift 2.2204e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916950098238       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916950191216       residual = 9.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916950210592       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916950214317       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916950217469       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916950217428       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916950218077       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916950218587       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916950218948       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916950219607       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916950220496       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916950221312       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916950222878       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916950223302       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916950224163       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916950224016       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916950224088       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916950224487       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916950224791       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916950224804       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916950224766       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916950224669       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916950224786       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916950224921       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916950224795       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916950224925       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916950224838       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916950224831       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916950224897       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916950224889       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916950224933       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916950224912       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916950224897       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916950224878       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916950224848       residual = 9.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.2204e+02 is 1.553354e-06

solving harmonic davidson linear method for identity shift 8.8818e+02, overlap shift 8.8818e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916950098238       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916950121489       residual = 9.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916950126334       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916950127265       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916950128053       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916950128043       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916950128206       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916950128333       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916950128423       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916950128588       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916950128811       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916950129015       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916950129405       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916950129511       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916950129727       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916950129690       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916950129708       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916950129808       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916950129884       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916950129889       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916950129878       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916950129852       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916950129880       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916950129916       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916950129883       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916950129918       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916950129899       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916950129892       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916950129913       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916950129910       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916950129920       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916950129912       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916950129912       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916950129904       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916950129896       residual = 9.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.8818e+02 is 3.883856e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               3.968172 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4762e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
  uu_0                 2.099658e-01 1 1  ON 0
  uu_1                 5.297250e-02 1 1  ON 1
  uu_2                -3.786920e-02 1 1  ON 2
  uu_3                -9.122442e-02 1 1  ON 3
  uu_4                -1.219423e-01 1 1  ON 4
  uu_5                -1.298142e-01 1 1  ON 5
  uu_6                -1.125655e-01 1 1  ON 6
  uu_7                -5.673894e-02 1 1  ON 7
  uu_8                 5.807045e-02 1 1  ON 8
  uu_9                 1.245060e-01 1 1  ON 9
  ud_0                 3.048775e-01 1 1  ON 10
  ud_1                 7.564055e-02 1 1  ON 11
  ud_2                -2.647844e-02 1 1  ON 12
  ud_3                -7.930411e-02 1 1  ON 13
  ud_4                -1.150110e-01 1 1  ON 14
  ud_5                -1.333286e-01 1 1  ON 15
  ud_6                -1.264027e-01 1 1  ON 16
  ud_7                -8.460394e-02 1 1  ON 17
  ud_8                -6.256175e-03 1 1  ON 18
  ud_9                 8.581210e-02 1 1  ON 19
  eO_0                -7.034964e-01 1 1  ON 20
  eO_1                -4.202670e-01 1 1  ON 21
  eO_2                -4.180237e-02 1 1  ON 22
  eO_3                 1.844434e-01 1 1  ON 23
  eO_4                 2.569175e-01 1 1  ON 24
  eO_5                 2.798450e-01 1 1  ON 25
  eO_6                 2.508570e-01 1 1  ON 26
  eO_7                 1.335218e-01 1 1  ON 27
  eO_8                 2.929644e-02 1 1  ON 28
  eO_9                 1.920097e-02 1 1  ON 29
 eH1_0                -2.017291e-01 1 1  ON 30
 eH1_1                -9.604169e-02 1 1  ON 31
 eH1_2                -4.456893e-02 1 1  ON 32
 eH1_3                -1.424139e-02 1 1  ON 33
 eH1_4                 1.808379e-02 1 1  ON 34
 eH1_5                 2.186441e-02 1 1  ON 35
 eH1_6                 7.089894e-02 1 1  ON 36
 eH1_7                 1.025483e-01 1 1  ON 37
 eH1_8                 1.010695e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031724e-01 1 1  ON 40
 eH2_1                -9.764791e-02 1 1  ON 41
 eH2_2                -4.626993e-02 1 1  ON 42
 eH2_3                -1.570872e-02 1 1  ON 43
 eH2_4                 1.609658e-02 1 1  ON 44
 eH2_5                 1.955024e-02 1 1  ON 45
 eH2_6                 7.199670e-02 1 1  ON 46
 eH2_7                 1.099044e-01 1 1  ON 47
 eH2_8                 1.035760e-01 1 1  ON 48
 eH2_9                 2.896437e-02 1 1  ON 49
ci_001                -4.165812e-02 3 1  ON 50
ci_002                -3.094302e-02 3 1  ON 51
ci_003                -1.139980e-02 3 1  ON 52
ci_004                 2.557795e-02 3 1  ON 53
ci_005                 2.573420e-02 3 1  ON 54
ci_006                -2.021031e-02 3 1  ON 55
ci_007                -1.979916e-02 3 1  ON 56
ci_008                -4.050813e-03 3 1  ON 57
ci_009                -1.516934e-02 3 1  ON 58
ci_010                -9.527762e-03 3 1  ON 59
ci_011                -9.637994e-03 3 1  ON 60
ci_012                -9.626902e-03 3 1  ON 61
ci_013                -2.166327e-02 3 1  ON 62
ci_014                 1.333070e-02 3 1  ON 63
ci_015                 1.313641e-02 3 1  ON 64
ci_016                 1.627939e-02 3 1  ON 65
ci_017                 1.612050e-02 3 1  ON 66
ci_018                 1.085961e-02 3 1  ON 67
ci_019                 1.052280e-02 3 1  ON 68
ci_020                 1.847039e-02 3 1  ON 69
ci_021                 1.812545e-02 3 1  ON 70
ci_022                 1.026964e-02 3 1  ON 71
ci_023                 1.028364e-02 3 1  ON 72
ci_024                 6.710599e-03 3 1  ON 73
ci_025                 6.514573e-03 3 1  ON 74
ci_026                 1.187388e-02 3 1  ON 75
ci_027                 1.184172e-02 3 1  ON 76
ci_028                -9.176040e-03 3 1  ON 77
ci_029                -9.753444e-03 3 1  ON 78
ci_030                -4.996027e-03 3 1  ON 79
ci_031                -4.662808e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.201
    reference variance = 0.255201
====================================================
  Execution time = 1.8905e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9527e-01
  Total weights = 1.9738e+06
  Execution time = 1.5950e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287034293902
                                         uncertainty =       0.001705652872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287034293902
                                         uncertainty =       0.001705652872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378822087
  error estimate for blocks of size 2^( 2) =       0.000393877735
  error estimate for blocks of size 2^( 3) =       0.000408158185
  error estimate for blocks of size 2^( 4) =       0.000418290188
  error estimate for blocks of size 2^( 5) =       0.000425760991
  error estimate for blocks of size 2^( 6) =       0.000429730119
  error estimate for blocks of size 2^( 7) =       0.000430062755

      target function =      -0.920114167889
              le_mean =     -17.207243503634
             les_mean =     296.384501259534
             stat err =       0.000425961013
             autocorr =       1.264355253049
   target nu stat err =       0.000425961013
   target dn stat err =       0.002480209173
      target stat err =       0.003956982705
              std dev =       0.535735333722
             le_variance =       0.287012347798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287034072472
                                         uncertainty =       0.001705654685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287034072472
                                         uncertainty =       0.001705654685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378821944
  error estimate for blocks of size 2^( 2) =       0.000393877572
  error estimate for blocks of size 2^( 3) =       0.000408158031
  error estimate for blocks of size 2^( 4) =       0.000418290016
  error estimate for blocks of size 2^( 5) =       0.000425760848
  error estimate for blocks of size 2^( 6) =       0.000429729994
  error estimate for blocks of size 2^( 7) =       0.000430062625

      target function =      -0.920113677745
              le_mean =     -17.207243502587
             les_mean =     296.384501531031
             stat err =       0.000425960871
             autocorr =       1.264355365714
   target nu stat err =       0.000425960871
   target dn stat err =       0.002480803005
      target stat err =       0.003957894061
              std dev =       0.535735130373
             le_variance =       0.287012129915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287034182867
                                         uncertainty =       0.001705653775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287034182867
                                         uncertainty =       0.001705653775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378822015
  error estimate for blocks of size 2^( 2) =       0.000393877653
  error estimate for blocks of size 2^( 3) =       0.000408158107
  error estimate for blocks of size 2^( 4) =       0.000418290102
  error estimate for blocks of size 2^( 5) =       0.000425760919
  error estimate for blocks of size 2^( 6) =       0.000429730056
  error estimate for blocks of size 2^( 7) =       0.000430062690

      target function =      -0.920113925501
              le_mean =     -17.207243503096
             les_mean =     296.384501393066
             stat err =       0.000425960942
             autocorr =       1.264355309613
   target nu stat err =       0.000425960942
   target dn stat err =       0.002480506152
      target stat err =       0.003957438502
              std dev =       0.535735231750
             le_variance =       0.287012238538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287034279999
                                         uncertainty =       0.001705652985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287034279999
                                         uncertainty =       0.001705652985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378822078
  error estimate for blocks of size 2^( 2) =       0.000393877724
  error estimate for blocks of size 2^( 3) =       0.000408158175
  error estimate for blocks of size 2^( 4) =       0.000418290177
  error estimate for blocks of size 2^( 5) =       0.000425760982
  error estimate for blocks of size 2^( 6) =       0.000429730111
  error estimate for blocks of size 2^( 7) =       0.000430062747

      target function =      -0.920114137901
              le_mean =     -17.207243503565
             les_mean =     296.384501275965
             stat err =       0.000425961004
             autocorr =       1.264355260135
   target nu stat err =       0.000425961004
   target dn stat err =       0.002480246281
      target stat err =       0.003957039660
              std dev =       0.535735320954
             le_variance =       0.287012334117


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920114167889        initial  <--
     5.5511e+01     5.5511e+02             6.2104e-06        -0.920113677745
     2.2204e+02     2.2204e+03             1.5534e-06        -0.920113925501
     8.8818e+02     8.8818e+03             3.8839e-07        -0.920114137901

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.8183
  </log>
  <optVariables href="H2O.s069.opt.xml">
  uu_0                 2.099661e-01 1 1  ON 0
  uu_1                 5.297248e-02 1 1  ON 1
  uu_2                -3.786918e-02 1 1  ON 2
  uu_3                -9.122430e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298133e-01 1 1  ON 5
  uu_6                -1.125654e-01 1 1  ON 6
  uu_7                -5.674050e-02 1 1  ON 7
  uu_8                 5.807042e-02 1 1  ON 8
  uu_9                 1.245061e-01 1 1  ON 9
  ud_0                 3.048776e-01 1 1  ON 10
  ud_1                 7.564083e-02 1 1  ON 11
  ud_2                -2.647841e-02 1 1  ON 12
  ud_3                -7.930427e-02 1 1  ON 13
  ud_4                -1.150112e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264024e-01 1 1  ON 16
  ud_7                -8.460436e-02 1 1  ON 17
  ud_8                -6.256379e-03 1 1  ON 18
  ud_9                 8.581248e-02 1 1  ON 19
  eO_0                -7.034955e-01 1 1  ON 20
  eO_1                -4.202662e-01 1 1  ON 21
  eO_2                -4.180149e-02 1 1  ON 22
  eO_3                 1.844436e-01 1 1  ON 23
  eO_4                 2.569168e-01 1 1  ON 24
  eO_5                 2.798438e-01 1 1  ON 25
  eO_6                 2.508573e-01 1 1  ON 26
  eO_7                 1.335210e-01 1 1  ON 27
  eO_8                 2.929629e-02 1 1  ON 28
  eO_9                 1.920097e-02 1 1  ON 29
 eH1_0                -2.017294e-01 1 1  ON 30
 eH1_1                -9.604192e-02 1 1  ON 31
 eH1_2                -4.456912e-02 1 1  ON 32
 eH1_3                -1.424126e-02 1 1  ON 33
 eH1_4                 1.808391e-02 1 1  ON 34
 eH1_5                 2.186451e-02 1 1  ON 35
 eH1_6                 7.089887e-02 1 1  ON 36
 eH1_7                 1.025490e-01 1 1  ON 37
 eH1_8                 1.010694e-01 1 1  ON 38
 eH1_9                 2.609462e-02 1 1  ON 39
 eH2_0                -2.031724e-01 1 1  ON 40
 eH2_1                -9.764769e-02 1 1  ON 41
 eH2_2                -4.626973e-02 1 1  ON 42
 eH2_3                -1.570864e-02 1 1  ON 43
 eH2_4                 1.609668e-02 1 1  ON 44
 eH2_5                 1.955091e-02 1 1  ON 45
 eH2_6                 7.199618e-02 1 1  ON 46
 eH2_7                 1.099043e-01 1 1  ON 47
 eH2_8                 1.035754e-01 1 1  ON 48
 eH2_9                 2.896433e-02 1 1  ON 49
ci_001                -4.165791e-02 3 1  ON 50
ci_002                -3.094293e-02 3 1  ON 51
ci_003                -1.140016e-02 3 1  ON 52
ci_004                 2.557791e-02 3 1  ON 53
ci_005                 2.573446e-02 3 1  ON 54
ci_006                -2.021030e-02 3 1  ON 55
ci_007                -1.979891e-02 3 1  ON 56
ci_008                -4.050367e-03 3 1  ON 57
ci_009                -1.516935e-02 3 1  ON 58
ci_010                -9.528244e-03 3 1  ON 59
ci_011                -9.637837e-03 3 1  ON 60
ci_012                -9.626576e-03 3 1  ON 61
ci_013                -2.166329e-02 3 1  ON 62
ci_014                 1.333051e-02 3 1  ON 63
ci_015                 1.313651e-02 3 1  ON 64
ci_016                 1.627937e-02 3 1  ON 65
ci_017                 1.612043e-02 3 1  ON 66
ci_018                 1.085985e-02 3 1  ON 67
ci_019                 1.052277e-02 3 1  ON 68
ci_020                 1.847030e-02 3 1  ON 69
ci_021                 1.812547e-02 3 1  ON 70
ci_022                 1.026971e-02 3 1  ON 71
ci_023                 1.028362e-02 3 1  ON 72
ci_024                 6.710328e-03 3 1  ON 73
ci_025                 6.514604e-03 3 1  ON 74
ci_026                 1.187443e-02 3 1  ON 75
ci_027                 1.184161e-02 3 1  ON 76
ci_028                -9.175722e-03 3 1  ON 77
ci_029                -9.753429e-03 3 1  ON 78
ci_030                -4.996129e-03 3 1  ON 79
ci_031                -4.662864e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1588e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.1599
    reference variance = 0.226039
====================================================
  Execution time = 1.9068e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5392e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9580e-01
  Total weights = 1.973513111e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5451e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288542398841
                                         uncertainty =       0.002021004652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288542398841
                                         uncertainty =       0.002021004652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379830869
  error estimate for blocks of size 2^( 2) =       0.000395157674
  error estimate for blocks of size 2^( 3) =       0.000409482956
  error estimate for blocks of size 2^( 4) =       0.000419896911
  error estimate for blocks of size 2^( 5) =       0.000426870000
  error estimate for blocks of size 2^( 6) =       0.000431166824
  error estimate for blocks of size 2^( 7) =       0.000433624989

      target function =      -0.919292782636
              le_mean =     -17.205861552827
             les_mean =     296.337475443866
             stat err =       0.000427889681
             autocorr =       1.269062794693
   target nu stat err =       0.000427889681
   target dn stat err =       0.002741223691
      target stat err =       0.004341814480
              std dev =       0.537161966413
             le_variance =       0.288542978161


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720586155283e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+02, overlap shift 5.5511e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919312045593       residual = 4.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919312072600       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919312081248       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919312083019       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919312083570       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919312084146       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919312084228       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919312084440       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919312084895       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919312084733       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919312084759       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919312085081       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919312085145       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919312084906       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919312085024       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919312085206       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919312085232       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919312085265       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919312085467       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919312085420       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919312085450       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919312085422       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919312085437       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919312085505       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919312085476       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919312085472       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919312085472       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919312085519       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919312085532       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919312085546       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919312085542       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919312085579       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919312085575       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919312085574       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.5511e+02 is 6.115831e-07

solving harmonic davidson linear method for identity shift 2.2204e+03, overlap shift 2.2204e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919312045593       residual = 4.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919312052345       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919312054507       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919312054950       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919312055088       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919312055234       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919312055250       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919312055306       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919312055422       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919312055374       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919312055385       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919312055465       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919312055479       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919312055426       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919312055448       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919312055499       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919312055499       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919312055519       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919312055561       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919312055548       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919312055571       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919312055559       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919312055553       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919312055575       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919312055567       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919312055556       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919312055559       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919312055573       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919312055583       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919312055573       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919312055580       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919312055590       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919312055591       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919312055589       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.2204e+03 is 1.528968e-07

solving harmonic davidson linear method for identity shift 8.8818e+03, overlap shift 8.8818e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919312045593       residual = 4.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919312047281       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919312047821       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919312047932       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919312047966       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919312048006       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919312047986       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919312048029       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919312048046       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919312048009       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919312048042       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919312048060       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919312048062       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919312048053       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919312048074       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919312048056       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919312048078       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919312048072       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919312048113       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919312048074       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919312048097       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919312048053       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919312048079       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919312048120       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919312048093       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919312048063       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919312048088       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919312048067       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919312048077       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919312048060       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919312048071       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919312048053       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919312048106       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919312048119       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.8818e+03 is 3.822426e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.009741 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4660e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
  uu_0                 2.099662e-01 1 1  ON 0
  uu_1                 5.297255e-02 1 1  ON 1
  uu_2                -3.786913e-02 1 1  ON 2
  uu_3                -9.122427e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298133e-01 1 1  ON 5
  uu_6                -1.125654e-01 1 1  ON 6
  uu_7                -5.674059e-02 1 1  ON 7
  uu_8                 5.807027e-02 1 1  ON 8
  uu_9                 1.245061e-01 1 1  ON 9
  ud_0                 3.048776e-01 1 1  ON 10
  ud_1                 7.564080e-02 1 1  ON 11
  ud_2                -2.647842e-02 1 1  ON 12
  ud_3                -7.930427e-02 1 1  ON 13
  ud_4                -1.150112e-01 1 1  ON 14
  ud_5                -1.333284e-01 1 1  ON 15
  ud_6                -1.264024e-01 1 1  ON 16
  ud_7                -8.460436e-02 1 1  ON 17
  ud_8                -6.256393e-03 1 1  ON 18
  ud_9                 8.581243e-02 1 1  ON 19
  eO_0                -7.034956e-01 1 1  ON 20
  eO_1                -4.202662e-01 1 1  ON 21
  eO_2                -4.180149e-02 1 1  ON 22
  eO_3                 1.844436e-01 1 1  ON 23
  eO_4                 2.569168e-01 1 1  ON 24
  eO_5                 2.798437e-01 1 1  ON 25
  eO_6                 2.508572e-01 1 1  ON 26
  eO_7                 1.335211e-01 1 1  ON 27
  eO_8                 2.929630e-02 1 1  ON 28
  eO_9                 1.920098e-02 1 1  ON 29
 eH1_0                -2.017294e-01 1 1  ON 30
 eH1_1                -9.604196e-02 1 1  ON 31
 eH1_2                -4.456918e-02 1 1  ON 32
 eH1_3                -1.424129e-02 1 1  ON 33
 eH1_4                 1.808389e-02 1 1  ON 34
 eH1_5                 2.186454e-02 1 1  ON 35
 eH1_6                 7.089890e-02 1 1  ON 36
 eH1_7                 1.025490e-01 1 1  ON 37
 eH1_8                 1.010694e-01 1 1  ON 38
 eH1_9                 2.609465e-02 1 1  ON 39
 eH2_0                -2.031724e-01 1 1  ON 40
 eH2_1                -9.764770e-02 1 1  ON 41
 eH2_2                -4.626977e-02 1 1  ON 42
 eH2_3                -1.570869e-02 1 1  ON 43
 eH2_4                 1.609668e-02 1 1  ON 44
 eH2_5                 1.955093e-02 1 1  ON 45
 eH2_6                 7.199623e-02 1 1  ON 46
 eH2_7                 1.099043e-01 1 1  ON 47
 eH2_8                 1.035754e-01 1 1  ON 48
 eH2_9                 2.896435e-02 1 1  ON 49
ci_001                -4.165792e-02 3 1  ON 50
ci_002                -3.094293e-02 3 1  ON 51
ci_003                -1.140014e-02 3 1  ON 52
ci_004                 2.557793e-02 3 1  ON 53
ci_005                 2.573443e-02 3 1  ON 54
ci_006                -2.021031e-02 3 1  ON 55
ci_007                -1.979890e-02 3 1  ON 56
ci_008                -4.050360e-03 3 1  ON 57
ci_009                -1.516936e-02 3 1  ON 58
ci_010                -9.528221e-03 3 1  ON 59
ci_011                -9.637868e-03 3 1  ON 60
ci_012                -9.626555e-03 3 1  ON 61
ci_013                -2.166327e-02 3 1  ON 62
ci_014                 1.333052e-02 3 1  ON 63
ci_015                 1.313647e-02 3 1  ON 64
ci_016                 1.627934e-02 3 1  ON 65
ci_017                 1.612042e-02 3 1  ON 66
ci_018                 1.085984e-02 3 1  ON 67
ci_019                 1.052280e-02 3 1  ON 68
ci_020                 1.847030e-02 3 1  ON 69
ci_021                 1.812547e-02 3 1  ON 70
ci_022                 1.026969e-02 3 1  ON 71
ci_023                 1.028363e-02 3 1  ON 72
ci_024                 6.710303e-03 3 1  ON 73
ci_025                 6.514613e-03 3 1  ON 74
ci_026                 1.187438e-02 3 1  ON 75
ci_027                 1.184161e-02 3 1  ON 76
ci_028                -9.175716e-03 3 1  ON 77
ci_029                -9.753421e-03 3 1  ON 78
ci_030                -4.996111e-03 3 1  ON 79
ci_031                -4.662865e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.1827
    reference variance = 0.293329
====================================================
  Execution time = 1.9132e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9648e-01
  Total weights = 1.9736e+06
  Execution time = 1.5944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290160144222
                                         uncertainty =       0.001452071979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290160144222
                                         uncertainty =       0.001452071979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380927620
  error estimate for blocks of size 2^( 2) =       0.000395981831
  error estimate for blocks of size 2^( 3) =       0.000410396795
  error estimate for blocks of size 2^( 4) =       0.000420461214
  error estimate for blocks of size 2^( 5) =       0.000428016453
  error estimate for blocks of size 2^( 6) =       0.000430294159
  error estimate for blocks of size 2^( 7) =       0.000431904778

      target function =      -0.918229969873
              le_mean =     -17.207090377296
             les_mean =     296.380441257646
             stat err =       0.000427669151
             autocorr =       1.260465382531
   target nu stat err =       0.000427669151
   target dn stat err =       0.001882140978
      target stat err =       0.003027543790
              std dev =       0.538713006125
             le_variance =       0.290211702969

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290160147526
                                         uncertainty =       0.001452073965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290160147526
                                         uncertainty =       0.001452073965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380927622
  error estimate for blocks of size 2^( 2) =       0.000395981827
  error estimate for blocks of size 2^( 3) =       0.000410396785
  error estimate for blocks of size 2^( 4) =       0.000420461200
  error estimate for blocks of size 2^( 5) =       0.000428016431
  error estimate for blocks of size 2^( 6) =       0.000430294139
  error estimate for blocks of size 2^( 7) =       0.000431904765

      target function =      -0.918227883778
              le_mean =     -17.207090376959
             les_mean =     296.380442581644
             stat err =       0.000427669134
             autocorr =       1.260465265851
   target nu stat err =       0.000427669134
   target dn stat err =       0.001882210287
      target stat err =       0.003027635479
              std dev =       0.538713009773
             le_variance =       0.290211706899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290160145873
                                         uncertainty =       0.001452072972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290160145873
                                         uncertainty =       0.001452072972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380927621
  error estimate for blocks of size 2^( 2) =       0.000395981829
  error estimate for blocks of size 2^( 3) =       0.000410396790
  error estimate for blocks of size 2^( 4) =       0.000420461207
  error estimate for blocks of size 2^( 5) =       0.000428016442
  error estimate for blocks of size 2^( 6) =       0.000430294149
  error estimate for blocks of size 2^( 7) =       0.000431904772

      target function =      -0.918228932536
              le_mean =     -17.207090377128
             les_mean =     296.380441915980
             stat err =       0.000427669142
             autocorr =       1.260465324186
   target nu stat err =       0.000427669142
   target dn stat err =       0.001882175342
      target stat err =       0.003027589231
              std dev =       0.538713007948
             le_variance =       0.290211704933

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290160144428
                                         uncertainty =       0.001452072103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290160144428
                                         uncertainty =       0.001452072103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380927620
  error estimate for blocks of size 2^( 2) =       0.000395981831
  error estimate for blocks of size 2^( 3) =       0.000410396795
  error estimate for blocks of size 2^( 4) =       0.000420461213
  error estimate for blocks of size 2^( 5) =       0.000428016452
  error estimate for blocks of size 2^( 6) =       0.000430294157
  error estimate for blocks of size 2^( 7) =       0.000431904777

      target function =      -0.918229840833
              le_mean =     -17.207090377275
             les_mean =     296.380441339535
             stat err =       0.000427669150
             autocorr =       1.260465375237
   target nu stat err =       0.000427669150
   target dn stat err =       0.001882145242
      target stat err =       0.003027549427
              std dev =       0.538713006353
             le_variance =       0.290211703214


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918229969873        initial  <--
     5.5511e+02     5.5511e+03             6.1158e-07        -0.918227883778
     2.2204e+03     2.2204e+04             1.5290e-07        -0.918228932536
     8.8818e+03     8.8818e+04             3.8224e-08        -0.918229840833

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.0304
  </log>
  <optVariables href="H2O.s070.opt.xml">
  uu_0                 2.099661e-01 1 1  ON 0
  uu_1                 5.297248e-02 1 1  ON 1
  uu_2                -3.786918e-02 1 1  ON 2
  uu_3                -9.122430e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298133e-01 1 1  ON 5
  uu_6                -1.125654e-01 1 1  ON 6
  uu_7                -5.674050e-02 1 1  ON 7
  uu_8                 5.807042e-02 1 1  ON 8
  uu_9                 1.245061e-01 1 1  ON 9
  ud_0                 3.048776e-01 1 1  ON 10
  ud_1                 7.564083e-02 1 1  ON 11
  ud_2                -2.647841e-02 1 1  ON 12
  ud_3                -7.930427e-02 1 1  ON 13
  ud_4                -1.150112e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264024e-01 1 1  ON 16
  ud_7                -8.460436e-02 1 1  ON 17
  ud_8                -6.256379e-03 1 1  ON 18
  ud_9                 8.581248e-02 1 1  ON 19
  eO_0                -7.034955e-01 1 1  ON 20
  eO_1                -4.202662e-01 1 1  ON 21
  eO_2                -4.180149e-02 1 1  ON 22
  eO_3                 1.844436e-01 1 1  ON 23
  eO_4                 2.569168e-01 1 1  ON 24
  eO_5                 2.798438e-01 1 1  ON 25
  eO_6                 2.508573e-01 1 1  ON 26
  eO_7                 1.335210e-01 1 1  ON 27
  eO_8                 2.929629e-02 1 1  ON 28
  eO_9                 1.920097e-02 1 1  ON 29
 eH1_0                -2.017294e-01 1 1  ON 30
 eH1_1                -9.604192e-02 1 1  ON 31
 eH1_2                -4.456912e-02 1 1  ON 32
 eH1_3                -1.424126e-02 1 1  ON 33
 eH1_4                 1.808391e-02 1 1  ON 34
 eH1_5                 2.186451e-02 1 1  ON 35
 eH1_6                 7.089887e-02 1 1  ON 36
 eH1_7                 1.025490e-01 1 1  ON 37
 eH1_8                 1.010694e-01 1 1  ON 38
 eH1_9                 2.609462e-02 1 1  ON 39
 eH2_0                -2.031724e-01 1 1  ON 40
 eH2_1                -9.764769e-02 1 1  ON 41
 eH2_2                -4.626973e-02 1 1  ON 42
 eH2_3                -1.570864e-02 1 1  ON 43
 eH2_4                 1.609668e-02 1 1  ON 44
 eH2_5                 1.955091e-02 1 1  ON 45
 eH2_6                 7.199618e-02 1 1  ON 46
 eH2_7                 1.099043e-01 1 1  ON 47
 eH2_8                 1.035754e-01 1 1  ON 48
 eH2_9                 2.896433e-02 1 1  ON 49
ci_001                -4.165791e-02 3 1  ON 50
ci_002                -3.094293e-02 3 1  ON 51
ci_003                -1.140016e-02 3 1  ON 52
ci_004                 2.557791e-02 3 1  ON 53
ci_005                 2.573446e-02 3 1  ON 54
ci_006                -2.021030e-02 3 1  ON 55
ci_007                -1.979891e-02 3 1  ON 56
ci_008                -4.050367e-03 3 1  ON 57
ci_009                -1.516935e-02 3 1  ON 58
ci_010                -9.528244e-03 3 1  ON 59
ci_011                -9.637837e-03 3 1  ON 60
ci_012                -9.626576e-03 3 1  ON 61
ci_013                -2.166329e-02 3 1  ON 62
ci_014                 1.333051e-02 3 1  ON 63
ci_015                 1.313651e-02 3 1  ON 64
ci_016                 1.627937e-02 3 1  ON 65
ci_017                 1.612043e-02 3 1  ON 66
ci_018                 1.085985e-02 3 1  ON 67
ci_019                 1.052277e-02 3 1  ON 68
ci_020                 1.847030e-02 3 1  ON 69
ci_021                 1.812547e-02 3 1  ON 70
ci_022                 1.026971e-02 3 1  ON 71
ci_023                 1.028362e-02 3 1  ON 72
ci_024                 6.710328e-03 3 1  ON 73
ci_025                 6.514604e-03 3 1  ON 74
ci_026                 1.187443e-02 3 1  ON 75
ci_027                 1.184161e-02 3 1  ON 76
ci_028                -9.175722e-03 3 1  ON 77
ci_029                -9.753429e-03 3 1  ON 78
ci_030                -4.996129e-03 3 1  ON 79
ci_031                -4.662864e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1699e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.2511
    reference variance = 0.241382
====================================================
  Execution time = 1.8867e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5403e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9659e-01
  Total weights = 1.973670695e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4933e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287724684610
                                         uncertainty =       0.001739895007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287724684610
                                         uncertainty =       0.001739895007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379259897
  error estimate for blocks of size 2^( 2) =       0.000394670355
  error estimate for blocks of size 2^( 3) =       0.000408780480
  error estimate for blocks of size 2^( 4) =       0.000419085146
  error estimate for blocks of size 2^( 5) =       0.000424738608
  error estimate for blocks of size 2^( 6) =       0.000427957798
  error estimate for blocks of size 2^( 7) =       0.000429225037

      target function =      -0.918067924320
              le_mean =     -17.206499619220
             les_mean =     296.360216305741
             stat err =       0.000425251647
             autocorr =       1.257239923821
   target nu stat err =       0.000425251647
   target dn stat err =       0.002399769891
      target stat err =       0.003810829758
              std dev =       0.536354490116
             le_variance =       0.287676139068


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720649961922e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+03, overlap shift 5.5511e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918082780054       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918082781813       residual = 8.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918082782462       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918082782539       residual = 8.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918082782570       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918082782565       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918082782552       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918082782611       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918082782662       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918082782644       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918082782722       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918082782728       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918082782819       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918082782800       residual = 8.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918082782812       residual = 5.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918082782811       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918082782795       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918082782812       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918082782812       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918082782833       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918082782831       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918082782828       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918082782852       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918082782858       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918082782863       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918082782848       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918082782851       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918082782861       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918082782859       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918082782873       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918082782870       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918082782857       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918082782864       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918082782884       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918082782865       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.5511e+03 is 8.318762e-08

solving harmonic davidson linear method for identity shift 2.2204e+04, overlap shift 2.2204e+05 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918082780054       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918082780494       residual = 8.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918082780656       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918082780675       residual = 8.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918082780682       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918082780693       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918082780663       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918082780699       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918082780685       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918082780675       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918082780729       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918082780699       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918082780785       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918082780705       residual = 8.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918082780738       residual = 5.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918082780751       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918082780740       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918082780764       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918082780741       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918082780744       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918082780752       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918082780751       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918082780758       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918082780671       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918082780755       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918082780767       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918082780666       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918082780736       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918082780804       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918082780738       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918082780633       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918082780721       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918082780709       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918082780767       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918082780670       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.2204e+04 is 2.079693e-08

solving harmonic davidson linear method for identity shift 8.8818e+04, overlap shift 8.8818e+05 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918082780054       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918082780164       residual = 8.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918082780204       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918082780209       residual = 8.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918082780165       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918082780113       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918082780047       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918082780484       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918082779927       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918082780376       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918082780243       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918082780223       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918082780132       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918082780079       residual = 8.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918082780059       residual = 5.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918082780222       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918082780177       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918082780328       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918082780143       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918082780272       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918082780073       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918082779952       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918082780409       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918082780038       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918082780518       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918082780223       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918082780460       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918082780043       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918082779934       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918082780167       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918082780027       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918082779842       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918082780051       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918082780500       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918082780067       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.8818e+04 is 5.199235e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.055083 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4412e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
  uu_0                 2.099661e-01 1 1  ON 0
  uu_1                 5.297248e-02 1 1  ON 1
  uu_2                -3.786917e-02 1 1  ON 2
  uu_3                -9.122430e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298133e-01 1 1  ON 5
  uu_6                -1.125654e-01 1 1  ON 6
  uu_7                -5.674050e-02 1 1  ON 7
  uu_8                 5.807040e-02 1 1  ON 8
  uu_9                 1.245061e-01 1 1  ON 9
  ud_0                 3.048776e-01 1 1  ON 10
  ud_1                 7.564083e-02 1 1  ON 11
  ud_2                -2.647841e-02 1 1  ON 12
  ud_3                -7.930427e-02 1 1  ON 13
  ud_4                -1.150112e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264024e-01 1 1  ON 16
  ud_7                -8.460435e-02 1 1  ON 17
  ud_8                -6.256384e-03 1 1  ON 18
  ud_9                 8.581247e-02 1 1  ON 19
  eO_0                -7.034955e-01 1 1  ON 20
  eO_1                -4.202662e-01 1 1  ON 21
  eO_2                -4.180150e-02 1 1  ON 22
  eO_3                 1.844436e-01 1 1  ON 23
  eO_4                 2.569168e-01 1 1  ON 24
  eO_5                 2.798438e-01 1 1  ON 25
  eO_6                 2.508572e-01 1 1  ON 26
  eO_7                 1.335211e-01 1 1  ON 27
  eO_8                 2.929629e-02 1 1  ON 28
  eO_9                 1.920097e-02 1 1  ON 29
 eH1_0                -2.017294e-01 1 1  ON 30
 eH1_1                -9.604192e-02 1 1  ON 31
 eH1_2                -4.456912e-02 1 1  ON 32
 eH1_3                -1.424126e-02 1 1  ON 33
 eH1_4                 1.808392e-02 1 1  ON 34
 eH1_5                 2.186450e-02 1 1  ON 35
 eH1_6                 7.089887e-02 1 1  ON 36
 eH1_7                 1.025490e-01 1 1  ON 37
 eH1_8                 1.010694e-01 1 1  ON 38
 eH1_9                 2.609462e-02 1 1  ON 39
 eH2_0                -2.031724e-01 1 1  ON 40
 eH2_1                -9.764770e-02 1 1  ON 41
 eH2_2                -4.626973e-02 1 1  ON 42
 eH2_3                -1.570863e-02 1 1  ON 43
 eH2_4                 1.609669e-02 1 1  ON 44
 eH2_5                 1.955091e-02 1 1  ON 45
 eH2_6                 7.199618e-02 1 1  ON 46
 eH2_7                 1.099043e-01 1 1  ON 47
 eH2_8                 1.035754e-01 1 1  ON 48
 eH2_9                 2.896433e-02 1 1  ON 49
ci_001                -4.165791e-02 3 1  ON 50
ci_002                -3.094293e-02 3 1  ON 51
ci_003                -1.140016e-02 3 1  ON 52
ci_004                 2.557790e-02 3 1  ON 53
ci_005                 2.573446e-02 3 1  ON 54
ci_006                -2.021030e-02 3 1  ON 55
ci_007                -1.979891e-02 3 1  ON 56
ci_008                -4.050369e-03 3 1  ON 57
ci_009                -1.516935e-02 3 1  ON 58
ci_010                -9.528246e-03 3 1  ON 59
ci_011                -9.637838e-03 3 1  ON 60
ci_012                -9.626574e-03 3 1  ON 61
ci_013                -2.166329e-02 3 1  ON 62
ci_014                 1.333051e-02 3 1  ON 63
ci_015                 1.313651e-02 3 1  ON 64
ci_016                 1.627938e-02 3 1  ON 65
ci_017                 1.612043e-02 3 1  ON 66
ci_018                 1.085985e-02 3 1  ON 67
ci_019                 1.052277e-02 3 1  ON 68
ci_020                 1.847030e-02 3 1  ON 69
ci_021                 1.812547e-02 3 1  ON 70
ci_022                 1.026971e-02 3 1  ON 71
ci_023                 1.028362e-02 3 1  ON 72
ci_024                 6.710327e-03 3 1  ON 73
ci_025                 6.514603e-03 3 1  ON 74
ci_026                 1.187443e-02 3 1  ON 75
ci_027                 1.184161e-02 3 1  ON 76
ci_028                -9.175723e-03 3 1  ON 77
ci_029                -9.753428e-03 3 1  ON 78
ci_030                -4.996129e-03 3 1  ON 79
ci_031                -4.662862e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.1955
    reference variance = 0.373073
====================================================
  Execution time = 1.8868e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9759e-01
  Total weights = 1.9737e+06
  Execution time = 1.6035e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289655343877
                                         uncertainty =       0.002392891097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289655343877
                                         uncertainty =       0.002392891097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380560748
  error estimate for blocks of size 2^( 2) =       0.000395801287
  error estimate for blocks of size 2^( 3) =       0.000409760198
  error estimate for blocks of size 2^( 4) =       0.000419946541
  error estimate for blocks of size 2^( 5) =       0.000425005089
  error estimate for blocks of size 2^( 6) =       0.000428218952
  error estimate for blocks of size 2^( 7) =       0.000428268740

      target function =      -0.916507573874
              le_mean =     -17.205962108383
             les_mean =     296.342722142210
             stat err =       0.000425359831
             autocorr =       1.249294890380
   target nu stat err =       0.000425359831
   target dn stat err =       0.002911681341
      target stat err =       0.004577127935
              std dev =       0.538194171577
             le_variance =       0.289652966319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289655344264
                                         uncertainty =       0.002392891972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289655344264
                                         uncertainty =       0.002392891972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380560749
  error estimate for blocks of size 2^( 2) =       0.000395801286
  error estimate for blocks of size 2^( 3) =       0.000409760196
  error estimate for blocks of size 2^( 4) =       0.000419946537
  error estimate for blocks of size 2^( 5) =       0.000425005085
  error estimate for blocks of size 2^( 6) =       0.000428218949
  error estimate for blocks of size 2^( 7) =       0.000428268737

      target function =      -0.916507620633
              le_mean =     -17.205962108220
             les_mean =     296.342722106469
             stat err =       0.000425359827
             autocorr =       1.249294868104
   target nu stat err =       0.000425359827
   target dn stat err =       0.002911680948
      target stat err =       0.004577127791
              std dev =       0.538194171936
             le_variance =       0.289652966706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289655344070
                                         uncertainty =       0.002392891535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289655344070
                                         uncertainty =       0.002392891535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380560748
  error estimate for blocks of size 2^( 2) =       0.000395801286
  error estimate for blocks of size 2^( 3) =       0.000409760197
  error estimate for blocks of size 2^( 4) =       0.000419946539
  error estimate for blocks of size 2^( 5) =       0.000425005087
  error estimate for blocks of size 2^( 6) =       0.000428218951
  error estimate for blocks of size 2^( 7) =       0.000428268738

      target function =      -0.916507597281
              le_mean =     -17.205962108301
             les_mean =     296.342722124322
             stat err =       0.000425359829
             autocorr =       1.249294879243
   target nu stat err =       0.000425359829
   target dn stat err =       0.002911681145
      target stat err =       0.004577127863
              std dev =       0.538194171756
             le_variance =       0.289652966512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289655343901
                                         uncertainty =       0.002392891152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289655343901
                                         uncertainty =       0.002392891152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380560748
  error estimate for blocks of size 2^( 2) =       0.000395801287
  error estimate for blocks of size 2^( 3) =       0.000409760198
  error estimate for blocks of size 2^( 4) =       0.000419946540
  error estimate for blocks of size 2^( 5) =       0.000425005089
  error estimate for blocks of size 2^( 6) =       0.000428218952
  error estimate for blocks of size 2^( 7) =       0.000428268740

      target function =      -0.916507576803
              le_mean =     -17.205962108373
             les_mean =     296.342722139972
             stat err =       0.000425359830
             autocorr =       1.249294888992
   target nu stat err =       0.000425359830
   target dn stat err =       0.002911681317
      target stat err =       0.004577127926
              std dev =       0.538194171599
             le_variance =       0.289652966343


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916507573874        initial
     5.5511e+03     5.5511e+04             8.3188e-08        -0.916507620633  <--
     2.2204e+04     2.2204e+05             2.0797e-08        -0.916507597281
     8.8818e+04     8.8818e+05             5.1992e-09        -0.916507576803

*****************************************************************************
Applying the update for shift_i =   5.5511e+03     and shift_s =   5.5511e+04
*****************************************************************************

  Execution time = 2.6830e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
  uu_0                 2.099661e-01 1 1  ON 0
  uu_1                 5.297250e-02 1 1  ON 1
  uu_2                -3.786916e-02 1 1  ON 2
  uu_3                -9.122428e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298133e-01 1 1  ON 5
  uu_6                -1.125654e-01 1 1  ON 6
  uu_7                -5.674050e-02 1 1  ON 7
  uu_8                 5.807034e-02 1 1  ON 8
  uu_9                 1.245061e-01 1 1  ON 9
  ud_0                 3.048776e-01 1 1  ON 10
  ud_1                 7.564082e-02 1 1  ON 11
  ud_2                -2.647842e-02 1 1  ON 12
  ud_3                -7.930427e-02 1 1  ON 13
  ud_4                -1.150112e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264024e-01 1 1  ON 16
  ud_7                -8.460432e-02 1 1  ON 17
  ud_8                -6.256399e-03 1 1  ON 18
  ud_9                 8.581246e-02 1 1  ON 19
  eO_0                -7.034956e-01 1 1  ON 20
  eO_1                -4.202662e-01 1 1  ON 21
  eO_2                -4.180153e-02 1 1  ON 22
  eO_3                 1.844436e-01 1 1  ON 23
  eO_4                 2.569168e-01 1 1  ON 24
  eO_5                 2.798438e-01 1 1  ON 25
  eO_6                 2.508572e-01 1 1  ON 26
  eO_7                 1.335211e-01 1 1  ON 27
  eO_8                 2.929629e-02 1 1  ON 28
  eO_9                 1.920097e-02 1 1  ON 29
 eH1_0                -2.017294e-01 1 1  ON 30
 eH1_1                -9.604193e-02 1 1  ON 31
 eH1_2                -4.456913e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808392e-02 1 1  ON 34
 eH1_5                 2.186449e-02 1 1  ON 35
 eH1_6                 7.089888e-02 1 1  ON 36
 eH1_7                 1.025490e-01 1 1  ON 37
 eH1_8                 1.010694e-01 1 1  ON 38
 eH1_9                 2.609463e-02 1 1  ON 39
 eH2_0                -2.031724e-01 1 1  ON 40
 eH2_1                -9.764770e-02 1 1  ON 41
 eH2_2                -4.626973e-02 1 1  ON 42
 eH2_3                -1.570862e-02 1 1  ON 43
 eH2_4                 1.609671e-02 1 1  ON 44
 eH2_5                 1.955093e-02 1 1  ON 45
 eH2_6                 7.199615e-02 1 1  ON 46
 eH2_7                 1.099043e-01 1 1  ON 47
 eH2_8                 1.035754e-01 1 1  ON 48
 eH2_9                 2.896433e-02 1 1  ON 49
ci_001                -4.165792e-02 3 1  ON 50
ci_002                -3.094293e-02 3 1  ON 51
ci_003                -1.140017e-02 3 1  ON 52
ci_004                 2.557790e-02 3 1  ON 53
ci_005                 2.573447e-02 3 1  ON 54
ci_006                -2.021030e-02 3 1  ON 55
ci_007                -1.979891e-02 3 1  ON 56
ci_008                -4.050375e-03 3 1  ON 57
ci_009                -1.516933e-02 3 1  ON 58
ci_010                -9.528252e-03 3 1  ON 59
ci_011                -9.637844e-03 3 1  ON 60
ci_012                -9.626569e-03 3 1  ON 61
ci_013                -2.166329e-02 3 1  ON 62
ci_014                 1.333052e-02 3 1  ON 63
ci_015                 1.313652e-02 3 1  ON 64
ci_016                 1.627938e-02 3 1  ON 65
ci_017                 1.612043e-02 3 1  ON 66
ci_018                 1.085985e-02 3 1  ON 67
ci_019                 1.052277e-02 3 1  ON 68
ci_020                 1.847030e-02 3 1  ON 69
ci_021                 1.812546e-02 3 1  ON 70
ci_022                 1.026972e-02 3 1  ON 71
ci_023                 1.028363e-02 3 1  ON 72
ci_024                 6.710326e-03 3 1  ON 73
ci_025                 6.514598e-03 3 1  ON 74
ci_026                 1.187443e-02 3 1  ON 75
ci_027                 1.184161e-02 3 1  ON 76
ci_028                -9.175729e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.996129e-03 3 1  ON 79
ci_031                -4.662855e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1248e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.2259
    reference variance = 0.304952
====================================================
  Execution time = 1.9310e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5430e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9370e-01
  Total weights = 1.973637256e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4987e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287740328742
                                         uncertainty =       0.001552674002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287740328742
                                         uncertainty =       0.001552674002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379297216
  error estimate for blocks of size 2^( 2) =       0.000394684943
  error estimate for blocks of size 2^( 3) =       0.000408890438
  error estimate for blocks of size 2^( 4) =       0.000419447032
  error estimate for blocks of size 2^( 5) =       0.000425903521
  error estimate for blocks of size 2^( 6) =       0.000429515936
  error estimate for blocks of size 2^( 7) =       0.000432658887

      target function =      -0.922592420563
              le_mean =     -17.206382442988
             les_mean =     296.353300099880
             stat err =       0.000426881344
             autocorr =       1.266645367524
   target nu stat err =       0.000426881344
   target dn stat err =       0.001926848325
      target stat err =       0.003119619226
              std dev =       0.536407267594
             le_variance =       0.287732756728


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720638244299e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+03, overlap shift 1.3878e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922602002653       residual = 4.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922602012681       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922602018166       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922602019604       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922602020087       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922602020023       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922602020229       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922602020360       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922602020295       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922602020227       residual = 9.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922602020321       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922602020464       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922602020614       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922602020660       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922602020689       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922602020700       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922602020707       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922602020754       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922602020717       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.922602020777       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.922602020733       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.922602020746       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.922602020776       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.922602020806       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.922602020773       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.922602020820       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.922602020792       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.922602020803       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.922602020803       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.922602020805       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.922602020807       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.922602020813       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.922602020802       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.922602020803       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.922602020804       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.922602020807       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3878e+03 is 2.149728e-07

solving harmonic davidson linear method for identity shift 5.5511e+03, overlap shift 5.5511e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922602002653       residual = 4.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922602005160       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922602006531       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922602006889       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922602007013       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922602006997       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922602007048       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922602007085       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922602007070       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922602007056       residual = 9.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922602007078       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922602007105       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922602007154       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922602007153       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922602007167       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922602007167       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922602007149       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922602007178       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922602007164       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.922602007187       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.922602007161       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.922602007189       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.922602007201       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.922602007183       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.922602007188       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.922602007187       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.922602007191       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.922602007167       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.922602007198       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.922602007189       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.922602007208       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.922602007184       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.922602007197       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.922602007179       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.922602007210       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.922602007200       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.5511e+03 is 5.374340e-08

solving harmonic davidson linear method for identity shift 2.2204e+04, overlap shift 2.2204e+05 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922602002653       residual = 4.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922602003279       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922602003622       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922602003712       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922602003750       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922602003780       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922602003756       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922602003711       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922602003695       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922602003710       residual = 9.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922602003730       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922602003771       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922602003866       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922602003741       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922602003831       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922602003815       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922602003741       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922602003796       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922602003779       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.922602003786       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.922602003827       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.922602003755       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.922602003829       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.922602003753       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.922602003692       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.922602003771       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.922602003776       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.922602003809       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.922602003709       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.922602003806       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.922602003714       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.922602003772       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.922602003843       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.922602003742       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.922602003738       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.922602003831       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.2204e+04 is 1.343586e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.104700 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4864e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
  uu_0                 2.099661e-01 1 1  ON 0
  uu_1                 5.297250e-02 1 1  ON 1
  uu_2                -3.786915e-02 1 1  ON 2
  uu_3                -9.122427e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125654e-01 1 1  ON 6
  uu_7                -5.674051e-02 1 1  ON 7
  uu_8                 5.807028e-02 1 1  ON 8
  uu_9                 1.245061e-01 1 1  ON 9
  ud_0                 3.048776e-01 1 1  ON 10
  ud_1                 7.564080e-02 1 1  ON 11
  ud_2                -2.647843e-02 1 1  ON 12
  ud_3                -7.930429e-02 1 1  ON 13
  ud_4                -1.150112e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264023e-01 1 1  ON 16
  ud_7                -8.460427e-02 1 1  ON 17
  ud_8                -6.256385e-03 1 1  ON 18
  ud_9                 8.581245e-02 1 1  ON 19
  eO_0                -7.034956e-01 1 1  ON 20
  eO_1                -4.202662e-01 1 1  ON 21
  eO_2                -4.180154e-02 1 1  ON 22
  eO_3                 1.844436e-01 1 1  ON 23
  eO_4                 2.569168e-01 1 1  ON 24
  eO_5                 2.798438e-01 1 1  ON 25
  eO_6                 2.508572e-01 1 1  ON 26
  eO_7                 1.335211e-01 1 1  ON 27
  eO_8                 2.929629e-02 1 1  ON 28
  eO_9                 1.920097e-02 1 1  ON 29
 eH1_0                -2.017294e-01 1 1  ON 30
 eH1_1                -9.604193e-02 1 1  ON 31
 eH1_2                -4.456913e-02 1 1  ON 32
 eH1_3                -1.424126e-02 1 1  ON 33
 eH1_4                 1.808391e-02 1 1  ON 34
 eH1_5                 2.186446e-02 1 1  ON 35
 eH1_6                 7.089890e-02 1 1  ON 36
 eH1_7                 1.025490e-01 1 1  ON 37
 eH1_8                 1.010694e-01 1 1  ON 38
 eH1_9                 2.609463e-02 1 1  ON 39
 eH2_0                -2.031724e-01 1 1  ON 40
 eH2_1                -9.764770e-02 1 1  ON 41
 eH2_2                -4.626972e-02 1 1  ON 42
 eH2_3                -1.570863e-02 1 1  ON 43
 eH2_4                 1.609669e-02 1 1  ON 44
 eH2_5                 1.955092e-02 1 1  ON 45
 eH2_6                 7.199614e-02 1 1  ON 46
 eH2_7                 1.099043e-01 1 1  ON 47
 eH2_8                 1.035754e-01 1 1  ON 48
 eH2_9                 2.896434e-02 1 1  ON 49
ci_001                -4.165790e-02 3 1  ON 50
ci_002                -3.094293e-02 3 1  ON 51
ci_003                -1.140015e-02 3 1  ON 52
ci_004                 2.557789e-02 3 1  ON 53
ci_005                 2.573447e-02 3 1  ON 54
ci_006                -2.021029e-02 3 1  ON 55
ci_007                -1.979891e-02 3 1  ON 56
ci_008                -4.050388e-03 3 1  ON 57
ci_009                -1.516934e-02 3 1  ON 58
ci_010                -9.528263e-03 3 1  ON 59
ci_011                -9.637850e-03 3 1  ON 60
ci_012                -9.626573e-03 3 1  ON 61
ci_013                -2.166328e-02 3 1  ON 62
ci_014                 1.333051e-02 3 1  ON 63
ci_015                 1.313653e-02 3 1  ON 64
ci_016                 1.627937e-02 3 1  ON 65
ci_017                 1.612042e-02 3 1  ON 66
ci_018                 1.085984e-02 3 1  ON 67
ci_019                 1.052278e-02 3 1  ON 68
ci_020                 1.847030e-02 3 1  ON 69
ci_021                 1.812548e-02 3 1  ON 70
ci_022                 1.026973e-02 3 1  ON 71
ci_023                 1.028362e-02 3 1  ON 72
ci_024                 6.710318e-03 3 1  ON 73
ci_025                 6.514604e-03 3 1  ON 74
ci_026                 1.187443e-02 3 1  ON 75
ci_027                 1.184162e-02 3 1  ON 76
ci_028                -9.175718e-03 3 1  ON 77
ci_029                -9.753429e-03 3 1  ON 78
ci_030                -4.996124e-03 3 1  ON 79
ci_031                -4.662856e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.2556
    reference variance = 0.945801
====================================================
  Execution time = 1.8963e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9689e-01
  Total weights = 1.9738e+06
  Execution time = 1.6024e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289247464050
                                         uncertainty =       0.001595489259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289247464050
                                         uncertainty =       0.001595489259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380280790
  error estimate for blocks of size 2^( 2) =       0.000395184840
  error estimate for blocks of size 2^( 3) =       0.000409736058
  error estimate for blocks of size 2^( 4) =       0.000420418998
  error estimate for blocks of size 2^( 5) =       0.000426770609
  error estimate for blocks of size 2^( 6) =       0.000428976238
  error estimate for blocks of size 2^( 7) =       0.000430657678

      target function =      -0.917598739315
              le_mean =     -17.206407216059
             les_mean =     296.357340249007
             stat err =       0.000426705881
             autocorr =       1.259065958252
   target nu stat err =       0.000426705881
   target dn stat err =       0.002154842187
      target stat err =       0.003433105114
              std dev =       0.537798250370
             le_variance =       0.289226958101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289247434171
                                         uncertainty =       0.001595488768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289247434171
                                         uncertainty =       0.001595488768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380280770
  error estimate for blocks of size 2^( 2) =       0.000395184817
  error estimate for blocks of size 2^( 3) =       0.000409736031
  error estimate for blocks of size 2^( 4) =       0.000420418968
  error estimate for blocks of size 2^( 5) =       0.000426770579
  error estimate for blocks of size 2^( 6) =       0.000428976209
  error estimate for blocks of size 2^( 7) =       0.000430657649

      target function =      -0.917598826382
              le_mean =     -17.206407215216
             les_mean =     296.357340164096
             stat err =       0.000426705851
             autocorr =       1.259065914738
   target nu stat err =       0.000426705851
   target dn stat err =       0.002154842929
      target stat err =       0.003433106864
              std dev =       0.537798222619
             le_variance =       0.289226928252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289247449110
                                         uncertainty =       0.001595489013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289247449110
                                         uncertainty =       0.001595489013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380280780
  error estimate for blocks of size 2^( 2) =       0.000395184829
  error estimate for blocks of size 2^( 3) =       0.000409736045
  error estimate for blocks of size 2^( 4) =       0.000420418983
  error estimate for blocks of size 2^( 5) =       0.000426770594
  error estimate for blocks of size 2^( 6) =       0.000428976224
  error estimate for blocks of size 2^( 7) =       0.000430657663

      target function =      -0.917598782859
              le_mean =     -17.206407215637
             les_mean =     296.357340206543
             stat err =       0.000426705866
             autocorr =       1.259065936495
   target nu stat err =       0.000426705866
   target dn stat err =       0.002154842558
      target stat err =       0.003433105989
              std dev =       0.537798236494
             le_variance =       0.289226943176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289247462183
                                         uncertainty =       0.001595489228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289247462183
                                         uncertainty =       0.001595489228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380280789
  error estimate for blocks of size 2^( 2) =       0.000395184839
  error estimate for blocks of size 2^( 3) =       0.000409736056
  error estimate for blocks of size 2^( 4) =       0.000420418996
  error estimate for blocks of size 2^( 5) =       0.000426770607
  error estimate for blocks of size 2^( 6) =       0.000428976236
  error estimate for blocks of size 2^( 7) =       0.000430657676

      target function =      -0.917598744759
              le_mean =     -17.206407216006
             les_mean =     296.357340243698
             stat err =       0.000426705879
             autocorr =       1.259065955531
   target nu stat err =       0.000426705879
   target dn stat err =       0.002154842233
      target stat err =       0.003433105223
              std dev =       0.537798248636
             le_variance =       0.289226956236


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917598739315        initial
     1.3878e+03     1.3878e+04             2.1497e-07        -0.917598826382  <--
     5.5511e+03     5.5511e+04             5.3743e-08        -0.917598782859
     2.2204e+04     2.2204e+05             1.3436e-08        -0.917598744759

*****************************************************************************
Applying the update for shift_i =   1.3878e+03     and shift_s =   1.3878e+04
*****************************************************************************

  Execution time = 2.6880e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
  uu_0                 2.099661e-01 1 1  ON 0
  uu_1                 5.297250e-02 1 1  ON 1
  uu_2                -3.786913e-02 1 1  ON 2
  uu_3                -9.122424e-02 1 1  ON 3
  uu_4                -1.219418e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125654e-01 1 1  ON 6
  uu_7                -5.674054e-02 1 1  ON 7
  uu_8                 5.807012e-02 1 1  ON 8
  uu_9                 1.245061e-01 1 1  ON 9
  ud_0                 3.048776e-01 1 1  ON 10
  ud_1                 7.564075e-02 1 1  ON 11
  ud_2                -2.647846e-02 1 1  ON 12
  ud_3                -7.930433e-02 1 1  ON 13
  ud_4                -1.150113e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264023e-01 1 1  ON 16
  ud_7                -8.460413e-02 1 1  ON 17
  ud_8                -6.256344e-03 1 1  ON 18
  ud_9                 8.581243e-02 1 1  ON 19
  eO_0                -7.034957e-01 1 1  ON 20
  eO_1                -4.202663e-01 1 1  ON 21
  eO_2                -4.180158e-02 1 1  ON 22
  eO_3                 1.844436e-01 1 1  ON 23
  eO_4                 2.569168e-01 1 1  ON 24
  eO_5                 2.798439e-01 1 1  ON 25
  eO_6                 2.508572e-01 1 1  ON 26
  eO_7                 1.335213e-01 1 1  ON 27
  eO_8                 2.929629e-02 1 1  ON 28
  eO_9                 1.920098e-02 1 1  ON 29
 eH1_0                -2.017293e-01 1 1  ON 30
 eH1_1                -9.604192e-02 1 1  ON 31
 eH1_2                -4.456912e-02 1 1  ON 32
 eH1_3                -1.424129e-02 1 1  ON 33
 eH1_4                 1.808387e-02 1 1  ON 34
 eH1_5                 2.186438e-02 1 1  ON 35
 eH1_6                 7.089897e-02 1 1  ON 36
 eH1_7                 1.025489e-01 1 1  ON 37
 eH1_8                 1.010694e-01 1 1  ON 38
 eH1_9                 2.609463e-02 1 1  ON 39
 eH2_0                -2.031723e-01 1 1  ON 40
 eH2_1                -9.764768e-02 1 1  ON 41
 eH2_2                -4.626970e-02 1 1  ON 42
 eH2_3                -1.570867e-02 1 1  ON 43
 eH2_4                 1.609663e-02 1 1  ON 44
 eH2_5                 1.955090e-02 1 1  ON 45
 eH2_6                 7.199609e-02 1 1  ON 46
 eH2_7                 1.099043e-01 1 1  ON 47
 eH2_8                 1.035755e-01 1 1  ON 48
 eH2_9                 2.896434e-02 1 1  ON 49
ci_001                -4.165784e-02 3 1  ON 50
ci_002                -3.094296e-02 3 1  ON 51
ci_003                -1.140012e-02 3 1  ON 52
ci_004                 2.557785e-02 3 1  ON 53
ci_005                 2.573449e-02 3 1  ON 54
ci_006                -2.021026e-02 3 1  ON 55
ci_007                -1.979891e-02 3 1  ON 56
ci_008                -4.050425e-03 3 1  ON 57
ci_009                -1.516935e-02 3 1  ON 58
ci_010                -9.528295e-03 3 1  ON 59
ci_011                -9.637868e-03 3 1  ON 60
ci_012                -9.626586e-03 3 1  ON 61
ci_013                -2.166324e-02 3 1  ON 62
ci_014                 1.333047e-02 3 1  ON 63
ci_015                 1.313657e-02 3 1  ON 64
ci_016                 1.627935e-02 3 1  ON 65
ci_017                 1.612041e-02 3 1  ON 66
ci_018                 1.085983e-02 3 1  ON 67
ci_019                 1.052279e-02 3 1  ON 68
ci_020                 1.847029e-02 3 1  ON 69
ci_021                 1.812553e-02 3 1  ON 70
ci_022                 1.026977e-02 3 1  ON 71
ci_023                 1.028360e-02 3 1  ON 72
ci_024                 6.710292e-03 3 1  ON 73
ci_025                 6.514622e-03 3 1  ON 74
ci_026                 1.187441e-02 3 1  ON 75
ci_027                 1.184166e-02 3 1  ON 76
ci_028                -9.175683e-03 3 1  ON 77
ci_029                -9.753443e-03 3 1  ON 78
ci_030                -4.996107e-03 3 1  ON 79
ci_031                -4.662859e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1750e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.2547
    reference variance = 0.147051
====================================================
  Execution time = 2.1504e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5429e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9482e-01
  Total weights = 1.973950017e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5008e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286972958733
                                         uncertainty =       0.001661587965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286972958733
                                         uncertainty =       0.001661587965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378774257
  error estimate for blocks of size 2^( 2) =       0.000394196507
  error estimate for blocks of size 2^( 3) =       0.000408252602
  error estimate for blocks of size 2^( 4) =       0.000418675386
  error estimate for blocks of size 2^( 5) =       0.000424971888
  error estimate for blocks of size 2^( 6) =       0.000428752975
  error estimate for blocks of size 2^( 7) =       0.000431268006

      target function =      -0.920828404088
              le_mean =     -17.205977387769
             les_mean =     296.340481879214
             stat err =       0.000425917064
             autocorr =       1.264413633516
   target nu stat err =       0.000425917064
   target dn stat err =       0.002441206064
      target stat err =       0.003893665599
              std dev =       0.535667690982
             le_variance =       0.286939875162


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720597738777e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+02, overlap shift 3.4694e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920843743310       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920843880671       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920843896556       residual = 3.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920843902213       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920843904232       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920843905429       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920843905798       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920843906298       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920843906256       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920843907251       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920843907830       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920843908263       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920843907879       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920843907887       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920843907834       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920843908112       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920843908429       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920843908830       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920843909069       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920843909143       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920843909343       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920843909202       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920843909230       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920843909172       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920843909130       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920843909073       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920843909070       residual = 9.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920843909062       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920843909074       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920843909056       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920843909032       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920843909091       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920843909128       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920843909101       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.920843909118       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.920843909141       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.4694e+02 is 8.708494e-07

solving harmonic davidson linear method for identity shift 1.3878e+03, overlap shift 1.3878e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920843743310       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920843777656       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920843781628       residual = 3.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920843783043       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920843783548       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920843783848       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920843783938       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920843784062       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920843784052       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920843784304       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920843784447       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920843784555       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920843784457       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920843784460       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920843784449       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920843784518       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920843784594       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920843784695       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920843784757       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920843784776       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920843784825       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920843784792       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920843784796       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920843784781       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920843784770       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920843784753       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920843784751       residual = 9.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920843784748       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920843784760       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920843784750       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920843784746       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920843784764       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920843784768       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920843784762       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.920843784768       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.920843784774       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3878e+03 is 2.177211e-07

solving harmonic davidson linear method for identity shift 5.5511e+03, overlap shift 5.5511e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920843743310       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920843751897       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920843752890       residual = 3.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920843753244       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920843753374       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920843753440       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920843753455       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920843753500       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920843753504       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920843753561       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920843753596       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920843753626       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920843753595       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920843753597       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920843753606       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920843753615       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920843753645       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920843753662       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920843753674       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920843753686       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920843753681       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920843753690       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920843753670       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920843753682       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920843753660       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920843753667       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920843753670       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920843753645       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920843753654       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920843753674       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920843753654       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920843753676       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920843753668       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920843753685       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.920843753684       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.920843753682       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.5511e+03 is 5.443083e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.154122 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7060e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
  uu_0                 2.099662e-01 1 1  ON 0
  uu_1                 5.297255e-02 1 1  ON 1
  uu_2                -3.786913e-02 1 1  ON 2
  uu_3                -9.122425e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125654e-01 1 1  ON 6
  uu_7                -5.674057e-02 1 1  ON 7
  uu_8                 5.806994e-02 1 1  ON 8
  uu_9                 1.245062e-01 1 1  ON 9
  ud_0                 3.048776e-01 1 1  ON 10
  ud_1                 7.564073e-02 1 1  ON 11
  ud_2                -2.647847e-02 1 1  ON 12
  ud_3                -7.930431e-02 1 1  ON 13
  ud_4                -1.150112e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264024e-01 1 1  ON 16
  ud_7                -8.460410e-02 1 1  ON 17
  ud_8                -6.256316e-03 1 1  ON 18
  ud_9                 8.581237e-02 1 1  ON 19
  eO_0                -7.034958e-01 1 1  ON 20
  eO_1                -4.202663e-01 1 1  ON 21
  eO_2                -4.180152e-02 1 1  ON 22
  eO_3                 1.844437e-01 1 1  ON 23
  eO_4                 2.569168e-01 1 1  ON 24
  eO_5                 2.798437e-01 1 1  ON 25
  eO_6                 2.508571e-01 1 1  ON 26
  eO_7                 1.335215e-01 1 1  ON 27
  eO_8                 2.929634e-02 1 1  ON 28
  eO_9                 1.920098e-02 1 1  ON 29
 eH1_0                -2.017292e-01 1 1  ON 30
 eH1_1                -9.604189e-02 1 1  ON 31
 eH1_2                -4.456911e-02 1 1  ON 32
 eH1_3                -1.424129e-02 1 1  ON 33
 eH1_4                 1.808387e-02 1 1  ON 34
 eH1_5                 2.186435e-02 1 1  ON 35
 eH1_6                 7.089882e-02 1 1  ON 36
 eH1_7                 1.025488e-01 1 1  ON 37
 eH1_8                 1.010696e-01 1 1  ON 38
 eH1_9                 2.609466e-02 1 1  ON 39
 eH2_0                -2.031723e-01 1 1  ON 40
 eH2_1                -9.764765e-02 1 1  ON 41
 eH2_2                -4.626968e-02 1 1  ON 42
 eH2_3                -1.570864e-02 1 1  ON 43
 eH2_4                 1.609667e-02 1 1  ON 44
 eH2_5                 1.955088e-02 1 1  ON 45
 eH2_6                 7.199595e-02 1 1  ON 46
 eH2_7                 1.099043e-01 1 1  ON 47
 eH2_8                 1.035755e-01 1 1  ON 48
 eH2_9                 2.896436e-02 1 1  ON 49
ci_001                -4.165786e-02 3 1  ON 50
ci_002                -3.094297e-02 3 1  ON 51
ci_003                -1.140013e-02 3 1  ON 52
ci_004                 2.557795e-02 3 1  ON 53
ci_005                 2.573450e-02 3 1  ON 54
ci_006                -2.021026e-02 3 1  ON 55
ci_007                -1.979891e-02 3 1  ON 56
ci_008                -4.050509e-03 3 1  ON 57
ci_009                -1.516935e-02 3 1  ON 58
ci_010                -9.528334e-03 3 1  ON 59
ci_011                -9.637871e-03 3 1  ON 60
ci_012                -9.626667e-03 3 1  ON 61
ci_013                -2.166318e-02 3 1  ON 62
ci_014                 1.333044e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627934e-02 3 1  ON 65
ci_017                 1.612040e-02 3 1  ON 66
ci_018                 1.085986e-02 3 1  ON 67
ci_019                 1.052283e-02 3 1  ON 68
ci_020                 1.847024e-02 3 1  ON 69
ci_021                 1.812550e-02 3 1  ON 70
ci_022                 1.026979e-02 3 1  ON 71
ci_023                 1.028357e-02 3 1  ON 72
ci_024                 6.710323e-03 3 1  ON 73
ci_025                 6.514735e-03 3 1  ON 74
ci_026                 1.187427e-02 3 1  ON 75
ci_027                 1.184166e-02 3 1  ON 76
ci_028                -9.175677e-03 3 1  ON 77
ci_029                -9.753437e-03 3 1  ON 78
ci_030                -4.996083e-03 3 1  ON 79
ci_031                -4.662788e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.141
    reference variance = 0.197956
====================================================
  Execution time = 1.8975e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9987e-01
  Total weights = 1.9739e+06
  Execution time = 1.6083e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291274090511
                                         uncertainty =       0.002118157019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291274090511
                                         uncertainty =       0.002118157019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381591536
  error estimate for blocks of size 2^( 2) =       0.000396566993
  error estimate for blocks of size 2^( 3) =       0.000410469567
  error estimate for blocks of size 2^( 4) =       0.000421063693
  error estimate for blocks of size 2^( 5) =       0.000427584096
  error estimate for blocks of size 2^( 6) =       0.000430357274
  error estimate for blocks of size 2^( 7) =       0.000429515048

      target function =      -0.912959735789
              le_mean =     -17.206589581010
             les_mean =     296.366598953719
             stat err =       0.000427130028
             autocorr =       1.252918269926
   target nu stat err =       0.000427130028
   target dn stat err =       0.003102643194
      target stat err =       0.004838953656
              std dev =       0.539651925463
             le_variance =       0.291224200656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291274043931
                                         uncertainty =       0.002118155311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291274043931
                                         uncertainty =       0.002118155311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381591506
  error estimate for blocks of size 2^( 2) =       0.000396566935
  error estimate for blocks of size 2^( 3) =       0.000410469482
  error estimate for blocks of size 2^( 4) =       0.000421063580
  error estimate for blocks of size 2^( 5) =       0.000427583954
  error estimate for blocks of size 2^( 6) =       0.000430357120
  error estimate for blocks of size 2^( 7) =       0.000429514879

      target function =      -0.912959788549
              le_mean =     -17.206589577034
             les_mean =     296.366598783219
             stat err =       0.000427129883
             autocorr =       1.252917618187
   target nu stat err =       0.000427129883
   target dn stat err =       0.003102596566
      target stat err =       0.004838883028
              std dev =       0.539651882483
             le_variance =       0.291224154268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291274067211
                                         uncertainty =       0.002118156165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291274067211
                                         uncertainty =       0.002118156165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381591521
  error estimate for blocks of size 2^( 2) =       0.000396566964
  error estimate for blocks of size 2^( 3) =       0.000410469525
  error estimate for blocks of size 2^( 4) =       0.000421063636
  error estimate for blocks of size 2^( 5) =       0.000427584025
  error estimate for blocks of size 2^( 6) =       0.000430357197
  error estimate for blocks of size 2^( 7) =       0.000429514963

      target function =      -0.912959762294
              le_mean =     -17.206589579021
             les_mean =     296.366598868349
             stat err =       0.000427129955
             autocorr =       1.252917944015
   target nu stat err =       0.000427129955
   target dn stat err =       0.003102619874
      target stat err =       0.004838918333
              std dev =       0.539651903964
             le_variance =       0.291224177452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291274087598
                                         uncertainty =       0.002118156912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291274087598
                                         uncertainty =       0.002118156912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381591534
  error estimate for blocks of size 2^( 2) =       0.000396566989
  error estimate for blocks of size 2^( 3) =       0.000410469562
  error estimate for blocks of size 2^( 4) =       0.000421063686
  error estimate for blocks of size 2^( 5) =       0.000427584087
  error estimate for blocks of size 2^( 6) =       0.000430357265
  error estimate for blocks of size 2^( 7) =       0.000429515038

      target function =      -0.912959739115
              le_mean =     -17.206589580761
             les_mean =     296.366598943036
             stat err =       0.000427130019
             autocorr =       1.252918229187
   target nu stat err =       0.000427130019
   target dn stat err =       0.003102640279
      target stat err =       0.004838949240
              std dev =       0.539651922775
             le_variance =       0.291224197755


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912959735789        initial
     3.4694e+02     3.4694e+03             8.7085e-07        -0.912959788549  <--
     1.3878e+03     1.3878e+04             2.1772e-07        -0.912959762294
     5.5511e+03     5.5511e+04             5.4431e-08        -0.912959739115

*****************************************************************************
Applying the update for shift_i =   3.4694e+02     and shift_s =   3.4694e+03
*****************************************************************************

  Execution time = 2.6899e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297270e-02 1 1  ON 1
  uu_2                -3.786912e-02 1 1  ON 2
  uu_3                -9.122428e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674065e-02 1 1  ON 7
  uu_8                 5.806941e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564068e-02 1 1  ON 11
  ud_2                -2.647849e-02 1 1  ON 12
  ud_3                -7.930424e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460402e-02 1 1  ON 17
  ud_8                -6.256233e-03 1 1  ON 18
  ud_9                 8.581221e-02 1 1  ON 19
  eO_0                -7.034959e-01 1 1  ON 20
  eO_1                -4.202663e-01 1 1  ON 21
  eO_2                -4.180135e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335221e-01 1 1  ON 27
  eO_8                 2.929650e-02 1 1  ON 28
  eO_9                 1.920098e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604179e-02 1 1  ON 31
 eH1_2                -4.456909e-02 1 1  ON 32
 eH1_3                -1.424130e-02 1 1  ON 33
 eH1_4                 1.808387e-02 1 1  ON 34
 eH1_5                 2.186428e-02 1 1  ON 35
 eH1_6                 7.089838e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609476e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764757e-02 1 1  ON 41
 eH2_2                -4.626962e-02 1 1  ON 42
 eH2_3                -1.570857e-02 1 1  ON 43
 eH2_4                 1.609679e-02 1 1  ON 44
 eH2_5                 1.955082e-02 1 1  ON 45
 eH2_6                 7.199555e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035757e-01 1 1  ON 48
 eH2_9                 2.896440e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094302e-02 3 1  ON 51
ci_003                -1.140018e-02 3 1  ON 52
ci_004                 2.557825e-02 3 1  ON 53
ci_005                 2.573453e-02 3 1  ON 54
ci_006                -2.021027e-02 3 1  ON 55
ci_007                -1.979893e-02 3 1  ON 56
ci_008                -4.050761e-03 3 1  ON 57
ci_009                -1.516935e-02 3 1  ON 58
ci_010                -9.528453e-03 3 1  ON 59
ci_011                -9.637880e-03 3 1  ON 60
ci_012                -9.626909e-03 3 1  ON 61
ci_013                -2.166301e-02 3 1  ON 62
ci_014                 1.333032e-02 3 1  ON 63
ci_015                 1.313659e-02 3 1  ON 64
ci_016                 1.627930e-02 3 1  ON 65
ci_017                 1.612038e-02 3 1  ON 66
ci_018                 1.085995e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847008e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026982e-02 3 1  ON 71
ci_023                 1.028346e-02 3 1  ON 72
ci_024                 6.710414e-03 3 1  ON 73
ci_025                 6.515073e-03 3 1  ON 74
ci_026                 1.187387e-02 3 1  ON 75
ci_027                 1.184167e-02 3 1  ON 76
ci_028                -9.175658e-03 3 1  ON 77
ci_029                -9.753419e-03 3 1  ON 78
ci_030                -4.996009e-03 3 1  ON 79
ci_031                -4.662575e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.3965e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.239
    reference variance = 0.300553
====================================================
  Execution time = 1.8882e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5413e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9745e-01
  Total weights = 1.973973935e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5051e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291135765022
                                         uncertainty =       0.001848053243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291135765022
                                         uncertainty =       0.001848053243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381567415
  error estimate for blocks of size 2^( 2) =       0.000397071884
  error estimate for blocks of size 2^( 3) =       0.000411347041
  error estimate for blocks of size 2^( 4) =       0.000422100031
  error estimate for blocks of size 2^( 5) =       0.000428836441
  error estimate for blocks of size 2^( 6) =       0.000431979066
  error estimate for blocks of size 2^( 7) =       0.000433921500

      target function =      -0.916729463486
              le_mean =     -17.206273083117
             les_mean =     296.353284101624
             stat err =       0.000429209259
             autocorr =       1.265306107582
   target nu stat err =       0.000429209259
   target dn stat err =       0.002179943091
      target stat err =       0.003464925931
              std dev =       0.539617813915
             le_variance =       0.291187385094


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720627308312e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+01, overlap shift 8.6736e+02 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916741629321       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916741755628       residual = 7.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916741789865       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916741801714       residual = 6.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916741806942       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916741808568       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916741805791       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916741806197       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916741808799       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916741809618       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916741812183       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916741813482       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916741811840       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916741811190       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916741811918       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916741812481       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916741812752       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916741813435       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916741814410       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916741814580       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916741815912       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916741816613       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916741816483       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916741816364       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916741816373       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916741816193       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916741816044       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916741816183       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916741816128       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916741816282       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916741816274       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916741816340       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916741816323       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916741816274       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916741816397       residual = 8.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.6736e+01 is 4.494907e-06

solving harmonic davidson linear method for identity shift 3.4694e+02, overlap shift 3.4694e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916741629321       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916741660919       residual = 7.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916741669483       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916741672446       residual = 6.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916741673754       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916741674160       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916741673466       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916741673566       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916741674219       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916741674423       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916741675064       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916741675389       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916741674978       residual = 9.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916741674816       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916741674998       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916741675139       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916741675206       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916741675377       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916741675621       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916741675663       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916741675997       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916741676172       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916741676139       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916741676110       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916741676112       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916741676065       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916741676029       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916741676066       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916741676052       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916741676087       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916741676086       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916741676102       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916741676100       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916741676086       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916741676117       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.4694e+02 is 1.123831e-06

solving harmonic davidson linear method for identity shift 1.3878e+03, overlap shift 1.3878e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916741629321       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916741637222       residual = 7.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916741639363       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916741640104       residual = 6.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916741640430       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916741640532       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916741640358       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916741640385       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916741640544       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916741640596       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916741640760       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916741640838       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916741640738       residual = 9.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916741640699       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916741640738       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916741640777       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916741640794       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916741640836       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916741640898       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916741640908       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916741640991       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916741641037       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916741641030       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916741641017       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916741641017       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916741641007       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916741640992       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916741641014       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916741641006       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916741641012       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916741641016       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916741641022       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916741641018       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916741641019       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916741641026       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3878e+03 is 2.809642e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.199732 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4439e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
  uu_0                 2.099666e-01 1 1  ON 0
  uu_1                 5.297272e-02 1 1  ON 1
  uu_2                -3.786909e-02 1 1  ON 2
  uu_3                -9.122422e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298129e-01 1 1  ON 5
  uu_6                -1.125653e-01 1 1  ON 6
  uu_7                -5.674067e-02 1 1  ON 7
  uu_8                 5.806829e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048771e-01 1 1  ON 10
  ud_1                 7.564045e-02 1 1  ON 11
  ud_2                -2.647862e-02 1 1  ON 12
  ud_3                -7.930441e-02 1 1  ON 13
  ud_4                -1.150112e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264023e-01 1 1  ON 16
  ud_7                -8.460339e-02 1 1  ON 17
  ud_8                -6.256206e-03 1 1  ON 18
  ud_9                 8.581190e-02 1 1  ON 19
  eO_0                -7.034958e-01 1 1  ON 20
  eO_1                -4.202662e-01 1 1  ON 21
  eO_2                -4.180137e-02 1 1  ON 22
  eO_3                 1.844437e-01 1 1  ON 23
  eO_4                 2.569162e-01 1 1  ON 24
  eO_5                 2.798423e-01 1 1  ON 25
  eO_6                 2.508573e-01 1 1  ON 26
  eO_7                 1.335229e-01 1 1  ON 27
  eO_8                 2.929655e-02 1 1  ON 28
  eO_9                 1.920096e-02 1 1  ON 29
 eH1_0                -2.017287e-01 1 1  ON 30
 eH1_1                -9.604170e-02 1 1  ON 31
 eH1_2                -4.456889e-02 1 1  ON 32
 eH1_3                -1.424097e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186362e-02 1 1  ON 35
 eH1_6                 7.089796e-02 1 1  ON 36
 eH1_7                 1.025483e-01 1 1  ON 37
 eH1_8                 1.010703e-01 1 1  ON 38
 eH1_9                 2.609483e-02 1 1  ON 39
 eH2_0                -2.031720e-01 1 1  ON 40
 eH2_1                -9.764741e-02 1 1  ON 41
 eH2_2                -4.626953e-02 1 1  ON 42
 eH2_3                -1.570875e-02 1 1  ON 43
 eH2_4                 1.609654e-02 1 1  ON 44
 eH2_5                 1.955085e-02 1 1  ON 45
 eH2_6                 7.199497e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035762e-01 1 1  ON 48
 eH2_9                 2.896446e-02 1 1  ON 49
ci_001                -4.165778e-02 3 1  ON 50
ci_002                -3.094293e-02 3 1  ON 51
ci_003                -1.140020e-02 3 1  ON 52
ci_004                 2.557816e-02 3 1  ON 53
ci_005                 2.573445e-02 3 1  ON 54
ci_006                -2.021031e-02 3 1  ON 55
ci_007                -1.979893e-02 3 1  ON 56
ci_008                -4.050876e-03 3 1  ON 57
ci_009                -1.516923e-02 3 1  ON 58
ci_010                -9.528409e-03 3 1  ON 59
ci_011                -9.637804e-03 3 1  ON 60
ci_012                -9.627048e-03 3 1  ON 61
ci_013                -2.166290e-02 3 1  ON 62
ci_014                 1.333057e-02 3 1  ON 63
ci_015                 1.313664e-02 3 1  ON 64
ci_016                 1.627934e-02 3 1  ON 65
ci_017                 1.612053e-02 3 1  ON 66
ci_018                 1.085984e-02 3 1  ON 67
ci_019                 1.052290e-02 3 1  ON 68
ci_020                 1.847020e-02 3 1  ON 69
ci_021                 1.812545e-02 3 1  ON 70
ci_022                 1.026992e-02 3 1  ON 71
ci_023                 1.028364e-02 3 1  ON 72
ci_024                 6.710622e-03 3 1  ON 73
ci_025                 6.515388e-03 3 1  ON 74
ci_026                 1.187370e-02 3 1  ON 75
ci_027                 1.184163e-02 3 1  ON 76
ci_028                -9.175691e-03 3 1  ON 77
ci_029                -9.753351e-03 3 1  ON 78
ci_030                -4.995896e-03 3 1  ON 79
ci_031                -4.662716e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2506
    reference variance = 0.3316
====================================================
  Execution time = 1.9113e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9913e-01
  Total weights = 1.9737e+06
  Execution time = 1.5933e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291341854022
                                         uncertainty =       0.001678544166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291341854022
                                         uncertainty =       0.001678544166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381649460
  error estimate for blocks of size 2^( 2) =       0.000396974111
  error estimate for blocks of size 2^( 3) =       0.000411023310
  error estimate for blocks of size 2^( 4) =       0.000421168525
  error estimate for blocks of size 2^( 5) =       0.000426818132
  error estimate for blocks of size 2^( 6) =       0.000429042639
  error estimate for blocks of size 2^( 7) =       0.000431210061

      target function =      -0.914116746445
              le_mean =     -17.206536203293
             les_mean =     296.364020298267
             stat err =       0.000427059839
             autocorr =       1.252126366830
   target nu stat err =       0.000427059839
   target dn stat err =       0.002359740163
      target stat err =       0.003718798029
              std dev =       0.539733841875
             le_variance =       0.291312620065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291341827190
                                         uncertainty =       0.001678554504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291341827190
                                         uncertainty =       0.001678554504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381649441
  error estimate for blocks of size 2^( 2) =       0.000396974110
  error estimate for blocks of size 2^( 3) =       0.000411023319
  error estimate for blocks of size 2^( 4) =       0.000421168553
  error estimate for blocks of size 2^( 5) =       0.000426818177
  error estimate for blocks of size 2^( 6) =       0.000429042676
  error estimate for blocks of size 2^( 7) =       0.000431210075

      target function =      -0.914115704525
              le_mean =     -17.206536196994
             les_mean =     296.364020755325
             stat err =       0.000427059871
             autocorr =       1.252126672303
   target nu stat err =       0.000427059871
   target dn stat err =       0.002359769328
      target stat err =       0.003718833907
              std dev =       0.539733815618
             le_variance =       0.291312591722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291341840560
                                         uncertainty =       0.001678549337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291341840560
                                         uncertainty =       0.001678549337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381649450
  error estimate for blocks of size 2^( 2) =       0.000396974110
  error estimate for blocks of size 2^( 3) =       0.000411023315
  error estimate for blocks of size 2^( 4) =       0.000421168539
  error estimate for blocks of size 2^( 5) =       0.000426818155
  error estimate for blocks of size 2^( 6) =       0.000429042658
  error estimate for blocks of size 2^( 7) =       0.000431210068

      target function =      -0.914116240119
              le_mean =     -17.206536200138
             les_mean =     296.364020517155
             stat err =       0.000427059855
             autocorr =       1.252126519621
   target nu stat err =       0.000427059855
   target dn stat err =       0.002359754524
      target stat err =       0.003718815749
              std dev =       0.539733828704
             le_variance =       0.291312605848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291341852334
                                         uncertainty =       0.001678544813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291341852334
                                         uncertainty =       0.001678544813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381649458
  error estimate for blocks of size 2^( 2) =       0.000396974111
  error estimate for blocks of size 2^( 3) =       0.000411023311
  error estimate for blocks of size 2^( 4) =       0.000421168527
  error estimate for blocks of size 2^( 5) =       0.000426818135
  error estimate for blocks of size 2^( 6) =       0.000429042641
  error estimate for blocks of size 2^( 7) =       0.000431210062

      target function =      -0.914116684793
              le_mean =     -17.206536202898
             les_mean =     296.364020324554
             stat err =       0.000427059841
             autocorr =       1.252126385926
   target nu stat err =       0.000427059841
   target dn stat err =       0.002359741933
      target stat err =       0.003718800219
              std dev =       0.539733840224
             le_variance =       0.291312618283


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914116746445        initial  <--
     8.6736e+01     8.6736e+02             4.4949e-06        -0.914115704525
     3.4694e+02     3.4694e+03             1.1238e-06        -0.914116240119
     1.3878e+03     1.3878e+04             2.8096e-07        -0.914116684793

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.9958
  </log>
  <optVariables href="H2O.s074.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297270e-02 1 1  ON 1
  uu_2                -3.786912e-02 1 1  ON 2
  uu_3                -9.122428e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674065e-02 1 1  ON 7
  uu_8                 5.806941e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564068e-02 1 1  ON 11
  ud_2                -2.647849e-02 1 1  ON 12
  ud_3                -7.930424e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460402e-02 1 1  ON 17
  ud_8                -6.256233e-03 1 1  ON 18
  ud_9                 8.581221e-02 1 1  ON 19
  eO_0                -7.034959e-01 1 1  ON 20
  eO_1                -4.202663e-01 1 1  ON 21
  eO_2                -4.180135e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335221e-01 1 1  ON 27
  eO_8                 2.929650e-02 1 1  ON 28
  eO_9                 1.920098e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604179e-02 1 1  ON 31
 eH1_2                -4.456909e-02 1 1  ON 32
 eH1_3                -1.424130e-02 1 1  ON 33
 eH1_4                 1.808387e-02 1 1  ON 34
 eH1_5                 2.186428e-02 1 1  ON 35
 eH1_6                 7.089838e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609476e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764757e-02 1 1  ON 41
 eH2_2                -4.626962e-02 1 1  ON 42
 eH2_3                -1.570857e-02 1 1  ON 43
 eH2_4                 1.609679e-02 1 1  ON 44
 eH2_5                 1.955082e-02 1 1  ON 45
 eH2_6                 7.199555e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035757e-01 1 1  ON 48
 eH2_9                 2.896440e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094302e-02 3 1  ON 51
ci_003                -1.140018e-02 3 1  ON 52
ci_004                 2.557825e-02 3 1  ON 53
ci_005                 2.573453e-02 3 1  ON 54
ci_006                -2.021027e-02 3 1  ON 55
ci_007                -1.979893e-02 3 1  ON 56
ci_008                -4.050761e-03 3 1  ON 57
ci_009                -1.516935e-02 3 1  ON 58
ci_010                -9.528453e-03 3 1  ON 59
ci_011                -9.637880e-03 3 1  ON 60
ci_012                -9.626909e-03 3 1  ON 61
ci_013                -2.166301e-02 3 1  ON 62
ci_014                 1.333032e-02 3 1  ON 63
ci_015                 1.313659e-02 3 1  ON 64
ci_016                 1.627930e-02 3 1  ON 65
ci_017                 1.612038e-02 3 1  ON 66
ci_018                 1.085995e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847008e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026982e-02 3 1  ON 71
ci_023                 1.028346e-02 3 1  ON 72
ci_024                 6.710414e-03 3 1  ON 73
ci_025                 6.515073e-03 3 1  ON 74
ci_026                 1.187387e-02 3 1  ON 75
ci_027                 1.184167e-02 3 1  ON 76
ci_028                -9.175658e-03 3 1  ON 77
ci_029                -9.753419e-03 3 1  ON 78
ci_030                -4.996009e-03 3 1  ON 79
ci_031                -4.662575e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1442e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.1502
    reference variance = 0.263671
====================================================
  Execution time = 1.9293e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5424e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9658e-01
  Total weights = 1.973516011e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7368e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288901233721
                                         uncertainty =       0.002177282221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288901233721
                                         uncertainty =       0.002177282221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380142144
  error estimate for blocks of size 2^( 2) =       0.000395639377
  error estimate for blocks of size 2^( 3) =       0.000409954424
  error estimate for blocks of size 2^( 4) =       0.000420023832
  error estimate for blocks of size 2^( 5) =       0.000426939774
  error estimate for blocks of size 2^( 6) =       0.000431311294
  error estimate for blocks of size 2^( 7) =       0.000434148151

      target function =      -0.918084818837
              le_mean =     -17.205933759616
             les_mean =     296.340735027842
             stat err =       0.000428105763
             autocorr =       1.268265292332
   target nu stat err =       0.000428105763
   target dn stat err =       0.002658244688
      target stat err =       0.004203839339
              std dev =       0.537602176149
             le_variance =       0.289016099800


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720593375962e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+02, overlap shift 8.6736e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918102922882       residual = 5.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918102944462       residual = 8.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918102950788       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918102950727       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918102951815       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918102952331       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918102952726       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918102953162       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918102953292       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918102953415       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918102953173       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918102953230       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918102953497       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918102953706       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918102953755       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918102953886       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918102953831       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918102953887       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918102953943       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918102953963       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918102954037       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918102953980       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918102953964       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918102954018       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918102954057       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918102954073       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918102954073       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918102954049       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918102954042       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918102954041       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918102954044       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918102954035       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918102954056       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918102954059       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918102954072       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918102954075       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.6736e+02 is 3.841722e-07

solving harmonic davidson linear method for identity shift 3.4694e+03, overlap shift 3.4694e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918102922882       residual = 5.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918102928277       residual = 8.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918102929859       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918102929844       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918102930117       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918102930248       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918102930346       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918102930452       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918102930481       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918102930515       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918102930444       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918102930461       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918102930540       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918102930591       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918102930598       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918102930624       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918102930616       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918102930642       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918102930645       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918102930658       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918102930665       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918102930688       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918102930665       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918102930669       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918102930671       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918102930688       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918102930676       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918102930674       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918102930673       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918102930656       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918102930672       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918102930644       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918102930657       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918102930675       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918102930675       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918102930666       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.4694e+03 is 9.604609e-08

solving harmonic davidson linear method for identity shift 1.3878e+04, overlap shift 1.3878e+05 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918102922882       residual = 5.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918102924231       residual = 8.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918102924626       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918102924622       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918102924706       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918102924716       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918102924723       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918102924789       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918102924790       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918102924772       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918102924787       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918102924778       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918102924792       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918102924809       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918102924832       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918102924835       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918102924783       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918102924842       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918102924803       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918102924843       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918102924831       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918102924812       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918102924822       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918102924838       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918102924806       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918102924789       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918102924894       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.918102924809       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.918102924799       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.918102924875       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.918102924910       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.918102924885       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.918102924819       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918102924823       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.918102924842       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.918102924782       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3878e+04 is 2.401171e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.249277 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5084e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297273e-02 1 1  ON 1
  uu_2                -3.786910e-02 1 1  ON 2
  uu_3                -9.122427e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674073e-02 1 1  ON 7
  uu_8                 5.806935e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564066e-02 1 1  ON 11
  ud_2                -2.647849e-02 1 1  ON 12
  ud_3                -7.930426e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264026e-01 1 1  ON 16
  ud_7                -8.460400e-02 1 1  ON 17
  ud_8                -6.256195e-03 1 1  ON 18
  ud_9                 8.581221e-02 1 1  ON 19
  eO_0                -7.034959e-01 1 1  ON 20
  eO_1                -4.202663e-01 1 1  ON 21
  eO_2                -4.180135e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929652e-02 1 1  ON 28
  eO_9                 1.920098e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604178e-02 1 1  ON 31
 eH1_2                -4.456909e-02 1 1  ON 32
 eH1_3                -1.424130e-02 1 1  ON 33
 eH1_4                 1.808387e-02 1 1  ON 34
 eH1_5                 2.186424e-02 1 1  ON 35
 eH1_6                 7.089833e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609477e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764761e-02 1 1  ON 41
 eH2_2                -4.626965e-02 1 1  ON 42
 eH2_3                -1.570862e-02 1 1  ON 43
 eH2_4                 1.609681e-02 1 1  ON 44
 eH2_5                 1.955092e-02 1 1  ON 45
 eH2_6                 7.199560e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165791e-02 3 1  ON 50
ci_002                -3.094302e-02 3 1  ON 51
ci_003                -1.140018e-02 3 1  ON 52
ci_004                 2.557824e-02 3 1  ON 53
ci_005                 2.573453e-02 3 1  ON 54
ci_006                -2.021027e-02 3 1  ON 55
ci_007                -1.979895e-02 3 1  ON 56
ci_008                -4.050793e-03 3 1  ON 57
ci_009                -1.516935e-02 3 1  ON 58
ci_010                -9.528460e-03 3 1  ON 59
ci_011                -9.637898e-03 3 1  ON 60
ci_012                -9.626923e-03 3 1  ON 61
ci_013                -2.166303e-02 3 1  ON 62
ci_014                 1.333032e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627930e-02 3 1  ON 65
ci_017                 1.612038e-02 3 1  ON 66
ci_018                 1.085995e-02 3 1  ON 67
ci_019                 1.052294e-02 3 1  ON 68
ci_020                 1.847006e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026982e-02 3 1  ON 71
ci_023                 1.028348e-02 3 1  ON 72
ci_024                 6.710409e-03 3 1  ON 73
ci_025                 6.515029e-03 3 1  ON 74
ci_026                 1.187388e-02 3 1  ON 75
ci_027                 1.184167e-02 3 1  ON 76
ci_028                -9.175655e-03 3 1  ON 77
ci_029                -9.753413e-03 3 1  ON 78
ci_030                -4.996013e-03 3 1  ON 79
ci_031                -4.662576e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.2974
    reference variance = 0.160845
====================================================
  Execution time = 1.8845e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9995e-01
  Total weights = 1.9735e+06
  Execution time = 1.6051e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289050562932
                                         uncertainty =       0.001655064160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289050562932
                                         uncertainty =       0.001655064160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380157042
  error estimate for blocks of size 2^( 2) =       0.000395323324
  error estimate for blocks of size 2^( 3) =       0.000409540933
  error estimate for blocks of size 2^( 4) =       0.000419420995
  error estimate for blocks of size 2^( 5) =       0.000425695944
  error estimate for blocks of size 2^( 6) =       0.000430376853
  error estimate for blocks of size 2^( 7) =       0.000432356346

      target function =      -0.912834212142
              le_mean =     -17.206465145690
             les_mean =     296.362391992728
             stat err =       0.000426962535
             autocorr =       1.261401827996
   target nu stat err =       0.000426962535
   target dn stat err =       0.003792677186
      target stat err =       0.005890436487
              std dev =       0.537623244838
             le_variance =       0.289038753391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289050565119
                                         uncertainty =       0.001655064933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289050565119
                                         uncertainty =       0.001655064933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380157044
  error estimate for blocks of size 2^( 2) =       0.000395323314
  error estimate for blocks of size 2^( 3) =       0.000409540910
  error estimate for blocks of size 2^( 4) =       0.000419420963
  error estimate for blocks of size 2^( 5) =       0.000425695907
  error estimate for blocks of size 2^( 6) =       0.000430376811
  error estimate for blocks of size 2^( 7) =       0.000432356293

      target function =      -0.912834197000
              le_mean =     -17.206465145530
             les_mean =     296.362391996876
             stat err =       0.000426962494
             autocorr =       1.261401575833
   target nu stat err =       0.000426962494
   target dn stat err =       0.003792691705
      target stat err =       0.005890458496
              std dev =       0.537623247126
             le_variance =       0.289038755850

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289050564025
                                         uncertainty =       0.001655064547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289050564025
                                         uncertainty =       0.001655064547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380157043
  error estimate for blocks of size 2^( 2) =       0.000395323319
  error estimate for blocks of size 2^( 3) =       0.000409540921
  error estimate for blocks of size 2^( 4) =       0.000419420979
  error estimate for blocks of size 2^( 5) =       0.000425695926
  error estimate for blocks of size 2^( 6) =       0.000430376832
  error estimate for blocks of size 2^( 7) =       0.000432356320

      target function =      -0.912834204738
              le_mean =     -17.206465145610
             les_mean =     296.362391994691
             stat err =       0.000426962514
             autocorr =       1.261401701911
   target nu stat err =       0.000426962514
   target dn stat err =       0.003792684444
      target stat err =       0.005890447491
              std dev =       0.537623245981
             le_variance =       0.289038754620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289050563069
                                         uncertainty =       0.001655064208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289050563069
                                         uncertainty =       0.001655064208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380157042
  error estimate for blocks of size 2^( 2) =       0.000395323323
  error estimate for blocks of size 2^( 3) =       0.000409540931
  error estimate for blocks of size 2^( 4) =       0.000419420993
  error estimate for blocks of size 2^( 5) =       0.000425695942
  error estimate for blocks of size 2^( 6) =       0.000430376850
  error estimate for blocks of size 2^( 7) =       0.000432356343

      target function =      -0.912834211235
              le_mean =     -17.206465145680
             les_mean =     296.362391992961
             stat err =       0.000426962532
             autocorr =       1.261401812235
   target nu stat err =       0.000426962532
   target dn stat err =       0.003792678094
      target stat err =       0.005890437862
              std dev =       0.537623244981
             le_variance =       0.289038753544


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912834212142        initial  <--
     8.6736e+02     8.6736e+03             3.8417e-07        -0.912834197000
     3.4694e+03     3.4694e+04             9.6046e-08        -0.912834204738
     1.3878e+04     1.3878e+05             2.4012e-08        -0.912834211235

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.7708
  </log>
  <optVariables href="H2O.s075.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297270e-02 1 1  ON 1
  uu_2                -3.786912e-02 1 1  ON 2
  uu_3                -9.122428e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674065e-02 1 1  ON 7
  uu_8                 5.806941e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564068e-02 1 1  ON 11
  ud_2                -2.647849e-02 1 1  ON 12
  ud_3                -7.930424e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460402e-02 1 1  ON 17
  ud_8                -6.256233e-03 1 1  ON 18
  ud_9                 8.581221e-02 1 1  ON 19
  eO_0                -7.034959e-01 1 1  ON 20
  eO_1                -4.202663e-01 1 1  ON 21
  eO_2                -4.180135e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335221e-01 1 1  ON 27
  eO_8                 2.929650e-02 1 1  ON 28
  eO_9                 1.920098e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604179e-02 1 1  ON 31
 eH1_2                -4.456909e-02 1 1  ON 32
 eH1_3                -1.424130e-02 1 1  ON 33
 eH1_4                 1.808387e-02 1 1  ON 34
 eH1_5                 2.186428e-02 1 1  ON 35
 eH1_6                 7.089838e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609476e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764757e-02 1 1  ON 41
 eH2_2                -4.626962e-02 1 1  ON 42
 eH2_3                -1.570857e-02 1 1  ON 43
 eH2_4                 1.609679e-02 1 1  ON 44
 eH2_5                 1.955082e-02 1 1  ON 45
 eH2_6                 7.199555e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035757e-01 1 1  ON 48
 eH2_9                 2.896440e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094302e-02 3 1  ON 51
ci_003                -1.140018e-02 3 1  ON 52
ci_004                 2.557825e-02 3 1  ON 53
ci_005                 2.573453e-02 3 1  ON 54
ci_006                -2.021027e-02 3 1  ON 55
ci_007                -1.979893e-02 3 1  ON 56
ci_008                -4.050761e-03 3 1  ON 57
ci_009                -1.516935e-02 3 1  ON 58
ci_010                -9.528453e-03 3 1  ON 59
ci_011                -9.637880e-03 3 1  ON 60
ci_012                -9.626909e-03 3 1  ON 61
ci_013                -2.166301e-02 3 1  ON 62
ci_014                 1.333032e-02 3 1  ON 63
ci_015                 1.313659e-02 3 1  ON 64
ci_016                 1.627930e-02 3 1  ON 65
ci_017                 1.612038e-02 3 1  ON 66
ci_018                 1.085995e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847008e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026982e-02 3 1  ON 71
ci_023                 1.028346e-02 3 1  ON 72
ci_024                 6.710414e-03 3 1  ON 73
ci_025                 6.515073e-03 3 1  ON 74
ci_026                 1.187387e-02 3 1  ON 75
ci_027                 1.184167e-02 3 1  ON 76
ci_028                -9.175658e-03 3 1  ON 77
ci_029                -9.753419e-03 3 1  ON 78
ci_030                -4.996009e-03 3 1  ON 79
ci_031                -4.662575e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1862e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.1727
    reference variance = 0.164267
====================================================
  Execution time = 1.9065e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5412e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0173e-01
  Total weights = 1.974028482e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5215e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292522419525
                                         uncertainty =       0.002772139531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292522419525
                                         uncertainty =       0.002772139531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382489101
  error estimate for blocks of size 2^( 2) =       0.000397707904
  error estimate for blocks of size 2^( 3) =       0.000412057927
  error estimate for blocks of size 2^( 4) =       0.000422659379
  error estimate for blocks of size 2^( 5) =       0.000428883870
  error estimate for blocks of size 2^( 6) =       0.000430229284
  error estimate for blocks of size 2^( 7) =       0.000430950756

      target function =      -0.910131390863
              le_mean =     -17.205507453762
             les_mean =     296.331217008788
             stat err =       0.000428180822
             autocorr =       1.253188197605
   target nu stat err =       0.000428180822
   target dn stat err =       0.003250672368
      target stat err =       0.005023996092
              std dev =       0.540921273513
             le_variance =       0.292595824139


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720550745376e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+03, overlap shift 8.6736e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910158075163       residual = 5.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910158077041       residual = 7.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910158077530       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910158077615       residual = 8.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910158077676       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910158077707       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910158077721       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910158077703       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910158077717       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910158077725       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910158077771       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910158077816       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910158077782       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910158077816       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910158077815       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910158077826       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910158077822       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910158077841       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910158077849       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910158077809       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910158077828       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910158077830       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910158077826       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910158077826       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910158077856       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910158077840       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910158077835       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910158077825       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910158077816       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910158077806       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910158077846       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910158077834       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910158077838       residual = 9.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.6736e+03 is 4.183829e-08

solving harmonic davidson linear method for identity shift 3.4694e+04, overlap shift 3.4694e+05 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910158075163       residual = 5.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910158075633       residual = 7.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910158075755       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910158075776       residual = 8.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910158075792       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910158075818       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910158075822       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910158075836       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910158075800       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910158075758       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910158075747       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910158075741       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910158075839       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910158075840       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910158075765       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910158075834       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910158075650       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910158075756       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910158075800       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910158075811       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910158075811       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910158075772       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910158075782       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910158075889       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910158075788       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910158075967       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910158075726       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910158075815       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910158075817       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910158075946       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910158075879       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910158075797       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910158075789       residual = 9.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.4694e+04 is 1.045961e-08

solving harmonic davidson linear method for identity shift 1.3878e+05, overlap shift 1.3878e+06 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910158075163       residual = 5.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910158075281       residual = 7.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910158075311       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910158075304       residual = 8.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910158075320       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910158075245       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910158075389       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910158075300       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910158075738       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910158075506       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910158075548       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910158075380       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910158075211       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910158075437       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910158074770       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910158075625       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910158075207       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910158075457       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910158075535       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910158075650       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910158075685       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910158075243       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910158075606       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910158075433       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910158074981       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910158075248       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910158075460       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910158075448       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910158075337       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910158074992       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910158075151       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910158075313       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910158075284       residual = 9.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3878e+05 is 2.614904e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.287542 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4630e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297270e-02 1 1  ON 1
  uu_2                -3.786912e-02 1 1  ON 2
  uu_3                -9.122428e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674065e-02 1 1  ON 7
  uu_8                 5.806940e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564067e-02 1 1  ON 11
  ud_2                -2.647849e-02 1 1  ON 12
  ud_3                -7.930424e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460401e-02 1 1  ON 17
  ud_8                -6.256234e-03 1 1  ON 18
  ud_9                 8.581221e-02 1 1  ON 19
  eO_0                -7.034959e-01 1 1  ON 20
  eO_1                -4.202663e-01 1 1  ON 21
  eO_2                -4.180135e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335221e-01 1 1  ON 27
  eO_8                 2.929650e-02 1 1  ON 28
  eO_9                 1.920098e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604178e-02 1 1  ON 31
 eH1_2                -4.456909e-02 1 1  ON 32
 eH1_3                -1.424130e-02 1 1  ON 33
 eH1_4                 1.808387e-02 1 1  ON 34
 eH1_5                 2.186428e-02 1 1  ON 35
 eH1_6                 7.089838e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609476e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764757e-02 1 1  ON 41
 eH2_2                -4.626962e-02 1 1  ON 42
 eH2_3                -1.570857e-02 1 1  ON 43
 eH2_4                 1.609679e-02 1 1  ON 44
 eH2_5                 1.955081e-02 1 1  ON 45
 eH2_6                 7.199555e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035757e-01 1 1  ON 48
 eH2_9                 2.896440e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094302e-02 3 1  ON 51
ci_003                -1.140018e-02 3 1  ON 52
ci_004                 2.557825e-02 3 1  ON 53
ci_005                 2.573453e-02 3 1  ON 54
ci_006                -2.021027e-02 3 1  ON 55
ci_007                -1.979894e-02 3 1  ON 56
ci_008                -4.050764e-03 3 1  ON 57
ci_009                -1.516935e-02 3 1  ON 58
ci_010                -9.528453e-03 3 1  ON 59
ci_011                -9.637879e-03 3 1  ON 60
ci_012                -9.626907e-03 3 1  ON 61
ci_013                -2.166301e-02 3 1  ON 62
ci_014                 1.333032e-02 3 1  ON 63
ci_015                 1.313659e-02 3 1  ON 64
ci_016                 1.627930e-02 3 1  ON 65
ci_017                 1.612038e-02 3 1  ON 66
ci_018                 1.085995e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847008e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026982e-02 3 1  ON 71
ci_023                 1.028346e-02 3 1  ON 72
ci_024                 6.710414e-03 3 1  ON 73
ci_025                 6.515073e-03 3 1  ON 74
ci_026                 1.187387e-02 3 1  ON 75
ci_027                 1.184168e-02 3 1  ON 76
ci_028                -9.175659e-03 3 1  ON 77
ci_029                -9.753419e-03 3 1  ON 78
ci_030                -4.996007e-03 3 1  ON 79
ci_031                -4.662573e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.2031
    reference variance = 0.202938
====================================================
  Execution time = 1.9073e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9348e-01
  Total weights = 1.9737e+06
  Execution time = 1.5986e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288051782172
                                         uncertainty =       0.001769131762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288051782172
                                         uncertainty =       0.001769131762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379492125
  error estimate for blocks of size 2^( 2) =       0.000395188001
  error estimate for blocks of size 2^( 3) =       0.000409602405
  error estimate for blocks of size 2^( 4) =       0.000420026314
  error estimate for blocks of size 2^( 5) =       0.000425768679
  error estimate for blocks of size 2^( 6) =       0.000429296979
  error estimate for blocks of size 2^( 7) =       0.000430825273

      target function =      -0.922948448748
              le_mean =     -17.206436853034
             les_mean =     296.354945533770
             stat err =       0.000426479311
             autocorr =       1.262962339197
   target nu stat err =       0.000426479311
   target dn stat err =       0.002051840545
      target stat err =       0.003313952244
              std dev =       0.536682909674
             le_variance =       0.288028545536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288051779425
                                         uncertainty =       0.001769131715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288051779425
                                         uncertainty =       0.001769131715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379492123
  error estimate for blocks of size 2^( 2) =       0.000395187999
  error estimate for blocks of size 2^( 3) =       0.000409602404
  error estimate for blocks of size 2^( 4) =       0.000420026313
  error estimate for blocks of size 2^( 5) =       0.000425768677
  error estimate for blocks of size 2^( 6) =       0.000429296978
  error estimate for blocks of size 2^( 7) =       0.000430825273

      target function =      -0.922948452559
              le_mean =     -17.206436853011
             les_mean =     296.354945530552
             stat err =       0.000426479310
             autocorr =       1.262962344839
   target nu stat err =       0.000426479310
   target dn stat err =       0.002051840235
      target stat err =       0.003313951793
              std dev =       0.536682907095
             le_variance =       0.288028542768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288051780799
                                         uncertainty =       0.001769131738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288051780799
                                         uncertainty =       0.001769131738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379492124
  error estimate for blocks of size 2^( 2) =       0.000395188000
  error estimate for blocks of size 2^( 3) =       0.000409602405
  error estimate for blocks of size 2^( 4) =       0.000420026313
  error estimate for blocks of size 2^( 5) =       0.000425768678
  error estimate for blocks of size 2^( 6) =       0.000429296978
  error estimate for blocks of size 2^( 7) =       0.000430825273

      target function =      -0.922948450654
              le_mean =     -17.206436853023
             les_mean =     296.354945532161
             stat err =       0.000426479311
             autocorr =       1.262962342016
   target nu stat err =       0.000426479311
   target dn stat err =       0.002051840390
      target stat err =       0.003313952018
              std dev =       0.536682908384
             le_variance =       0.288028544152

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288051782000
                                         uncertainty =       0.001769131759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288051782000
                                         uncertainty =       0.001769131759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379492125
  error estimate for blocks of size 2^( 2) =       0.000395188001
  error estimate for blocks of size 2^( 3) =       0.000409602405
  error estimate for blocks of size 2^( 4) =       0.000420026314
  error estimate for blocks of size 2^( 5) =       0.000425768678
  error estimate for blocks of size 2^( 6) =       0.000429296979
  error estimate for blocks of size 2^( 7) =       0.000430825273

      target function =      -0.922948448987
              le_mean =     -17.206436853033
             les_mean =     296.354945533568
             stat err =       0.000426479311
             autocorr =       1.262962339544
   target nu stat err =       0.000426479311
   target dn stat err =       0.002051840526
      target stat err =       0.003313952215
              std dev =       0.536682909513
             le_variance =       0.288028545363


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.922948448748        initial
     8.6736e+03     8.6736e+04             4.1838e-08        -0.922948452559  <--
     3.4694e+04     3.4694e+05             1.0460e-08        -0.922948450654
     1.3878e+05     1.3878e+06             2.6149e-09        -0.922948448987

*****************************************************************************
Applying the update for shift_i =   8.6736e+03     and shift_s =   8.6736e+04
*****************************************************************************

  Execution time = 2.6980e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297271e-02 1 1  ON 1
  uu_2                -3.786911e-02 1 1  ON 2
  uu_3                -9.122427e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674067e-02 1 1  ON 7
  uu_8                 5.806938e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564067e-02 1 1  ON 11
  ud_2                -2.647849e-02 1 1  ON 12
  ud_3                -7.930424e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460399e-02 1 1  ON 17
  ud_8                -6.256236e-03 1 1  ON 18
  ud_9                 8.581220e-02 1 1  ON 19
  eO_0                -7.034959e-01 1 1  ON 20
  eO_1                -4.202663e-01 1 1  ON 21
  eO_2                -4.180136e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335221e-01 1 1  ON 27
  eO_8                 2.929650e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604178e-02 1 1  ON 31
 eH1_2                -4.456909e-02 1 1  ON 32
 eH1_3                -1.424130e-02 1 1  ON 33
 eH1_4                 1.808387e-02 1 1  ON 34
 eH1_5                 2.186429e-02 1 1  ON 35
 eH1_6                 7.089837e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609476e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764756e-02 1 1  ON 41
 eH2_2                -4.626962e-02 1 1  ON 42
 eH2_3                -1.570857e-02 1 1  ON 43
 eH2_4                 1.609679e-02 1 1  ON 44
 eH2_5                 1.955078e-02 1 1  ON 45
 eH2_6                 7.199555e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035757e-01 1 1  ON 48
 eH2_9                 2.896440e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094302e-02 3 1  ON 51
ci_003                -1.140019e-02 3 1  ON 52
ci_004                 2.557825e-02 3 1  ON 53
ci_005                 2.573453e-02 3 1  ON 54
ci_006                -2.021027e-02 3 1  ON 55
ci_007                -1.979894e-02 3 1  ON 56
ci_008                -4.050772e-03 3 1  ON 57
ci_009                -1.516934e-02 3 1  ON 58
ci_010                -9.528454e-03 3 1  ON 59
ci_011                -9.637878e-03 3 1  ON 60
ci_012                -9.626900e-03 3 1  ON 61
ci_013                -2.166301e-02 3 1  ON 62
ci_014                 1.333033e-02 3 1  ON 63
ci_015                 1.313659e-02 3 1  ON 64
ci_016                 1.627930e-02 3 1  ON 65
ci_017                 1.612038e-02 3 1  ON 66
ci_018                 1.085995e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847008e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026982e-02 3 1  ON 71
ci_023                 1.028345e-02 3 1  ON 72
ci_024                 6.710414e-03 3 1  ON 73
ci_025                 6.515072e-03 3 1  ON 74
ci_026                 1.187388e-02 3 1  ON 75
ci_027                 1.184168e-02 3 1  ON 76
ci_028                -9.175659e-03 3 1  ON 77
ci_029                -9.753418e-03 3 1  ON 78
ci_030                -4.996003e-03 3 1  ON 79
ci_031                -4.662568e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1616e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.1921
    reference variance = 0.365548
====================================================
  Execution time = 1.9120e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5435e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9815e-01
  Total weights = 1.973597456e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291255487341
                                         uncertainty =       0.001841960200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291255487341
                                         uncertainty =       0.001841960200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381603888
  error estimate for blocks of size 2^( 2) =       0.000397206139
  error estimate for blocks of size 2^( 3) =       0.000410982763
  error estimate for blocks of size 2^( 4) =       0.000421400059
  error estimate for blocks of size 2^( 5) =       0.000426968757
  error estimate for blocks of size 2^( 6) =       0.000431016508
  error estimate for blocks of size 2^( 7) =       0.000431321172

      target function =      -0.915636586743
              le_mean =     -17.206336607913
             les_mean =     296.356174186747
             stat err =       0.000427676624
             autocorr =       1.256045712115
   target nu stat err =       0.000427676624
   target dn stat err =       0.002100643728
      target stat err =       0.003336584144
              std dev =       0.539669393358
             le_variance =       0.291243054127


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720633660791e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+03, overlap shift 2.1684e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915647796128       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915647802203       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915647804749       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915647805490       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915647805432       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915647805481       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915647805504       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915647805410       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915647805468       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915647805565       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915647805646       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915647805655       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915647805727       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915647805784       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915647805808       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915647805808       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915647805851       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915647805934       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915647805981       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915647805962       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915647805976       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915647805984       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915647805973       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915647805998       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915647806011       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915647805997       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915647805976       residual = 9.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915647805995       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915647805997       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915647805990       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915647805997       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915647805990       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915647806000       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915647805997       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+03 is 1.429940e-07

solving harmonic davidson linear method for identity shift 8.6736e+03, overlap shift 8.6736e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915647796128       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915647797647       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915647798283       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915647798469       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915647798454       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915647798461       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915647798471       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915647798447       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915647798452       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915647798483       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915647798508       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915647798497       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915647798499       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915647798542       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915647798560       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915647798534       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915647798546       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915647798579       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915647798589       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915647798583       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915647798585       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915647798617       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915647798570       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915647798590       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915647798645       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915647798578       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915647798617       residual = 9.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915647798593       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915647798611       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915647798614       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915647798579       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915647798591       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915647798598       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915647798627       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.6736e+03 is 3.574855e-08

solving harmonic davidson linear method for identity shift 3.4694e+04, overlap shift 3.4694e+05 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915647796128       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915647796508       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915647796667       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915647796713       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915647796707       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915647796732       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915647796706       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915647796646       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915647796712       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915647796815       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915647796826       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915647796633       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915647796852       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915647796689       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915647796733       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915647796836       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915647796708       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915647796698       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915647796601       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915647796386       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915647796677       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915647796877       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915647796779       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915647796725       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915647796793       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915647796707       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915647796754       residual = 9.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915647796547       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915647796740       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915647796830       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915647796726       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915647796766       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915647796700       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915647796698       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.4694e+04 is 8.937141e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.329683 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4654e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297273e-02 1 1  ON 1
  uu_2                -3.786909e-02 1 1  ON 2
  uu_3                -9.122426e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674069e-02 1 1  ON 7
  uu_8                 5.806934e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564065e-02 1 1  ON 11
  ud_2                -2.647850e-02 1 1  ON 12
  ud_3                -7.930425e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460398e-02 1 1  ON 17
  ud_8                -6.256228e-03 1 1  ON 18
  ud_9                 8.581219e-02 1 1  ON 19
  eO_0                -7.034959e-01 1 1  ON 20
  eO_1                -4.202663e-01 1 1  ON 21
  eO_2                -4.180137e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335221e-01 1 1  ON 27
  eO_8                 2.929650e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604178e-02 1 1  ON 31
 eH1_2                -4.456909e-02 1 1  ON 32
 eH1_3                -1.424129e-02 1 1  ON 33
 eH1_4                 1.808387e-02 1 1  ON 34
 eH1_5                 2.186428e-02 1 1  ON 35
 eH1_6                 7.089836e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609477e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764756e-02 1 1  ON 41
 eH2_2                -4.626962e-02 1 1  ON 42
 eH2_3                -1.570856e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955077e-02 1 1  ON 45
 eH2_6                 7.199553e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035757e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094302e-02 3 1  ON 51
ci_003                -1.140019e-02 3 1  ON 52
ci_004                 2.557825e-02 3 1  ON 53
ci_005                 2.573453e-02 3 1  ON 54
ci_006                -2.021026e-02 3 1  ON 55
ci_007                -1.979895e-02 3 1  ON 56
ci_008                -4.050773e-03 3 1  ON 57
ci_009                -1.516933e-02 3 1  ON 58
ci_010                -9.528451e-03 3 1  ON 59
ci_011                -9.637869e-03 3 1  ON 60
ci_012                -9.626903e-03 3 1  ON 61
ci_013                -2.166300e-02 3 1  ON 62
ci_014                 1.333032e-02 3 1  ON 63
ci_015                 1.313659e-02 3 1  ON 64
ci_016                 1.627929e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085995e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847008e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026983e-02 3 1  ON 71
ci_023                 1.028344e-02 3 1  ON 72
ci_024                 6.710407e-03 3 1  ON 73
ci_025                 6.515076e-03 3 1  ON 74
ci_026                 1.187387e-02 3 1  ON 75
ci_027                 1.184167e-02 3 1  ON 76
ci_028                -9.175662e-03 3 1  ON 77
ci_029                -9.753419e-03 3 1  ON 78
ci_030                -4.995994e-03 3 1  ON 79
ci_031                -4.662559e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.2249
    reference variance = 0.144994
====================================================
  Execution time = 1.8928e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0477e-01
  Total weights = 1.9736e+06
  Execution time = 1.6030e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292738051798
                                         uncertainty =       0.002329442537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292738051798
                                         uncertainty =       0.002329442537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382562933
  error estimate for blocks of size 2^( 2) =       0.000397994260
  error estimate for blocks of size 2^( 3) =       0.000412364271
  error estimate for blocks of size 2^( 4) =       0.000422606213
  error estimate for blocks of size 2^( 5) =       0.000429619474
  error estimate for blocks of size 2^( 6) =       0.000432294566
  error estimate for blocks of size 2^( 7) =       0.000432942598

      target function =      -0.905439204929
              le_mean =     -17.206990627995
             les_mean =     296.385296819545
             stat err =       0.000429365713
             autocorr =       1.259647252671
   target nu stat err =       0.000429365713
   target dn stat err =       0.004037889181
      target stat err =       0.006171802393
              std dev =       0.541025688756
             le_variance =       0.292708795894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292738053794
                                         uncertainty =       0.002329445361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292738053794
                                         uncertainty =       0.002329445361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382562935
  error estimate for blocks of size 2^( 2) =       0.000397994264
  error estimate for blocks of size 2^( 3) =       0.000412364279
  error estimate for blocks of size 2^( 4) =       0.000422606224
  error estimate for blocks of size 2^( 5) =       0.000429619484
  error estimate for blocks of size 2^( 6) =       0.000432294578
  error estimate for blocks of size 2^( 7) =       0.000432942610

      target function =      -0.905439298664
              le_mean =     -17.206990627611
             les_mean =     296.385296745003
             stat err =       0.000429365724
             autocorr =       1.259647309502
   target nu stat err =       0.000429365724
   target dn stat err =       0.004037857588
      target stat err =       0.006171756024
              std dev =       0.541025690596
             le_variance =       0.292708797884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292738052796
                                         uncertainty =       0.002329443949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292738052796
                                         uncertainty =       0.002329443949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382562934
  error estimate for blocks of size 2^( 2) =       0.000397994262
  error estimate for blocks of size 2^( 3) =       0.000412364275
  error estimate for blocks of size 2^( 4) =       0.000422606219
  error estimate for blocks of size 2^( 5) =       0.000429619479
  error estimate for blocks of size 2^( 6) =       0.000432294572
  error estimate for blocks of size 2^( 7) =       0.000432942604

      target function =      -0.905439251823
              le_mean =     -17.206990627803
             les_mean =     296.385296782256
             stat err =       0.000429365718
             autocorr =       1.259647281077
   target nu stat err =       0.000429365718
   target dn stat err =       0.004037873382
      target stat err =       0.006171779206
              std dev =       0.541025689676
             le_variance =       0.292708796889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292738051923
                                         uncertainty =       0.002329442713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292738051923
                                         uncertainty =       0.002329442713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382562933
  error estimate for blocks of size 2^( 2) =       0.000397994260
  error estimate for blocks of size 2^( 3) =       0.000412364271
  error estimate for blocks of size 2^( 4) =       0.000422606214
  error estimate for blocks of size 2^( 5) =       0.000429619474
  error estimate for blocks of size 2^( 6) =       0.000432294567
  error estimate for blocks of size 2^( 7) =       0.000432942598

      target function =      -0.905439210793
              le_mean =     -17.206990627971
             les_mean =     296.385296814882
             stat err =       0.000429365713
             autocorr =       1.259647256223
   target nu stat err =       0.000429365713
   target dn stat err =       0.004037887206
      target stat err =       0.006171799494
              std dev =       0.541025688871
             le_variance =       0.292708796018


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.905439204929        initial
     2.1684e+03     2.1684e+04             1.4299e-07        -0.905439298664  <--
     8.6736e+03     8.6736e+04             3.5749e-08        -0.905439251823
     3.4694e+04     3.4694e+05             8.9371e-09        -0.905439210793

*****************************************************************************
Applying the update for shift_i =   2.1684e+03     and shift_s =   2.1684e+04
*****************************************************************************

  Execution time = 2.6847e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806924e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256204e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637843e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627928e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710388e-03 3 1  ON 73
ci_025                 6.515087e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175671e-03 3 1  ON 77
ci_029                -9.753423e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662532e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1508e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.2067
    reference variance = 0.218973
====================================================
  Execution time = 1.9264e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5448e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0078e-01
  Total weights = 1.973819474e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6104e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292362634706
                                         uncertainty =       0.002032435613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292362634706
                                         uncertainty =       0.002032435613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382346248
  error estimate for blocks of size 2^( 2) =       0.000397518003
  error estimate for blocks of size 2^( 3) =       0.000411557144
  error estimate for blocks of size 2^( 4) =       0.000421704395
  error estimate for blocks of size 2^( 5) =       0.000428395189
  error estimate for blocks of size 2^( 6) =       0.000431558367
  error estimate for blocks of size 2^( 7) =       0.000433716494

      target function =      -0.911599948007
              le_mean =     -17.205691767756
             les_mean =     296.336604222222
             stat err =       0.000428843611
             autocorr =       1.258010378063
   target nu stat err =       0.000428843611
   target dn stat err =       0.002663920074
      target stat err =       0.004152485800
              std dev =       0.540719249235
             le_variance =       0.292377306494


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720569176776e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+02, overlap shift 5.4210e+03 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911617647470       residual = 4.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911617683732       residual = 9.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911617691391       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911617692644       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911617693260       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911617693042       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911617693859       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911617694012       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911617694197       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911617694524       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911617694449       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911617694350       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911617694888       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911617695101       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911617695020       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911617695143       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911617694994       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911617695065       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911617695154       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911617695183       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911617695345       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911617695403       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911617695362       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911617695455       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911617695512       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911617695553       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911617695522       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911617695530       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911617695512       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911617695502       residual = 9.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911617695505       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911617695502       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911617695507       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911617695515       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911617695513       residual = 5.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+02 is 5.070498e-07

solving harmonic davidson linear method for identity shift 2.1684e+03, overlap shift 2.1684e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911617647470       residual = 4.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911617656536       residual = 9.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911617658451       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911617658764       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911617658917       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911617658864       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911617659071       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911617659101       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911617659153       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911617659235       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911617659215       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911617659191       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911617659325       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911617659376       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911617659360       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911617659383       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911617659355       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911617659372       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911617659393       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911617659400       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911617659431       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911617659462       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911617659456       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911617659456       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911617659466       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911617659487       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911617659484       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911617659483       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911617659480       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911617659482       residual = 9.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911617659485       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911617659479       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911617659477       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911617659483       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911617659495       residual = 5.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+03 is 1.267636e-07

solving harmonic davidson linear method for identity shift 8.6736e+03, overlap shift 8.6736e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911617647470       residual = 4.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911617649737       residual = 9.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911617650215       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911617650294       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911617650331       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911617650313       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911617650373       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911617650384       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911617650376       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911617650421       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911617650405       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911617650379       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911617650447       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911617650417       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911617650410       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911617650421       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911617650438       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911617650454       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911617650476       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911617650483       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911617650458       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911617650492       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911617650445       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911617650466       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911617650475       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911617650454       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911617650486       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911617650438       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911617650434       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911617650475       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911617650473       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911617650499       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911617650451       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911617650479       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911617650461       residual = 5.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.6736e+03 is 3.169097e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.375075 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4925e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786907e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298131e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674079e-02 1 1  ON 7
  uu_8                 5.806918e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564063e-02 1 1  ON 11
  ud_2                -2.647851e-02 1 1  ON 12
  ud_3                -7.930427e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264026e-01 1 1  ON 16
  ud_7                -8.460391e-02 1 1  ON 17
  ud_8                -6.256230e-03 1 1  ON 18
  ud_9                 8.581208e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180145e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335223e-01 1 1  ON 27
  eO_8                 2.929653e-02 1 1  ON 28
  eO_9                 1.920100e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604170e-02 1 1  ON 31
 eH1_2                -4.456902e-02 1 1  ON 32
 eH1_3                -1.424124e-02 1 1  ON 33
 eH1_4                 1.808386e-02 1 1  ON 34
 eH1_5                 2.186415e-02 1 1  ON 35
 eH1_6                 7.089821e-02 1 1  ON 36
 eH1_7                 1.025484e-01 1 1  ON 37
 eH1_8                 1.010701e-01 1 1  ON 38
 eH1_9                 2.609480e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764758e-02 1 1  ON 41
 eH2_2                -4.626960e-02 1 1  ON 42
 eH2_3                -1.570847e-02 1 1  ON 43
 eH2_4                 1.609683e-02 1 1  ON 44
 eH2_5                 1.955076e-02 1 1  ON 45
 eH2_6                 7.199537e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896442e-02 1 1  ON 49
ci_001                -4.165789e-02 3 1  ON 50
ci_002                -3.094303e-02 3 1  ON 51
ci_003                -1.140018e-02 3 1  ON 52
ci_004                 2.557826e-02 3 1  ON 53
ci_005                 2.573457e-02 3 1  ON 54
ci_006                -2.021026e-02 3 1  ON 55
ci_007                -1.979900e-02 3 1  ON 56
ci_008                -4.050800e-03 3 1  ON 57
ci_009                -1.516930e-02 3 1  ON 58
ci_010                -9.528427e-03 3 1  ON 59
ci_011                -9.637811e-03 3 1  ON 60
ci_012                -9.626883e-03 3 1  ON 61
ci_013                -2.166297e-02 3 1  ON 62
ci_014                 1.333030e-02 3 1  ON 63
ci_015                 1.313662e-02 3 1  ON 64
ci_016                 1.627928e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085991e-02 3 1  ON 67
ci_019                 1.052290e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812545e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028343e-02 3 1  ON 72
ci_024                 6.710374e-03 3 1  ON 73
ci_025                 6.515081e-03 3 1  ON 74
ci_026                 1.187384e-02 3 1  ON 75
ci_027                 1.184169e-02 3 1  ON 76
ci_028                -9.175676e-03 3 1  ON 77
ci_029                -9.753393e-03 3 1  ON 78
ci_030                -4.995954e-03 3 1  ON 79
ci_031                -4.662481e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.2083
    reference variance = 0.22949
====================================================
  Execution time = 1.8762e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9638e-01
  Total weights = 1.9737e+06
  Execution time = 1.6001e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287775207942
                                         uncertainty =       0.001488459658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287775207942
                                         uncertainty =       0.001488459658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379340646
  error estimate for blocks of size 2^( 2) =       0.000394443170
  error estimate for blocks of size 2^( 3) =       0.000408536332
  error estimate for blocks of size 2^( 4) =       0.000418745906
  error estimate for blocks of size 2^( 5) =       0.000425047075
  error estimate for blocks of size 2^( 6) =       0.000427001100
  error estimate for blocks of size 2^( 7) =       0.000428549983

      target function =      -0.918388992405
              le_mean =     -17.205559358242
             les_mean =     296.327657491104
             stat err =       0.000424836016
             autocorr =       1.254249381918
   target nu stat err =       0.000424836016
   target dn stat err =       0.002755102346
      target stat err =       0.004351437072
              std dev =       0.536468686693
             le_variance =       0.287798651802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287775211445
                                         uncertainty =       0.001488458572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287775211445
                                         uncertainty =       0.001488458572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379340648
  error estimate for blocks of size 2^( 2) =       0.000394443184
  error estimate for blocks of size 2^( 3) =       0.000408536356
  error estimate for blocks of size 2^( 4) =       0.000418745936
  error estimate for blocks of size 2^( 5) =       0.000425047106
  error estimate for blocks of size 2^( 6) =       0.000427001131
  error estimate for blocks of size 2^( 7) =       0.000428550017

      target function =      -0.918388804686
              le_mean =     -17.205559358879
             les_mean =     296.327657632846
             stat err =       0.000424836048
             autocorr =       1.254249555022
   target nu stat err =       0.000424836048
   target dn stat err =       0.002755174664
      target stat err =       0.004351546425
              std dev =       0.536468689687
             le_variance =       0.287798655014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287775209692
                                         uncertainty =       0.001488459115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287775209692
                                         uncertainty =       0.001488459115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379340647
  error estimate for blocks of size 2^( 2) =       0.000394443177
  error estimate for blocks of size 2^( 3) =       0.000408536344
  error estimate for blocks of size 2^( 4) =       0.000418745921
  error estimate for blocks of size 2^( 5) =       0.000425047091
  error estimate for blocks of size 2^( 6) =       0.000427001116
  error estimate for blocks of size 2^( 7) =       0.000428550000

      target function =      -0.918388898570
              le_mean =     -17.205559358561
             les_mean =     296.327657561954
             stat err =       0.000424836032
             autocorr =       1.254249468480
   target nu stat err =       0.000424836032
   target dn stat err =       0.002755138507
      target stat err =       0.004351491751
              std dev =       0.536468688189
             le_variance =       0.287798653407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287775208161
                                         uncertainty =       0.001488459590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287775208161
                                         uncertainty =       0.001488459590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379340646
  error estimate for blocks of size 2^( 2) =       0.000394443171
  error estimate for blocks of size 2^( 3) =       0.000408536334
  error estimate for blocks of size 2^( 4) =       0.000418745908
  error estimate for blocks of size 2^( 5) =       0.000425047077
  error estimate for blocks of size 2^( 6) =       0.000427001102
  error estimate for blocks of size 2^( 7) =       0.000428549985

      target function =      -0.918388980679
              le_mean =     -17.205559358282
             les_mean =     296.327657499957
             stat err =       0.000424836018
             autocorr =       1.254249392727
   target nu stat err =       0.000424836018
   target dn stat err =       0.002755106866
      target stat err =       0.004351443906
              std dev =       0.536468686880
             le_variance =       0.287798652003


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918388992405        initial  <--
     5.4210e+02     5.4210e+03             5.0705e-07        -0.918388804686
     2.1684e+03     2.1684e+04             1.2676e-07        -0.918388898570
     8.6736e+03     8.6736e+04             3.1691e-08        -0.918388980679

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7937
  </log>
  <optVariables href="H2O.s078.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806924e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256204e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637843e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627928e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710388e-03 3 1  ON 73
ci_025                 6.515087e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175671e-03 3 1  ON 77
ci_029                -9.753423e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662532e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5725e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.2665
    reference variance = 0.311688
====================================================
  Execution time = 1.8970e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5417e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.1023e-01
  Total weights = 1.973838476e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4909e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295898421776
                                         uncertainty =       0.003900681462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295898421776
                                         uncertainty =       0.003900681462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384630014
  error estimate for blocks of size 2^( 2) =       0.000399701693
  error estimate for blocks of size 2^( 3) =       0.000413526749
  error estimate for blocks of size 2^( 4) =       0.000424155317
  error estimate for blocks of size 2^( 5) =       0.000429465449
  error estimate for blocks of size 2^( 6) =       0.000430737097
  error estimate for blocks of size 2^( 7) =       0.000434870069

      target function =      -0.897064510861
              le_mean =     -17.206204078471
             les_mean =     296.363684368210
             stat err =       0.000429806983
             autocorr =       1.248707133678
   target nu stat err =       0.000429806983
   target dn stat err =       0.010062678687
      target stat err =       0.014992906397
              std dev =       0.543948982292
             le_variance =       0.295880495337


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720620407847e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+03, overlap shift 5.4210e+04 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897313107885       residual = 5.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897313141871       residual = 6.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897313146901       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897313149742       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897313150375       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897313151115       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897313151507       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897313152163       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897313152696       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897313152963       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.897313153252       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.897313153371       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.897313153517       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.897313153646       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.897313153698       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.897313153741       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.897313153772       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.897313153813       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.897313153838       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.897313153869       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.897313153889       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.897313153931       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.897313153922       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.897313153933       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.897313153914       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.897313153928       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.897313153926       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.897313153922       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.897313153938       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.897313153922       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.897313153929       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.897313153926       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.897313153939       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.897313153908       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.897313153946       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.897313153928       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.897313153932       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.897313153960       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.897313153925       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+03 is 1.028630e-07

solving harmonic davidson linear method for identity shift 2.1684e+04, overlap shift 2.1684e+05 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897313107885       residual = 5.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897313116382       residual = 6.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897313117639       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897313118351       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897313118585       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897313118694       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897313118777       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897313118969       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897313119108       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897313119098       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.897313119223       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.897313119269       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.897313119265       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.897313119266       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.897313119391       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.897313119314       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.897313119403       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.897313119401       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.897313119330       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.897313119402       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.897313119293       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.897313119372       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.897313119442       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.897313119268       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.897313119383       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.897313119302       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.897313119382       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.897313119371       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.897313119514       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.897313119367       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.897313119387       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.897313119380       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.897313119438       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.897313119292       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.897313119399       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.897313119409       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.897313119387       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.897313119382       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.897313119320       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+04 is 2.571588e-08

solving harmonic davidson linear method for identity shift 8.6736e+04, overlap shift 8.6736e+05 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897313107885       residual = 5.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897313110009       residual = 6.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897313110324       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897313110515       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897313110565       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897313110608       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897313110471       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897313110709       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897313110664       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897313110851       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.897313110594       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.897313110818       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.897313110804       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.897313110704       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.897313110572       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.897313110370       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.897313111026       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.897313110918       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.897313110681       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.897313110640       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.897313110497       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.897313110889       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.897313110805       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.897313110780       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.897313110707       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.897313110648       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.897313110778       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.897313110735       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.897313110809       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.897313110951       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.897313110648       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.897313110714       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.897313110903       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.897313110804       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.897313110616       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.897313110362       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.897313110439       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.897313110712       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.897313110504       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.6736e+04 is 6.428979e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.436758 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4528e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297279e-02 1 1  ON 1
  uu_2                -3.786904e-02 1 1  ON 2
  uu_3                -9.122422e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125657e-01 1 1  ON 6
  uu_7                -5.674079e-02 1 1  ON 7
  uu_8                 5.806922e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048773e-01 1 1  ON 10
  ud_1                 7.564060e-02 1 1  ON 11
  ud_2                -2.647855e-02 1 1  ON 12
  ud_3                -7.930429e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460391e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581214e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180142e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604176e-02 1 1  ON 31
 eH1_2                -4.456906e-02 1 1  ON 32
 eH1_3                -1.424124e-02 1 1  ON 33
 eH1_4                 1.808389e-02 1 1  ON 34
 eH1_5                 2.186423e-02 1 1  ON 35
 eH1_6                 7.089829e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609479e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626962e-02 1 1  ON 42
 eH2_3                -1.570853e-02 1 1  ON 43
 eH2_4                 1.609681e-02 1 1  ON 44
 eH2_5                 1.955076e-02 1 1  ON 45
 eH2_6                 7.199547e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094300e-02 3 1  ON 51
ci_003                -1.140020e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021024e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050789e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637841e-03 3 1  ON 60
ci_012                -9.626911e-03 3 1  ON 61
ci_013                -2.166299e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627929e-02 3 1  ON 65
ci_017                 1.612036e-02 3 1  ON 66
ci_018                 1.085992e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847008e-02 3 1  ON 69
ci_021                 1.812543e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710381e-03 3 1  ON 73
ci_025                 6.515092e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184166e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753408e-03 3 1  ON 78
ci_030                -4.995966e-03 3 1  ON 79
ci_031                -4.662538e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.2024
    reference variance = 0.271201
====================================================
  Execution time = 1.9083e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9328e-01
  Total weights = 1.9737e+06
  Execution time = 1.6003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287550259536
                                         uncertainty =       0.001825669069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287550259536
                                         uncertainty =       0.001825669069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379149070
  error estimate for blocks of size 2^( 2) =       0.000394585811
  error estimate for blocks of size 2^( 3) =       0.000409162350
  error estimate for blocks of size 2^( 4) =       0.000419639353
  error estimate for blocks of size 2^( 5) =       0.000425494486
  error estimate for blocks of size 2^( 6) =       0.000429011532
  error estimate for blocks of size 2^( 7) =       0.000434218457

      target function =      -0.923257226902
              le_mean =     -17.205682660951
             les_mean =     296.328797821051
             stat err =       0.000427090957
             autocorr =       1.268880612168
   target nu stat err =       0.000427090957
   target dn stat err =       0.001950716889
      target stat err =       0.003156595011
              std dev =       0.536197757055
             le_variance =       0.287508034671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287550252740
                                         uncertainty =       0.001825668044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287550252740
                                         uncertainty =       0.001825668044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379149066
  error estimate for blocks of size 2^( 2) =       0.000394585807
  error estimate for blocks of size 2^( 3) =       0.000409162347
  error estimate for blocks of size 2^( 4) =       0.000419639351
  error estimate for blocks of size 2^( 5) =       0.000425494485
  error estimate for blocks of size 2^( 6) =       0.000429011532
  error estimate for blocks of size 2^( 7) =       0.000434218461

      target function =      -0.923256851168
              le_mean =     -17.205682661584
             les_mean =     296.328798081449
             stat err =       0.000427090957
             autocorr =       1.268880643694
   target nu stat err =       0.000427090957
   target dn stat err =       0.001950718505
      target stat err =       0.003156594990
              std dev =       0.536197750712
             le_variance =       0.287508027868

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287550256138
                                         uncertainty =       0.001825668556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287550256138
                                         uncertainty =       0.001825668556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379149068
  error estimate for blocks of size 2^( 2) =       0.000394585809
  error estimate for blocks of size 2^( 3) =       0.000409162349
  error estimate for blocks of size 2^( 4) =       0.000419639352
  error estimate for blocks of size 2^( 5) =       0.000425494485
  error estimate for blocks of size 2^( 6) =       0.000429011532
  error estimate for blocks of size 2^( 7) =       0.000434218459

      target function =      -0.923257039752
              le_mean =     -17.205682661267
             les_mean =     296.328797950794
             stat err =       0.000427090957
             autocorr =       1.268880627930
   target nu stat err =       0.000427090957
   target dn stat err =       0.001950717688
      target stat err =       0.003156594992
              std dev =       0.536197753883
             le_variance =       0.287508031269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287550259112
                                         uncertainty =       0.001825669005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287550259112
                                         uncertainty =       0.001825669005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379149070
  error estimate for blocks of size 2^( 2) =       0.000394585810
  error estimate for blocks of size 2^( 3) =       0.000409162350
  error estimate for blocks of size 2^( 4) =       0.000419639352
  error estimate for blocks of size 2^( 5) =       0.000425494486
  error estimate for blocks of size 2^( 6) =       0.000429011532
  error estimate for blocks of size 2^( 7) =       0.000434218458

      target function =      -0.923257203587
              le_mean =     -17.205682660990
             les_mean =     296.328797837219
             stat err =       0.000427090957
             autocorr =       1.268880614140
   target nu stat err =       0.000427090957
   target dn stat err =       0.001950716988
      target stat err =       0.003156595008
              std dev =       0.536197756658
             le_variance =       0.287508034245


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923257226902        initial  <--
     5.4210e+03     5.4210e+04             1.0286e-07        -0.923256851168
     2.1684e+04     2.1684e+05             2.5716e-08        -0.923257039752
     8.6736e+04     8.6736e+05             6.4290e-09        -0.923257203587

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.0056
  </log>
  <optVariables href="H2O.s079.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806924e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256204e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637843e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627928e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710388e-03 3 1  ON 73
ci_025                 6.515087e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175671e-03 3 1  ON 77
ci_029                -9.753423e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662532e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1540e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.3143
    reference variance = 0.417933
====================================================
  Execution time = 1.9164e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5413e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9778e-01
  Total weights = 1.973703935e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4850e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290819114274
                                         uncertainty =       0.001838773812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290819114274
                                         uncertainty =       0.001838773812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381318582
  error estimate for blocks of size 2^( 2) =       0.000396697311
  error estimate for blocks of size 2^( 3) =       0.000410921874
  error estimate for blocks of size 2^( 4) =       0.000420871739
  error estimate for blocks of size 2^( 5) =       0.000426550408
  error estimate for blocks of size 2^( 6) =       0.000429538196
  error estimate for blocks of size 2^( 7) =       0.000431040817

      target function =      -0.916195074457
              le_mean =     -17.207024172457
             les_mean =     296.379462853125
             stat err =       0.000427000290
             autocorr =       1.253950522504
   target nu stat err =       0.000427000290
   target dn stat err =       0.002751153925
      target stat err =       0.004337263923
              std dev =       0.539265910689
             le_variance =       0.290807722431


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720702417246e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+04, overlap shift 5.4210e+05 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916214706841       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916214707124       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916214707180       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916214707182       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916214707190       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916214707236       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916214707185       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916214707262       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916214707578       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916214707277       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916214707233       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916214707173       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916214707238       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916214707179       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916214707230       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916214707272       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916214707092       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916214707192       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916214707177       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916214707088       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916214707302       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916214707196       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916214707302       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916214707187       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916214707109       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916214707210       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916214707198       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916214707130       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916214707343       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916214707361       residual = 9.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916214707205       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916214707059       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916214707299       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916214707553       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916214707205       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916214707406       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+04 is 8.769494e-09

solving harmonic davidson linear method for identity shift 2.1684e+05, overlap shift 2.1684e+06 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916214706841       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916214706911       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916214706925       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916214706926       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916214707104       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916214706518       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916214707063       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916214706648       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916214707412       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916214706909       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916214707073       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916214706305       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916214707349       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916214706728       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916214707166       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916214707201       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916214706767       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916214706786       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916214706648       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916214706475       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916214706707       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916214707309       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916214706853       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916214706214       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916214706401       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916214707325       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916214707591       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916214708128       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916214706260       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916214708230       residual = 9.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916214706982       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916214706887       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916214707013       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916214707025       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916214707043       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916214707274       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+05 is 2.192374e-09

solving harmonic davidson linear method for identity shift 8.6736e+05, overlap shift 8.6736e+06 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916214706841       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916214706858       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916214706862       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916214706862       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916214707096       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916214705902       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916214705307       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916214707550       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916214707068       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916214706292       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916214703985       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916214709015       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916214708085       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916214703142       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916214705614       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916214707082       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916214705786       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916214707369       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916214706313       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916214707676       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916214707939       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916214707952       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916214707268       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916214707424       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916214708166       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916214707849       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916214707344       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916214706601       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916214707618       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916214706023       residual = 9.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916214703088       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916214706331       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916214703521       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916214706920       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916214708057       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916214706913       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.6736e+05 is 5.480933e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.485956 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4703e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256204e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528442e-03 3 1  ON 59
ci_011                -9.637843e-03 3 1  ON 60
ci_012                -9.626913e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710388e-03 3 1  ON 73
ci_025                 6.515087e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175671e-03 3 1  ON 77
ci_029                -9.753422e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662532e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.1912
    reference variance = 0.191099
====================================================
  Execution time = 1.8837e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9853e-01
  Total weights = 1.9737e+06
  Execution time = 1.6020e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290269913991
                                         uncertainty =       0.001559877709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290269913991
                                         uncertainty =       0.001559877709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381015346
  error estimate for blocks of size 2^( 2) =       0.000396373746
  error estimate for blocks of size 2^( 3) =       0.000410591499
  error estimate for blocks of size 2^( 4) =       0.000420922260
  error estimate for blocks of size 2^( 5) =       0.000427977413
  error estimate for blocks of size 2^( 6) =       0.000430475691
  error estimate for blocks of size 2^( 7) =       0.000432041352

      target function =      -0.915061798858
              le_mean =     -17.206013559491
             les_mean =     296.345429493682
             stat err =       0.000427854179
             autocorr =       1.260975416774
   target nu stat err =       0.000427854179
   target dn stat err =       0.002405430361
      target stat err =       0.003792398523
              std dev =       0.538837070443
             le_variance =       0.290345388483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290269914288
                                         uncertainty =       0.001559877679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290269914288
                                         uncertainty =       0.001559877679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381015347
  error estimate for blocks of size 2^( 2) =       0.000396373746
  error estimate for blocks of size 2^( 3) =       0.000410591499
  error estimate for blocks of size 2^( 4) =       0.000420922260
  error estimate for blocks of size 2^( 5) =       0.000427977413
  error estimate for blocks of size 2^( 6) =       0.000430475691
  error estimate for blocks of size 2^( 7) =       0.000432041352

      target function =      -0.915061797873
              le_mean =     -17.206013559510
             les_mean =     296.345429494966
             stat err =       0.000427854179
             autocorr =       1.260975414845
   target nu stat err =       0.000427854179
   target dn stat err =       0.002405430311
      target stat err =       0.003792398439
              std dev =       0.538837070711
             le_variance =       0.290345388773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290269914140
                                         uncertainty =       0.001559877694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290269914140
                                         uncertainty =       0.001559877694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381015347
  error estimate for blocks of size 2^( 2) =       0.000396373746
  error estimate for blocks of size 2^( 3) =       0.000410591499
  error estimate for blocks of size 2^( 4) =       0.000420922260
  error estimate for blocks of size 2^( 5) =       0.000427977413
  error estimate for blocks of size 2^( 6) =       0.000430475691
  error estimate for blocks of size 2^( 7) =       0.000432041352

      target function =      -0.915061798366
              le_mean =     -17.206013559500
             les_mean =     296.345429494324
             stat err =       0.000427854179
             autocorr =       1.260975415815
   target nu stat err =       0.000427854179
   target dn stat err =       0.002405430336
      target stat err =       0.003792398481
              std dev =       0.538837070577
             le_variance =       0.290345388628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290269914010
                                         uncertainty =       0.001559877707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290269914010
                                         uncertainty =       0.001559877707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381015346
  error estimate for blocks of size 2^( 2) =       0.000396373746
  error estimate for blocks of size 2^( 3) =       0.000410591499
  error estimate for blocks of size 2^( 4) =       0.000420922260
  error estimate for blocks of size 2^( 5) =       0.000427977413
  error estimate for blocks of size 2^( 6) =       0.000430475691
  error estimate for blocks of size 2^( 7) =       0.000432041352

      target function =      -0.915061798797
              le_mean =     -17.206013559492
             les_mean =     296.345429493762
             stat err =       0.000427854179
             autocorr =       1.260975416659
   target nu stat err =       0.000427854179
   target dn stat err =       0.002405430358
      target stat err =       0.003792398518
              std dev =       0.538837070459
             le_variance =       0.290345388501


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915061798858        initial  <--
     5.4210e+04     5.4210e+05             8.7695e-09        -0.915061797873
     2.1684e+05     2.1684e+06             2.1924e-09        -0.915061798366
     8.6736e+05     8.6736e+06             5.4809e-10        -0.915061798797

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.7401
  </log>
  <optVariables href="H2O.s080.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806924e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256204e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637843e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627928e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710388e-03 3 1  ON 73
ci_025                 6.515087e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175671e-03 3 1  ON 77
ci_029                -9.753423e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662532e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1450e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.2502
    reference variance = 0.209193
====================================================
  Execution time = 1.9047e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5433e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0062e-01
  Total weights = 1.973792852e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5439e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290156113605
                                         uncertainty =       0.002029803044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290156113605
                                         uncertainty =       0.002029803044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380874585
  error estimate for blocks of size 2^( 2) =       0.000396373176
  error estimate for blocks of size 2^( 3) =       0.000410437491
  error estimate for blocks of size 2^( 4) =       0.000421365260
  error estimate for blocks of size 2^( 5) =       0.000428250205
  error estimate for blocks of size 2^( 6) =       0.000432204578
  error estimate for blocks of size 2^( 7) =       0.000433324930

      target function =      -0.911772206144
              le_mean =     -17.206190931085
             les_mean =     296.353628041413
             stat err =       0.000428786243
             autocorr =       1.267411660515
   target nu stat err =       0.000428786243
   target dn stat err =       0.005196989048
      target stat err =       0.008021043399
              std dev =       0.538638004079
             le_variance =       0.290130899438


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720619093109e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+05, overlap shift 5.4210e+06 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911842016623       residual = 6.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911842016989       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911842017010       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911842017019       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911842017020       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911842016134       residual = 9.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911842017393       residual = 8.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911842017133       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911842017038       residual = 7.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911842015583       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911842016969       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911842016877       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911842017197       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911842017248       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911842014803       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911842017036       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911842016715       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911842017691       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911842017551       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911842017275       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911842017457       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911842017824       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911842017096       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911842016614       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911842018392       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911842015457       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911842017456       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911842017876       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911842016059       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911842017953       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911842018362       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911842014455       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911842016967       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911842016294       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911842016474       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911842016770       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911842014790       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+05 is 6.957081e-10

solving harmonic davidson linear method for identity shift 2.1684e+06, overlap shift 2.1684e+07 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911842016623       residual = 6.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911842016714       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911842016719       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911842016722       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911842016722       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911842016563       residual = 9.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911842015178       residual = 8.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911842015871       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911842014883       residual = 7.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911842014135       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911842017656       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911842015086       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911842013100       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911842008984       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911842012270       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911842010876       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911842014387       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911842022648       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911842016582       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911842021897       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911842018313       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911842015461       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911842014407       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911842015492       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911842017619       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911842016131       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911842016929       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911842012124       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911842018944       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911842002669       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911842021919       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911842011271       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911842010607       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911842020858       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911842013457       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911842026174       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911842012282       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+06 is 1.739270e-10

solving harmonic davidson linear method for identity shift 8.6736e+06, overlap shift 8.6736e+07 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911842016623       residual = 6.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911842016645       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911842016647       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911842016647       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911842014877       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911842009789       residual = 9.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911842011519       residual = 8.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911842026882       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911842004188       residual = 7.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911842008002       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911842010490       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911842012201       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911842014077       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911842008404       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911842005075       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911842009297       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911842001564       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911842028280       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911842029405       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911841992178       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911842002835       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911842047432       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911842032106       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911842026169       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911842038345       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911842004896       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911842016977       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911842039360       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911842001667       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911842022313       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911842010712       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911842010839       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911842012441       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911842023050       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911842020571       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911841981027       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911842020295       residual = 5.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.6736e+06 is 4.348176e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.539683 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4650e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806924e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256204e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637843e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627928e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710388e-03 3 1  ON 73
ci_025                 6.515087e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175671e-03 3 1  ON 77
ci_029                -9.753423e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662532e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.1814
    reference variance = 0.321824
====================================================
  Execution time = 1.8897e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0309e-01
  Total weights = 1.9738e+06
  Execution time = 1.5996e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293792102327
                                         uncertainty =       0.002854793838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293792102327
                                         uncertainty =       0.002854793838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383259544
  error estimate for blocks of size 2^( 2) =       0.000398667403
  error estimate for blocks of size 2^( 3) =       0.000412307189
  error estimate for blocks of size 2^( 4) =       0.000422306267
  error estimate for blocks of size 2^( 5) =       0.000428843850
  error estimate for blocks of size 2^( 6) =       0.000433143010
  error estimate for blocks of size 2^( 7) =       0.000434523121

      target function =      -0.908035722517
              le_mean =     -17.205984509532
             les_mean =     296.348995418574
             stat err =       0.000429704062
             autocorr =       1.257051184777
   target nu stat err =       0.000429704062
   target dn stat err =       0.003438920278
      target stat err =       0.005289958627
              std dev =       0.542010844629
             le_variance =       0.293775755695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293792102272
                                         uncertainty =       0.002854793831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293792102272
                                         uncertainty =       0.002854793831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383259544
  error estimate for blocks of size 2^( 2) =       0.000398667403
  error estimate for blocks of size 2^( 3) =       0.000412307189
  error estimate for blocks of size 2^( 4) =       0.000422306266
  error estimate for blocks of size 2^( 5) =       0.000428843850
  error estimate for blocks of size 2^( 6) =       0.000433143010
  error estimate for blocks of size 2^( 7) =       0.000434523121

      target function =      -0.908035723137
              le_mean =     -17.205984509533
             les_mean =     296.348995418198
             stat err =       0.000429704062
             autocorr =       1.257051185017
   target nu stat err =       0.000429704062
   target dn stat err =       0.003438920220
      target stat err =       0.005289958547
              std dev =       0.542010844578
             le_variance =       0.293775755640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293792102299
                                         uncertainty =       0.002854793835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293792102299
                                         uncertainty =       0.002854793835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383259544
  error estimate for blocks of size 2^( 2) =       0.000398667403
  error estimate for blocks of size 2^( 3) =       0.000412307189
  error estimate for blocks of size 2^( 4) =       0.000422306266
  error estimate for blocks of size 2^( 5) =       0.000428843850
  error estimate for blocks of size 2^( 6) =       0.000433143010
  error estimate for blocks of size 2^( 7) =       0.000434523121

      target function =      -0.908035722827
              le_mean =     -17.205984509532
             les_mean =     296.348995418386
             stat err =       0.000429704062
             autocorr =       1.257051184900
   target nu stat err =       0.000429704062
   target dn stat err =       0.003438920249
      target stat err =       0.005289958587
              std dev =       0.542010844603
             le_variance =       0.293775755667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293792102324
                                         uncertainty =       0.002854793838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293792102324
                                         uncertainty =       0.002854793838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383259544
  error estimate for blocks of size 2^( 2) =       0.000398667403
  error estimate for blocks of size 2^( 3) =       0.000412307189
  error estimate for blocks of size 2^( 4) =       0.000422306267
  error estimate for blocks of size 2^( 5) =       0.000428843850
  error estimate for blocks of size 2^( 6) =       0.000433143010
  error estimate for blocks of size 2^( 7) =       0.000434523121

      target function =      -0.908035722556
              le_mean =     -17.205984509532
             les_mean =     296.348995418550
             stat err =       0.000429704062
             autocorr =       1.257051184796
   target nu stat err =       0.000429704062
   target dn stat err =       0.003438920274
      target stat err =       0.005289958622
              std dev =       0.542010844625
             le_variance =       0.293775755691


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908035722517        initial
     5.4210e+05     5.4210e+06             6.9571e-10        -0.908035723137  <--
     2.1684e+06     2.1684e+07             1.7393e-10        -0.908035722827
     8.6736e+06     8.6736e+07             4.3482e-11        -0.908035722556

*****************************************************************************
Applying the update for shift_i =   5.4210e+05     and shift_s =   5.4210e+06
*****************************************************************************

  Execution time = 2.6828e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806924e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256204e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637843e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627928e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710388e-03 3 1  ON 73
ci_025                 6.515087e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175671e-03 3 1  ON 77
ci_029                -9.753423e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662532e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1485e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.2547
    reference variance = 0.55891
====================================================
  Execution time = 1.9049e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5441e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0311e-01
  Total weights = 1.973781304e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4642e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293682458024
                                         uncertainty =       0.001802539598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293682458024
                                         uncertainty =       0.001802539598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383151584
  error estimate for blocks of size 2^( 2) =       0.000398150105
  error estimate for blocks of size 2^( 3) =       0.000412024883
  error estimate for blocks of size 2^( 4) =       0.000421937122
  error estimate for blocks of size 2^( 5) =       0.000428125100
  error estimate for blocks of size 2^( 6) =       0.000430209972
  error estimate for blocks of size 2^( 7) =       0.000432208885

      target function =      -0.908019902384
              le_mean =     -17.205753976340
             les_mean =     296.341081935964
             stat err =       0.000428120270
             autocorr =       1.248505131442
   target nu stat err =       0.000428120270
   target dn stat err =       0.003003168982
      target stat err =       0.004630417786
              std dev =       0.541858165901
             le_variance =       0.293610271954


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720575397634e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+05, overlap shift 1.3553e+06 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908042456337       residual = 4.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908042456484       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908042456521       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908042456532       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908042456683       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908042456548       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908042456701       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908042456529       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908042456310       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908042456277       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908042456291       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908042456476       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.908042456472       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.908042456906       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.908042456656       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.908042456335       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.908042456828       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.908042456623       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.908042456577       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908042456556       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.908042456338       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.908042456349       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908042456588       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.908042456612       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.908042456287       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908042456438       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.908042457167       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.908042456487       residual = 9.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.908042456474       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908042455876       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.908042456897       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.908042456339       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.908042456570       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908042456514       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.908042456795       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+05 is 2.806448e-09

solving harmonic davidson linear method for identity shift 5.4210e+05, overlap shift 5.4210e+06 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908042456337       residual = 4.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908042456374       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908042456383       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908042456399       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908042456192       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908042456190       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908042455845       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908042456382       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908042456824       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908042455511       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908042456863       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908042456507       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.908042455204       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.908042456297       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.908042456420       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.908042456486       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.908042455727       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.908042455520       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.908042456227       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908042454776       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.908042457219       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.908042456704       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908042456756       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.908042456312       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.908042456622       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908042457832       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.908042455374       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.908042456408       residual = 9.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.908042456847       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908042455168       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.908042454180       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.908042455460       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.908042457235       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908042457727       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.908042456644       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+05 is 7.016120e-10

solving harmonic davidson linear method for identity shift 2.1684e+06, overlap shift 2.1684e+07 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908042456337       residual = 4.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908042456347       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908042456349       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908042457031       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908042456327       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908042460191       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908042458165       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908042453643       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908042456233       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908042455057       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908042454443       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908042456730       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.908042458858       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.908042460971       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.908042459124       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.908042454056       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.908042450929       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.908042457077       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.908042457506       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.908042455382       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.908042458774       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.908042447168       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.908042459202       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.908042458504       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.908042465603       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.908042459180       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.908042459344       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.908042467468       residual = 9.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.908042452958       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908042455297       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.908042450583       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.908042456691       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.908042459342       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.908042456303       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.908042460702       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1684e+06 is 1.754031e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.585111 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4564e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806924e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256204e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637843e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627928e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710388e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175671e-03 3 1  ON 77
ci_029                -9.753423e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662532e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.26
    reference variance = 0.250141
====================================================
  Execution time = 1.8783e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9650e-01
  Total weights = 1.9738e+06
  Execution time = 1.5958e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290009777453
                                         uncertainty =       0.001679614484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290009777453
                                         uncertainty =       0.001679614484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380772096
  error estimate for blocks of size 2^( 2) =       0.000395784391
  error estimate for blocks of size 2^( 3) =       0.000409799196
  error estimate for blocks of size 2^( 4) =       0.000419870222
  error estimate for blocks of size 2^( 5) =       0.000426305388
  error estimate for blocks of size 2^( 6) =       0.000428204414
  error estimate for blocks of size 2^( 7) =       0.000429084469

      target function =      -0.918217994703
              le_mean =     -17.205577480031
             les_mean =     296.328397181176
             stat err =       0.000425866123
             autocorr =       1.250880894378
   target nu stat err =       0.000425866123
   target dn stat err =       0.001944380503
      target stat err =       0.003112459969
              std dev =       0.538493062527
             le_variance =       0.289974778389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290009777712
                                         uncertainty =       0.001679614483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290009777712
                                         uncertainty =       0.001679614483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380772096
  error estimate for blocks of size 2^( 2) =       0.000395784391
  error estimate for blocks of size 2^( 3) =       0.000409799196
  error estimate for blocks of size 2^( 4) =       0.000419870222
  error estimate for blocks of size 2^( 5) =       0.000426305388
  error estimate for blocks of size 2^( 6) =       0.000428204415
  error estimate for blocks of size 2^( 7) =       0.000429084470

      target function =      -0.918217999649
              le_mean =     -17.205577480025
             les_mean =     296.328397177797
             stat err =       0.000425866124
             autocorr =       1.250880895419
   target nu stat err =       0.000425866124
   target dn stat err =       0.001944380424
      target stat err =       0.003112459882
              std dev =       0.538493062767
             le_variance =       0.289974778649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290009777583
                                         uncertainty =       0.001679614484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290009777583
                                         uncertainty =       0.001679614484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380772096
  error estimate for blocks of size 2^( 2) =       0.000395784391
  error estimate for blocks of size 2^( 3) =       0.000409799196
  error estimate for blocks of size 2^( 4) =       0.000419870222
  error estimate for blocks of size 2^( 5) =       0.000426305388
  error estimate for blocks of size 2^( 6) =       0.000428204415
  error estimate for blocks of size 2^( 7) =       0.000429084469

      target function =      -0.918217997176
              le_mean =     -17.205577480028
             les_mean =     296.328397179486
             stat err =       0.000425866124
             autocorr =       1.250880894902
   target nu stat err =       0.000425866124
   target dn stat err =       0.001944380464
      target stat err =       0.003112459926
              std dev =       0.538493062647
             le_variance =       0.289974778519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290009777470
                                         uncertainty =       0.001679614484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290009777470
                                         uncertainty =       0.001679614484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380772096
  error estimate for blocks of size 2^( 2) =       0.000395784391
  error estimate for blocks of size 2^( 3) =       0.000409799196
  error estimate for blocks of size 2^( 4) =       0.000419870222
  error estimate for blocks of size 2^( 5) =       0.000426305388
  error estimate for blocks of size 2^( 6) =       0.000428204414
  error estimate for blocks of size 2^( 7) =       0.000429084469

      target function =      -0.918217995012
              le_mean =     -17.205577480031
             les_mean =     296.328397180964
             stat err =       0.000425866123
             autocorr =       1.250880894447
   target nu stat err =       0.000425866123
   target dn stat err =       0.001944380498
      target stat err =       0.003112459963
              std dev =       0.538493062542
             le_variance =       0.289974778405


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918217994703        initial
     1.3553e+05     1.3553e+06             2.8064e-09        -0.918217999649  <--
     5.4210e+05     5.4210e+06             7.0161e-10        -0.918217997176
     2.1684e+06     2.1684e+07             1.7540e-10        -0.918217995012

*****************************************************************************
Applying the update for shift_i =   1.3553e+05     and shift_s =   1.3553e+06
*****************************************************************************

  Execution time = 2.6670e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1240e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.1884
    reference variance = 0.180416
====================================================
  Execution time = 1.9032e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5429e+04
  VMC Eavg = -1.7205e+01
  VMC Evar = 3.0653e-01
  Total weights = 1.973860231e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5173e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291489183401
                                         uncertainty =       0.001950038247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291489183401
                                         uncertainty =       0.001950038247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381731318
  error estimate for blocks of size 2^( 2) =       0.000396851469
  error estimate for blocks of size 2^( 3) =       0.000410724462
  error estimate for blocks of size 2^( 4) =       0.000420969139
  error estimate for blocks of size 2^( 5) =       0.000426477881
  error estimate for blocks of size 2^( 6) =       0.000430028388
  error estimate for blocks of size 2^( 7) =       0.000431969743

      target function =      -0.902745863849
              le_mean =     -17.205442286236
             les_mean =     296.333778927033
             stat err =       0.000427361288
             autocorr =       1.253356955920
   target nu stat err =       0.000427361288
   target dn stat err =       0.007061140995
      target stat err =       0.010649793063
              std dev =       0.539849606969
             le_variance =       0.291437598145


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720544228624e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+04, overlap shift 3.3881e+05 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902870358134       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902870360186       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902870360506       residual = 7.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902870360615       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902870360630       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902870360748       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902870360786       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902870360764       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902870360923       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902870360894       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902870360769       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.902870360882       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.902870360951       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.902870361018       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.902870361029       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.902870360986       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.902870360986       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.902870360937       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.902870361041       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.902870360931       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.902870360967       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.902870360831       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.902870360912       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.902870361065       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.902870360795       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.902870360869       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.902870360956       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.902870360926       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.902870360946       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.902870360951       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.902870360944       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.902870360872       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.902870361122       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.902870360968       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.902870360828       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.902870361043       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.902870360869       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.902870360970       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.902870360940       residual = 9.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.3881e+04 is 1.658330e-08

solving harmonic davidson linear method for identity shift 1.3553e+05, overlap shift 1.3553e+06 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902870358134       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902870358647       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902870358727       residual = 7.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902870358754       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902870358765       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902870358781       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902870358607       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902870358812       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902870358753       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902870358845       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902870358872       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.902870358576       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.902870358837       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.902870358651       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.902870358796       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.902870358970       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.902870359233       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.902870358455       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.902870358752       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.902870358904       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.902870358656       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.902870358995       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.902870359120       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.902870358782       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.902870359007       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.902870358891       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.902870358874       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.902870358900       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.902870358704       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.902870358675       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.902870358025       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.902870358879       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.902870358151       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.902870358935       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.902870358860       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.902870358861       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.902870358471       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.902870358592       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.902870358833       residual = 9.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+05 is 4.145829e-09

solving harmonic davidson linear method for identity shift 5.4210e+05, overlap shift 5.4210e+06 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902870358134       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902870358262       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902870358282       residual = 7.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902870358289       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902870358292       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902870358296       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902870359018       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902870358303       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902870357849       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902870357775       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902870358256       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.902870357607       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.902870357854       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.902870358085       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.902870358991       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.902870358538       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.902870356931       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.902870357829       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.902870358042       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.902870358273       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.902870357859       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.902870358071       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.902870357132       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.902870358256       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.902870358299       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.902870357675       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.902870357193       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.902870355013       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.902870356527       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.902870356087       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.902870356333       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.902870357499       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.902870359600       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.902870359241       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.902870357190       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.902870359861       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.902870358214       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.902870357964       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.902870359336       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+05 is 1.036457e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.646490 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4616e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122422e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581214e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604178e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199549e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528443e-03 3 1  ON 59
ci_011                -9.637843e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313657e-02 3 1  ON 64
ci_016                 1.627928e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710388e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175672e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.2565
    reference variance = 0.278088
====================================================
  Execution time = 1.8922e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9843e-01
  Total weights = 1.9737e+06
  Execution time = 1.6011e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290129559211
                                         uncertainty =       0.001714997255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290129559211
                                         uncertainty =       0.001714997255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380858385
  error estimate for blocks of size 2^( 2) =       0.000396303545
  error estimate for blocks of size 2^( 3) =       0.000410453270
  error estimate for blocks of size 2^( 4) =       0.000420377168
  error estimate for blocks of size 2^( 5) =       0.000426900717
  error estimate for blocks of size 2^( 6) =       0.000429389132
  error estimate for blocks of size 2^( 7) =       0.000431641241

      target function =      -0.915195014930
              le_mean =     -17.206253254668
             les_mean =     296.353584991603
             stat err =       0.000427077064
             autocorr =       1.257434740071
   target nu stat err =       0.000427077064
   target dn stat err =       0.002874486651
      target stat err =       0.004510232266
              std dev =       0.538615093241
             le_variance =       0.290106218667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290129560224
                                         uncertainty =       0.001714997237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290129560224
                                         uncertainty =       0.001714997237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380858386
  error estimate for blocks of size 2^( 2) =       0.000396303546
  error estimate for blocks of size 2^( 3) =       0.000410453270
  error estimate for blocks of size 2^( 4) =       0.000420377169
  error estimate for blocks of size 2^( 5) =       0.000426900718
  error estimate for blocks of size 2^( 6) =       0.000429389132
  error estimate for blocks of size 2^( 7) =       0.000431641241

      target function =      -0.915194990660
              le_mean =     -17.206253254557
             les_mean =     296.353585003466
             stat err =       0.000427077065
             autocorr =       1.257434739268
   target nu stat err =       0.000427077065
   target dn stat err =       0.002874486133
      target stat err =       0.004510231238
              std dev =       0.538615094198
             le_variance =       0.290106219697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290129559717
                                         uncertainty =       0.001714997246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290129559717
                                         uncertainty =       0.001714997246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380858385
  error estimate for blocks of size 2^( 2) =       0.000396303546
  error estimate for blocks of size 2^( 3) =       0.000410453270
  error estimate for blocks of size 2^( 4) =       0.000420377168
  error estimate for blocks of size 2^( 5) =       0.000426900717
  error estimate for blocks of size 2^( 6) =       0.000429389132
  error estimate for blocks of size 2^( 7) =       0.000431641241

      target function =      -0.915195002798
              le_mean =     -17.206253254613
             les_mean =     296.353584997533
             stat err =       0.000427077065
             autocorr =       1.257434739676
   target nu stat err =       0.000427077065
   target dn stat err =       0.002874486392
      target stat err =       0.004510231752
              std dev =       0.538615093719
             le_variance =       0.290106219182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290129559274
                                         uncertainty =       0.001714997253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290129559274
                                         uncertainty =       0.001714997253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380858385
  error estimate for blocks of size 2^( 2) =       0.000396303545
  error estimate for blocks of size 2^( 3) =       0.000410453270
  error estimate for blocks of size 2^( 4) =       0.000420377168
  error estimate for blocks of size 2^( 5) =       0.000426900717
  error estimate for blocks of size 2^( 6) =       0.000429389132
  error estimate for blocks of size 2^( 7) =       0.000431641241

      target function =      -0.915195013414
              le_mean =     -17.206253254661
             les_mean =     296.353584992344
             stat err =       0.000427077064
             autocorr =       1.257434740019
   target nu stat err =       0.000427077064
   target dn stat err =       0.002874486619
      target stat err =       0.004510232202
              std dev =       0.538615093301
             le_variance =       0.290106218732


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915195014930        initial  <--
     3.3881e+04     3.3881e+05             1.6583e-08        -0.915194990660
     1.3553e+05     1.3553e+06             4.1458e-09        -0.915195002798
     5.4210e+05     5.4210e+06             1.0365e-09        -0.915195013414

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.8343
  </log>
  <optVariables href="H2O.s083.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1457e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2595
    reference variance = 0.46813
====================================================
  Execution time = 1.8959e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5416e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0065e-01
  Total weights = 1.973624949e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5170e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293453593651
                                         uncertainty =       0.002527946047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293453593651
                                         uncertainty =       0.002527946047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383026781
  error estimate for blocks of size 2^( 2) =       0.000398173195
  error estimate for blocks of size 2^( 3) =       0.000412037049
  error estimate for blocks of size 2^( 4) =       0.000422415140
  error estimate for blocks of size 2^( 5) =       0.000429572853
  error estimate for blocks of size 2^( 6) =       0.000433102923
  error estimate for blocks of size 2^( 7) =       0.000433752118

      target function =      -0.911771084666
              le_mean =     -17.206503678748
             les_mean =     296.364417448081
             stat err =       0.000429710758
             autocorr =       1.258618680447
   target nu stat err =       0.000429710758
   target dn stat err =       0.002970297020
      target stat err =       0.004625244272
              std dev =       0.541681667927
             le_variance =       0.293419029368


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720650367875e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+05, overlap shift 3.3881e+06 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911793287727       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911793287755       residual = 5.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911793287765       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911793287768       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911793287769       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911793287706       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911793287769       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911793287769       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911793287770       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911793288309       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911793287818       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911793287328       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911793287514       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911793287428       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911793287774       residual = 8.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911793286819       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911793288773       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911793287622       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911793287826       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911793288583       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911793287775       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911793288453       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911793287977       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911793287658       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911793287761       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911793287961       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911793288557       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911793291826       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911793288531       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911793288015       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911793289441       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911793286695       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911793287121       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911793288629       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911793286859       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911793288246       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911793286018       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911793288195       residual = 6.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.3881e+05 is 1.052007e-09

solving harmonic davidson linear method for identity shift 1.3553e+06, overlap shift 1.3553e+07 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911793287727       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911793287734       residual = 5.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911793287736       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911793287737       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911793287737       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911793287738       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911793287737       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911793287737       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911793287738       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911793287738       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911793287738       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911793291608       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911793287738       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911793287739       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911793287739       residual = 8.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911793287940       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911793283860       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911793288011       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911793286882       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911793290536       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911793286722       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911793290165       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911793283873       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911793283499       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911793283614       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911793285324       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911793283001       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911793293463       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911793290138       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911793287008       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911793289244       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911793287890       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911793290114       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911793291698       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911793282873       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911793288137       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911793286423       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911793286458       residual = 6.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+06 is 2.630018e-10

solving harmonic davidson linear method for identity shift 5.4210e+06, overlap shift 5.4210e+07 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911793287727       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911793287729       residual = 5.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911793287729       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911793287729       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911793287729       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911793287729       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911793287729       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911793285152       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911793287729       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911793287730       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911793296015       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911793287730       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.911793287730       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.911793287730       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.911793290723       residual = 8.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.911793293194       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.911793287730       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.911793287730       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.911793293766       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.911793290958       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.911793287730       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.911793290630       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.911793287730       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.911793281393       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.911793295649       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.911793261442       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.911793299171       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.911793282456       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.911793276570       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.911793277189       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.911793285376       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.911793289042       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.911793266733       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.911793306933       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.911793281328       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.911793275325       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.911793266659       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911793264265       residual = 6.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+06 is 6.575025e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.703014 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4538e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175671e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2659
    reference variance = 0.556769
====================================================
  Execution time = 2.0948e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9818e-01
  Total weights = 1.9738e+06
  Execution time = 1.5982e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290694209063
                                         uncertainty =       0.001578077081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290694209063
                                         uncertainty =       0.001578077081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381275252
  error estimate for blocks of size 2^( 2) =       0.000396505619
  error estimate for blocks of size 2^( 3) =       0.000410879029
  error estimate for blocks of size 2^( 4) =       0.000420812036
  error estimate for blocks of size 2^( 5) =       0.000427005708
  error estimate for blocks of size 2^( 6) =       0.000431079376
  error estimate for blocks of size 2^( 7) =       0.000432791363

      target function =      -0.915605396794
              le_mean =     -17.205934325143
             les_mean =     296.342353664964
             stat err =       0.000427922121
             autocorr =       1.259656817618
   target nu stat err =       0.000427922121
   target dn stat err =       0.002292777920
      target stat err =       0.003625113817
              std dev =       0.539204631826
             le_variance =       0.290741634983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290694209023
                                         uncertainty =       0.001578077072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290694209023
                                         uncertainty =       0.001578077072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381275252
  error estimate for blocks of size 2^( 2) =       0.000396505619
  error estimate for blocks of size 2^( 3) =       0.000410879029
  error estimate for blocks of size 2^( 4) =       0.000420812036
  error estimate for blocks of size 2^( 5) =       0.000427005708
  error estimate for blocks of size 2^( 6) =       0.000431079376
  error estimate for blocks of size 2^( 7) =       0.000432791363

      target function =      -0.915605395020
              le_mean =     -17.205934325142
             les_mean =     296.342353666097
             stat err =       0.000427922121
             autocorr =       1.259656817785
   target nu stat err =       0.000427922121
   target dn stat err =       0.002292777966
      target stat err =       0.003625113872
              std dev =       0.539204631789
             le_variance =       0.290741634943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290694209043
                                         uncertainty =       0.001578077077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290694209043
                                         uncertainty =       0.001578077077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381275252
  error estimate for blocks of size 2^( 2) =       0.000396505619
  error estimate for blocks of size 2^( 3) =       0.000410879029
  error estimate for blocks of size 2^( 4) =       0.000420812036
  error estimate for blocks of size 2^( 5) =       0.000427005708
  error estimate for blocks of size 2^( 6) =       0.000431079376
  error estimate for blocks of size 2^( 7) =       0.000432791363

      target function =      -0.915605395907
              le_mean =     -17.205934325143
             les_mean =     296.342353665531
             stat err =       0.000427922121
             autocorr =       1.259656817699
   target nu stat err =       0.000427922121
   target dn stat err =       0.002292777943
      target stat err =       0.003625113845
              std dev =       0.539204631808
             le_variance =       0.290741634963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290694209060
                                         uncertainty =       0.001578077080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290694209060
                                         uncertainty =       0.001578077080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381275252
  error estimate for blocks of size 2^( 2) =       0.000396505619
  error estimate for blocks of size 2^( 3) =       0.000410879029
  error estimate for blocks of size 2^( 4) =       0.000420812036
  error estimate for blocks of size 2^( 5) =       0.000427005708
  error estimate for blocks of size 2^( 6) =       0.000431079376
  error estimate for blocks of size 2^( 7) =       0.000432791363

      target function =      -0.915605396684
              le_mean =     -17.205934325143
             les_mean =     296.342353665035
             stat err =       0.000427922121
             autocorr =       1.259656817630
   target nu stat err =       0.000427922121
   target dn stat err =       0.002292777923
      target stat err =       0.003625113820
              std dev =       0.539204631824
             le_variance =       0.290741634981


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915605396794        initial  <--
     3.3881e+05     3.3881e+06             1.0520e-09        -0.915605395020
     1.3553e+06     1.3553e+07             2.6300e-10        -0.915605395907
     5.4210e+06     5.4210e+07             6.5750e-11        -0.915605396684

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8603
  </log>
  <optVariables href="H2O.s084.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.3410e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.1448
    reference variance = 0.190555
====================================================
  Execution time = 1.9191e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5422e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9688e-01
  Total weights = 1.973717148e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4500e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290653531963
                                         uncertainty =       0.001981960173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290653531963
                                         uncertainty =       0.001981960173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381190822
  error estimate for blocks of size 2^( 2) =       0.000396837792
  error estimate for blocks of size 2^( 3) =       0.000410502603
  error estimate for blocks of size 2^( 4) =       0.000420540919
  error estimate for blocks of size 2^( 5) =       0.000427409331
  error estimate for blocks of size 2^( 6) =       0.000431052951
  error estimate for blocks of size 2^( 7) =       0.000433716734

      target function =      -0.917612517156
              le_mean =     -17.206254923264
             les_mean =     296.352090741828
             stat err =       0.000428179984
             autocorr =       1.261734130952
   target nu stat err =       0.000428179984
   target dn stat err =       0.002304891505
      target stat err =       0.003661437317
              std dev =       0.539085230601
             le_variance =       0.290612885852


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720625492326e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+06, overlap shift 3.3881e+07 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917626080712       residual = 3.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917626080716       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917626080718       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917626080718       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917626080591       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917626091251       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917626082000       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917626081166       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917626080348       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917626077627       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917626077726       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917626082395       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917626078443       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917626079976       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917626084899       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917626077133       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917626076766       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917626067197       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917626076061       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917626086616       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917626078532       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917626078743       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917626086141       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917626081545       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917626074797       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917626080445       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917626077018       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917626085912       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917626076539       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917626081172       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917626078712       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917626080744       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917626076706       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917626084220       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917626091994       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917626079720       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.3881e+06 is 1.032200e-10

solving harmonic davidson linear method for identity shift 1.3553e+07, overlap shift 1.3553e+08 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917626080712       residual = 3.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917626080713       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917626080713       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917626080713       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917626080716       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917626077713       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917626074862       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917626074933       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917626077913       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917626107871       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917626096552       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917626067614       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917626070423       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917626089283       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917626056938       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917626053034       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917626049220       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917626099833       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917626092929       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917626088911       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917626072775       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917626039927       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917626028299       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917626065621       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917626085004       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917626092619       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917626099432       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917626068711       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917626022903       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917626075133       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917626069561       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917626054123       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917626013356       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917626062046       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917626103212       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917626058954       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+07 is 2.580491e-11

solving harmonic davidson linear method for identity shift 5.4210e+07, overlap shift 5.4210e+08 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917626080712       residual = 3.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917626080712       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917626080712       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917626080712       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917626080472       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917626087822       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917626115621       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917625972517       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917626123742       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917626076807       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917626068539       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917626089091       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917626114292       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917626108611       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917626225588       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917626022991       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917626130954       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917626201928       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917626110878       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917626115084       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917626224544       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917626215695       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917626120453       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917626108775       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917626110808       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917626170216       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917626035119       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917625988560       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917626059529       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917625952704       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917626118896       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917626123013       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917626033607       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917626195693       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917626158315       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.917626056805       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+07 is 6.451504e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.764896 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4714e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2921
    reference variance = 0.285923
====================================================
  Execution time = 1.8627e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9966e-01
  Total weights = 1.9735e+06
  Execution time = 1.6009e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290897386662
                                         uncertainty =       0.001861840190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290897386662
                                         uncertainty =       0.001861840190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381329419
  error estimate for blocks of size 2^( 2) =       0.000397042692
  error estimate for blocks of size 2^( 3) =       0.000411190329
  error estimate for blocks of size 2^( 4) =       0.000421542662
  error estimate for blocks of size 2^( 5) =       0.000427922474
  error estimate for blocks of size 2^( 6) =       0.000429778803
  error estimate for blocks of size 2^( 7) =       0.000432775270

      target function =      -0.913299113431
              le_mean =     -17.206432502589
             les_mean =     296.360982341183
             stat err =       0.000428004802
             autocorr =       1.259785656423
   target nu stat err =       0.000428004802
   target dn stat err =       0.002361311806
      target stat err =       0.003714251425
              std dev =       0.539281236732
             le_variance =       0.290824252291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290897386654
                                         uncertainty =       0.001861840189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290897386654
                                         uncertainty =       0.001861840189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381329419
  error estimate for blocks of size 2^( 2) =       0.000397042692
  error estimate for blocks of size 2^( 3) =       0.000411190329
  error estimate for blocks of size 2^( 4) =       0.000421542662
  error estimate for blocks of size 2^( 5) =       0.000427922474
  error estimate for blocks of size 2^( 6) =       0.000429778803
  error estimate for blocks of size 2^( 7) =       0.000432775270

      target function =      -0.913299113420
              le_mean =     -17.206432502589
             les_mean =     296.360982341198
             stat err =       0.000428004802
             autocorr =       1.259785656434
   target nu stat err =       0.000428004802
   target dn stat err =       0.002361311813
      target stat err =       0.003714251436
              std dev =       0.539281236724
             le_variance =       0.290824252283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290897386658
                                         uncertainty =       0.001861840190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290897386658
                                         uncertainty =       0.001861840190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381329419
  error estimate for blocks of size 2^( 2) =       0.000397042692
  error estimate for blocks of size 2^( 3) =       0.000411190329
  error estimate for blocks of size 2^( 4) =       0.000421542662
  error estimate for blocks of size 2^( 5) =       0.000427922474
  error estimate for blocks of size 2^( 6) =       0.000429778803
  error estimate for blocks of size 2^( 7) =       0.000432775270

      target function =      -0.913299113425
              le_mean =     -17.206432502589
             les_mean =     296.360982341191
             stat err =       0.000428004802
             autocorr =       1.259785656419
   target nu stat err =       0.000428004802
   target dn stat err =       0.002361311809
      target stat err =       0.003714251430
              std dev =       0.539281236728
             le_variance =       0.290824252287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290897386661
                                         uncertainty =       0.001861840190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290897386661
                                         uncertainty =       0.001861840190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381329419
  error estimate for blocks of size 2^( 2) =       0.000397042692
  error estimate for blocks of size 2^( 3) =       0.000411190329
  error estimate for blocks of size 2^( 4) =       0.000421542662
  error estimate for blocks of size 2^( 5) =       0.000427922474
  error estimate for blocks of size 2^( 6) =       0.000429778803
  error estimate for blocks of size 2^( 7) =       0.000432775270

      target function =      -0.913299113430
              le_mean =     -17.206432502589
             les_mean =     296.360982341184
             stat err =       0.000428004802
             autocorr =       1.259785656412
   target nu stat err =       0.000428004802
   target dn stat err =       0.002361311806
      target stat err =       0.003714251426
              std dev =       0.539281236731
             le_variance =       0.290824252291


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913299113431        initial  <--
     3.3881e+06     3.3881e+07             1.0322e-10        -0.913299113420
     1.3553e+07     1.3553e+08             2.5805e-11        -0.913299113425
     5.4210e+07     5.4210e+08             6.4515e-12        -0.913299113430

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.5348
  </log>
  <optVariables href="H2O.s085.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1266e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.2169
    reference variance = 0.316253
====================================================
  Execution time = 1.9059e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5408e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0030e-01
  Total weights = 1.973752378e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4366e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293392746082
                                         uncertainty =       0.004812114666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293392746082
                                         uncertainty =       0.004812114666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382967604
  error estimate for blocks of size 2^( 2) =       0.000398291612
  error estimate for blocks of size 2^( 3) =       0.000412820155
  error estimate for blocks of size 2^( 4) =       0.000422450355
  error estimate for blocks of size 2^( 5) =       0.000428586447
  error estimate for blocks of size 2^( 6) =       0.000431953419
  error estimate for blocks of size 2^( 7) =       0.000433638879

      target function =      -0.912259008376
              le_mean =     -17.206517297605
             les_mean =     296.364535482023
             stat err =       0.000429157275
             autocorr =       1.255766471258
   target nu stat err =       0.000429157275
   target dn stat err =       0.005316653468
      target stat err =       0.008218026492
              std dev =       0.541597979179
             le_variance =       0.293328371051


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720651729761e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+07, overlap shift 3.3881e+08 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912332552854       residual = 3.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912332552858       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912332552858       residual = 8.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912332536537       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912332552858       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912332552858       residual = 9.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912332552858       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912332552858       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912332546250       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912332552858       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912332552858       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912332404140       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912332552858       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912332671028       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912332552858       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912332552858       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912332531813       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912332552858       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912332552858       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912332552858       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912332552858       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912332552858       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912332538296       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912332606620       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912332596666       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912332349904       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912332618325       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912332174339       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912332472082       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912332600324       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912332770370       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912332476876       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912332461589       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912332595511       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912332572276       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912332619898       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.3881e+07 is 1.271075e-11

solving harmonic davidson linear method for identity shift 1.3553e+08, overlap shift 1.3553e+09 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912332552854       residual = 3.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912332552855       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912332552855       residual = 8.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912332552855       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912332552855       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912332552855       residual = 9.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912332371556       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912332433044       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912332552855       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912332552855       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912332588751       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912332552855       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912332707451       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912332552855       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912332552855       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912332493277       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912332552855       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912332552855       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912332552855       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912332571467       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912332725401       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912332455538       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912332559549       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912332353910       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912332890715       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912332541201       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912332412347       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912331958557       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912332185161       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912332736861       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912332186499       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912331480475       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912332766179       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912332595507       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912332878412       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912331929673       residual = 3.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+08 is 3.177750e-12

solving harmonic davidson linear method for identity shift 5.4210e+08, overlap shift 5.4210e+09 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912332552854       residual = 3.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912332552855       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912332552855       residual = 8.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912332552855       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912332552855       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912332552855       residual = 9.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912332552855       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912332552855       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912332552855       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912332085611       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912332317399       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912333228379       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912332819853       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912332270563       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912332733084       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912332630712       residual = 5.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912332552855       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912331362428       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912332075853       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912333108131       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912332552855       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912332938183       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912330767365       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912332693858       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912332809258       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912333745801       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912333143285       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912332278416       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912331900394       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912331790414       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912331532330       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912332088096       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912334161392       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912334293033       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912332764348       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912333036314       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.4210e+08 is 7.945605e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.826612 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4566e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.1521
    reference variance = 0.314637
====================================================
  Execution time = 1.8858e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0055e-01
  Total weights = 1.9736e+06
  Execution time = 1.5983e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291341336744
                                         uncertainty =       0.002004516890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291341336744
                                         uncertainty =       0.002004516890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381700631
  error estimate for blocks of size 2^( 2) =       0.000397030079
  error estimate for blocks of size 2^( 3) =       0.000411208240
  error estimate for blocks of size 2^( 4) =       0.000421301126
  error estimate for blocks of size 2^( 5) =       0.000427467451
  error estimate for blocks of size 2^( 6) =       0.000431369892
  error estimate for blocks of size 2^( 7) =       0.000434771446

      target function =      -0.911942561869
              le_mean =     -17.205705203833
             les_mean =     296.336839738140
             stat err =       0.000428727479
             autocorr =       1.261586066118
   target nu stat err =       0.000428727479
   target dn stat err =       0.003021133593
      target stat err =       0.004697036560
              std dev =       0.539806209506
             le_variance =       0.291390743821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291341336743
                                         uncertainty =       0.002004516890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291341336743
                                         uncertainty =       0.002004516890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381700631
  error estimate for blocks of size 2^( 2) =       0.000397030079
  error estimate for blocks of size 2^( 3) =       0.000411208240
  error estimate for blocks of size 2^( 4) =       0.000421301126
  error estimate for blocks of size 2^( 5) =       0.000427467451
  error estimate for blocks of size 2^( 6) =       0.000431369892
  error estimate for blocks of size 2^( 7) =       0.000434771446

      target function =      -0.911942561886
              le_mean =     -17.205705203833
             les_mean =     296.336839738130
             stat err =       0.000428727479
             autocorr =       1.261586066116
   target nu stat err =       0.000428727479
   target dn stat err =       0.003021133592
      target stat err =       0.004697036559
              std dev =       0.539806209505
             le_variance =       0.291390743820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291341336743
                                         uncertainty =       0.002004516890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291341336743
                                         uncertainty =       0.002004516890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381700631
  error estimate for blocks of size 2^( 2) =       0.000397030079
  error estimate for blocks of size 2^( 3) =       0.000411208240
  error estimate for blocks of size 2^( 4) =       0.000421301126
  error estimate for blocks of size 2^( 5) =       0.000427467451
  error estimate for blocks of size 2^( 6) =       0.000431369892
  error estimate for blocks of size 2^( 7) =       0.000434771446

      target function =      -0.911942561878
              le_mean =     -17.205705203833
             les_mean =     296.336839738135
             stat err =       0.000428727479
             autocorr =       1.261586066122
   target nu stat err =       0.000428727479
   target dn stat err =       0.003021133593
      target stat err =       0.004697036559
              std dev =       0.539806209505
             le_variance =       0.291390743820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291341336744
                                         uncertainty =       0.002004516890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291341336744
                                         uncertainty =       0.002004516890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381700631
  error estimate for blocks of size 2^( 2) =       0.000397030079
  error estimate for blocks of size 2^( 3) =       0.000411208240
  error estimate for blocks of size 2^( 4) =       0.000421301126
  error estimate for blocks of size 2^( 5) =       0.000427467451
  error estimate for blocks of size 2^( 6) =       0.000431369892
  error estimate for blocks of size 2^( 7) =       0.000434771446

      target function =      -0.911942561870
              le_mean =     -17.205705203833
             les_mean =     296.336839738139
             stat err =       0.000428727479
             autocorr =       1.261586066121
   target nu stat err =       0.000428727479
   target dn stat err =       0.003021133593
      target stat err =       0.004697036560
              std dev =       0.539806209506
             le_variance =       0.291390743821


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911942561869        initial
     3.3881e+07     3.3881e+08             1.2711e-11        -0.911942561886  <--
     1.3553e+08     1.3553e+09             3.1778e-12        -0.911942561878
     5.4210e+08     5.4210e+09             7.9456e-13        -0.911942561870

*****************************************************************************
Applying the update for shift_i =   3.3881e+07     and shift_s =   3.3881e+08
*****************************************************************************

  Execution time = 2.6775e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1359e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.2269
    reference variance = 0.406003
====================================================
  Execution time = 1.9053e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5417e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0146e-01
  Total weights = 1.973638084e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4362e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293006796799
                                         uncertainty =       0.001778774940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293006796799
                                         uncertainty =       0.001778774940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382728225
  error estimate for blocks of size 2^( 2) =       0.000397951506
  error estimate for blocks of size 2^( 3) =       0.000411540030
  error estimate for blocks of size 2^( 4) =       0.000421147646
  error estimate for blocks of size 2^( 5) =       0.000427815429
  error estimate for blocks of size 2^( 6) =       0.000431089851
  error estimate for blocks of size 2^( 7) =       0.000434503537

      target function =      -0.910525237667
              le_mean =     -17.206572797985
             les_mean =     296.367611611778
             stat err =       0.000428639116
             autocorr =       1.254303451802
   target nu stat err =       0.000428639116
   target dn stat err =       0.002340776919
      target stat err =       0.003662430124
              std dev =       0.541259446990
             le_variance =       0.292961788956


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720657279798e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+06, overlap shift 8.4703e+07 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910538887203       residual = 4.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910538887206       residual = 9.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910538887206       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910538887206       residual = 7.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910538887206       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910538887206       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910538887206       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910538887206       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910538887206       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910538874501       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910538887206       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910538899788       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910538887206       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910538897976       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910538874116       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910538894647       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910538885619       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910538890249       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910538900386       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910538880303       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910538874186       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910538880006       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910538896876       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910538874644       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910538893290       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910538926452       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910538888999       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910538889465       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910538895446       residual = 9.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910538896010       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910538913944       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910538891112       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910538899069       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910538851908       residual = 7.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.4703e+06 is 3.480278e-11

solving harmonic davidson linear method for identity shift 3.3881e+07, overlap shift 3.3881e+08 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910538887203       residual = 4.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910538887204       residual = 9.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910538887204       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910538887204       residual = 7.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910538887204       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910538874925       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910538887204       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910538865504       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910538875273       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910538887204       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910538838991       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910538963522       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910538943982       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910538915832       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910538888139       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910538869513       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910538837653       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910538803462       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910538918368       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910538896325       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910538972746       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910538919408       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910538815122       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910538704157       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910538849846       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910538876720       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910538868092       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910539035677       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910538746433       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910538891342       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910538899815       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910538850765       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910538928355       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910538878556       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.3881e+07 is 8.700431e-12

solving harmonic davidson linear method for identity shift 1.3553e+08, overlap shift 1.3553e+09 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910538887203       residual = 4.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910538887203       residual = 9.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910538887203       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910538887203       residual = 7.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910538892235       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910538887203       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910538887203       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910538841636       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910539072392       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910538687651       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910538660614       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910539037050       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.910539085299       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910538653841       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.910538819065       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.910538567466       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.910538589174       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.910538703080       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.910538991096       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.910538512347       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.910539514732       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910538945231       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.910538784270       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.910539480537       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.910539155488       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.910539083535       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.910539036432       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.910538348647       residual = 7.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.910538845509       residual = 9.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.910539110337       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.910538627476       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.910539358408       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.910538649578       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.910538830570       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+08 is 2.175271e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.880326 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4552e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.1801
    reference variance = 0.184915
====================================================
  Execution time = 1.8867e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9415e-01
  Total weights = 1.9737e+06
  Execution time = 1.6051e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287279012140
                                         uncertainty =       0.001591950724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287279012140
                                         uncertainty =       0.001591950724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378989416
  error estimate for blocks of size 2^( 2) =       0.000394484561
  error estimate for blocks of size 2^( 3) =       0.000408292186
  error estimate for blocks of size 2^( 4) =       0.000418509253
  error estimate for blocks of size 2^( 5) =       0.000424686287
  error estimate for blocks of size 2^( 6) =       0.000427311696
  error estimate for blocks of size 2^( 7) =       0.000431152456

      target function =      -0.921884863926
              le_mean =     -17.206431999763
             les_mean =     296.355454316202
             stat err =       0.000425414923
             autocorr =       1.260002123627
   target nu stat err =       0.000425414923
   target dn stat err =       0.002044793796
      target stat err =       0.003295267985
              std dev =       0.535971971835
             le_variance =       0.287265954592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287279012139
                                         uncertainty =       0.001591950724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287279012139
                                         uncertainty =       0.001591950724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378989416
  error estimate for blocks of size 2^( 2) =       0.000394484561
  error estimate for blocks of size 2^( 3) =       0.000408292186
  error estimate for blocks of size 2^( 4) =       0.000418509253
  error estimate for blocks of size 2^( 5) =       0.000424686287
  error estimate for blocks of size 2^( 6) =       0.000427311696
  error estimate for blocks of size 2^( 7) =       0.000431152456

      target function =      -0.921884863894
              le_mean =     -17.206431999763
             les_mean =     296.355454316218
             stat err =       0.000425414923
             autocorr =       1.260002123633
   target nu stat err =       0.000425414923
   target dn stat err =       0.002044793801
      target stat err =       0.003295267992
              std dev =       0.535971971833
             le_variance =       0.287265954591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287279012140
                                         uncertainty =       0.001591950724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287279012140
                                         uncertainty =       0.001591950724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378989416
  error estimate for blocks of size 2^( 2) =       0.000394484561
  error estimate for blocks of size 2^( 3) =       0.000408292186
  error estimate for blocks of size 2^( 4) =       0.000418509253
  error estimate for blocks of size 2^( 5) =       0.000424686287
  error estimate for blocks of size 2^( 6) =       0.000427311696
  error estimate for blocks of size 2^( 7) =       0.000431152456

      target function =      -0.921884863910
              le_mean =     -17.206431999763
             les_mean =     296.355454316210
             stat err =       0.000425414923
             autocorr =       1.260002123626
   target nu stat err =       0.000425414923
   target dn stat err =       0.002044793798
      target stat err =       0.003295267988
              std dev =       0.535971971834
             le_variance =       0.287265954592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287279012140
                                         uncertainty =       0.001591950724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287279012140
                                         uncertainty =       0.001591950724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378989416
  error estimate for blocks of size 2^( 2) =       0.000394484561
  error estimate for blocks of size 2^( 3) =       0.000408292186
  error estimate for blocks of size 2^( 4) =       0.000418509253
  error estimate for blocks of size 2^( 5) =       0.000424686287
  error estimate for blocks of size 2^( 6) =       0.000427311696
  error estimate for blocks of size 2^( 7) =       0.000431152456

      target function =      -0.921884863924
              le_mean =     -17.206431999763
             les_mean =     296.355454316203
             stat err =       0.000425414923
             autocorr =       1.260002123625
   target nu stat err =       0.000425414923
   target dn stat err =       0.002044793796
      target stat err =       0.003295267985
              std dev =       0.535971971834
             le_variance =       0.287265954592


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921884863926        initial  <--
     8.4703e+06     8.4703e+07             3.4803e-11        -0.921884863894
     3.3881e+07     3.3881e+08             8.7004e-12        -0.921884863910
     1.3553e+08     1.3553e+09             2.1753e-12        -0.921884863924

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.7877
  </log>
  <optVariables href="H2O.s087.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1358e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.2209
    reference variance = 0.197529
====================================================
  Execution time = 1.9042e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5417e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9783e-01
  Total weights = 1.973643489e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4982e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287665785804
                                         uncertainty =       0.001896474362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287665785804
                                         uncertainty =       0.001896474362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379273382
  error estimate for blocks of size 2^( 2) =       0.000394557524
  error estimate for blocks of size 2^( 3) =       0.000408120706
  error estimate for blocks of size 2^( 4) =       0.000418941560
  error estimate for blocks of size 2^( 5) =       0.000425486045
  error estimate for blocks of size 2^( 6) =       0.000430768077
  error estimate for blocks of size 2^( 7) =       0.000434273046

      target function =      -0.916129588731
              le_mean =     -17.206023851910
             les_mean =     296.345089051870
             stat err =       0.000427367182
             autocorr =       1.269689739785
   target nu stat err =       0.000427367182
   target dn stat err =       0.003015455186
      target stat err =       0.004733489464
              std dev =       0.536373560261
             le_variance =       0.287696596147


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720602385191e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+07, overlap shift 8.4703e+08 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916152782696       residual = 9.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916152782697       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916152782697       residual = 7.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916152782697       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916152796782       residual = 8.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916152811986       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916152646085       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916152782544       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916152828760       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916152773335       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916152874179       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916152732119       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916152882419       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916152928921       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916152541272       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916152636867       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916152762375       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916152803068       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916152805535       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916152592332       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916152550468       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916152727499       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916152878692       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916152900561       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916152900120       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916152821338       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916152844268       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916152656830       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916152953874       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916152924958       residual = 9.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916152830196       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916152600911       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916152217910       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916152512035       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916152631207       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916152746061       residual = 7.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.4703e+07 is 5.420440e-12

solving harmonic davidson linear method for identity shift 3.3881e+08, overlap shift 3.3881e+09 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916152782696       residual = 9.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916152782696       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916152782696       residual = 7.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916152765515       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916152782692       residual = 8.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916152538013       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916152878886       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916152854192       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916153005617       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916153059351       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916153523166       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916152956361       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916152091258       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916152771836       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916152478695       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916152921263       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916152434746       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916153163455       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916152517076       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916152433681       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916153234576       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916152836335       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916152730833       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916152511361       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916150977432       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916152843480       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916152856968       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916152627752       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916152006625       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916152063530       residual = 9.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916152831277       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916152395641       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916153179990       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916152312508       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916152531216       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916151744956       residual = 7.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.3881e+08 is 1.354849e-12

solving harmonic davidson linear method for identity shift 1.3553e+09, overlap shift 1.3553e+10 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916152782696       residual = 9.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916152782696       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916152782696       residual = 7.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916152782696       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916152782696       residual = 8.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916153966822       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916151390707       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916156612872       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916151430051       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916154790381       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916151036407       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916151260221       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916150646426       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.916152386232       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.916155826762       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916150410457       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.916151834932       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.916153220578       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916149662919       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916150875056       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.916151422177       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.916148994608       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.916155020468       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.916155376606       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.916151504954       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.916154843531       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916157375385       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916151172942       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.916153942283       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.916146767445       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.916152478557       residual = 9.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.916152351150       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.916153759436       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916150963732       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.916151751965       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.916151912896       residual = 7.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+09 is 3.385965e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               4.941796 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4612e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.2024
    reference variance = 0.188938
====================================================
  Execution time = 1.8771e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7208e+01
  VMC Evar = 3.0026e-01
  Total weights = 1.9737e+06
  Execution time = 1.6085e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293918572876
                                         uncertainty =       0.002216839924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293918572876
                                         uncertainty =       0.002216839924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383349797
  error estimate for blocks of size 2^( 2) =       0.000398295921
  error estimate for blocks of size 2^( 3) =       0.000412313382
  error estimate for blocks of size 2^( 4) =       0.000422114493
  error estimate for blocks of size 2^( 5) =       0.000428341573
  error estimate for blocks of size 2^( 6) =       0.000431292503
  error estimate for blocks of size 2^( 7) =       0.000432158333

      target function =      -0.912352594023
              le_mean =     -17.207532830112
             les_mean =     296.399444752298
             stat err =       0.000428476726
             autocorr =       1.249292115240
   target nu stat err =       0.000428476726
   target dn stat err =       0.002473379424
      target stat err =       0.003884147546
              std dev =       0.542138481549
             le_variance =       0.293914133177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293918572876
                                         uncertainty =       0.002216839924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293918572876
                                         uncertainty =       0.002216839924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383349797
  error estimate for blocks of size 2^( 2) =       0.000398295921
  error estimate for blocks of size 2^( 3) =       0.000412313382
  error estimate for blocks of size 2^( 4) =       0.000422114493
  error estimate for blocks of size 2^( 5) =       0.000428341573
  error estimate for blocks of size 2^( 6) =       0.000431292503
  error estimate for blocks of size 2^( 7) =       0.000432158333

      target function =      -0.912352594022
              le_mean =     -17.207532830112
             les_mean =     296.399444752299
             stat err =       0.000428476726
             autocorr =       1.249292115236
   target nu stat err =       0.000428476726
   target dn stat err =       0.002473379424
      target stat err =       0.003884147546
              std dev =       0.542138481550
             le_variance =       0.293914133177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293918572876
                                         uncertainty =       0.002216839924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293918572876
                                         uncertainty =       0.002216839924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383349797
  error estimate for blocks of size 2^( 2) =       0.000398295921
  error estimate for blocks of size 2^( 3) =       0.000412313382
  error estimate for blocks of size 2^( 4) =       0.000422114493
  error estimate for blocks of size 2^( 5) =       0.000428341573
  error estimate for blocks of size 2^( 6) =       0.000431292503
  error estimate for blocks of size 2^( 7) =       0.000432158333

      target function =      -0.912352594023
              le_mean =     -17.207532830112
             les_mean =     296.399444752298
             stat err =       0.000428476726
             autocorr =       1.249292115241
   target nu stat err =       0.000428476726
   target dn stat err =       0.002473379424
      target stat err =       0.003884147546
              std dev =       0.542138481549
             le_variance =       0.293914133177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293918572876
                                         uncertainty =       0.002216839924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293918572876
                                         uncertainty =       0.002216839924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383349797
  error estimate for blocks of size 2^( 2) =       0.000398295921
  error estimate for blocks of size 2^( 3) =       0.000412313382
  error estimate for blocks of size 2^( 4) =       0.000422114493
  error estimate for blocks of size 2^( 5) =       0.000428341573
  error estimate for blocks of size 2^( 6) =       0.000431292503
  error estimate for blocks of size 2^( 7) =       0.000432158333

      target function =      -0.912352594023
              le_mean =     -17.207532830112
             les_mean =     296.399444752298
             stat err =       0.000428476726
             autocorr =       1.249292115240
   target nu stat err =       0.000428476726
   target dn stat err =       0.002473379424
      target stat err =       0.003884147546
              std dev =       0.542138481549
             le_variance =       0.293914133176


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912352594023        initial  <--
     8.4703e+07     8.4703e+08             5.4204e-12        -0.912352594022
     3.3881e+08     3.3881e+09             1.3548e-12        -0.912352594023
     1.3553e+09     1.3553e+10             3.3860e-13        -0.912352594023

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.7460
  </log>
  <optVariables href="H2O.s088.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1376e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.1486
    reference variance = 0.233164
====================================================
  Execution time = 1.9206e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5408e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.0383e-01
  Total weights = 1.973897235e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5526e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292507102966
                                         uncertainty =       0.002670949825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292507102966
                                         uncertainty =       0.002670949825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382449742
  error estimate for blocks of size 2^( 2) =       0.000397688087
  error estimate for blocks of size 2^( 3) =       0.000411755609
  error estimate for blocks of size 2^( 4) =       0.000422431034
  error estimate for blocks of size 2^( 5) =       0.000428965376
  error estimate for blocks of size 2^( 6) =       0.000432485748
  error estimate for blocks of size 2^( 7) =       0.000433748888

      target function =      -0.906823017730
              le_mean =     -17.206873535064
             les_mean =     296.380324563386
             stat err =       0.000429407761
             autocorr =       1.260639859261
   target nu stat err =       0.000429407761
   target dn stat err =       0.006085123889
      target stat err =       0.009292263140
              std dev =       0.540865612492
             le_variance =       0.292535610776


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720687353506e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+08, overlap shift 8.4703e+09 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906917689248       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906917689248       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906917689248       residual = 8.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906917685417       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906917671758       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906918111106       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906918191918       residual = 8.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906917628642       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906917738801       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906918195849       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906916659936       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906918207347       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.906918965426       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.906918891041       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.906914911710       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.906917895278       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.906916800450       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.906918165754       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.906914967097       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.906920118172       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.906920250262       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.906918796016       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.906919094972       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.906918263966       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.906918562161       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.906914625200       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.906918209425       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.906918734510       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.906918207010       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.906916440420       residual = 9.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.906917590921       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.906916796740       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.906917884934       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.906917234283       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.906918385760       residual = 8.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.4703e+08 is 3.904490e-13

solving harmonic davidson linear method for identity shift 3.3881e+09, overlap shift 3.3881e+10 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906917689248       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906917689248       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906917689248       residual = 8.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906916132534       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906918074600       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906917335450       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906922317451       residual = 8.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906924095764       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906933420179       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906923965097       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906918552001       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906900291297       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.906925627093       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.906914797546       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.906924169238       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.906928200470       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.906923004968       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.906928037960       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.906916378037       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.906912740601       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.906911738184       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.906923490830       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.906918928989       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.906934418853       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.906925956974       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.906924716344       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.906930764944       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.906912687668       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.906918194752       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.906935940463       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.906921029964       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.906925656966       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.906913187867       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.906923073118       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.906915444549       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.906920352702       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.906909695164       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.906906754039       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.906891252591       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.906914361812       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.906920256351       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.906912259803       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.906897965661       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.906926603644       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.906920806859       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.906884968935       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.906893117700       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.906941290425       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.906916618299       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.906954670057       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.906913584433       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.906876173224       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.906958089864       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.906945391282       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.906921361235       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.906960733210       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.906956146377       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.906866683935       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.906905754786       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.906971251015       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.906891879534       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.906832991880       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.906984879400       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.906444146303       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.906948677313       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.906503121485       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.907764753183       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.906921934160       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.906892111870       residual = 5.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.907201447481       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.906648551381       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.906428333137       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.907104969078       residual = 1.84e-05           smallest_sin_value = 9.98e-01
davidson iteration   73 stopping due to small subspace S singular value of 9.19e-01
davidson solver did not converge after         73 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.3881e+09 is 9.696254e-14

solving harmonic davidson linear method for identity shift 1.3553e+10, overlap shift 1.3553e+11 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906917689248       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906917689248       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906917689248       residual = 8.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906917689248       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906913375645       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906930938717       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906902396162       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906888389044       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906915140563       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906918369440       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906872631276       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906947806169       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.906950046761       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.906903001710       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.906898615367       residual = 7.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.906944917015       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.906956847729       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.906939498444       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.906844732373       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.906915439059       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.906893888710       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.906936316427       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.906938693572       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.906937214687       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.906941987513       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.906895687581       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.906948392844       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.906897424436       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.906928021267       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.906924139523       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.906881560941       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.906890738159       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.906857568596       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.906943423980       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.906892650906       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.906940036913       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.906937431653       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.906910191216       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.906935623204       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.906975065018       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.906906915183       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.906953139038       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.906889836272       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.907076540918       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.906602679475       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.906908862816       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.907160632506       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.906976397431       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.907066078460       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.906851759931       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.906966186720       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.906928508469       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.906974832117       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.906989694936       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.906862909726       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.906750246161       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.907062428422       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.906722054713       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.906711200784       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.907002230378       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.907124883566       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.907008800821       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.906631383046       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.907215394660       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.906912555305       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.909993618110       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.905042327247       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.905556640732       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.907685479476       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.906167250109       residual = 8.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.907707243242       residual = 9.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.905724862765       residual = 7.69e-04           smallest_sin_value = 9.93e-01
davidson iteration   72 stopping due to small subspace S singular value of 7.05e-01
davidson solver did not converge after         72 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3553e+10 is 2.450753e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               5.248746 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5074e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.165
    reference variance = 0.209944
====================================================
  Execution time = 1.8687e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0678e-01
  Total weights = 1.9736e+06
  Execution time = 1.6004e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295051861711
                                         uncertainty =       0.003816271602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295051861711
                                         uncertainty =       0.003816271602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384034653
  error estimate for blocks of size 2^( 2) =       0.000399177085
  error estimate for blocks of size 2^( 3) =       0.000413132894
  error estimate for blocks of size 2^( 4) =       0.000422121698
  error estimate for blocks of size 2^( 5) =       0.000427931214
  error estimate for blocks of size 2^( 6) =       0.000429782889
  error estimate for blocks of size 2^( 7) =       0.000432335239

      target function =      -0.902405366243
              le_mean =     -17.205747436268
             les_mean =     296.344524410634
             stat err =       0.000428042760
             autocorr =       1.242320019093
   target nu stat err =       0.000428042760
   target dn stat err =       0.005826247823
      target stat err =       0.008794558326
              std dev =       0.543107014161
             le_variance =       0.294965228830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295051861711
                                         uncertainty =       0.003816271602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295051861711
                                         uncertainty =       0.003816271602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384034653
  error estimate for blocks of size 2^( 2) =       0.000399177085
  error estimate for blocks of size 2^( 3) =       0.000413132894
  error estimate for blocks of size 2^( 4) =       0.000422121698
  error estimate for blocks of size 2^( 5) =       0.000427931214
  error estimate for blocks of size 2^( 6) =       0.000429782889
  error estimate for blocks of size 2^( 7) =       0.000432335239

      target function =      -0.902405366243
              le_mean =     -17.205747436268
             les_mean =     296.344524410634
             stat err =       0.000428042760
             autocorr =       1.242320019095
   target nu stat err =       0.000428042760
   target dn stat err =       0.005826247823
      target stat err =       0.008794558326
              std dev =       0.543107014161
             le_variance =       0.294965228830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295051861711
                                         uncertainty =       0.003816271602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295051861711
                                         uncertainty =       0.003816271602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384034653
  error estimate for blocks of size 2^( 2) =       0.000399177085
  error estimate for blocks of size 2^( 3) =       0.000413132894
  error estimate for blocks of size 2^( 4) =       0.000422121698
  error estimate for blocks of size 2^( 5) =       0.000427931214
  error estimate for blocks of size 2^( 6) =       0.000429782889
  error estimate for blocks of size 2^( 7) =       0.000432335239

      target function =      -0.902405366243
              le_mean =     -17.205747436268
             les_mean =     296.344524410634
             stat err =       0.000428042760
             autocorr =       1.242320019088
   target nu stat err =       0.000428042760
   target dn stat err =       0.005826247823
      target stat err =       0.008794558326
              std dev =       0.543107014161
             le_variance =       0.294965228830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295051861711
                                         uncertainty =       0.003816271602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295051861711
                                         uncertainty =       0.003816271602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384034653
  error estimate for blocks of size 2^( 2) =       0.000399177085
  error estimate for blocks of size 2^( 3) =       0.000413132894
  error estimate for blocks of size 2^( 4) =       0.000422121698
  error estimate for blocks of size 2^( 5) =       0.000427931214
  error estimate for blocks of size 2^( 6) =       0.000429782889
  error estimate for blocks of size 2^( 7) =       0.000432335239

      target function =      -0.902405366243
              le_mean =     -17.205747436268
             les_mean =     296.344524410634
             stat err =       0.000428042760
             autocorr =       1.242320019093
   target nu stat err =       0.000428042760
   target dn stat err =       0.005826247823
      target stat err =       0.008794558326
              std dev =       0.543107014161
             le_variance =       0.294965228830


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.902405366243        initial
     8.4703e+08     8.4703e+09             3.9045e-13        -0.902405366243  <--
     3.3881e+09     3.3881e+10             9.6963e-14        -0.902405366243
     1.3553e+10     1.3553e+11             2.4508e-14        -0.902405366243

*****************************************************************************
Applying the update for shift_i =   8.4703e+08     and shift_s =   8.4703e+09
*****************************************************************************

  Execution time = 2.6605e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1697e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.3051
    reference variance = 0.5311
====================================================
  Execution time = 1.8916e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5444e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9990e-01
  Total weights = 1.973899620e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6336e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291540437360
                                         uncertainty =       0.002287458467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291540437360
                                         uncertainty =       0.002287458467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381911929
  error estimate for blocks of size 2^( 2) =       0.000397604615
  error estimate for blocks of size 2^( 3) =       0.000411903999
  error estimate for blocks of size 2^( 4) =       0.000421898557
  error estimate for blocks of size 2^( 5) =       0.000428079939
  error estimate for blocks of size 2^( 6) =       0.000432011480
  error estimate for blocks of size 2^( 7) =       0.000435126351

      target function =      -0.912929583013
              le_mean =     -17.206212717946
             les_mean =     296.353654702589
             stat err =       0.000429279082
             autocorr =       1.263435294504
   target nu stat err =       0.000429279082
   target dn stat err =       0.003123273218
      target stat err =       0.004867244185
              std dev =       0.540105029945
             le_variance =       0.291713443371


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720621271795e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+08, overlap shift 2.1176e+09 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912954461005       residual = 4.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912954461005       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912954461005       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912954461005       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912954500316       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912954451099       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912954841905       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912954399089       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912954556282       residual = 9.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912954420592       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912954499323       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912954911754       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912954657725       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912954562831       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912954637023       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912954463143       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912954007772       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912954520185       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912954681378       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912954754005       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912954965246       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912953856273       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912954874562       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912954378105       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912954214934       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912953907207       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912954241724       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912954375535       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912955439486       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912955092771       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912955730422       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912954693437       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912954139360       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912954319435       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912954270029       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912954501984       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912953681869       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912954199292       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912954474440       residual = 5.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1176e+08 is 3.625934e-12

solving harmonic davidson linear method for identity shift 8.4703e+08, overlap shift 8.4703e+09 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912954461005       residual = 4.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912954461005       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912954461005       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912954461005       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912954461005       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912954461005       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912954461005       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912954405966       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912954763674       residual = 9.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912955196113       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912956827635       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912954000708       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912952406891       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912954485270       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912953996928       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912955099696       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912955119221       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912955506089       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912954786028       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912952476979       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912954064968       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912955545031       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912956466926       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912954485232       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912954754893       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912955166778       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912956183838       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912952467794       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912955031361       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912955019668       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912957063768       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912960301589       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912953788055       residual = 6.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912952207636       residual = 6.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912952855815       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912956215643       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912955760348       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912952889547       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912957364166       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         38 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.4703e+08 is 9.073702e-13

solving harmonic davidson linear method for identity shift 3.3881e+09, overlap shift 3.3881e+10 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912954461005       residual = 4.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912954461005       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912954461005       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912954461005       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912954461005       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912954461005       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912954461005       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912954461005       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912954461005       residual = 9.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912955423103       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912948127006       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912958156523       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.912943509524       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.912949180736       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.912949519999       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.912954461005       residual = 9.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.912954481760       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.912954471734       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.912948953489       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912960412190       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.912924572069       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.912954205243       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.912934310458       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.912952586529       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.912958251617       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.912954542952       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912945494378       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.912952154663       residual = 8.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.912965906823       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912945219458       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912983519051       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.912950416981       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.912958267248       residual = 8.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912952302686       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.912953754921       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912967122392       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.912950186484       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912966290945       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.912948414702       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.912946452788       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.912950591159       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.912947803557       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.912957990206       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.912949960369       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.912942111441       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.912957513180       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.912928113047       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.912940157400       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.912986170320       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.912941737218       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.912967115110       residual = 6.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.912947454511       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.912908279223       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.912930633916       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.912919768910       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.912908706201       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.913014658759       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.912937895897       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.913082866469       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.912919325368       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.913261682582       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.912650258408       residual = 9.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.913024865098       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.913034001094       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.913324232516       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.913596268871       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.913706693892       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.913536595840       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.912993563646       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.913769630733       residual = 6.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.913959054116       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.910952788245       residual = 4.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   72:   krylov dim =  73   tar_fn =      -0.911991335382       residual = 1.95e-04           smallest_sin_value = 9.99e-01
davidson iteration   73 stopping due to small subspace S singular value of 8.64e-01
davidson solver did not converge after         73 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.3881e+09 is 2.266893e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               5.444664 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4754e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.1796
    reference variance = 0.227841
====================================================
  Execution time = 2.1125e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9571e-01
  Total weights = 1.9738e+06
  Execution time = 1.6065e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289473536754
                                         uncertainty =       0.001510979295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289473536754
                                         uncertainty =       0.001510979295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380437508
  error estimate for blocks of size 2^( 2) =       0.000395705203
  error estimate for blocks of size 2^( 3) =       0.000409624125
  error estimate for blocks of size 2^( 4) =       0.000419905637
  error estimate for blocks of size 2^( 5) =       0.000426470885
  error estimate for blocks of size 2^( 6) =       0.000430367108
  error estimate for blocks of size 2^( 7) =       0.000432814170

      target function =      -0.919438371622
              le_mean =     -17.206257758365
             les_mean =     296.351020137914
             stat err =       0.000427389450
             autocorr =       1.262062721603
   target nu stat err =       0.000427389450
   target dn stat err =       0.002005044269
      target stat err =       0.003217348471
              std dev =       0.538019883275
             le_variance =       0.289465394799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289473536754
                                         uncertainty =       0.001510979295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289473536754
                                         uncertainty =       0.001510979295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380437508
  error estimate for blocks of size 2^( 2) =       0.000395705203
  error estimate for blocks of size 2^( 3) =       0.000409624125
  error estimate for blocks of size 2^( 4) =       0.000419905637
  error estimate for blocks of size 2^( 5) =       0.000426470885
  error estimate for blocks of size 2^( 6) =       0.000430367108
  error estimate for blocks of size 2^( 7) =       0.000432814170

      target function =      -0.919438371622
              le_mean =     -17.206257758365
             les_mean =     296.351020137914
             stat err =       0.000427389450
             autocorr =       1.262062721599
   target nu stat err =       0.000427389450
   target dn stat err =       0.002005044269
      target stat err =       0.003217348471
              std dev =       0.538019883275
             le_variance =       0.289465394799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289473536754
                                         uncertainty =       0.001510979295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289473536754
                                         uncertainty =       0.001510979295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380437508
  error estimate for blocks of size 2^( 2) =       0.000395705203
  error estimate for blocks of size 2^( 3) =       0.000409624125
  error estimate for blocks of size 2^( 4) =       0.000419905637
  error estimate for blocks of size 2^( 5) =       0.000426470885
  error estimate for blocks of size 2^( 6) =       0.000430367108
  error estimate for blocks of size 2^( 7) =       0.000432814170

      target function =      -0.919438371622
              le_mean =     -17.206257758365
             les_mean =     296.351020137914
             stat err =       0.000427389450
             autocorr =       1.262062721601
   target nu stat err =       0.000427389450
   target dn stat err =       0.002005044269
      target stat err =       0.003217348471
              std dev =       0.538019883275
             le_variance =       0.289465394799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289473536754
                                         uncertainty =       0.001510979295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289473536754
                                         uncertainty =       0.001510979295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380437508
  error estimate for blocks of size 2^( 2) =       0.000395705203
  error estimate for blocks of size 2^( 3) =       0.000409624125
  error estimate for blocks of size 2^( 4) =       0.000419905637
  error estimate for blocks of size 2^( 5) =       0.000426470885
  error estimate for blocks of size 2^( 6) =       0.000430367108
  error estimate for blocks of size 2^( 7) =       0.000432814170

      target function =      -0.919438371622
              le_mean =     -17.206257758365
             les_mean =     296.351020137914
             stat err =       0.000427389450
             autocorr =       1.262062721606
   target nu stat err =       0.000427389450
   target dn stat err =       0.002005044269
      target stat err =       0.003217348471
              std dev =       0.538019883275
             le_variance =       0.289465394799


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919438371622        initial
     2.1176e+08     2.1176e+09             3.6259e-12        -0.919438371622
     8.4703e+08     8.4703e+09             9.0737e-13        -0.919438371622  <--
     3.3881e+09     3.3881e+10             2.2669e-13        -0.919438371622

*****************************************************************************
Applying the update for shift_i =   8.4703e+08     and shift_s =   8.4703e+09
*****************************************************************************

  Execution time = 2.9047e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.3815e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.1744
    reference variance = 0.208352
====================================================
  Execution time = 1.9282e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5420e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9967e-01
  Total weights = 1.973418051e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291041299313
                                         uncertainty =       0.002331310658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291041299313
                                         uncertainty =       0.002331310658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381600031
  error estimate for blocks of size 2^( 2) =       0.000396991015
  error estimate for blocks of size 2^( 3) =       0.000411118670
  error estimate for blocks of size 2^( 4) =       0.000421610860
  error estimate for blocks of size 2^( 5) =       0.000427666013
  error estimate for blocks of size 2^( 6) =       0.000430685489
  error estimate for blocks of size 2^( 7) =       0.000431205308

      target function =      -0.913281858077
              le_mean =     -17.205918519853
             les_mean =     296.343307043852
             stat err =       0.000427791917
             autocorr =       1.256748419953
   target nu stat err =       0.000427791917
   target dn stat err =       0.003045474779
      target stat err =       0.004749374201
              std dev =       0.539663938744
             le_variance =       0.291237166780


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720591851985e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+08, overlap shift 2.1176e+09 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913305150122       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913305150122       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913305150122       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913305150122       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913305150122       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913305324980       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913305226794       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913304965600       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913305085880       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913305070075       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913304970984       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913305149078       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913304668772       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913305028650       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913304842462       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913304900437       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913305189225       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913304464041       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913304266888       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913305343645       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913305129987       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913305246146       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913306322132       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913305779151       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913305514808       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913305100285       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913304781061       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913305543158       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913305507326       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913304863767       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913304145217       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913304917334       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913305369385       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913305142827       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913305228235       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913304837142       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1176e+08 is 2.077446e-12

solving harmonic davidson linear method for identity shift 8.4703e+08, overlap shift 8.4703e+09 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913305150122       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913305150122       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913305150122       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913305150122       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913305147757       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913305020054       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913306644984       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913305409335       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913304909729       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913304454330       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913304515277       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913302979687       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913305632510       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913306669651       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913304387653       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913306974032       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913302982970       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913305407278       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913303617161       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913303550379       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913305452447       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913304622939       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913305248043       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913305375661       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913303885306       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913300871159       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913303008801       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913302578011       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913303509156       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913303288378       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913308547074       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913301669446       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913305574900       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913302912817       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913303996276       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913302848361       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913306563717       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913304168326       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         37 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.4703e+08 is 5.194241e-13

solving harmonic davidson linear method for identity shift 3.3881e+09, overlap shift 3.3881e+10 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913305150122       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913305150122       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913305150122       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913305527624       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913303450067       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913307625971       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913306458361       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913302243796       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913289326660       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913303955269       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913294570610       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913307279976       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913300079981       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913309079468       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913313191555       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913305518208       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913291305615       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913306808519       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913311332172       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913308424082       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913303094164       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913312865177       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913297008919       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913309202196       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913309844390       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913306720783       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913295735549       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913295580968       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913308545735       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913303861826       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913299523260       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913292922833       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913293713030       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913300443827       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913307173907       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913313014109       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913301806984       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913305497598       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913299566776       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.913295126408       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.913283637211       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.913302613542       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.913293729550       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.913268463242       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.913296939942       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.913302088027       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.913296871324       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.913305863367       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.913312605246       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.913280930059       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.913334588101       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.913332178647       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.913251964913       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.913299607599       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.913332377831       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.913269165144       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.913234085357       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.913324944999       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.913253653566       residual = 9.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.913288016148       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.913204910307       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.913200921854       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.913182058853       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.913374499563       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.913336797204       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.913377803428       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.912928922316       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.913052027982       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.913067191055       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.912769727467       residual = 4.39e-05           smallest_sin_value = 9.99e-01
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.913409947984       residual = 7.46e-05           smallest_sin_value = 9.96e-01
davidson iteration   71 stopping due to small subspace S singular value of 7.31e-01
davidson solver did not converge after         71 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.3881e+09 is 1.303486e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               5.608039 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4975e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2604
    reference variance = 0.266923
====================================================
  Execution time = 1.9061e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9530e-01
  Total weights = 1.9736e+06
  Execution time = 1.5951e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287912803487
                                         uncertainty =       0.001641448728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287912803487
                                         uncertainty =       0.001641448728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379365882
  error estimate for blocks of size 2^( 2) =       0.000394573809
  error estimate for blocks of size 2^( 3) =       0.000408570742
  error estimate for blocks of size 2^( 4) =       0.000419048369
  error estimate for blocks of size 2^( 5) =       0.000426050122
  error estimate for blocks of size 2^( 6) =       0.000430337240
  error estimate for blocks of size 2^( 7) =       0.000433720771

      target function =      -0.920083987835
              le_mean =     -17.206406379908
             les_mean =     296.355720244798
             stat err =       0.000427289126
             autocorr =       1.268607104838
   target nu stat err =       0.000427289126
   target dn stat err =       0.002108477387
      target stat err =       0.003380580757
              std dev =       0.536504375813
             le_variance =       0.287836945266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287912803487
                                         uncertainty =       0.001641448728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287912803487
                                         uncertainty =       0.001641448728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379365882
  error estimate for blocks of size 2^( 2) =       0.000394573809
  error estimate for blocks of size 2^( 3) =       0.000408570742
  error estimate for blocks of size 2^( 4) =       0.000419048369
  error estimate for blocks of size 2^( 5) =       0.000426050122
  error estimate for blocks of size 2^( 6) =       0.000430337240
  error estimate for blocks of size 2^( 7) =       0.000433720771

      target function =      -0.920083987836
              le_mean =     -17.206406379908
             les_mean =     296.355720244797
             stat err =       0.000427289126
             autocorr =       1.268607104840
   target nu stat err =       0.000427289126
   target dn stat err =       0.002108477387
      target stat err =       0.003380580757
              std dev =       0.536504375813
             le_variance =       0.287836945266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287912803487
                                         uncertainty =       0.001641448728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287912803487
                                         uncertainty =       0.001641448728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379365882
  error estimate for blocks of size 2^( 2) =       0.000394573809
  error estimate for blocks of size 2^( 3) =       0.000408570742
  error estimate for blocks of size 2^( 4) =       0.000419048369
  error estimate for blocks of size 2^( 5) =       0.000426050122
  error estimate for blocks of size 2^( 6) =       0.000430337240
  error estimate for blocks of size 2^( 7) =       0.000433720771

      target function =      -0.920083987836
              le_mean =     -17.206406379908
             les_mean =     296.355720244797
             stat err =       0.000427289126
             autocorr =       1.268607104828
   target nu stat err =       0.000427289126
   target dn stat err =       0.002108477387
      target stat err =       0.003380580757
              std dev =       0.536504375813
             le_variance =       0.287836945266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287912803487
                                         uncertainty =       0.001641448728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287912803487
                                         uncertainty =       0.001641448728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379365882
  error estimate for blocks of size 2^( 2) =       0.000394573809
  error estimate for blocks of size 2^( 3) =       0.000408570742
  error estimate for blocks of size 2^( 4) =       0.000419048369
  error estimate for blocks of size 2^( 5) =       0.000426050122
  error estimate for blocks of size 2^( 6) =       0.000430337240
  error estimate for blocks of size 2^( 7) =       0.000433720771

      target function =      -0.920083987835
              le_mean =     -17.206406379908
             les_mean =     296.355720244798
             stat err =       0.000427289126
             autocorr =       1.268607104839
   target nu stat err =       0.000427289126
   target dn stat err =       0.002108477387
      target stat err =       0.003380580757
              std dev =       0.536504375813
             le_variance =       0.287836945266


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920083987835        initial
     2.1176e+08     2.1176e+09             2.0774e-12        -0.920083987836  <--
     8.4703e+08     8.4703e+09             5.1942e-13        -0.920083987836
     3.3881e+09     3.3881e+10             1.3035e-13        -0.920083987835

*****************************************************************************
Applying the update for shift_i =   2.1176e+08     and shift_s =   2.1176e+09
*****************************************************************************

  Execution time = 2.6947e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1928e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.225
    reference variance = 0.179286
====================================================
  Execution time = 1.9113e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5423e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9887e-01
  Total weights = 1.974055786e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4995e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290267467234
                                         uncertainty =       0.002237382341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290267467234
                                         uncertainty =       0.002237382341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380949850
  error estimate for blocks of size 2^( 2) =       0.000395929661
  error estimate for blocks of size 2^( 3) =       0.000409983592
  error estimate for blocks of size 2^( 4) =       0.000420473169
  error estimate for blocks of size 2^( 5) =       0.000426561152
  error estimate for blocks of size 2^( 6) =       0.000429072360
  error estimate for blocks of size 2^( 7) =       0.000431244349

      target function =      -0.914524233150
              le_mean =     -17.205959354360
             les_mean =     296.343905855967
             stat err =       0.000426837757
             autocorr =       1.255422896583
   target nu stat err =       0.000426837757
   target dn stat err =       0.003113987131
      target stat err =       0.004866980143
              std dev =       0.538744444404
             le_variance =       0.290245576376


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720595935436e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e+07, overlap shift 5.2940e+08 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914549093255       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914549093256       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914549093256       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914549093256       residual = 8.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914549093256       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914549093256       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914549137969       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914549093256       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914549093256       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914548991660       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914549047677       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914549181694       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914549082042       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914549088286       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914549120083       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914549169867       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914549128245       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914548956845       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914549250348       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914548987192       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914548816982       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914549087369       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914549118237       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914549196603       residual = 9.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914549135224       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914549224565       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914549304869       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914549075745       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914549067292       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914549106540       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914548923908       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914549155716       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914548790223       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914549186526       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914549175509       residual = 9.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.2940e+07 is 6.994962e-12

solving harmonic davidson linear method for identity shift 2.1176e+08, overlap shift 2.1176e+09 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914549093255       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914549093255       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914549093255       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914549093255       residual = 8.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914549093255       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914549093255       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914549093255       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914549093255       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914549093255       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914549093255       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914549365175       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914549093255       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914549093255       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914549485814       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914548816149       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914549093255       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914549093255       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914549093255       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914549437777       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914548890620       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914548522296       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914549093255       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914548110106       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914548555598       residual = 9.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914548878251       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914549154690       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914548734324       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914548751321       residual = 7.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914549201541       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914548465806       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914548551381       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914548770905       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914548577535       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914548887701       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914549128979       residual = 9.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1176e+08 is 1.748752e-12

solving harmonic davidson linear method for identity shift 8.4703e+08, overlap shift 8.4703e+09 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914549093255       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914549093255       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914549093255       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914549093255       residual = 8.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914549183902       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914549093255       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914549093255       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914549981525       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914550330529       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914551145225       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914549979224       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914549874917       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.914548613372       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.914549569759       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.914546620610       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.914549093255       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.914547895950       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.914549246138       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.914550193621       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.914547224664       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.914549093255       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.914547961866       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.914549978665       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.914545382475       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.914549688637       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.914548791353       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.914549257527       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.914549479735       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914548385518       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.914547427628       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.914550607502       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.914553797094       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.914549328614       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.914548965987       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.914549452984       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914546541681       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.4703e+08 is 4.372031e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               5.655277 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4665e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.1618
    reference variance = 0.247851
====================================================
  Execution time = 1.8860e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9891e-01
  Total weights = 1.9737e+06
  Execution time = 1.6016e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290707452320
                                         uncertainty =       0.002291799513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290707452320
                                         uncertainty =       0.002291799513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381255839
  error estimate for blocks of size 2^( 2) =       0.000396345147
  error estimate for blocks of size 2^( 3) =       0.000410295402
  error estimate for blocks of size 2^( 4) =       0.000420743278
  error estimate for blocks of size 2^( 5) =       0.000426987926
  error estimate for blocks of size 2^( 6) =       0.000430872814
  error estimate for blocks of size 2^( 7) =       0.000431685777

      target function =      -0.914451931767
              le_mean =     -17.206914077054
             les_mean =     296.376800810397
             stat err =       0.000427572449
             autocorr =       1.257727100798
   target nu stat err =       0.000427572449
   target dn stat err =       0.002567738694
      target stat err =       0.004040614398
              std dev =       0.539177178184
             le_variance =       0.290712029475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290707452319
                                         uncertainty =       0.002291799513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290707452319
                                         uncertainty =       0.002291799513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381255839
  error estimate for blocks of size 2^( 2) =       0.000396345147
  error estimate for blocks of size 2^( 3) =       0.000410295402
  error estimate for blocks of size 2^( 4) =       0.000420743278
  error estimate for blocks of size 2^( 5) =       0.000426987926
  error estimate for blocks of size 2^( 6) =       0.000430872814
  error estimate for blocks of size 2^( 7) =       0.000431685777

      target function =      -0.914451931751
              le_mean =     -17.206914077054
             les_mean =     296.376800810408
             stat err =       0.000427572449
             autocorr =       1.257727100803
   target nu stat err =       0.000427572449
   target dn stat err =       0.002567738694
      target stat err =       0.004040614397
              std dev =       0.539177178183
             le_variance =       0.290712029474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290707452319
                                         uncertainty =       0.002291799513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290707452319
                                         uncertainty =       0.002291799513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381255839
  error estimate for blocks of size 2^( 2) =       0.000396345147
  error estimate for blocks of size 2^( 3) =       0.000410295402
  error estimate for blocks of size 2^( 4) =       0.000420743278
  error estimate for blocks of size 2^( 5) =       0.000426987926
  error estimate for blocks of size 2^( 6) =       0.000430872814
  error estimate for blocks of size 2^( 7) =       0.000431685777

      target function =      -0.914451931759
              le_mean =     -17.206914077054
             les_mean =     296.376800810402
             stat err =       0.000427572449
             autocorr =       1.257727100794
   target nu stat err =       0.000427572449
   target dn stat err =       0.002567738694
      target stat err =       0.004040614398
              std dev =       0.539177178184
             le_variance =       0.290712029474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290707452320
                                         uncertainty =       0.002291799513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290707452320
                                         uncertainty =       0.002291799513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381255839
  error estimate for blocks of size 2^( 2) =       0.000396345147
  error estimate for blocks of size 2^( 3) =       0.000410295402
  error estimate for blocks of size 2^( 4) =       0.000420743278
  error estimate for blocks of size 2^( 5) =       0.000426987926
  error estimate for blocks of size 2^( 6) =       0.000430872814
  error estimate for blocks of size 2^( 7) =       0.000431685777

      target function =      -0.914451931766
              le_mean =     -17.206914077054
             les_mean =     296.376800810397
             stat err =       0.000427572449
             autocorr =       1.257727100794
   target nu stat err =       0.000427572449
   target dn stat err =       0.002567738694
      target stat err =       0.004040614398
              std dev =       0.539177178184
             le_variance =       0.290712029475


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914451931767        initial  <--
     5.2940e+07     5.2940e+08             6.9950e-12        -0.914451931751
     2.1176e+08     2.1176e+09             1.7488e-12        -0.914451931759
     8.4703e+08     8.4703e+09             4.3720e-13        -0.914451931766

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.7952
  </log>
  <optVariables href="H2O.s092.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1467e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.2172
    reference variance = 0.171469
====================================================
  Execution time = 1.9261e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5420e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0233e-01
  Total weights = 1.973850354e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5164e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293046119023
                                         uncertainty =       0.002165384805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293046119023
                                         uncertainty =       0.002165384805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382716408
  error estimate for blocks of size 2^( 2) =       0.000398078619
  error estimate for blocks of size 2^( 3) =       0.000412419497
  error estimate for blocks of size 2^( 4) =       0.000422568065
  error estimate for blocks of size 2^( 5) =       0.000428331235
  error estimate for blocks of size 2^( 6) =       0.000431497984
  error estimate for blocks of size 2^( 7) =       0.000431158642

      target function =      -0.909209404874
              le_mean =     -17.206082830241
             les_mean =     296.351612497829
             stat err =       0.000428388981
             autocorr =       1.252917338383
   target nu stat err =       0.000428388981
   target dn stat err =       0.003020269791
      target stat err =       0.004671123044
              std dev =       0.541242734842
             le_variance =       0.292943698019


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720608283024e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e+08, overlap shift 5.2940e+09 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909232341443       residual = 7.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909232341443       residual = 7.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909232341443       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909232341443       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909232279702       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909232306125       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909232480877       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909232172999       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909233731708       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909232524004       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909232533412       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909231426166       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.909231594934       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.909232258663       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.909231975083       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.909231120271       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.909232656870       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.909232214026       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.909232845955       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.909231079834       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.909232309531       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909232331575       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.909233407248       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.909232257526       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.909230821675       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909232612161       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.909232380213       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.909231935183       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.909231368282       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.909233070382       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.909234792929       residual = 6.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909232829246       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.909231908371       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.909232390173       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.909232656944       residual = 8.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.2940e+08 is 5.942990e-13

solving harmonic davidson linear method for identity shift 2.1176e+09, overlap shift 2.1176e+10 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909232341443       residual = 7.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909232341443       residual = 7.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909232341443       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909231711465       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909230962663       residual = 6.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909232634464       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909229370002       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909232975275       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909234493266       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909234285543       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909232017489       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909226982792       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.909233467674       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.909235806300       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.909232866260       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.909228782718       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.909234691974       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.909235345099       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.909234290965       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.909232127643       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.909233454430       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909229473992       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.909232874379       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.909237190164       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.909234097750       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909228975715       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.909233453696       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.909230211538       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.909217121436       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.909222604910       residual = 9.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.909234720708       residual = 6.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909229025822       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.909232273349       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.909228041649       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.909222588076       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.909228464036       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1176e+09 is 1.486492e-13

solving harmonic davidson linear method for identity shift 8.4703e+09, overlap shift 8.4703e+10 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909232341443       residual = 7.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909232341443       residual = 7.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909232341443       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909232341443       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909232341443       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909232316216       residual = 6.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909218023677       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909236171452       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909223531693       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909194809330       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909253195825       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909223937112       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.909236197408       residual = 9.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.909235765315       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.909213750042       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.909231084876       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.909223799914       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.909228167412       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.909187011424       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.909230781557       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.909261213600       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909205684640       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.909207802633       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.909236572346       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.909246313953       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.909218140312       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.909254708781       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.909229680717       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.909235316932       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.909265378840       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.909244636966       residual = 9.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.909254946954       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.909228194480       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.909113382269       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.909234637068       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.909388912574       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.909130821070       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.909281939843       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.909254481141       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.909279731396       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.909290361989       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.909295616086       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.909177388386       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.909232035199       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.909208324327       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.909310262336       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.909222593569       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.909203787807       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.909134746096       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.909301072363       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.909318255165       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.909080067552       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.909336025450       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.909503697207       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.909218733395       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.909292244875       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.909406638179       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.909305293957       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.909437875632       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.909141745719       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.908741864259       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.908812914596       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.909210971988       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.909642598316       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.909593705938       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.911565368613       residual = 6.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.910882550518       residual = 9.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.910524612308       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.909002803274       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.908385515883       residual = 7.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.907369779443       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.905166982040       residual = 1.80e-03           smallest_sin_value = 9.97e-01
davidson iteration   72 stopping due to small subspace S singular value of 9.43e-01
davidson solver did not converge after         72 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.4703e+09 is 3.739188e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               5.821810 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4949e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.2043
    reference variance = 0.151834
====================================================
  Execution time = 1.9342e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9843e-01
  Total weights = 1.9738e+06
  Execution time = 1.6099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289514985874
                                         uncertainty =       0.001860417279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289514985874
                                         uncertainty =       0.001860417279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380516601
  error estimate for blocks of size 2^( 2) =       0.000395928606
  error estimate for blocks of size 2^( 3) =       0.000410422462
  error estimate for blocks of size 2^( 4) =       0.000421081624
  error estimate for blocks of size 2^( 5) =       0.000426990117
  error estimate for blocks of size 2^( 6) =       0.000430112792
  error estimate for blocks of size 2^( 7) =       0.000430685619

      target function =      -0.915195259048
              le_mean =     -17.206644258047
             les_mean =     296.367039351038
             stat err =       0.000427217538
             autocorr =       1.260523445489
   target nu stat err =       0.000427217538
   target dn stat err =       0.002515017598
      target stat err =       0.003964581855
              std dev =       0.538131738145
             le_variance =       0.289585767599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289514985874
                                         uncertainty =       0.001860417279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289514985874
                                         uncertainty =       0.001860417279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380516601
  error estimate for blocks of size 2^( 2) =       0.000395928606
  error estimate for blocks of size 2^( 3) =       0.000410422462
  error estimate for blocks of size 2^( 4) =       0.000421081624
  error estimate for blocks of size 2^( 5) =       0.000426990117
  error estimate for blocks of size 2^( 6) =       0.000430112792
  error estimate for blocks of size 2^( 7) =       0.000430685619

      target function =      -0.915195259047
              le_mean =     -17.206644258047
             les_mean =     296.367039351038
             stat err =       0.000427217538
             autocorr =       1.260523445495
   target nu stat err =       0.000427217538
   target dn stat err =       0.002515017598
      target stat err =       0.003964581855
              std dev =       0.538131738145
             le_variance =       0.289585767599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289514985874
                                         uncertainty =       0.001860417279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289514985874
                                         uncertainty =       0.001860417279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380516601
  error estimate for blocks of size 2^( 2) =       0.000395928606
  error estimate for blocks of size 2^( 3) =       0.000410422462
  error estimate for blocks of size 2^( 4) =       0.000421081624
  error estimate for blocks of size 2^( 5) =       0.000426990117
  error estimate for blocks of size 2^( 6) =       0.000430112792
  error estimate for blocks of size 2^( 7) =       0.000430685619

      target function =      -0.915195259048
              le_mean =     -17.206644258047
             les_mean =     296.367039351038
             stat err =       0.000427217538
             autocorr =       1.260523445502
   target nu stat err =       0.000427217538
   target dn stat err =       0.002515017598
      target stat err =       0.003964581855
              std dev =       0.538131738145
             le_variance =       0.289585767599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289514985874
                                         uncertainty =       0.001860417279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289514985874
                                         uncertainty =       0.001860417279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380516601
  error estimate for blocks of size 2^( 2) =       0.000395928606
  error estimate for blocks of size 2^( 3) =       0.000410422462
  error estimate for blocks of size 2^( 4) =       0.000421081624
  error estimate for blocks of size 2^( 5) =       0.000426990117
  error estimate for blocks of size 2^( 6) =       0.000430112792
  error estimate for blocks of size 2^( 7) =       0.000430685619

      target function =      -0.915195259048
              le_mean =     -17.206644258047
             les_mean =     296.367039351038
             stat err =       0.000427217538
             autocorr =       1.260523445495
   target nu stat err =       0.000427217538
   target dn stat err =       0.002515017598
      target stat err =       0.003964581855
              std dev =       0.538131738145
             le_variance =       0.289585767599


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915195259048        initial  <--
     5.2940e+08     5.2940e+09             5.9430e-13        -0.915195259047
     2.1176e+09     2.1176e+10             1.4865e-13        -0.915195259048
     8.4703e+09     8.4703e+10             3.7392e-14        -0.915195259048

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.2913
  </log>
  <optVariables href="H2O.s093.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2247e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.2163
    reference variance = 0.667389
====================================================
  Execution time = 1.9097e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5429e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9959e-01
  Total weights = 1.973695595e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5793e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291869918804
                                         uncertainty =       0.002136947797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291869918804
                                         uncertainty =       0.002136947797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381990567
  error estimate for blocks of size 2^( 2) =       0.000397055508
  error estimate for blocks of size 2^( 3) =       0.000410744199
  error estimate for blocks of size 2^( 4) =       0.000421055590
  error estimate for blocks of size 2^( 5) =       0.000426879988
  error estimate for blocks of size 2^( 6) =       0.000430622156
  error estimate for blocks of size 2^( 7) =       0.000433148251

      target function =      -0.913430175061
              le_mean =     -17.205757737488
             les_mean =     296.337684574661
             stat err =       0.000427926496
             autocorr =       1.254969230505
   target nu stat err =       0.000427926496
   target dn stat err =       0.002527477063
      target stat err =       0.003962191174
              std dev =       0.540216240871
             le_variance =       0.291833586901


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720575773749e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e+09, overlap shift 5.2940e+10 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913446450851       residual = 5.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913446450851       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913446450851       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913446450851       residual = 7.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913446419218       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913452173319       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913452759491       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913449792847       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913443708434       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913443462162       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913441673088       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913461901089       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913450656375       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913440070440       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913447446997       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913442567513       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913445391835       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913431455737       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913452552664       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913465956974       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913459916214       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913444243410       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913461489503       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913452034572       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913436069411       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913437463893       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913439066499       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913450234816       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913452487229       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913435278518       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913449019363       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913452849699       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913451987808       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913453231160       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913439512569       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913453313802       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913443837984       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913442523677       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913462524134       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.913445133478       residual = 6.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         39 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.2940e+09 is 5.139954e-14

solving harmonic davidson linear method for identity shift 2.1176e+10, overlap shift 2.1176e+11 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913446450851       residual = 5.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913446450851       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913446450851       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913454722582       residual = 7.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913451670197       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913463204777       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913450914115       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913463463498       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913448414525       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913483788436       residual = 9.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913451154279       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913425263557       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913450165325       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913454721532       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913412362670       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913437006716       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913395466545       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913518600541       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913449750074       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913476222527       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913458501428       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913371000907       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913484629582       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913469857711       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913503936168       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913438369878       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913420684726       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913465516510       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913361142974       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913416205896       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.913418294891       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913430798306       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913371742416       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.913363360120       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913424908860       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.913502275395       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913312715640       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913421876190       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913620607542       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.913478128328       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.913484033685       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.913299623129       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.913338698099       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.913342938550       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.913514867704       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.913567437893       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.913318561656       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.913971300939       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.913365152963       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.913198687494       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.913258815233       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.913317810563       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.913576958274       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.913647720856       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.913959611000       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.913325849575       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.913809879683       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.913194356752       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.912745854251       residual = 6.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.912740833158       residual = 7.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.912229271556       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.915412719897       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.914086590522       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.913834799036       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.913809222184       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.912585934359       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.921489909310       residual = 6.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.918008876497       residual = 3.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.923708390776       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.913656216604       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.908036827399       residual = 4.23e-03           smallest_sin_value = 9.98e-01
davidson iteration   71 stopping due to small subspace S singular value of 9.13e-01
davidson solver did not converge after         71 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1176e+10 is 1.286394e-14

solving harmonic davidson linear method for identity shift 8.4703e+10, overlap shift 8.4703e+11 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913446450851       residual = 5.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913446450851       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913446450851       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913493619587       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913471653853       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913471485567       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913439328762       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913397327301       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913446450851       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913602316763       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913565391728       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913486254016       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913469466426       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913441849289       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913488056862       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913178911703       residual = 8.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913459284344       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913211310686       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913213811046       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913242805538       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913246468465       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913510512754       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913520447649       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913639215486       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913413668438       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913369717298       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913437089005       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913608351798       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.913557951665       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.913425700164       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.912874166715       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.913362629986       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.913481584385       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.912925590468       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.913422575697       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.912895523046       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.913325223219       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913692843335       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.913108670068       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.913156946680       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.913155801805       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.913838850926       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.912701362494       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.913094220084       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.912601167565       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.914292120454       residual = 9.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.913360034144       residual = 9.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.913282591766       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.913883507625       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.913126993395       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.913484207113       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.914413884156       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.911962277706       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.911598984416       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.913299563936       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.914690467879       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.915760766386       residual = 2.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.911715045405       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.910148035745       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.912225738201       residual = 7.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.918923434285       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.911370427161       residual = 9.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.915697851463       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.914770731937       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.909294401887       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.875758860882       residual = 1.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.893481014159       residual = 8.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.917954483560       residual = 2.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.894401106026       residual = 6.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.905271326300       residual = 3.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.929384856814       residual = 1.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.952103507872       residual = 2.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   72 stopping due to small subspace S singular value of 9.20e-01
davidson solver did not converge after         72 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.4703e+10 is 2.663760e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               6.106549 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4967e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.2104
    reference variance = 0.222814
====================================================
  Execution time = 1.9363e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9612e-01
  Total weights = 1.9739e+06
  Execution time = 1.6017e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289082398523
                                         uncertainty =       0.001979575721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289082398523
                                         uncertainty =       0.001979575721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380204280
  error estimate for blocks of size 2^( 2) =       0.000395292166
  error estimate for blocks of size 2^( 3) =       0.000409401427
  error estimate for blocks of size 2^( 4) =       0.000420036901
  error estimate for blocks of size 2^( 5) =       0.000427086912
  error estimate for blocks of size 2^( 6) =       0.000431034625
  error estimate for blocks of size 2^( 7) =       0.000430852730

      target function =      -0.918798071648
              le_mean =     -17.206767065756
             les_mean =     296.368949425445
             stat err =       0.000427252792
             autocorr =       1.262803615011
   target nu stat err =       0.000427252792
   target dn stat err =       0.002483613440
      target stat err =       0.003948014148
              std dev =       0.537690048876
             le_variance =       0.289110588661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289082398523
                                         uncertainty =       0.001979575721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289082398523
                                         uncertainty =       0.001979575721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380204280
  error estimate for blocks of size 2^( 2) =       0.000395292166
  error estimate for blocks of size 2^( 3) =       0.000409401427
  error estimate for blocks of size 2^( 4) =       0.000420036901
  error estimate for blocks of size 2^( 5) =       0.000427086912
  error estimate for blocks of size 2^( 6) =       0.000431034625
  error estimate for blocks of size 2^( 7) =       0.000430852730

      target function =      -0.918798071648
              le_mean =     -17.206767065756
             les_mean =     296.368949425445
             stat err =       0.000427252792
             autocorr =       1.262803615011
   target nu stat err =       0.000427252792
   target dn stat err =       0.002483613440
      target stat err =       0.003948014148
              std dev =       0.537690048876
             le_variance =       0.289110588661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289082398523
                                         uncertainty =       0.001979575721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289082398523
                                         uncertainty =       0.001979575721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380204280
  error estimate for blocks of size 2^( 2) =       0.000395292166
  error estimate for blocks of size 2^( 3) =       0.000409401427
  error estimate for blocks of size 2^( 4) =       0.000420036901
  error estimate for blocks of size 2^( 5) =       0.000427086912
  error estimate for blocks of size 2^( 6) =       0.000431034625
  error estimate for blocks of size 2^( 7) =       0.000430852730

      target function =      -0.918798071648
              le_mean =     -17.206767065756
             les_mean =     296.368949425445
             stat err =       0.000427252792
             autocorr =       1.262803614999
   target nu stat err =       0.000427252792
   target dn stat err =       0.002483613440
      target stat err =       0.003948014148
              std dev =       0.537690048876
             le_variance =       0.289110588661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289082398523
                                         uncertainty =       0.001979575721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289082398523
                                         uncertainty =       0.001979575721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380204280
  error estimate for blocks of size 2^( 2) =       0.000395292166
  error estimate for blocks of size 2^( 3) =       0.000409401427
  error estimate for blocks of size 2^( 4) =       0.000420036901
  error estimate for blocks of size 2^( 5) =       0.000427086912
  error estimate for blocks of size 2^( 6) =       0.000431034625
  error estimate for blocks of size 2^( 7) =       0.000430852730

      target function =      -0.918798071648
              le_mean =     -17.206767065756
             les_mean =     296.368949425445
             stat err =       0.000427252792
             autocorr =       1.262803615010
   target nu stat err =       0.000427252792
   target dn stat err =       0.002483613440
      target stat err =       0.003948014148
              std dev =       0.537690048876
             le_variance =       0.289110588661


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918798071648        initial
     5.2940e+09     5.2940e+10             5.1400e-14        -0.918798071648  <--
     2.1176e+10     2.1176e+11             1.2864e-14        -0.918798071648
     8.4703e+10     8.4703e+11             2.6638e-15        -0.918798071648

*****************************************************************************
Applying the update for shift_i =   5.2940e+09     and shift_s =   5.2940e+10
*****************************************************************************

  Execution time = 2.7292e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2265e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.2766
    reference variance = 0.223176
====================================================
  Execution time = 1.9232e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5421e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9587e-01
  Total weights = 1.973831869e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5371e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288233159283
                                         uncertainty =       0.001827698765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288233159283
                                         uncertainty =       0.001827698765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379588620
  error estimate for blocks of size 2^( 2) =       0.000394956916
  error estimate for blocks of size 2^( 3) =       0.000408572346
  error estimate for blocks of size 2^( 4) =       0.000418371961
  error estimate for blocks of size 2^( 5) =       0.000424615984
  error estimate for blocks of size 2^( 6) =       0.000427114499
  error estimate for blocks of size 2^( 7) =       0.000427829740

      target function =      -0.919197641309
              le_mean =     -17.205871639352
             les_mean =     296.337886205027
             stat err =       0.000424483046
             autocorr =       1.250530618051
   target nu stat err =       0.000424483046
   target dn stat err =       0.002395917240
      target stat err =       0.003809459948
              std dev =       0.536819375097
             le_variance =       0.288175041479


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720587163935e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e+09, overlap shift 1.3235e+10 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919212549519       residual = 5.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919212549519       residual = 6.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919212549519       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919212549519       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919212212080       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919212549519       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919210422335       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919209856120       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919210603095       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919212156610       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919214508349       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919212840803       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919211550429       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919213073239       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919211778287       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919212065362       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919219414381       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919212092984       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919215768282       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919211885426       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919208675080       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919214382574       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919214577716       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919212646808       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919214645990       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919209481197       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919212357726       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919212726599       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919213865108       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919214450172       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919212415286       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919213303076       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919213019847       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919220436930       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919211379269       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919211966229       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3235e+09 is 1.885735e-13

solving harmonic davidson linear method for identity shift 5.2940e+09, overlap shift 5.2940e+10 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919212549519       residual = 5.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919212549519       residual = 6.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919212549519       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919212522272       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919212549264       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919211949137       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919211707665       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919202596169       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919204305471       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919213142335       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919217943576       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919208376495       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919217454137       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919222089989       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919225438722       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919202957579       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919218951433       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919203480839       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919181268258       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919207859759       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919178146123       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919230903289       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919204299937       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919220624600       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919217685345       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919222549820       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919204550250       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919232010440       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919215255969       residual = 6.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919212923607       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919222634025       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919210197610       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919206898203       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919190635916       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919233742422       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919223533392       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.919203037837       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.919210934232       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.919215255425       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.919195030187       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.919215903782       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         40 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.2940e+09 is 4.681892e-14

solving harmonic davidson linear method for identity shift 2.1176e+10, overlap shift 2.1176e+11 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919212549519       residual = 5.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919212549519       residual = 6.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919212549519       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919212549519       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919213254589       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919223651498       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919241494323       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919220479054       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919186641851       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919168279051       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919227076611       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919160858388       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.919194639855       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.919142193816       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.919256959727       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.919214612337       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.919222085107       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.919215976460       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.919285877603       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.919184276859       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919153447907       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.919260137987       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.919295990109       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.919182440765       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.919214009765       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.919192460651       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.919204816042       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.919281633331       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.919222811916       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.919243902922       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.919201336311       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.919241613802       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.919176846475       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.919333439643       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.919342794193       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.919160396935       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.919211727413       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.919321147578       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.919289136060       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.919034229274       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.919298761616       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.919435681755       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.918861155663       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.919277550304       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.918879976594       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.919100314592       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.918992050378       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.919307647745       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.919022222488       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.919462310788       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.920240809780       residual = 9.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.920383765535       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.918628680458       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.918270197839       residual = 8.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.918958037953       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.918832237847       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.919566607383       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.918143921446       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.918020889538       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.924538508884       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.924108347621       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.920838303811       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.917888981531       residual = 7.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.921967308693       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.918654146570       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.918427189383       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.917806968683       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.926517429771       residual = 6.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.925516732216       residual = 4.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.923171525300       residual = 5.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.914882275440       residual = 8.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   71:   krylov dim =  72   tar_fn =      -0.917719174820       residual = 2.82e-03           smallest_sin_value = 9.97e-01
davidson iteration   72 stopping due to small subspace S singular value of 9.72e-01
davidson solver did not converge after         72 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.1176e+10 is 1.179892e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               6.282920 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4951e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.2772
    reference variance = 0.298893
====================================================
  Execution time = 1.9217e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9866e-01
  Total weights = 1.9738e+06
  Execution time = 1.5997e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290564971734
                                         uncertainty =       0.001983200861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290564971734
                                         uncertainty =       0.001983200861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381194888
  error estimate for blocks of size 2^( 2) =       0.000396571088
  error estimate for blocks of size 2^( 3) =       0.000409916734
  error estimate for blocks of size 2^( 4) =       0.000420292174
  error estimate for blocks of size 2^( 5) =       0.000427042739
  error estimate for blocks of size 2^( 6) =       0.000428269861
  error estimate for blocks of size 2^( 7) =       0.000430126989

      target function =      -0.914840743137
              le_mean =     -17.206475134258
             les_mean =     296.361449394992
             stat err =       0.000426432941
             autocorr =       1.251432287543
   target nu stat err =       0.000426432941
   target dn stat err =       0.002609040758
      target stat err =       0.004103301311
              std dev =       0.539090980008
             le_variance =       0.290619084725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290564971734
                                         uncertainty =       0.001983200861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290564971734
                                         uncertainty =       0.001983200861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381194888
  error estimate for blocks of size 2^( 2) =       0.000396571088
  error estimate for blocks of size 2^( 3) =       0.000409916734
  error estimate for blocks of size 2^( 4) =       0.000420292174
  error estimate for blocks of size 2^( 5) =       0.000427042739
  error estimate for blocks of size 2^( 6) =       0.000428269861
  error estimate for blocks of size 2^( 7) =       0.000430126989

      target function =      -0.914840743138
              le_mean =     -17.206475134258
             les_mean =     296.361449394991
             stat err =       0.000426432941
             autocorr =       1.251432287547
   target nu stat err =       0.000426432941
   target dn stat err =       0.002609040758
      target stat err =       0.004103301310
              std dev =       0.539090980008
             le_variance =       0.290619084726

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290564971733
                                         uncertainty =       0.001983200861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290564971733
                                         uncertainty =       0.001983200861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381194888
  error estimate for blocks of size 2^( 2) =       0.000396571088
  error estimate for blocks of size 2^( 3) =       0.000409916734
  error estimate for blocks of size 2^( 4) =       0.000420292174
  error estimate for blocks of size 2^( 5) =       0.000427042739
  error estimate for blocks of size 2^( 6) =       0.000428269861
  error estimate for blocks of size 2^( 7) =       0.000430126989

      target function =      -0.914840743137
              le_mean =     -17.206475134258
             les_mean =     296.361449394992
             stat err =       0.000426432941
             autocorr =       1.251432287550
   target nu stat err =       0.000426432941
   target dn stat err =       0.002609040758
      target stat err =       0.004103301311
              std dev =       0.539090980008
             le_variance =       0.290619084726

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290564971734
                                         uncertainty =       0.001983200861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290564971734
                                         uncertainty =       0.001983200861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381194888
  error estimate for blocks of size 2^( 2) =       0.000396571088
  error estimate for blocks of size 2^( 3) =       0.000409916734
  error estimate for blocks of size 2^( 4) =       0.000420292174
  error estimate for blocks of size 2^( 5) =       0.000427042739
  error estimate for blocks of size 2^( 6) =       0.000428269861
  error estimate for blocks of size 2^( 7) =       0.000430126989

      target function =      -0.914840743137
              le_mean =     -17.206475134258
             les_mean =     296.361449394992
             stat err =       0.000426432941
             autocorr =       1.251432287544
   target nu stat err =       0.000426432941
   target dn stat err =       0.002609040758
      target stat err =       0.004103301311
              std dev =       0.539090980007
             le_variance =       0.290619084725


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914840743137        initial
     1.3235e+09     1.3235e+10             1.8857e-13        -0.914840743138  <--
     5.2940e+09     5.2940e+10             4.6819e-14        -0.914840743137
     2.1176e+10     2.1176e+11             1.1799e-14        -0.914840743137

*****************************************************************************
Applying the update for shift_i =   1.3235e+09     and shift_s =   1.3235e+10
*****************************************************************************

  Execution time = 2.7183e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2141e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.2099
    reference variance = 0.365331
====================================================
  Execution time = 2.1607e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5419e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9811e-01
  Total weights = 1.974035055e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4976e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290099632264
                                         uncertainty =       0.001866814100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290099632264
                                         uncertainty =       0.001866814100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380894124
  error estimate for blocks of size 2^( 2) =       0.000395915851
  error estimate for blocks of size 2^( 3) =       0.000410091708
  error estimate for blocks of size 2^( 4) =       0.000420194485
  error estimate for blocks of size 2^( 5) =       0.000426538034
  error estimate for blocks of size 2^( 6) =       0.000430584976
  error estimate for blocks of size 2^( 7) =       0.000431232906

      target function =      -0.915692664833
              le_mean =     -17.206309402666
             les_mean =     296.355197717490
             stat err =       0.000427137600
             autocorr =       1.257555212129
   target nu stat err =       0.000427137600
   target dn stat err =       0.002654568160
      target stat err =       0.004179293862
              std dev =       0.538665635455
             le_variance =       0.290160666820


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720630940267e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3087e+08, overlap shift 3.3087e+09 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915710676248       residual = 4.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915710676249       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915710676249       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915710676249       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915710676249       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915710795424       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915710733374       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915709860188       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915711288338       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915711065238       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915710647713       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915710352966       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915711211383       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915711222503       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915710378102       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915710304037       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915710472366       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915710841518       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915710379918       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915710522658       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915710880469       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915710346368       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915711351261       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915709928450       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915710435850       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915711184755       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915710555165       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915709961824       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915711787535       residual = 9.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915710301129       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915709634369       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915709730155       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915710679307       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915709109426       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915710263006       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.3087e+08 is 1.144078e-12

solving harmonic davidson linear method for identity shift 1.3235e+09, overlap shift 1.3235e+10 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915710676248       residual = 4.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915710676248       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915710676248       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915711057589       residual = 8.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915711617091       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915710529577       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915708923196       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915708002772       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915711069836       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915711494342       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915710728633       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915711345795       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915710764571       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915712340112       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915713926351       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915710299886       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915708691338       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915711718745       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915708460148       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915710713078       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915709724732       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915709323175       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915713213060       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915711334781       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915713063756       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915706884793       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915711557833       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915708427402       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915710477803       residual = 9.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915710104992       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915711958116       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915704390647       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915709475510       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915710022887       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915708851632       residual = 6.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3235e+09 is 2.858591e-13

solving harmonic davidson linear method for identity shift 5.2940e+09, overlap shift 5.2940e+10 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915710676248       residual = 4.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915710676248       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915710676248       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915710676248       residual = 8.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915717374566       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915710767582       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915704887269       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915691662949       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915708923224       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915727670542       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915721725507       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915702671429       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915709267154       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915718159333       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915704019955       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915721245964       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915727438034       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915708586553       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915704774613       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915744274956       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915710368138       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915703924326       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915719556440       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915716725351       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915725997741       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915721306385       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915714819394       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915690547217       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915710560028       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915714074801       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915699159270       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915711516244       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915728953262       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915710178343       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915724514412       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915706562365       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915705980339       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.915692436193       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915721061450       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915713907641       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.915711969436       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.915728454030       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.915715383809       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.915676690729       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.915675545701       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.915712551466       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.915726317552       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.915700454410       residual = 9.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.915680498944       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.915707232238       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.915654955338       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.915707380153       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.915713887350       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.915654754619       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.915717128680       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.915679681117       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.915575883081       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.915704212518       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   tar_fn =      -0.915806276333       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   tar_fn =      -0.915688561196       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   tar_fn =      -0.915633833761       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   tar_fn =      -0.915364425224       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   tar_fn =      -0.916310342137       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   tar_fn =      -0.915451064186       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   tar_fn =      -0.916121992498       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   tar_fn =      -0.915988232784       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   tar_fn =      -0.915616521305       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   tar_fn =      -0.914023251404       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   tar_fn =      -0.913513213192       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   69:   krylov dim =  70   tar_fn =      -0.915797923485       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   70:   krylov dim =  71   tar_fn =      -0.920772138197       residual = 2.57e-03           smallest_sin_value = 9.98e-01
davidson iteration   71 stopping due to small subspace S singular value of 9.64e-01
davidson solver did not converge after         71 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 5.2940e+09 is 7.161686e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               6.441208 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7268e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.2112
    reference variance = 0.249234
====================================================
  Execution time = 1.9299e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7205e+01
  VMC Evar = 2.9322e-01
  Total weights = 1.9740e+06
  Execution time = 1.6048e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286828736353
                                         uncertainty =       0.001676752434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286828736353
                                         uncertainty =       0.001676752434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378748172
  error estimate for blocks of size 2^( 2) =       0.000394136397
  error estimate for blocks of size 2^( 3) =       0.000408004932
  error estimate for blocks of size 2^( 4) =       0.000417651750
  error estimate for blocks of size 2^( 5) =       0.000424080198
  error estimate for blocks of size 2^( 6) =       0.000428030488
  error estimate for blocks of size 2^( 7) =       0.000430064948

      target function =      -0.923356265525
              le_mean =     -17.205464693806
             les_mean =     296.321233178756
             stat err =       0.000424956846
             autocorr =       1.258892275605
   target nu stat err =       0.000424956846
   target dn stat err =       0.002134381634
      target stat err =       0.003437195915
              std dev =       0.535630801567
             le_variance =       0.286900355588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286828736353
                                         uncertainty =       0.001676752434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286828736353
                                         uncertainty =       0.001676752434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378748172
  error estimate for blocks of size 2^( 2) =       0.000394136397
  error estimate for blocks of size 2^( 3) =       0.000408004932
  error estimate for blocks of size 2^( 4) =       0.000417651750
  error estimate for blocks of size 2^( 5) =       0.000424080198
  error estimate for blocks of size 2^( 6) =       0.000428030488
  error estimate for blocks of size 2^( 7) =       0.000430064948

      target function =      -0.923356265526
              le_mean =     -17.205464693806
             les_mean =     296.321233178756
             stat err =       0.000424956846
             autocorr =       1.258892275601
   target nu stat err =       0.000424956846
   target dn stat err =       0.002134381634
      target stat err =       0.003437195915
              std dev =       0.535630801567
             le_variance =       0.286900355588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286828736353
                                         uncertainty =       0.001676752434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286828736353
                                         uncertainty =       0.001676752434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378748172
  error estimate for blocks of size 2^( 2) =       0.000394136397
  error estimate for blocks of size 2^( 3) =       0.000408004932
  error estimate for blocks of size 2^( 4) =       0.000417651750
  error estimate for blocks of size 2^( 5) =       0.000424080198
  error estimate for blocks of size 2^( 6) =       0.000428030488
  error estimate for blocks of size 2^( 7) =       0.000430064948

      target function =      -0.923356265525
              le_mean =     -17.205464693806
             les_mean =     296.321233178756
             stat err =       0.000424956846
             autocorr =       1.258892275609
   target nu stat err =       0.000424956846
   target dn stat err =       0.002134381634
      target stat err =       0.003437195915
              std dev =       0.535630801567
             le_variance =       0.286900355588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286828736353
                                         uncertainty =       0.001676752434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286828736353
                                         uncertainty =       0.001676752434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378748172
  error estimate for blocks of size 2^( 2) =       0.000394136397
  error estimate for blocks of size 2^( 3) =       0.000408004932
  error estimate for blocks of size 2^( 4) =       0.000417651750
  error estimate for blocks of size 2^( 5) =       0.000424080198
  error estimate for blocks of size 2^( 6) =       0.000428030488
  error estimate for blocks of size 2^( 7) =       0.000430064948

      target function =      -0.923356265525
              le_mean =     -17.205464693806
             les_mean =     296.321233178756
             stat err =       0.000424956846
             autocorr =       1.258892275608
   target nu stat err =       0.000424956846
   target dn stat err =       0.002134381634
      target stat err =       0.003437195915
              std dev =       0.535630801567
             le_variance =       0.286900355588


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.923356265525        initial
     3.3087e+08     3.3087e+09             1.1441e-12        -0.923356265526  <--
     1.3235e+09     1.3235e+10             2.8586e-13        -0.923356265525
     5.2940e+09     5.2940e+10             7.1617e-14        -0.923356265525

*****************************************************************************
Applying the update for shift_i =   3.3087e+08     and shift_s =   3.3087e+09
*****************************************************************************

  Execution time = 2.7255e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4529e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.175
    reference variance = 0.399908
====================================================
  Execution time = 1.9269e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5405e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 2.9519e-01
  Total weights = 1.973799056e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289239949073
                                         uncertainty =       0.001751665115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289239949073
                                         uncertainty =       0.001751665115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380324761
  error estimate for blocks of size 2^( 2) =       0.000395656212
  error estimate for blocks of size 2^( 3) =       0.000409220826
  error estimate for blocks of size 2^( 4) =       0.000419365279
  error estimate for blocks of size 2^( 5) =       0.000425696795
  error estimate for blocks of size 2^( 6) =       0.000427495907
  error estimate for blocks of size 2^( 7) =       0.000427828290

      target function =      -0.920248696464
              le_mean =     -17.207051726872
             les_mean =     296.377820861415
             stat err =       0.000425096568
             autocorr =       1.249297852477
   target nu stat err =       0.000425096568
   target dn stat err =       0.001961722976
      target stat err =       0.003160568725
              std dev =       0.537860435780
             le_variance =       0.289293848377


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720705172687e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+07, overlap shift 8.2718e+08 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920258516691       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920258516691       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920258516691       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920258516691       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920258516509       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920258488356       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920258465634       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920258493741       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920258490873       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920258346020       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920258601270       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920258699006       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920258417925       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920258829558       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920258608678       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920258574806       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920258473466       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920258373558       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920258736208       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920258563371       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920258111721       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920258835445       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920258757614       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920258680540       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920258469825       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920258178213       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920258165880       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920258531337       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920258849603       residual = 9.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920258426492       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920258315103       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920258337755       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920258156058       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920258554884       residual = 8.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.2718e+07 is 5.431472e-12

solving harmonic davidson linear method for identity shift 3.3087e+08, overlap shift 3.3087e+09 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920258516691       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920258516691       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920258516691       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920258516691       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920258516691       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920258637065       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920258027225       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920258360656       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920258576058       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920258563323       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920258853513       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920258899794       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920259831282       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920258156577       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920258138557       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920259000692       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920259214121       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920258722784       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920258784321       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920258525589       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920258812359       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920258556734       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920258424966       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920258779420       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920258036418       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920258361235       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920257817655       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920258570166       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920257544327       residual = 9.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920257586661       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920257849125       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920258486769       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920258439404       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920258703252       residual = 8.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.3087e+08 is 1.357994e-12

solving harmonic davidson linear method for identity shift 1.3235e+09, overlap shift 1.3235e+10 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920258516691       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920258516691       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920258516691       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920258516691       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920258516691       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920258515262       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920261683376       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920261060994       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920256906280       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920259212054       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920259334805       residual = 9.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920261009782       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920258581583       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.920258921334       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.920255853005       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.920259156928       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.920260116054       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.920259946006       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.920254684444       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.920257492101       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.920260046238       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.920254747340       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920260017085       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920259872087       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.920256721516       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.920253361506       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.920258995053       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.920258661444       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.920258282053       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.920259661108       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.920261740072       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.920261316035       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920259908752       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920262157691       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 1.3235e+09 is 3.392435e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               6.483528 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4801e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.136
    reference variance = 0.372563
====================================================
  Execution time = 1.9039e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9712e-01
  Total weights = 1.9739e+06
  Execution time = 1.6037e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289427458671
                                         uncertainty =       0.002008132922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289427458671
                                         uncertainty =       0.002008132922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380374791
  error estimate for blocks of size 2^( 2) =       0.000395977965
  error estimate for blocks of size 2^( 3) =       0.000410120493
  error estimate for blocks of size 2^( 4) =       0.000419989569
  error estimate for blocks of size 2^( 5) =       0.000426609248
  error estimate for blocks of size 2^( 6) =       0.000427774734
  error estimate for blocks of size 2^( 7) =       0.000429499407

      target function =      -0.917244804211
              le_mean =     -17.205745819142
             les_mean =     296.334809365477
             stat err =       0.000425968240
             autocorr =       1.254096585961
   target nu stat err =       0.000425968240
   target dn stat err =       0.002596504309
      target stat err =       0.004099684294
              std dev =       0.537931187632
             le_variance =       0.289369962627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289427458670
                                         uncertainty =       0.002008132922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289427458670
                                         uncertainty =       0.002008132922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380374791
  error estimate for blocks of size 2^( 2) =       0.000395977965
  error estimate for blocks of size 2^( 3) =       0.000410120493
  error estimate for blocks of size 2^( 4) =       0.000419989569
  error estimate for blocks of size 2^( 5) =       0.000426609248
  error estimate for blocks of size 2^( 6) =       0.000427774734
  error estimate for blocks of size 2^( 7) =       0.000429499407

      target function =      -0.917244804212
              le_mean =     -17.205745819142
             les_mean =     296.334809365477
             stat err =       0.000425968240
             autocorr =       1.254096585955
   target nu stat err =       0.000425968240
   target dn stat err =       0.002596504309
      target stat err =       0.004099684294
              std dev =       0.537931187632
             le_variance =       0.289369962627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289427458670
                                         uncertainty =       0.002008132922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289427458670
                                         uncertainty =       0.002008132922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380374791
  error estimate for blocks of size 2^( 2) =       0.000395977965
  error estimate for blocks of size 2^( 3) =       0.000410120493
  error estimate for blocks of size 2^( 4) =       0.000419989569
  error estimate for blocks of size 2^( 5) =       0.000426609248
  error estimate for blocks of size 2^( 6) =       0.000427774734
  error estimate for blocks of size 2^( 7) =       0.000429499407

      target function =      -0.917244804212
              le_mean =     -17.205745819142
             les_mean =     296.334809365477
             stat err =       0.000425968240
             autocorr =       1.254096585953
   target nu stat err =       0.000425968240
   target dn stat err =       0.002596504309
      target stat err =       0.004099684294
              std dev =       0.537931187632
             le_variance =       0.289369962627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289427458671
                                         uncertainty =       0.002008132922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289427458671
                                         uncertainty =       0.002008132922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380374791
  error estimate for blocks of size 2^( 2) =       0.000395977965
  error estimate for blocks of size 2^( 3) =       0.000410120493
  error estimate for blocks of size 2^( 4) =       0.000419989569
  error estimate for blocks of size 2^( 5) =       0.000426609248
  error estimate for blocks of size 2^( 6) =       0.000427774734
  error estimate for blocks of size 2^( 7) =       0.000429499407

      target function =      -0.917244804211
              le_mean =     -17.205745819142
             les_mean =     296.334809365477
             stat err =       0.000425968240
             autocorr =       1.254096585953
   target nu stat err =       0.000425968240
   target dn stat err =       0.002596504309
      target stat err =       0.004099684294
              std dev =       0.537931187632
             le_variance =       0.289369962627


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917244804211        initial
     8.2718e+07     8.2718e+08             5.4315e-12        -0.917244804212  <--
     3.3087e+08     3.3087e+09             1.3580e-12        -0.917244804212
     1.3235e+09     1.3235e+10             3.3924e-13        -0.917244804211

*****************************************************************************
Applying the update for shift_i =   8.2718e+07     and shift_s =   8.2718e+08
*****************************************************************************

  Execution time = 2.6993e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1800e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.2118
    reference variance = 0.175239
====================================================
  Execution time = 1.9174e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5400e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9694e-01
  Total weights = 1.973905192e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5292e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289944005400
                                         uncertainty =       0.001803279493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289944005400
                                         uncertainty =       0.001803279493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380744042
  error estimate for blocks of size 2^( 2) =       0.000396186745
  error estimate for blocks of size 2^( 3) =       0.000410184869
  error estimate for blocks of size 2^( 4) =       0.000420723836
  error estimate for blocks of size 2^( 5) =       0.000427367318
  error estimate for blocks of size 2^( 6) =       0.000430119246
  error estimate for blocks of size 2^( 7) =       0.000431062302

      target function =      -0.917521972751
              le_mean =     -17.206499594615
             les_mean =     296.360564606984
             stat err =       0.000427318175
             autocorr =       1.259611156462
   target nu stat err =       0.000427318175
   target dn stat err =       0.002556187186
      target stat err =       0.004046457852
              std dev =       0.538453388068
             le_variance =       0.289932051122


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720649959462e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0680e+07, overlap shift 2.0680e+08 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917538697623       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917538697624       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917538697625       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917538710274       residual = 6.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917538697625       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917538697625       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917538670434       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917538701201       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917538643499       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917538663050       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917538680397       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917538702775       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917538738404       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917538686845       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917538689816       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917538747079       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917538723486       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917538675086       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917538657783       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917538643569       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917538748679       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917538652790       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917538681185       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917538723409       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917538736033       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917538778814       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917538573075       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917538762780       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917538597608       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917538667450       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917538732596       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917538659057       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917538698405       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917538660050       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917538624956       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.0680e+07 is 1.535707e-11

solving harmonic davidson linear method for identity shift 8.2718e+07, overlap shift 8.2718e+08 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917538697623       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917538697624       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917538697624       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917538750004       residual = 6.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917538709453       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917538716776       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917538697624       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917538731345       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917538628327       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917538852353       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917538809313       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917538697624       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917538629011       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917538653221       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917538599934       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917538564563       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917538899322       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917538614492       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917538808991       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917538699928       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917538771414       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917538570297       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917538768458       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917538722736       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917538615559       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917538760776       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917538753873       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917538749421       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917538740298       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917538729095       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917538688028       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917538461373       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917538398452       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917539008818       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917538546709       residual = 9.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.2718e+07 is 3.839085e-12

solving harmonic davidson linear method for identity shift 3.3087e+08, overlap shift 3.3087e+09 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917538697623       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917538697623       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917538697623       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917538697623       residual = 6.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917538687368       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917538697623       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917538959171       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917539244939       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917538574942       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917538453915       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917538125709       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917539329253       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917538721174       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.917539684591       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.917538734334       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.917539218704       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.917538682935       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.917538697623       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.917538611191       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.917538951544       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.917538984698       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.917539249995       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.917538304973       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.917539441561       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.917539061083       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.917538488936       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.917540786989       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.917537468955       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.917538985908       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.917539689715       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.917538200003       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.917539778998       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.917537829940       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.917537398345       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917537200232       residual = 9.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.3087e+08 is 9.593032e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               6.529264 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.4755e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.1723
    reference variance = 0.239977
====================================================
  Execution time = 1.8962e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9987e-01
  Total weights = 1.9738e+06
  Execution time = 1.5935e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291499078241
                                         uncertainty =       0.001854130544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291499078241
                                         uncertainty =       0.001854130544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381749178
  error estimate for blocks of size 2^( 2) =       0.000397326290
  error estimate for blocks of size 2^( 3) =       0.000411111673
  error estimate for blocks of size 2^( 4) =       0.000421336168
  error estimate for blocks of size 2^( 5) =       0.000427551637
  error estimate for blocks of size 2^( 6) =       0.000430868310
  error estimate for blocks of size 2^( 7) =       0.000432886803

      target function =      -0.912979914458
              le_mean =     -17.206074213871
             les_mean =     296.348861929177
             stat err =       0.000428160730
             autocorr =       1.257932801548
   target nu stat err =       0.000428160730
   target dn stat err =       0.002671913090
      target stat err =       0.004179753412
              std dev =       0.539874865242
             le_variance =       0.291464870120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291499078241
                                         uncertainty =       0.001854130544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291499078241
                                         uncertainty =       0.001854130544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381749178
  error estimate for blocks of size 2^( 2) =       0.000397326290
  error estimate for blocks of size 2^( 3) =       0.000411111673
  error estimate for blocks of size 2^( 4) =       0.000421336168
  error estimate for blocks of size 2^( 5) =       0.000427551637
  error estimate for blocks of size 2^( 6) =       0.000430868310
  error estimate for blocks of size 2^( 7) =       0.000432886803

      target function =      -0.912979914453
              le_mean =     -17.206074213870
             les_mean =     296.348861929178
             stat err =       0.000428160730
             autocorr =       1.257932801554
   target nu stat err =       0.000428160730
   target dn stat err =       0.002671913090
      target stat err =       0.004179753412
              std dev =       0.539874865242
             le_variance =       0.291464870120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291499078241
                                         uncertainty =       0.001854130544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291499078241
                                         uncertainty =       0.001854130544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381749178
  error estimate for blocks of size 2^( 2) =       0.000397326290
  error estimate for blocks of size 2^( 3) =       0.000411111673
  error estimate for blocks of size 2^( 4) =       0.000421336168
  error estimate for blocks of size 2^( 5) =       0.000427551637
  error estimate for blocks of size 2^( 6) =       0.000430868310
  error estimate for blocks of size 2^( 7) =       0.000432886803

      target function =      -0.912979914455
              le_mean =     -17.206074213871
             les_mean =     296.348861929178
             stat err =       0.000428160730
             autocorr =       1.257932801555
   target nu stat err =       0.000428160730
   target dn stat err =       0.002671913090
      target stat err =       0.004179753412
              std dev =       0.539874865241
             le_variance =       0.291464870119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291499078241
                                         uncertainty =       0.001854130544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291499078241
                                         uncertainty =       0.001854130544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381749178
  error estimate for blocks of size 2^( 2) =       0.000397326290
  error estimate for blocks of size 2^( 3) =       0.000411111673
  error estimate for blocks of size 2^( 4) =       0.000421336168
  error estimate for blocks of size 2^( 5) =       0.000427551637
  error estimate for blocks of size 2^( 6) =       0.000430868310
  error estimate for blocks of size 2^( 7) =       0.000432886803

      target function =      -0.912979914458
              le_mean =     -17.206074213871
             les_mean =     296.348861929177
             stat err =       0.000428160730
             autocorr =       1.257932801547
   target nu stat err =       0.000428160730
   target dn stat err =       0.002671913090
      target stat err =       0.004179753412
              std dev =       0.539874865242
             le_variance =       0.291464870120


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912979914458        initial  <--
     2.0680e+07     2.0680e+08             1.5357e-11        -0.912979914453
     8.2718e+07     8.2718e+08             3.8391e-12        -0.912979914455
     3.3087e+08     3.3087e+09             9.5930e-13        -0.912979914458

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.8911
  </log>
  <optVariables href="H2O.s098.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.1652e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 11912 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.1677
    reference variance = 0.276589
====================================================
  Execution time = 1.9440e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5423e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 2.9851e-01
  Total weights = 1.973913210e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5378e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291307421109
                                         uncertainty =       0.002290490028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291307421109
                                         uncertainty =       0.002290490028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381601513
  error estimate for blocks of size 2^( 2) =       0.000396796126
  error estimate for blocks of size 2^( 3) =       0.000410849178
  error estimate for blocks of size 2^( 4) =       0.000421500346
  error estimate for blocks of size 2^( 5) =       0.000427711913
  error estimate for blocks of size 2^( 6) =       0.000431656100
  error estimate for blocks of size 2^( 7) =       0.000436574523

      target function =      -0.915080237838
              le_mean =     -17.205956529825
             les_mean =     296.343454376741
             stat err =       0.000429360720
             autocorr =       1.265973005191
   target nu stat err =       0.000429360720
   target dn stat err =       0.002570810816
      target stat err =       0.004044138771
              std dev =       0.539666035663
             le_variance =       0.291239430048


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720595652982e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 81
Check correct_vf_var_size: 246, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0680e+08, overlap shift 2.0680e+09 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915097088415       residual = 6.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915097088415       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915097088415       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915097088415       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915097078132       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915097083032       residual = 7.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915097015880       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915097076756       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915097370431       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915097580170       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915097020358       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915097048277       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915096711197       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915097188056       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915097525285       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915097131156       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915096965932       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915096901208       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915097044823       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915097298763       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915096889492       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915096636929       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915097273897       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915096341202       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915096666037       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915096432815       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915096213174       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915096848703       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915097461726       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915096634734       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915097191336       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915097132438       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915097323977       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915096705818       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915096677085       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915096851779       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 2.0680e+08 is 1.814282e-12

solving harmonic davidson linear method for identity shift 8.2718e+08, overlap shift 8.2718e+09 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915097088415       residual = 6.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915097088415       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915097088415       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915097088414       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915097088415       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915097210429       residual = 7.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915097594478       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915097277528       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915096926951       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915096137706       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915097533589       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915094667850       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915096665804       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915097783582       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915096643555       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915094511877       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915095512532       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915096766124       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915096861616       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915095945640       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915096934601       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915098003794       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915097837388       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915097116919       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915099618349       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915098051583       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915097120396       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915096760185       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915098948810       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915098107129       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915096854031       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915098272673       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915096410315       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915094814318       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915097783980       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915093349209       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 8.2718e+08 is 4.534002e-13

solving harmonic davidson linear method for identity shift 3.3087e+09, overlap shift 3.3087e+10 and omega -1.7747e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915097088415       residual = 6.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915097088415       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915097088415       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915097088415       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915097088415       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915097048287       residual = 7.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915098479790       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915098796465       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915098676290       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915099128107       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915096873811       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915097293907       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.915097116045       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.915091224404       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.915095242901       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.915092627924       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.915109611216       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.915090608154       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.915097195353       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.915097357214       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.915096234291       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.915097721683       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.915098053969       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.915098484865       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.915103513400       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.915095260705       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915093488911       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.915092705773       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.915092280776       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.915099139192       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.915105866177       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915104257569       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915091360444       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.915085330057       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.915094599971       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.915085016233       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.915097535218       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 82 and evec_eigen.size(): 82
The largest weight on the derivative vector for shift 3.3087e+09 is 1.135336e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               6.580048 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 82 and numParams is: 81

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5039e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.2407
    reference variance = 0.47414
====================================================
  Execution time = 1.9107e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.0499e-01
  Total weights = 1.9735e+06
  Execution time = 1.5914e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291204839504
                                         uncertainty =       0.001662597461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291204839504
                                         uncertainty =       0.001662597461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381605061
  error estimate for blocks of size 2^( 2) =       0.000396568414
  error estimate for blocks of size 2^( 3) =       0.000410626426
  error estimate for blocks of size 2^( 4) =       0.000421133100
  error estimate for blocks of size 2^( 5) =       0.000427448529
  error estimate for blocks of size 2^( 6) =       0.000431748537
  error estimate for blocks of size 2^( 7) =       0.000434654061

      target function =      -0.905057143742
              le_mean =     -17.206282298565
             les_mean =     296.361136412710
             stat err =       0.000428746057
             autocorr =       1.262327449891
   target nu stat err =       0.000428746057
   target dn stat err =       0.006946210476
      target stat err =       0.010547308499
              std dev =       0.539671052450
             le_variance =       0.291244844853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291204839504
                                         uncertainty =       0.001662597461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291204839504
                                         uncertainty =       0.001662597461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381605061
  error estimate for blocks of size 2^( 2) =       0.000396568414
  error estimate for blocks of size 2^( 3) =       0.000410626426
  error estimate for blocks of size 2^( 4) =       0.000421133100
  error estimate for blocks of size 2^( 5) =       0.000427448529
  error estimate for blocks of size 2^( 6) =       0.000431748537
  error estimate for blocks of size 2^( 7) =       0.000434654061

      target function =      -0.905057143730
              le_mean =     -17.206282298565
             les_mean =     296.361136412719
             stat err =       0.000428746057
             autocorr =       1.262327449886
   target nu stat err =       0.000428746057
   target dn stat err =       0.006946210480
      target stat err =       0.010547308505
              std dev =       0.539671052450
             le_variance =       0.291244844853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291204839504
                                         uncertainty =       0.001662597461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291204839504
                                         uncertainty =       0.001662597461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381605061
  error estimate for blocks of size 2^( 2) =       0.000396568414
  error estimate for blocks of size 2^( 3) =       0.000410626426
  error estimate for blocks of size 2^( 4) =       0.000421133100
  error estimate for blocks of size 2^( 5) =       0.000427448529
  error estimate for blocks of size 2^( 6) =       0.000431748537
  error estimate for blocks of size 2^( 7) =       0.000434654061

      target function =      -0.905057143736
              le_mean =     -17.206282298565
             les_mean =     296.361136412714
             stat err =       0.000428746057
             autocorr =       1.262327449888
   target nu stat err =       0.000428746057
   target dn stat err =       0.006946210478
      target stat err =       0.010547308502
              std dev =       0.539671052450
             le_variance =       0.291244844853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291204839504
                                         uncertainty =       0.001662597461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291204839504
                                         uncertainty =       0.001662597461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381605061
  error estimate for blocks of size 2^( 2) =       0.000396568414
  error estimate for blocks of size 2^( 3) =       0.000410626426
  error estimate for blocks of size 2^( 4) =       0.000421133100
  error estimate for blocks of size 2^( 5) =       0.000427448529
  error estimate for blocks of size 2^( 6) =       0.000431748537
  error estimate for blocks of size 2^( 7) =       0.000434654061

      target function =      -0.905057143741
              le_mean =     -17.206282298565
             les_mean =     296.361136412711
             stat err =       0.000428746057
             autocorr =       1.262327449888
   target nu stat err =       0.000428746057
   target dn stat err =       0.006946210476
      target stat err =       0.010547308499
              std dev =       0.539671052450
             le_variance =       0.291244844853


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.905057143742        initial  <--
     2.0680e+08     2.0680e+09             1.8143e-12        -0.905057143730
     8.2718e+08     8.2718e+09             4.5340e-13        -0.905057143736
     3.3087e+09     3.3087e+10             1.1353e-13        -0.905057143741

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.0315
  </log>
  <optVariables href="H2O.s099.opt.xml">
  uu_0                 2.099665e-01 1 1  ON 0
  uu_1                 5.297278e-02 1 1  ON 1
  uu_2                -3.786905e-02 1 1  ON 2
  uu_3                -9.122423e-02 1 1  ON 3
  uu_4                -1.219419e-01 1 1  ON 4
  uu_5                -1.298132e-01 1 1  ON 5
  uu_6                -1.125656e-01 1 1  ON 6
  uu_7                -5.674078e-02 1 1  ON 7
  uu_8                 5.806923e-02 1 1  ON 8
  uu_9                 1.245064e-01 1 1  ON 9
  ud_0                 3.048774e-01 1 1  ON 10
  ud_1                 7.564061e-02 1 1  ON 11
  ud_2                -2.647854e-02 1 1  ON 12
  ud_3                -7.930428e-02 1 1  ON 13
  ud_4                -1.150111e-01 1 1  ON 14
  ud_5                -1.333285e-01 1 1  ON 15
  ud_6                -1.264025e-01 1 1  ON 16
  ud_7                -8.460392e-02 1 1  ON 17
  ud_8                -6.256203e-03 1 1  ON 18
  ud_9                 8.581215e-02 1 1  ON 19
  eO_0                -7.034960e-01 1 1  ON 20
  eO_1                -4.202664e-01 1 1  ON 21
  eO_2                -4.180141e-02 1 1  ON 22
  eO_3                 1.844439e-01 1 1  ON 23
  eO_4                 2.569167e-01 1 1  ON 24
  eO_5                 2.798430e-01 1 1  ON 25
  eO_6                 2.508569e-01 1 1  ON 26
  eO_7                 1.335222e-01 1 1  ON 27
  eO_8                 2.929651e-02 1 1  ON 28
  eO_9                 1.920099e-02 1 1  ON 29
 eH1_0                -2.017290e-01 1 1  ON 30
 eH1_1                -9.604177e-02 1 1  ON 31
 eH1_2                -4.456907e-02 1 1  ON 32
 eH1_3                -1.424125e-02 1 1  ON 33
 eH1_4                 1.808388e-02 1 1  ON 34
 eH1_5                 2.186426e-02 1 1  ON 35
 eH1_6                 7.089831e-02 1 1  ON 36
 eH1_7                 1.025485e-01 1 1  ON 37
 eH1_8                 1.010700e-01 1 1  ON 38
 eH1_9                 2.609478e-02 1 1  ON 39
 eH2_0                -2.031722e-01 1 1  ON 40
 eH2_1                -9.764755e-02 1 1  ON 41
 eH2_2                -4.626961e-02 1 1  ON 42
 eH2_3                -1.570852e-02 1 1  ON 43
 eH2_4                 1.609680e-02 1 1  ON 44
 eH2_5                 1.955074e-02 1 1  ON 45
 eH2_6                 7.199548e-02 1 1  ON 46
 eH2_7                 1.099040e-01 1 1  ON 47
 eH2_8                 1.035758e-01 1 1  ON 48
 eH2_9                 2.896441e-02 1 1  ON 49
ci_001                -4.165793e-02 3 1  ON 50
ci_002                -3.094301e-02 3 1  ON 51
ci_003                -1.140021e-02 3 1  ON 52
ci_004                 2.557827e-02 3 1  ON 53
ci_005                 2.573455e-02 3 1  ON 54
ci_006                -2.021025e-02 3 1  ON 55
ci_007                -1.979898e-02 3 1  ON 56
ci_008                -4.050778e-03 3 1  ON 57
ci_009                -1.516931e-02 3 1  ON 58
ci_010                -9.528441e-03 3 1  ON 59
ci_011                -9.637842e-03 3 1  ON 60
ci_012                -9.626912e-03 3 1  ON 61
ci_013                -2.166298e-02 3 1  ON 62
ci_014                 1.333031e-02 3 1  ON 63
ci_015                 1.313658e-02 3 1  ON 64
ci_016                 1.627927e-02 3 1  ON 65
ci_017                 1.612037e-02 3 1  ON 66
ci_018                 1.085994e-02 3 1  ON 67
ci_019                 1.052293e-02 3 1  ON 68
ci_020                 1.847007e-02 3 1  ON 69
ci_021                 1.812542e-02 3 1  ON 70
ci_022                 1.026984e-02 3 1  ON 71
ci_023                 1.028341e-02 3 1  ON 72
ci_024                 6.710389e-03 3 1  ON 73
ci_025                 6.515088e-03 3 1  ON 74
ci_026                 1.187386e-02 3 1  ON 75
ci_027                 1.184165e-02 3 1  ON 76
ci_028                -9.175670e-03 3 1  ON 77
ci_029                -9.753424e-03 3 1  ON 78
ci_030                -4.995970e-03 3 1  ON 79
ci_031                -4.662531e-03 3 1  ON 80
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.2076e+01 secs
  Total Execution time = 5.2351e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
